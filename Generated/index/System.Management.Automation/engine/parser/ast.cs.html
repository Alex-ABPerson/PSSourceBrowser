<!DOCTYPE html>
<html><head><title>ast.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(10578);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/parser/ast.cs" target="_top">engine\parser\ast.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="c">//</span>
<span class="c">// This file contains all of the publicly visible parts of the PowerShell abstract syntax tree.</span>
<span class="c">// Any private/internal methods or properties are found in the file AstCompile.cs.</span>
<span class="c">//</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>.<span class="i">Expressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <b>using</b> <span class="i">KeyValuePair</span> = <span class="i">Tuple</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;;
    <b>using</b> <span class="i">IfClause</span> = <span class="i">Tuple</span>&lt;<a href="#86812479028959b8" class="t t">PipelineBaseAst</a>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a>&gt;;
    <b>using</b> <span class="i">SwitchClause</span> = <span class="i">Tuple</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a>&gt;;
    <b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">Emit</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
 
    <b>internal interface</b> <a id="1a23a5e08e419be9" href="../../R/1a23a5e08e419be9.html" target="n" data-glyph="50,0" class="t t">ISupportsAssignment</a>
    {
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a id="2a53987d0bdfbaff" href="../../R/2a53987d0bdfbaff.html" target="n" data-glyph="72,1" class="i method">GetAssignableValue</a>();
    }
 
    <b>internal interface</b> <a id="41e026a3563ae47a" href="../../R/41e026a3563ae47a.html" target="n" data-glyph="50,0" class="t t">IAssignableValue</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> GetValue is only called for pre/post increment/decrement or for read/modify/write assignment operators (+=, -=, etc.)</span>
        <span class="c">///</span><span class="c"> It returns the expressions that holds the value of the ast.  It may append the exprs or temps lists if the return</span>
        <span class="c">///</span><span class="c"> value relies on temps and other expressions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i">Expression</span>? <a id="68362cbeefdedafa" href="../../R/68362cbeefdedafa.html" target="n" data-glyph="72,1" class="i method">GetValue</a>(<a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r0 rd" class="r0 r">compiler</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r1 rd" class="r1 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r2 rd" class="r2 r">temps</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SetValue is called to set the result of an assignment (=) or to write back the result of</span>
        <span class="c">///</span><span class="c"> a pre/post increment/decrement.  It needs to use potentially cached temps if GetValue was called first.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i">Expression</span> <a id="e85a96ce4e1c229b" href="../../R/e85a96ce4e1c229b.html" target="n" data-glyph="72,1" class="i method">SetValue</a>(<a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r3 rd" class="r3 r">compiler</span>, <span class="i">Expression</span> <span id="r4 rd" class="r4 r">rhs</span>);
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <b>internal interface</b> <a id="063cc8bbea9e10f2" href="../../R/063cc8bbea9e10f2.html" target="n" data-glyph="50,0" class="t t">IParameterMetadataProvider</a>
    {
        <b>bool</b> <a id="dea65be215e5a292" href="../../R/dea65be215e5a292.html" target="n" data-glyph="72,1" class="i method">HasAnyScriptBlockAttributes</a>();
 
        <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <a id="c8000536ef7797f3" href="../../R/c8000536ef7797f3.html" target="n" data-glyph="72,1" class="i method">GetParameterMetadata</a>(<b>bool</b> <span id="r5 rd" class="r5 r">automaticPositions</span>, <b>ref bool</b> <span id="r6 rd" class="r6 r">usesCmdletBinding</span>);
 
        <span class="i">IEnumerable</span>&lt;<span class="i">Attribute</span>&gt; <a id="5268a33bec21621c" href="../../R/5268a33bec21621c.html" target="n" data-glyph="72,1" class="i method">GetScriptBlockAttributes</a>();
 
        <span class="i">IEnumerable</span>&lt;<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>&gt; <a id="8aeaf9e21660f350" href="../../R/8aeaf9e21660f350.html" target="n" data-glyph="72,1" class="i method">GetExperimentalAttributes</a>();
 
        <b>bool</b> <a id="960da0e2b7046796" href="../../R/960da0e2b7046796.html" target="n" data-glyph="72,1" class="i method">UsesCmdletBinding</a>();
 
        <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="57fef4bbca7ab95c" href="../../R/57fef4bbca7ab95c.html" target="n" data-glyph="102,1" class="i property">Parameters</a> { <b>get</b>; }
 
        <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="b25d4ae40ae3a393" href="../../R/b25d4ae40ae3a393.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Remoting/Invoke Command
 
        <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="43e8e80a08c89ef8" href="../../R/43e8e80a08c89ef8.html" target="n" data-glyph="72,1" class="i method">GetPowerShell</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r7 rd" class="r7 r">context</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r8 rd" class="r8 r">variables</span>, <b>bool</b> <span id="r9 rd" class="r9 r">isTrustedInput</span>,
            <b>bool</b> <span id="r10 rd" class="r10 r">filterNonUsingVariables</span>, <b>bool</b>? <span id="r11 rd" class="r11 r">createLocalScope</span>, <b>params object</b>[] <span id="r12 rd" class="r12 r">args</span>);
 
        <b>string</b> <a id="9eb35ed25013c0ba" href="../../R/9eb35ed25013c0ba.html" target="n" data-glyph="72,1" class="i method">GetWithInputHandlingForInvokeCommand</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return value is Tuple[paramText, scriptBlockText]</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="65bd5fb5ed6ed146" href="../../R/65bd5fb5ed6ed146.html" target="n" data-glyph="72,1" class="i method">GetWithInputHandlingForInvokeCommandWithUsingExpression</a>(<span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r13 rd" class="r13 r">usingVariablesTuple</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Remoting/Invoke Command
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The abstract base class for all PowerShell abstract syntax tree nodes.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1724:TypeNamesShouldNotMatchNamespaces&quot;</span>)]
    <b>public abstract class</b> <a id="d47621d83efd14de" href="../../R/d47621d83efd14de.html" target="n" data-glyph="0,0" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common fields of an ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="e73f9afcbf27eb4d" href="../../R/e73f9afcbf27eb4d.html" target="n" data-glyph="75,1" class="t constructor">Ast</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r14 rd" class="r14 r">extent</span>)
        {
            <b>if</b> (<span class="r14 r">extent</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r14 r">extent</span>));
            }
 
            <a href="#d47621d83efd14de" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a> = <span class="r14 r">extent</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent in the source this ast represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="d9d5cd324ee61136" href="../../R/d9d5cd324ee61136.html" target="n" data-glyph="102,1" class="i property">Extent</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parent tree for this node.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="faf9ad7a55f1cc57" href="../../R/faf9ad7a55f1cc57.html" target="n" data-glyph="102,1" class="i property">Parent</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Visit the Ast using a visitor that can choose how the tree traversal is performed.  This visit method is</span>
        <span class="c">///</span><span class="c"> for advanced uses of the visitor pattern where an </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is insufficient.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">astVisitor</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The visitor.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns the value returned by the visitor.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public object</b> <a id="a4bac0354b26d4df" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Visit</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r15 rd" class="r15 r">astVisitor</span>)
        {
            <b>if</b> (<span class="r15 r">astVisitor</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r15 r">astVisitor</span>));
            }
 
            <b>return</b> <a href="#d47621d83efd14de" class="k">this</a>.<a href="#71efa3501b9475f2" class="i method">Accept</a>(<span class="r15 r">astVisitor</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Visit each node in the Ast, calling the methods in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">astVisitor</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for each node in the ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">astVisitor</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The visitor.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="b97830265ba444e4" href="../../R/b97830265ba444e4.html" target="n" data-glyph="72,1" class="i method">Visit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r16 rd" class="r16 r">astVisitor</span>)
        {
            <b>if</b> (<span class="r16 r">astVisitor</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r16 r">astVisitor</span>));
            }
 
            <a href="#d47621d83efd14de" class="k">this</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r16 r">astVisitor</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traverse the entire Ast, returning all nodes in the tree for which </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">predicate</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> returns true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">predicate</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The predicate function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">searchNestedScriptBlocks</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Search nested functions and script block expressions.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A possibly empty collection of matching Ast nodes.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IEnumerable</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <a id="295d6794e5f79636" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">FindAll</a>(<span class="i">Func</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>, <b>bool</b>&gt; <span id="r17 rd" class="r17 r">predicate</span>, <b>bool</b> <span id="r18 rd" class="r18 r">searchNestedScriptBlocks</span>)
        {
            <b>if</b> (<span class="r17 r">predicate</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r17 r">predicate</span>));
            }
 
            <b>return</b> <a href="AstVisitor.cs.html#5298c9a8d6287f90" class="t t">AstSearcher</a>.<a href="AstVisitor.cs.html#c9340837cfddcaff" class="i method">FindAll</a>(<a href="#d47621d83efd14de" class="k">this</a>, <span class="r17 r">predicate</span>, <span class="r18 r">searchNestedScriptBlocks</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traverse the entire Ast, returning the first node in the tree for which </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">predicate</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> returns true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">predicate</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The predicate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">searchNestedScriptBlocks</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Search nested functions and script block expressions.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The first matching node, or null if there is no match.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="5d67955db08c10c0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Find</a>(<span class="i">Func</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>, <b>bool</b>&gt; <span id="r19 rd" class="r19 r">predicate</span>, <b>bool</b> <span id="r20 rd" class="r20 r">searchNestedScriptBlocks</span>)
        {
            <b>if</b> (<span class="r19 r">predicate</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r19 r">predicate</span>));
            }
 
            <b>return</b> <a href="AstVisitor.cs.html#5298c9a8d6287f90" class="t t">AstSearcher</a>.<a href="AstVisitor.cs.html#903a28e4cb0d8226" class="i method">FindFirst</a>(<a href="#d47621d83efd14de" class="k">this</a>, <span class="r19 r">predicate</span>, <span class="r20 r">searchNestedScriptBlocks</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Formats the ast and returns a string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="e8e96a43a76cce85" href="../../R/e8e96a43a76cce85.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Duplicates the AST, allowing it to be composed into other ASTs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A copy of the AST, with the link to the previous parent removed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="7559dca1878820e8" href="../../R/7559dca1878820e8.html" target="n" data-glyph="72,1" class="i method">Copy</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the resultant object from the AST and returns it if it is safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The object represented by the AST as a safe object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is deemed unsafe</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public object</b> <a id="2ebfd58d8599888e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SafeGetValue</a>()
        {
            <b>return</b> <a href="#5e7c4352ff5792f8" class="i method">SafeGetValue</a>(<span class="r21 r">skipHashtableSizeCheck</span>: <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the resultant object from the AST and returns it if it is safe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">skipHashtableSizeCheck</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Set to skip hashtable limit validation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The object represented by the AST as a safe object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is deemed unsafe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public object</b> <a id="5e7c4352ff5792f8" href="../../R/5e7c4352ff5792f8.html" target="n" data-glyph="72,1" class="i method">SafeGetValue</a>(<b>bool</b> <span id="r21 rd" class="r21 r">skipHashtableSizeCheck</span>)
        {
            <b>try</b>
            {
                <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r22 rd" class="r22 r">context</span> = <b>null</b>;
                <b>if</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> != <b>null</b>)
                {
                    <span class="r22 r">context</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>;
                }
 
                <b>return</b> <a href="SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<a href="SafeValues.cs.html#1a637852005dfb2f" class="i method">GetSafeValue</a>(<a href="#d47621d83efd14de" class="k">this</a>, <span class="r22 r">context</span>, <span class="r21 r">skipHashtableSizeCheck</span> ? <a href="SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<a href="SafeValues.cs.html#525ae8157bd81dda" class="t t">SafeValueContext</a>.<a href="SafeValues.cs.html#f4f6230490f91602" class="i field">SkipHashtableSizeCheck</a> : <a href="SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<a href="SafeValues.cs.html#525ae8157bd81dda" class="t t">SafeValueContext</a>.<a href="SafeValues.cs.html#9649c27dbb99fbab" class="i field">Default</a>);
            }
            <b>catch</b>
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">AutomationExceptions</span>.<span class="i">CantConvertWithDynamicExpression</span>, <a href="#d47621d83efd14de" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy a collection of AST elements.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The actual AST type</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">elements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Collection of ASTs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="r23 r t">T</span>[] <a id="3038859e1e8cacd7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CopyElements</a>&lt;<span id="r23 rd t" class="r23 r t">T</span>&gt;(<span class="i">ReadOnlyCollection</span>&lt;<span class="r23 r t">T</span>&gt; <span id="r24 rd" class="r24 r">elements</span>) <b>where</b> <span class="r23 r t">T</span> : <a href="#d47621d83efd14de" class="t t">Ast</a>
        {
            <b>if</b> (<span class="r24 r">elements</span> == <b>null</b> || <span class="r24 r">elements</span>.<span class="i">Count</span> == 0) { <b>return</b> <b>null</b>; }
 
            <b>var</b> <span id="r25 rd" class="r25 r">result</span> = <b>new</b> <span class="r23 r t">T</span>[<span class="r24 r">elements</span>.<span class="i">Count</span>];
            <b>for</b> (<b>int</b> <span id="r26 rd" class="r26 r">i</span> = 0; <span class="r26 r">i</span> &lt; <span class="r25 r">result</span>.<span class="i">Length</span>; <span class="r26 r">i</span>++)
            {
                <span class="r25 r">result</span>[<span class="r26 r">i</span>] = (<span class="r23 r t">T</span>)<span class="r24 r">elements</span>[<span class="r26 r">i</span>].<span class="i">Copy</span>();
            }
 
            <b>return</b> <span class="r25 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy a single AST element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The actual AST type</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">element</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An AST instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="r27 r t">T</span> <a id="1e6d1dbcf15d3377" href="../../R/1e6d1dbcf15d3377.html" target="n" data-glyph="74,1" class="i method">CopyElement</a>&lt;<span id="r27 rd t" class="r27 r t">T</span>&gt;(<span class="r27 r t">T</span> <span id="r28 rd" class="r28 r">element</span>) <b>where</b> <span class="r27 r t">T</span> : <a href="#d47621d83efd14de" class="t t">Ast</a>
        {
            <b>if</b> (<span class="r28 r">element</span> == <b>null</b>) { <b>return</b> <b>null</b>; }
 
            <b>return</b> (<span class="r27 r t">T</span>)<span class="r28 r">element</span>.<span class="i">Copy</span>();
        }
 
        <span class="c">// Should be protected AND internal, but C# doesn&#39;t support that.</span>
        <b>internal void</b> <a id="d4ea5706ee4030a1" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetParents</a>&lt;<span id="r29 rd t" class="r29 r t">T</span>&gt;(<span class="i">ReadOnlyCollection</span>&lt;<span class="r29 r t">T</span>&gt; <span id="r30 rd" class="r30 r">children</span>)
            <b>where</b> <span class="r29 r t">T</span> : <a href="#d47621d83efd14de" class="t t">Ast</a>
        {
            <b>for</b> (<b>int</b> <span id="r31 rd" class="r31 r">index</span> = 0; <span class="r31 r">index</span> &lt; <span class="r30 r">children</span>.<span class="i">Count</span>; <span class="r31 r">index</span>++)
            {
                <b>var</b> <span id="r32 rd" class="r32 r">child</span> = <span class="r30 r">children</span>[<span class="r31 r">index</span>];
                <span class="i">SetParent</span>(<span class="r32 r">child</span>);
            }
        }
 
        <span class="c">// Should be protected AND internal, but C# doesn&#39;t support that.</span>
        <b>internal void</b> <a id="246f3ed3d11bee56" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetParents</a>&lt;<span id="r33 rd t" class="r33 r t">T1</span>, <span id="r34 rd t" class="r34 r t">T2</span>&gt;(<span class="i">ReadOnlyCollection</span>&lt;<span class="i">Tuple</span>&lt;<span class="r33 r t">T1</span>, <span class="r34 r t">T2</span>&gt;&gt; <span id="r35 rd" class="r35 r">children</span>)
            <b>where</b> <span class="r33 r t">T1</span> : <a href="#d47621d83efd14de" class="t t">Ast</a>
            <b>where</b> <span class="r34 r t">T2</span> : <a href="#d47621d83efd14de" class="t t">Ast</a>
        {
            <b>for</b> (<b>int</b> <span id="r36 rd" class="r36 r">index</span> = 0; <span class="r36 r">index</span> &lt; <span class="r35 r">children</span>.<span class="i">Count</span>; <span class="r36 r">index</span>++)
            {
                <b>var</b> <span id="r37 rd" class="r37 r">child</span> = <span class="r35 r">children</span>[<span class="r36 r">index</span>];
                <span class="i">SetParent</span>(<span class="r37 r">child</span>.<span class="i">Item1</span>);
                <span class="i">SetParent</span>(<span class="r37 r">child</span>.<span class="i">Item2</span>);
            }
        }
 
        <span class="c">// Should be protected AND internal, but C# doesn&#39;t support that.</span>
        <b>internal void</b> <a id="16b383c9efa28c6a" href="../../R/16b383c9efa28c6a.html" target="n" data-glyph="74,1" class="i method">SetParent</a>(<a href="#d47621d83efd14de" class="t t">Ast</a> <span id="r38 rd" class="r38 r">child</span>)
        {
            <b>if</b> (<span class="r38 r">child</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> != <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">ParserStrings</span>.<span class="i">AstIsReused</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r38 r">child</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> == <b>null</b>, <span class="s">&quot;Parent can only be set once&quot;</span>);
            <span class="r38 r">child</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> = <a href="#d47621d83efd14de" class="k">this</a>;
        }
 
        <b>internal void</b> <a id="57de7cef4d614364" href="../../R/57de7cef4d614364.html" target="n" data-glyph="74,1" class="i method">ClearParent</a>()
        {
            <a href="#d47621d83efd14de" class="k">this</a>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> = <b>null</b>;
        }
 
        <b>internal abstract object</b> <a id="71efa3501b9475f2" href="../../R/71efa3501b9475f2.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r39 rd" class="r39 r">visitor</span>);
 
        <b>internal abstract</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="2e9232a83bfd248d" href="../../R/2e9232a83bfd248d.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r40 rd" class="r40 r">visitor</span>);
 
        <b>internal static readonly</b> <a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>[] <a id="00d80b67ba056d84" href="../../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">EmptyPSTypeNameArray</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt;();
 
        <b>internal bool</b> <a id="af9f0cd8f2a43a97" href="../../R/af9f0cd8f2a43a97.html" target="n" data-glyph="74,1" class="i method">IsInWorkflow</a>()
        {
            <span class="c">// Scan up the AST&#39;s parents, looking for a script block that is either</span>
            <span class="c">// a workflow, or has a job definition attribute.</span>
            <span class="c">// Stop scanning when we encounter a FunctionDefinitionAst</span>
            <a href="#d47621d83efd14de" class="t t">Ast</a> <span id="r41 rd" class="r41 r">current</span> = <a href="#d47621d83efd14de" class="k">this</a>;
            <b>bool</b> <span id="r42 rd" class="r42 r">stopScanning</span> = <b>false</b>;
 
            <b>while</b> (<span class="r41 r">current</span> != <b>null</b> &amp;&amp; !<span class="r42 r">stopScanning</span>)
            {
                <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r43 rd" class="r43 r">scriptBlock</span> = <span class="r41 r">current</span> <b>as</b> <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a>;
                <b>if</b> (<span class="r43 r">scriptBlock</span> != <b>null</b>)
                {
                    <span class="c">// See if this uses the workflow keyword</span>
                    <a href="#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r44 rd" class="r44 r">functionDefinition</span> = <span class="r43 r">scriptBlock</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>;
                    <b>if</b> ((<span class="r44 r">functionDefinition</span> != <b>null</b>))
                    {
                        <span class="r42 r">stopScanning</span> = <b>true</b>;
                        <b>if</b> (<span class="r44 r">functionDefinition</span>.<a href="#d87e1032aa3dac41" class="i property">IsWorkflow</a>) { <b>return</b> <b>true</b>; }
                    }
                }
 
                <a href="#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r45 rd" class="r45 r">commandAst</span> = <span class="r41 r">current</span> <b>as</b> <a href="#a310aaa1e0374ddd" class="t t">CommandAst</a>;
                <b>if</b> (<span class="r45 r">commandAst</span> != <b>null</b> &amp;&amp;
                    <b>string</b>.<span class="i">Equals</span>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7002a360506192c2" class="i field">InlineScript</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>(), <span class="r45 r">commandAst</span>.<a href="#14cec84b5558d5c6" class="i method">GetCommandName</a>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                    <a href="#d47621d83efd14de" class="k">this</a> != <span class="r45 r">commandAst</span>)
                {
                    <b>return</b> <b>false</b>;
                }
 
                <span class="r41 r">current</span> = <span class="r41 r">current</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal bool</b> <a id="6c2f95c8b079b507" href="../../R/6c2f95c8b079b507.html" target="n" data-glyph="104,1" class="i property">HasSuspiciousContent</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Search Ancestor Ast
 
        <b>internal static</b> <a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a> <a id="19d83a8cef88c290" href="../../R/19d83a8cef88c290.html" target="n" data-glyph="74,1" class="i method">GetAncestorConfigurationDefinitionAstAndDynamicKeywordStatementAst</a>(
            <a href="#d47621d83efd14de" class="t t">Ast</a> <span id="r46 rd" class="r46 r">ast</span>,
            <b>out</b> <a href="#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a> <span id="r47 rd" class="r47 r">keywordAst</span>)
        {
            <a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a> <span id="r48 rd" class="r48 r">configAst</span> = <b>null</b>;
            <span class="r47 r">keywordAst</span> = <a href="#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>&gt;(<span class="r46 r">ast</span>);
            <span class="r48 r">configAst</span> = (<span class="r47 r">keywordAst</span> != <b>null</b>) ? <a href="#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a>&gt;(<span class="r47 r">keywordAst</span>) : <a href="#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a>&gt;(<span class="r46 r">ast</span>);
            <b>return</b> <span class="r48 r">configAst</span>;
        }
 
        <b>internal static</b> <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a> <a id="81f4b7f69378f8bf" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetAncestorHashtableAst</a>(<a href="#d47621d83efd14de" class="t t">Ast</a> <span id="r49 rd" class="r49 r">ast</span>, <b>out</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <span id="r50 rd" class="r50 r">lastChildOfHashtable</span>)
        {
            <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r51 rd" class="r51 r">hashtableAst</span> = <b>null</b>;
            <span class="r50 r">lastChildOfHashtable</span> = <b>null</b>;
            <b>while</b> (<span class="r49 r">ast</span> != <b>null</b>)
            {
                <span class="r51 r">hashtableAst</span> = <span class="r49 r">ast</span> <b>as</b> <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a>;
                <b>if</b> (<span class="r51 r">hashtableAst</span> != <b>null</b>)
                    <b>break</b>;
                <span class="r50 r">lastChildOfHashtable</span> = <span class="r49 r">ast</span>;
                <span class="r49 r">ast</span> = <span class="r49 r">ast</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
 
            <b>return</b> <span class="r51 r">hashtableAst</span>;
        }
 
        <b>internal static</b> <a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <a id="1fc90b0e58babd9d" href="../../R/1fc90b0e58babd9d.html" target="n" data-glyph="74,1" class="i method">GetAncestorTypeDefinitionAst</a>(<a href="#d47621d83efd14de" class="t t">Ast</a> <span id="r52 rd" class="r52 r">ast</span>)
        {
            <a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r53 rd" class="r53 r">typeDefinitionAst</span> = <b>null</b>;
 
            <b>while</b> (<span class="r52 r">ast</span> != <b>null</b>)
            {
                <span class="r53 r">typeDefinitionAst</span> = <span class="r52 r">ast</span> <b>as</b> <a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>;
                <b>if</b> (<span class="r53 r">typeDefinitionAst</span> != <b>null</b>)
                    <b>break</b>;
 
                <span class="c">// Nested function isn&#39;t really a member of the type so stop looking</span>
                <span class="c">// Anonymous script blocks are though</span>
                <a href="#dd61b2a7b388405b" class="k">var</a> <span id="r54 rd" class="r54 r">functionDefinitionAst</span> = <span class="r52 r">ast</span> <b>as</b> <a href="#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>;
                <b>if</b> (<span class="r54 r">functionDefinitionAst</span> != <b>null</b> &amp;&amp; <span class="r54 r">functionDefinitionAst</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>)
                    <b>break</b>;
                <span class="r52 r">ast</span> = <span class="r52 r">ast</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
 
            <b>return</b> <span class="r53 r">typeDefinitionAst</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get ancestor Ast of the given type of the given ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">ast</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="r56 r t">T</span> <a id="4ec2535310b60c23" href="../../R/4ec2535310b60c23.html" target="n" data-glyph="74,1" class="i method">GetAncestorAst</a>&lt;<span id="r56 rd t" class="r56 r t">T</span>&gt;(<a href="#d47621d83efd14de" class="t t">Ast</a> <span id="r55 rd" class="r55 r">ast</span>) <b>where</b> <span class="r56 r t">T</span> : <a href="#d47621d83efd14de" class="t t">Ast</a>
        {
            <span class="r56 r t">T</span> <span id="r57 rd" class="r57 r">targetAst</span> = <b>null</b>;
            <a href="#d47621d83efd14de" class="k">var</a> <span id="r58 rd" class="r58 r">parent</span> = <span class="r55 r">ast</span>;
            <b>while</b> (<span class="r58 r">parent</span> != <b>null</b>)
            {
                <span class="r57 r">targetAst</span> = <span class="r58 r">parent</span> <b>as</b> <span class="r56 r t">T</span>;
                <b>if</b> (<span class="r57 r">targetAst</span> != <b>null</b>)
                    <b>break</b>;
                <span class="r58 r">parent</span> = <span class="r58 r">parent</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
 
            <b>return</b> <span class="r57 r">targetAst</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">// A dummy class to hold an extent for open/close curlies so we can step in the debugger.</span>
    <span class="c">// This Ast is never produced by the parser, only from the compiler.</span>
    <b>internal class</b> <a id="6da4eec59e0795e1" href="../../R/6da4eec59e0795e1.html" target="n" data-glyph="2,0" class="t t">SequencePointAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <b>public</b> <a id="d9a5b055bdfedfca" href="../../R/d9a5b055bdfedfca.html" target="n" data-glyph="72,1" class="t constructor">SequencePointAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r59 rd" class="r59 r">extent</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r59 r">extent</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the SequencePointAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="3e0dcc13fe734723" href="../../R/3e0dcc13fe734723.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>internal override object</b> <a id="92edccad2a53395a" href="../../R/92edccad2a53395a.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r60 rd" class="r60 r">visitor</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d3fef3dea1191593" href="../../R/d3fef3dea1191593.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r61 rd" class="r61 r">visitor</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <span class="r61 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#6da4eec59e0795e1" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A placeholder statement used when there are syntactic errors in the source script.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="e02a155b7afded8b" href="../../R/e02a155b7afded8b.html" target="n" data-glyph="0,0" class="t t">ErrorStatementAst</a> : <a href="#86812479028959b8" class="t t">PipelineBaseAst</a>
    {
        <b>internal</b> <a id="03a67eb2183c3b50" href="../../R/03a67eb2183c3b50.html" target="n" data-glyph="74,1" class="t constructor">ErrorStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r62 rd" class="r62 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r63 rd" class="r63 r">nestedAsts</span> = <b>null</b>)
            : <a href="#73f5cf54093debaa" class="k">base</a>(<span class="r62 r">extent</span>)
        {
            <b>if</b> (<span class="r63 r">nestedAsts</span> != <b>null</b> &amp;&amp; <span class="r63 r">nestedAsts</span>.<span class="i">Any</span>())
            {
                <a href="#13ed308a0a98e3fe" class="i property">NestedAst</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r63 r">nestedAsts</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#13ed308a0a98e3fe" class="i property">NestedAst</a>);
            }
        }
 
        <b>internal</b> <a id="9afb18709d821fbe" href="../../R/9afb18709d821fbe.html" target="n" data-glyph="74,1" class="t constructor">ErrorStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r64 rd" class="r64 r">extent</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r65 rd" class="r65 r">kind</span>, <span class="i">IEnumerable</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r66 rd" class="r66 r">nestedAsts</span> = <b>null</b>)
            : <a href="#73f5cf54093debaa" class="k">base</a>(<span class="r64 r">extent</span>)
        {
            <b>if</b> (<span class="r65 r">kind</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r65 r">kind</span>));
            }
 
            <a href="#e07360799fb872a6" class="i property">Kind</a> = <span class="r65 r">kind</span>;
            <b>if</b> (<span class="r66 r">nestedAsts</span> != <b>null</b> &amp;&amp; <span class="r66 r">nestedAsts</span>.<span class="i">Any</span>())
            {
                <a href="#13ed308a0a98e3fe" class="i property">NestedAst</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r66 r">nestedAsts</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#13ed308a0a98e3fe" class="i property">NestedAst</a>);
            }
        }
 
        <b>internal</b> <a id="2f0253466c0fc1e0" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ErrorStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r67 rd" class="r67 r">extent</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r68 rd" class="r68 r">kind</span>, <span class="i">IEnumerable</span>&lt;<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;&gt;&gt; <span id="r69 rd" class="r69 r">flags</span>, <span class="i">IEnumerable</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r70 rd" class="r70 r">conditions</span>, <span class="i">IEnumerable</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r71 rd" class="r71 r">bodies</span>)
            : <a href="#73f5cf54093debaa" class="k">base</a>(<span class="r67 r">extent</span>)
        {
            <b>if</b> (<span class="r68 r">kind</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r68 r">kind</span>));
            }
 
            <a href="#e07360799fb872a6" class="i property">Kind</a> = <span class="r68 r">kind</span>;
            <b>if</b> (<span class="r69 r">flags</span> != <b>null</b> &amp;&amp; <span class="r69 r">flags</span>.<span class="i">Any</span>())
            {
                <a href="#989775977d1f1960" class="i property">Flags</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;&gt; <span id="r72 rd" class="r72 r">entry</span> <b>in</b> <span class="r69 r">flags</span>)
                {
                    <b>if</b> (<a href="#989775977d1f1960" class="i property">Flags</a>.<span class="i">ContainsKey</span>(<span class="r72 r">entry</span>.<span class="i">Key</span>))
                        <b>continue</b>;
 
                    <a href="#989775977d1f1960" class="i property">Flags</a>.<span class="i">Add</span>(<span class="r72 r">entry</span>.<span class="i">Key</span>, <span class="r72 r">entry</span>.<span class="i">Value</span>);
                    <b>if</b> (<span class="r72 r">entry</span>.<span class="i">Value</span>.<span class="i">Item2</span> != <b>null</b>)
                    {
                        <span class="i">SetParent</span>(<span class="r72 r">entry</span>.<span class="i">Value</span>.<span class="i">Item2</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r70 r">conditions</span> != <b>null</b> &amp;&amp; <span class="r70 r">conditions</span>.<span class="i">Any</span>())
            {
                <a href="#228b4ca33e2eeed2" class="i property">Conditions</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r70 r">conditions</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#228b4ca33e2eeed2" class="i property">Conditions</a>);
            }
 
            <b>if</b> (<span class="r71 r">bodies</span> != <b>null</b> &amp;&amp; <span class="r71 r">bodies</span>.<span class="i">Any</span>())
            {
                <a href="#f586eeeddbf00fec" class="i property">Bodies</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r71 r">bodies</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#f586eeeddbf00fec" class="i property">Bodies</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate the kind of the ErrorStatement. e.g. Kind == Switch means that this error statment is generated</span>
        <span class="c">///</span><span class="c"> when parsing a switch statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="e07360799fb872a6" href="../../R/e07360799fb872a6.html" target="n" data-glyph="102,1" class="i property">Kind</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flags specified and their value. The value is null if it&#39;s not specified.</span>
        <span class="c">///</span><span class="c"> e.g. switch -regex -file c:\demo.txt  ---&gt;   regex -- null</span>
        <span class="c">///</span><span class="c">                                              file  -- { c:\demo.txt }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TODO, Changing this to an IDictionary because ReadOnlyDictionary is available only in .NET 4.5</span>
        <span class="c">///</span><span class="c"> This is a temporary workaround and will be fixed later. Tracked by Win8: 354135</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1006:DoNotNestGenericTypesInMemberSignatures&quot;</span>)]
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;&gt; <a id="989775977d1f1960" href="../../R/989775977d1f1960.html" target="n" data-glyph="102,1" class="i property">Flags</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The conditions specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <a id="228b4ca33e2eeed2" href="../../R/228b4ca33e2eeed2.html" target="n" data-glyph="102,1" class="i property">Conditions</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The bodies specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <a id="f586eeeddbf00fec" href="../../R/f586eeeddbf00fec.html" target="n" data-glyph="102,1" class="i property">Bodies</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sometimes a valid ast is parsed successfully within the extent that this error statement represents.  Those</span>
        <span class="c">///</span><span class="c"> asts are contained in this collection.  This collection may contain other error asts.  This collection may</span>
        <span class="c">///</span><span class="c"> be null when no asts were successfully constructed within the extent of this error ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <a id="13ed308a0a98e3fe" href="../../R/13ed308a0a98e3fe.html" target="n" data-glyph="102,1" class="i property">NestedAst</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ErrorStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="96faaf94d8121825" href="../../R/96faaf94d8121825.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>if</b> (<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#e07360799fb872a6" class="i property">Kind</a> == <b>null</b>)
            {
                <b>var</b> <span id="r73 rd" class="r73 r">newNestedAst</span> = <span class="i">CopyElements</span>(<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#13ed308a0a98e3fe" class="i property">NestedAst</a>);
                <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r73 r">newNestedAst</span>);
            }
            <b>else</b> <b>if</b> (<a href="#989775977d1f1960" class="i property">Flags</a> != <b>null</b> || <a href="#228b4ca33e2eeed2" class="i property">Conditions</a> != <b>null</b> || <a href="#f586eeeddbf00fec" class="i property">Bodies</a> != <b>null</b>)
            {
                <b>var</b> <span id="r74 rd" class="r74 r">newConditions</span> = <span class="i">CopyElements</span>(<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#228b4ca33e2eeed2" class="i property">Conditions</a>);
                <b>var</b> <span id="r75 rd" class="r75 r">newBodies</span> = <span class="i">CopyElements</span>(<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#f586eeeddbf00fec" class="i property">Bodies</a>);
                <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;&gt; <span id="r76 rd" class="r76 r">newFlags</span> = <b>null</b>;
 
                <b>if</b> (<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#989775977d1f1960" class="i property">Flags</a> != <b>null</b>)
                {
                    <span class="r76 r">newFlags</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                    <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;&gt; <span id="r77 rd" class="r77 r">entry</span> <b>in</b> <a href="#e02a155b7afded8b" class="k">this</a>.<a href="#989775977d1f1960" class="i property">Flags</a>)
                    {
                        <span class="r27 r t">var</span> <span id="r78 rd" class="r78 r">newAst</span> = <span class="i">CopyElement</span>(<span class="r77 r">entry</span>.<span class="i">Value</span>.<span class="i">Item2</span>);
                        <span class="r76 r">newFlags</span>.<span class="i">Add</span>(<span class="r77 r">entry</span>.<span class="i">Key</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r77 r">entry</span>.<span class="i">Value</span>.<span class="i">Item1</span>, <span class="r78 r">newAst</span>));
                    }
                }
 
                <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#e02a155b7afded8b" class="k">this</a>.<a href="#e07360799fb872a6" class="i property">Kind</a>, <span class="r76 r">newFlags</span>, <span class="r74 r">newConditions</span>, <span class="r75 r">newBodies</span>);
            }
            <b>else</b>
            {
                <b>var</b> <span id="r79 rd" class="r79 r">newNestedAst</span> = <span class="i">CopyElements</span>(<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#13ed308a0a98e3fe" class="i property">NestedAst</a>);
                <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e02a155b7afded8b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#e02a155b7afded8b" class="k">this</a>.<a href="#e07360799fb872a6" class="i property">Kind</a>, <span class="r79 r">newNestedAst</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="73edf5a3753c0751" href="../../R/73edf5a3753c0751.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r80 rd" class="r80 r">visitor</span>)
        {
            <b>return</b> <span class="r80 r">visitor</span>.<a href="AstVisitor.cs.html#d4556ea5c48b0ba5" class="i method">VisitErrorStatement</a>(<a href="#e02a155b7afded8b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="97372537902081f2" href="../../R/97372537902081f2.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r81 rd" class="r81 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r82 rd" class="r82 r">action</span> = <span class="r81 r">visitor</span>.<a href="PreOrderVisitor.cs.html#7602bcabb42bd363" class="i method">VisitErrorStatement</a>(<a href="#e02a155b7afded8b" class="k">this</a>);
            <b>if</b> (<span class="r82 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r81 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#e02a155b7afded8b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r82 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#13ed308a0a98e3fe" class="i property">NestedAst</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r83 rd" class="r83 r">index</span> = 0; <span class="r83 r">index</span> &lt; <a href="#13ed308a0a98e3fe" class="i property">NestedAst</a>.<span class="i">Count</span>; <span class="r83 r">index</span>++)
                {
                    <b>var</b> <span id="r84 rd" class="r84 r">ast</span> = <a href="#13ed308a0a98e3fe" class="i property">NestedAst</a>[<span class="r83 r">index</span>];
                    <span class="r82 r">action</span> = <span class="r84 r">ast</span>.<span class="i">InternalVisit</span>(<span class="r81 r">visitor</span>);
                    <b>if</b> (<span class="r82 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r82 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#989775977d1f1960" class="i property">Flags</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r85 rd" class="r85 r">tuple</span> <b>in</b> <a href="#989775977d1f1960" class="i property">Flags</a>.<span class="i">Values</span>)
                {
                    <b>if</b> (<span class="r85 r">tuple</span>.<span class="i">Item2</span> == <b>null</b>)
                        <b>continue</b>;
 
                    <span class="r82 r">action</span> = <span class="r85 r">tuple</span>.<span class="i">Item2</span>.<span class="i">InternalVisit</span>(<span class="r81 r">visitor</span>);
                    <b>if</b> (<span class="r82 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r82 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#228b4ca33e2eeed2" class="i property">Conditions</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r86 rd" class="r86 r">index</span> = 0; <span class="r86 r">index</span> &lt; <a href="#228b4ca33e2eeed2" class="i property">Conditions</a>.<span class="i">Count</span>; <span class="r86 r">index</span>++)
                {
                    <b>var</b> <span id="r87 rd" class="r87 r">ast</span> = <a href="#228b4ca33e2eeed2" class="i property">Conditions</a>[<span class="r86 r">index</span>];
                    <span class="r82 r">action</span> = <span class="r87 r">ast</span>.<span class="i">InternalVisit</span>(<span class="r81 r">visitor</span>);
                    <b>if</b> (<span class="r82 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r82 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#f586eeeddbf00fec" class="i property">Bodies</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r88 rd" class="r88 r">index</span> = 0; <span class="r88 r">index</span> &lt; <a href="#f586eeeddbf00fec" class="i property">Bodies</a>.<span class="i">Count</span>; <span class="r88 r">index</span>++)
                {
                    <b>var</b> <span id="r89 rd" class="r89 r">ast</span> = <a href="#f586eeeddbf00fec" class="i property">Bodies</a>[<span class="r88 r">index</span>];
                    <span class="r82 r">action</span> = <span class="r89 r">ast</span>.<span class="i">InternalVisit</span>(<span class="r81 r">visitor</span>);
                    <b>if</b> (<span class="r82 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r81 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#e02a155b7afded8b" class="k">this</a>, <span class="r82 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A placeholder expression used when there are syntactic errors in the source script.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="bdf2b3276843e0c2" href="../../R/bdf2b3276843e0c2.html" target="n" data-glyph="0,0" class="t t">ErrorExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <b>internal</b> <a id="521987ae533dc4bd" href="../../R/521987ae533dc4bd.html" target="n" data-glyph="74,1" class="t constructor">ErrorExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r90 rd" class="r90 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r91 rd" class="r91 r">nestedAsts</span> = <b>null</b>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r90 r">extent</span>)
        {
            <b>if</b> (<span class="r91 r">nestedAsts</span> != <b>null</b> &amp;&amp; <span class="r91 r">nestedAsts</span>.<span class="i">Any</span>())
            {
                <a href="#95771f0ae3fb5445" class="i property">NestedAst</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r91 r">nestedAsts</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#95771f0ae3fb5445" class="i property">NestedAst</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sometimes a valid ast is parsed successfully within the extent that this error expression represents.  Those</span>
        <span class="c">///</span><span class="c"> asts are contained in this collection.  This collection may contain other error asts.  This collection may</span>
        <span class="c">///</span><span class="c"> be null when no asts were successfully constructed within the extent of this error ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt; <a id="95771f0ae3fb5445" href="../../R/95771f0ae3fb5445.html" target="n" data-glyph="102,1" class="i property">NestedAst</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ErrorExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="e62b0cc922121498" href="../../R/e62b0cc922121498.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r92 rd" class="r92 r">newNestedAst</span> = <span class="i">CopyElements</span>(<a href="#bdf2b3276843e0c2" class="k">this</a>.<a href="#95771f0ae3fb5445" class="i property">NestedAst</a>);
            <b>return</b> <b>new</b> <span class="t">ErrorExpressionAst</span>(<a href="#bdf2b3276843e0c2" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r92 r">newNestedAst</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="2a0c8c97d2f1ddb2" href="../../R/2a0c8c97d2f1ddb2.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r93 rd" class="r93 r">visitor</span>)
        {
            <b>return</b> <span class="r93 r">visitor</span>.<a href="AstVisitor.cs.html#411558391cb6b7d0" class="i method">VisitErrorExpression</a>(<a href="#bdf2b3276843e0c2" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="4c92c611bd0266f0" href="../../R/4c92c611bd0266f0.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r94 rd" class="r94 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r95 rd" class="r95 r">action</span> = <span class="r94 r">visitor</span>.<a href="PreOrderVisitor.cs.html#aaf3b23da05a915c" class="i method">VisitErrorExpression</a>(<a href="#bdf2b3276843e0c2" class="k">this</a>);
            <b>if</b> (<span class="r95 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r94 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#bdf2b3276843e0c2" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r95 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#95771f0ae3fb5445" class="i property">NestedAst</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r96 rd" class="r96 r">index</span> = 0; <span class="r96 r">index</span> &lt; <a href="#95771f0ae3fb5445" class="i property">NestedAst</a>.<span class="i">Count</span>; <span class="r96 r">index</span>++)
                {
                    <b>var</b> <span id="r97 rd" class="r97 r">ast</span> = <a href="#95771f0ae3fb5445" class="i property">NestedAst</a>[<span class="r96 r">index</span>];
                    <span class="r95 r">action</span> = <span class="r97 r">ast</span>.<span class="i">InternalVisit</span>(<span class="r94 r">visitor</span>);
                    <b>if</b> (<span class="r95 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r94 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#bdf2b3276843e0c2" class="k">this</a>, <span class="r95 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Script Blocks
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="829bb35b0576766a" href="../../R/829bb35b0576766a.html" target="n" data-glyph="0,0" class="t t"><span id="e061a4522dffde0d">ScriptRequirements</span></a>
    {
        <b>internal static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="../ExternalScriptInfo.cs.html#b11a97aaaf8c5e31" class="t t">PSSnapInSpecification</a>&gt; <a id="52529f049b26f9b3" href="../../R/52529f049b26f9b3.html" target="n" data-glyph="44,1" class="i field">EmptySnapinCollection</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="../ExternalScriptInfo.cs.html#b11a97aaaf8c5e31" class="t t">PSSnapInSpecification</a>&gt;();
 
        <b>internal static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="99f85dd334439f4b" href="../../R/99f85dd334439f4b.html" target="n" data-glyph="44,1" class="i field">EmptyAssemblyCollection</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<b>string</b>&gt;();
 
        <b>internal static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <a id="58e359adcc7454c6" href="../../R/58e359adcc7454c6.html" target="n" data-glyph="44,1" class="i field">EmptyModuleCollection</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;();
 
        <b>internal static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="1b0a118e59898f3c" href="../../R/1b0a118e59898f3c.html" target="n" data-glyph="44,1" class="i field">EmptyEditionCollection</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The application id this script requires, specified like:</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -Shellid Shell</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If no application id has been specified, this property is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="3b5a4c855ccf6268" href="../../R/3b5a4c855ccf6268.html" target="n" data-glyph="102,1" class="i property">RequiredApplicationId</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PowerShell version this script requires, specified like:</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -Version 3</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If no version has been specified, this property is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Version</span> <a id="157ab9c15f178cbb" href="../../R/157ab9c15f178cbb.html" target="n" data-glyph="102,1" class="i property">RequiredPSVersion</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PowerShell Edition this script requires, specified like:</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -PSEdition Desktop</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If no PSEdition has been specified, this property is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="b2758c401ba81fa0" href="../../R/b2758c401ba81fa0.html" target="n" data-glyph="102,1" class="i property">RequiredPSEditions</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The modules this script requires, specified like:</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -Module NetAdapter</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -Module @{Name=&quot;NetAdapter&quot;; Version=&quot;1.0.0.0&quot;}</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If no modules are required, this property is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <a id="8cb98a6ac41d8433" href="../../R/8cb98a6ac41d8433.html" target="n" data-glyph="102,1" class="i property">RequiredModules</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The snapins this script requires, specified like:</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -PSSnapin Snapin</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -PSSnapin Snapin -Version 2</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If no snapins are required, this property is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="../ExternalScriptInfo.cs.html#b11a97aaaf8c5e31" class="t t">PSSnapInSpecification</a>&gt; <a id="8585577fef49b313" href="../../R/8585577fef49b313.html" target="n" data-glyph="102,1" class="i property">RequiresPSSnapIns</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The assemblies this script requires, specified like:</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -Assembly path\to\foo.dll</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -Assembly &quot;System.Management.Automation, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If no assemblies are required, this property is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="799c9d9fc3077468" href="../../R/799c9d9fc3077468.html" target="n" data-glyph="102,1" class="i property">RequiredAssemblies</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies if this script requires elevated privileges, specified like:</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">#requires -RunAsAdministrator</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If nothing is specified, this property is false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="e47f1f838c92f68f" href="../../R/e47f1f838c92f68f.html" target="n" data-glyph="102,1" class="i property">IsElevationRequired</a> { <b>get</b>; <b>internal set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A ScriptBlockAst is the root ast node for a complete script.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="6f963589327835a4" href="../../R/6f963589327835a4.html" target="n" data-glyph="0,0" class="t t">ScriptBlockAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>, <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="af402b9dfbb5d36f" href="../../R/af402b9dfbb5d36f.html" target="n" data-glyph="46,1" class="i field">s_emptyAttributeList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
 
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <a id="c9cf221dfec60d97" href="../../R/c9cf221dfec60d97.html" target="n" data-glyph="46,1" class="i field">s_emptyUsingStatementList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt;();
 
        <b>internal bool</b> <a id="5152487ebaa7a76b" href="../../R/5152487ebaa7a76b.html" target="n" data-glyph="104,1" class="i property">HadErrors</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="3b3b1d45fd29329c" href="../../R/3b3b1d45fd29329c.html" target="n" data-glyph="104,1" class="i property">IsConfiguration</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal bool</b> <a id="cfdef203b60231c5" href="../../R/cfdef203b60231c5.html" target="n" data-glyph="104,1" class="i property">PostParseChecksPerformed</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that uses explicitly named begin/process/end blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">usingStatements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list of using statments, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The set of attributes for the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">beginBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the begin block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">processBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the process block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">endBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the end block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">dynamicParamBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the dynamicparam block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="00ad020d39d87b85" href="../../R/00ad020d39d87b85.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r98 rd" class="r98 r">extent</span>,
                              <span class="i">IEnumerable</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r99 rd" class="r99 r">usingStatements</span>,
                              <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r100 rd" class="r100 r">attributes</span>,
                              <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r101 rd" class="r101 r">paramBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r102 rd" class="r102 r">beginBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r103 rd" class="r103 r">processBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r104 rd" class="r104 r">endBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r105 rd" class="r105 r">dynamicParamBlock</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r98 r">extent</span>)
        {
            <a href="#83060b5572750fd4" class="i method">SetUsingStatements</a>(<span class="r99 r">usingStatements</span>);
 
            <b>if</b> (<span class="r100 r">attributes</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#a46b9537e8b363d2" class="i property">Attributes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(<span class="r100 r">attributes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#a46b9537e8b363d2" class="i property">Attributes</a>);
            }
            <b>else</b>
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#a46b9537e8b363d2" class="i property">Attributes</a> = <a href="#af402b9dfbb5d36f" class="i field">s_emptyAttributeList</a>;
            }
 
            <b>if</b> (<span class="r101 r">paramBlock</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> = <span class="r101 r">paramBlock</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r101 r">paramBlock</span>);
            }
 
            <b>if</b> (<span class="r102 r">beginBlock</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#08794a618a2d04ac" class="i property">BeginBlock</a> = <span class="r102 r">beginBlock</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r102 r">beginBlock</span>);
            }
 
            <b>if</b> (<span class="r103 r">processBlock</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#8940fb8f9b3e6444" class="i property">ProcessBlock</a> = <span class="r103 r">processBlock</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r103 r">processBlock</span>);
            }
 
            <b>if</b> (<span class="r104 r">endBlock</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#958e631868900aba" class="i property">EndBlock</a> = <span class="r104 r">endBlock</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r104 r">endBlock</span>);
            }
 
            <b>if</b> (<span class="r105 r">dynamicParamBlock</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#4549d1761658a004" class="i property">DynamicParamBlock</a> = <span class="r105 r">dynamicParamBlock</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r105 r">dynamicParamBlock</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that uses explicitly named begin/process/end blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">usingStatements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list of using statments, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">beginBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the begin block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">processBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the process block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">endBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the end block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">dynamicParamBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the dynamicparam block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="94c4162459fbe2a4" href="../../R/94c4162459fbe2a4.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r106 rd" class="r106 r">extent</span>,
                              <span class="i">IEnumerable</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r107 rd" class="r107 r">usingStatements</span>,
                              <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r108 rd" class="r108 r">paramBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r109 rd" class="r109 r">beginBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r110 rd" class="r110 r">processBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r111 rd" class="r111 r">endBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r112 rd" class="r112 r">dynamicParamBlock</span>)
            : <a href="#00ad020d39d87b85" class="k">this</a>(<span class="r106 r">extent</span>, <span class="r107 r">usingStatements</span>, <b>null</b>, <span class="r108 r">paramBlock</span>, <span class="r109 r">beginBlock</span>, <span class="r110 r">processBlock</span>, <span class="r111 r">endBlock</span>, <span class="r112 r">dynamicParamBlock</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that uses explicitly named begin/process/end blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">beginBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the begin block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">processBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the process block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">endBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the end block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">dynamicParamBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the dynamicparam block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="4593cfbb8050701a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r113 rd" class="r113 r">extent</span>,
                              <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r114 rd" class="r114 r">paramBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r115 rd" class="r115 r">beginBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r116 rd" class="r116 r">processBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r117 rd" class="r117 r">endBlock</span>,
                              <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r118 rd" class="r118 r">dynamicParamBlock</span>)
            : <a href="#94c4162459fbe2a4" class="k">this</a>(<span class="r113 r">extent</span>, <b>null</b>, <span class="r114 r">paramBlock</span>, <span class="r115 r">beginBlock</span>, <span class="r116 r">processBlock</span>, <span class="r117 r">endBlock</span>, <span class="r118 r">dynamicParamBlock</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that does not use explicitly named blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">usingStatements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list of using statments, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">statements</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The statements that go in the end block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false, or the</span>
        <span class="c">///</span><span class="c"> process block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">isFilter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a filter, false if it is a function or workflow.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">statements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="a2dbcaca81de6b8e" href="../../R/a2dbcaca81de6b8e.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r119 rd" class="r119 r">extent</span>, <span class="i">List</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r120 rd" class="r120 r">usingStatements</span>, <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r121 rd" class="r121 r">paramBlock</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r122 rd" class="r122 r">statements</span>, <b>bool</b> <span id="r123 rd" class="r123 r">isFilter</span>)
            : <b>this</b>(<span class="r119 r">extent</span>, <span class="r120 r">usingStatements</span>, <b>null</b>, <span class="r121 r">paramBlock</span>, <span class="r122 r">statements</span>, <span class="r123 r">isFilter</span>, <b>false</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that does not use explicitly named blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r125 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">statements</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The statements that go in the end block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false, or the</span>
        <span class="c">///</span><span class="c"> process block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">isFilter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a filter, false if it is a function or workflow.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">statements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="97cd877cfe108c7b" href="../../R/97cd877cfe108c7b.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r124 rd" class="r124 r">extent</span>, <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r125 rd" class="r125 r">paramBlock</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r126 rd" class="r126 r">statements</span>, <b>bool</b> <span id="r127 rd" class="r127 r">isFilter</span>)
            : <a href="#1086a9d25997bd40" class="k">this</a>(<span class="r124 r">extent</span>, <b>null</b>, <b>null</b>, <span class="r125 r">paramBlock</span>, <span class="r126 r">statements</span>, <span class="r127 r">isFilter</span>, <b>false</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that does not use explicitly named blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">statements</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The statements that go in the end block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false, or the</span>
        <span class="c">///</span><span class="c"> process block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">isFilter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a filter, false if it is a function or workflow.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r132 r">isConfiguration</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">statements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="da5664c069b1ebfb" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r128 rd" class="r128 r">extent</span>, <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r129 rd" class="r129 r">paramBlock</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r130 rd" class="r130 r">statements</span>, <b>bool</b> <span id="r131 rd" class="r131 r">isFilter</span>, <b>bool</b> <span id="r132 rd" class="r132 r">isConfiguration</span>)
            : <a href="#1086a9d25997bd40" class="k">this</a>(<span class="r128 r">extent</span>, <b>null</b>, <b>null</b>, <span class="r129 r">paramBlock</span>, <span class="r130 r">statements</span>, <span class="r131 r">isFilter</span>, <span class="r132 r">isConfiguration</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that does not use explicitly named blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">usingStatements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list of using statments, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">statements</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The statements that go in the end block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false, or the</span>
        <span class="c">///</span><span class="c"> process block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">isFilter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a filter, false if it is a function or workflow.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">isConfiguration</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">statements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="e0230cc24658bf00" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r133 rd" class="r133 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r134 rd" class="r134 r">usingStatements</span>, <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r135 rd" class="r135 r">paramBlock</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r136 rd" class="r136 r">statements</span>, <b>bool</b> <span id="r137 rd" class="r137 r">isFilter</span>, <b>bool</b> <span id="r138 rd" class="r138 r">isConfiguration</span>)
            : <a href="#1086a9d25997bd40" class="k">this</a>(<span class="r133 r">extent</span>, <span class="r134 r">usingStatements</span>, <b>null</b>, <span class="r135 r">paramBlock</span>, <span class="r136 r">statements</span>, <span class="r137 r">isFilter</span>, <span class="r138 r">isConfiguration</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that does not use explicitly named blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attributes for the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">statements</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The statements that go in the end block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false, or the</span>
        <span class="c">///</span><span class="c"> process block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">isFilter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a filter, false if it is a function or workflow.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">isConfiguration</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">statements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="e9aeffab821fc451" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r139 rd" class="r139 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r140 rd" class="r140 r">attributes</span>, <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r141 rd" class="r141 r">paramBlock</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r142 rd" class="r142 r">statements</span>, <b>bool</b> <span id="r143 rd" class="r143 r">isFilter</span>, <b>bool</b> <span id="r144 rd" class="r144 r">isConfiguration</span>)
            : <a href="#1086a9d25997bd40" class="k">this</a>(<span class="r139 r">extent</span>, <b>null</b>, <span class="r140 r">attributes</span>, <span class="r141 r">paramBlock</span>, <span class="r142 r">statements</span>, <span class="r143 r">isFilter</span>, <span class="r144 r">isConfiguration</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a ScriptBlockAst that does not use explicitly named blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">usingStatements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list of using statments, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r147 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attributes for the script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r148 r">paramBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the param block, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r149 r">statements</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The statements that go in the end block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false, or the</span>
        <span class="c">///</span><span class="c"> process block if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">isFilter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">isFilter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a filter, false if it is a function or workflow.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">isConfiguration</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the script block is a configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r149 r">statements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;param&quot;</span>)]
        <b>public</b> <a id="1086a9d25997bd40" href="../../R/1086a9d25997bd40.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r145 rd" class="r145 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r146 rd" class="r146 r">usingStatements</span>, <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r147 rd" class="r147 r">attributes</span>, <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r148 rd" class="r148 r">paramBlock</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r149 rd" class="r149 r">statements</span>, <b>bool</b> <span id="r150 rd" class="r150 r">isFilter</span>, <b>bool</b> <span id="r151 rd" class="r151 r">isConfiguration</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r145 r">extent</span>)
        {
            <a href="#83060b5572750fd4" class="i method">SetUsingStatements</a>(<span class="r146 r">usingStatements</span>);
 
            <b>if</b> (<span class="r147 r">attributes</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#a46b9537e8b363d2" class="i property">Attributes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(<span class="r147 r">attributes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#a46b9537e8b363d2" class="i property">Attributes</a>);
            }
            <b>else</b>
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#a46b9537e8b363d2" class="i property">Attributes</a> = <a href="#af402b9dfbb5d36f" class="i field">s_emptyAttributeList</a>;
            }
 
            <b>if</b> (<span class="r149 r">statements</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r149 r">statements</span>));
            }
 
            <b>if</b> (<span class="r148 r">paramBlock</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> = <span class="r148 r">paramBlock</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r148 r">paramBlock</span>);
            }
 
            <b>if</b> (<span class="r150 r">isFilter</span>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#8940fb8f9b3e6444" class="i property">ProcessBlock</a> = <b>new</b> <a href="#96d8e19358d66e35" class="t constructor">NamedBlockAst</a>(<span class="r149 r">statements</span>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a>, <span class="r149 r">statements</span>, <b>true</b>);
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#8940fb8f9b3e6444" class="i property">ProcessBlock</a>);
            }
            <b>else</b>
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#958e631868900aba" class="i property">EndBlock</a> = <b>new</b> <a href="#96d8e19358d66e35" class="t constructor">NamedBlockAst</a>(<span class="r149 r">statements</span>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a>, <span class="r149 r">statements</span>, <b>true</b>);
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#3b3b1d45fd29329c" class="i property">IsConfiguration</a> = <span class="r151 r">isConfiguration</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#958e631868900aba" class="i property">EndBlock</a>);
            }
        }
 
        <b>private void</b> <a id="83060b5572750fd4" href="../../R/83060b5572750fd4.html" target="n" data-glyph="76,1" class="i method">SetUsingStatements</a>(<span class="i">IEnumerable</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r152 rd" class="r152 r">usingStatements</span>)
        {
            <b>if</b> (<span class="r152 r">usingStatements</span> != <b>null</b>)
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#c707ba0b01460c10" class="i property">UsingStatements</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt;(<span class="r152 r">usingStatements</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#c707ba0b01460c10" class="i property">UsingStatements</a>);
            }
            <b>else</b>
            {
                <a href="#6f963589327835a4" class="k">this</a>.<a href="#c707ba0b01460c10" class="i property">UsingStatements</a> = <a href="#c9cf221dfec60d97" class="i field">s_emptyUsingStatementList</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for attributes (such as [DscLocalConfigurationManager()]) used before the scriptblock.</span>
        <span class="c">///</span><span class="c"> This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="a46b9537e8b363d2" href="../../R/a46b9537e8b363d2.html" target="n" data-glyph="102,1" class="i property">Attributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for any using statements.  This property is never null.</span>
        <span class="c">///</span><span class="c"> Elements of the collection are instances of either </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> or (only in error cases) </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e02a155b7afded8b" class="t t">ErrorStatementAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <a id="c707ba0b01460c10" href="../../R/c707ba0b01460c10.html" target="n" data-glyph="102,1" class="i property">UsingStatements</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast representing the parameters for a script block, or null if no param block was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Param&quot;</span>)]
        <b>public</b> <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <a id="3fd8788db62344d2" href="../../R/3fd8788db62344d2.html" target="n" data-glyph="102,1" class="i property">ParamBlock</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast representing the begin block for a script block, or null if no begin block was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <a id="08794a618a2d04ac" href="../../R/08794a618a2d04ac.html" target="n" data-glyph="102,1" class="i property">BeginBlock</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast representing the process block for a script block, or null if no process block was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <a id="8940fb8f9b3e6444" href="../../R/8940fb8f9b3e6444.html" target="n" data-glyph="102,1" class="i property">ProcessBlock</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast representing the end block for a script block, or null if no end block was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <a id="958e631868900aba" href="../../R/958e631868900aba.html" target="n" data-glyph="102,1" class="i property">EndBlock</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast representing the dynamicparam block for a script block, or null if no dynamicparam block was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Param&quot;</span>)]
        <b>public</b> <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <a id="4549d1761658a004" href="../../R/4549d1761658a004.html" target="n" data-glyph="102,1" class="i property">DynamicParamBlock</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All of the parsed information from any #requires in the script, or null if #requires was not used.</span>
        <span class="c">///</span><span class="c"> This property is only set for the top level script block (where </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d47621d83efd14de" class="t t">Ast</a>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">) is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#829bb35b0576766a" class="t t">ScriptRequirements</a> <a id="db84554dcf2e5444" href="../../R/db84554dcf2e5444.html" target="n" data-glyph="102,1" class="i property">ScriptRequirements</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the help content, if any, for the script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#3e2184322a40858b" class="t t">CommentHelpInfo</a> <a id="ef45c7d53c5e4991" href="../../R/ef45c7d53c5e4991.html" target="n" data-glyph="72,1" class="i method">GetHelpContent</a>()
        {
            <span class="i">Dictionary</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt; <span id="r153 rd" class="r153 r">scriptBlockTokenCache</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt;();
            <b>var</b> <span id="r154 rd" class="r154 r">commentTokens</span> = <a href="../../help/HelpCommentsParser.cs.html#9f10a00eb0f83566" class="t t">HelpCommentsParser</a>.<a href="../../help/HelpCommentsParser.cs.html#20a6987da91cc728" class="i method">GetHelpCommentTokens</a>(<a href="#6f963589327835a4" class="k">this</a>, <span class="r153 r">scriptBlockTokenCache</span>);
            <b>if</b> (<span class="r154 r">commentTokens</span> != <b>null</b>)
            {
                <b>return</b> <a href="../../help/HelpCommentsParser.cs.html#9f10a00eb0f83566" class="t t">HelpCommentsParser</a>.<span class="i">GetHelpContents</span>(<span class="r154 r">commentTokens</span>.<span class="i">Item1</span>, <span class="r154 r">commentTokens</span>.<span class="i">Item2</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert the ast into a script block that can be invoked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The compiled script block.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/ParserException.cs.html#89a0a90c9fc1219d" class="t t">ParseException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown if there are any semantic errors in the ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="c92a81f9f4baf15f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetScriptBlock</a>()
        {
            <b>if</b> (!<a href="#cfdef203b60231c5" class="i property">PostParseChecksPerformed</a>)
            {
                <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r155 rd" class="r155 r">parser</span> = <b>new</b> <a href="Parser.cs.html#aee2c3138d83ea53" class="t constructor">Parser</a>();
                <span class="c">// we call PerformPostParseChecks on root ScriptBlockAst, to obey contract of SymbolResolver.</span>
                <span class="c">// It needs to be run from the top of the tree.</span>
                <span class="c">// It&#39;s ok to report an error from a different part of AST in this case.</span>
                <a href="#6f963589327835a4" class="k">var</a> <span id="r156 rd" class="r156 r">root</span> = <a href="#2da0a0258c541e7a" class="i method">GetRootScriptBlockAst</a>();
                <span class="r156 r">root</span>.<a href="#3e5400a9fb46cc34" class="i method">PerformPostParseChecks</a>(<span class="r155 r">parser</span>);
                <b>if</b> (<span class="r155 r">parser</span>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0)
                {
                    <b>throw</b> <b>new</b> <span class="t">ParseException</span>(<span class="r155 r">parser</span>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">ToArray</span>());
                }
            }
 
            <b>if</b> (<a href="#5152487ebaa7a76b" class="i property">HadErrors</a>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshInvalidOperationException.cs.html#901b411ac57457e6" class="t constructor">PSInvalidOperationException</a>();
            }
 
            <b>return</b> <b>new</b> <a href="../runtime/CompiledScriptBlock.cs.html#7c5e468d9c460238" class="t constructor">ScriptBlock</a>(<a href="#6f963589327835a4" class="k">this</a>, <span class="r157 r">isFilter</span>: <b>false</b>);
        }
 
        <b>private</b> <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="2da0a0258c541e7a" href="../../R/2da0a0258c541e7a.html" target="n" data-glyph="76,1" class="i method">GetRootScriptBlockAst</a>()
        {
            <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r158 rd" class="r158 r">rootScriptBlockAst</span> = <a href="#6f963589327835a4" class="k">this</a>;
            <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r159 rd" class="r159 r">parent</span>;
            <b>while</b> ((<span class="r159 r">parent</span> = <a href="#d47621d83efd14de" class="t t">Ast</a>.<a href="#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="#6f963589327835a4" class="t t">ScriptBlockAst</a>&gt;(<span class="r158 r">rootScriptBlockAst</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a>)) != <b>null</b>)
            {
                <span class="r158 r">rootScriptBlockAst</span> = <span class="r159 r">parent</span>;
            }
 
            <b>return</b> <span class="r158 r">rootScriptBlockAst</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ScriptBlockAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="f6d5239a25d66c7a" href="../../R/f6d5239a25d66c7a.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#be95362bdc5e7d07" class="k">var</a> <span id="r160 rd" class="r160 r">newParamBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>);
            <a href="#61c97c02c53bf32d" class="k">var</a> <span id="r161 rd" class="r161 r">newBeginBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#08794a618a2d04ac" class="i property">BeginBlock</a>);
            <a href="#61c97c02c53bf32d" class="k">var</a> <span id="r162 rd" class="r162 r">newProcessBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#8940fb8f9b3e6444" class="i property">ProcessBlock</a>);
            <a href="#61c97c02c53bf32d" class="k">var</a> <span id="r163 rd" class="r163 r">newEndBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#958e631868900aba" class="i property">EndBlock</a>);
            <a href="#61c97c02c53bf32d" class="k">var</a> <span id="r164 rd" class="r164 r">newDynamicParamBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#4549d1761658a004" class="i property">DynamicParamBlock</a>);
            <b>var</b> <span id="r165 rd" class="r165 r">newAttributes</span> = <span class="i">CopyElements</span>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#a46b9537e8b363d2" class="i property">Attributes</a>);
            <b>var</b> <span id="r166 rd" class="r166 r">newUsingStatements</span> = <span class="i">CopyElements</span>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#c707ba0b01460c10" class="i property">UsingStatements</a>);
 
            <a href="#6f963589327835a4" class="k">var</a> <span id="r167 rd" class="r167 r">scriptBlockAst</span> = <b>new</b> <span class="t">ScriptBlockAst</span>(<a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r166 r">newUsingStatements</span>, <span class="r165 r">newAttributes</span>, <span class="r160 r">newParamBlock</span>, <span class="r161 r">newBeginBlock</span>, <span class="r162 r">newProcessBlock</span>,
                                                    <span class="r163 r">newEndBlock</span>, <span class="r164 r">newDynamicParamBlock</span>)
            {
                <a href="#3b3b1d45fd29329c" class="i property">IsConfiguration</a> = <a href="#6f963589327835a4" class="k">this</a>.<a href="#3b3b1d45fd29329c" class="i property">IsConfiguration</a>,
                <a href="#db84554dcf2e5444" class="i property">ScriptRequirements</a> = <a href="#6f963589327835a4" class="k">this</a>.<a href="#db84554dcf2e5444" class="i property">ScriptRequirements</a>
            };
            <b>return</b> <span class="r167 r">scriptBlockAst</span>;
        }
 
        <b>internal string</b> <a id="8753abaf002f9597" href="../../R/8753abaf002f9597.html" target="n" data-glyph="74,1" class="i method">ToStringForSerialization</a>()
        {
            <b>string</b> <span id="r168 rd" class="r168 r">result</span> = <a href="#6f963589327835a4" class="k">this</a>.<a href="#e8e96a43a76cce85" class="i method">ToString</a>();
            <b>if</b> (<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> != <b>null</b>)
            {
                <span class="c">// Parent is FunctionDefinitionAst or ScriptBlockExpressionAst</span>
                <span class="c">// The extent includes curlies which we want to exclude.</span>
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r168 r">result</span>[0] == <span class="s">&#39;{&#39;</span> &amp;&amp; <span class="r168 r">result</span>[<span class="r168 r">result</span>.<span class="i">Length</span> - 1] == <span class="s">&#39;}&#39;</span>,
                    <span class="s">&quot;There is an incorrect assumption about the extent.&quot;</span>);
                <span class="r168 r">result</span> = <span class="r168 r">result</span>.<span class="i">Substring</span>(1, <span class="r168 r">result</span>.<span class="i">Length</span> - 2);
            }
 
            <b>return</b> <span class="r168 r">result</span>;
        }
 
        <b>internal string</b> <a id="8a9e338706865ac2" href="../../R/8a9e338706865ac2.html" target="n" data-glyph="74,1" class="i method">ToStringForSerialization</a>(<span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r169 rd" class="r169 r">usingVariablesTuple</span>, <b>int</b> <span id="r170 rd" class="r170 r">initialStartOffset</span>, <b>int</b> <span id="r171 rd" class="r171 r">initialEndOffset</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r169 r">usingVariablesTuple</span>.<span class="i">Item1</span> != <b>null</b> &amp;&amp; <span class="r169 r">usingVariablesTuple</span>.<span class="i">Item1</span>.<span class="i">Count</span> &gt; 0 &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r169 r">usingVariablesTuple</span>.<span class="i">Item2</span>),
                               <span class="s">&quot;Caller makes sure the value passed in is not null or empty&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r170 r">initialStartOffset</span> &lt; <span class="r171 r">initialEndOffset</span> &amp;&amp; <span class="r170 r">initialStartOffset</span> &gt;= <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &amp;&amp; <span class="r171 r">initialEndOffset</span> &lt;= <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>,
                               <span class="s">&quot;Caller makes sure the section is within the ScriptBlockAst&quot;</span>);
 
            <span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt; <span id="r172 rd" class="r172 r">usingVars</span> = <span class="r169 r">usingVariablesTuple</span>.<span class="i">Item1</span>; <span class="c">// A list of using variables</span>
            <b>string</b> <span id="r173 rd" class="r173 r">newParams</span> = <span class="r169 r">usingVariablesTuple</span>.<span class="i">Item2</span>; <span class="c">// The new parameters are separated by the comma</span>
 
            <span class="c">// astElements contains</span>
            <span class="c">//  -- UsingVariable</span>
            <span class="c">//  -- ParamBlockAst</span>
            <b>var</b> <span id="r174 rd" class="r174 r">astElements</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r172 r">usingVars</span>);
            <b>if</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <span class="r174 r">astElements</span>.<span class="i">Add</span>(<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>);
            }
 
            <b>int</b> <span id="r175 rd" class="r175 r">indexOffset</span> = <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>;
            <b>int</b> <span id="r176 rd" class="r176 r">startOffset</span> = <span class="r170 r">initialStartOffset</span> - <span class="r175 r">indexOffset</span>;
            <b>int</b> <span id="r177 rd" class="r177 r">endOffset</span> = <span class="r171 r">initialEndOffset</span> - <span class="r175 r">indexOffset</span>;
 
            <b>string</b> <span id="r178 rd" class="r178 r">script</span> = <a href="#6f963589327835a4" class="k">this</a>.<a href="#e8e96a43a76cce85" class="i method">ToString</a>();
            <b>var</b> <span id="r179 rd" class="r179 r">newScript</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>foreach</b> (<b>var</b> <span id="r180 rd" class="r180 r">ast</span> <b>in</b> <span class="r174 r">astElements</span>.<span class="i">OrderBy</span>(<b>static</b> <span id="r181 rd" class="r181 r">ast</span> =&gt; <span class="r181 r">ast</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span>))
            {
                <b>int</b> <span id="r182 rd" class="r182 r">astStartOffset</span> = <span class="r180 r">ast</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span> - <span class="r175 r">indexOffset</span>;
                <b>int</b> <span id="r183 rd" class="r183 r">astEndOffset</span> = <span class="r180 r">ast</span>.<span class="i">Extent</span>.<span class="i">EndOffset</span> - <span class="r175 r">indexOffset</span>;
 
                <span class="c">// Skip the ast that is before the section that we care about</span>
                <b>if</b> (<span class="r182 r">astStartOffset</span> &lt; <span class="r176 r">startOffset</span>) { <b>continue</b>; }
                <span class="c">// We are done processing the section that we care about</span>
                <b>if</b> (<span class="r182 r">astStartOffset</span> &gt;= <span class="r177 r">endOffset</span>) { <b>break</b>; }
 
                <a href="#248562b22b336dec" class="k">var</a> <span id="r184 rd" class="r184 r">varAst</span> = <span class="r180 r">ast</span> <b>as</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                <b>if</b> (<span class="r184 r">varAst</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r185 rd" class="r185 r">varName</span> = <span class="r184 r">varAst</span>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>;
                    <b>string</b> <span id="r186 rd" class="r186 r">varSign</span> = <span class="r184 r">varAst</span>.<a href="#7f1485a08eb97fcc" class="i property">Splatted</a> ? <span class="s">&quot;@&quot;</span> : <span class="s">&quot;$&quot;</span>;
                    <b>string</b> <span id="r187 rd" class="r187 r">newVarName</span> = <span class="r186 r">varSign</span> + <a href="#42d36b88817a807f" class="t t">UsingExpressionAst</a>.<a href="#3331acd12e22a1c8" class="i field">UsingPrefix</a> + <span class="r185 r">varName</span>;
 
                    <span class="r179 r">newScript</span>.<span class="i">Append</span>(<span class="r178 r">script</span>.<span class="i">AsSpan</span>(<span class="r176 r">startOffset</span>, <span class="r182 r">astStartOffset</span> - <span class="r176 r">startOffset</span>));
                    <span class="r179 r">newScript</span>.<span class="i">Append</span>(<span class="r187 r">newVarName</span>);
                    <span class="r176 r">startOffset</span> = <span class="r183 r">astEndOffset</span>;
                }
                <b>else</b>
                {
                    <a href="#be95362bdc5e7d07" class="k">var</a> <span id="r188 rd" class="r188 r">paramAst</span> = <span class="r180 r">ast</span> <b>as</b> <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a>;
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r188 r">paramAst</span> != <b>null</b>, <span class="s">&quot;The elements in astElements are either ParamBlockAst or VariableExpressionAst&quot;</span>);
 
                    <b>int</b> <span id="r189 rd" class="r189 r">currentOffset</span>;
                    <b>if</b> (<span class="r188 r">paramAst</span>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>.<span class="i">Count</span> == 0)
                    {
                        <span class="r189 r">currentOffset</span> = <span class="r183 r">astEndOffset</span> - 1;
                    }
                    <b>else</b>
                    {
                        <b>var</b> <span id="r190 rd" class="r190 r">firstParam</span> = <span class="r188 r">paramAst</span>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>[0];
                        <span class="r189 r">currentOffset</span> = <span class="r190 r">firstParam</span>.<span class="i">Attributes</span>.<span class="i">Count</span> == 0 ? <span class="r190 r">firstParam</span>.<span class="i">Name</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span> - <span class="r175 r">indexOffset</span> : <span class="r190 r">firstParam</span>.<span class="i">Attributes</span>[0].<span class="i">Extent</span>.<span class="i">StartOffset</span> - <span class="r175 r">indexOffset</span>;
                        <span class="r173 r">newParams</span> += <span class="s">&quot;,\n&quot;</span>;
                    }
 
                    <span class="r179 r">newScript</span>.<span class="i">Append</span>(<span class="r178 r">script</span>.<span class="i">AsSpan</span>(<span class="r176 r">startOffset</span>, <span class="r189 r">currentOffset</span> - <span class="r176 r">startOffset</span>));
                    <span class="r179 r">newScript</span>.<span class="i">Append</span>(<span class="r173 r">newParams</span>);
                    <span class="r176 r">startOffset</span> = <span class="r189 r">currentOffset</span>;
                }
            }
 
            <span class="r179 r">newScript</span>.<span class="i">Append</span>(<span class="r178 r">script</span>.<span class="i">AsSpan</span>(<span class="r176 r">startOffset</span>, <span class="r177 r">endOffset</span> - <span class="r176 r">startOffset</span>));
            <b>string</b> <span id="r191 rd" class="r191 r">result</span> = <span class="r179 r">newScript</span>.<span class="i">ToString</span>();
 
            <b>if</b> (<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> != <b>null</b> &amp;&amp; <span class="r170 r">initialStartOffset</span> == <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &amp;&amp; <span class="r171 r">initialEndOffset</span> == <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>)
            {
                <span class="c">// Parent is FunctionDefinitionAst or ScriptBlockExpressionAst</span>
                <span class="c">// The extent includes curlies which we want to exclude.</span>
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r191 r">result</span>[0] == <span class="s">&#39;{&#39;</span> &amp;&amp; <span class="r191 r">result</span>[<span class="r191 r">result</span>.<span class="i">Length</span> - 1] == <span class="s">&#39;}&#39;</span>,
                    <span class="s">&quot;There is an incorrect assumption about the extent.&quot;</span>);
                <span class="r191 r">result</span> = <span class="r191 r">result</span>.<span class="i">Substring</span>(1, <span class="r191 r">result</span>.<span class="i">Length</span> - 2);
            }
 
            <b>return</b> <span class="r191 r">result</span>;
        }
 
        <b>internal void</b> <a id="3e5400a9fb46cc34" href="../../R/3e5400a9fb46cc34.html" target="n" data-glyph="74,1" class="i method">PerformPostParseChecks</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r192 rd" class="r192 r">parser</span>)
        {
            <b>bool</b> <span id="r193 rd" class="r193 r">etwEnabled</span> = <a href="Parser.cs.html#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="Parser.cs.html#10130af1551d9144" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r193 r">etwEnabled</span>) <a href="Parser.cs.html#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="Parser.cs.html#10130af1551d9144" class="i field">Log</a>.<a href="Parser.cs.html#0ed986f4938384f3" class="i method">ResolveSymbolsStart</a>();
 
            <a href="SymbolResolver.cs.html#2121410b8db29d18" class="t t">SymbolResolver</a>.<a href="SymbolResolver.cs.html#99b86e22d2f31cb0" class="i method">ResolveSymbols</a>(<span class="r192 r">parser</span>, <a href="#6f963589327835a4" class="k">this</a>);
            <b>if</b> (<span class="r193 r">etwEnabled</span>)
            {
                <a href="Parser.cs.html#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="Parser.cs.html#10130af1551d9144" class="i field">Log</a>.<a href="Parser.cs.html#d4d6de9d8d9c112c" class="i method">ResolveSymbolsStop</a>();
                <a href="Parser.cs.html#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="Parser.cs.html#10130af1551d9144" class="i field">Log</a>.<a href="Parser.cs.html#8f10b17c4a508be7" class="i method">SemanticChecksStart</a>();
            }
 
            <a href="SemanticChecks.cs.html#20ff17b776f5a22d" class="t t">SemanticChecks</a>.<a href="SemanticChecks.cs.html#585e0d8f25cb1d38" class="i method">CheckAst</a>(<span class="r192 r">parser</span>, <a href="#6f963589327835a4" class="k">this</a>);
            <b>if</b> (<span class="r193 r">etwEnabled</span>) <a href="Parser.cs.html#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="Parser.cs.html#10130af1551d9144" class="i field">Log</a>.<a href="Parser.cs.html#c890e969e3d7b2bd" class="i method">SemanticChecksStop</a>();
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#cfdef203b60231c5" class="i property">PostParseChecksPerformed</a>, <span class="s">&quot;Post parse checks not set during semantic checks&quot;</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="d18edcf2ee519956" href="../../R/d18edcf2ee519956.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r194 rd" class="r194 r">visitor</span>)
        {
            <b>return</b> <span class="r194 r">visitor</span>.<a href="AstVisitor.cs.html#1699f4a7bd930b39" class="i method">VisitScriptBlock</a>(<a href="#6f963589327835a4" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="360723934e684b68" href="../../R/360723934e684b68.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r195 rd" class="r195 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r196 rd" class="r196 r">action</span> = <span class="r195 r">visitor</span>.<a href="PreOrderVisitor.cs.html#1c8ec334de372b05" class="i method">VisitScriptBlock</a>(<a href="#6f963589327835a4" class="k">this</a>);
            <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r195 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#6f963589327835a4" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
 
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r197 rd" class="r197 r">visitor2</span> = <span class="r195 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r197 r">visitor2</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r198 rd" class="r198 r">usingStatement</span> <b>in</b> <a href="#c707ba0b01460c10" class="i property">UsingStatements</a>)
                    {
                        <span class="r196 r">action</span> = <span class="r198 r">usingStatement</span>.<span class="i">InternalVisit</span>(<span class="r197 r">visitor2</span>);
                        <b>if</b> (<span class="r196 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                        {
                            <b>break</b>;
                        }
                    }
                }
 
                <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r199 rd" class="r199 r">attr</span> <b>in</b> <a href="#a46b9537e8b363d2" class="i property">Attributes</a>)
                    {
                        <span class="r196 r">action</span> = <span class="r199 r">attr</span>.<span class="i">InternalVisit</span>(<span class="r197 r">visitor2</span>);
                        <b>if</b> (<span class="r196 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                        {
                            <b>break</b>;
                        }
                    }
                }
            }
 
            <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
                <span class="r196 r">action</span> = <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#5610f38d37fc216e" class="i method">InternalVisit</a>(<span class="r195 r">visitor</span>);
            <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#4549d1761658a004" class="i property">DynamicParamBlock</a> != <b>null</b>)
                <span class="r196 r">action</span> = <a href="#4549d1761658a004" class="i property">DynamicParamBlock</a>.<a href="#d4ea6c30a7108195" class="i method">InternalVisit</a>(<span class="r195 r">visitor</span>);
            <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#08794a618a2d04ac" class="i property">BeginBlock</a> != <b>null</b>)
                <span class="r196 r">action</span> = <a href="#08794a618a2d04ac" class="i property">BeginBlock</a>.<a href="#d4ea6c30a7108195" class="i method">InternalVisit</a>(<span class="r195 r">visitor</span>);
            <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#8940fb8f9b3e6444" class="i property">ProcessBlock</a> != <b>null</b>)
                <span class="r196 r">action</span> = <a href="#8940fb8f9b3e6444" class="i property">ProcessBlock</a>.<a href="#d4ea6c30a7108195" class="i method">InternalVisit</a>(<span class="r195 r">visitor</span>);
            <b>if</b> (<span class="r196 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#958e631868900aba" class="i property">EndBlock</a> != <b>null</b>)
                <span class="r196 r">action</span> = <a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#d4ea6c30a7108195" class="i method">InternalVisit</a>(<span class="r195 r">visitor</span>);
            <b>return</b> <span class="r195 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#6f963589327835a4" class="k">this</a>, <span class="r196 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IParameterMetadataProvider implementation
 
        <b>bool</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#dea65be215e5a292" class="i method">HasAnyScriptBlockAttributes</a>()
        {
            <b>return</b> <a href="#a46b9537e8b363d2" class="i property">Attributes</a>.<span class="i">Count</span> &gt; 0 || <a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b> &amp;&amp; <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>.<span class="i">Count</span> &gt; 0;
        }
 
        <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#c8000536ef7797f3" class="i method">GetParameterMetadata</a>(<b>bool</b> <span id="r200 rd" class="r200 r">automaticPositions</span>, <b>ref bool</b> <span id="r201 rd" class="r201 r">usesCmdletBinding</span>)
        {
            <b>if</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="Compiler.cs.html#8ad349e7ea45c522" class="i method">GetParameterMetaData</a>(<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>, <span class="r200 r">automaticPositions</span>, <b>ref</b> <span class="r201 r">usesCmdletBinding</span>);
            }
 
            <b>return</b> <b>new</b> <a href="../PseudoParameters.cs.html#fe6fd05e3511357a" class="t constructor">RuntimeDefinedParameterDictionary</a> { <a href="../PseudoParameters.cs.html#188173533cedce98" class="i property">Data</a> = <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a>.<a href="../PseudoParameters.cs.html#8c8a683808508461" class="i field">EmptyParameterArray</a> };
        }
 
        <span class="i">IEnumerable</span>&lt;<span class="i">Attribute</span>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#5268a33bec21621c" class="i method">GetScriptBlockAttributes</a>()
        {
            <b>for</b> (<b>int</b> <span id="r202 rd" class="r202 r">index</span> = 0; <span class="r202 r">index</span> &lt; <a href="#a46b9537e8b363d2" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r202 r">index</span>++)
            {
                <b>var</b> <span id="r203 rd" class="r203 r">attributeAst</span> = <a href="#a46b9537e8b363d2" class="i property">Attributes</a>[<span class="r202 r">index</span>];
                <b>yield</b> <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">GetAttribute</span>(<span class="r203 r">attributeAst</span>);
            }
 
            <b>if</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r204 rd" class="r204 r">index</span> = 0; <span class="r204 r">index</span> &lt; <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r204 r">index</span>++)
                {
                    <b>var</b> <span id="r205 rd" class="r205 r">attributeAst</span> = <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>[<span class="r204 r">index</span>];
                    <b>yield</b> <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">GetAttribute</span>(<span class="r205 r">attributeAst</span>);
                }
            }
        }
 
        <span class="i">IEnumerable</span>&lt;<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#8aeaf9e21660f350" class="i method">GetExperimentalAttributes</a>()
        {
            <b>for</b> (<b>int</b> <span id="r206 rd" class="r206 r">index</span> = 0; <span class="r206 r">index</span> &lt; <a href="#a46b9537e8b363d2" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r206 r">index</span>++)
            {
                <a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r207 rd" class="r207 r">attributeAst</span> = <a href="#a46b9537e8b363d2" class="i property">Attributes</a>[<span class="r206 r">index</span>];
                <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a> <span id="r208 rd" class="r208 r">expAttr</span> = <a href="#225622736d4caf97" class="i method">GetExpAttributeHelper</a>(<span class="r207 r">attributeAst</span>);
                <b>if</b> (<span class="r208 r">expAttr</span> != <b>null</b>) { <b>yield</b> <b>return</b> <span class="r208 r">expAttr</span>; }
            }
 
            <b>if</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r209 rd" class="r209 r">index</span> = 0; <span class="r209 r">index</span> &lt; <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r209 r">index</span>++)
                {
                    <b>var</b> <span id="r210 rd" class="r210 r">attributeAst</span> = <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>[<span class="r209 r">index</span>];
                    <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="k">var</a> <span id="r211 rd" class="r211 r">expAttr</span> = <span class="i">GetExpAttributeHelper</span>(<span class="r210 r">attributeAst</span>);
                    <b>if</b> (<span class="r211 r">expAttr</span> != <b>null</b>) { <b>yield</b> <b>return</b> <span class="r211 r">expAttr</span>; }
                }
            }
 
            <b>static</b> <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a> <a id="225622736d4caf97" href="../../R/225622736d4caf97.html" target="n" data-glyph="76,2" class="i method">GetExpAttributeHelper</a>(<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r212 rd" class="r212 r">attributeAst</span>)
            {
                <a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r213 rd" class="r213 r">potentialExpAttr</span> = <b>null</b>;
                <b>string</b> <span id="r214 rd" class="r214 r">expAttrTypeName</span> = <b>typeof</b>(<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>).<span class="i">FullName</span>;
                <b>string</b> <span id="r215 rd" class="r215 r">attrAstTypeName</span> = <span class="r212 r">attributeAst</span>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="#d299e8e1674e18ab" class="i property">Name</a>;
 
                <b>if</b> (<a href="TypeResolver.cs.html#c299defb2b5f7804" class="t t">TypeAccelerators</a>.<a href="TypeResolver.cs.html#da69e644635c6f39" class="i property">Get</a>.<span class="i">TryGetValue</span>(<span class="r215 r">attrAstTypeName</span>, <b>out</b> <span class="i">Type</span> <span id="r216 rd" class="r216 r">attrType</span>) &amp;&amp; <span class="r216 r">attrType</span> == <b>typeof</b>(<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>))
                {
                    <span class="r213 r">potentialExpAttr</span> = <span class="r212 r">attributeAst</span>;
                }
                <b>else</b> <b>if</b> (<span class="r214 r">expAttrTypeName</span>.<span class="i">EndsWith</span>(<span class="r215 r">attrAstTypeName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// Handle two cases:</span>
                    <span class="c">//   1. declare the attribute using full type name;</span>
                    <span class="c">//   2. declare the attribute using partial type name due to &#39;using namespace&#39;.</span>
                    <b>int</b> <span id="r217 rd" class="r217 r">expAttrLength</span> = <span class="r214 r">expAttrTypeName</span>.<span class="i">Length</span>;
                    <b>int</b> <span id="r218 rd" class="r218 r">attrAstLength</span> = <span class="r215 r">attrAstTypeName</span>.<span class="i">Length</span>;
                    <b>if</b> (<span class="r217 r">expAttrLength</span> == <span class="r218 r">attrAstLength</span> || <span class="r214 r">expAttrTypeName</span>[<span class="r217 r">expAttrLength</span> - <span class="r218 r">attrAstLength</span> - 1] == <span class="s">&#39;.&#39;</span>)
                    {
                        <span class="r213 r">potentialExpAttr</span> = <span class="r212 r">attributeAst</span>;
                    }
                }
 
                <b>if</b> (<span class="r213 r">potentialExpAttr</span> != <b>null</b>)
                {
                    <b>try</b>
                    {
                        <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="Compiler.cs.html#cc9b80635c765212" class="i method">GetAttribute</a>(<span class="r213 r">potentialExpAttr</span>) <b>as</b> <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>;
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                        <span class="c">// catch all and assume it&#39;s not a declaration of ExperimentalAttribute</span>
                    }
                }
 
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#57fef4bbca7ab95c" class="i property">Parameters</a>
        {
            <b>get</b> { <b>return</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>) ? <a href="#6f963589327835a4" class="k">this</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a> : <b>null</b>; }
        }
 
        <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#b25d4ae40ae3a393" class="i property">Body</a> { <b>get</b> { <b>return</b> <a href="#6f963589327835a4" class="k">this</a>; } }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PowerShell Conversion
 
        <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#43e8e80a08c89ef8" class="i method">GetPowerShell</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r219 rd" class="r219 r">context</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r220 rd" class="r220 r">variables</span>, <b>bool</b> <span id="r221 rd" class="r221 r">isTrustedInput</span>,
            <b>bool</b> <span id="r222 rd" class="r222 r">filterNonUsingVariables</span>, <b>bool</b>? <span id="r223 rd" class="r223 r">createLocalScope</span>, <b>params object</b>[] <span id="r224 rd" class="r224 r">args</span>)
        {
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#3dcd207b1b77d402" class="i method">CheckStackDepth</a>();
            <b>return</b> <a href="../runtime/ScriptBlockToPowerShell.cs.html#a1edebc1e23d4bb8" class="t t">ScriptBlockToPowerShellConverter</a>.<a href="../runtime/ScriptBlockToPowerShell.cs.html#436ad3b875b6f173" class="i method">Convert</a>(<a href="#6f963589327835a4" class="k">this</a>, <b>null</b>, <span class="r221 r">isTrustedInput</span>, <span class="r219 r">context</span>, <span class="r220 r">variables</span>, <span class="r222 r">filterNonUsingVariables</span>, <span class="r223 r">createLocalScope</span>, <span class="r224 r">args</span>);
        }
 
        <b>string</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#9eb35ed25013c0ba" class="i method">GetWithInputHandlingForInvokeCommand</a>()
        {
            <b>return</b> <a href="#f2bbf5607f098faa" class="i method">GetWithInputHandlingForInvokeCommandImpl</a>(<b>null</b>);
        }
 
        <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#65bd5fb5ed6ed146" class="i method">GetWithInputHandlingForInvokeCommandWithUsingExpression</a>(
            <span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r225 rd" class="r225 r">usingVariablesTuple</span>)
        {
            <b>string</b> <span id="r226 rd" class="r226 r">additionalNewParams</span> = <span class="r225 r">usingVariablesTuple</span>.<span class="i">Item2</span>;
            <b>string</b> <span id="r227 rd" class="r227 r">scriptBlockText</span> = <a href="#f2bbf5607f098faa" class="i method">GetWithInputHandlingForInvokeCommandImpl</a>(<span class="r225 r">usingVariablesTuple</span>);
 
            <b>string</b> <span id="r228 rd" class="r228 r">paramText</span> = <b>null</b>;
            <b>if</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> == <b>null</b>)
            {
                <span class="r228 r">paramText</span> = <span class="s">&quot;param(&quot;</span> + <span class="r226 r">additionalNewParams</span> + <span class="s">&quot;)&quot;</span> + <span class="i">Environment</span>.<span class="i">NewLine</span>;
            }
 
            <b>return</b> <b>new</b> <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="r228 r">paramText</span>, <span class="r227 r">scriptBlockText</span>);
        }
 
        <b>private string</b> <a id="f2bbf5607f098faa" href="../../R/f2bbf5607f098faa.html" target="n" data-glyph="76,1" class="i method">GetWithInputHandlingForInvokeCommandImpl</a>(<span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r229 rd" class="r229 r">usingVariablesTuple</span>)
        {
            <span class="c">// do not add &quot;$input |&quot; to complex pipelines</span>
            <b>string</b> <span id="r230 rd" class="r230 r">unused1</span>;
            <b>string</b> <span id="r231 rd" class="r231 r">unused2</span>;
            <a href="#785915ec8547ce9f" class="k">var</a> <span id="r232 rd" class="r232 r">pipelineAst</span> = <a href="#c5ba04d06deeb4d5" class="i method">GetSimplePipeline</a>(<b>false</b>, <b>out</b> <span class="r230 r">unused1</span>, <b>out</b> <span class="r231 r">unused2</span>);
            <b>if</b> (<span class="r232 r">pipelineAst</span> == <b>null</b>)
            {
                <b>return</b> (<span class="r229 r">usingVariablesTuple</span> == <b>null</b>)
                    ? <a href="#6f963589327835a4" class="k">this</a>.<a href="#8753abaf002f9597" class="i method">ToStringForSerialization</a>()
                    : <a href="#6f963589327835a4" class="k">this</a>.<a href="#8a9e338706865ac2" class="i method">ToStringForSerialization</a>(<span class="r229 r">usingVariablesTuple</span>, <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>, <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>);
            }
 
            <span class="c">// do not add &quot;$input |&quot; to pipelines beginning with an expression</span>
            <b>if</b> (<span class="r232 r">pipelineAst</span>.<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>[0] <b>is</b> <a href="#f4da818a29387c5d" class="t t">CommandExpressionAst</a>)
            {
                <b>return</b> (<span class="r229 r">usingVariablesTuple</span> == <b>null</b>)
                    ? <a href="#6f963589327835a4" class="k">this</a>.<a href="#8753abaf002f9597" class="i method">ToStringForSerialization</a>()
                    : <a href="#6f963589327835a4" class="k">this</a>.<a href="#8a9e338706865ac2" class="i method">ToStringForSerialization</a>(<span class="r229 r">usingVariablesTuple</span>, <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>, <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>);
            }
 
            <span class="c">// do not add &quot;$input |&quot; to commands that reference $input in their arguments</span>
            <b>if</b> (<a href="AstVisitor.cs.html#5298c9a8d6287f90" class="t t">AstSearcher</a>.<a href="AstVisitor.cs.html#e53f8659ae77015d" class="i method">IsUsingDollarInput</a>(<a href="#6f963589327835a4" class="k">this</a>))
            {
                <b>return</b> (<span class="r229 r">usingVariablesTuple</span> == <b>null</b>)
                    ? <a href="#6f963589327835a4" class="k">this</a>.<a href="#8753abaf002f9597" class="i method">ToStringForSerialization</a>()
                    : <a href="#6f963589327835a4" class="k">this</a>.<a href="#8a9e338706865ac2" class="i method">ToStringForSerialization</a>(<span class="r229 r">usingVariablesTuple</span>, <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>, <a href="#6f963589327835a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>);
            }
 
            <span class="c">// all checks above failed - change script into &quot;$input | &lt;original script&gt;&quot;</span>
            <b>var</b> <span id="r233 rd" class="r233 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>if</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <b>string</b> <span id="r234 rd" class="r234 r">paramText</span> = (<span class="r229 r">usingVariablesTuple</span> == <b>null</b>)
                    ? <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#e8e96a43a76cce85" class="i method">ToString</a>()
                    : <a href="#6f963589327835a4" class="k">this</a>.<a href="#8a9e338706865ac2" class="i method">ToStringForSerialization</a>(<span class="r229 r">usingVariablesTuple</span>, <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>, <a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>);
                <span class="r233 r">sb</span>.<span class="i">Append</span>(<span class="r234 r">paramText</span>);
            }
 
            <span class="r233 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;$input |&quot;</span>);
            <b>string</b> <span id="r235 rd" class="r235 r">pipelineText</span> = (<span class="r229 r">usingVariablesTuple</span> == <b>null</b>)
                ? <span class="r232 r">pipelineAst</span>.<a href="#e8e96a43a76cce85" class="i method">ToString</a>()
                : <a href="#6f963589327835a4" class="k">this</a>.<a href="#8a9e338706865ac2" class="i method">ToStringForSerialization</a>(<span class="r229 r">usingVariablesTuple</span>, <span class="r232 r">pipelineAst</span>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>, <span class="r232 r">pipelineAst</span>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>);
            <span class="r233 r">sb</span>.<span class="i">Append</span>(<span class="r235 r">pipelineText</span>);
 
            <b>return</b> <span class="r233 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PowerShell Conversion
 
        <b>bool</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#960da0e2b7046796" class="i method">UsesCmdletBinding</a>()
        {
            <b>bool</b> <span id="r236 rd" class="r236 r">usesCmdletBinding</span> = <b>false</b>;
 
            <b>if</b> (<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <span class="r236 r">usesCmdletBinding</span> = <a href="#6f963589327835a4" class="k">this</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>.<span class="i">Any</span>(<b>static</b> <span id="r237 rd" class="r237 r">attribute</span> =&gt; <b>typeof</b>(<a href="../Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>) == <span class="r237 r">attribute</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionAttributeType</span>());
                <b>if</b> (!<span class="r236 r">usesCmdletBinding</span>)
                {
                    <span class="r236 r">usesCmdletBinding</span> = <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a>.<span class="i">UsesCmdletBinding</span>(<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>);
                }
            }
 
            <b>return</b> <span class="r236 r">usesCmdletBinding</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IParameterMetadataProvider implementation
 
        <b>internal</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a> <a id="c5ba04d06deeb4d5" href="../../R/c5ba04d06deeb4d5.html" target="n" data-glyph="74,1" class="i method">GetSimplePipeline</a>(<b>bool</b> <span id="r238 rd" class="r238 r">allowMultiplePipelines</span>, <b>out string</b> <span id="r239 rd" class="r239 r">errorId</span>, <b>out string</b> <span id="r240 rd" class="r240 r">errorMsg</span>)
        {
            <b>if</b> (<a href="#08794a618a2d04ac" class="i property">BeginBlock</a> != <b>null</b> || <a href="#8940fb8f9b3e6444" class="i property">ProcessBlock</a> != <b>null</b> || <a href="#4549d1761658a004" class="i property">DynamicParamBlock</a> != <b>null</b>)
            {
                <span class="r239 r">errorId</span> = <span class="s">&quot;CanConvertOneClauseOnly&quot;</span>;
                <span class="r240 r">errorMsg</span> = <span class="i">AutomationExceptions</span>.<span class="i">CanConvertOneClauseOnly</span>;
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<a href="#958e631868900aba" class="i property">EndBlock</a> == <b>null</b> || <a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a>.<span class="i">Count</span> &lt; 1)
            {
                <span class="r239 r">errorId</span> = <span class="s">&quot;CantConvertEmptyPipeline&quot;</span>;
                <span class="r240 r">errorMsg</span> = <span class="i">AutomationExceptions</span>.<span class="i">CantConvertEmptyPipeline</span>;
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#2b645ddd993169db" class="i property">Traps</a> != <b>null</b> &amp;&amp; <a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#2b645ddd993169db" class="i property">Traps</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r239 r">errorId</span> = <span class="s">&quot;CantConvertScriptBlockWithTrap&quot;</span>;
                <span class="r240 r">errorMsg</span> = <span class="i">AutomationExceptions</span>.<span class="i">CantConvertScriptBlockWithTrap</span>;
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// Make sure all statements are pipelines.</span>
            <b>if</b> (<a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a>.<span class="i">Any</span>(<span id="r241 rd" class="r241 r">ast</span> =&gt; <span class="r241 r">ast</span> <b>is not</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a>))
            {
                <span class="r239 r">errorId</span> = <span class="s">&quot;CanOnlyConvertOnePipeline&quot;</span>;
                <span class="r240 r">errorMsg</span> = <span class="i">AutomationExceptions</span>.<span class="i">CanOnlyConvertOnePipeline</span>;
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a>.<span class="i">Count</span> != 1 &amp;&amp; !<span class="r238 r">allowMultiplePipelines</span>)
            {
                <span class="r239 r">errorId</span> = <span class="s">&quot;CanOnlyConvertOnePipeline&quot;</span>;
                <span class="r240 r">errorMsg</span> = <span class="i">AutomationExceptions</span>.<span class="i">CanOnlyConvertOnePipeline</span>;
                <b>return</b> <b>null</b>;
            }
 
            <span class="r239 r">errorId</span> = <b>null</b>;
            <span class="r240 r">errorMsg</span> = <b>null</b>;
            <b>return</b> <a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a>[0] <b>as</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the param statement in a script block.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Param&quot;</span>)]
    <b>public class</b> <a id="be95362bdc5e7d07" href="../../R/be95362bdc5e7d07.html" target="n" data-glyph="0,0" class="t t">ParamBlockAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="c1c10317bff490a9" href="../../R/c1c10317bff490a9.html" target="n" data-glyph="46,1" class="i field">s_emptyAttributeList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
 
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="40967c2c56733050" href="../../R/40967c2c56733050.html" target="n" data-glyph="46,1" class="i field">s_emptyParameterList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct the ast for a param statement of a script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r242 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the param statement, from any possible attributes to the closing paren.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r243 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attributes (such as [cmdletbinding()]) specified on the param statement.  May be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r244 r">parameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The parameters to the script block.  May be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r242 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="292b52027e41f11c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ParamBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r242 rd" class="r242 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r243 rd" class="r243 r">attributes</span>, <span class="i">IEnumerable</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r244 rd" class="r244 r">parameters</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r242 r">extent</span>)
        {
            <b>if</b> (<span class="r243 r">attributes</span> != <b>null</b>)
            {
                <a href="#be95362bdc5e7d07" class="k">this</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(<span class="r243 r">attributes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>);
            }
            <b>else</b>
            {
                <a href="#be95362bdc5e7d07" class="k">this</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a> = <a href="#c1c10317bff490a9" class="i field">s_emptyAttributeList</a>;
            }
 
            <b>if</b> (<span class="r244 r">parameters</span> != <b>null</b>)
            {
                <a href="#be95362bdc5e7d07" class="k">this</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;(<span class="r244 r">parameters</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#ffac8f01ede94077" class="i property">Parameters</a>);
            }
            <b>else</b>
            {
                <a href="#be95362bdc5e7d07" class="k">this</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a> = <a href="#40967c2c56733050" class="i field">s_emptyParameterList</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for attributes (such as [cmdletbinding()]) used before the param keyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="2f9e902bfe8c2c10" href="../../R/2f9e902bfe8c2c10.html" target="n" data-glyph="102,1" class="i property">Attributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for the parameters of the param statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="ffac8f01ede94077" href="../../R/ffac8f01ede94077.html" target="n" data-glyph="102,1" class="i property">Parameters</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ParamBlockAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="3362b6c8d4cb7649" href="../../R/3362b6c8d4cb7649.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r245 rd" class="r245 r">newAttributes</span> = <span class="i">CopyElements</span>(<a href="#be95362bdc5e7d07" class="k">this</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>);
            <b>var</b> <span id="r246 rd" class="r246 r">newParameters</span> = <span class="i">CopyElements</span>(<a href="#be95362bdc5e7d07" class="k">this</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>);
            <b>return</b> <b>new</b> <span class="t">ParamBlockAst</span>(<a href="#be95362bdc5e7d07" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r245 r">newAttributes</span>, <span class="r246 r">newParameters</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="bc348c80a4335fcf" href="../../R/bc348c80a4335fcf.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r247 rd" class="r247 r">visitor</span>)
        {
            <b>return</b> <span class="r247 r">visitor</span>.<a href="AstVisitor.cs.html#864201e8e3e3d51a" class="i method">VisitParamBlock</a>(<a href="#be95362bdc5e7d07" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="5610f38d37fc216e" href="../../R/5610f38d37fc216e.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r248 rd" class="r248 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r249 rd" class="r249 r">action</span> = <span class="r248 r">visitor</span>.<a href="PreOrderVisitor.cs.html#422cff09ecc65fc8" class="i method">VisitParamBlock</a>(<a href="#be95362bdc5e7d07" class="k">this</a>);
            <b>if</b> (<span class="r249 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r248 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#be95362bdc5e7d07" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r249 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r250 rd" class="r250 r">index</span> = 0; <span class="r250 r">index</span> &lt; <a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r250 r">index</span>++)
                {
                    <b>var</b> <span id="r251 rd" class="r251 r">attributeAst</span> = <a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>[<span class="r250 r">index</span>];
                    <span class="r249 r">action</span> = <span class="r251 r">attributeAst</span>.<span class="i">InternalVisit</span>(<span class="r248 r">visitor</span>);
                    <b>if</b> (<span class="r249 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r249 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r252 rd" class="r252 r">index</span> = 0; <span class="r252 r">index</span> &lt; <a href="#ffac8f01ede94077" class="i property">Parameters</a>.<span class="i">Count</span>; <span class="r252 r">index</span>++)
                {
                    <b>var</b> <span id="r253 rd" class="r253 r">paramAst</span> = <a href="#ffac8f01ede94077" class="i property">Parameters</a>[<span class="r252 r">index</span>];
                    <span class="r249 r">action</span> = <span class="r253 r">paramAst</span>.<span class="i">InternalVisit</span>(<span class="r248 r">visitor</span>);
                    <b>if</b> (<span class="r249 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r248 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#be95362bdc5e7d07" class="k">this</a>, <span class="r249 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <b>internal static bool</b> <a id="ca4b13f518b0d4f8" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">UsesCmdletBinding</a>(<span class="i">IEnumerable</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r254 rd" class="r254 r">parameters</span>)
        {
            <b>bool</b> <span id="r255 rd" class="r255 r">usesCmdletBinding</span> = <b>false</b>;
            <b>foreach</b> (<b>var</b> <span id="r256 rd" class="r256 r">parameter</span> <b>in</b> <span class="r254 r">parameters</span>)
            {
                <span class="r255 r">usesCmdletBinding</span> = <span class="r256 r">parameter</span>.<span class="i">Attributes</span>.<span class="i">Any</span>(<span id="r257 rd" class="r257 r">attribute</span> =&gt; (<span class="r257 r">attribute</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionAttributeType</span>() != <b>null</b>) &amp;&amp;
                                                                          <span class="r257 r">attribute</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionAttributeType</span>() == <b>typeof</b>(<a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>));
                <b>if</b> (<span class="r255 r">usesCmdletBinding</span>)
                {
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r255 r">usesCmdletBinding</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a begin, process, end, or dynamicparam block in a scriptblock.  This ast is used even</span>
    <span class="c">///</span><span class="c"> when the block is unnamed, in which case the block is either an end block (for functions) or process block (for filters).</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="61c97c02c53bf32d" href="../../R/61c97c02c53bf32d.html" target="n" data-glyph="0,0" class="t t">NamedBlockAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct the ast for a begin, process, end, or dynamic param block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r258 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the block.  If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r259 r">unnamed</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is false, the extent includes</span>
        <span class="c">///</span><span class="c"> the keyword through the closing curly, otherwise the extent is the as the extent of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r260 r">statementBlock</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">blockName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The kind of block, must be one of:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">list</span> <span class="c">type</span><span class="c">=</span><span class="c">&quot;</span><span class="c">bullet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#21e2c9fe8b59b672" class="i field">Begin</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47d5893abf9a2fb2" class="i field">Dynamicparam</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r260 r">statementBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the statements in this named block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r259 r">unnamed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the block was not explicitly named.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r258 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r260 r">statementBlock</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">blockName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not one of the valid kinds for a named block,</span>
        <span class="c">///</span><span class="c"> or if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r259 r">unnamed</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">blockName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is neither</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> nor </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="96d8e19358d66e35" href="../../R/96d8e19358d66e35.html" target="n" data-glyph="72,1" class="t constructor">NamedBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r258 rd" class="r258 r">extent</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r261 rd" class="r261 r">blockName</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r260 rd" class="r260 r">statementBlock</span>, <b>bool</b> <span id="r259 rd" class="r259 r">unnamed</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r258 r">extent</span>)
        {
            <span class="c">// Validate the block name.  If the block is unnamed, it must be an End block (for a function)</span>
            <span class="c">// or Process block (for a filter).</span>
            <b>if</b> (!<span class="r261 r">blockName</span>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#387f851b946225c7" class="i field">ScriptBlockBlockName</a>)
                || (<span class="r259 r">unnamed</span> &amp;&amp; (<span class="r261 r">blockName</span> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#21e2c9fe8b59b672" class="i field">Begin</a> || <span class="r261 r">blockName</span> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47d5893abf9a2fb2" class="i field">Dynamicparam</a>)))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r261 r">blockName</span>));
            }
 
            <b>if</b> (<span class="r260 r">statementBlock</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r260 r">statementBlock</span>));
            }
 
            <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#4b76ccd3ee5695b7" class="i property">Unnamed</a> = <span class="r259 r">unnamed</span>;
            <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#aa5032ef2125a47e" class="i property">BlockKind</a> = <span class="r261 r">blockName</span>;
            <b>var</b> <span id="r262 rd" class="r262 r">statements</span> = <span class="r260 r">statementBlock</span>.<a href="#2d53956b12d128eb" class="i property">Statements</a>;
            <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a> = <span class="r262 r">statements</span>;
            <b>for</b> (<b>int</b> <span id="r263 rd" class="r263 r">index</span> = 0; <span class="r263 r">index</span> &lt; <span class="r262 r">statements</span>.<span class="i">Count</span>; <span class="r263 r">index</span>++)
            {
                <b>var</b> <span id="r264 rd" class="r264 r">stmt</span> = <span class="r262 r">statements</span>[<span class="r263 r">index</span>];
                <span class="r264 r">stmt</span>.<span class="i">ClearParent</span>();
            }
 
            <span class="i">SetParents</span>(<span class="r262 r">statements</span>);
 
            <b>var</b> <span id="r265 rd" class="r265 r">traps</span> = <span class="r260 r">statementBlock</span>.<a href="#8a3ec42ea63c1318" class="i property">Traps</a>;
            <b>if</b> (<span class="r265 r">traps</span> != <b>null</b> &amp;&amp; <span class="r265 r">traps</span>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#2b645ddd993169db" class="i property">Traps</a> = <span class="r265 r">traps</span>;
                <b>for</b> (<b>int</b> <span id="r266 rd" class="r266 r">index</span> = 0; <span class="r266 r">index</span> &lt; <span class="r265 r">traps</span>.<span class="i">Count</span>; <span class="r266 r">index</span>++)
                {
                    <b>var</b> <span id="r267 rd" class="r267 r">trap</span> = <span class="r265 r">traps</span>[<span class="r266 r">index</span>];
                    <span class="r267 r">trap</span>.<span class="i">ClearParent</span>();
                }
 
                <span class="i">SetParents</span>(<span class="r265 r">traps</span>);
            }
 
            <b>if</b> (!<span class="r259 r">unnamed</span>)
            {
                <a href="Position.cs.html#a988805453837004" class="k">var</a> <span id="r268 rd" class="r268 r">statementsExtent</span> = <span class="r260 r">statementBlock</span>.<a href="#d9d5cd324ee61136" class="i property">Extent</a> <b>as</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>;
                <b>if</b> (<span class="r268 r">statementsExtent</span> != <b>null</b>)
                {
                    <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#8ddb2aaad2172b52" class="i property">OpenCurlyExtent</a> = <b>new</b> <span class="t">InternalScriptExtent</span>(<span class="r268 r">statementsExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r268 r">statementsExtent</span>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>, <span class="r268 r">statementsExtent</span>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a> + 1);
                    <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#93f6b4a0e3e6cc04" class="i property">CloseCurlyExtent</a> = <b>new</b> <span class="t">InternalScriptExtent</span>(<span class="r268 r">statementsExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r268 r">statementsExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a> - 1, <span class="r268 r">statementsExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For a function/filter that did not explicitly name the end/process block (which is quite common),</span>
        <span class="c">///</span><span class="c"> this property will return true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4b76ccd3ee5695b7" href="../../R/4b76ccd3ee5695b7.html" target="n" data-glyph="102,1" class="i property">Unnamed</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The kind of block, always one of:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">list</span> <span class="c">type</span><span class="c">=</span><span class="c">&quot;</span><span class="c">bullet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#21e2c9fe8b59b672" class="i field">Begin</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">item</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47d5893abf9a2fb2" class="i field">Dynamicparam</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">item</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <a id="aa5032ef2125a47e" href="../../R/aa5032ef2125a47e.html" target="n" data-glyph="102,1" class="i property">BlockKind</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for all of the statements represented by this statement block.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <a id="496f71fcd5c4e6a1" href="../../R/496f71fcd5c4e6a1.html" target="n" data-glyph="102,1" class="i property">Statements</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for all of the trap statements specified by this statement block, or null if no trap statements were</span>
        <span class="c">///</span><span class="c"> specified in this block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <a id="2b645ddd993169db" href="../../R/2b645ddd993169db.html" target="n" data-glyph="102,1" class="i property">Traps</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the NamedBlockAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="1555d1993f61b92b" href="../../R/1555d1993f61b92b.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r269 rd" class="r269 r">newTraps</span> = <span class="i">CopyElements</span>(<a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#2b645ddd993169db" class="i property">Traps</a>);
            <b>var</b> <span id="r270 rd" class="r270 r">newStatements</span> = <span class="i">CopyElements</span>(<a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a>);
            <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r271 rd" class="r271 r">statementBlockExtent</span> = <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>;
 
            <b>if</b> (<a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#8ddb2aaad2172b52" class="i property">OpenCurlyExtent</a> != <b>null</b> &amp;&amp; <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#93f6b4a0e3e6cc04" class="i property">CloseCurlyExtent</a> != <b>null</b>)
            {
                <span class="c">// For explicitly named block, the Extent of the StatementBlockAst is not</span>
                <span class="c">// the same as the Extent of the NamedBlockAst. In this case, reconstruct</span>
                <span class="c">// the Extent of the StatementBlockAst from openExtent/closeExtent.</span>
                <a href="Position.cs.html#a988805453837004" class="k">var</a> <span id="r272 rd" class="r272 r">openExtent</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#8ddb2aaad2172b52" class="i property">OpenCurlyExtent</a>;
                <a href="Position.cs.html#a988805453837004" class="k">var</a> <span id="r273 rd" class="r273 r">closeExtent</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#93f6b4a0e3e6cc04" class="i property">CloseCurlyExtent</a>;
                <span class="r271 r">statementBlockExtent</span> = <b>new</b> <a href="Position.cs.html#0b34c128e3d218a0" class="t constructor">InternalScriptExtent</a>(<span class="r272 r">openExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r272 r">openExtent</span>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>, <span class="r273 r">closeExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a>);
            }
 
            <a href="#268644c84b225866" class="k">var</a> <span id="r274 rd" class="r274 r">statementBlock</span> = <b>new</b> <span class="t">StatementBlockAst</span>(<span class="r271 r">statementBlockExtent</span>, <span class="r270 r">newStatements</span>, <span class="r269 r">newTraps</span>);
            <b>return</b> <b>new</b> <a href="#96d8e19358d66e35" class="t constructor">NamedBlockAst</a>(<a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#aa5032ef2125a47e" class="i property">BlockKind</a>, <span class="r274 r">statementBlock</span>, <a href="#61c97c02c53bf32d" class="k">this</a>.<a href="#4b76ccd3ee5695b7" class="i property">Unnamed</a>);
        }
 
        <span class="c">// Used by the debugger for command breakpoints</span>
        <b>internal</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="8ddb2aaad2172b52" href="../../R/8ddb2aaad2172b52.html" target="n" data-glyph="104,1" class="i property">OpenCurlyExtent</a> { <b>get</b>; }
 
        <b>internal</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="93f6b4a0e3e6cc04" href="../../R/93f6b4a0e3e6cc04.html" target="n" data-glyph="104,1" class="i property">CloseCurlyExtent</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="86c7adf75f108f3e" href="../../R/86c7adf75f108f3e.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r275 rd" class="r275 r">visitor</span>)
        {
            <b>return</b> <span class="r275 r">visitor</span>.<a href="AstVisitor.cs.html#a79bbd82b90b8c44" class="i method">VisitNamedBlock</a>(<a href="#61c97c02c53bf32d" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d4ea6c30a7108195" href="../../R/d4ea6c30a7108195.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r276 rd" class="r276 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r277 rd" class="r277 r">action</span> = <span class="r276 r">visitor</span>.<a href="PreOrderVisitor.cs.html#73ce990e1fb9dca2" class="i method">VisitNamedBlock</a>(<a href="#61c97c02c53bf32d" class="k">this</a>);
            <b>if</b> (<span class="r277 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r276 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#61c97c02c53bf32d" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r277 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r277 r">action</span> = <a href="#268644c84b225866" class="t t">StatementBlockAst</a>.<a href="#e97d641fd893bf3f" class="i method">InternalVisit</a>(<span class="r276 r">visitor</span>, <a href="#2b645ddd993169db" class="i property">Traps</a>, <a href="#496f71fcd5c4e6a1" class="i property">Statements</a>, <span class="r277 r">action</span>);
            <b>return</b> <span class="r276 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#61c97c02c53bf32d" class="k">this</a>, <span class="r277 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a named attribute argument.  For example, in </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[Parameter(Mandatory=$true)]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, this ast</span>
    <span class="c">///</span><span class="c"> represents </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">Mandatory=$true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="283d46191e6456a4" href="../../R/283d46191e6456a4.html" target="n" data-glyph="0,0" class="t t">NamedAttributeArgumentAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct the ast for a named attribute argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r278 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the named attribute argument, starting with the name, ending with the expression, or if the expression</span>
        <span class="c">///</span><span class="c"> is omitted from the source, then ending at the end of the name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r279 r">argumentName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the argument specified.  May not be null or empty.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r280 r">argument</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The argument expression.  May not be null even if the expression is omitted from the source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r281 r">expressionOmitted</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when an explicit argument is not provided in the source, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[Parameter(Mandatory)]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.  In this case,</span>
        <span class="c">///</span><span class="c"> an ast for the argument expression must still be provided.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r278 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r279 r">argumentName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r280 r">argument</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null, or if</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r279 r">argumentName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is an empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="98717b4b553d59d3" href="../../R/98717b4b553d59d3.html" target="n" data-glyph="72,1" class="t constructor">NamedAttributeArgumentAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r278 rd" class="r278 r">extent</span>, <b>string</b> <span id="r279 rd" class="r279 r">argumentName</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r280 rd" class="r280 r">argument</span>, <b>bool</b> <span id="r281 rd" class="r281 r">expressionOmitted</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r278 r">extent</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r279 r">argumentName</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r279 r">argumentName</span>));
            }
 
            <b>if</b> (<span class="r280 r">argument</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r280 r">argument</span>));
            }
 
            <a href="#283d46191e6456a4" class="k">this</a>.<a href="#56d6eaafae98f8ee" class="i property">Argument</a> = <span class="r280 r">argument</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r280 r">argument</span>);
            <a href="#283d46191e6456a4" class="k">this</a>.<a href="#b9de8a2050ab7312" class="i property">ArgumentName</a> = <span class="r279 r">argumentName</span>;
            <a href="#283d46191e6456a4" class="k">this</a>.<a href="#14518954f554a70a" class="i property">ExpressionOmitted</a> = <span class="r281 r">expressionOmitted</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The named argument specified by this ast, is never null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b9de8a2050ab7312" href="../../R/b9de8a2050ab7312.html" target="n" data-glyph="102,1" class="i property">ArgumentName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast of the value of the argument specified by this ast.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="56d6eaafae98f8ee" href="../../R/56d6eaafae98f8ee.html" target="n" data-glyph="102,1" class="i property">Argument</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the source omitted an expression, this returns true, otherwise false.  This allows a caller to distinguish</span>
        <span class="c">///</span><span class="c"> the difference between </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[Parameter(Mandatory)]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[Parameter(Mandatory=$true)]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="14518954f554a70a" href="../../R/14518954f554a70a.html" target="n" data-glyph="102,1" class="i property">ExpressionOmitted</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the NamedAttributeArgumentAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="50e7e758d81995bb" href="../../R/50e7e758d81995bb.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r282 rd" class="r282 r">newArgument</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#283d46191e6456a4" class="k">this</a>.<a href="#56d6eaafae98f8ee" class="i property">Argument</a>);
            <b>return</b> <b>new</b> <a href="#98717b4b553d59d3" class="t constructor">NamedAttributeArgumentAst</a>(<a href="#283d46191e6456a4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#283d46191e6456a4" class="k">this</a>.<a href="#b9de8a2050ab7312" class="i property">ArgumentName</a>, <span class="r282 r">newArgument</span>, <a href="#283d46191e6456a4" class="k">this</a>.<a href="#14518954f554a70a" class="i property">ExpressionOmitted</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="1e55b26821f73f21" href="../../R/1e55b26821f73f21.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r283 rd" class="r283 r">visitor</span>)
        {
            <b>return</b> <span class="r283 r">visitor</span>.<a href="AstVisitor.cs.html#a6f7e9535bb920f3" class="i method">VisitNamedAttributeArgument</a>(<a href="#283d46191e6456a4" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="ce537253843fbae9" href="../../R/ce537253843fbae9.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r284 rd" class="r284 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r285 rd" class="r285 r">action</span> = <span class="r284 r">visitor</span>.<a href="PreOrderVisitor.cs.html#d4998213fcb6eef2" class="i method">VisitNamedAttributeArgument</a>(<a href="#283d46191e6456a4" class="k">this</a>);
            <b>if</b> (<span class="r285 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r284 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#283d46191e6456a4" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r285 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r285 r">action</span> = <a href="#56d6eaafae98f8ee" class="i property">Argument</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r284 r">visitor</span>);
            <b>return</b> <span class="r284 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#283d46191e6456a4" class="k">this</a>, <span class="r285 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class representing attributes that accept optional arguments, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[Parameter()]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, as well as</span>
    <span class="c">///</span><span class="c"> type constraints, such as </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[int]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="35c989f6a7b4eace" href="../../R/35c989f6a7b4eace.html" target="n" data-glyph="0,0" class="t t">AttributeBaseAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common fields for an attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r286 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the attribute, from the opening &#39;[&#39; to the closing &#39;]&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r287 r">typeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type named by the attribute.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r286 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r287 r">typeName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="0dee8b2efc800326" href="../../R/0dee8b2efc800326.html" target="n" data-glyph="75,1" class="t constructor">AttributeBaseAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r286 rd" class="r286 r">extent</span>, <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r287 rd" class="r287 r">typeName</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r286 r">extent</span>)
        {
            <b>if</b> (<span class="r287 r">typeName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r287 r">typeName</span>));
            }
 
            <a href="#35c989f6a7b4eace" class="k">this</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a> = <span class="r287 r">typeName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type name for the attribute.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="eae1f2f74db44d11" href="../../R/eae1f2f74db44d11.html" target="n" data-glyph="102,1" class="i property">TypeName</a> { <b>get</b>; }
 
        <b>internal abstract</b> <span class="i">Attribute</span> <a id="4335717fad9e152b" href="../../R/4335717fad9e152b.html" target="n" data-glyph="74,1" class="i method">GetAttribute</a>();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing an attribute with optional positional and named arguments.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="f576d1d6cbb736a0" href="../../R/f576d1d6cbb736a0.html" target="n" data-glyph="0,0" class="t t">AttributeAst</a> : <a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="82683fa8f2fd0e22" href="../../R/82683fa8f2fd0e22.html" target="n" data-glyph="46,1" class="i field">s_emptyPositionalArguments</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
 
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt; <a id="d355c66d4d60e139" href="../../R/d355c66d4d60e139.html" target="n" data-glyph="46,1" class="i field">s_emptyNamedAttributeArguments</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an attribute ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the attribute from opening &#39;[&#39; to closing &#39;]&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r289 r">namedArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The named arguments, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r290 r">positionalArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The positional arguments, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r291 r">typeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attribute name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r291 r">typeName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="6e9436b8cfc16d34" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">AttributeAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r288 rd" class="r288 r">extent</span>,
                            <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r291 rd" class="r291 r">typeName</span>,
                            <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r290 rd" class="r290 r">positionalArguments</span>,
                            <span class="i">IEnumerable</span>&lt;<a href="#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt; <span id="r289 rd" class="r289 r">namedArguments</span>)
            : <a href="#0dee8b2efc800326" class="k">base</a>(<span class="r288 r">extent</span>, <span class="r291 r">typeName</span>)
        {
            <b>if</b> (<span class="r290 r">positionalArguments</span> != <b>null</b>)
            {
                <a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#0ad84283990f3553" class="i property">PositionalArguments</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;(<span class="r290 r">positionalArguments</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#0ad84283990f3553" class="i property">PositionalArguments</a>);
            }
            <b>else</b>
            {
                <a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#0ad84283990f3553" class="i property">PositionalArguments</a> = <a href="#82683fa8f2fd0e22" class="i field">s_emptyPositionalArguments</a>;
            }
 
            <b>if</b> (<span class="r289 r">namedArguments</span> != <b>null</b>)
            {
                <a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#6bb710ef7b74106a" class="i property">NamedArguments</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt;(<span class="r289 r">namedArguments</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#6bb710ef7b74106a" class="i property">NamedArguments</a>);
            }
            <b>else</b>
            {
                <a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#6bb710ef7b74106a" class="i property">NamedArguments</a> = <a href="#d355c66d4d60e139" class="i field">s_emptyNamedAttributeArguments</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for the attribute arguments specified positionally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="0ad84283990f3553" href="../../R/0ad84283990f3553.html" target="n" data-glyph="102,1" class="i property">PositionalArguments</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for the named attribute arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt; <a id="6bb710ef7b74106a" href="../../R/6bb710ef7b74106a.html" target="n" data-glyph="102,1" class="i property">NamedArguments</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the AttributeAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="6828184566b7a7b2" href="../../R/6828184566b7a7b2.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r292 rd" class="r292 r">newPositionalArguments</span> = <span class="i">CopyElements</span>(<a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#0ad84283990f3553" class="i property">PositionalArguments</a>);
            <b>var</b> <span id="r293 rd" class="r293 r">newNamedArguments</span> = <span class="i">CopyElements</span>(<a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#6bb710ef7b74106a" class="i property">NamedArguments</a>);
            <b>return</b> <b>new</b> <span class="t">AttributeAst</span>(<a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#f576d1d6cbb736a0" class="k">this</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>, <span class="r292 r">newPositionalArguments</span>, <span class="r293 r">newNamedArguments</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="06730ea08bbdafc9" href="../../R/06730ea08bbdafc9.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r294 rd" class="r294 r">visitor</span>)
        {
            <b>return</b> <span class="r294 r">visitor</span>.<a href="AstVisitor.cs.html#23d9e205ba300a14" class="i method">VisitAttribute</a>(<a href="#f576d1d6cbb736a0" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="32172b0000ca9323" href="../../R/32172b0000ca9323.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r295 rd" class="r295 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r296 rd" class="r296 r">action</span> = <span class="r295 r">visitor</span>.<a href="PreOrderVisitor.cs.html#50902d16629f393e" class="i method">VisitAttribute</a>(<a href="#f576d1d6cbb736a0" class="k">this</a>);
            <b>if</b> (<span class="r296 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r295 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f576d1d6cbb736a0" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r296 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r297 rd" class="r297 r">index</span> = 0; <span class="r297 r">index</span> &lt; <a href="#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>; <span class="r297 r">index</span>++)
                {
                    <b>var</b> <span id="r298 rd" class="r298 r">expressionAst</span> = <a href="#0ad84283990f3553" class="i property">PositionalArguments</a>[<span class="r297 r">index</span>];
                    <span class="r296 r">action</span> = <span class="r298 r">expressionAst</span>.<span class="i">InternalVisit</span>(<span class="r295 r">visitor</span>);
                    <b>if</b> (<span class="r296 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r296 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r299 rd" class="r299 r">index</span> = 0; <span class="r299 r">index</span> &lt; <a href="#6bb710ef7b74106a" class="i property">NamedArguments</a>.<span class="i">Count</span>; <span class="r299 r">index</span>++)
                {
                    <b>var</b> <span id="r300 rd" class="r300 r">namedAttributeArgumentAst</span> = <a href="#6bb710ef7b74106a" class="i property">NamedArguments</a>[<span class="r299 r">index</span>];
                    <span class="r296 r">action</span> = <span class="r300 r">namedAttributeArgumentAst</span>.<span class="i">InternalVisit</span>(<span class="r295 r">visitor</span>);
                    <b>if</b> (<span class="r296 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r295 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f576d1d6cbb736a0" class="k">this</a>, <span class="r296 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <b>internal override</b> <span class="i">Attribute</span> <a id="87df005a4595a132" href="../../R/87df005a4595a132.html" target="n" data-glyph="74,1" class="i method">GetAttribute</a>()
        {
            <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="Compiler.cs.html#cc9b80635c765212" class="i method">GetAttribute</a>(<a href="#f576d1d6cbb736a0" class="k">this</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a type constraint, which is simply a typename with no arguments.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="34b9d5dbbaca964d" href="../../R/34b9d5dbbaca964d.html" target="n" data-glyph="0,0" class="t t">TypeConstraintAst</a> : <a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a type constraint from a possibly not yet resolved typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r301 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the constraint, from the opening &#39;[&#39; to the closing &#39;]&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r302 r">typeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type for the constraint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r301 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r302 r">typeName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="51c2fb9bdf674fb1" href="../../R/51c2fb9bdf674fb1.html" target="n" data-glyph="72,1" class="t constructor">TypeConstraintAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r301 rd" class="r301 r">extent</span>, <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r302 rd" class="r302 r">typeName</span>)
            : <a href="#0dee8b2efc800326" class="k">base</a>(<span class="r301 r">extent</span>, <span class="r302 r">typeName</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a type constraint from a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r303 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the constraint, from the opening &#39;[&#39; to the closing &#39;]&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type for the constraint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r303 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="4b063073ca7bf963" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">TypeConstraintAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r303 rd" class="r303 r">extent</span>, <span class="i">Type</span> <span id="r304 rd" class="r304 r">type</span>)
            : <a href="#0dee8b2efc800326" class="k">base</a>(<span class="r303 r">extent</span>, <b>new</b> <a href="#0ebf85aaf186500c" class="t constructor">ReflectionTypeName</a>(<span class="r304 r">type</span>))
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the TypeConstraintAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="831acc9878fed4c5" href="../../R/831acc9878fed4c5.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#51c2fb9bdf674fb1" class="t constructor">TypeConstraintAst</a>(<a href="#34b9d5dbbaca964d" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#34b9d5dbbaca964d" class="k">this</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="fdc717168966a66c" href="../../R/fdc717168966a66c.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r305 rd" class="r305 r">visitor</span>)
        {
            <b>return</b> <span class="r305 r">visitor</span>.<a href="AstVisitor.cs.html#a941e94302011695" class="i method">VisitTypeConstraint</a>(<a href="#34b9d5dbbaca964d" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="fda3411c37051037" href="../../R/fda3411c37051037.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r306 rd" class="r306 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r307 rd" class="r307 r">action</span> = <span class="r306 r">visitor</span>.<a href="PreOrderVisitor.cs.html#1dcc57320c0ffbe3" class="i method">VisitTypeConstraint</a>(<a href="#34b9d5dbbaca964d" class="k">this</a>);
            <b>return</b> <span class="r306 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#34b9d5dbbaca964d" class="k">this</a>, <span class="r307 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> ? <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> : <span class="r307 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <b>internal override</b> <span class="i">Attribute</span> <a id="f6600a8387d816aa" href="../../R/f6600a8387d816aa.html" target="n" data-glyph="74,1" class="i method">GetAttribute</a>()
        {
            <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="Compiler.cs.html#c75a25cfd3c34811" class="i method">GetAttribute</a>(<a href="#34b9d5dbbaca964d" class="k">this</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a parameter to a script.  Parameters may appear in one of 2 places, either just after the</span>
    <span class="c">///</span><span class="c"> name of the function, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">function foo($a){}</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or in a param statement, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">param($a)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="bf2a2797225b11b5" href="../../R/bf2a2797225b11b5.html" target="n" data-glyph="0,0" class="t t">ParameterAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <a id="878d78018b9cf586" href="../../R/878d78018b9cf586.html" target="n" data-glyph="46,1" class="i field">s_emptyAttributeList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a parameter ast from the name, attributes, and default value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the parameter, including the attributes and default if specified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r309 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r310 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attributes, or null if no attributes were specified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r311 r">defaultValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The default value of the parameter, or null if no default value was specified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r309 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="d98d448baf106f8c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ParameterAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r308 rd" class="r308 r">extent</span>,
                            <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r309 rd" class="r309 r">name</span>,
                            <span class="i">IEnumerable</span>&lt;<a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r310 rd" class="r310 r">attributes</span>,
                            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r311 rd" class="r311 r">defaultValue</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r308 r">extent</span>)
        {
            <b>if</b> (<span class="r309 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r309 r">name</span>));
            }
 
            <b>if</b> (<span class="r310 r">attributes</span> != <b>null</b>)
            {
                <a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt;(<span class="r310 r">attributes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a>);
            }
            <b>else</b>
            {
                <a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a> = <a href="#878d78018b9cf586" class="i field">s_emptyAttributeList</a>;
            }
 
            <a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#ba2fe0223eb09f0d" class="i property">Name</a> = <span class="r309 r">name</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r309 r">name</span>);
            <b>if</b> (<span class="r311 r">defaultValue</span> != <b>null</b>)
            {
                <a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#d0773d8161160fae" class="i property">DefaultValue</a> = <span class="r311 r">defaultValue</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r311 r">defaultValue</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for any attributes or type constraints specified on the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <a id="5f4fbe2ccc8004ce" href="../../R/5f4fbe2ccc8004ce.html" target="n" data-glyph="102,1" class="i property">Attributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The variable path for the parameter.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <a id="ba2fe0223eb09f0d" href="../../R/ba2fe0223eb09f0d.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the default value of the parameter, or null if no default value was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="d0773d8161160fae" href="../../R/d0773d8161160fae.html" target="n" data-glyph="102,1" class="i property">DefaultValue</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the type of the parameter.  If the parameter is constrained to be a specific type, that type is returned,</span>
        <span class="c">///</span><span class="c"> otherwise </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(object)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> is returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="a41281d1e358ea79" href="../../R/a41281d1e358ea79.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b>
            {
                <span class="i">Type</span> <span id="r312 rd" class="r312 r">type</span> = <b>null</b>;
                <b>var</b> <span id="r313 rd" class="r313 r">typeConstraint</span> = <a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a>.<span class="i">OfType</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;().<span class="i">FirstOrDefault</span>();
                <b>if</b> (<span class="r313 r">typeConstraint</span> != <b>null</b>)
                {
                    <span class="r312 r">type</span> = <span class="r313 r">typeConstraint</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionType</span>();
                }
 
                <b>return</b> <span class="r312 r">type</span> ?? <b>typeof</b>(<b>object</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ParameterAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="2d8368cd66239c9c" href="../../R/2d8368cd66239c9c.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#248562b22b336dec" class="k">var</a> <span id="r314 rd" class="r314 r">newName</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#ba2fe0223eb09f0d" class="i property">Name</a>);
            <b>var</b> <span id="r315 rd" class="r315 r">newAttributes</span> = <span class="i">CopyElements</span>(<a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a>);
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r316 rd" class="r316 r">newDefaultValue</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#d0773d8161160fae" class="i property">DefaultValue</a>);
            <b>return</b> <b>new</b> <span class="t">ParameterAst</span>(<a href="#bf2a2797225b11b5" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r314 r">newName</span>, <span class="r315 r">newAttributes</span>, <span class="r316 r">newDefaultValue</span>);
        }
 
        <b>internal string</b> <a id="0ba621637c9074e7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetTooltip</a>()
        {
            <b>var</b> <span id="r317 rd" class="r317 r">typeConstraint</span> = <a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a>.<span class="i">OfType</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;().<span class="i">FirstOrDefault</span>();
            <b>var</b> <span id="r318 rd" class="r318 r">type</span> = <span class="r317 r">typeConstraint</span> != <b>null</b> ? <span class="r317 r">typeConstraint</span>.<span class="i">TypeName</span>.<span class="i">FullName</span> : <span class="s">&quot;object&quot;</span>;
            <b>return</b> <span class="r318 r">type</span> + <span class="s">&quot; &quot;</span> + <a href="#ba2fe0223eb09f0d" class="i property">Name</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the text that represents this ParameterAst based on the $using variables passed in.</span>
        <span class="c">///</span><span class="c"> A parameter name cannot be a using variable, but its default value could contain any number of UsingExpressions, for example:</span>
        <span class="c">///</span><span class="c">     function bar ($x = (Get-X @using:defaultSettings.Parameters)) { ... }</span>
        <span class="c">///</span><span class="c"> This method goes through the ParameterAst text and replace each $using variable with its new synthetic name (remove the $using prefix).</span>
        <span class="c">///</span><span class="c"> This method is used when we call Invoke-Command targeting a PSv2 remote machine. In that case, we might need to call this method</span>
        <span class="c">///</span><span class="c"> to process the script block text, since $using prefix cannot be recognized by PSv2.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">orderedUsingVar</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A sorted enumerator of using variable asts, ascendingly sorted based on StartOffSet.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The text of the ParameterAst with $using variable being replaced with a new variable name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="3792aa098484856b" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetParamTextWithDollarUsingHandling</a>(<span class="i">IEnumerator</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt; <span id="r319 rd" class="r319 r">orderedUsingVar</span>)
        {
            <b>int</b> <span id="r320 rd" class="r320 r">indexOffset</span> = <a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>;
            <b>int</b> <span id="r321 rd" class="r321 r">startOffset</span> = 0;
            <b>int</b> <span id="r322 rd" class="r322 r">endOffset</span> = <a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a> - <a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>;
 
            <b>string</b> <span id="r323 rd" class="r323 r">paramText</span> = <a href="#e8e96a43a76cce85" class="i method">ToString</a>();
            <b>if</b> (<span class="r319 r">orderedUsingVar</span>.<span class="i">Current</span> == <b>null</b> &amp;&amp; !<span class="r319 r">orderedUsingVar</span>.<span class="i">MoveNext</span>())
            {
                <b>return</b> <span class="r323 r">paramText</span>;
            }
 
            <b>var</b> <span id="r324 rd" class="r324 r">newParamText</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>do</b>
            {
                <b>var</b> <span id="r325 rd" class="r325 r">varAst</span> = <span class="r319 r">orderedUsingVar</span>.<span class="i">Current</span>;
                <b>int</b> <span id="r326 rd" class="r326 r">astStartOffset</span> = <span class="r325 r">varAst</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span> - <span class="r320 r">indexOffset</span>;
                <b>int</b> <span id="r327 rd" class="r327 r">astEndOffset</span> = <span class="r325 r">varAst</span>.<span class="i">Extent</span>.<span class="i">EndOffset</span> - <span class="r320 r">indexOffset</span>;
 
                <span class="c">// Skip the VariableAst that is before section we care about</span>
                <b>if</b> (<span class="r326 r">astStartOffset</span> &lt; <span class="r321 r">startOffset</span>) { <b>continue</b>; }
                <span class="c">// We are done processing the current ParameterAst</span>
                <b>if</b> (<span class="r326 r">astStartOffset</span> &gt;= <span class="r322 r">endOffset</span>) { <b>break</b>; }
 
                <b>string</b> <span id="r328 rd" class="r328 r">varName</span> = <span class="r325 r">varAst</span>.<span class="i">VariablePath</span>.<span class="i">UserPath</span>;
                <b>string</b> <span id="r329 rd" class="r329 r">varSign</span> = <span class="r325 r">varAst</span>.<span class="i">Splatted</span> ? <span class="s">&quot;@&quot;</span> : <span class="s">&quot;$&quot;</span>;
                <b>string</b> <span id="r330 rd" class="r330 r">newVarName</span> = <span class="r329 r">varSign</span> + <a href="#42d36b88817a807f" class="t t">UsingExpressionAst</a>.<a href="#3331acd12e22a1c8" class="i field">UsingPrefix</a> + <span class="r328 r">varName</span>;
 
                <span class="r324 r">newParamText</span>.<span class="i">Append</span>(<span class="r323 r">paramText</span>.<span class="i">AsSpan</span>(<span class="r321 r">startOffset</span>, <span class="r326 r">astStartOffset</span> - <span class="r321 r">startOffset</span>));
                <span class="r324 r">newParamText</span>.<span class="i">Append</span>(<span class="r330 r">newVarName</span>);
                <span class="r321 r">startOffset</span> = <span class="r327 r">astEndOffset</span>;
            } <b>while</b> (<span class="r319 r">orderedUsingVar</span>.<span class="i">MoveNext</span>());
 
            <b>if</b> (<span class="r321 r">startOffset</span> == 0)
            {
                <span class="c">// Nothing changed within the ParameterAst text</span>
                <b>return</b> <span class="r323 r">paramText</span>;
            }
 
            <span class="r324 r">newParamText</span>.<span class="i">Append</span>(<span class="r323 r">paramText</span>.<span class="i">AsSpan</span>(<span class="r321 r">startOffset</span>, <span class="r322 r">endOffset</span> - <span class="r321 r">startOffset</span>));
            <b>return</b> <span class="r324 r">newParamText</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="72869f3627d96dbe" href="../../R/72869f3627d96dbe.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r331 rd" class="r331 r">visitor</span>)
        {
            <b>return</b> <span class="r331 r">visitor</span>.<a href="AstVisitor.cs.html#1be4368098e35028" class="i method">VisitParameter</a>(<a href="#bf2a2797225b11b5" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="ac9cf04ee7d28f38" href="../../R/ac9cf04ee7d28f38.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r332 rd" class="r332 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r333 rd" class="r333 r">action</span> = <span class="r332 r">visitor</span>.<a href="PreOrderVisitor.cs.html#cb7cd5dd3c15477d" class="i method">VisitParameter</a>(<a href="#bf2a2797225b11b5" class="k">this</a>);
            <b>if</b> (<span class="r333 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r332 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#bf2a2797225b11b5" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r333 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r334 rd" class="r334 r">index</span> = 0; <span class="r334 r">index</span> &lt; <a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r334 r">index</span>++)
                {
                    <b>var</b> <span id="r335 rd" class="r335 r">attributeAst</span> = <a href="#5f4fbe2ccc8004ce" class="i property">Attributes</a>[<span class="r334 r">index</span>];
                    <span class="r333 r">action</span> = <span class="r335 r">attributeAst</span>.<span class="i">InternalVisit</span>(<span class="r332 r">visitor</span>);
                    <b>if</b> (<span class="r333 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r333 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r333 r">action</span> = <a href="#ba2fe0223eb09f0d" class="i property">Name</a>.<a href="#f6111212a2587de2" class="i method">InternalVisit</a>(<span class="r332 r">visitor</span>);
            }
 
            <b>if</b> (<span class="r333 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#d0773d8161160fae" class="i property">DefaultValue</a> != <b>null</b>)
            {
                <span class="r333 r">action</span> = <a href="#d0773d8161160fae" class="i property">DefaultValue</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r332 r">visitor</span>);
            }
 
            <b>return</b> <span class="r332 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#bf2a2797225b11b5" class="k">this</a>, <span class="r333 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Script Blocks
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Statements
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a block of statements.  The block of statements could be part of a script block or some other</span>
    <span class="c">///</span><span class="c"> statement such as an if statement or while statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="268644c84b225866" href="../../R/268644c84b225866.html" target="n" data-glyph="0,0" class="t t">StatementBlockAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <a id="970ce002cbf69ffc" href="../../R/970ce002cbf69ffc.html" target="n" data-glyph="46,1" class="i field">s_emptyStatementCollection</a> = <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a statement block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r336 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement block.  If curly braces are part of the statement block (and</span>
        <span class="c">///</span><span class="c"> not some other ast like in a script block), then the curly braces are included in the extent, otherwise the</span>
        <span class="c">///</span><span class="c"> extent runs from the first statement or trap to the last statement or trap.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r337 r">statements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The (possibly null) collection of statements.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r338 r">traps</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The (possibly null) collection of trap statements.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r336 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="843ddfcdc5cdf1a3" href="../../R/843ddfcdc5cdf1a3.html" target="n" data-glyph="72,1" class="t constructor">StatementBlockAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r336 rd" class="r336 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r337 rd" class="r337 r">statements</span>, <span class="i">IEnumerable</span>&lt;<a href="#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r338 rd" class="r338 r">traps</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r336 r">extent</span>)
        {
            <b>if</b> (<span class="r337 r">statements</span> != <b>null</b>)
            {
                <a href="#268644c84b225866" class="k">this</a>.<a href="#2d53956b12d128eb" class="i property">Statements</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;(<span class="r337 r">statements</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#2d53956b12d128eb" class="i property">Statements</a>);
            }
            <b>else</b>
            {
                <a href="#268644c84b225866" class="k">this</a>.<a href="#2d53956b12d128eb" class="i property">Statements</a> = <a href="#970ce002cbf69ffc" class="i field">s_emptyStatementCollection</a>;
            }
 
            <b>if</b> (<span class="r338 r">traps</span> != <b>null</b> &amp;&amp; <span class="r338 r">traps</span>.<span class="i">Any</span>())
            {
                <a href="#268644c84b225866" class="k">this</a>.<a href="#8a3ec42ea63c1318" class="i property">Traps</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt;(<span class="r338 r">traps</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#8a3ec42ea63c1318" class="i property">Traps</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for all of the statements represented by this statement block.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <a id="2d53956b12d128eb" href="../../R/2d53956b12d128eb.html" target="n" data-glyph="102,1" class="i property">Statements</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for all of the trap statements specified by this statement block, or null if no trap statements were</span>
        <span class="c">///</span><span class="c"> specified in this block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <a id="8a3ec42ea63c1318" href="../../R/8a3ec42ea63c1318.html" target="n" data-glyph="102,1" class="i property">Traps</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the StatementBlockAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="e10774814b02a138" href="../../R/e10774814b02a138.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r339 rd" class="r339 r">newStatements</span> = <span class="i">CopyElements</span>(<a href="#268644c84b225866" class="k">this</a>.<a href="#2d53956b12d128eb" class="i property">Statements</a>);
            <b>var</b> <span id="r340 rd" class="r340 r">newTraps</span> = <span class="i">CopyElements</span>(<a href="#268644c84b225866" class="k">this</a>.<a href="#8a3ec42ea63c1318" class="i property">Traps</a>);
 
            <b>return</b> <b>new</b> <span class="t">StatementBlockAst</span>(<a href="#268644c84b225866" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r339 r">newStatements</span>, <span class="r340 r">newTraps</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="320e0abd734f9b5f" href="../../R/320e0abd734f9b5f.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r341 rd" class="r341 r">visitor</span>)
        {
            <b>return</b> <span class="r341 r">visitor</span>.<a href="AstVisitor.cs.html#8d89a04736f2e235" class="i method">VisitStatementBlock</a>(<a href="#268644c84b225866" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="21211804510b17d0" href="../../R/21211804510b17d0.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r342 rd" class="r342 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r343 rd" class="r343 r">action</span> = <span class="r342 r">visitor</span>.<a href="PreOrderVisitor.cs.html#5740ff1e3ada8689" class="i method">VisitStatementBlock</a>(<a href="#268644c84b225866" class="k">this</a>);
            <b>return</b> <span class="r342 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#268644c84b225866" class="k">this</a>, <a href="#e97d641fd893bf3f" class="i method">InternalVisit</a>(<span class="r342 r">visitor</span>, <a href="#8a3ec42ea63c1318" class="i property">Traps</a>, <a href="#2d53956b12d128eb" class="i property">Statements</a>, <span class="r343 r">action</span>));
        }
 
        <b>internal static</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e97d641fd893bf3f" href="../../R/e97d641fd893bf3f.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r344 rd" class="r344 r">visitor</span>,
                                                     <span class="i">ReadOnlyCollection</span>&lt;<a href="#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r345 rd" class="r345 r">traps</span>,
                                                     <span class="i">ReadOnlyCollection</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r346 rd" class="r346 r">statements</span>,
                                                     <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <span id="r347 rd" class="r347 r">action</span>)
        {
            <b>if</b> (<span class="r347 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
 
            <b>if</b> (<span class="r347 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <span class="r345 r">traps</span> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r348 rd" class="r348 r">index</span> = 0; <span class="r348 r">index</span> &lt; <span class="r345 r">traps</span>.<span class="i">Count</span>; <span class="r348 r">index</span>++)
                {
                    <b>var</b> <span id="r349 rd" class="r349 r">trapAst</span> = <span class="r345 r">traps</span>[<span class="r348 r">index</span>];
                    <span class="r347 r">action</span> = <span class="r349 r">trapAst</span>.<span class="i">InternalVisit</span>(<span class="r344 r">visitor</span>);
                    <b>if</b> (<span class="r347 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r347 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <span class="r346 r">statements</span> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r350 rd" class="r350 r">index</span> = 0; <span class="r350 r">index</span> &lt; <span class="r346 r">statements</span>.<span class="i">Count</span>; <span class="r350 r">index</span>++)
                {
                    <b>var</b> <span id="r351 rd" class="r351 r">statementAst</span> = <span class="r346 r">statements</span>[<span class="r350 r">index</span>];
                    <span class="r347 r">action</span> = <span class="r351 r">statementAst</span>.<span class="i">InternalVisit</span>(<span class="r344 r">visitor</span>);
                    <b>if</b> (<span class="r347 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r347 r">action</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class for any statement like an if statement or while statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="9c25dfdd7f4807b0" href="../../R/9c25dfdd7f4807b0.html" target="n" data-glyph="0,0" class="t t">StatementAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common fields of a statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r352 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r352 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="e1bbf1b8e63bd89f" href="../../R/e1bbf1b8e63bd89f.html" target="n" data-glyph="75,1" class="t constructor">StatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r352 rd" class="r352 r">extent</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r352 r">extent</span>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Specifies type attributes.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="b246aec2982cbe0e" href="../../R/b246aec2982cbe0e.html" target="n" data-glyph="18,0" class="t t"><span id="ff9a99a50d965929">TypeAttributes</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">No attributes specified.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e1fe6221d064d909" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x00,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The type specifies a class.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d60e921be64513ed" href="../../R/d60e921be64513ed.html" target="n" data-glyph="24,1" class="i field">Class</a> = 0x01,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The type specifies an interface.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c97c681c86ae931e" href="../../R/c97c681c86ae931e.html" target="n" data-glyph="24,1" class="i field">Interface</a> = 0x02,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The type specifies an enum.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ed298c43d5bc1d4b" href="../../R/ed298c43d5bc1d4b.html" target="n" data-glyph="24,1" class="i field">Enum</a> = 0x04,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a type definition including attributes, base class and</span>
    <span class="c">///</span><span class="c"> implemented interfaces, plus it&#39;s members.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="d7f0bc21c0f10879" href="../../R/d7f0bc21c0f10879.html" target="n" data-glyph="0,0" class="t t">TypeDefinitionAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="538b892ac3029ff5" href="../../R/538b892ac3029ff5.html" target="n" data-glyph="46,1" class="i field">s_emptyAttributeList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
 
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#6092492a0585632c" class="t t">MemberAst</a>&gt; <a id="b593162adff86b19" href="../../R/b593162adff86b19.html" target="n" data-glyph="46,1" class="i field">s_emptyMembersCollection</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#6092492a0585632c" class="t t">MemberAst</a>&gt;();
 
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <a id="57ca29be3212225a" href="../../R/57ca29be3212225a.html" target="n" data-glyph="46,1" class="i field">s_emptyBaseTypesCollection</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a type definition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r353 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the type definition, from any attributes to the closing curly brace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r354 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r355 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attributes, or null if no attributes were specified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r356 r">members</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The members, or null if no members were specified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r357 r">typeAttributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attributes (like class or interface) of the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r358 r">baseTypes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Base class and implemented interfaces for the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8b0ce829bce11875" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">TypeDefinitionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r353 rd" class="r353 r">extent</span>, <b>string</b> <span id="r354 rd" class="r354 r">name</span>, <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r355 rd" class="r355 r">attributes</span>, <span class="i">IEnumerable</span>&lt;<a href="#6092492a0585632c" class="t t">MemberAst</a>&gt; <span id="r356 rd" class="r356 r">members</span>, <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a> <span id="r357 rd" class="r357 r">typeAttributes</span>, <span class="i">IEnumerable</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <span id="r358 rd" class="r358 r">baseTypes</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r353 r">extent</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r354 r">name</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r354 r">name</span>));
            }
 
            <b>if</b> (<span class="r355 r">attributes</span> != <b>null</b> &amp;&amp; <span class="r355 r">attributes</span>.<span class="i">Any</span>())
            {
                <a href="#9bd8b4fdfddab8c7" class="i property">Attributes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(<span class="r355 r">attributes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#9bd8b4fdfddab8c7" class="i property">Attributes</a>);
            }
            <b>else</b>
            {
                <a href="#9bd8b4fdfddab8c7" class="i property">Attributes</a> = <a href="#538b892ac3029ff5" class="i field">s_emptyAttributeList</a>;
            }
 
            <b>if</b> (<span class="r356 r">members</span> != <b>null</b> &amp;&amp; <span class="r356 r">members</span>.<span class="i">Any</span>())
            {
                <a href="#9f439131b4d83a32" class="i property">Members</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#6092492a0585632c" class="t t">MemberAst</a>&gt;(<span class="r356 r">members</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#9f439131b4d83a32" class="i property">Members</a>);
            }
            <b>else</b>
            {
                <a href="#9f439131b4d83a32" class="i property">Members</a> = <a href="#b593162adff86b19" class="i field">s_emptyMembersCollection</a>;
            }
 
            <b>if</b> (<span class="r358 r">baseTypes</span> != <b>null</b> &amp;&amp; <span class="r358 r">baseTypes</span>.<span class="i">Any</span>())
            {
                <a href="#10a87071659a5887" class="i property">BaseTypes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;(<span class="r358 r">baseTypes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#10a87071659a5887" class="i property">BaseTypes</a>);
            }
            <b>else</b>
            {
                <a href="#10a87071659a5887" class="i property">BaseTypes</a> = <a href="#57ca29be3212225a" class="i field">s_emptyBaseTypesCollection</a>;
            }
 
            <a href="#d7f0bc21c0f10879" class="k">this</a>.<a href="#b2edb6e99afb6054" class="i property">Name</a> = <span class="r354 r">name</span>;
            <a href="#d7f0bc21c0f10879" class="k">this</a>.<a href="#ee5b02a57d7f836d" class="i property">TypeAttributes</a> = <span class="r357 r">typeAttributes</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b2edb6e99afb6054" href="../../R/b2edb6e99afb6054.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for the custom attributes specified on the type.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="9bd8b4fdfddab8c7" href="../../R/9bd8b4fdfddab8c7.html" target="n" data-glyph="102,1" class="i property">Attributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for the base types. This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <a id="10a87071659a5887" href="../../R/10a87071659a5887.html" target="n" data-glyph="102,1" class="i property">BaseTypes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts for the members of the type.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#6092492a0585632c" class="t t">MemberAst</a>&gt; <a id="9f439131b4d83a32" href="../../R/9f439131b4d83a32.html" target="n" data-glyph="102,1" class="i property">Members</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type attributes (like class or interface) of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a> <a id="ee5b02a57d7f836d" href="../../R/ee5b02a57d7f836d.html" target="n" data-glyph="102,1" class="i property">TypeAttributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the type defines an enum.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="26f9adfa0f5150bd" href="../../R/26f9adfa0f5150bd.html" target="n" data-glyph="102,1" class="i property">IsEnum</a> { <b>get</b> { <b>return</b> (<a href="#ee5b02a57d7f836d" class="i property">TypeAttributes</a> &amp; <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="#ed298c43d5bc1d4b" class="i field">Enum</a>) == <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="#ed298c43d5bc1d4b" class="i field">Enum</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the type defines a class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="db380593e8b5ec71" href="../../R/db380593e8b5ec71.html" target="n" data-glyph="102,1" class="i property">IsClass</a> { <b>get</b> { <b>return</b> (<a href="#ee5b02a57d7f836d" class="i property">TypeAttributes</a> &amp; <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="#d60e921be64513ed" class="i field">Class</a>) == <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="#d60e921be64513ed" class="i field">Class</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the type defines an interface.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="eb8026076027d935" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsInterface</a> { <b>get</b> { <b>return</b> (<a href="#ee5b02a57d7f836d" class="i property">TypeAttributes</a> &amp; <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="#c97c681c86ae931e" class="i field">Interface</a>) == <a href="#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="#c97c681c86ae931e" class="i field">Interface</a>; } }
 
        <b>internal</b> <span class="i">Type</span> <a id="238185060b3af590" href="../../R/238185060b3af590.html" target="n" data-glyph="104,1" class="i property">Type</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9e01eb43b0f36943" class="i field">_type</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// The assert may seem a little bit confusing.</span>
                <span class="c">// It&#39;s because RuntimeType is not a public class and I don&#39;t want to use Name string in assert.</span>
                <span class="c">// The basic idea is that Type field should go thru 3 stages:</span>
                <span class="c">// 1. null</span>
                <span class="c">// 2. TypeBuilder</span>
                <span class="c">// 3. RuntimeType</span>
                <span class="c">// We also allow wipe type (assign to null), because there could be errors.</span>
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>value</b> == <b>null</b> || <a href="#9e01eb43b0f36943" class="i field">_type</a> == <b>null</b> || <a href="#9e01eb43b0f36943" class="i field">_type</a> <b>is</b> <span class="i">TypeBuilder</span>, <span class="s">&quot;Type must be assigned only once to RuntimeType&quot;</span>);
                <a href="#9e01eb43b0f36943" class="i field">_type</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the TypeDefinitionAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="f1711d872f3e6f1f" href="../../R/f1711d872f3e6f1f.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <span class="t">TypeDefinitionAst</span>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#b2edb6e99afb6054" class="i property">Name</a>, <span class="i">CopyElements</span>(<a href="#9bd8b4fdfddab8c7" class="i property">Attributes</a>), <span class="i">CopyElements</span>(<a href="#9f439131b4d83a32" class="i property">Members</a>), <a href="#ee5b02a57d7f836d" class="i property">TypeAttributes</a>, <span class="i">CopyElements</span>(<a href="#10a87071659a5887" class="i property">BaseTypes</a>));
        }
 
        <b>private</b> <span class="i">Type</span> <a id="9e01eb43b0f36943" href="../../R/9e01eb43b0f36943.html" target="n" data-glyph="46,1" class="i field">_type</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="10e5966490f39dec" href="../../R/10e5966490f39dec.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r359 rd" class="r359 r">visitor</span>)
        {
            <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="k">var</a> <span id="r360 rd" class="r360 r">visitor2</span> = <span class="r359 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>;
            <b>return</b> <span class="r360 r">visitor2</span>?.<a href="AstVisitor.cs.html#b25214dcc5fa2a38" class="i method">VisitTypeDefinition</a>(<a href="#d7f0bc21c0f10879" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="dd5685ee49561e0e" href="../../R/dd5685ee49561e0e.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r361 rd" class="r361 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r362 rd" class="r362 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r363 rd" class="r363 r">visitor2</span> = <span class="r361 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r363 r">visitor2</span> != <b>null</b>)
            {
                <span class="r362 r">action</span> = <span class="r363 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#605f75653576e057" class="i method">VisitTypeDefinition</a>(<a href="#d7f0bc21c0f10879" class="k">this</a>);
                <b>if</b> (<span class="r362 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                    <b>return</b> <span class="r361 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#d7f0bc21c0f10879" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            }
 
            <span class="c">// REVIEW: should old visitors completely skip the attributes and</span>
            <span class="c">// bodies of methods, or should they get a chance to see them.  If</span>
            <span class="c">// we want to skip them, the code below needs to move up into the</span>
            <span class="c">// above test &#39;visitor2 != null&#39;.</span>
            <b>if</b> (<span class="r362 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r364 rd" class="r364 r">index</span> = 0; <span class="r364 r">index</span> &lt; <a href="#9bd8b4fdfddab8c7" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r364 r">index</span>++)
                {
                    <b>var</b> <span id="r365 rd" class="r365 r">attribute</span> = <a href="#9bd8b4fdfddab8c7" class="i property">Attributes</a>[<span class="r364 r">index</span>];
                    <span class="r362 r">action</span> = <span class="r365 r">attribute</span>.<span class="i">InternalVisit</span>(<span class="r361 r">visitor</span>);
                    <b>if</b> (<span class="r362 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    {
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r362 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r366 rd" class="r366 r">index</span> = 0; <span class="r366 r">index</span> &lt; <a href="#10a87071659a5887" class="i property">BaseTypes</a>.<span class="i">Count</span>; <span class="r366 r">index</span>++)
                {
                    <b>var</b> <span id="r367 rd" class="r367 r">baseTypes</span> = <a href="#10a87071659a5887" class="i property">BaseTypes</a>[<span class="r366 r">index</span>];
                    <span class="r362 r">action</span> = <span class="r367 r">baseTypes</span>.<span class="i">InternalVisit</span>(<span class="r361 r">visitor</span>);
                    <b>if</b> (<span class="r362 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    {
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r362 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r368 rd" class="r368 r">index</span> = 0; <span class="r368 r">index</span> &lt; <a href="#9f439131b4d83a32" class="i property">Members</a>.<span class="i">Count</span>; <span class="r368 r">index</span>++)
                {
                    <b>var</b> <span id="r369 rd" class="r369 r">member</span> = <a href="#9f439131b4d83a32" class="i property">Members</a>[<span class="r368 r">index</span>];
                    <span class="r362 r">action</span> = <span class="r369 r">member</span>.<span class="i">InternalVisit</span>(<span class="r361 r">visitor</span>);
                    <b>if</b> (<span class="r362 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    {
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r361 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#d7f0bc21c0f10879" class="k">this</a>, <span class="r362 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The kind of using statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="0837a04517723905" href="../../R/0837a04517723905.html" target="n" data-glyph="18,0" class="t t"><span id="402d68999c48a320">UsingStatementKind</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A parse time reference to an assembly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="98acf874996a057c" href="../../R/98acf874996a057c.html" target="n" data-glyph="24,1" class="i field">Assembly</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A parse time command alias.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="68fe72ea611e4f8d" href="../../R/68fe72ea611e4f8d.html" target="n" data-glyph="24,1" class="i field">Command</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A parse time reference or alias to a module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4e97afe747960a96" href="../../R/4e97afe747960a96.html" target="n" data-glyph="24,1" class="i field">Module</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A parse time statement that allows specifying types without their full namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8c39b25da17c5e31" href="../../R/8c39b25da17c5e31.html" target="n" data-glyph="24,1" class="i field">Namespace</a> = 3,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A parse time type alias (type accelerator).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="32e92208f14046ce" href="../../R/32e92208f14046ce.html" target="n" data-glyph="24,1" class="i field">Type</a> = 4,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a using statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="a269e1753cbc4c90" href="../../R/a269e1753cbc4c90.html" target="n" data-glyph="0,0" class="t t">UsingStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a simple using statement (one that is not a form of an alias).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r370 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the using statement including the using keyword.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r371 r">kind</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The kind of using statement, cannot be </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#68fe72ea611e4f8d" class="i field">Command</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#32e92208f14046ce" class="i field">Type</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r372 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The item (assembly, module, or namespace) being used.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4108c0236bff4485" href="../../R/4108c0236bff4485.html" target="n" data-glyph="72,1" class="t constructor">UsingStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r370 rd" class="r370 r">extent</span>, <a href="#0837a04517723905" class="t t">UsingStatementKind</a> <span id="r371 rd" class="r371 r">kind</span>, <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r372 rd" class="r372 r">name</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r370 r">extent</span>)
        {
            <b>if</b> (<span class="r372 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r372 r">name</span>));
            }
 
            <b>if</b> (<span class="r371 r">kind</span> == <a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#68fe72ea611e4f8d" class="i field">Command</a> || <span class="r371 r">kind</span> == <a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#32e92208f14046ce" class="i field">Type</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r371 r">kind</span>));
            }
 
            <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a> = <span class="r371 r">kind</span>;
            <a href="#02967e77bbe69be3" class="i property">Name</a> = <span class="r372 r">name</span>;
 
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#02967e77bbe69be3" class="i property">Name</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a simple (one that is not a form of an alias) using module statement with module specification as hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r373 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the using statement including the using keyword.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r374 r">moduleSpecification</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">HashtableAst that describes </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="07320bfb632893ad" href="../../R/07320bfb632893ad.html" target="n" data-glyph="72,1" class="t constructor">UsingStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r373 rd" class="r373 r">extent</span>, <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r374 rd" class="r374 r">moduleSpecification</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r373 r">extent</span>)
        {
            <b>if</b> (<span class="r374 r">moduleSpecification</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r374 r">moduleSpecification</span>));
            }
 
            <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a> = <a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#4e97afe747960a96" class="i field">Module</a>;
            <a href="#4109993f1afb989e" class="i property">ModuleSpecification</a> = <span class="r374 r">moduleSpecification</span>;
 
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r374 r">moduleSpecification</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a using statement that aliases an item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r375 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the using statement including the using keyword.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r376 r">kind</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The kind of using statement, cannot be </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#98acf874996a057c" class="i field">Assembly</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r377 r">aliasName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the alias.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r378 r">resolvedAliasAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The item being aliased.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8707b54e786c43b3" href="../../R/8707b54e786c43b3.html" target="n" data-glyph="72,1" class="t constructor">UsingStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r375 rd" class="r375 r">extent</span>, <a href="#0837a04517723905" class="t t">UsingStatementKind</a> <span id="r376 rd" class="r376 r">kind</span>, <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r377 rd" class="r377 r">aliasName</span>,
                                 <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r378 rd" class="r378 r">resolvedAliasAst</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r375 r">extent</span>)
        {
            <b>if</b> (<span class="r377 r">aliasName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r377 r">aliasName</span>));
            }
 
            <b>if</b> (<span class="r378 r">resolvedAliasAst</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r378 r">resolvedAliasAst</span>));
            }
 
            <b>if</b> (<span class="r376 r">kind</span> == <a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#98acf874996a057c" class="i field">Assembly</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r376 r">kind</span>));
            }
 
            <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a> = <span class="r376 r">kind</span>;
            <a href="#02967e77bbe69be3" class="i property">Name</a> = <span class="r377 r">aliasName</span>;
            <a href="#3d935e2cfb8a27f1" class="i property">Alias</a> = <span class="r378 r">resolvedAliasAst</span>;
 
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#02967e77bbe69be3" class="i property">Name</a>);
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#3d935e2cfb8a27f1" class="i property">Alias</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a using module statement that aliases an item with module specification as hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r379 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the using statement including the using keyword.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r380 r">aliasName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the alias.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r381 r">moduleSpecification</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The module being aliased. Hashtable that describes </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4522b0f6bef6dd2b" href="../../R/4522b0f6bef6dd2b.html" target="n" data-glyph="72,1" class="t constructor">UsingStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r379 rd" class="r379 r">extent</span>, <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r380 rd" class="r380 r">aliasName</span>, <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r381 rd" class="r381 r">moduleSpecification</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r379 r">extent</span>)
        {
            <b>if</b> (<span class="r381 r">moduleSpecification</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r381 r">moduleSpecification</span>));
            }
 
            <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a> = <a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#4e97afe747960a96" class="i field">Module</a>;
            <a href="#4109993f1afb989e" class="i property">ModuleSpecification</a> = <span class="r381 r">moduleSpecification</span>;
            <a href="#02967e77bbe69be3" class="i property">Name</a> = <span class="r380 r">aliasName</span>;
 
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r381 r">moduleSpecification</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The kind of using statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#0837a04517723905" class="t t">UsingStatementKind</a> <a id="4b031903ea1b04ed" href="../../R/4b031903ea1b04ed.html" target="n" data-glyph="102,1" class="i property">UsingStatementKind</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#3d935e2cfb8a27f1" class="i property">Alias</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4109993f1afb989e" class="i property">ModuleSpecification</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null, the item being used, otherwise the alias name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <a id="02967e77bbe69be3" href="../../R/02967e77bbe69be3.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item being aliased.</span>
        <span class="c">///</span><span class="c"> This property is mutually exclusive with </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4109993f1afb989e" class="i property">ModuleSpecification</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <a id="3d935e2cfb8a27f1" href="../../R/3d935e2cfb8a27f1.html" target="n" data-glyph="102,1" class="i property">Alias</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable that can be converted to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">. Only for &#39;using module&#39; case, otherwise null.</span>
        <span class="c">///</span><span class="c"> This property is mutually exclusive with </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#3d935e2cfb8a27f1" class="i property">Alias</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a> <a id="4109993f1afb989e" href="../../R/4109993f1afb989e.html" target="n" data-glyph="102,1" class="i property">ModuleSpecification</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ModuleInfo about used module. Only for &#39;using module&#39; case, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="330774b0df5f5f0d" href="../../R/330774b0df5f5f0d.html" target="n" data-glyph="104,1" class="i property">ModuleInfo</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the UsingStatementAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="e25a1e1d7aadddd9" href="../../R/e25a1e1d7aadddd9.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#a269e1753cbc4c90" class="k">var</a> <span id="r382 rd" class="r382 r">copy</span> = <a href="#3d935e2cfb8a27f1" class="i property">Alias</a> != <b>null</b>
                ? <b>new</b> <a href="#8707b54e786c43b3" class="t constructor">UsingStatementAst</a>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a>, <a href="#02967e77bbe69be3" class="i property">Name</a>, <a href="#3d935e2cfb8a27f1" class="i property">Alias</a>)
                : <b>new</b> <a href="#4108c0236bff4485" class="t constructor">UsingStatementAst</a>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a>, <a href="#02967e77bbe69be3" class="i property">Name</a>);
            <span class="r382 r">copy</span>.<a href="#330774b0df5f5f0d" class="i property">ModuleInfo</a> = <a href="#330774b0df5f5f0d" class="i property">ModuleInfo</a>;
 
            <b>return</b> <span class="r382 r">copy</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="da9cef7e7a43dfd2" href="../../R/da9cef7e7a43dfd2.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r383 rd" class="r383 r">visitor</span>)
        {
            <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="k">var</a> <span id="r384 rd" class="r384 r">visitor2</span> = <span class="r383 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>;
            <b>return</b> <span class="r384 r">visitor2</span>?.<a href="AstVisitor.cs.html#2b078d8f8ede051a" class="i method">VisitUsingStatement</a>(<a href="#a269e1753cbc4c90" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="7417d98c51724ea2" href="../../R/7417d98c51724ea2.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r385 rd" class="r385 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r386 rd" class="r386 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r387 rd" class="r387 r">visitor2</span> = <span class="r385 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r387 r">visitor2</span> != <b>null</b>)
            {
                <span class="r386 r">action</span> = <span class="r387 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#d03fb4e75b3927e7" class="i method">VisitUsingStatement</a>(<a href="#a269e1753cbc4c90" class="k">this</a>);
                <b>if</b> (<span class="r386 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    <b>return</b> <span class="r385 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a269e1753cbc4c90" class="k">this</a>, <span class="r386 r">action</span>);
            }
 
            <b>if</b> (<a href="#02967e77bbe69be3" class="i property">Name</a> != <b>null</b>)
                <span class="r386 r">action</span> = <a href="#02967e77bbe69be3" class="i property">Name</a>.<a href="#0c46d9356ff6a000" class="i method">InternalVisit</a>(<span class="r385 r">visitor</span>);
 
            <b>if</b> (<span class="r386 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <b>return</b> <span class="r385 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a269e1753cbc4c90" class="k">this</a>, <span class="r386 r">action</span>);
 
            <b>if</b> (<a href="#4109993f1afb989e" class="i property">ModuleSpecification</a> != <b>null</b>)
                <span class="r386 r">action</span> = <a href="#4109993f1afb989e" class="i property">ModuleSpecification</a>.<a href="#f933d3e6dc2e3f98" class="i method">InternalVisit</a>(<span class="r385 r">visitor</span>);
 
            <b>if</b> (<span class="r386 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <b>return</b> <span class="r385 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a269e1753cbc4c90" class="k">this</a>, <span class="r386 r">action</span>);
 
            <b>if</b> (<a href="#3d935e2cfb8a27f1" class="i property">Alias</a> != <b>null</b>)
                <span class="r386 r">action</span> = <a href="#3d935e2cfb8a27f1" class="i property">Alias</a>.<a href="#0c46d9356ff6a000" class="i method">InternalVisit</a>(<span class="r385 r">visitor</span>);
 
            <b>return</b> <span class="r385 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a269e1753cbc4c90" class="k">this</a>, <span class="r386 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define imported module and all type definitions imported by this using statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r388 r">moduleInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Return ExportedTypeTable for this module.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">ReadOnlyDictionary</span>&lt;<b>string</b>, <a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <a id="414e9a795dd7232f" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DefineImportedModule</a>(<a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r388 rd" class="r388 r">moduleInfo</span>)
        {
            <b>var</b> <span id="r389 rd" class="r389 r">types</span> = <span class="r388 r">moduleInfo</span>.<a href="../Modules/PSModuleInfo.cs.html#7d3f55f45bfcc4cc" class="i method">GetExportedTypeDefinitions</a>();
            <a href="#330774b0df5f5f0d" class="i property">ModuleInfo</a> = <span class="r388 r">moduleInfo</span>;
            <b>return</b> <span class="r389 r">types</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is UsingStatementKind Module or Assembly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True, if it is.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6eade438e49592dc" href="../../R/6eade438e49592dc.html" target="n" data-glyph="74,1" class="i method">IsUsingModuleOrAssembly</a>()
        {
            <b>return</b> <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a> == <a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#98acf874996a057c" class="i field">Assembly</a> || <a href="#4b031903ea1b04ed" class="i property">UsingStatementKind</a> == <a href="#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="#4e97afe747960a96" class="i field">Module</a>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class for type members.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="6092492a0585632c" href="../../R/6092492a0585632c.html" target="n" data-glyph="0,0" class="t t">MemberAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common fields of a type member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r390 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the type member.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="62cef8181fa36c9b" href="../../R/62cef8181fa36c9b.html" target="n" data-glyph="75,1" class="t constructor">MemberAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r390 rd" class="r390 r">extent</span>) : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r390 r">extent</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the member.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract string</b> <a id="ddafb4df65953092" href="../../R/ddafb4df65953092.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <b>internal abstract string</b> <a id="25d247583932116b" href="../../R/25d247583932116b.html" target="n" data-glyph="74,1" class="i method">GetTooltip</a>();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The attributes for a property.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="003cbc0806eaf107" href="../../R/003cbc0806eaf107.html" target="n" data-glyph="18,0" class="t t"><span id="d9376ba46e673fee">PropertyAttributes</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">No attributes specified.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="551845ffcb4cfcb3" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x00,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The property is public.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b2401842fad0b17e" href="../../R/b2401842fad0b17e.html" target="n" data-glyph="24,1" class="i field">Public</a> = 0x01,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The property is private.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="914712ffecad59b1" href="../../R/914712ffecad59b1.html" target="n" data-glyph="24,1" class="i field">Private</a> = 0x02,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The property is static.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="43f6609d852582fe" href="../../R/43f6609d852582fe.html" target="n" data-glyph="24,1" class="i field">Static</a> = 0x10,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The property is a literal.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="743cc7ba3d819534" href="../../R/743cc7ba3d819534.html" target="n" data-glyph="24,1" class="i field">Literal</a> = 0x20,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The property is a hidden.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="db9fd4c5992c99bd" href="../../R/db9fd4c5992c99bd.html" target="n" data-glyph="24,1" class="i field">Hidden</a> = 0x40,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast for a property.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="88ad8abafd061e97" href="../../R/88ad8abafd061e97.html" target="n" data-glyph="0,0" class="t t">PropertyMemberAst</a> : <a href="#6092492a0585632c" class="t t">MemberAst</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="b22d6c2813f904a8" href="../../R/b22d6c2813f904a8.html" target="n" data-glyph="46,1" class="i field">s_emptyAttributeList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a property member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r391 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the property starting with any custom attributes.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r392 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the property.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r393 r">propertyType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ast for the type of the property - may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r394 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The custom attributes for the property.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r395 r">propertyAttributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attributes (like public or static) for the property.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r396 r">initialValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The initial value of the property (may be null).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="13db239495d63d20" href="../../R/13db239495d63d20.html" target="n" data-glyph="72,1" class="t constructor">PropertyMemberAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r391 rd" class="r391 r">extent</span>, <b>string</b> <span id="r392 rd" class="r392 r">name</span>, <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r393 rd" class="r393 r">propertyType</span>, <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r394 rd" class="r394 r">attributes</span>, <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a> <span id="r395 rd" class="r395 r">propertyAttributes</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r396 rd" class="r396 r">initialValue</span>)
            : <a href="#62cef8181fa36c9b" class="k">base</a>(<span class="r391 r">extent</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r392 r">name</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r392 r">name</span>));
            }
 
            <b>if</b> ((<span class="r395 r">propertyAttributes</span> &amp; (<a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#914712ffecad59b1" class="i field">Private</a> | <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#b2401842fad0b17e" class="i field">Public</a>)) ==
                (<a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#914712ffecad59b1" class="i field">Private</a> | <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#b2401842fad0b17e" class="i field">Public</a>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r395 r">propertyAttributes</span>));
            }
 
            <a href="#d93cd0c92947c0b5" class="i property">Name</a> = <span class="r392 r">name</span>;
            <b>if</b> (<span class="r393 r">propertyType</span> != <b>null</b>)
            {
                <a href="#15850665413648cb" class="i property">PropertyType</a> = <span class="r393 r">propertyType</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#15850665413648cb" class="i property">PropertyType</a>);
            }
 
            <b>if</b> (<span class="r394 r">attributes</span> != <b>null</b>)
            {
                <a href="#88ad8abafd061e97" class="k">this</a>.<a href="#8ea99b56a0b0002a" class="i property">Attributes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(<span class="r394 r">attributes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#8ea99b56a0b0002a" class="i property">Attributes</a>);
            }
            <b>else</b>
            {
                <a href="#88ad8abafd061e97" class="k">this</a>.<a href="#8ea99b56a0b0002a" class="i property">Attributes</a> = <a href="#b22d6c2813f904a8" class="i field">s_emptyAttributeList</a>;
            }
 
            <a href="#520a32108eee8b5e" class="i property">PropertyAttributes</a> = <span class="r395 r">propertyAttributes</span>;
            <a href="#aed4bc0cb0136a95" class="i property">InitialValue</a> = <span class="r396 r">initialValue</span>;
 
            <b>if</b> (<a href="#aed4bc0cb0136a95" class="i property">InitialValue</a> != <b>null</b>)
            {
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#aed4bc0cb0136a95" class="i property">InitialValue</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="d93cd0c92947c0b5" href="../../R/d93cd0c92947c0b5.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the type of the property.  This property may be null if no type was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <a id="15850665413648cb" href="../../R/15850665413648cb.html" target="n" data-glyph="102,1" class="i property">PropertyType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The custom attributes of the property.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="8ea99b56a0b0002a" href="../../R/8ea99b56a0b0002a.html" target="n" data-glyph="102,1" class="i property">Attributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The attributes (like public or static) of the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a> <a id="520a32108eee8b5e" href="../../R/520a32108eee8b5e.html" target="n" data-glyph="102,1" class="i property">PropertyAttributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the initial value of the property.  This property may be null if no initial value was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="aed4bc0cb0136a95" href="../../R/aed4bc0cb0136a95.html" target="n" data-glyph="102,1" class="i property">InitialValue</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return true if the property is public.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="444c108d48010285" href="../../R/444c108d48010285.html" target="n" data-glyph="102,1" class="i property">IsPublic</a> { <b>get</b> { <b>return</b> (<a href="#520a32108eee8b5e" class="i property">PropertyAttributes</a> &amp; <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#b2401842fad0b17e" class="i field">Public</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return true if the property is private.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="33fd7cb4eb24680b" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsPrivate</a> { <b>get</b> { <b>return</b> (<a href="#520a32108eee8b5e" class="i property">PropertyAttributes</a> &amp; <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#914712ffecad59b1" class="i field">Private</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return true if the property is hidden.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="19f0ac305787111e" href="../../R/19f0ac305787111e.html" target="n" data-glyph="102,1" class="i property">IsHidden</a> { <b>get</b> { <b>return</b> (<a href="#520a32108eee8b5e" class="i property">PropertyAttributes</a> &amp; <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#db9fd4c5992c99bd" class="i field">Hidden</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return true if the property is static.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="a4fccd8c1d834725" href="../../R/a4fccd8c1d834725.html" target="n" data-glyph="102,1" class="i property">IsStatic</a> { <b>get</b> { <b>return</b> (<a href="#520a32108eee8b5e" class="i property">PropertyAttributes</a> &amp; <a href="#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="#43f6609d852582fe" class="i field">Static</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the PropertyMemberAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="68198a1da014724d" href="../../R/68198a1da014724d.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#34b9d5dbbaca964d" class="k">var</a> <span id="r397 rd" class="r397 r">newPropertyType</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#15850665413648cb" class="i property">PropertyType</a>);
            <b>var</b> <span id="r398 rd" class="r398 r">newAttributes</span> = <span class="i">CopyElements</span>(<a href="#8ea99b56a0b0002a" class="i property">Attributes</a>);
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r399 rd" class="r399 r">newInitialValue</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#aed4bc0cb0136a95" class="i property">InitialValue</a>);
            <b>return</b> <b>new</b> <span class="t">PropertyMemberAst</span>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#d93cd0c92947c0b5" class="i property">Name</a>, <span class="r397 r">newPropertyType</span>, <span class="r398 r">newAttributes</span>, <a href="#520a32108eee8b5e" class="i property">PropertyAttributes</a>, <span class="r399 r">newInitialValue</span>);
        }
 
        <b>internal override string</b> <a id="d96715eac1587802" href="../../R/d96715eac1587802.html" target="n" data-glyph="74,1" class="i method">GetTooltip</a>()
        {
            <b>var</b> <span id="r400 rd" class="r400 r">type</span> = <a href="#15850665413648cb" class="i property">PropertyType</a> != <b>null</b> ? <a href="#15850665413648cb" class="i property">PropertyType</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="#15c64a580f477707" class="i property">FullName</a> : <span class="s">&quot;object&quot;</span>;
            <b>return</b> <a href="#a4fccd8c1d834725" class="i property">IsStatic</a>
                ? <span class="s">&quot;static &quot;</span> + <span class="r400 r">type</span> + <span class="s">&quot; &quot;</span> + <a href="#d93cd0c92947c0b5" class="i property">Name</a>
                : <span class="r400 r">type</span> + <span class="s">&quot; &quot;</span> + <a href="#d93cd0c92947c0b5" class="i property">Name</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="0a43cea05d0407a3" href="../../R/0a43cea05d0407a3.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r401 rd" class="r401 r">visitor</span>)
        {
            <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="k">var</a> <span id="r402 rd" class="r402 r">visitor2</span> = <span class="r401 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>;
            <b>return</b> <span class="r402 r">visitor2</span>?.<a href="AstVisitor.cs.html#e9a963b9df0abc79" class="i method">VisitPropertyMember</a>(<a href="#88ad8abafd061e97" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="8b81c8612a2d07d3" href="../../R/8b81c8612a2d07d3.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r403 rd" class="r403 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r404 rd" class="r404 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r405 rd" class="r405 r">visitor2</span> = <span class="r403 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r405 r">visitor2</span> != <b>null</b>)
            {
                <span class="r404 r">action</span> = <span class="r405 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#fe8ede87dffba4d1" class="i method">VisitPropertyMember</a>(<a href="#88ad8abafd061e97" class="k">this</a>);
                <b>if</b> (<span class="r404 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                    <b>return</b> <span class="r403 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#88ad8abafd061e97" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
 
                <b>if</b> (<span class="r404 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#15850665413648cb" class="i property">PropertyType</a> != <b>null</b>)
                    <span class="r404 r">action</span> = <a href="#15850665413648cb" class="i property">PropertyType</a>.<a href="#fda3411c37051037" class="i method">InternalVisit</a>(<span class="r403 r">visitor</span>);
 
                <b>if</b> (<span class="r404 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                {
                    <b>for</b> (<b>int</b> <span id="r406 rd" class="r406 r">index</span> = 0; <span class="r406 r">index</span> &lt; <a href="#8ea99b56a0b0002a" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r406 r">index</span>++)
                    {
                        <b>var</b> <span id="r407 rd" class="r407 r">attributeAst</span> = <a href="#8ea99b56a0b0002a" class="i property">Attributes</a>[<span class="r406 r">index</span>];
                        <span class="r404 r">action</span> = <span class="r407 r">attributeAst</span>.<span class="i">InternalVisit</span>(<span class="r403 r">visitor</span>);
                        <b>if</b> (<span class="r404 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r404 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#aed4bc0cb0136a95" class="i property">InitialValue</a> != <b>null</b>)
                    <span class="r404 r">action</span> = <a href="#aed4bc0cb0136a95" class="i property">InitialValue</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r403 r">visitor</span>);
            }
 
            <b>return</b> <span class="r403 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#88ad8abafd061e97" class="k">this</a>, <span class="r404 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Flags for a method.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="e5a1ea7f5a227ec3" href="../../R/e5a1ea7f5a227ec3.html" target="n" data-glyph="18,0" class="t t"><span id="3c45e2e9b2475c30">MethodAttributes</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">No flags specified.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="6771606c30641809" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x00,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The method is public.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f2d4c4659fabc967" href="../../R/f2d4c4659fabc967.html" target="n" data-glyph="24,1" class="i field">Public</a> = 0x01,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The method is private.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b9d13f1ee0d8fecb" href="../../R/b9d13f1ee0d8fecb.html" target="n" data-glyph="24,1" class="i field">Private</a> = 0x02,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The method is static.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="09a86f235bd689ff" href="../../R/09a86f235bd689ff.html" target="n" data-glyph="24,1" class="i field">Static</a> = 0x10,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The property is a hidden.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c7f8d97ad1275e8b" href="../../R/c7f8d97ad1275e8b.html" target="n" data-glyph="24,1" class="i field">Hidden</a> = 0x40,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast for a method.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="0c4f2db9a681a977" href="../../R/0c4f2db9a681a977.html" target="n" data-glyph="0,0" class="t t">FunctionMemberAst</a> : <a href="#6092492a0585632c" class="t t">MemberAst</a>, <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="57659d7bb620e2db" href="../../R/57659d7bb620e2db.html" target="n" data-glyph="46,1" class="i field">s_emptyAttributeList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
 
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="fd6367d07529faf8" href="../../R/fd6367d07529faf8.html" target="n" data-glyph="46,1" class="i field">s_emptyParameterList</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;();
 
        <b>private readonly</b> <a href="#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <a id="dc29e816bf113f77" href="../../R/dc29e816bf113f77.html" target="n" data-glyph="46,1" class="i field">_functionDefinitionAst</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a member function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r408 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the method starting from any attributes to the closing curly.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r409 r">functionDefinitionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The main body of the method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r410 r">returnType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The return type of the method, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r411 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The custom attributes for the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r412 r">methodAttributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The method attributes like public or static.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8e3e72f4a9bf26e0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">FunctionMemberAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r408 rd" class="r408 r">extent</span>, <a href="#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r409 rd" class="r409 r">functionDefinitionAst</span>, <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r410 rd" class="r410 r">returnType</span>, <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r411 rd" class="r411 r">attributes</span>, <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a> <span id="r412 rd" class="r412 r">methodAttributes</span>)
            : <a href="#62cef8181fa36c9b" class="k">base</a>(<span class="r408 r">extent</span>)
        {
            <b>if</b> (<span class="r409 r">functionDefinitionAst</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r409 r">functionDefinitionAst</span>));
            }
 
            <b>if</b> ((<span class="r412 r">methodAttributes</span> &amp; (<a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#b9d13f1ee0d8fecb" class="i field">Private</a> | <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#f2d4c4659fabc967" class="i field">Public</a>)) ==
                (<a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#b9d13f1ee0d8fecb" class="i field">Private</a> | <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#f2d4c4659fabc967" class="i field">Public</a>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r412 r">methodAttributes</span>));
            }
 
            <b>if</b> (<span class="r410 r">returnType</span> != <b>null</b>)
            {
                <a href="#9f5c50ce429b8578" class="i property">ReturnType</a> = <span class="r410 r">returnType</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r410 r">returnType</span>);
            }
 
            <b>if</b> (<span class="r411 r">attributes</span> != <b>null</b>)
            {
                <a href="#0c4f2db9a681a977" class="k">this</a>.<a href="#e701f9e07e1afeec" class="i property">Attributes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(<span class="r411 r">attributes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#e701f9e07e1afeec" class="i property">Attributes</a>);
            }
            <b>else</b>
            {
                <a href="#0c4f2db9a681a977" class="k">this</a>.<a href="#e701f9e07e1afeec" class="i property">Attributes</a> = <a href="#57659d7bb620e2db" class="i field">s_emptyAttributeList</a>;
            }
 
            <a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a> = <span class="r409 r">functionDefinitionAst</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r409 r">functionDefinitionAst</span>);
            <a href="#875811313106c63b" class="i property">MethodAttributes</a> = <span class="r412 r">methodAttributes</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the method.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="4a93ad116ed68e0e" href="../../R/4a93ad116ed68e0e.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b> { <b>return</b> <a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>.<a href="#951cc91108156df0" class="i property">Name</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The attributes specified on the method.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="e701f9e07e1afeec" href="../../R/e701f9e07e1afeec.html" target="n" data-glyph="102,1" class="i property">Attributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast representing the return type for the method.  This property may be null if no return type was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <a id="9f5c50ce429b8578" href="../../R/9f5c50ce429b8578.html" target="n" data-glyph="102,1" class="i property">ReturnType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameters specified immediately after the function name.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="f958ae4f9695b021" href="../../R/f958ae4f9695b021.html" target="n" data-glyph="102,1" class="i property">Parameters</a>
        {
            <b>get</b> { <b>return</b> <a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>.<a href="#653a0e4bf79364c2" class="i property">Parameters</a> ?? <a href="#fd6367d07529faf8" class="i field">s_emptyParameterList</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The body of the function.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="0cea07df0e8f92c9" href="../../R/0cea07df0e8f92c9.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b> { <b>return</b> <a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>.<a href="#201bce3cfc040274" class="i property">Body</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method attribute flags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a> <a id="875811313106c63b" href="../../R/875811313106c63b.html" target="n" data-glyph="102,1" class="i property">MethodAttributes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the method is public.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="144d1140b3eca8bb" href="../../R/144d1140b3eca8bb.html" target="n" data-glyph="102,1" class="i property">IsPublic</a> { <b>get</b> { <b>return</b> (<a href="#875811313106c63b" class="i property">MethodAttributes</a> &amp; <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#f2d4c4659fabc967" class="i field">Public</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the method is public.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b61fb8d55091b997" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsPrivate</a> { <b>get</b> { <b>return</b> (<a href="#875811313106c63b" class="i property">MethodAttributes</a> &amp; <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#b9d13f1ee0d8fecb" class="i field">Private</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the method is hidden.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="eb78b3c043381ff5" href="../../R/eb78b3c043381ff5.html" target="n" data-glyph="102,1" class="i property">IsHidden</a> { <b>get</b> { <b>return</b> (<a href="#875811313106c63b" class="i property">MethodAttributes</a> &amp; <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#c7f8d97ad1275e8b" class="i field">Hidden</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the method is static.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="d453a785cf1ce2d4" href="../../R/d453a785cf1ce2d4.html" target="n" data-glyph="102,1" class="i property">IsStatic</a> { <b>get</b> { <b>return</b> (<a href="#875811313106c63b" class="i property">MethodAttributes</a> &amp; <a href="#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="#09a86f235bd689ff" class="i field">Static</a>) != 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the method is a constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4faa75be8a2eed76" href="../../R/4faa75be8a2eed76.html" target="n" data-glyph="102,1" class="i property">IsConstructor</a>
        {
            <b>get</b> { <b>return</b> <a href="#4a93ad116ed68e0e" class="i property">Name</a>.<span class="i">Equals</span>(((<a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>)<a href="#faf9ad7a55f1cc57" class="i property">Parent</a>).<a href="#b2edb6e99afb6054" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>); }
        }
 
        <b>internal</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="7383b4996970fa8a" href="../../R/7383b4996970fa8a.html" target="n" data-glyph="104,1" class="i property">NameExtent</a> { <b>get</b> { <b>return</b> <a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>.<a href="#8ec8b89e52c97e95" class="i property">NameExtent</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy a function member ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="7cc53fa75807383b" href="../../R/7cc53fa75807383b.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#dd61b2a7b388405b" class="k">var</a> <span id="r413 rd" class="r413 r">newDefn</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>);
            <a href="#34b9d5dbbaca964d" class="k">var</a> <span id="r414 rd" class="r414 r">newReturnType</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#9f5c50ce429b8578" class="i property">ReturnType</a>);
            <b>var</b> <span id="r415 rd" class="r415 r">newAttributes</span> = <span class="i">CopyElements</span>(<a href="#e701f9e07e1afeec" class="i property">Attributes</a>);
 
            <b>return</b> <b>new</b> <span class="t">FunctionMemberAst</span>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r413 r">newDefn</span>, <span class="r414 r">newReturnType</span>, <span class="r415 r">newAttributes</span>, <a href="#875811313106c63b" class="i property">MethodAttributes</a>);
        }
 
        <b>internal override string</b> <a id="bf7c178857fc97d7" href="../../R/bf7c178857fc97d7.html" target="n" data-glyph="74,1" class="i method">GetTooltip</a>()
        {
            <b>var</b> <span id="r416 rd" class="r416 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>if</b> (<a href="#d453a785cf1ce2d4" class="i property">IsStatic</a>)
            {
                <span class="r416 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;static &quot;</span>);
            }
 
            <span class="r416 r">sb</span>.<span class="i">Append</span>(<a href="#89500cf38f3e53f4" class="i method">IsReturnTypeVoid</a>() ? <span class="s">&quot;void&quot;</span> : <a href="#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="#15c64a580f477707" class="i property">FullName</a>);
            <span class="r416 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
            <span class="r416 r">sb</span>.<span class="i">Append</span>(<a href="#4a93ad116ed68e0e" class="i property">Name</a>);
            <span class="r416 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;(&#39;</span>);
            <b>for</b> (<b>int</b> <span id="r417 rd" class="r417 r">i</span> = 0; <span class="r417 r">i</span> &lt; <a href="#f958ae4f9695b021" class="i property">Parameters</a>.<span class="i">Count</span>; <span class="r417 r">i</span>++)
            {
                <b>if</b> (<span class="r417 r">i</span> &gt; 0)
                {
                    <span class="r416 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                }
 
                <span class="r416 r">sb</span>.<span class="i">Append</span>(<a href="#f958ae4f9695b021" class="i property">Parameters</a>[<span class="r417 r">i</span>].<span class="i">GetTooltip</span>());
            }
 
            <span class="r416 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;)&#39;</span>);
            <b>return</b> <span class="r416 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="09a670e94ad05703" href="../../R/09a670e94ad05703.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r418 rd" class="r418 r">visitor</span>)
        {
            <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="k">var</a> <span id="r419 rd" class="r419 r">visitor2</span> = <span class="r418 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>;
            <b>return</b> <span class="r419 r">visitor2</span>?.<a href="AstVisitor.cs.html#b28902198f36fac6" class="i method">VisitFunctionMember</a>(<a href="#0c4f2db9a681a977" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="97150a5648c58c81" href="../../R/97150a5648c58c81.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r420 rd" class="r420 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r421 rd" class="r421 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r422 rd" class="r422 r">visitor2</span> = <span class="r420 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r422 r">visitor2</span> != <b>null</b>)
            {
                <span class="r421 r">action</span> = <span class="r422 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#3b3d826ff119c2a9" class="i method">VisitFunctionMember</a>(<a href="#0c4f2db9a681a977" class="k">this</a>);
                <b>if</b> (<span class="r421 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                    <b>return</b> <span class="r420 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#0c4f2db9a681a977" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
                <b>if</b> (<span class="r421 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                {
                    <b>for</b> (<b>int</b> <span id="r423 rd" class="r423 r">index</span> = 0; <span class="r423 r">index</span> &lt; <a href="#e701f9e07e1afeec" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r423 r">index</span>++)
                    {
                        <b>var</b> <span id="r424 rd" class="r424 r">attributeAst</span> = <a href="#e701f9e07e1afeec" class="i property">Attributes</a>[<span class="r423 r">index</span>];
                        <span class="r421 r">action</span> = <span class="r424 r">attributeAst</span>.<span class="i">InternalVisit</span>(<span class="r420 r">visitor</span>);
                        <b>if</b> (<span class="r421 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r421 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#9f5c50ce429b8578" class="i property">ReturnType</a> != <b>null</b>)
                    <span class="r421 r">action</span> = <a href="#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="#fda3411c37051037" class="i method">InternalVisit</a>(<span class="r420 r">visitor</span>);
 
                <b>if</b> (<span class="r421 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    <span class="r421 r">action</span> = <a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>.<a href="#79990ab5c4c3c8c9" class="i method">InternalVisit</a>(<span class="r420 r">visitor</span>);
            }
 
            <b>return</b> <span class="r420 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#0c4f2db9a681a977" class="k">this</a>, <span class="r421 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IParameterMetadataProvider implementation
 
        <b>bool</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#dea65be215e5a292" class="i method">HasAnyScriptBlockAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>).<a href="#dea65be215e5a292" class="i method">HasAnyScriptBlockAttributes</a>();
        }
 
        <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#57fef4bbca7ab95c" class="i property">Parameters</a>
        {
            <b>get</b> { <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>).<a href="#57fef4bbca7ab95c" class="i property">Parameters</a>; }
        }
 
        <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#c8000536ef7797f3" class="i method">GetParameterMetadata</a>(<b>bool</b> <span id="r425 rd" class="r425 r">automaticPositions</span>, <b>ref bool</b> <span id="r426 rd" class="r426 r">usesCmdletBinding</span>)
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>).<a href="#c8000536ef7797f3" class="i method">GetParameterMetadata</a>(<span class="r425 r">automaticPositions</span>, <b>ref</b> <span class="r426 r">usesCmdletBinding</span>);
        }
 
        <span class="i">IEnumerable</span>&lt;<span class="i">Attribute</span>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#5268a33bec21621c" class="i method">GetScriptBlockAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>).<a href="#5268a33bec21621c" class="i method">GetScriptBlockAttributes</a>();
        }
 
        <span class="i">IEnumerable</span>&lt;<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#8aeaf9e21660f350" class="i method">GetExperimentalAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>).<a href="#8aeaf9e21660f350" class="i method">GetExperimentalAttributes</a>();
        }
 
        <b>bool</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#960da0e2b7046796" class="i method">UsesCmdletBinding</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#dc29e816bf113f77" class="i field">_functionDefinitionAst</a>).<a href="#960da0e2b7046796" class="i method">UsesCmdletBinding</a>();
        }
 
        <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#43e8e80a08c89ef8" class="i method">GetPowerShell</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r427 rd" class="r427 r">context</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r428 rd" class="r428 r">variables</span>, <b>bool</b> <span id="r429 rd" class="r429 r">isTrustedInput</span>,
            <b>bool</b> <span id="r430 rd" class="r430 r">filterNonUsingVariables</span>, <b>bool</b>? <span id="r431 rd" class="r431 r">createLocalScope</span>, <b>params object</b>[] <span id="r432 rd" class="r432 r">args</span>)
        {
            <span class="c">// OK?  I think this isn&#39;t reachable</span>
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
        }
 
        <b>string</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#9eb35ed25013c0ba" class="i method">GetWithInputHandlingForInvokeCommand</a>()
        {
            <span class="c">// OK?  I think this isn&#39;t reachable</span>
            <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
        }
 
        <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#65bd5fb5ed6ed146" class="i method">GetWithInputHandlingForInvokeCommandWithUsingExpression</a>(<span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r433 rd" class="r433 r">usingVariablesTuple</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IParameterMetadataProvider implementation
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal helpers
        <b>internal bool</b> <a id="89500cf38f3e53f4" href="../../R/89500cf38f3e53f4.html" target="n" data-glyph="74,1" class="i method">IsReturnTypeVoid</a>()
        {
            <b>if</b> (<a href="#9f5c50ce429b8578" class="i property">ReturnType</a> == <b>null</b>)
                <b>return</b> <b>true</b>;
            <a href="#83b43c1855a09e15" class="k">var</a> <span id="r434 rd" class="r434 r">typeName</span> = <a href="#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a> <b>as</b> <a href="#83b43c1855a09e15" class="t t">TypeName</a>;
            <b>return</b> <span class="r434 r">typeName</span> != <b>null</b> &amp;&amp; <span class="r434 r">typeName</span>.<span class="i">IsType</span>(<b>typeof</b>(<b>void</b>));
        }
 
        <b>internal</b> <span class="i">Type</span> <a id="d04a04ffd2e70981" href="../../R/d04a04ffd2e70981.html" target="n" data-glyph="74,1" class="i method">GetReturnType</a>()
        {
            <b>return</b> <a href="#9f5c50ce429b8578" class="i property">ReturnType</a> == <b>null</b> ? <b>typeof</b>(<b>void</b>) : <a href="#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <b>internal enum</b> <a id="19743eab765b38bd" href="../../R/19743eab765b38bd.html" target="n" data-glyph="20,0" class="t t"><span id="6bd346be5ad797d1">SpecialMemberFunctionType</span></a>
    {
        <a id="0c187d0aa304e82a" href="../../R/0c187d0aa304e82a.html" target="n" data-glyph="24,1" class="i field">None</a>,
        <a id="2db5275de9fc26b7" href="../../R/2db5275de9fc26b7.html" target="n" data-glyph="24,1" class="i field">DefaultConstructor</a>,
        <a id="b78a27783df5b515" href="../../R/b78a27783df5b515.html" target="n" data-glyph="24,1" class="i field">StaticConstructor</a>,
    }
 
    <b>internal class</b> <a id="542e4087fd3a0dac" href="../../R/542e4087fd3a0dac.html" target="n" data-glyph="2,0" class="t t">CompilerGeneratedMemberFunctionAst</a> : <a href="#6092492a0585632c" class="t t">MemberAst</a>, <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>
    {
        <b>internal</b> <a id="b4a695ea7bedf426" href="../../R/b4a695ea7bedf426.html" target="n" data-glyph="74,1" class="t constructor">CompilerGeneratedMemberFunctionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r435 rd" class="r435 r">extent</span>, <a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r436 rd" class="r436 r">definingType</span>, <a href="#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a> <span id="r437 rd" class="r437 r">type</span>)
            : <a href="#62cef8181fa36c9b" class="k">base</a>(<span class="r435 r">extent</span>)
        {
            <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r438 rd" class="r438 r">statement</span> = <b>null</b>;
            <b>if</b> (<span class="r437 r">type</span> == <a href="#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a>.<a href="#2db5275de9fc26b7" class="i field">DefaultConstructor</a>)
            {
                <a href="#93dc2e4429de8e4e" class="k">var</a> <span id="r439 rd" class="r439 r">invokeMemberAst</span> = <b>new</b> <span class="t">BaseCtorInvokeMemberExpressionAst</span>(<span class="r435 r">extent</span>, <span class="r435 r">extent</span>, <span class="i">Array</span>.<span class="i">Empty</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;());
                <span class="r438 r">statement</span> = <b>new</b> <a href="#cdb6db10eccdfa97" class="t constructor">CommandExpressionAst</a>(<span class="r435 r">extent</span>, <span class="r439 r">invokeMemberAst</span>, <b>null</b>);
            }
 
            <a href="#265bfb7653a464aa" class="i property">Body</a> = <b>new</b> <a href="#97cd877cfe108c7b" class="t constructor">ScriptBlockAst</a>(<span class="r435 r">extent</span>, <b>null</b>, <b>new</b> <span class="t">StatementBlockAst</span>(<span class="r435 r">extent</span>, <span class="r438 r">statement</span> == <b>null</b> ? <b>null</b> : <b>new</b>[] { <span class="r438 r">statement</span> }, <b>null</b>), <b>false</b>);
            <a href="#542e4087fd3a0dac" class="k">this</a>.<a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#265bfb7653a464aa" class="i property">Body</a>);
            <span class="r436 r">definingType</span>.<a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#542e4087fd3a0dac" class="k">this</a>);
            <a href="#99051ed8c3d7385d" class="i property">DefiningType</a> = <span class="r436 r">definingType</span>;
            <a href="#48a124828c4da2d7" class="i property">Type</a> = <span class="r437 r">type</span>;
        }
 
        <b>public override string</b> <a id="14b4515bf16866b2" href="../../R/14b4515bf16866b2.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <span class="c">// This is fine for now, but if we add non-constructors, the name will be wrong.</span>
            <b>get</b> { <b>return</b> <a href="#99051ed8c3d7385d" class="i property">DefiningType</a>.<a href="#b2edb6e99afb6054" class="i property">Name</a>; }
        }
 
        <b>internal</b> <a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <a id="99051ed8c3d7385d" href="../../R/99051ed8c3d7385d.html" target="n" data-glyph="104,1" class="i property">DefiningType</a> { <b>get</b>; }
 
        <b>internal</b> <a href="#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a> <a id="48a124828c4da2d7" href="../../R/48a124828c4da2d7.html" target="n" data-glyph="104,1" class="i property">Type</a> { <b>get</b>; }
 
        <b>internal override string</b> <a id="ffdb299fae2d27ee" href="../../R/ffdb299fae2d27ee.html" target="n" data-glyph="74,1" class="i method">GetTooltip</a>()
        {
            <b>return</b> <a href="#99051ed8c3d7385d" class="i property">DefiningType</a>.<a href="#b2edb6e99afb6054" class="i property">Name</a> + <span class="s">&quot; new()&quot;</span>;
        }
 
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="37fd67a6c0383a2c" href="../../R/37fd67a6c0383a2c.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#b4a695ea7bedf426" class="t constructor">CompilerGeneratedMemberFunctionAst</a>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, (<a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>)<a href="#99051ed8c3d7385d" class="i property">DefiningType</a>.<a href="#f1711d872f3e6f1f" class="i method">Copy</a>(), <a href="#48a124828c4da2d7" class="i property">Type</a>);
        }
 
        <b>internal override object</b> <a id="68b23d4396ae2ecd" href="../../R/68b23d4396ae2ecd.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r440 rd" class="r440 r">visitor</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="8c55e8e18ac9e6f3" href="../../R/8c55e8e18ac9e6f3.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r441 rd" class="r441 r">visitor</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public bool</b> <a id="38b4dd5adb187ad4" href="../../R/38b4dd5adb187ad4.html" target="n" data-glyph="72,1" class="i method">HasAnyScriptBlockAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#265bfb7653a464aa" class="i property">Body</a>).<a href="#dea65be215e5a292" class="i method">HasAnyScriptBlockAttributes</a>();
        }
 
        <b>public</b> <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <a id="af6fbf520ee88007" href="../../R/af6fbf520ee88007.html" target="n" data-glyph="72,1" class="i method">GetParameterMetadata</a>(<b>bool</b> <span id="r442 rd" class="r442 r">automaticPositions</span>, <b>ref bool</b> <span id="r443 rd" class="r443 r">usesCmdletBinding</span>)
        {
            <b>return</b> <b>new</b> <a href="../PseudoParameters.cs.html#fe6fd05e3511357a" class="t constructor">RuntimeDefinedParameterDictionary</a> { <a href="../PseudoParameters.cs.html#188173533cedce98" class="i property">Data</a> = <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a>.<a href="../PseudoParameters.cs.html#8c8a683808508461" class="i field">EmptyParameterArray</a> };
        }
 
        <b>public</b> <span class="i">IEnumerable</span>&lt;<span class="i">Attribute</span>&gt; <a id="dc99f026200c0c71" href="../../R/dc99f026200c0c71.html" target="n" data-glyph="72,1" class="i method">GetScriptBlockAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#265bfb7653a464aa" class="i property">Body</a>).<a href="#5268a33bec21621c" class="i method">GetScriptBlockAttributes</a>();
        }
 
        <b>public</b> <span class="i">IEnumerable</span>&lt;<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>&gt; <a id="14a089745b83a29d" href="../../R/14a089745b83a29d.html" target="n" data-glyph="72,1" class="i method">GetExperimentalAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#265bfb7653a464aa" class="i property">Body</a>).<a href="#8aeaf9e21660f350" class="i method">GetExperimentalAttributes</a>();
        }
 
        <b>public bool</b> <a id="61d9cd5479e55c2e" href="../../R/61d9cd5479e55c2e.html" target="n" data-glyph="72,1" class="i method">UsesCmdletBinding</a>()
        {
            <b>return</b> <b>false</b>;
        }
 
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="ef33fdd74af711d4" href="../../R/ef33fdd74af711d4.html" target="n" data-glyph="102,1" class="i property">Parameters</a> { <b>get</b> { <b>return</b> <b>null</b>; } }
 
        <b>public</b> <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="265bfb7653a464aa" href="../../R/265bfb7653a464aa.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <b>public</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="48e135448c4ff863" href="../../R/48e135448c4ff863.html" target="n" data-glyph="72,1" class="i method">GetPowerShell</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r444 rd" class="r444 r">context</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r445 rd" class="r445 r">variables</span>, <b>bool</b> <span id="r446 rd" class="r446 r">isTrustedInput</span>,
            <b>bool</b> <span id="r447 rd" class="r447 r">filterNonUsingVariables</span>, <b>bool</b>? <span id="r448 rd" class="r448 r">createLocalScope</span>, <b>params object</b>[] <span id="r449 rd" class="r449 r">args</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public string</b> <a id="add80858a5d6b8e8" href="../../R/add80858a5d6b8e8.html" target="n" data-glyph="72,1" class="i method">GetWithInputHandlingForInvokeCommand</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public</b> <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="6a8302eb4077498b" href="../../R/6a8302eb4077498b.html" target="n" data-glyph="72,1" class="i method">GetWithInputHandlingForInvokeCommandWithUsingExpression</a>(<span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r450 rd" class="r450 r">usingVariablesTuple</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;code should be unreachable&quot;</span>);
            <b>return</b> <b>null</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a function or filter definition.  The function is always named.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="dd61b2a7b388405b" href="../../R/dd61b2a7b388405b.html" target="n" data-glyph="0,0" class="t t">FunctionDefinitionAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>, <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a function definition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r451 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the function definition, starting with the function or filter keyword, ending at the closing curly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r452 r">isFilter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the filter keyword was used.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r453 r">isWorkflow</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the workflow keyword was used.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r454 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r455 r">parameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameters specified after the function name.  This does not include parameters specified with a param statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r456 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body of the function/filter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r451 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r454 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r456 r">body</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null, or</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r454 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is an empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="cb99d3eff97e5b74" href="../../R/cb99d3eff97e5b74.html" target="n" data-glyph="72,1" class="t constructor">FunctionDefinitionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r451 rd" class="r451 r">extent</span>,
                                     <b>bool</b> <span id="r452 rd" class="r452 r">isFilter</span>,
                                     <b>bool</b> <span id="r453 rd" class="r453 r">isWorkflow</span>,
                                     <b>string</b> <span id="r454 rd" class="r454 r">name</span>,
                                     <span class="i">IEnumerable</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r455 rd" class="r455 r">parameters</span>,
                                     <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r456 rd" class="r456 r">body</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r451 r">extent</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r454 r">name</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r454 r">name</span>));
            }
 
            <b>if</b> (<span class="r456 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r456 r">body</span>));
            }
 
            <b>if</b> (<span class="r452 r">isFilter</span> &amp;&amp; <span class="r453 r">isWorkflow</span>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r452 r">isFilter</span>));
            }
 
            <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#705ac8788be4b00f" class="i property">IsFilter</a> = <span class="r452 r">isFilter</span>;
            <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#d87e1032aa3dac41" class="i property">IsWorkflow</a> = <span class="r453 r">isWorkflow</span>;
 
            <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#951cc91108156df0" class="i property">Name</a> = <span class="r454 r">name</span>;
            <b>if</b> (<span class="r455 r">parameters</span> != <b>null</b> &amp;&amp; <span class="r455 r">parameters</span>.<span class="i">Any</span>())
            {
                <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#653a0e4bf79364c2" class="i property">Parameters</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;(<span class="r455 r">parameters</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#653a0e4bf79364c2" class="i property">Parameters</a>);
            }
 
            <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#201bce3cfc040274" class="i property">Body</a> = <span class="r456 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r456 r">body</span>);
        }
 
        <b>internal</b> <a id="342e27d35cd2189e" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">FunctionDefinitionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r457 rd" class="r457 r">extent</span>,
                                       <b>bool</b> <span id="r458 rd" class="r458 r">isFilter</span>,
                                       <b>bool</b> <span id="r459 rd" class="r459 r">isWorkflow</span>,
                                       <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r460 rd" class="r460 r">functionNameToken</span>,
                                       <span class="i">IEnumerable</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r461 rd" class="r461 r">parameters</span>,
                                       <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r462 rd" class="r462 r">body</span>)
            : <a href="#cb99d3eff97e5b74" class="k">this</a>(<span class="r457 r">extent</span>,
                   <span class="r458 r">isFilter</span>,
                   <span class="r459 r">isWorkflow</span>,
                   (<span class="r460 r">functionNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>) ? ((<a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>)<span class="r460 r">functionNameToken</span>).<a href="token.cs.html#f95f094124370df7" class="i property">Value</a> : <span class="r460 r">functionNameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>,
                   <span class="r461 r">parameters</span>,
                   <span class="r462 r">body</span>)
        {
            <a href="#8ec8b89e52c97e95" class="i property">NameExtent</a> = <span class="r460 r">functionNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the filter keyword was used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="705ac8788be4b00f" href="../../R/705ac8788be4b00f.html" target="n" data-glyph="102,1" class="i property">IsFilter</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the workflow keyword was used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="d87e1032aa3dac41" href="../../R/d87e1032aa3dac41.html" target="n" data-glyph="102,1" class="i property">IsWorkflow</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function or filter.  This property is never null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="951cc91108156df0" href="../../R/951cc91108156df0.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameters specified immediately after the function name, or null if no parameters were specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">It is possible that this property may have a value and </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#6f963589327835a4" class="t t">ScriptBlockAst</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to also have a</span>
        <span class="c">///</span><span class="c"> value.  Normally this is not allowed in a valid script, but in one rare case it is allowed:</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">function foo() { param($a) }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In this example, the parameters specified after the function name must be empty or the script is not valid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="653a0e4bf79364c2" href="../../R/653a0e4bf79364c2.html" target="n" data-glyph="102,1" class="i property">Parameters</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The body of the function.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="201bce3cfc040274" href="../../R/201bce3cfc040274.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <b>internal</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="8ec8b89e52c97e95" href="../../R/8ec8b89e52c97e95.html" target="n" data-glyph="104,1" class="i property">NameExtent</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the help content, if any, for the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#3e2184322a40858b" class="t t">CommentHelpInfo</a> <a id="f497d497efadc1f0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHelpContent</a>()
        {
            <span class="i">Dictionary</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt; <span id="r463 rd" class="r463 r">scriptBlockTokenCache</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt;();
            <b>var</b> <span id="r464 rd" class="r464 r">commentTokens</span> = <a href="../../help/HelpCommentsParser.cs.html#9f10a00eb0f83566" class="t t">HelpCommentsParser</a>.<a href="../../help/HelpCommentsParser.cs.html#20a6987da91cc728" class="i method">GetHelpCommentTokens</a>(<a href="#dd61b2a7b388405b" class="k">this</a>, <span class="r463 r">scriptBlockTokenCache</span>);
            <b>if</b> (<span class="r464 r">commentTokens</span> != <b>null</b>)
            {
                <b>return</b> <a href="../../help/HelpCommentsParser.cs.html#9f10a00eb0f83566" class="t t">HelpCommentsParser</a>.<span class="i">GetHelpContents</span>(<span class="r464 r">commentTokens</span>.<span class="i">Item1</span>, <span class="r464 r">commentTokens</span>.<span class="i">Item2</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the help content, if any, for the function.</span>
        <span class="c">///</span><span class="c"> Use this overload when parsing multiple functions within a single scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r465 r">scriptBlockTokenCache</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A dictionary that the parser will use to</span>
        <span class="c">///</span><span class="c"> map AST nodes to their respective tokens. The parser uses this to improve performance</span>
        <span class="c">///</span><span class="c"> while repeatedly parsing the parent script blocks of a function (since the parent</span>
        <span class="c">///</span><span class="c"> script blocks may contain help comments related to this function.</span>
        <span class="c">///</span><span class="c"> To conserve memory, clear / null-out this cache when done with repeated parsing.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#3e2184322a40858b" class="t t">CommentHelpInfo</a> <a id="02fe3ac328e74ed0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHelpContent</a>(<span class="i">Dictionary</span>&lt;<a href="#d47621d83efd14de" class="t t">Ast</a>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[]&gt; <span id="r465 rd" class="r465 r">scriptBlockTokenCache</span>)
        {
            <b>if</b> (<span class="r465 r">scriptBlockTokenCache</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r465 r">scriptBlockTokenCache</span>));
            }
 
            <b>var</b> <span id="r466 rd" class="r466 r">commentTokens</span> = <a href="../../help/HelpCommentsParser.cs.html#9f10a00eb0f83566" class="t t">HelpCommentsParser</a>.<a href="../../help/HelpCommentsParser.cs.html#20a6987da91cc728" class="i method">GetHelpCommentTokens</a>(<a href="#dd61b2a7b388405b" class="k">this</a>, <span class="r465 r">scriptBlockTokenCache</span>);
            <b>if</b> (<span class="r466 r">commentTokens</span> != <b>null</b>)
            {
                <b>return</b> <a href="../../help/HelpCommentsParser.cs.html#9f10a00eb0f83566" class="t t">HelpCommentsParser</a>.<span class="i">GetHelpContents</span>(<span class="r466 r">commentTokens</span>.<span class="i">Item1</span>, <span class="r466 r">commentTokens</span>.<span class="i">Item2</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the FunctionDefinitionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="0cc8258f1aefc89f" href="../../R/0cc8258f1aefc89f.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r467 rd" class="r467 r">newParameters</span> = <span class="i">CopyElements</span>(<a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#653a0e4bf79364c2" class="i property">Parameters</a>);
            <a href="#6f963589327835a4" class="k">var</a> <span id="r468 rd" class="r468 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#201bce3cfc040274" class="i property">Body</a>);
 
            <b>return</b> <b>new</b> <span class="t">FunctionDefinitionAst</span>(<a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#705ac8788be4b00f" class="i property">IsFilter</a>, <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#d87e1032aa3dac41" class="i property">IsWorkflow</a>, <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#951cc91108156df0" class="i property">Name</a>, <span class="r467 r">newParameters</span>, <span class="r468 r">newBody</span>) { <a href="#8ec8b89e52c97e95" class="i property">NameExtent</a> = <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#8ec8b89e52c97e95" class="i property">NameExtent</a> };
        }
 
        <b>internal string</b> <a id="98eceea7e3f7c2a6" href="../../R/98eceea7e3f7c2a6.html" target="n" data-glyph="74,1" class="i method">GetParamTextFromParameterList</a>(<span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r469 rd" class="r469 r">usingVariablesTuple</span> = <b>null</b>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#653a0e4bf79364c2" class="i property">Parameters</a> != <b>null</b>, <span class="s">&quot;Caller makes sure that Parameters is not null before calling this method.&quot;</span>);
 
            <b>string</b> <span id="r470 rd" class="r470 r">additionalNewUsingParams</span> = <b>null</b>;
            <span class="i">IEnumerator</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt; <span id="r471 rd" class="r471 r">orderedUsingVars</span> = <b>null</b>;
            <b>if</b> (<span class="r469 r">usingVariablesTuple</span> != <b>null</b>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(
                    <span class="r469 r">usingVariablesTuple</span>.<span class="i">Item1</span> != <b>null</b> &amp;&amp; <span class="r469 r">usingVariablesTuple</span>.<span class="i">Item1</span>.<span class="i">Count</span> &gt; 0 &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r469 r">usingVariablesTuple</span>.<span class="i">Item2</span>),
                    <span class="s">&quot;Caller makes sure the value passed in is not null or empty.&quot;</span>);
                <span class="r471 r">orderedUsingVars</span> = <span class="r469 r">usingVariablesTuple</span>.<span class="i">Item1</span>.<span class="i">OrderBy</span>(<b>static</b> <span id="r472 rd" class="r472 r">varAst</span> =&gt; <span class="r472 r">varAst</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span>).<span class="i">GetEnumerator</span>();
                <span class="r470 r">additionalNewUsingParams</span> = <span class="r469 r">usingVariablesTuple</span>.<span class="i">Item2</span>;
            }
 
            <b>var</b> <span id="r473 rd" class="r473 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="s">&quot;param(&quot;</span>);
            <b>string</b> <span id="r474 rd" class="r474 r">separator</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r470 r">additionalNewUsingParams</span> != <b>null</b>)
            {
                <span class="c">// Add the $using variable parameters if necessary</span>
                <span class="r473 r">sb</span>.<span class="i">Append</span>(<span class="r470 r">additionalNewUsingParams</span>);
                <span class="r474 r">separator</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <b>for</b> (<b>int</b> <span id="r475 rd" class="r475 r">i</span> = 0; <span class="r475 r">i</span> &lt; <a href="#653a0e4bf79364c2" class="i property">Parameters</a>.<span class="i">Count</span>; <span class="r475 r">i</span>++)
            {
                <b>var</b> <span id="r476 rd" class="r476 r">param</span> = <a href="#653a0e4bf79364c2" class="i property">Parameters</a>[<span class="r475 r">i</span>];
                <span class="r473 r">sb</span>.<span class="i">Append</span>(<span class="r474 r">separator</span>);
                <span class="r473 r">sb</span>.<span class="i">Append</span>(<span class="r471 r">orderedUsingVars</span> != <b>null</b>
                              ? <span class="r476 r">param</span>.<span class="i">GetParamTextWithDollarUsingHandling</span>(<span class="r471 r">orderedUsingVars</span>)
                              : <span class="r476 r">param</span>.<span class="i">ToString</span>());
                <span class="r474 r">separator</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <span class="r473 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;)&#39;</span>);
            <span class="r473 r">sb</span>.<span class="i">Append</span>(<span class="i">Environment</span>.<span class="i">NewLine</span>);
 
            <b>return</b> <span class="r473 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="eb2a5381f07e349a" href="../../R/eb2a5381f07e349a.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r477 rd" class="r477 r">visitor</span>)
        {
            <b>return</b> <span class="r477 r">visitor</span>.<a href="AstVisitor.cs.html#359901345df93b2a" class="i method">VisitFunctionDefinition</a>(<a href="#dd61b2a7b388405b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="79990ab5c4c3c8c9" href="../../R/79990ab5c4c3c8c9.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r478 rd" class="r478 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r479 rd" class="r479 r">action</span> = <span class="r478 r">visitor</span>.<a href="PreOrderVisitor.cs.html#d9e0ef598f56791a" class="i method">VisitFunctionDefinition</a>(<a href="#dd61b2a7b388405b" class="k">this</a>);
            <b>if</b> (<span class="r479 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r478 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#dd61b2a7b388405b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r479 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>if</b> (<a href="#653a0e4bf79364c2" class="i property">Parameters</a> != <b>null</b>)
                {
                    <b>for</b> (<b>int</b> <span id="r480 rd" class="r480 r">index</span> = 0; <span class="r480 r">index</span> &lt; <a href="#653a0e4bf79364c2" class="i property">Parameters</a>.<span class="i">Count</span>; <span class="r480 r">index</span>++)
                    {
                        <b>var</b> <span id="r481 rd" class="r481 r">param</span> = <a href="#653a0e4bf79364c2" class="i property">Parameters</a>[<span class="r480 r">index</span>];
                        <span class="r479 r">action</span> = <span class="r481 r">param</span>.<span class="i">InternalVisit</span>(<span class="r478 r">visitor</span>);
                        <b>if</b> (<span class="r479 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r479 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    <span class="r479 r">action</span> = <a href="#201bce3cfc040274" class="i property">Body</a>.<a href="#360723934e684b68" class="i method">InternalVisit</a>(<span class="r478 r">visitor</span>);
            }
 
            <b>return</b> <span class="r478 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#dd61b2a7b388405b" class="k">this</a>, <span class="r479 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IParameterMetadataProvider implementation
 
        <b>bool</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#dea65be215e5a292" class="i method">HasAnyScriptBlockAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#201bce3cfc040274" class="i property">Body</a>).<a href="#dea65be215e5a292" class="i method">HasAnyScriptBlockAttributes</a>();
        }
 
        <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#c8000536ef7797f3" class="i method">GetParameterMetadata</a>(<b>bool</b> <span id="r482 rd" class="r482 r">automaticPositions</span>, <b>ref bool</b> <span id="r483 rd" class="r483 r">usesCmdletBinding</span>)
        {
            <b>if</b> (<a href="#653a0e4bf79364c2" class="i property">Parameters</a> != <b>null</b>)
            {
                <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="Compiler.cs.html#8ad349e7ea45c522" class="i method">GetParameterMetaData</a>(<a href="#653a0e4bf79364c2" class="i property">Parameters</a>, <span class="r482 r">automaticPositions</span>, <b>ref</b> <span class="r483 r">usesCmdletBinding</span>);
            }
 
            <b>if</b> (<a href="#201bce3cfc040274" class="i property">Body</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="Compiler.cs.html#8ad349e7ea45c522" class="i method">GetParameterMetaData</a>(<a href="#201bce3cfc040274" class="i property">Body</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>, <span class="r482 r">automaticPositions</span>, <b>ref</b> <span class="r483 r">usesCmdletBinding</span>);
            }
 
            <b>return</b> <b>new</b> <a href="../PseudoParameters.cs.html#fe6fd05e3511357a" class="t constructor">RuntimeDefinedParameterDictionary</a> { <a href="../PseudoParameters.cs.html#188173533cedce98" class="i property">Data</a> = <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a>.<a href="../PseudoParameters.cs.html#8c8a683808508461" class="i field">EmptyParameterArray</a> };
        }
 
        <span class="i">IEnumerable</span>&lt;<span class="i">Attribute</span>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#5268a33bec21621c" class="i method">GetScriptBlockAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#201bce3cfc040274" class="i property">Body</a>).<a href="#5268a33bec21621c" class="i method">GetScriptBlockAttributes</a>();
        }
 
        <span class="i">IEnumerable</span>&lt;<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#8aeaf9e21660f350" class="i method">GetExperimentalAttributes</a>()
        {
            <b>return</b> ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#201bce3cfc040274" class="i property">Body</a>).<a href="#8aeaf9e21660f350" class="i method">GetExperimentalAttributes</a>();
        }
 
        <span class="i">ReadOnlyCollection</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#57fef4bbca7ab95c" class="i property">Parameters</a>
        {
            <b>get</b> { <b>return</b> <a href="#653a0e4bf79364c2" class="i property">Parameters</a> ?? (<a href="#201bce3cfc040274" class="i property">Body</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>?.<a href="#ffac8f01ede94077" class="i property">Parameters</a>); }
        }
 
        <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#43e8e80a08c89ef8" class="i method">GetPowerShell</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r484 rd" class="r484 r">context</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r485 rd" class="r485 r">variables</span>, <b>bool</b> <span id="r486 rd" class="r486 r">isTrustedInput</span>,
            <b>bool</b> <span id="r487 rd" class="r487 r">filterNonUsingVariables</span>, <b>bool</b>? <span id="r488 rd" class="r488 r">createLocalScope</span>, <b>params object</b>[] <span id="r489 rd" class="r489 r">args</span>)
        {
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#3dcd207b1b77d402" class="i method">CheckStackDepth</a>();
            <b>return</b> <a href="../runtime/ScriptBlockToPowerShell.cs.html#a1edebc1e23d4bb8" class="t t">ScriptBlockToPowerShellConverter</a>.<a href="../runtime/ScriptBlockToPowerShell.cs.html#436ad3b875b6f173" class="i method">Convert</a>(<a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#201bce3cfc040274" class="i property">Body</a>, <a href="#dd61b2a7b388405b" class="k">this</a>.<a href="#653a0e4bf79364c2" class="i property">Parameters</a>, <span class="r486 r">isTrustedInput</span>, <span class="r484 r">context</span>, <span class="r485 r">variables</span>, <span class="r487 r">filterNonUsingVariables</span>, <span class="r488 r">createLocalScope</span>, <span class="r489 r">args</span>);
        }
 
        <b>string</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#9eb35ed25013c0ba" class="i method">GetWithInputHandlingForInvokeCommand</a>()
        {
            <b>string</b> <span id="r490 rd" class="r490 r">result</span> = ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#201bce3cfc040274" class="i property">Body</a>).<a href="#9eb35ed25013c0ba" class="i method">GetWithInputHandlingForInvokeCommand</a>();
            <b>return</b> <a href="#653a0e4bf79364c2" class="i property">Parameters</a> == <b>null</b> ? <span class="r490 r">result</span> : (<a href="#98eceea7e3f7c2a6" class="i method">GetParamTextFromParameterList</a>() + <span class="r490 r">result</span>);
        }
 
        <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt; <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#65bd5fb5ed6ed146" class="i method">GetWithInputHandlingForInvokeCommandWithUsingExpression</a>(
            <span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;, <b>string</b>&gt; <span id="r491 rd" class="r491 r">usingVariablesTuple</span>)
        {
            <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt; <span id="r492 rd" class="r492 r">result</span> =
                ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#201bce3cfc040274" class="i property">Body</a>).<a href="#65bd5fb5ed6ed146" class="i method">GetWithInputHandlingForInvokeCommandWithUsingExpression</a>(<span class="r491 r">usingVariablesTuple</span>);
 
            <b>if</b> (<a href="#653a0e4bf79364c2" class="i property">Parameters</a> == <b>null</b>)
            {
                <b>return</b> <span class="r492 r">result</span>;
            }
 
            <b>string</b> <span id="r493 rd" class="r493 r">paramText</span> = <a href="#98eceea7e3f7c2a6" class="i method">GetParamTextFromParameterList</a>(<span class="r491 r">usingVariablesTuple</span>);
            <b>return</b> <b>new</b> <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="r493 r">paramText</span>, <span class="r492 r">result</span>.<span class="i">Item2</span>);
        }
 
        <b>bool</b> <a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>.<a href="#960da0e2b7046796" class="i method">UsesCmdletBinding</a>()
        {
            <b>bool</b> <span id="r494 rd" class="r494 r">usesCmdletBinding</span> = <b>false</b>;
            <b>if</b> (<a href="#653a0e4bf79364c2" class="i property">Parameters</a> != <b>null</b>)
            {
                <span class="r494 r">usesCmdletBinding</span> = <a href="#be95362bdc5e7d07" class="t t">ParamBlockAst</a>.<span class="i">UsesCmdletBinding</span>(<a href="#653a0e4bf79364c2" class="i property">Parameters</a>);
            }
            <b>else</b> <b>if</b> (<a href="#201bce3cfc040274" class="i property">Body</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <span class="r494 r">usesCmdletBinding</span> = ((<a href="#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<a href="#201bce3cfc040274" class="i property">Body</a>).<a href="#960da0e2b7046796" class="i method">UsesCmdletBinding</a>();
            }
 
            <b>return</b> <span class="r494 r">usesCmdletBinding</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IParameterMetadataProvider implementation
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an if statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="5371982d66a6137d" href="../../R/5371982d66a6137d.html" target="n" data-glyph="0,0" class="t t">IfStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an if statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r495 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the statement, starting with the if keyword, ending at the closing curly of the last clause.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r496 r">clauses</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A non-empty collection of pairs of condition expressions and statement blocks.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r497 r">elseClause</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The else clause, or null if no clause was specified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r495 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r496 r">clauses</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1006:DoNotNestGenericTypesInMemberSignatures&quot;</span>)]
        <b>public</b> <a id="662625600f3f2d71" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">IfStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r495 rd" class="r495 r">extent</span>, <span class="i">IEnumerable</span>&lt;<span class="i">IfClause</span>&gt; <span id="r496 rd" class="r496 r">clauses</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r497 rd" class="r497 r">elseClause</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r495 r">extent</span>)
        {
            <b>if</b> (<span class="r496 r">clauses</span> == <b>null</b> || !<span class="r496 r">clauses</span>.<span class="i">Any</span>())
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r496 r">clauses</span>));
            }
 
            <a href="#5371982d66a6137d" class="k">this</a>.<a href="#7467cf9a24b469f1" class="i property">Clauses</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<span class="i">IfClause</span>&gt;(<span class="r496 r">clauses</span>.<span class="i">ToArray</span>());
            <span class="i">SetParents</span>(<a href="#7467cf9a24b469f1" class="i property">Clauses</a>);
 
            <b>if</b> (<span class="r497 r">elseClause</span> != <b>null</b>)
            {
                <a href="#5371982d66a6137d" class="k">this</a>.<a href="#6cff2184cfb69977" class="i property">ElseClause</a> = <span class="r497 r">elseClause</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r497 r">elseClause</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts representing a pair of (condition,statements) that are tested, in sequence until the first condition</span>
        <span class="c">///</span><span class="c"> tests true, in which case it&#39;s statements are executed, otherwise the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#6cff2184cfb69977" class="i property">ElseClause</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, if any, is</span>
        <span class="c">///</span><span class="c"> executed.  This property is never null and always has at least 1 value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1006:DoNotNestGenericTypesInMemberSignatures&quot;</span>)]
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<span class="i">IfClause</span>&gt; <a id="7467cf9a24b469f1" href="../../R/7467cf9a24b469f1.html" target="n" data-glyph="102,1" class="i property">Clauses</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the else clause, or null if no else clause is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="6cff2184cfb69977" href="../../R/6cff2184cfb69977.html" target="n" data-glyph="102,1" class="i property">ElseClause</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the IfStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="57b109acaa59326a" href="../../R/57b109acaa59326a.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r498 rd" class="r498 r">newClauses</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">IfClause</span>&gt;(<a href="#5371982d66a6137d" class="k">this</a>.<a href="#7467cf9a24b469f1" class="i property">Clauses</a>.<span class="i">Count</span>);
            <b>for</b> (<b>int</b> <span id="r499 rd" class="r499 r">i</span> = 0; <span class="r499 r">i</span> &lt; <a href="#5371982d66a6137d" class="k">this</a>.<a href="#7467cf9a24b469f1" class="i property">Clauses</a>.<span class="i">Count</span>; <span class="r499 r">i</span>++)
            {
                <b>var</b> <span id="r500 rd" class="r500 r">clause</span> = <a href="#5371982d66a6137d" class="k">this</a>.<a href="#7467cf9a24b469f1" class="i property">Clauses</a>[<span class="r499 r">i</span>];
                <span class="r27 r t">var</span> <span id="r501 rd" class="r501 r">newCondition</span> = <span class="i">CopyElement</span>(<span class="r500 r">clause</span>.<span class="i">Item1</span>);
                <span class="r27 r t">var</span> <span id="r502 rd" class="r502 r">newStatementBlock</span> = <span class="i">CopyElement</span>(<span class="r500 r">clause</span>.<span class="i">Item2</span>);
 
                <span class="r498 r">newClauses</span>.<span class="i">Add</span>(<span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r501 r">newCondition</span>, <span class="r502 r">newStatementBlock</span>));
            }
 
            <a href="#268644c84b225866" class="k">var</a> <span id="r503 rd" class="r503 r">newElseClause</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#5371982d66a6137d" class="k">this</a>.<a href="#6cff2184cfb69977" class="i property">ElseClause</a>);
            <b>return</b> <b>new</b> <span class="t">IfStatementAst</span>(<a href="#5371982d66a6137d" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r498 r">newClauses</span>, <span class="r503 r">newElseClause</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="338c084d5b708f11" href="../../R/338c084d5b708f11.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r504 rd" class="r504 r">visitor</span>)
        {
            <b>return</b> <span class="r504 r">visitor</span>.<a href="AstVisitor.cs.html#8ca9dd24dec14fa2" class="i method">VisitIfStatement</a>(<a href="#5371982d66a6137d" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="5eac17591626a1ff" href="../../R/5eac17591626a1ff.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r505 rd" class="r505 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r506 rd" class="r506 r">action</span> = <span class="r505 r">visitor</span>.<a href="PreOrderVisitor.cs.html#b07f679b3e16acbd" class="i method">VisitIfStatement</a>(<a href="#5371982d66a6137d" class="k">this</a>);
            <b>if</b> (<span class="r506 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r505 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#5371982d66a6137d" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r506 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r507 rd" class="r507 r">index</span> = 0; <span class="r507 r">index</span> &lt; <a href="#7467cf9a24b469f1" class="i property">Clauses</a>.<span class="i">Count</span>; <span class="r507 r">index</span>++)
                {
                    <b>var</b> <span id="r508 rd" class="r508 r">ifClause</span> = <a href="#7467cf9a24b469f1" class="i property">Clauses</a>[<span class="r507 r">index</span>];
                    <span class="r506 r">action</span> = <span class="r508 r">ifClause</span>.<span class="i">Item1</span>.<span class="i">InternalVisit</span>(<span class="r505 r">visitor</span>);
                    <b>if</b> (<span class="r506 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                    <span class="r506 r">action</span> = <span class="r508 r">ifClause</span>.<span class="i">Item2</span>.<span class="i">InternalVisit</span>(<span class="r505 r">visitor</span>);
                    <b>if</b> (<span class="r506 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r506 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#6cff2184cfb69977" class="i property">ElseClause</a> != <b>null</b>)
            {
                <span class="r506 r">action</span> = <a href="#6cff2184cfb69977" class="i property">ElseClause</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r505 r">visitor</span>);
            }
 
            <b>return</b> <span class="r505 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#5371982d66a6137d" class="k">this</a>, <span class="r506 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the data statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="37c175482122764b" href="../../R/37c175482122764b.html" target="n" data-glyph="0,0" class="t t">DataStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <b>private static readonly</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>[] <a id="14be867b1c430375" href="../../R/14be867b1c430375.html" target="n" data-glyph="46,1" class="i field">s_emptyCommandsAllowed</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a data statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r509 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the data statement, extending from the data keyword to the closing curly brace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r510 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable, if specified, otherwise null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r511 r">commandsAllowed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list of commands allowed in the data statement, if specified, otherwise null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r512 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body of the data statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r509 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r512 r">body</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="28decacf7b7700d9" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">DataStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r509 rd" class="r509 r">extent</span>,
                                <b>string</b> <span id="r510 rd" class="r510 r">variableName</span>,
                                <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r511 rd" class="r511 r">commandsAllowed</span>,
                                <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r512 rd" class="r512 r">body</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r509 r">extent</span>)
        {
            <b>if</b> (<span class="r512 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r512 r">body</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r510 r">variableName</span>))
            {
                <span class="r510 r">variableName</span> = <b>null</b>;
            }
 
            <a href="#37c175482122764b" class="k">this</a>.<a href="#9eb92e727e59a7eb" class="i property">Variable</a> = <span class="r510 r">variableName</span>;
            <b>if</b> (<span class="r511 r">commandsAllowed</span> != <b>null</b> &amp;&amp; <span class="r511 r">commandsAllowed</span>.<span class="i">Any</span>())
            {
                <a href="#37c175482122764b" class="k">this</a>.<a href="#11fb9d287a8e9308" class="i property">CommandsAllowed</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;(<span class="r511 r">commandsAllowed</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#11fb9d287a8e9308" class="i property">CommandsAllowed</a>);
                <a href="#37c175482122764b" class="k">this</a>.<a href="#fd85adecda14b40c" class="i property">HasNonConstantAllowedCommand</a> = <a href="#11fb9d287a8e9308" class="i property">CommandsAllowed</a>.<span class="i">Any</span>(<b>static</b> <span id="r513 rd" class="r513 r">ast</span> =&gt; <span class="r513 r">ast</span> <b>is not</b> <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>);
            }
            <b>else</b>
            {
                <a href="#37c175482122764b" class="k">this</a>.<a href="#11fb9d287a8e9308" class="i property">CommandsAllowed</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;(<a href="#14be867b1c430375" class="i field">s_emptyCommandsAllowed</a>);
            }
 
            <a href="#37c175482122764b" class="k">this</a>.<a href="#75dab9efd3d1b59e" class="i property">Body</a> = <span class="r512 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r512 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable this data statement sets, or null if no variable name was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="9eb92e727e59a7eb" href="../../R/9eb92e727e59a7eb.html" target="n" data-glyph="102,1" class="i property">Variable</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The asts naming the commands allowed to execute in this data statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="11fb9d287a8e9308" href="../../R/11fb9d287a8e9308.html" target="n" data-glyph="102,1" class="i property">CommandsAllowed</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the body of the data statement.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="75dab9efd3d1b59e" href="../../R/75dab9efd3d1b59e.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the DataStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="379150106cc02e0c" href="../../R/379150106cc02e0c.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r514 rd" class="r514 r">newCommandsAllowed</span> = <span class="i">CopyElements</span>(<a href="#37c175482122764b" class="k">this</a>.<a href="#11fb9d287a8e9308" class="i property">CommandsAllowed</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r515 rd" class="r515 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#37c175482122764b" class="k">this</a>.<a href="#75dab9efd3d1b59e" class="i property">Body</a>);
            <b>return</b> <b>new</b> <span class="t">DataStatementAst</span>(<a href="#37c175482122764b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#37c175482122764b" class="k">this</a>.<a href="#9eb92e727e59a7eb" class="i property">Variable</a>, <span class="r514 r">newCommandsAllowed</span>, <span class="r515 r">newBody</span>);
        }
 
        <b>internal bool</b> <a id="fd85adecda14b40c" href="../../R/fd85adecda14b40c.html" target="n" data-glyph="104,1" class="i property">HasNonConstantAllowedCommand</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="eb3262da956234b3" href="../../R/eb3262da956234b3.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r516 rd" class="r516 r">visitor</span>)
        {
            <b>return</b> <span class="r516 r">visitor</span>.<a href="AstVisitor.cs.html#3e577da7aae40944" class="i method">VisitDataStatement</a>(<a href="#37c175482122764b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="4acbabd834ab0d91" href="../../R/4acbabd834ab0d91.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r517 rd" class="r517 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r518 rd" class="r518 r">action</span> = <span class="r517 r">visitor</span>.<a href="PreOrderVisitor.cs.html#be13af0e1b9d1000" class="i method">VisitDataStatement</a>(<a href="#37c175482122764b" class="k">this</a>);
            <b>if</b> (<span class="r518 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r517 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#37c175482122764b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r518 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r518 r">action</span> = <a href="#75dab9efd3d1b59e" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r517 r">visitor</span>);
            <b>return</b> <span class="r517 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#37c175482122764b" class="k">this</a>, <span class="r518 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Code Generation Details
 
        <b>internal int</b> <a id="5f228d7fc0478b96" href="../../R/5f228d7fc0478b96.html" target="n" data-glyph="104,1" class="i property">TupleIndex</a> { <b>get</b>; <b>set</b>; } = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#6aefafdf223b7beb" class="i field">Unanalyzed</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Code Generation Details
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Looping Statements
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class for statements that have labels such as a while statement or a switch statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="056fe4b6395c295c" href="../../R/056fe4b6395c295c.html" target="n" data-glyph="0,0" class="t t">LabeledStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the properties common to labeled statements.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r519 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r520 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label for the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r521 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null pipeline for the condition test of the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r519 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="a345d961d1befe22" href="../../R/a345d961d1befe22.html" target="n" data-glyph="75,1" class="t constructor">LabeledStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r519 rd" class="r519 r">extent</span>, <b>string</b> <span id="r520 rd" class="r520 r">label</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r521 rd" class="r521 r">condition</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r519 r">extent</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r520 r">label</span>))
            {
                <span class="r520 r">label</span> = <b>null</b>;
            }
 
            <a href="#056fe4b6395c295c" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a> = <span class="r520 r">label</span>;
            <b>if</b> (<span class="r521 r">condition</span> != <b>null</b>)
            {
                <a href="#056fe4b6395c295c" class="k">this</a>.<a href="#933ad75377815bca" class="i property">Condition</a> = <span class="r521 r">condition</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r521 r">condition</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The label name if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="6e78c18e515b91da" href="../../R/6e78c18e515b91da.html" target="n" data-glyph="102,1" class="i property">Label</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the condition that is tested on each iteration of the loop, or the condition tested on a switch.</span>
        <span class="c">///</span><span class="c"> This property may be null if the statement is a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4ca51f16f7c100d4" class="t t">ForStatementAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, otherwise it is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="933ad75377815bca" href="../../R/933ad75377815bca.html" target="n" data-glyph="102,1" class="i property">Condition</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class for looping statements including a the do/while statement, the do/until statement,</span>
    <span class="c">///</span><span class="c"> the foreach statement, the for statement, and the while statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="931b3c793b175596" href="../../R/931b3c793b175596.html" target="n" data-glyph="0,0" class="t t">LoopStatementAst</a> : <a href="#056fe4b6395c295c" class="t t">LabeledStatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the properties common to all loop statements.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r522 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r523 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label for the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r524 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null pipeline for the condition test of the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r525 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body of the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r522 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r525 r">body</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="a0b04ae0016a0999" href="../../R/a0b04ae0016a0999.html" target="n" data-glyph="75,1" class="t constructor">LoopStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r522 rd" class="r522 r">extent</span>, <b>string</b> <span id="r523 rd" class="r523 r">label</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r524 rd" class="r524 r">condition</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r525 rd" class="r525 r">body</span>)
            : <a href="#a345d961d1befe22" class="k">base</a>(<span class="r522 r">extent</span>, <span class="r523 r">label</span>, <span class="r524 r">condition</span>)
        {
            <b>if</b> (<span class="r525 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r525 r">body</span>));
            }
 
            <a href="#931b3c793b175596" class="k">this</a>.<a href="#246ea985df627fa9" class="i property">Body</a> = <span class="r525 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r525 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The body of a loop statement.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="246ea985df627fa9" href="../../R/246ea985df627fa9.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Flags that are specified on a foreach statement.  Values may be or&#39;ed together, not all invalid combinations</span>
    <span class="c">///</span><span class="c"> of flags are detected.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="23c2c283246ee841" href="../../R/23c2c283246ee841.html" target="n" data-glyph="18,0" class="t t"><span id="ee223de54f322005">ForEachFlags</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No flags specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9936c14ad16b99e7" href="../../R/9936c14ad16b99e7.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x00,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The -parallel flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="15784204dbd0f70a" href="../../R/15784204dbd0f70a.html" target="n" data-glyph="24,1" class="i field">Parallel</a> = 0x01,
 
        <span class="c">// If any flags are added that impact evaluation of items during the foreach statement, then</span>
        <span class="c">// a binder (and caching strategy) needs to be added similar to SwitchClauseEvalBinder.</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the foreach statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="9ae6aa2909fef7b0" href="../../R/9ae6aa2909fef7b0.html" target="n" data-glyph="0,0" class="t t">ForEachStatementAst</a> : <a href="#931b3c793b175596" class="t t">LoopStatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a foreach statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r526 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the statement, starting from the optional label or the foreach keyword and ending at the closing curly brace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r527 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r528 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Any flags that affect how the foreach statement is processed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r529 r">variable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable set on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r530 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The pipeline generating values to iterate through.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r531 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body to execute for each element written from pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r526 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r530 r">expression</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r529 r">variable</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="49cf26686faa147d" href="../../R/49cf26686faa147d.html" target="n" data-glyph="72,1" class="t constructor">ForEachStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r526 rd" class="r526 r">extent</span>,
                                   <b>string</b> <span id="r527 rd" class="r527 r">label</span>,
                                   <a href="#23c2c283246ee841" class="t t">ForEachFlags</a> <span id="r528 rd" class="r528 r">flags</span>,
                                   <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r529 rd" class="r529 r">variable</span>,
                                   <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r530 rd" class="r530 r">expression</span>,
                                   <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r531 rd" class="r531 r">body</span>)
            : <a href="#a0b04ae0016a0999" class="k">base</a>(<span class="r526 r">extent</span>, <span class="r527 r">label</span>, <span class="r530 r">expression</span>, <span class="r531 r">body</span>)
        {
            <b>if</b> (<span class="r530 r">expression</span> == <b>null</b> || <span class="r529 r">variable</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r530 r">expression</span> == <b>null</b> ? <span class="s">&quot;expression&quot;</span> : <span class="s">&quot;variablePath&quot;</span>);
            }
 
            <a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#ceac4fea87d6a65a" class="i property">Flags</a> = <span class="r528 r">flags</span>;
            <a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#913a1ea5efca1400" class="i property">Variable</a> = <span class="r529 r">variable</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r529 r">variable</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a foreach statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r532 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the statement, starting from the optional label or the foreach keyword and ending at the closing curly brace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r533 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r534 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Any flags that affect how the foreach statement is processed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r535 r">throttleLimit</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The limit to be obeyed during parallel processing, if any.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r536 r">variable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable set on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r537 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The pipeline generating values to iterate through.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r538 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body to execute for each element written from pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r532 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r537 r">expression</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r536 r">variable</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="3187e658b485c638" href="../../R/3187e658b485c638.html" target="n" data-glyph="72,1" class="t constructor">ForEachStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r532 rd" class="r532 r">extent</span>,
                                   <b>string</b> <span id="r533 rd" class="r533 r">label</span>,
                                   <a href="#23c2c283246ee841" class="t t">ForEachFlags</a> <span id="r534 rd" class="r534 r">flags</span>,
                                   <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r535 rd" class="r535 r">throttleLimit</span>,
                                   <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r536 rd" class="r536 r">variable</span>,
                                   <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r537 rd" class="r537 r">expression</span>,
                                   <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r538 rd" class="r538 r">body</span>)
            : <a href="#49cf26686faa147d" class="k">this</a>(<span class="r532 r">extent</span>, <span class="r533 r">label</span>, <span class="r534 r">flags</span>, <span class="r536 r">variable</span>, <span class="r537 r">expression</span>, <span class="r538 r">body</span>)
        {
            <a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#5ff3ea0ed041de61" class="i property">ThrottleLimit</a> = <span class="r535 r">throttleLimit</span>;
            <b>if</b> (<span class="r535 r">throttleLimit</span> != <b>null</b>)
            {
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r535 r">throttleLimit</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable set for each item as the loop iterates.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <a id="913a1ea5efca1400" href="../../R/913a1ea5efca1400.html" target="n" data-glyph="102,1" class="i property">Variable</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The limit to be obeyed during parallel processing, if any.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="5ff3ea0ed041de61" href="../../R/5ff3ea0ed041de61.html" target="n" data-glyph="102,1" class="i property">ThrottleLimit</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flags, if any specified on the foreach statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#23c2c283246ee841" class="t t">ForEachFlags</a> <a id="ceac4fea87d6a65a" href="../../R/ceac4fea87d6a65a.html" target="n" data-glyph="102,1" class="i property">Flags</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ForEachStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="b365092c348b28c7" href="../../R/b365092c348b28c7.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#248562b22b336dec" class="k">var</a> <span id="r539 rd" class="r539 r">newVariable</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#913a1ea5efca1400" class="i property">Variable</a>);
            <a href="#86812479028959b8" class="k">var</a> <span id="r540 rd" class="r540 r">newExpression</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#933ad75377815bca" class="i property">Condition</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r541 rd" class="r541 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#246ea985df627fa9" class="i property">Body</a>);
 
            <b>if</b> (<a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#5ff3ea0ed041de61" class="i property">ThrottleLimit</a> != <b>null</b>)
            {
                <a href="#78a833319fe635b4" class="k">var</a> <span id="r542 rd" class="r542 r">newThrottleLimit</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#5ff3ea0ed041de61" class="i property">ThrottleLimit</a>);
                <b>return</b> <b>new</b> <a href="#3187e658b485c638" class="t constructor">ForEachStatementAst</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a>, <a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#ceac4fea87d6a65a" class="i property">Flags</a>, <span class="r542 r">newThrottleLimit</span>,
                                               <span class="r539 r">newVariable</span>, <span class="r540 r">newExpression</span>, <span class="r541 r">newBody</span>);
            }
 
            <b>return</b> <b>new</b> <a href="#49cf26686faa147d" class="t constructor">ForEachStatementAst</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a>, <a href="#9ae6aa2909fef7b0" class="k">this</a>.<a href="#ceac4fea87d6a65a" class="i property">Flags</a>, <span class="r539 r">newVariable</span>, <span class="r540 r">newExpression</span>, <span class="r541 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="8ce8a394173df5f1" href="../../R/8ce8a394173df5f1.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r543 rd" class="r543 r">visitor</span>)
        {
            <b>return</b> <span class="r543 r">visitor</span>.<a href="AstVisitor.cs.html#9b999dbbad291ba0" class="i method">VisitForEachStatement</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e0af16cefc4370ec" href="../../R/e0af16cefc4370ec.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r544 rd" class="r544 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r545 rd" class="r545 r">action</span> = <span class="r544 r">visitor</span>.<a href="PreOrderVisitor.cs.html#099872b21ebffcc9" class="i method">VisitForEachStatement</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>);
            <b>if</b> (<span class="r545 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r544 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r545 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r545 r">action</span> = <a href="#913a1ea5efca1400" class="i property">Variable</a>.<a href="#f6111212a2587de2" class="i method">InternalVisit</a>(<span class="r544 r">visitor</span>);
            <b>if</b> (<span class="r545 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r545 r">action</span> = <a href="#933ad75377815bca" class="i property">Condition</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r544 r">visitor</span>);
            <b>if</b> (<span class="r545 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r545 r">action</span> = <a href="#246ea985df627fa9" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r544 r">visitor</span>);
            <b>return</b> <span class="r544 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#9ae6aa2909fef7b0" class="k">this</a>, <span class="r545 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast for a for statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="4ca51f16f7c100d4" href="../../R/4ca51f16f7c100d4.html" target="n" data-glyph="0,0" class="t t">ForStatementAst</a> : <a href="#931b3c793b175596" class="t t">LoopStatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a for statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r546 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement, from the label or for keyword to the closing curly.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r547 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r548 r">initializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null initialization expression executed before the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r549 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null condition expression tested on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r550 r">iterator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null iteration expression executed after each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r551 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body executed on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r546 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="663e6bd4ab228bfe" href="../../R/663e6bd4ab228bfe.html" target="n" data-glyph="72,1" class="t constructor">ForStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r546 rd" class="r546 r">extent</span>,
                               <b>string</b> <span id="r547 rd" class="r547 r">label</span>,
                               <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r548 rd" class="r548 r">initializer</span>,
                               <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r549 rd" class="r549 r">condition</span>,
                               <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r550 rd" class="r550 r">iterator</span>,
                               <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r551 rd" class="r551 r">body</span>)
            : <a href="#a0b04ae0016a0999" class="k">base</a>(<span class="r546 r">extent</span>, <span class="r547 r">label</span>, <span class="r549 r">condition</span>, <span class="r551 r">body</span>)
        {
            <b>if</b> (<span class="r548 r">initializer</span> != <b>null</b>)
            {
                <a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#942ba53dacb0f05a" class="i property">Initializer</a> = <span class="r548 r">initializer</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r548 r">initializer</span>);
            }
 
            <b>if</b> (<span class="r550 r">iterator</span> != <b>null</b>)
            {
                <a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#48de440e240c2649" class="i property">Iterator</a> = <span class="r550 r">iterator</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r550 r">iterator</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the initialization expression of a for statement, or null if none was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="942ba53dacb0f05a" href="../../R/942ba53dacb0f05a.html" target="n" data-glyph="102,1" class="i property">Initializer</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the iteration expression of a for statement, or null if none was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="48de440e240c2649" href="../../R/48de440e240c2649.html" target="n" data-glyph="102,1" class="i property">Iterator</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ForStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="787f3bff9041a475" href="../../R/787f3bff9041a475.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r552 rd" class="r552 r">newInitializer</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#942ba53dacb0f05a" class="i property">Initializer</a>);
            <a href="#86812479028959b8" class="k">var</a> <span id="r553 rd" class="r553 r">newCondition</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#933ad75377815bca" class="i property">Condition</a>);
            <a href="#86812479028959b8" class="k">var</a> <span id="r554 rd" class="r554 r">newIterator</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#48de440e240c2649" class="i property">Iterator</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r555 rd" class="r555 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#246ea985df627fa9" class="i property">Body</a>);
 
            <b>return</b> <b>new</b> <a href="#663e6bd4ab228bfe" class="t constructor">ForStatementAst</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#4ca51f16f7c100d4" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a>, <span class="r552 r">newInitializer</span>, <span class="r553 r">newCondition</span>, <span class="r554 r">newIterator</span>, <span class="r555 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="c7f342ceba8f2f24" href="../../R/c7f342ceba8f2f24.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r556 rd" class="r556 r">visitor</span>)
        {
            <b>return</b> <span class="r556 r">visitor</span>.<a href="AstVisitor.cs.html#47b549bd35cd2549" class="i method">VisitForStatement</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="431c30ec1e4bbf5d" href="../../R/431c30ec1e4bbf5d.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r557 rd" class="r557 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r558 rd" class="r558 r">action</span> = <span class="r557 r">visitor</span>.<a href="PreOrderVisitor.cs.html#aee5e09eaf376368" class="i method">VisitForStatement</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>);
            <b>if</b> (<span class="r558 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r557 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r558 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#942ba53dacb0f05a" class="i property">Initializer</a> != <b>null</b>)
                <span class="r558 r">action</span> = <a href="#942ba53dacb0f05a" class="i property">Initializer</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r557 r">visitor</span>);
            <b>if</b> (<span class="r558 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#933ad75377815bca" class="i property">Condition</a> != <b>null</b>)
                <span class="r558 r">action</span> = <a href="#933ad75377815bca" class="i property">Condition</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r557 r">visitor</span>);
            <b>if</b> (<span class="r558 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#48de440e240c2649" class="i property">Iterator</a> != <b>null</b>)
                <span class="r558 r">action</span> = <a href="#48de440e240c2649" class="i property">Iterator</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r557 r">visitor</span>);
            <b>if</b> (<span class="r558 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r558 r">action</span> = <a href="#246ea985df627fa9" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r557 r">visitor</span>);
            <b>return</b> <span class="r557 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4ca51f16f7c100d4" class="k">this</a>, <span class="r558 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents the do/while statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b2d1fe560ff56deb" href="../../R/b2d1fe560ff56deb.html" target="n" data-glyph="0,0" class="t t">DoWhileStatementAst</a> : <a href="#931b3c793b175596" class="t t">LoopStatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a do/while statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r559 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the do/while statment from the label or do keyword to the closing curly brace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r560 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r561 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The condition tested on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r562 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body executed on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r559 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r561 r">condition</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="4c0084da04267c4f" href="../../R/4c0084da04267c4f.html" target="n" data-glyph="72,1" class="t constructor">DoWhileStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r559 rd" class="r559 r">extent</span>, <b>string</b> <span id="r560 rd" class="r560 r">label</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r561 rd" class="r561 r">condition</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r562 rd" class="r562 r">body</span>)
            : <a href="#a0b04ae0016a0999" class="k">base</a>(<span class="r559 r">extent</span>, <span class="r560 r">label</span>, <span class="r561 r">condition</span>, <span class="r562 r">body</span>)
        {
            <b>if</b> (<span class="r561 r">condition</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r561 r">condition</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the DoWhileStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="df13c3c9dba441b5" href="../../R/df13c3c9dba441b5.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r563 rd" class="r563 r">newCondition</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#b2d1fe560ff56deb" class="k">this</a>.<a href="#933ad75377815bca" class="i property">Condition</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r564 rd" class="r564 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#b2d1fe560ff56deb" class="k">this</a>.<a href="#246ea985df627fa9" class="i property">Body</a>);
            <b>return</b> <b>new</b> <a href="#4c0084da04267c4f" class="t constructor">DoWhileStatementAst</a>(<a href="#b2d1fe560ff56deb" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#b2d1fe560ff56deb" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a>, <span class="r563 r">newCondition</span>, <span class="r564 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="27e035ca5baa7a27" href="../../R/27e035ca5baa7a27.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r565 rd" class="r565 r">visitor</span>)
        {
            <b>return</b> <span class="r565 r">visitor</span>.<a href="AstVisitor.cs.html#3f06d936d5e628f9" class="i method">VisitDoWhileStatement</a>(<a href="#b2d1fe560ff56deb" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d20550cb1fc03aee" href="../../R/d20550cb1fc03aee.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r566 rd" class="r566 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r567 rd" class="r567 r">action</span> = <span class="r566 r">visitor</span>.<a href="PreOrderVisitor.cs.html#46d9bac33ac2bdfa" class="i method">VisitDoWhileStatement</a>(<a href="#b2d1fe560ff56deb" class="k">this</a>);
            <b>if</b> (<span class="r567 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r566 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#b2d1fe560ff56deb" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r567 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r567 r">action</span> = <a href="#933ad75377815bca" class="i property">Condition</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r566 r">visitor</span>);
            <b>if</b> (<span class="r567 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r567 r">action</span> = <a href="#246ea985df627fa9" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r566 r">visitor</span>);
            <b>return</b> <span class="r566 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#b2d1fe560ff56deb" class="k">this</a>, <span class="r567 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a do/until statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="d641b5faf306abeb" href="../../R/d641b5faf306abeb.html" target="n" data-glyph="0,0" class="t t">DoUntilStatementAst</a> : <a href="#931b3c793b175596" class="t t">LoopStatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a do/until statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r568 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement, from the label or do keyword to the closing curly brace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r569 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r570 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The condition tested on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r571 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body executed on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r568 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r570 r">condition</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="3f8786d40ee146dc" href="../../R/3f8786d40ee146dc.html" target="n" data-glyph="72,1" class="t constructor">DoUntilStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r568 rd" class="r568 r">extent</span>, <b>string</b> <span id="r569 rd" class="r569 r">label</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r570 rd" class="r570 r">condition</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r571 rd" class="r571 r">body</span>)
            : <a href="#a0b04ae0016a0999" class="k">base</a>(<span class="r568 r">extent</span>, <span class="r569 r">label</span>, <span class="r570 r">condition</span>, <span class="r571 r">body</span>)
        {
            <b>if</b> (<span class="r570 r">condition</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r570 r">condition</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the DoUntilStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="12cf4728fb635b31" href="../../R/12cf4728fb635b31.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r572 rd" class="r572 r">newCondition</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#d641b5faf306abeb" class="k">this</a>.<a href="#933ad75377815bca" class="i property">Condition</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r573 rd" class="r573 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#d641b5faf306abeb" class="k">this</a>.<a href="#246ea985df627fa9" class="i property">Body</a>);
            <b>return</b> <b>new</b> <a href="#3f8786d40ee146dc" class="t constructor">DoUntilStatementAst</a>(<a href="#d641b5faf306abeb" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#d641b5faf306abeb" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a>, <span class="r572 r">newCondition</span>, <span class="r573 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="bac418f9537249d1" href="../../R/bac418f9537249d1.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r574 rd" class="r574 r">visitor</span>)
        {
            <b>return</b> <span class="r574 r">visitor</span>.<a href="AstVisitor.cs.html#0fe76e353202a04b" class="i method">VisitDoUntilStatement</a>(<a href="#d641b5faf306abeb" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="ea63ba66d1a9dfa4" href="../../R/ea63ba66d1a9dfa4.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r575 rd" class="r575 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r576 rd" class="r576 r">action</span> = <span class="r575 r">visitor</span>.<a href="PreOrderVisitor.cs.html#32fcb71b0380de12" class="i method">VisitDoUntilStatement</a>(<a href="#d641b5faf306abeb" class="k">this</a>);
            <b>if</b> (<span class="r576 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r575 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#d641b5faf306abeb" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r576 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r576 r">action</span> = <a href="#933ad75377815bca" class="i property">Condition</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r575 r">visitor</span>);
            <b>if</b> (<span class="r576 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r576 r">action</span> = <a href="#246ea985df627fa9" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r575 r">visitor</span>);
            <b>return</b> <span class="r575 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#d641b5faf306abeb" class="k">this</a>, <span class="r576 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast for a while statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="4e9a52b62ed8b2b1" href="../../R/4e9a52b62ed8b2b1.html" target="n" data-glyph="0,0" class="t t">WhileStatementAst</a> : <a href="#931b3c793b175596" class="t t">LoopStatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a while statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r577 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement, from the label or while keyword to the closing curly brace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r578 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r579 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The condition tested on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r580 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body executed on each iteration of the loop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r577 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r579 r">condition</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="191b47ce16e16151" href="../../R/191b47ce16e16151.html" target="n" data-glyph="72,1" class="t constructor">WhileStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r577 rd" class="r577 r">extent</span>, <b>string</b> <span id="r578 rd" class="r578 r">label</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r579 rd" class="r579 r">condition</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r580 rd" class="r580 r">body</span>)
            : <a href="#a0b04ae0016a0999" class="k">base</a>(<span class="r577 r">extent</span>, <span class="r578 r">label</span>, <span class="r579 r">condition</span>, <span class="r580 r">body</span>)
        {
            <b>if</b> (<span class="r579 r">condition</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r579 r">condition</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the WhileStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="a060da6018dbf9e5" href="../../R/a060da6018dbf9e5.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r581 rd" class="r581 r">newCondition</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4e9a52b62ed8b2b1" class="k">this</a>.<a href="#933ad75377815bca" class="i property">Condition</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r582 rd" class="r582 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4e9a52b62ed8b2b1" class="k">this</a>.<a href="#246ea985df627fa9" class="i property">Body</a>);
            <b>return</b> <b>new</b> <a href="#191b47ce16e16151" class="t constructor">WhileStatementAst</a>(<a href="#4e9a52b62ed8b2b1" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#4e9a52b62ed8b2b1" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a>, <span class="r581 r">newCondition</span>, <span class="r582 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="3a08693c2be86664" href="../../R/3a08693c2be86664.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r583 rd" class="r583 r">visitor</span>)
        {
            <b>return</b> <span class="r583 r">visitor</span>.<a href="AstVisitor.cs.html#cbfa4eef59dab30b" class="i method">VisitWhileStatement</a>(<a href="#4e9a52b62ed8b2b1" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e6a07b33e74c1adf" href="../../R/e6a07b33e74c1adf.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r584 rd" class="r584 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r585 rd" class="r585 r">action</span> = <span class="r584 r">visitor</span>.<a href="PreOrderVisitor.cs.html#d761abb246899537" class="i method">VisitWhileStatement</a>(<a href="#4e9a52b62ed8b2b1" class="k">this</a>);
            <b>if</b> (<span class="r585 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r584 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4e9a52b62ed8b2b1" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r585 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r585 r">action</span> = <a href="#933ad75377815bca" class="i property">Condition</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r584 r">visitor</span>);
            <b>if</b> (<span class="r585 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r585 r">action</span> = <a href="#246ea985df627fa9" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r584 r">visitor</span>);
            <b>return</b> <span class="r584 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4e9a52b62ed8b2b1" class="k">this</a>, <span class="r585 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Flags that are specified on a switch statement.  Values may be or&#39;ed together, not all invalid combinations</span>
    <span class="c">///</span><span class="c"> of flags are detected.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="f3ebdce54e14c694" href="../../R/f3ebdce54e14c694.html" target="n" data-glyph="18,0" class="t t"><span id="c65ae7d79fc69f5b">SwitchFlags</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No flags specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c295735669134c1e" href="../../R/c295735669134c1e.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x00,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The -file flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="298af185be79cfea" href="../../R/298af185be79cfea.html" target="n" data-glyph="24,1" class="i field">File</a> = 0x01,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The -regex flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="6c98f78beaa551f0" href="../../R/6c98f78beaa551f0.html" target="n" data-glyph="24,1" class="i field">Regex</a> = 0x02,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The -wildcard flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8c2beda7309b3ae0" href="../../R/8c2beda7309b3ae0.html" target="n" data-glyph="24,1" class="i field">Wildcard</a> = 0x04,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The -exact flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="96f4b37c43c4a07c" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Exact</a> = 0x08,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The -casesensitive flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="5612873142e6f4be" href="../../R/5612873142e6f4be.html" target="n" data-glyph="24,1" class="i field">CaseSensitive</a> = 0x10,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The -parallel flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ef0ad3b1b1c543cb" href="../../R/ef0ad3b1b1c543cb.html" target="n" data-glyph="24,1" class="i field">Parallel</a> = 0x20,
 
        <span class="c">// If any flags are added that influence evaluation of switch elements,</span>
        <span class="c">// then the caching strategy in SwitchClauseEvalBinder needs to be updated,</span>
        <span class="c">// and possibly its _binderCache.</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a switch statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="4d96f6c979a5266e" href="../../R/4d96f6c979a5266e.html" target="n" data-glyph="0,0" class="t t">SwitchStatementAst</a> : <a href="#056fe4b6395c295c" class="t t">LabeledStatementAst</a>
    {
        <b>private static readonly</b> <span class="i">SwitchClause</span>[] <a id="8a3fffeb20b421a2" href="../../R/8a3fffeb20b421a2.html" target="n" data-glyph="46,1" class="i field">s_emptyClauseArray</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">SwitchClause</span>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a switch statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r586 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement, from the label or switch keyword to the closing curly.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r587 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r588 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression being switched upon.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r589 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Any flags that affect how the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r588 r">condition</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is tested.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r590 r">clauses</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A possibly null or empty collection of conditions and block of statements to execute if the condition matches.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r591 r">default</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The default clause to execute if no clauses match.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r586 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r591 r">default</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r590 r">clauses</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> are both null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1006:DoNotNestGenericTypesInMemberSignatures&quot;</span>)]
        <b>public</b> <a id="2c5bd4b31e59ec2f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SwitchStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r586 rd" class="r586 r">extent</span>,
                                  <b>string</b> <span id="r587 rd" class="r587 r">label</span>,
                                  <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r588 rd" class="r588 r">condition</span>,
                                  <a href="#f3ebdce54e14c694" class="t t">SwitchFlags</a> <span id="r589 rd" class="r589 r">flags</span>,
                                  <span class="i">IEnumerable</span>&lt;<span class="i">SwitchClause</span>&gt; <span id="r590 rd" class="r590 r">clauses</span>,
                                  <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r591 rd" class="r591 r">@default</span>)
            : <a href="#a345d961d1befe22" class="k">base</a>(<span class="r586 r">extent</span>, <span class="r587 r">label</span>, <span class="r588 r">condition</span>)
        {
            <b>if</b> ((<span class="r590 r">clauses</span> == <b>null</b> || !<span class="r590 r">clauses</span>.<span class="i">Any</span>()) &amp;&amp; <span class="r591 r">@default</span> == <b>null</b>)
            {
                <span class="c">// Must specify either clauses or default.  If neither, just complain about clauses as that&#39;s the most likely</span>
                <span class="c">// invalid argument.</span>
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r590 r">clauses</span>));
            }
 
            <a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#aaca019540ac3d40" class="i property">Flags</a> = <span class="r589 r">flags</span>;
            <a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#297d524de4c5c69a" class="i property">Clauses</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<span class="i">SwitchClause</span>&gt;(
                (<span class="r590 r">clauses</span> != <b>null</b> &amp;&amp; <span class="r590 r">clauses</span>.<span class="i">Any</span>()) ? <span class="r590 r">clauses</span>.<span class="i">ToArray</span>() : <a href="#8a3fffeb20b421a2" class="i field">s_emptyClauseArray</a>);
            <span class="i">SetParents</span>(<a href="#297d524de4c5c69a" class="i property">Clauses</a>);
            <b>if</b> (<span class="r591 r">@default</span> != <b>null</b>)
            {
                <a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#c977933db5bdc245" class="i property">Default</a> = <span class="r591 r">@default</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r591 r">@default</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flags, if any specified on the switch statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#f3ebdce54e14c694" class="t t">SwitchFlags</a> <a id="aaca019540ac3d40" href="../../R/aaca019540ac3d40.html" target="n" data-glyph="102,1" class="i property">Flags</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A possibly empty collection of conditions and statement blocks representing the cases of the switch statement.</span>
        <span class="c">///</span><span class="c"> If the collection is empty, the default clause is not null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1006:DoNotNestGenericTypesInMemberSignatures&quot;</span>)]
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<span class="i">SwitchClause</span>&gt; <a id="297d524de4c5c69a" href="../../R/297d524de4c5c69a.html" target="n" data-glyph="102,1" class="i property">Clauses</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the default of the switch statement, or null if no default block was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="c977933db5bdc245" href="../../R/c977933db5bdc245.html" target="n" data-glyph="102,1" class="i property">Default</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the SwitchStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="e86890ccaeebff63" href="../../R/e86890ccaeebff63.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r592 rd" class="r592 r">newCondition</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#933ad75377815bca" class="i property">Condition</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r593 rd" class="r593 r">newDefault</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#c977933db5bdc245" class="i property">Default</a>);
 
            <span class="i">List</span>&lt;<span class="i">SwitchClause</span>&gt; <span id="r594 rd" class="r594 r">newClauses</span> = <b>null</b>;
            <b>if</b> (<a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#297d524de4c5c69a" class="i property">Clauses</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r594 r">newClauses</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">SwitchClause</span>&gt;(<a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#297d524de4c5c69a" class="i property">Clauses</a>.<span class="i">Count</span>);
                <b>for</b> (<b>int</b> <span id="r595 rd" class="r595 r">i</span> = 0; <span class="r595 r">i</span> &lt; <a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#297d524de4c5c69a" class="i property">Clauses</a>.<span class="i">Count</span>; <span class="r595 r">i</span>++)
                {
                    <b>var</b> <span id="r596 rd" class="r596 r">clause</span> = <a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#297d524de4c5c69a" class="i property">Clauses</a>[<span class="r595 r">i</span>];
                    <span class="r27 r t">var</span> <span id="r597 rd" class="r597 r">newSwitchItem1</span> = <span class="i">CopyElement</span>(<span class="r596 r">clause</span>.<span class="i">Item1</span>);
                    <span class="r27 r t">var</span> <span id="r598 rd" class="r598 r">newSwitchItem2</span> = <span class="i">CopyElement</span>(<span class="r596 r">clause</span>.<span class="i">Item2</span>);
 
                    <span class="r594 r">newClauses</span>.<span class="i">Add</span>(<span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r597 r">newSwitchItem1</span>, <span class="r598 r">newSwitchItem2</span>));
                }
            }
 
            <b>return</b> <b>new</b> <span class="t">SwitchStatementAst</span>(<a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#6e78c18e515b91da" class="i property">Label</a>, <span class="r592 r">newCondition</span>, <a href="#4d96f6c979a5266e" class="k">this</a>.<a href="#aaca019540ac3d40" class="i property">Flags</a>, <span class="r594 r">newClauses</span>, <span class="r593 r">newDefault</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="38d662857e9dd1a1" href="../../R/38d662857e9dd1a1.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r599 rd" class="r599 r">visitor</span>)
        {
            <b>return</b> <span class="r599 r">visitor</span>.<a href="AstVisitor.cs.html#6b4eb0caa3d78578" class="i method">VisitSwitchStatement</a>(<a href="#4d96f6c979a5266e" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="fde370a9fa160a8a" href="../../R/fde370a9fa160a8a.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r600 rd" class="r600 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r601 rd" class="r601 r">action</span> = <span class="r600 r">visitor</span>.<a href="PreOrderVisitor.cs.html#95c41b3d13656435" class="i method">VisitSwitchStatement</a>(<a href="#4d96f6c979a5266e" class="k">this</a>);
            <b>if</b> (<span class="r601 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r600 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4d96f6c979a5266e" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r601 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r601 r">action</span> = <a href="#933ad75377815bca" class="i property">Condition</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r600 r">visitor</span>);
            <b>if</b> (<span class="r601 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r602 rd" class="r602 r">index</span> = 0; <span class="r602 r">index</span> &lt; <a href="#297d524de4c5c69a" class="i property">Clauses</a>.<span class="i">Count</span>; <span class="r602 r">index</span>++)
                {
                    <b>var</b> <span id="r603 rd" class="r603 r">switchClauseAst</span> = <a href="#297d524de4c5c69a" class="i property">Clauses</a>[<span class="r602 r">index</span>];
                    <span class="r601 r">action</span> = <span class="r603 r">switchClauseAst</span>.<span class="i">Item1</span>.<span class="i">InternalVisit</span>(<span class="r600 r">visitor</span>);
                    <b>if</b> (<span class="r601 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                    <span class="r601 r">action</span> = <span class="r603 r">switchClauseAst</span>.<span class="i">Item2</span>.<span class="i">InternalVisit</span>(<span class="r600 r">visitor</span>);
                    <b>if</b> (<span class="r601 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r601 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#c977933db5bdc245" class="i property">Default</a> != <b>null</b>)
                <span class="r601 r">action</span> = <a href="#c977933db5bdc245" class="i property">Default</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r600 r">visitor</span>);
            <b>return</b> <span class="r600 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4d96f6c979a5266e" class="k">this</a>, <span class="r601 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Looping Statements
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Exception Handling Statements
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a single catch as part of a try statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="fafbccc59f688c0e" href="../../R/fafbccc59f688c0e.html" target="n" data-glyph="0,0" class="t t">CatchClauseAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <a id="e9698bf5193ef6df" href="../../R/e9698bf5193ef6df.html" target="n" data-glyph="46,1" class="i field">s_emptyCatchTypes</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a catch clause.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r604 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the catch, from the catch keyword to the closing curly brace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r605 r">catchTypes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The collection of types caught by this catch clause, may be null if all types are caught.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r606 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The body of the catch clause.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r604 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r606 r">body</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="966e20a673982fbc" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CatchClauseAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r604 rd" class="r604 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <span id="r605 rd" class="r605 r">catchTypes</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r606 rd" class="r606 r">body</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r604 r">extent</span>)
        {
            <b>if</b> (<span class="r606 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r606 r">body</span>));
            }
 
            <b>if</b> (<span class="r605 r">catchTypes</span> != <b>null</b>)
            {
                <a href="#fafbccc59f688c0e" class="k">this</a>.<a href="#965c23dce819c035" class="i property">CatchTypes</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;(<span class="r605 r">catchTypes</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#965c23dce819c035" class="i property">CatchTypes</a>);
            }
            <b>else</b>
            {
                <a href="#fafbccc59f688c0e" class="k">this</a>.<a href="#965c23dce819c035" class="i property">CatchTypes</a> = <a href="#e9698bf5193ef6df" class="i field">s_emptyCatchTypes</a>;
            }
 
            <a href="#fafbccc59f688c0e" class="k">this</a>.<a href="#efd5374afedb9514" class="i property">Body</a> = <span class="r606 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r606 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A possibly empty collection of types caught by this catch block.  If the collection is empty, the catch handler</span>
        <span class="c">///</span><span class="c"> catches all exceptions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <a id="965c23dce819c035" href="../../R/965c23dce819c035.html" target="n" data-glyph="102,1" class="i property">CatchTypes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if this handler handles any kind of exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;CatchAll&quot;</span>)]
        <b>public bool</b> <a id="98a314e6e3800ec9" href="../../R/98a314e6e3800ec9.html" target="n" data-glyph="102,1" class="i property">IsCatchAll</a> { <b>get</b> { <b>return</b> <a href="#965c23dce819c035" class="i property">CatchTypes</a>.<span class="i">Count</span> == 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The body of the catch block.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="efd5374afedb9514" href="../../R/efd5374afedb9514.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the CatchClauseAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="89710f06e96f1ae6" href="../../R/89710f06e96f1ae6.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r607 rd" class="r607 r">newCatchTypes</span> = <span class="i">CopyElements</span>(<a href="#fafbccc59f688c0e" class="k">this</a>.<a href="#965c23dce819c035" class="i property">CatchTypes</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r608 rd" class="r608 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#fafbccc59f688c0e" class="k">this</a>.<a href="#efd5374afedb9514" class="i property">Body</a>);
            <b>return</b> <b>new</b> <span class="t">CatchClauseAst</span>(<a href="#fafbccc59f688c0e" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r607 r">newCatchTypes</span>, <span class="r608 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="a354198a72bb2859" href="../../R/a354198a72bb2859.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r609 rd" class="r609 r">visitor</span>)
        {
            <b>return</b> <span class="r609 r">visitor</span>.<a href="AstVisitor.cs.html#15c7692d371a38e3" class="i method">VisitCatchClause</a>(<a href="#fafbccc59f688c0e" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="436934b05eb37601" href="../../R/436934b05eb37601.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r610 rd" class="r610 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r611 rd" class="r611 r">action</span> = <span class="r610 r">visitor</span>.<a href="PreOrderVisitor.cs.html#c7086bf512ab4ff1" class="i method">VisitCatchClause</a>(<a href="#fafbccc59f688c0e" class="k">this</a>);
            <b>if</b> (<span class="r611 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r610 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#fafbccc59f688c0e" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>for</b> (<b>int</b> <span id="r612 rd" class="r612 r">index</span> = 0; <span class="r612 r">index</span> &lt; <a href="#965c23dce819c035" class="i property">CatchTypes</a>.<span class="i">Count</span>; <span class="r612 r">index</span>++)
            {
                <b>var</b> <span id="r613 rd" class="r613 r">catchType</span> = <a href="#965c23dce819c035" class="i property">CatchTypes</a>[<span class="r612 r">index</span>];
                <b>if</b> (<span class="r611 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                <span class="r611 r">action</span> = <span class="r613 r">catchType</span>.<span class="i">InternalVisit</span>(<span class="r610 r">visitor</span>);
            }
 
            <b>if</b> (<span class="r611 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r611 r">action</span> = <a href="#efd5374afedb9514" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r610 r">visitor</span>);
            <b>return</b> <span class="r610 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#fafbccc59f688c0e" class="k">this</a>, <span class="r611 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a try statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="9827b5d12d62be7f" href="../../R/9827b5d12d62be7f.html" target="n" data-glyph="0,0" class="t t">TryStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#fafbccc59f688c0e" class="t t">CatchClauseAst</a>&gt; <a id="d3da5281d1461276" href="../../R/d3da5281d1461276.html" target="n" data-glyph="46,1" class="i field">s_emptyCatchClauses</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#fafbccc59f688c0e" class="t t">CatchClauseAst</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a try statement ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r614 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the try statement, from the try keyword to the closing curly of the last catch or finally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r615 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The region of guarded code.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r616 r">catchClauses</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list of catch clauses, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r617 r">finally</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The finally clause, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r614 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r615 r">body</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r616 r">catchClauses</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or is an empty collection and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r617 r">finally</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is also</span>
        <span class="c">///</span><span class="c"> null, then an exception is also raised as the try block must have a finally or at least one catch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="c1d2cce1f37e725c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">TryStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r614 rd" class="r614 r">extent</span>,
                               <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r615 rd" class="r615 r">body</span>,
                               <span class="i">IEnumerable</span>&lt;<a href="#fafbccc59f688c0e" class="t t">CatchClauseAst</a>&gt; <span id="r616 rd" class="r616 r">catchClauses</span>,
                               <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r617 rd" class="r617 r">@finally</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r614 r">extent</span>)
        {
            <b>if</b> (<span class="r615 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r615 r">body</span>));
            }
 
            <b>if</b> ((<span class="r616 r">catchClauses</span> == <b>null</b> || !<span class="r616 r">catchClauses</span>.<span class="i">Any</span>()) &amp;&amp; <span class="r617 r">@finally</span> == <b>null</b>)
            {
                <span class="c">// If no catches and no finally, just complain about catchClauses as that&#39;s the most likely invalid argument.</span>
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r616 r">catchClauses</span>));
            }
 
            <a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#591cd17e760ea038" class="i property">Body</a> = <span class="r615 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r615 r">body</span>);
            <b>if</b> (<span class="r616 r">catchClauses</span> != <b>null</b>)
            {
                <a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#29d08ecdd9ce8b5a" class="i property">CatchClauses</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#fafbccc59f688c0e" class="t t">CatchClauseAst</a>&gt;(<span class="r616 r">catchClauses</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>);
            }
            <b>else</b>
            {
                <a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#29d08ecdd9ce8b5a" class="i property">CatchClauses</a> = <a href="#d3da5281d1461276" class="i field">s_emptyCatchClauses</a>;
            }
 
            <b>if</b> (<span class="r617 r">@finally</span> != <b>null</b>)
            {
                <a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#56a1309fed36b070" class="i property">Finally</a> = <span class="r617 r">@finally</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r617 r">@finally</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The body of the try statement.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="591cd17e760ea038" href="../../R/591cd17e760ea038.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of catch clauses, which is empty if there are no catches.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#fafbccc59f688c0e" class="t t">CatchClauseAst</a>&gt; <a id="29d08ecdd9ce8b5a" href="../../R/29d08ecdd9ce8b5a.html" target="n" data-glyph="102,1" class="i property">CatchClauses</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the finally block, or null if no finally block was specified, in which case </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#29d08ecdd9ce8b5a" class="i property">CatchClauses</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is a non-null, non-empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="56a1309fed36b070" href="../../R/56a1309fed36b070.html" target="n" data-glyph="102,1" class="i property">Finally</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the TryStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="adffcf267c7643da" href="../../R/adffcf267c7643da.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#268644c84b225866" class="k">var</a> <span id="r618 rd" class="r618 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#591cd17e760ea038" class="i property">Body</a>);
            <b>var</b> <span id="r619 rd" class="r619 r">newCatchClauses</span> = <span class="i">CopyElements</span>(<a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r620 rd" class="r620 r">newFinally</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#56a1309fed36b070" class="i property">Finally</a>);
 
            <b>return</b> <b>new</b> <span class="t">TryStatementAst</span>(<a href="#9827b5d12d62be7f" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r618 r">newBody</span>, <span class="r619 r">newCatchClauses</span>, <span class="r620 r">newFinally</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="f044a86874fc5350" href="../../R/f044a86874fc5350.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r621 rd" class="r621 r">visitor</span>)
        {
            <b>return</b> <span class="r621 r">visitor</span>.<a href="AstVisitor.cs.html#385b74a8fe1e304d" class="i method">VisitTryStatement</a>(<a href="#9827b5d12d62be7f" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="2886351a7cfe75ca" href="../../R/2886351a7cfe75ca.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r622 rd" class="r622 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r623 rd" class="r623 r">action</span> = <span class="r622 r">visitor</span>.<a href="PreOrderVisitor.cs.html#80b348e3c60ef03d" class="i method">VisitTryStatement</a>(<a href="#9827b5d12d62be7f" class="k">this</a>);
            <b>if</b> (<span class="r623 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r622 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#9827b5d12d62be7f" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r623 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r623 r">action</span> = <a href="#591cd17e760ea038" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r622 r">visitor</span>);
            <b>if</b> (<span class="r623 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r624 rd" class="r624 r">index</span> = 0; <span class="r624 r">index</span> &lt; <a href="#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span>; <span class="r624 r">index</span>++)
                {
                    <b>var</b> <span id="r625 rd" class="r625 r">catchClause</span> = <a href="#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>[<span class="r624 r">index</span>];
                    <span class="r623 r">action</span> = <span class="r625 r">catchClause</span>.<span class="i">InternalVisit</span>(<span class="r622 r">visitor</span>);
                    <b>if</b> (<span class="r623 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r623 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#56a1309fed36b070" class="i property">Finally</a> != <b>null</b>)
                <span class="r623 r">action</span> = <a href="#56a1309fed36b070" class="i property">Finally</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r622 r">visitor</span>);
            <b>return</b> <span class="r622 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#9827b5d12d62be7f" class="k">this</a>, <span class="r623 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents the trap statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="5cedc9c886fbe837" href="../../R/5cedc9c886fbe837.html" target="n" data-glyph="0,0" class="t t">TrapStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a trap statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r626 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the trap statement, starting with the trap keyword and ending with the closing curly of the body.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r627 r">trapType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type handled by the trap statement, may be null if all exceptions are trapped.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r628 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The handler for the error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r626 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r628 r">body</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="2a6bb2763a18f4f6" href="../../R/2a6bb2763a18f4f6.html" target="n" data-glyph="72,1" class="t constructor">TrapStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r626 rd" class="r626 r">extent</span>, <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r627 rd" class="r627 r">trapType</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r628 rd" class="r628 r">body</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r626 r">extent</span>)
        {
            <b>if</b> (<span class="r628 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r628 r">body</span>));
            }
 
            <b>if</b> (<span class="r627 r">trapType</span> != <b>null</b>)
            {
                <a href="#5cedc9c886fbe837" class="k">this</a>.<a href="#81f0443bf2950d57" class="i property">TrapType</a> = <span class="r627 r">trapType</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r627 r">trapType</span>);
            }
 
            <a href="#5cedc9c886fbe837" class="k">this</a>.<a href="#f46fffb1c902252d" class="i property">Body</a> = <span class="r628 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r628 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the type trapped by this trap block, or null if no type was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <a id="81f0443bf2950d57" href="../../R/81f0443bf2950d57.html" target="n" data-glyph="102,1" class="i property">TrapType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The body for the trap block.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="f46fffb1c902252d" href="../../R/f46fffb1c902252d.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the TrapStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="79a43e2a2a88d789" href="../../R/79a43e2a2a88d789.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#34b9d5dbbaca964d" class="k">var</a> <span id="r629 rd" class="r629 r">newTrapType</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#5cedc9c886fbe837" class="k">this</a>.<a href="#81f0443bf2950d57" class="i property">TrapType</a>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r630 rd" class="r630 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#5cedc9c886fbe837" class="k">this</a>.<a href="#f46fffb1c902252d" class="i property">Body</a>);
            <b>return</b> <b>new</b> <a href="#2a6bb2763a18f4f6" class="t constructor">TrapStatementAst</a>(<a href="#5cedc9c886fbe837" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r629 r">newTrapType</span>, <span class="r630 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="b12da6ea766000f9" href="../../R/b12da6ea766000f9.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r631 rd" class="r631 r">visitor</span>)
        {
            <b>return</b> <span class="r631 r">visitor</span>.<a href="AstVisitor.cs.html#316a6786f233d0ab" class="i method">VisitTrap</a>(<a href="#5cedc9c886fbe837" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f2d14d47a40b62cc" href="../../R/f2d14d47a40b62cc.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r632 rd" class="r632 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r633 rd" class="r633 r">action</span> = <span class="r632 r">visitor</span>.<a href="PreOrderVisitor.cs.html#0f59ba5ccf4539dd" class="i method">VisitTrap</a>(<a href="#5cedc9c886fbe837" class="k">this</a>);
            <b>if</b> (<span class="r633 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r632 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#5cedc9c886fbe837" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r633 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#81f0443bf2950d57" class="i property">TrapType</a> != <b>null</b>)
                <span class="r633 r">action</span> = <a href="#81f0443bf2950d57" class="i property">TrapType</a>.<a href="#fda3411c37051037" class="i method">InternalVisit</a>(<span class="r632 r">visitor</span>);
            <b>if</b> (<span class="r633 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r633 r">action</span> = <a href="#f46fffb1c902252d" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r632 r">visitor</span>);
            <b>return</b> <span class="r632 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#5cedc9c886fbe837" class="k">this</a>, <span class="r633 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Exception Handling Statements
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Flow Control Statements
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the break statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="410610c8cad1e99b" href="../../R/410610c8cad1e99b.html" target="n" data-glyph="0,0" class="t t">BreakStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a break statement ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r634 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement, including the break keyword and the optional label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r635 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optional label expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r634 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="64b5a03810b882c0" href="../../R/64b5a03810b882c0.html" target="n" data-glyph="72,1" class="t constructor">BreakStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r634 rd" class="r634 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r635 rd" class="r635 r">label</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r634 r">extent</span>)
        {
            <b>if</b> (<span class="r635 r">label</span> != <b>null</b>)
            {
                <a href="#410610c8cad1e99b" class="k">this</a>.<a href="#d09d51ee2cd8ffec" class="i property">Label</a> = <span class="r635 r">label</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r635 r">label</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression or label to break to, or null if no label was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="d09d51ee2cd8ffec" href="../../R/d09d51ee2cd8ffec.html" target="n" data-glyph="102,1" class="i property">Label</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the BreakStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="7805e5eed626a9d8" href="../../R/7805e5eed626a9d8.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r636 rd" class="r636 r">newLabel</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#410610c8cad1e99b" class="k">this</a>.<a href="#d09d51ee2cd8ffec" class="i property">Label</a>);
            <b>return</b> <b>new</b> <a href="#64b5a03810b882c0" class="t constructor">BreakStatementAst</a>(<a href="#410610c8cad1e99b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r636 r">newLabel</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="1e8b48a4411f4d59" href="../../R/1e8b48a4411f4d59.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r637 rd" class="r637 r">visitor</span>)
        {
            <b>return</b> <span class="r637 r">visitor</span>.<a href="AstVisitor.cs.html#64d38f846adb90b9" class="i method">VisitBreakStatement</a>(<a href="#410610c8cad1e99b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f905fd1a29532224" href="../../R/f905fd1a29532224.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r638 rd" class="r638 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r639 rd" class="r639 r">action</span> = <span class="r638 r">visitor</span>.<a href="PreOrderVisitor.cs.html#1abfe014f539ea68" class="i method">VisitBreakStatement</a>(<a href="#410610c8cad1e99b" class="k">this</a>);
            <b>if</b> (<span class="r639 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r638 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#410610c8cad1e99b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r639 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#d09d51ee2cd8ffec" class="i property">Label</a> != <b>null</b>)
                <span class="r639 r">action</span> = <a href="#d09d51ee2cd8ffec" class="i property">Label</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r638 r">visitor</span>);
            <b>return</b> <span class="r638 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#410610c8cad1e99b" class="k">this</a>, <span class="r639 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the continue statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="f8a733d027117fbc" href="../../R/f8a733d027117fbc.html" target="n" data-glyph="0,0" class="t t">ContinueStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a continue statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r640 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement including the optional label.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r641 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optional label expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r640 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="9216abb5dcc1436d" href="../../R/9216abb5dcc1436d.html" target="n" data-glyph="72,1" class="t constructor">ContinueStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r640 rd" class="r640 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r641 rd" class="r641 r">label</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r640 r">extent</span>)
        {
            <b>if</b> (<span class="r641 r">label</span> != <b>null</b>)
            {
                <a href="#f8a733d027117fbc" class="k">this</a>.<a href="#2085acb39f31fba8" class="i property">Label</a> = <span class="r641 r">label</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r641 r">label</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression or label to continue to, or null if no label was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="2085acb39f31fba8" href="../../R/2085acb39f31fba8.html" target="n" data-glyph="102,1" class="i property">Label</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ContinueStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="afbcc845f8160184" href="../../R/afbcc845f8160184.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r642 rd" class="r642 r">newLabel</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#f8a733d027117fbc" class="k">this</a>.<a href="#2085acb39f31fba8" class="i property">Label</a>);
            <b>return</b> <b>new</b> <a href="#9216abb5dcc1436d" class="t constructor">ContinueStatementAst</a>(<a href="#f8a733d027117fbc" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r642 r">newLabel</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="6dbeec5f1fa37661" href="../../R/6dbeec5f1fa37661.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r643 rd" class="r643 r">visitor</span>)
        {
            <b>return</b> <span class="r643 r">visitor</span>.<a href="AstVisitor.cs.html#92e0c982d227c53e" class="i method">VisitContinueStatement</a>(<a href="#f8a733d027117fbc" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f5fa7287b94bd0e1" href="../../R/f5fa7287b94bd0e1.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r644 rd" class="r644 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r645 rd" class="r645 r">action</span> = <span class="r644 r">visitor</span>.<a href="PreOrderVisitor.cs.html#7d9328e3dc900e8d" class="i method">VisitContinueStatement</a>(<a href="#f8a733d027117fbc" class="k">this</a>);
            <b>if</b> (<span class="r645 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r644 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f8a733d027117fbc" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r645 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#2085acb39f31fba8" class="i property">Label</a> != <b>null</b>)
                <span class="r645 r">action</span> = <a href="#2085acb39f31fba8" class="i property">Label</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r644 r">visitor</span>);
            <b>return</b> <span class="r644 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f8a733d027117fbc" class="k">this</a>, <span class="r645 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the return statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="ba60713bd71ce457" href="../../R/ba60713bd71ce457.html" target="n" data-glyph="0,0" class="t t">ReturnStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a return statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r646 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement including the optional return value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r647 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optional return value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r646 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="b9bd1eeac7539b56" href="../../R/b9bd1eeac7539b56.html" target="n" data-glyph="72,1" class="t constructor">ReturnStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r646 rd" class="r646 r">extent</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r647 rd" class="r647 r">pipeline</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r646 r">extent</span>)
        {
            <b>if</b> (<span class="r647 r">pipeline</span> != <b>null</b>)
            {
                <a href="#ba60713bd71ce457" class="k">this</a>.<a href="#5b77ce523f7a0a91" class="i property">Pipeline</a> = <span class="r647 r">pipeline</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r647 r">pipeline</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline specified in the return statement, or null if none was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="5b77ce523f7a0a91" href="../../R/5b77ce523f7a0a91.html" target="n" data-glyph="102,1" class="i property">Pipeline</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ReturnStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="898ecbf450e23cb9" href="../../R/898ecbf450e23cb9.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r648 rd" class="r648 r">newPipeline</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#ba60713bd71ce457" class="k">this</a>.<a href="#5b77ce523f7a0a91" class="i property">Pipeline</a>);
            <b>return</b> <b>new</b> <a href="#b9bd1eeac7539b56" class="t constructor">ReturnStatementAst</a>(<a href="#ba60713bd71ce457" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r648 r">newPipeline</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="a0d3d32488bcd9d7" href="../../R/a0d3d32488bcd9d7.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r649 rd" class="r649 r">visitor</span>)
        {
            <b>return</b> <span class="r649 r">visitor</span>.<a href="AstVisitor.cs.html#8df162ef477d4c2c" class="i method">VisitReturnStatement</a>(<a href="#ba60713bd71ce457" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="2ac490c3c6d29616" href="../../R/2ac490c3c6d29616.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r650 rd" class="r650 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r651 rd" class="r651 r">action</span> = <span class="r650 r">visitor</span>.<a href="PreOrderVisitor.cs.html#86bb59037b83226d" class="i method">VisitReturnStatement</a>(<a href="#ba60713bd71ce457" class="k">this</a>);
            <b>if</b> (<span class="r651 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r650 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#ba60713bd71ce457" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r651 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#5b77ce523f7a0a91" class="i property">Pipeline</a> != <b>null</b>)
                <span class="r651 r">action</span> = <a href="#5b77ce523f7a0a91" class="i property">Pipeline</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r650 r">visitor</span>);
            <b>return</b> <span class="r650 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#ba60713bd71ce457" class="k">this</a>, <span class="r651 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the exit statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="c410ad4dd51f9687" href="../../R/c410ad4dd51f9687.html" target="n" data-glyph="0,0" class="t t">ExitStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an exit statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r652 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the exit statement including the optional exit value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r653 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optional exit value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r652 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="b785dc866e1d4a3c" href="../../R/b785dc866e1d4a3c.html" target="n" data-glyph="72,1" class="t constructor">ExitStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r652 rd" class="r652 r">extent</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r653 rd" class="r653 r">pipeline</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r652 r">extent</span>)
        {
            <b>if</b> (<span class="r653 r">pipeline</span> != <b>null</b>)
            {
                <a href="#c410ad4dd51f9687" class="k">this</a>.<a href="#5677dd38c48037f7" class="i property">Pipeline</a> = <span class="r653 r">pipeline</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r653 r">pipeline</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline specified in the exit statement, or null if none was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="5677dd38c48037f7" href="../../R/5677dd38c48037f7.html" target="n" data-glyph="102,1" class="i property">Pipeline</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ExitStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="75a02d4ccbd3c78f" href="../../R/75a02d4ccbd3c78f.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r654 rd" class="r654 r">newPipeline</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#c410ad4dd51f9687" class="k">this</a>.<a href="#5677dd38c48037f7" class="i property">Pipeline</a>);
            <b>return</b> <b>new</b> <a href="#b785dc866e1d4a3c" class="t constructor">ExitStatementAst</a>(<a href="#c410ad4dd51f9687" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r654 r">newPipeline</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="10462436f02ca197" href="../../R/10462436f02ca197.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r655 rd" class="r655 r">visitor</span>)
        {
            <b>return</b> <span class="r655 r">visitor</span>.<a href="AstVisitor.cs.html#87c6d3d31bd189a2" class="i method">VisitExitStatement</a>(<a href="#c410ad4dd51f9687" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="01881eb29a2e2de5" href="../../R/01881eb29a2e2de5.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r656 rd" class="r656 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r657 rd" class="r657 r">action</span> = <span class="r656 r">visitor</span>.<a href="PreOrderVisitor.cs.html#a3b6665a5683ed3e" class="i method">VisitExitStatement</a>(<a href="#c410ad4dd51f9687" class="k">this</a>);
            <b>if</b> (<span class="r657 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r656 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#c410ad4dd51f9687" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r657 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#5677dd38c48037f7" class="i property">Pipeline</a> != <b>null</b>)
                <span class="r657 r">action</span> = <a href="#5677dd38c48037f7" class="i property">Pipeline</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r656 r">visitor</span>);
            <b>return</b> <span class="r656 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#c410ad4dd51f9687" class="k">this</a>, <span class="r657 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing the throw statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="07e9c4f5bce4153b" href="../../R/07e9c4f5bce4153b.html" target="n" data-glyph="0,0" class="t t">ThrowStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a throw statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r658 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the throw statement, including the optional value to throw.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r659 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optional value to throw.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r658 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="eecff8dcadc3d274" href="../../R/eecff8dcadc3d274.html" target="n" data-glyph="72,1" class="t constructor">ThrowStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r658 rd" class="r658 r">extent</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r659 rd" class="r659 r">pipeline</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r658 r">extent</span>)
        {
            <b>if</b> (<span class="r659 r">pipeline</span> != <b>null</b>)
            {
                <a href="#07e9c4f5bce4153b" class="k">this</a>.<a href="#4e6ffefc40942042" class="i property">Pipeline</a> = <span class="r659 r">pipeline</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r659 r">pipeline</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline specified in the throw statement, or null if none was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="4e6ffefc40942042" href="../../R/4e6ffefc40942042.html" target="n" data-glyph="102,1" class="i property">Pipeline</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the throw statement is a rethrow.  In PowerShell, a throw statement need not throw anything.  Such</span>
        <span class="c">///</span><span class="c"> a throw statement throws a new exception if it does not appear lexically withing a catch, otherwise</span>
        <span class="c">///</span><span class="c"> it rethrows the caught exception.  Examples:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     if ($true) { throw } # not a rethrow</span>
        <span class="c">///</span><span class="c">     try { foo } catch { throw } # rethrow</span>
        <span class="c">///</span><span class="c">     try { foo } catch { . { throw } } # rethrow</span>
        <span class="c">///</span><span class="c">     try { foo } catch { function foo { throw } } # rethrow</span>
        <span class="c">///</span><span class="c">     try { foo } finally { throw } # not a rethrow</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="a1d97c46b4459087" href="../../R/a1d97c46b4459087.html" target="n" data-glyph="102,1" class="i property">IsRethrow</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#4e6ffefc40942042" class="i property">Pipeline</a> != <b>null</b>)
                    <b>return</b> <b>false</b>;
 
                <a href="#d47621d83efd14de" class="k">var</a> <span id="r660 rd" class="r660 r">parent</span> = <a href="#faf9ad7a55f1cc57" class="i property">Parent</a>;
                <b>while</b> (<span class="r660 r">parent</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r660 r">parent</span> <b>is</b> <a href="#fafbccc59f688c0e" class="t t">CatchClauseAst</a>)
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="r660 r">parent</span> = <span class="r660 r">parent</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a>;
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ThrowStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="09b04b1303b25802" href="../../R/09b04b1303b25802.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r661 rd" class="r661 r">newPipeline</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#07e9c4f5bce4153b" class="k">this</a>.<a href="#4e6ffefc40942042" class="i property">Pipeline</a>);
            <b>return</b> <b>new</b> <a href="#eecff8dcadc3d274" class="t constructor">ThrowStatementAst</a>(<a href="#07e9c4f5bce4153b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r661 r">newPipeline</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="3e927a788b459963" href="../../R/3e927a788b459963.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r662 rd" class="r662 r">visitor</span>)
        {
            <b>return</b> <span class="r662 r">visitor</span>.<a href="AstVisitor.cs.html#365749972c43c939" class="i method">VisitThrowStatement</a>(<a href="#07e9c4f5bce4153b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="9352029df7868dc4" href="../../R/9352029df7868dc4.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r663 rd" class="r663 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r664 rd" class="r664 r">action</span> = <span class="r663 r">visitor</span>.<a href="PreOrderVisitor.cs.html#dacde55da83c7aef" class="i method">VisitThrowStatement</a>(<a href="#07e9c4f5bce4153b" class="k">this</a>);
            <b>if</b> (<span class="r664 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r663 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#07e9c4f5bce4153b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r664 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#4e6ffefc40942042" class="i property">Pipeline</a> != <b>null</b>)
                <span class="r664 r">action</span> = <a href="#4e6ffefc40942042" class="i property">Pipeline</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r663 r">visitor</span>);
            <b>return</b> <span class="r663 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#07e9c4f5bce4153b" class="k">this</a>, <span class="r664 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An AST representing a syntax element chainable with &#39;</span><span class="c">&amp;amp;</span><span class="c">&amp;amp;</span><span class="c">&#39; or &#39;||&#39;.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="4ed29ab5c0549573" href="../../R/4ed29ab5c0549573.html" target="n" data-glyph="0,0" class="t t">ChainableAst</a> : <a href="#86812479028959b8" class="t t">PipelineBaseAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the new chainable AST with the given extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r665 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The script extent of the AST.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="8ac9475482ff33ca" href="../../R/8ac9475482ff33ca.html" target="n" data-glyph="75,1" class="t constructor">ChainableAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r665 rd" class="r665 r">extent</span>) : <a href="#73f5cf54093debaa" class="k">base</a>(<span class="r665 r">extent</span>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A command-oriented flow-controlled pipeline chain.</span>
    <span class="c">///</span><span class="c"> E.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">npm build </span><span class="c">&amp;amp;</span><span class="c">&amp;amp;</span><span class="c"> npm test</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">Get-Content -Raw ./file.txt || &quot;default&quot;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="56dc1a0918611f9c" href="../../R/56dc1a0918611f9c.html" target="n" data-glyph="0,0" class="t t">PipelineChainAst</a> : <a href="#4ed29ab5c0549573" class="t t">ChainableAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the new statement chain AST from two statements and an operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r666 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the chained statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r667 r">lhsChain</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The pipeline or pipeline chain to the left of the operator.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r668 r">rhsPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The pipeline to the right of the operator.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r669 r">chainOperator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The operator used.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r670 r">background</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True when this chain has been invoked with the background operator, false otherwise.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="07e97055b063d48b" href="../../R/07e97055b063d48b.html" target="n" data-glyph="72,1" class="t constructor">PipelineChainAst</a>(
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r666 rd" class="r666 r">extent</span>,
            <a href="#4ed29ab5c0549573" class="t t">ChainableAst</a> <span id="r667 rd" class="r667 r">lhsChain</span>,
            <a href="#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r668 rd" class="r668 r">rhsPipeline</span>,
            <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r669 rd" class="r669 r">chainOperator</span>,
            <b>bool</b> <span id="r670 rd" class="r670 r">background</span> = <b>false</b>)
            : <a href="#8ac9475482ff33ca" class="k">base</a>(<span class="r666 r">extent</span>)
        {
            <b>if</b> (<span class="r667 r">lhsChain</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r667 r">lhsChain</span>));
            }
 
            <b>if</b> (<span class="r668 r">rhsPipeline</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r668 r">rhsPipeline</span>));
            }
 
            <b>if</b> (<span class="r669 r">chainOperator</span> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a> &amp;&amp; <span class="r669 r">chainOperator</span> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<b>nameof</b>(<span class="r669 r">chainOperator</span>));
            }
 
            <a href="#6762de62f426f4e6" class="i property">LhsPipelineChain</a> = <span class="r667 r">lhsChain</span>;
            <a href="#2bd325bbf09cdf8f" class="i property">RhsPipeline</a> = <span class="r668 r">rhsPipeline</span>;
            <a href="#8f367d5ba0b83448" class="i property">Operator</a> = <span class="r669 r">chainOperator</span>;
            <a href="#ee72132d90340648" class="i property">Background</a> = <span class="r670 r">background</span>;
 
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#6762de62f426f4e6" class="i property">LhsPipelineChain</a>);
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#2bd325bbf09cdf8f" class="i property">RhsPipeline</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the left hand pipeline in the chain.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#4ed29ab5c0549573" class="t t">ChainableAst</a> <a id="6762de62f426f4e6" href="../../R/6762de62f426f4e6.html" target="n" data-glyph="102,1" class="i property">LhsPipelineChain</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the right hand pipeline in the chain.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a> <a id="2bd325bbf09cdf8f" href="../../R/2bd325bbf09cdf8f.html" target="n" data-glyph="102,1" class="i property">RhsPipeline</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the chaining operator used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <a id="8f367d5ba0b83448" href="../../R/8f367d5ba0b83448.html" target="n" data-glyph="102,1" class="i property">Operator</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a flag that indicates whether this chain has been invoked with the background operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="ee72132d90340648" href="../../R/ee72132d90340648.html" target="n" data-glyph="102,1" class="i property">Background</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a copy of this Ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A fresh copy of this PipelineChainAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="8620a4500545f1cb" href="../../R/8620a4500545f1cb.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#07e97055b063d48b" class="t constructor">PipelineChainAst</a>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#6762de62f426f4e6" class="i property">LhsPipelineChain</a>), <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#2bd325bbf09cdf8f" class="i property">RhsPipeline</a>), <a href="#8f367d5ba0b83448" class="i property">Operator</a>, <a href="#ee72132d90340648" class="i property">Background</a>);
        }
 
        <b>internal override object</b> <a id="3b43847e5affd2bf" href="../../R/3b43847e5affd2bf.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r671 rd" class="r671 r">visitor</span>)
        {
            <b>return</b> (<span class="r671 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>)?.<a href="AstVisitor.cs.html#b1ef40788c148744" class="i method">VisitPipelineChain</a>(<a href="#56dc1a0918611f9c" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="966ac153de444ce7" href="../../R/966ac153de444ce7.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r672 rd" class="r672 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <span id="r673 rd" class="r673 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
 
            <span class="c">// Can only visit new AST type if using AstVisitor2</span>
            <b>if</b> (<span class="r672 r">visitor</span> <b>is</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a> <span id="r674 rd" class="r674 r">visitor2</span>)
            {
                <span class="r673 r">action</span> = <span class="r674 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#bfa47e7b57472768" class="i method">VisitPipelineChain</a>(<a href="#56dc1a0918611f9c" class="k">this</a>);
                <b>if</b> (<span class="r673 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                {
                    <b>return</b> <span class="r672 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#56dc1a0918611f9c" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
                }
            }
 
            <b>if</b> (<span class="r673 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r673 r">action</span> = <a href="#6762de62f426f4e6" class="i property">LhsPipelineChain</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r672 r">visitor</span>);
            }
 
            <b>if</b> (<span class="r673 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r673 r">action</span> = <a href="#2bd325bbf09cdf8f" class="i property">RhsPipeline</a>.<a href="#a0779953b0ce54f3" class="i method">InternalVisit</a>(<span class="r672 r">visitor</span>);
            }
 
            <b>return</b> <span class="r672 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#56dc1a0918611f9c" class="k">this</a>, <span class="r673 r">action</span>);
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Flow Control Statements
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Pipelines
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class for statements that include command invocations, pipelines, expressions, and assignments.</span>
    <span class="c">///</span><span class="c"> Any statement that does not begin with a keyword is derives from PipelineBastAst.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="86812479028959b8" href="../../R/86812479028959b8.html" target="n" data-glyph="0,0" class="t t">PipelineBaseAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common parts of a PipelineBaseAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r675 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r675 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="73f5cf54093debaa" href="../../R/73f5cf54093debaa.html" target="n" data-glyph="75,1" class="t constructor">PipelineBaseAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r675 rd" class="r675 r">extent</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r675 r">extent</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline represents a pure expression, the expression is returned, otherwise null is returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="158661f5f6c8db6d" href="../../R/158661f5f6c8db6d.html" target="n" data-glyph="72,1" class="i method">GetPureExpression</a>()
        {
            <b>return</b> <b>null</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a PowerShell pipeline, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">gci -re . *.cs | select-string Foo</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> 65..90 | % { [char]$_ }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> A pipeline must have at least 1 command.  The first command may be an expression or a command invocation.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="785915ec8547ce9f" href="../../R/785915ec8547ce9f.html" target="n" data-glyph="0,0" class="t t">PipelineAst</a> : <a href="#4ed29ab5c0549573" class="t t">ChainableAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a pipeline from a collection of commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r676 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r677 r">pipelineElements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The collection of commands representing the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r678 r">background</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates that this pipeline should be run in the background.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r676 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r677 r">pipelineElements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="5c63ca6f1705d184" href="../../R/5c63ca6f1705d184.html" target="n" data-glyph="72,1" class="t constructor">PipelineAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r676 rd" class="r676 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>&gt; <span id="r677 rd" class="r677 r">pipelineElements</span>, <b>bool</b> <span id="r678 rd" class="r678 r">background</span>)
            : <a href="#8ac9475482ff33ca" class="k">base</a>(<span class="r676 r">extent</span>)
        {
            <b>if</b> (<span class="r677 r">pipelineElements</span> == <b>null</b> || !<span class="r677 r">pipelineElements</span>.<span class="i">Any</span>())
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r677 r">pipelineElements</span>));
            }
 
            <a href="#785915ec8547ce9f" class="k">this</a>.<a href="#552590fec9ffecb9" class="i property">Background</a> = <span class="r678 r">background</span>;
            <a href="#785915ec8547ce9f" class="k">this</a>.<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>&gt;(<span class="r677 r">pipelineElements</span>.<span class="i">ToArray</span>());
            <span class="i">SetParents</span>(<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a pipeline from a collection of commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r679 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r680 r">pipelineElements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The collection of commands representing the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r679 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r680 r">pipelineElements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="041d3a2ef92511f8" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PipelineAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r679 rd" class="r679 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>&gt; <span id="r680 rd" class="r680 r">pipelineElements</span>) : <a href="#5c63ca6f1705d184" class="k">this</a>(<span class="r679 r">extent</span>, <span class="r680 r">pipelineElements</span>, <span class="r678 r">background</span>: <b>false</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a pipeline from a single command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r681 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the pipeline (which should be the extent of the command).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r682 r">commandAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The command for the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r683 r">background</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates that this pipeline should be run in the background.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r681 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r682 r">commandAst</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="208c7297a3426413" href="../../R/208c7297a3426413.html" target="n" data-glyph="72,1" class="t constructor">PipelineAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r681 rd" class="r681 r">extent</span>, <a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a> <span id="r682 rd" class="r682 r">commandAst</span>, <b>bool</b> <span id="r683 rd" class="r683 r">background</span>)
            : <a href="#8ac9475482ff33ca" class="k">base</a>(<span class="r681 r">extent</span>)
        {
            <b>if</b> (<span class="r682 r">commandAst</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r682 r">commandAst</span>));
            }
 
            <a href="#785915ec8547ce9f" class="k">this</a>.<a href="#552590fec9ffecb9" class="i property">Background</a> = <span class="r683 r">background</span>;
            <a href="#785915ec8547ce9f" class="k">this</a>.<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>&gt;(<b>new</b> <a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>[] { <span class="r682 r">commandAst</span> });
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r682 r">commandAst</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a pipeline from a single command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r684 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the pipeline (which should be the extent of the command).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r685 r">commandAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The command for the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r684 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r685 r">commandAst</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="bc7308f4cd134e5f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PipelineAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r684 rd" class="r684 r">extent</span>, <a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a> <span id="r685 rd" class="r685 r">commandAst</span>) : <a href="#208c7297a3426413" class="k">this</a>(<span class="r684 r">extent</span>, <span class="r685 r">commandAst</span>, <span class="r683 r">background</span>: <b>false</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A non-null, non-empty collection of commands that represent the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>&gt; <a id="edccd333bf2ee4d5" href="../../R/edccd333bf2ee4d5.html" target="n" data-glyph="102,1" class="i property">PipelineElements</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that this pipeline should be run in the background.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="552590fec9ffecb9" href="../../R/552590fec9ffecb9.html" target="n" data-glyph="102,1" class="i property">Background</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline represents a pure expression, the expression is returned, otherwise null is returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="df65de159259e5e0" href="../../R/df65de159259e5e0.html" target="n" data-glyph="72,1" class="i method">GetPureExpression</a>()
        {
            <b>if</b> (<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span> != 1)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r686 rd" class="r686 r">expr</span> = <a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>[0] <b>as</b> <a href="#f4da818a29387c5d" class="t t">CommandExpressionAst</a>;
            <b>if</b> (<span class="r686 r">expr</span> != <b>null</b> &amp;&amp; <span class="r686 r">expr</span>.<a href="#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <span class="r686 r">expr</span>.<a href="#5e5388d1f86139f7" class="i property">Expression</a>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the PipelineAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A fresh copy of this PipelineAst instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="de5615feec02b3d0" href="../../R/de5615feec02b3d0.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r687 rd" class="r687 r">newPipelineElements</span> = <span class="i">CopyElements</span>(<a href="#785915ec8547ce9f" class="k">this</a>.<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>);
            <b>return</b> <b>new</b> <span class="t">PipelineAst</span>(<a href="#785915ec8547ce9f" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r687 r">newPipelineElements</span>, <a href="#785915ec8547ce9f" class="k">this</a>.<a href="#552590fec9ffecb9" class="i property">Background</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="5faeb70c4d036e11" href="../../R/5faeb70c4d036e11.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r688 rd" class="r688 r">visitor</span>)
        {
            <b>return</b> <span class="r688 r">visitor</span>.<a href="AstVisitor.cs.html#4fe9b0e6e93b18f1" class="i method">VisitPipeline</a>(<a href="#785915ec8547ce9f" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="a0779953b0ce54f3" href="../../R/a0779953b0ce54f3.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r689 rd" class="r689 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r690 rd" class="r690 r">action</span> = <span class="r689 r">visitor</span>.<a href="PreOrderVisitor.cs.html#91b98e9424d06ede" class="i method">VisitPipeline</a>(<a href="#785915ec8547ce9f" class="k">this</a>);
            <b>if</b> (<span class="r690 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r689 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#785915ec8547ce9f" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r690 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r691 rd" class="r691 r">index</span> = 0; <span class="r691 r">index</span> &lt; <a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span>; <span class="r691 r">index</span>++)
                {
                    <b>var</b> <span id="r692 rd" class="r692 r">commandAst</span> = <a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>[<span class="r691 r">index</span>];
                    <span class="r690 r">action</span> = <span class="r692 r">commandAst</span>.<span class="i">InternalVisit</span>(<span class="r689 r">visitor</span>);
                    <b>if</b> (<span class="r690 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r689 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#785915ec8547ce9f" class="k">this</a>, <span class="r690 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class for the components of a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a310aaa1e0374ddd" class="t t">CommandAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="22790ae48f5438c6" href="../../R/22790ae48f5438c6.html" target="n" data-glyph="0,0" class="t t">CommandElementAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common fields of a comment element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r693 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the command element.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r693 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="ece7ecc8f9bc663a" href="../../R/ece7ecc8f9bc663a.html" target="n" data-glyph="75,1" class="t constructor">CommandElementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r693 rd" class="r693 r">extent</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r693 r">extent</span>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a parameter to a command, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">dir -Path a*</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, this class represent &#39;-Path&#39;, and</span>
    <span class="c">///</span><span class="c"> in </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">dir -Path:a*</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, this class represents &#39;-Path:a*&#39;.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> In the first case, the argument &#39;a*&#39; is not represented by this class because the parser can&#39;t know until runtime</span>
    <span class="c">///</span><span class="c"> if the argument is positional or if -Path accepts an argument.  In the later case, the argument &#39;a*&#39; always</span>
    <span class="c">///</span><span class="c"> belongs to the parameter -Path.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b97c3b8b32a8faec" href="../../R/b97c3b8b32a8faec.html" target="n" data-glyph="0,0" class="t t">CommandParameterAst</a> : <a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a command parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r694 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the parameter, starting from the dash character, ending at the end of the parameter name, or else</span>
        <span class="c">///</span><span class="c"> at the end of the optional argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r695 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter name, without the leading dash and without the trailing colon, if a colon was used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r696 r">argument</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the parameter includes an argument with the syntax like </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">-Path:a*</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, then the expression for &#39;a*&#39; is</span>
        <span class="c">///</span><span class="c"> passed as the argument.  An argument is not required.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r697 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent to use for error reporting when parameter binding fails with this parameter.  If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r696 r">argument</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is null, this extent is the same as </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r694 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, otherwise it is the extent of the parameter token</span>
        <span class="c">///</span><span class="c"> itself.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r694 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r695 r">parameterName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">is null, or if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r695 r">parameterName</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is an empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="1a9adbfa2026244e" href="../../R/1a9adbfa2026244e.html" target="n" data-glyph="72,1" class="t constructor">CommandParameterAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r694 rd" class="r694 r">extent</span>, <b>string</b> <span id="r695 rd" class="r695 r">parameterName</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r696 rd" class="r696 r">argument</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r697 rd" class="r697 r">errorPosition</span>)
            : <a href="#ece7ecc8f9bc663a" class="k">base</a>(<span class="r694 r">extent</span>)
        {
            <b>if</b> (<span class="r697 r">errorPosition</span> == <b>null</b> || <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r695 r">parameterName</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r697 r">errorPosition</span> == <b>null</b> ? <span class="s">&quot;errorPosition&quot;</span> : <span class="s">&quot;parameterName&quot;</span>);
            }
 
            <a href="#b97c3b8b32a8faec" class="k">this</a>.<a href="#0a26f1be6b3fd748" class="i property">ParameterName</a> = <span class="r695 r">parameterName</span>;
            <b>if</b> (<span class="r696 r">argument</span> != <b>null</b>)
            {
                <a href="#b97c3b8b32a8faec" class="k">this</a>.<a href="#21fa828caf096206" class="i property">Argument</a> = <span class="r696 r">argument</span>;
                <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r696 r">argument</span>);
            }
 
            <a href="#b97c3b8b32a8faec" class="k">this</a>.<a href="#c02cc0fd1f27d9da" class="i property">ErrorPosition</a> = <span class="r697 r">errorPosition</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter.  This value does not include a leading dash, and in the case that an argument</span>
        <span class="c">///</span><span class="c"> is specified, no trailing colon is included either.  This property is never null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="0a26f1be6b3fd748" href="../../R/0a26f1be6b3fd748.html" target="n" data-glyph="102,1" class="i property">ParameterName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the argument if specified (e.g. -Path:-abc, then the argument is the ast for &#39;-ast&#39;), otherwise null</span>
        <span class="c">///</span><span class="c"> if no argument was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="21fa828caf096206" href="../../R/21fa828caf096206.html" target="n" data-glyph="102,1" class="i property">Argument</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error position to use when parameter binding fails.  This extent does not include the argument if one was</span>
        <span class="c">///</span><span class="c"> specified, which means this extent is often the same as </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d47621d83efd14de" class="t t">Ast</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="c02cc0fd1f27d9da" href="../../R/c02cc0fd1f27d9da.html" target="n" data-glyph="102,1" class="i property">ErrorPosition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the CommandParameterAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="07bcba8a0c99398e" href="../../R/07bcba8a0c99398e.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r698 rd" class="r698 r">newArgument</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#b97c3b8b32a8faec" class="k">this</a>.<a href="#21fa828caf096206" class="i property">Argument</a>);
            <b>return</b> <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#b97c3b8b32a8faec" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#b97c3b8b32a8faec" class="k">this</a>.<a href="#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="r698 r">newArgument</span>, <a href="#b97c3b8b32a8faec" class="k">this</a>.<a href="#c02cc0fd1f27d9da" class="i property">ErrorPosition</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="14140084ba17b272" href="../../R/14140084ba17b272.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r699 rd" class="r699 r">visitor</span>)
        {
            <b>return</b> <span class="r699 r">visitor</span>.<a href="AstVisitor.cs.html#ab332365659c5f96" class="i method">VisitCommandParameter</a>(<a href="#b97c3b8b32a8faec" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="88bc567b66558afa" href="../../R/88bc567b66558afa.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r700 rd" class="r700 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r701 rd" class="r701 r">action</span> = <span class="r700 r">visitor</span>.<a href="PreOrderVisitor.cs.html#11dba5d60442e7e3" class="i method">VisitCommandParameter</a>(<a href="#b97c3b8b32a8faec" class="k">this</a>);
            <b>if</b> (<span class="r701 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r700 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#b97c3b8b32a8faec" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<a href="#21fa828caf096206" class="i property">Argument</a> != <b>null</b> &amp;&amp; <span class="r701 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r701 r">action</span> = <a href="#21fa828caf096206" class="i property">Argument</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r700 r">visitor</span>);
            }
 
            <b>return</b> <span class="r700 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#b97c3b8b32a8faec" class="k">this</a>, <span class="r701 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class for a command and an expression wrapper that allows an expression as a command in a pipeline.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="dd8dd8a40be8b41f" href="../../R/dd8dd8a40be8b41f.html" target="n" data-glyph="0,0" class="t t">CommandBaseAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#62235daca4a9c495" class="t t">RedirectionAst</a>&gt; <a id="375118bd96051586" href="../../R/375118bd96051586.html" target="n" data-glyph="46,1" class="i field">s_emptyRedirections</a> =
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<a href="#62235daca4a9c495" class="t t">RedirectionAst</a>&gt;();
 
        <b>internal const int</b> <a id="80ff30fa4d2e1f56" href="../../R/80ff30fa4d2e1f56.html" target="n" data-glyph="8,1" class="i field">MaxRedirections</a> = (<b>int</b>)<a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="#6b317670c1b918f0" class="i field">Information</a> + 1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common fields of a command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r702 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r703 r">redirections</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The redirections for the command, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r702 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="dc5528677e18fb95" href="../../R/dc5528677e18fb95.html" target="n" data-glyph="75,1" class="t constructor">CommandBaseAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r702 rd" class="r702 r">extent</span>, <span class="i">IEnumerable</span>&lt;<a href="#62235daca4a9c495" class="t t">RedirectionAst</a>&gt; <span id="r703 rd" class="r703 r">redirections</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r702 r">extent</span>)
        {
            <b>if</b> (<span class="r703 r">redirections</span> != <b>null</b>)
            {
                <a href="#dd8dd8a40be8b41f" class="k">this</a>.<a href="#7d87854c277c8363" class="i property">Redirections</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#62235daca4a9c495" class="t t">RedirectionAst</a>&gt;(<span class="r703 r">redirections</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#7d87854c277c8363" class="i property">Redirections</a>);
            }
            <b>else</b>
            {
                <a href="#dd8dd8a40be8b41f" class="k">this</a>.<a href="#7d87854c277c8363" class="i property">Redirections</a> = <a href="#375118bd96051586" class="i field">s_emptyRedirections</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The possibly empty collection of redirections for this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#62235daca4a9c495" class="t t">RedirectionAst</a>&gt; <a id="7d87854c277c8363" href="../../R/7d87854c277c8363.html" target="n" data-glyph="102,1" class="i property">Redirections</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast for a command invocation, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">dir *.ps1</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="a310aaa1e0374ddd" href="../../R/a310aaa1e0374ddd.html" target="n" data-glyph="0,0" class="t t">CommandAst</a> : <a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a command invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r704 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the command, starting with either the optional invocation operator &#39;</span><span class="c">&amp;amp;</span><span class="c">&#39; or &#39;.&#39; or the command name</span>
        <span class="c">///</span><span class="c"> and ending with the last command element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r705 r">commandElements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The elements of the command (command name, parameters and expressions.).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r706 r">invocationOperator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The invocation operator that was used, if any.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r707 r">redirections</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The redirections for the command, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r704 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r705 r">commandElements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="6896fc67bc97e743" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CommandAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r704 rd" class="r704 r">extent</span>,
                          <span class="i">IEnumerable</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <span id="r705 rd" class="r705 r">commandElements</span>,
                          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r706 rd" class="r706 r">invocationOperator</span>,
                          <span class="i">IEnumerable</span>&lt;<a href="#62235daca4a9c495" class="t t">RedirectionAst</a>&gt; <span id="r707 rd" class="r707 r">redirections</span>)
            : <a href="#dc5528677e18fb95" class="k">base</a>(<span class="r704 r">extent</span>, <span class="r707 r">redirections</span>)
        {
            <b>if</b> (<span class="r705 r">commandElements</span> == <b>null</b> || !<span class="r705 r">commandElements</span>.<span class="i">Any</span>())
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r705 r">commandElements</span>));
            }
 
            <b>if</b> (<span class="r706 r">invocationOperator</span> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a> &amp;&amp; <span class="r706 r">invocationOperator</span> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a> &amp;&amp; <span class="r706 r">invocationOperator</span> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r706 r">invocationOperator</span>));
            }
 
            <a href="#a310aaa1e0374ddd" class="k">this</a>.<a href="#f3fdfe686fb0ef19" class="i property">CommandElements</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt;(<span class="r705 r">commandElements</span>.<span class="i">ToArray</span>());
            <span class="i">SetParents</span>(<a href="#f3fdfe686fb0ef19" class="i property">CommandElements</a>);
            <a href="#a310aaa1e0374ddd" class="k">this</a>.<a href="#16e18484040f8b6f" class="i property">InvocationOperator</a> = <span class="r706 r">invocationOperator</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A non-empty collection of command elements.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <a id="f3fdfe686fb0ef19" href="../../R/f3fdfe686fb0ef19.html" target="n" data-glyph="102,1" class="i property">CommandElements</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The invocation operator (either </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">) if one was specified,</span>
        <span class="c">///</span><span class="c"> otherwise the value is </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <a id="16e18484040f8b6f" href="../../R/16e18484040f8b6f.html" target="n" data-glyph="102,1" class="i property">InvocationOperator</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Returns the name of the command invoked by this ast.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">This command name may not be known statically, in which case null is returned.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For example, if the command name is in a variable: </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span><span class="c">&amp;amp;</span><span class="c"> $foo</span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span><span class="c">, then the parser cannot know which command is executed.</span>
        <span class="c">///</span><span class="c"> Similarly, if the command is being invoked in a module: </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span><span class="c">&amp;amp;</span><span class="c"> (gmo SomeModule) Bar</span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span><span class="c">, then the parser does not know the</span>
        <span class="c">///</span><span class="c"> command name is Bar because the parser can&#39;t determine that the expression </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">(gmo SomeModule)</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c"> returns a module instead</span>
        <span class="c">///</span><span class="c"> of a string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command name, if known, null otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public string</b> <a id="14cec84b5558d5c6" href="../../R/14cec84b5558d5c6.html" target="n" data-glyph="72,1" class="i method">GetCommandName</a>()
        {
            <a href="#e18e1bad255cd022" class="k">var</a> <span id="r708 rd" class="r708 r">name</span> = <a href="#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0] <b>as</b> <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>return</b> <span class="r708 r">name</span>?.<a href="#a6dc72732a1c7e0d" class="i property">Value</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this command was synthesized out of a dynamic keyword, this property will point to the DynamicKeyword</span>
        <span class="c">///</span><span class="c"> data structure that was used to create this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <a id="38c09f0576bc413e" href="../../R/38c09f0576bc413e.html" target="n" data-glyph="102,1" class="i property">DefiningKeyword</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the CommandAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="47663c267c34dd7d" href="../../R/47663c267c34dd7d.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r709 rd" class="r709 r">newCommandElements</span> = <span class="i">CopyElements</span>(<a href="#a310aaa1e0374ddd" class="k">this</a>.<a href="#f3fdfe686fb0ef19" class="i property">CommandElements</a>);
            <b>var</b> <span id="r710 rd" class="r710 r">newRedirections</span> = <span class="i">CopyElements</span>(<a href="#a310aaa1e0374ddd" class="k">this</a>.<a href="#7d87854c277c8363" class="i property">Redirections</a>);
            <b>return</b> <b>new</b> <span class="t">CommandAst</span>(<a href="#a310aaa1e0374ddd" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r709 r">newCommandElements</span>, <a href="#a310aaa1e0374ddd" class="k">this</a>.<a href="#16e18484040f8b6f" class="i property">InvocationOperator</a>, <span class="r710 r">newRedirections</span>)
            {
                <a href="#38c09f0576bc413e" class="i property">DefiningKeyword</a> = <a href="#a310aaa1e0374ddd" class="k">this</a>.<a href="#38c09f0576bc413e" class="i property">DefiningKeyword</a>
            };
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="d6dd2d4bbb54b8f3" href="../../R/d6dd2d4bbb54b8f3.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r711 rd" class="r711 r">visitor</span>)
        {
            <b>return</b> <span class="r711 r">visitor</span>.<a href="AstVisitor.cs.html#9366925891952c51" class="i method">VisitCommand</a>(<a href="#a310aaa1e0374ddd" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="bd01809f73bbec19" href="../../R/bd01809f73bbec19.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r712 rd" class="r712 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r713 rd" class="r713 r">action</span> = <span class="r712 r">visitor</span>.<a href="PreOrderVisitor.cs.html#da50bbd047cdf47d" class="i method">VisitCommand</a>(<a href="#a310aaa1e0374ddd" class="k">this</a>);
            <b>if</b> (<span class="r713 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r712 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a310aaa1e0374ddd" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r713 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r714 rd" class="r714 r">index</span> = 0; <span class="r714 r">index</span> &lt; <a href="#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span>; <span class="r714 r">index</span>++)
                {
                    <b>var</b> <span id="r715 rd" class="r715 r">commandElementAst</span> = <a href="#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r714 r">index</span>];
                    <span class="r713 r">action</span> = <span class="r715 r">commandElementAst</span>.<span class="i">InternalVisit</span>(<span class="r712 r">visitor</span>);
                    <b>if</b> (<span class="r713 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r713 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r716 rd" class="r716 r">index</span> = 0; <span class="r716 r">index</span> &lt; <a href="#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span>; <span class="r716 r">index</span>++)
                {
                    <b>var</b> <span id="r717 rd" class="r717 r">redirection</span> = <a href="#7d87854c277c8363" class="i property">Redirections</a>[<span class="r716 r">index</span>];
                    <b>if</b> (<span class="r713 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    {
                        <span class="r713 r">action</span> = <span class="r717 r">redirection</span>.<span class="i">InternalVisit</span>(<span class="r712 r">visitor</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r712 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a310aaa1e0374ddd" class="k">this</a>, <span class="r713 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing an expression when the expression is used as the first command of a pipeline.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="f4da818a29387c5d" href="../../R/f4da818a29387c5d.html" target="n" data-glyph="0,0" class="t t">CommandExpressionAst</a> : <a href="#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a command that wraps an expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r718 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r719 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression being wrapped.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r720 r">redirections</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The redirections for the command, may be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r718 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r719 r">expression</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="cdb6db10eccdfa97" href="../../R/cdb6db10eccdfa97.html" target="n" data-glyph="72,1" class="t constructor">CommandExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r718 rd" class="r718 r">extent</span>,
                                    <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r719 rd" class="r719 r">expression</span>,
                                    <span class="i">IEnumerable</span>&lt;<a href="#62235daca4a9c495" class="t t">RedirectionAst</a>&gt; <span id="r720 rd" class="r720 r">redirections</span>)
            : <a href="#dc5528677e18fb95" class="k">base</a>(<span class="r718 r">extent</span>, <span class="r720 r">redirections</span>)
        {
            <b>if</b> (<span class="r719 r">expression</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r719 r">expression</span>));
            }
 
            <a href="#f4da818a29387c5d" class="k">this</a>.<a href="#5e5388d1f86139f7" class="i property">Expression</a> = <span class="r719 r">expression</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r719 r">expression</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the expression that is or starts a pipeline.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="5e5388d1f86139f7" href="../../R/5e5388d1f86139f7.html" target="n" data-glyph="102,1" class="i property">Expression</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the CommandExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="17ee8c39d259c24c" href="../../R/17ee8c39d259c24c.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r721 rd" class="r721 r">newExpression</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#f4da818a29387c5d" class="k">this</a>.<a href="#5e5388d1f86139f7" class="i property">Expression</a>);
            <b>var</b> <span id="r722 rd" class="r722 r">newRedirections</span> = <span class="i">CopyElements</span>(<a href="#f4da818a29387c5d" class="k">this</a>.<a href="#7d87854c277c8363" class="i property">Redirections</a>);
            <b>return</b> <b>new</b> <span class="t">CommandExpressionAst</span>(<a href="#f4da818a29387c5d" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r721 r">newExpression</span>, <span class="r722 r">newRedirections</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="f77cf3ec9f9a59b1" href="../../R/f77cf3ec9f9a59b1.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r723 rd" class="r723 r">visitor</span>)
        {
            <b>return</b> <span class="r723 r">visitor</span>.<a href="AstVisitor.cs.html#ea9e98dd9c93112a" class="i method">VisitCommandExpression</a>(<a href="#f4da818a29387c5d" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="424b1518991e76fa" href="../../R/424b1518991e76fa.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r724 rd" class="r724 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r725 rd" class="r725 r">action</span> = <span class="r724 r">visitor</span>.<a href="PreOrderVisitor.cs.html#a37aefd5dc604978" class="i method">VisitCommandExpression</a>(<a href="#f4da818a29387c5d" class="k">this</a>);
            <b>if</b> (<span class="r725 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r724 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f4da818a29387c5d" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r725 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r725 r">action</span> = <a href="#5e5388d1f86139f7" class="i property">Expression</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r724 r">visitor</span>);
            <b>if</b> (<span class="r725 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r726 rd" class="r726 r">index</span> = 0; <span class="r726 r">index</span> &lt; <a href="#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span>; <span class="r726 r">index</span>++)
                {
                    <b>var</b> <span id="r727 rd" class="r727 r">redirection</span> = <a href="#7d87854c277c8363" class="i property">Redirections</a>[<span class="r726 r">index</span>];
                    <b>if</b> (<span class="r725 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                    {
                        <span class="r725 r">action</span> = <span class="r727 r">redirection</span>.<span class="i">InternalVisit</span>(<span class="r724 r">visitor</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r724 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f4da818a29387c5d" class="k">this</a>, <span class="r725 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class representing both file redirections and merging redirections.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="62235daca4a9c495" href="../../R/62235daca4a9c495.html" target="n" data-glyph="0,0" class="t t">RedirectionAst</a> : <a href="#d47621d83efd14de" class="t t">Ast</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the common fields in a redirection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r728 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the redirection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r729 r">from</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The stream to read from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="6d55bb3b1cc0a546" href="../../R/6d55bb3b1cc0a546.html" target="n" data-glyph="75,1" class="t constructor">RedirectionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r728 rd" class="r728 r">extent</span>, <a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <span id="r729 rd" class="r729 r">from</span>)
            : <a href="#e73f9afcbf27eb4d" class="k">base</a>(<span class="r728 r">extent</span>)
        {
            <a href="#62235daca4a9c495" class="k">this</a>.<a href="#54d26a89dbf0384f" class="i property">FromStream</a> = <span class="r729 r">from</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The stream to read objects from.  Objects are either merged with another stream, or written to a file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <a id="54d26a89dbf0384f" href="../../R/54d26a89dbf0384f.html" target="n" data-glyph="102,1" class="i property">FromStream</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The stream number that is redirected.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1711:IdentifiersShouldNotHaveIncorrectSuffix&quot;</span>)]
    <b>public enum</b> <a id="56e58ab4dc31cf5f" href="../../R/56e58ab4dc31cf5f.html" target="n" data-glyph="18,0" class="t t"><span id="10ee647aff98d649">RedirectionStream</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All streams, used when the redirection token uses &#39;*&#39; as the stream number.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e7ee7b8a1be15429" href="../../R/e7ee7b8a1be15429.html" target="n" data-glyph="24,1" class="i field">All</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The normal output stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="eef57f42e4c4012c" href="../../R/eef57f42e4c4012c.html" target="n" data-glyph="24,1" class="i field">Output</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9d1b0150bfeb2a28" href="../../R/9d1b0150bfeb2a28.html" target="n" data-glyph="24,1" class="i field">Error</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The warning stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f7c802fd607d5b44" href="../../R/f7c802fd607d5b44.html" target="n" data-glyph="24,1" class="i field">Warning</a> = 3,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The verbose stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9cb9a8aa5616a489" href="../../R/9cb9a8aa5616a489.html" target="n" data-glyph="24,1" class="i field">Verbose</a> = 4,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The debug stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="179346bf2c8c70e8" href="../../R/179346bf2c8c70e8.html" target="n" data-glyph="24,1" class="i field">Debug</a> = 5,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The information stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="6b317670c1b918f0" href="../../R/6b317670c1b918f0.html" target="n" data-glyph="24,1" class="i field">Information</a> = 6
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a redirection that merges 2 streams, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">dir 2&gt;</span><span class="c">&amp;amp;</span><span class="c">1</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="57ad2a29a39e91e6" href="../../R/57ad2a29a39e91e6.html" target="n" data-glyph="0,0" class="t t">MergingRedirectionAst</a> : <a href="#62235daca4a9c495" class="t t">RedirectionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a merging redirection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r730 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the redirection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r731 r">from</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The stream to read from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r732 r">to</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The stream to write to - must always be </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="#eef57f42e4c4012c" class="i field">Output</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r730 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="09fae3cd5578a4e0" href="../../R/09fae3cd5578a4e0.html" target="n" data-glyph="72,1" class="t constructor">MergingRedirectionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r730 rd" class="r730 r">extent</span>, <a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <span id="r731 rd" class="r731 r">from</span>, <a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <span id="r732 rd" class="r732 r">to</span>)
            : <a href="#6d55bb3b1cc0a546" class="k">base</a>(<span class="r730 r">extent</span>, <span class="r731 r">from</span>)
        {
            <a href="#57ad2a29a39e91e6" class="k">this</a>.<a href="#f0ccba0030de4284" class="i property">ToStream</a> = <span class="r732 r">to</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The stream that results will be written to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <a id="f0ccba0030de4284" href="../../R/f0ccba0030de4284.html" target="n" data-glyph="102,1" class="i property">ToStream</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the MergingRedirectionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="6f2fcfc8572f5aa0" href="../../R/6f2fcfc8572f5aa0.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#09fae3cd5578a4e0" class="t constructor">MergingRedirectionAst</a>(<a href="#57ad2a29a39e91e6" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#57ad2a29a39e91e6" class="k">this</a>.<a href="#54d26a89dbf0384f" class="i property">FromStream</a>, <a href="#57ad2a29a39e91e6" class="k">this</a>.<a href="#f0ccba0030de4284" class="i property">ToStream</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="bff2eab2f3e89b44" href="../../R/bff2eab2f3e89b44.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r733 rd" class="r733 r">visitor</span>)
        {
            <b>return</b> <span class="r733 r">visitor</span>.<a href="AstVisitor.cs.html#ca943ee6c4869151" class="i method">VisitMergingRedirection</a>(<a href="#57ad2a29a39e91e6" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="08f810378622ff0e" href="../../R/08f810378622ff0e.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r734 rd" class="r734 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r735 rd" class="r735 r">action</span> = <span class="r734 r">visitor</span>.<a href="PreOrderVisitor.cs.html#058b1e60e37f98e1" class="i method">VisitMergingRedirection</a>(<a href="#57ad2a29a39e91e6" class="k">this</a>);
            <b>return</b> <span class="r734 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#57ad2a29a39e91e6" class="k">this</a>, <span class="r735 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> ? <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> : <span class="r735 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a redirection to a file, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">dir &gt; out.txt</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, the &#39;&gt; out.txt&#39; is represented by this ast.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="2288e8fa779a0d57" href="../../R/2288e8fa779a0d57.html" target="n" data-glyph="0,0" class="t t">FileRedirectionAst</a> : <a href="#62235daca4a9c495" class="t t">RedirectionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a redirection to a file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r736 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the redirection, starting with the redirection operator and including the file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r737 r">stream</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The stream being redirected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r738 r">file</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The optional location to redirect to.  Merging operators may not specify a file, the other redirection</span>
        <span class="c">///</span><span class="c"> operators must specify a location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r739 r">append</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the file is being appended, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r736 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r738 r">file</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="3db17bc3755e0514" href="../../R/3db17bc3755e0514.html" target="n" data-glyph="72,1" class="t constructor">FileRedirectionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r736 rd" class="r736 r">extent</span>, <a href="#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <span id="r737 rd" class="r737 r">stream</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r738 rd" class="r738 r">file</span>, <b>bool</b> <span id="r739 rd" class="r739 r">append</span>)
            : <a href="#6d55bb3b1cc0a546" class="k">base</a>(<span class="r736 r">extent</span>, <span class="r737 r">stream</span>)
        {
            <b>if</b> (<span class="r738 r">file</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r738 r">file</span>));
            }
 
            <a href="#2288e8fa779a0d57" class="k">this</a>.<a href="#387c7bd2fd1d9d89" class="i property">Location</a> = <span class="r738 r">file</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r738 r">file</span>);
            <a href="#2288e8fa779a0d57" class="k">this</a>.<a href="#394a80d552aaa2ca" class="i property">Append</a> = <span class="r739 r">append</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the location to redirect to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="387c7bd2fd1d9d89" href="../../R/387c7bd2fd1d9d89.html" target="n" data-glyph="102,1" class="i property">Location</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the file is appended, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="394a80d552aaa2ca" href="../../R/394a80d552aaa2ca.html" target="n" data-glyph="102,1" class="i property">Append</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the FileRedirectionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="96f2267f21cfd503" href="../../R/96f2267f21cfd503.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r740 rd" class="r740 r">newFile</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#2288e8fa779a0d57" class="k">this</a>.<a href="#387c7bd2fd1d9d89" class="i property">Location</a>);
            <b>return</b> <b>new</b> <a href="#3db17bc3755e0514" class="t constructor">FileRedirectionAst</a>(<a href="#2288e8fa779a0d57" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#2288e8fa779a0d57" class="k">this</a>.<a href="#54d26a89dbf0384f" class="i property">FromStream</a>, <span class="r740 r">newFile</span>, <a href="#2288e8fa779a0d57" class="k">this</a>.<a href="#394a80d552aaa2ca" class="i property">Append</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="fb1d7371133a12ba" href="../../R/fb1d7371133a12ba.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r741 rd" class="r741 r">visitor</span>)
        {
            <b>return</b> <span class="r741 r">visitor</span>.<a href="AstVisitor.cs.html#af553a1817cde642" class="i method">VisitFileRedirection</a>(<a href="#2288e8fa779a0d57" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="258cff81aa11f752" href="../../R/258cff81aa11f752.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r742 rd" class="r742 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r743 rd" class="r743 r">action</span> = <span class="r742 r">visitor</span>.<a href="PreOrderVisitor.cs.html#046210e665ed874a" class="i method">VisitFileRedirection</a>(<a href="#2288e8fa779a0d57" class="k">this</a>);
            <b>if</b> (<span class="r743 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r742 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#2288e8fa779a0d57" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r743 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r743 r">action</span> = <a href="#387c7bd2fd1d9d89" class="i property">Location</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r742 r">visitor</span>);
            <b>return</b> <span class="r742 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#2288e8fa779a0d57" class="k">this</a>, <span class="r743 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Pipelines
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an assignment statement, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$x = 42</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="da5f345864f42e06" href="../../R/da5f345864f42e06.html" target="n" data-glyph="0,0" class="t t">AssignmentStatementAst</a> : <a href="#86812479028959b8" class="t t">PipelineBaseAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an assignment statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r744 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the assignment statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r745 r">left</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value being assigned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r746 r">operator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The assignment operator, e.g. &#39;=&#39; or &#39;+=&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r747 r">right</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to assign.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r748 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The position to report an error if an error occurs at runtime.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r744 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r745 r">left</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r747 r">right</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r748 r">errorPosition</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="d091f17bebe00b69" href="../../R/d091f17bebe00b69.html" target="n" data-glyph="72,1" class="t constructor">AssignmentStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r744 rd" class="r744 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r745 rd" class="r745 r">left</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r746 rd" class="r746 r">@operator</span>, <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r747 rd" class="r747 r">right</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r748 rd" class="r748 r">errorPosition</span>)
            : <a href="#73f5cf54093debaa" class="k">base</a>(<span class="r744 r">extent</span>)
        {
            <b>if</b> (<span class="r745 r">left</span> == <b>null</b> || <span class="r747 r">right</span> == <b>null</b> || <span class="r748 r">errorPosition</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r745 r">left</span> == <b>null</b> ? <span class="s">&quot;left&quot;</span> : <span class="r747 r">right</span> == <b>null</b> ? <span class="s">&quot;right&quot;</span> : <span class="s">&quot;errorPosition&quot;</span>);
            }
 
            <b>if</b> ((<span class="r746 r">@operator</span>.<a href="token.cs.html#dd86d229f95e81c2" class="i method">GetTraits</a>() &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#c02b7eb49b9e2b47" class="i field">AssignmentOperator</a>) == 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r746 r">@operator</span>));
            }
 
            <span class="c">// If the assignment is just an expression and the expression is not backgrounded then</span>
            <span class="c">// remove the pipeline wrapping the expression.</span>
            <a href="#785915ec8547ce9f" class="k">var</a> <span id="r749 rd" class="r749 r">pipelineAst</span> = <span class="r747 r">right</span> <b>as</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a>;
            <b>if</b> (<span class="r749 r">pipelineAst</span> != <b>null</b> &amp;&amp; !<span class="r749 r">pipelineAst</span>.<a href="#552590fec9ffecb9" class="i property">Background</a>)
            {
                <b>if</b> (<span class="r749 r">pipelineAst</span>.<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span> == 1)
                {
                    <a href="#f4da818a29387c5d" class="k">var</a> <span id="r750 rd" class="r750 r">commandExpressionAst</span> = <span class="r749 r">pipelineAst</span>.<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>[0] <b>as</b> <a href="#f4da818a29387c5d" class="t t">CommandExpressionAst</a>;
 
                    <b>if</b> (<span class="r750 r">commandExpressionAst</span> != <b>null</b>)
                    {
                        <span class="r747 r">right</span> = <span class="r750 r">commandExpressionAst</span>;
                        <span class="r747 r">right</span>.<a href="#57de7cef4d614364" class="i method">ClearParent</a>();
                    }
                }
            }
 
            <a href="#da5f345864f42e06" class="k">this</a>.<a href="#2712fe866a1a962b" class="i property">Operator</a> = <span class="r746 r">@operator</span>;
            <a href="#da5f345864f42e06" class="k">this</a>.<a href="#737e87d58bda06dc" class="i property">Left</a> = <span class="r745 r">left</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r745 r">left</span>);
            <a href="#da5f345864f42e06" class="k">this</a>.<a href="#ca8f4cbe093f3036" class="i property">Right</a> = <span class="r747 r">right</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r747 r">right</span>);
            <a href="#da5f345864f42e06" class="k">this</a>.<a href="#91a2e1e3051a9797" class="i property">ErrorPosition</a> = <span class="r748 r">errorPosition</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the location being assigned.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="737e87d58bda06dc" href="../../R/737e87d58bda06dc.html" target="n" data-glyph="102,1" class="i property">Left</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The operator for token assignment (such as =, +=, -=, etc.).  The value is always some assignment operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <a id="2712fe866a1a962b" href="../../R/2712fe866a1a962b.html" target="n" data-glyph="102,1" class="i property">Operator</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the value to assign.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="ca8f4cbe093f3036" href="../../R/ca8f4cbe093f3036.html" target="n" data-glyph="102,1" class="i property">Right</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position to report at runtime if there is an error during assignment.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="91a2e1e3051a9797" href="../../R/91a2e1e3051a9797.html" target="n" data-glyph="102,1" class="i property">ErrorPosition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the AssignmentStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="1199874f094dda4f" href="../../R/1199874f094dda4f.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r751 rd" class="r751 r">newLeft</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#da5f345864f42e06" class="k">this</a>.<a href="#737e87d58bda06dc" class="i property">Left</a>);
            <a href="#9c25dfdd7f4807b0" class="k">var</a> <span id="r752 rd" class="r752 r">newRight</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#da5f345864f42e06" class="k">this</a>.<a href="#ca8f4cbe093f3036" class="i property">Right</a>);
            <b>return</b> <b>new</b> <a href="#d091f17bebe00b69" class="t constructor">AssignmentStatementAst</a>(<a href="#da5f345864f42e06" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r751 r">newLeft</span>, <a href="#da5f345864f42e06" class="k">this</a>.<a href="#2712fe866a1a962b" class="i property">Operator</a>, <span class="r752 r">newRight</span>, <a href="#da5f345864f42e06" class="k">this</a>.<a href="#91a2e1e3051a9797" class="i property">ErrorPosition</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return all of the expressions assigned by the assignment statement.  Typically</span>
        <span class="c">///</span><span class="c"> it&#39;s just a variable expression, but if </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#737e87d58bda06dc" class="i property">Left</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is an </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0e44bc9125134006" class="t t">ArrayLiteralAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> then all of the elements are assigned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">All of the expressions assigned by the assignment statement.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="118f31ee174579ad" href="../../R/118f31ee174579ad.html" target="n" data-glyph="72,1" class="i method">GetAssignmentTargets</a>()
        {
            <a href="#0e44bc9125134006" class="k">var</a> <span id="r753 rd" class="r753 r">arrayExpression</span> = <a href="#737e87d58bda06dc" class="i property">Left</a> <b>as</b> <a href="#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
            <b>if</b> (<span class="r753 r">arrayExpression</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r754 rd" class="r754 r">element</span> <b>in</b> <span class="r753 r">arrayExpression</span>.<a href="#1b2cdef74794d8b9" class="i property">Elements</a>)
                {
                    <b>yield</b> <b>return</b> <span class="r754 r">element</span>;
                }
 
                <b>yield</b> <b>break</b>;
            }
 
            <b>yield</b> <b>return</b> <a href="#737e87d58bda06dc" class="i property">Left</a>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="197ddb5e8dcbb53d" href="../../R/197ddb5e8dcbb53d.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r755 rd" class="r755 r">visitor</span>)
        {
            <b>return</b> <span class="r755 r">visitor</span>.<a href="AstVisitor.cs.html#966fff9b183d522d" class="i method">VisitAssignmentStatement</a>(<a href="#da5f345864f42e06" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="c22df49a6c151699" href="../../R/c22df49a6c151699.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r756 rd" class="r756 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r757 rd" class="r757 r">action</span> = <span class="r756 r">visitor</span>.<a href="PreOrderVisitor.cs.html#a38ee1169f302987" class="i method">VisitAssignmentStatement</a>(<a href="#da5f345864f42e06" class="k">this</a>);
            <b>if</b> (<span class="r757 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r756 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#da5f345864f42e06" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r757 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r757 r">action</span> = <a href="#737e87d58bda06dc" class="i property">Left</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r756 r">visitor</span>);
            <b>if</b> (<span class="r757 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r757 r">action</span> = <a href="#ca8f4cbe093f3036" class="i property">Right</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r756 r">visitor</span>);
            <b>return</b> <span class="r756 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#da5f345864f42e06" class="k">this</a>, <span class="r757 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines types of configuration document.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="786dff667907c54f" href="../../R/786dff667907c54f.html" target="n" data-glyph="18,0" class="t t"><span id="431f8db612c9c3c4">ConfigurationType</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resource configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="251df5e9ba731897" href="../../R/251df5e9ba731897.html" target="n" data-glyph="24,1" class="i field">Resource</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Meta configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e1069d3c13089322" href="../../R/e1069d3c13089322.html" target="n" data-glyph="24,1" class="i field">Meta</a> = 1
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast represents the DSC configuration statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="d0b13bd03366725b" href="../../R/d0b13bd03366725b.html" target="n" data-glyph="0,0" class="t t">ConfigurationDefinitionAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a configuration statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r758 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the attribute and ending after the expression being attributed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r759 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of the configuration statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r760 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of the configuration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r761 r">instanceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The configuration name expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r758 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r759 r">body</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r761 r">instanceName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="8f3c4e19cb14c49f" href="../../R/8f3c4e19cb14c49f.html" target="n" data-glyph="72,1" class="t constructor">ConfigurationDefinitionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r758 rd" class="r758 r">extent</span>,
            <a href="#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r759 rd" class="r759 r">body</span>,
            <a href="#786dff667907c54f" class="t t">ConfigurationType</a> <span id="r760 rd" class="r760 r">type</span>,
            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r761 rd" class="r761 r">instanceName</span>) : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r758 r">extent</span>)
        {
            <b>if</b> (<span class="r758 r">extent</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r758 r">extent</span>));
            }
 
            <b>if</b> (<span class="r759 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r759 r">body</span>));
            }
 
            <b>if</b> (<span class="r761 r">instanceName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r761 r">instanceName</span>));
            }
 
            <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#230f823f9866cee2" class="i property">Body</a> = <span class="r759 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r759 r">body</span>);
            <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#22d89775bd538a61" class="i property">ConfigurationType</a> = <span class="r760 r">type</span>;
            <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#5378ed44edf4cc30" class="i property">InstanceName</a> = <span class="r761 r">instanceName</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r761 r">instanceName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This ast represents configuration body script block.</span>
        <span class="c">///</span><span class="c"> This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <a id="230f823f9866cee2" href="../../R/230f823f9866cee2.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The configuration type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#786dff667907c54f" class="t t">ConfigurationType</a> <a id="22d89775bd538a61" href="../../R/22d89775bd538a61.html" target="n" data-glyph="102,1" class="i property">ConfigurationType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the configuration instance,</span>
        <span class="c">///</span><span class="c"> For example, Instance name of &#39;configuration test { ...... }&#39; is &#39;test&#39;</span>
        <span class="c">///</span><span class="c"> This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="5378ed44edf4cc30" href="../../R/5378ed44edf4cc30.html" target="n" data-glyph="102,1" class="i property">InstanceName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Duplicates the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, allowing it to be composed into other ASTs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A copy of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, with the link to the previous parent removed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="a62e4a67b8799d39" href="../../R/a62e4a67b8799d39.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r762 rd" class="r762 r">body</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#230f823f9866cee2" class="i property">Body</a>);
            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r763 rd" class="r763 r">instanceName</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#5378ed44edf4cc30" class="i property">InstanceName</a>);
            <b>return</b> <b>new</b> <a href="#8f3c4e19cb14c49f" class="t constructor">ConfigurationDefinitionAst</a>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r762 r">body</span>, <a href="#22d89775bd538a61" class="i property">ConfigurationType</a>, <span class="r763 r">instanceName</span>)
            {
                <a href="#d40fe37376267313" class="i property">LCurlyToken</a> = <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d40fe37376267313" class="i property">LCurlyToken</a>,
                <a href="#0efa958062060e17" class="i property">ConfigurationToken</a> = <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#0efa958062060e17" class="i property">ConfigurationToken</a>,
                <a href="#0528a2e7b8bcb178" class="i property">CustomAttributes</a> = <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#0528a2e7b8bcb178" class="i property">CustomAttributes</a>?.<span class="i">Select</span>(<b>static</b> <span id="r764 rd" class="r764 r">e</span> =&gt; (<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>)<span class="r764 r">e</span>.<span class="i">Copy</span>())
            };
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="2abbda75d6c1264f" href="../../R/2abbda75d6c1264f.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r765 rd" class="r765 r">visitor</span>)
        {
            <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="k">var</a> <span id="r766 rd" class="r766 r">visitor2</span> = <span class="r765 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>;
            <b>return</b> <span class="r766 r">visitor2</span>?.<a href="AstVisitor.cs.html#80fc801e18b512ed" class="i method">VisitConfigurationDefinition</a>(<a href="#d0b13bd03366725b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="3dda2fab5beb4e22" href="../../R/3dda2fab5beb4e22.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r767 rd" class="r767 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r768 rd" class="r768 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r769 rd" class="r769 r">visitor2</span> = <span class="r767 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r769 r">visitor2</span> != <b>null</b>)
            {
                <span class="r768 r">action</span> = <span class="r769 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#02619a989c833254" class="i method">VisitConfigurationDefinition</a>(<a href="#d0b13bd03366725b" class="k">this</a>);
                <b>if</b> (<span class="r768 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                    <b>return</b> <span class="r767 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#d0b13bd03366725b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            }
 
            <b>if</b> (<span class="r768 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r768 r">action</span> = <a href="#5378ed44edf4cc30" class="i property">InstanceName</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r767 r">visitor</span>);
            }
 
            <b>if</b> (<span class="r768 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#c1cfb05d7c5cce33" class="i method">InternalVisit</a>(<span class="r767 r">visitor</span>);
            }
 
            <b>return</b> <span class="r767 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#d0b13bd03366725b" class="k">this</a>, <span class="r768 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal methods/properties
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="d40fe37376267313" href="../../R/d40fe37376267313.html" target="n" data-glyph="104,1" class="i property">LCurlyToken</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="0efa958062060e17" href="../../R/0efa958062060e17.html" target="n" data-glyph="104,1" class="i property">ConfigurationToken</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="0528a2e7b8bcb178" href="../../R/0528a2e7b8bcb178.html" target="n" data-glyph="104,1" class="i property">CustomAttributes</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A dynamic keyword may also define additional keywords in the child scope</span>
        <span class="c">///</span><span class="c"> of the scriptblock. This collection will contain those keywords.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>internal</b> <span class="i">List</span>&lt;<a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt; <a id="965ad4d7acbcd14a" href="../../R/965ad4d7acbcd14a.html" target="n" data-glyph="104,1" class="i property">DefinedKeywords</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generate ast that defines a function for this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#785915ec8547ce9f" class="t t">PipelineAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that defines a function for this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a> <a id="d297296cd1fef10d" href="../../R/d297296cd1fef10d.html" target="n" data-glyph="74,1" class="i method">GenerateSetItemPipelineAst</a>()
        {
            <span class="c">// **************************</span>
            <span class="c">// Now construct the AST to call the function that will build the actual object.</span>
            <span class="c">// This is composed of a call to command with the signature</span>
            <span class="c">//    function PSDesiredStateConfiguration\\Configuration</span>
            <span class="c">//    {</span>
            <span class="c">//      param (</span>
            <span class="c">//          ResourceModuleTuplesToImport,      # list of required resource-module tuples</span>
            <span class="c">//          $OutputPath = &quot;.&quot;,      # output path where the MOF will be placed</span>
            <span class="c">//          $Name,                  # name of the configuration == name of the wrapper function</span>
            <span class="c">//          [scriptblock]</span>
            <span class="c">//              $Body,              # the body of the configuration</span>
            <span class="c">//          [hashtable]</span>
            <span class="c">//              $ArgsToBody,        # the argument values to pass to the body scriptblock</span>
            <span class="c">//          [hashtable]</span>
            <span class="c">//              $ConfigurationData, # a collection of property bags describe the configuration environment</span>
            <span class="c">//          [string]</span>
            <span class="c">//              $InstanceName = &quot;&quot;  # THe name of the configuration instance being created.</span>
            <span class="c">//          [boolean]</span>
            <span class="c">//               $IsMetaConfig = $false # the configuration to generated is a meta configuration</span>
            <span class="c">//      )</span>
            <span class="c">//   }</span>
 
            <b>var</b> <span id="r770 rd" class="r770 r">cea</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt;
            {
                <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>,
                                                <span class="s">@&quot;PSDesiredStateConfiguration\Configuration&quot;</span>,
                                                <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>),
                <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;ArgsToBody&quot;</span>, <b>new</b> <a href="#ca2f2cf1331a5386" class="t constructor">VariableExpressionAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;toBody&quot;</span>, <b>false</b>), <a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;Name&quot;</span>, (<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>)<a href="#5378ed44edf4cc30" class="i property">InstanceName</a>.<a href="#7559dca1878820e8" class="i method">Copy</a>(), <a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>)
            };
 
            <span class="c">///////////////////////////</span>
            <span class="c">// get import parameters</span>
            <b>var</b> <span id="r771 rd" class="r771 r">bodyStatements</span> = <a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#3155915865e15c92" class="i property">ScriptBlock</a>.<a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a>;
            <b>var</b> <span id="r772 rd" class="r772 r">resourceModulePairsToImport</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<b>string</b>[], <a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[], <span class="i">Version</span>&gt;&gt;();
            <b>var</b> <span id="r773 rd" class="r773 r">resourceBody</span> = (<b>from</b> <span class="i">stm</span> <b>in</b> <span class="r771 r">bodyStatements</span> <b>where</b> !<span class="i">IsImportCommand</span>(<span class="i">stm</span>, <span class="r772 r">resourceModulePairsToImport</span>) <b>select</b> (<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>)<span class="i">stm</span>.<span class="i">Copy</span>()).<span class="i">ToList</span>();
 
            <span class="r770 r">cea</span>.<span class="i">Add</span>(<b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>, <span class="s">&quot;ResourceModuleTuplesToImport&quot;</span>, <b>new</b> <span class="t">ConstantExpressionAst</span>(<a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>, <span class="r772 r">resourceModulePairsToImport</span>), <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>));
 
            <a href="#6f963589327835a4" class="k">var</a> <span id="r774 rd" class="r774 r">scriptBlockBody</span> = <b>new</b> <span class="t">ScriptBlockAst</span>(<a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>,
                <a href="#0528a2e7b8bcb178" class="i property">CustomAttributes</a>?.<span class="i">Select</span>(<b>static</b> <span id="r775 rd" class="r775 r">att</span> =&gt; (<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>)<span class="r775 r">att</span>.<span class="i">Copy</span>()).<span class="i">ToList</span>(),
                <b>null</b>,
                <b>new</b> <span class="t">StatementBlockAst</span>(<a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r773 r">resourceBody</span>, <b>null</b>),
                <b>false</b>, <b>false</b>);
 
            <a href="#5ec0737db546f4f5" class="k">var</a> <span id="r776 rd" class="r776 r">scriptBlockExp</span> = <b>new</b> <a href="#dd24d41ff02dddc5" class="t constructor">ScriptBlockExpressionAst</a>(<a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r774 r">scriptBlockBody</span>);
 
            <span class="c">// then the configuration scriptblock as -Body</span>
            <span class="r770 r">cea</span>.<span class="i">Add</span>(<b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;Body&quot;</span>, <span class="r776 r">scriptBlockExp</span>, <a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
 
            <span class="r770 r">cea</span>.<span class="i">Add</span>(<b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;Outputpath&quot;</span>, <b>new</b> <a href="#ca2f2cf1331a5386" class="t constructor">VariableExpressionAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;OutputPath&quot;</span>, <b>false</b>), <a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
 
            <span class="r770 r">cea</span>.<span class="i">Add</span>(<b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;ConfigurationData&quot;</span>, <b>new</b> <a href="#ca2f2cf1331a5386" class="t constructor">VariableExpressionAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;ConfigurationData&quot;</span>, <b>false</b>), <a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
 
            <span class="r770 r">cea</span>.<span class="i">Add</span>(<b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;InstanceName&quot;</span>, <b>new</b> <a href="#ca2f2cf1331a5386" class="t constructor">VariableExpressionAst</a>(<a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;InstanceName&quot;</span>, <b>false</b>), <a href="#d40fe37376267313" class="i property">LCurlyToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
 
            <span class="c">//</span>
            <span class="c">// copy the configuration parameter to the new function parameter</span>
            <span class="c">// the new set-item created function will have below parameters</span>
            <span class="c">//    [cmdletbinding()]</span>
            <span class="c">//    param(</span>
            <span class="c">//            [string]</span>
            <span class="c">//                $InstanceName,</span>
            <span class="c">//            [string[]]</span>
            <span class="c">//                $DependsOn,</span>
            <span class="c">//            [string]</span>
            <span class="c">//                $OutputPath,</span>
            <span class="c">//            [hashtable]</span>
            <span class="c">//            [Microsoft.PowerShell.DesiredStateConfiguration.ArgumentToConfigurationDataTransformation()]</span>
            <span class="c">//               $ConfigurationData</span>
            <span class="c">//        )</span>
            <span class="c">//</span>
            <b>var</b> <span id="r777 rd" class="r777 r">attribAsts</span> =
                <a href="#77ca5baf5e7b798e" class="i property">ConfigurationBuildInParameterAttribAsts</a>.<span class="i">Select</span>(<b>static</b> <span id="r778 rd" class="r778 r">attribAst</span> =&gt; (<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>)<span class="r778 r">attribAst</span>.<span class="i">Copy</span>()).<span class="i">ToList</span>();
 
            <b>var</b> <span id="r779 rd" class="r779 r">paramAsts</span> = <a href="#389e07a75f191719" class="i property">ConfigurationBuildInParameters</a>.<span class="i">Select</span>(<b>static</b> <span id="r780 rd" class="r780 r">paramAst</span> =&gt; (<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>)<span class="r780 r">paramAst</span>.<span class="i">Copy</span>()).<span class="i">ToList</span>();
 
            <span class="c">// the parameters defined in the configuration keyword will be combined with above parameters</span>
            <span class="c">// it will be used to construct $ArgsToBody in the set-item created function boby using below statement</span>
            <span class="c">//         $toBody = @{}+$PSBoundParameters</span>
            <span class="c">//         $toBody.Remove(&quot;&quot;OutputPath&quot;&quot;)</span>
            <span class="c">//         $toBody.Remove(&quot;&quot;ConfigurationData&quot;&quot;)</span>
            <span class="c">//         $ConfigurationData = $psboundparameters[&quot;&quot;ConfigurationData&quot;&quot;]</span>
            <span class="c">//         $Outputpath = $psboundparameters[&quot;&quot;Outputpath&quot;&quot;]</span>
            <b>if</b> (<a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#3155915865e15c92" class="i property">ScriptBlock</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <span class="r779 r">paramAsts</span>.<span class="i">AddRange</span>(<a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#3155915865e15c92" class="i property">ScriptBlock</a>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>.<span class="i">Select</span>(<b>static</b> <span id="r781 rd" class="r781 r">parameterAst</span> =&gt; (<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>)<span class="r781 r">parameterAst</span>.<span class="i">Copy</span>()));
            }
 
            <a href="#be95362bdc5e7d07" class="k">var</a> <span id="r782 rd" class="r782 r">paramBlockAst</span> = <b>new</b> <span class="t">ParamBlockAst</span>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r777 r">attribAsts</span>, <span class="r779 r">paramAsts</span>);
 
            <a href="#a310aaa1e0374ddd" class="k">var</a> <span id="r783 rd" class="r783 r">cmdAst</span> = <b>new</b> <span class="t">CommandAst</span>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r770 r">cea</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>, <b>null</b>);
 
            <a href="#785915ec8547ce9f" class="k">var</a> <span id="r784 rd" class="r784 r">pipeLineAst</span> = <b>new</b> <a href="#208c7297a3426413" class="t constructor">PipelineAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r783 r">cmdAst</span>, <span class="r683 r">background</span>: <b>false</b>);
            <b>var</b> <span id="r785 rd" class="r785 r">funcStatements</span> = <a href="#1e4f907d14a48281" class="i property">ConfigurationExtraParameterStatements</a>.<span class="i">Select</span>(<b>static</b> <span id="r786 rd" class="r786 r">statement</span> =&gt; (<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>)<span class="r786 r">statement</span>.<span class="i">Copy</span>()).<span class="i">ToList</span>();
            <span class="r785 r">funcStatements</span>.<span class="i">Add</span>(<span class="r784 r">pipeLineAst</span>);
            <a href="#268644c84b225866" class="k">var</a> <span id="r787 rd" class="r787 r">statmentBlockAst</span> = <b>new</b> <span class="t">StatementBlockAst</span>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r785 r">funcStatements</span>, <b>null</b>);
 
            <a href="#6f963589327835a4" class="k">var</a> <span id="r788 rd" class="r788 r">funcBody</span> = <b>new</b> <span class="t">ScriptBlockAst</span>(<a href="#230f823f9866cee2" class="i property">Body</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>,
                <a href="#0528a2e7b8bcb178" class="i property">CustomAttributes</a>?.<span class="i">Select</span>(<b>static</b> <span id="r789 rd" class="r789 r">att</span> =&gt; (<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>)<span class="r789 r">att</span>.<span class="i">Copy</span>()).<span class="i">ToList</span>(),
                <span class="r782 r">paramBlockAst</span>, <span class="r787 r">statmentBlockAst</span>, <b>false</b>, <b>true</b>);
            <a href="#5ec0737db546f4f5" class="k">var</a> <span id="r790 rd" class="r790 r">funcBodyExp</span> = <b>new</b> <a href="#dd24d41ff02dddc5" class="t constructor">ScriptBlockExpressionAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r788 r">funcBody</span>);
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;Construct Set-Item pipeline&quot;
 
            <span class="c">// **************************</span>
            <span class="c">// Now construct the AST to call the set-item cmdlet that will create the function</span>
            <span class="c">// it will do set-item -Path function:\ConfigurationNameExpr -Value funcBody</span>
 
            <span class="c">// create function:\confignameexpression</span>
            <a href="#e18e1bad255cd022" class="k">var</a> <span id="r791 rd" class="r791 r">funcDriveStrExpr</span> = <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="s">@&quot;function:\&quot;</span>,
                                                                   <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>);
            <a href="#f3e3848ef2eae593" class="k">var</a> <span id="r792 rd" class="r792 r">funcPathStrExpr</span> = <b>new</b> <a href="#285ee0c928c6e703" class="t constructor">BinaryExpressionAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r791 r">funcDriveStrExpr</span>,
                                                          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28a6ab38fe6894ea" class="i field">Plus</a>,
                                                          (<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>)<a href="#5378ed44edf4cc30" class="i property">InstanceName</a>.<a href="#7559dca1878820e8" class="i method">Copy</a>(),
                                                          <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>);
 
            <b>var</b> <span id="r793 rd" class="r793 r">setItemCmdElements</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt;
            {
                <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="s">@&quot;set-item&quot;</span>,
                                                <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>),
                <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="s">&quot;Path&quot;</span>,
                                        <span class="r792 r">funcPathStrExpr</span>,
                                        <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>),
                <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="s">&quot;Value&quot;</span>, <span class="r790 r">funcBodyExp</span>,
                                        <a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>)
            };
 
            <span class="c">// then the configuration scriptblock as function body</span>
 
            <a href="#a310aaa1e0374ddd" class="k">var</a> <span id="r794 rd" class="r794 r">setItemCmdlet</span> = <b>new</b> <span class="t">CommandAst</span>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r793 r">setItemCmdElements</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>, <b>null</b>);
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <a href="#785915ec8547ce9f" class="k">var</a> <span id="r795 rd" class="r795 r">returnPipelineAst</span> = <b>new</b> <a href="#208c7297a3426413" class="t constructor">PipelineAst</a>(<a href="#d0b13bd03366725b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r794 r">setItemCmdlet</span>, <span class="r683 r">background</span>: <b>false</b>);
 
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r795 r">returnPipelineAst</span>);
 
            <b>return</b> <span class="r795 r">returnPipelineAst</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> static fields/methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r796 r">stmt</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r797 r">resourceModulePairsToImport</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Item1 - ResourceName, Item2 - ModuleName, Item3 - ModuleVersion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="89fe947c7afee11a" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsImportCommand</a>(<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r796 rd" class="r796 r">stmt</span>, <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<b>string</b>[], <a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[], <span class="i">Version</span>&gt;&gt; <span id="r797 rd" class="r797 r">resourceModulePairsToImport</span>)
        {
            <a href="#2c7580ec5eda8932" class="k">var</a> <span id="r798 rd" class="r798 r">dkwsAst</span> = <span class="r796 r">stmt</span> <b>as</b> <a href="#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>;
            <b>if</b> (<span class="r798 r">dkwsAst</span> == <b>null</b> || !<span class="r798 r">dkwsAst</span>.<a href="#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#b4378cc74685de63" class="i property">Keyword</a>.<span class="i">Equals</span>(<span class="s">&quot;Import-DscResource&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="#a310aaa1e0374ddd" class="k">var</a> <span id="r799 rd" class="r799 r">commandAst</span> = <b>new</b> <span class="t">CommandAst</span>(<span class="r798 r">dkwsAst</span>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="i">CopyElements</span>(<span class="r798 r">dkwsAst</span>.<a href="#783dff95585ad1fe" class="i property">CommandElements</a>), <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>, <b>null</b>);
 
            <a href="../CommandCompletion/PseudoParameterBinder.cs.html#cae64ef619e0a99a" class="t t">StaticBindingResult</a> <span id="r800 rd" class="r800 r">bindingResult</span> = <a href="../CommandCompletion/PseudoParameterBinder.cs.html#b6eface4652c31d3" class="t t">StaticParameterBinder</a>.<a href="../CommandCompletion/PseudoParameterBinder.cs.html#d2b93539d7859acd" class="i method">BindCommand</a>(<span class="r799 r">commandAst</span>, <b>false</b>);
            <a href="../CommandCompletion/PseudoParameterBinder.cs.html#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r801 rd" class="r801 r">moduleNames</span> = <b>null</b>;
            <a href="../CommandCompletion/PseudoParameterBinder.cs.html#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r802 rd" class="r802 r">resourceNames</span> = <b>null</b>;
            <a href="../CommandCompletion/PseudoParameterBinder.cs.html#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r803 rd" class="r803 r">moduleVersion</span> = <b>null</b>;
            <b>const string</b> <span id="r804 rd" class="r804 r">nameParam</span> = <span class="s">&quot;Name&quot;</span>;
            <b>const string</b> <span id="r805 rd" class="r805 r">moduleNameParam</span> = <span class="s">&quot;ModuleName&quot;</span>;
            <b>const string</b> <span id="r806 rd" class="r806 r">moduleVersionParam</span> = <span class="s">&quot;ModuleVersion&quot;</span>;
 
            <span class="c">// we are only interested in Name and ModuleName parameter</span>
            <b>foreach</b> (<b>var</b> <span id="r807 rd" class="r807 r">entry</span> <b>in</b> <span class="r800 r">bindingResult</span>.<a href="../CommandCompletion/PseudoParameterBinder.cs.html#e54921e80ff4b0b1" class="i property">BoundParameters</a>)
            {
                <b>string</b> <span id="r808 rd" class="r808 r">paramName</span> = <span class="r807 r">entry</span>.<span class="i">Key</span>;
                <b>var</b> <span id="r809 rd" class="r809 r">paramValue</span> = <span class="r807 r">entry</span>.<span class="i">Value</span>;
 
                <b>if</b> ((<span class="r808 r">paramName</span>.<span class="i">Length</span> &lt;= <span class="r804 r">nameParam</span>.<span class="i">Length</span>) &amp;&amp; (<span class="r808 r">paramName</span>.<span class="i">AsSpan</span>().<span class="i">Equals</span>(<span class="r804 r">nameParam</span>.<span class="i">AsSpan</span>(0, <span class="r808 r">paramName</span>.<span class="i">Length</span>), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <span class="r802 r">resourceNames</span> = <span class="r809 r">paramValue</span>;
                }
                <span class="c">// Since both parameters -ModuleName and -ModuleVersion has same start string i.e. Module so we will try to resolve it to -ModuleName</span>
                <span class="c">// if user specifies like -Module</span>
                <b>if</b> ((<span class="r808 r">paramName</span>.<span class="i">Length</span> &lt;= <span class="r805 r">moduleNameParam</span>.<span class="i">Length</span>) &amp;&amp; (<span class="r808 r">paramName</span>.<span class="i">AsSpan</span>().<span class="i">Equals</span>(<span class="r805 r">moduleNameParam</span>.<span class="i">AsSpan</span>(0, <span class="r808 r">paramName</span>.<span class="i">Length</span>), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <span class="r801 r">moduleNames</span> = <span class="r809 r">paramValue</span>;
                }
                <b>else</b> <b>if</b> ((<span class="r808 r">paramName</span>.<span class="i">Length</span> &lt;= <span class="r806 r">moduleVersionParam</span>.<span class="i">Length</span>) &amp;&amp; (<span class="r808 r">paramName</span>.<span class="i">AsSpan</span>().<span class="i">Equals</span>(<span class="r806 r">moduleVersionParam</span>.<span class="i">AsSpan</span>(0, <span class="r808 r">paramName</span>.<span class="i">Length</span>), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <span class="r803 r">moduleVersion</span> = <span class="r809 r">paramValue</span>;
                }
            }
 
            <b>string</b>[] <span id="r810 rd" class="r810 r">resourceNamesTyped</span> = <b>new</b>[] { <span class="s">&quot;*&quot;</span> };
            <a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[] <span id="r811 rd" class="r811 r">moduleNamesTyped</span> = <b>null</b>;
            <span class="i">Version</span> <span id="r812 rd" class="r812 r">moduleVersionTyped</span> = <b>null</b>;
 
            <b>if</b> (<span class="r802 r">resourceNames</span> != <b>null</b>)
            {
                <b>object</b> <span id="r813 rd" class="r813 r">resourceNameEvaluated</span>;
                <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r802 r">resourceNames</span>.<a href="../CommandCompletion/PseudoParameterBinder.cs.html#2eb0a9f4c6d73128" class="i property">Value</a>, <b>out</b> <span class="r813 r">resourceNameEvaluated</span>, <b>true</b>, <b>true</b>);
                <span class="r810 r">resourceNamesTyped</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<b>string</b>[]&gt;(<span class="r813 r">resourceNameEvaluated</span>);
            }
 
            <b>if</b> (<span class="r801 r">moduleNames</span> != <b>null</b>)
            {
                <b>object</b> <span id="r814 rd" class="r814 r">moduleNameEvaluated</span>;
                <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r801 r">moduleNames</span>.<a href="../CommandCompletion/PseudoParameterBinder.cs.html#2eb0a9f4c6d73128" class="i property">Value</a>, <b>out</b> <span class="r814 r">moduleNameEvaluated</span>, <b>true</b>, <b>true</b>);
                <span class="r811 r">moduleNamesTyped</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[]&gt;(<span class="r814 r">moduleNameEvaluated</span>);
            }
 
            <b>if</b> (<span class="r803 r">moduleVersion</span> != <b>null</b>)
            {
                <b>object</b> <span id="r815 rd" class="r815 r">moduleVersionEvaluated</span>;
                <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r803 r">moduleVersion</span>.<a href="../CommandCompletion/PseudoParameterBinder.cs.html#2eb0a9f4c6d73128" class="i property">Value</a>, <b>out</b> <span class="r815 r">moduleVersionEvaluated</span>, <b>true</b>, <b>true</b>);
                <b>if</b> (<span class="r815 r">moduleVersionEvaluated</span> <b>is double</b>)
                {
                    <span class="c">// this happens in case -ModuleVersion 1.0, then use extent text for that.</span>
                    <span class="c">// The better way to do it would be define static binding API against CommandInfo, that holds information about parameter types.</span>
                    <span class="c">// This way, we can avoid this ugly special-casing and say that -ModuleVersion has type [System.Version].</span>
                    <span class="r815 r">moduleVersionEvaluated</span> = <span class="r803 r">moduleVersion</span>.<a href="../CommandCompletion/PseudoParameterBinder.cs.html#2eb0a9f4c6d73128" class="i property">Value</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
                }
 
                <span class="r812 r">moduleVersionTyped</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<span class="i">Version</span>&gt;(<span class="r815 r">moduleVersionEvaluated</span>);
 
                <span class="c">// Use -ModuleVersion &lt;Version&gt; only in the case, if -ModuleName specified.</span>
                <span class="c">// Override ModuleName versions.</span>
                <b>if</b> (<span class="r811 r">moduleNamesTyped</span> != <b>null</b> &amp;&amp; <span class="r811 r">moduleNamesTyped</span>.<span class="i">Length</span> == 1)
                {
                    <b>for</b> (<b>int</b> <span id="r816 rd" class="r816 r">i</span> = 0; <span class="r816 r">i</span> &lt; <span class="r811 r">moduleNamesTyped</span>.<span class="i">Length</span>; <span class="r816 r">i</span>++)
                    {
                        <span class="r811 r">moduleNamesTyped</span>[<span class="r816 r">i</span>] = <b>new</b> <a href="../Modules/ModuleSpecification.cs.html#e40ff4979fd4b540" class="t constructor">ModuleSpecification</a>(<b>new</b> <span class="i">Hashtable</span>()
                        {
                            {<span class="s">&quot;ModuleName&quot;</span>, <span class="r811 r">moduleNamesTyped</span>[<span class="r816 r">i</span>].<a href="../Modules/ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>},
                            {<span class="s">&quot;ModuleVersion&quot;</span>, <span class="r812 r">moduleVersionTyped</span>}
                        });
                    }
                }
            }
 
            <span class="r797 r">resourceModulePairsToImport</span>.<span class="i">Add</span>(<b>new</b> <span class="i">Tuple</span>&lt;<b>string</b>[], <a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[], <span class="i">Version</span>&gt;(<span class="r810 r">resourceNamesTyped</span>, <span class="r811 r">moduleNamesTyped</span>, <span class="r812 r">moduleVersionTyped</span>));
            <b>return</b> <b>true</b>;
        }
 
        <b>private const string</b> <a id="92f7cd9010fe1896" href="../../R/92f7cd9010fe1896.html" target="n" data-glyph="10,1" class="i field">ConfigurationBuildInParametersStr</a> = <span class="s">@&quot;
                        [cmdletbinding()]
                        param(
                            [string]
                                $InstanceName,
                            [string[]]
                                $DependsOn,
                            [PSCredential]
                                $PsDscRunAsCredential,
                            [string]
                                $OutputPath,
                            [hashtable]
                            [Microsoft.PowerShell.DesiredStateConfiguration.ArgumentToConfigurationDataTransformation()]
                               $ConfigurationData
                        )&quot;</span>;
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="389e07a75f191719" href="../../R/389e07a75f191719.html" target="n" data-glyph="106,1" class="i property">ConfigurationBuildInParameters</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#0410eb7a45211f61" class="i field">s_configurationBuildInParameters</a> == <b>null</b>)
                {
                    <a href="#0410eb7a45211f61" class="i field">s_configurationBuildInParameters</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;();
 
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r817 rd" class="r817 r">tokens</span>;
                    <a href="Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r818 rd" class="r818 r">errors</span>;
                    <a href="#6f963589327835a4" class="k">var</a> <span id="r819 rd" class="r819 r">sba</span> = <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="Parser.cs.html#8c264bb718ff180a" class="i method">ParseInput</a>(<a href="#92f7cd9010fe1896" class="i field">ConfigurationBuildInParametersStr</a>, <b>out</b> <span class="r817 r">tokens</span>, <b>out</b> <span class="r818 r">errors</span>);
                    <b>if</b> (<span class="r819 r">sba</span> != <b>null</b>)
                    {
                        <b>foreach</b> (<b>var</b> <span id="r820 rd" class="r820 r">parameterAst</span> <b>in</b> <span class="r819 r">sba</span>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>)
                        {
                            <a href="#0410eb7a45211f61" class="i field">s_configurationBuildInParameters</a>.<span class="i">Add</span>((<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>)<span class="r820 r">parameterAst</span>.<span class="i">Copy</span>());
                        }
                    }
                }
 
                <b>return</b> <a href="#0410eb7a45211f61" class="i field">s_configurationBuildInParameters</a>;
            }
        }
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="0410eb7a45211f61" href="../../R/0410eb7a45211f61.html" target="n" data-glyph="46,1" class="i field">s_configurationBuildInParameters</a>;
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="77ca5baf5e7b798e" href="../../R/77ca5baf5e7b798e.html" target="n" data-glyph="106,1" class="i property">ConfigurationBuildInParameterAttribAsts</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#18113ebdd1276640" class="i field">s_configurationBuildInParameterAttrAsts</a> == <b>null</b>)
                {
                    <a href="#18113ebdd1276640" class="i field">s_configurationBuildInParameterAttrAsts</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
 
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r821 rd" class="r821 r">tokens</span>;
                    <a href="Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r822 rd" class="r822 r">errors</span>;
                    <a href="#6f963589327835a4" class="k">var</a> <span id="r823 rd" class="r823 r">sba</span> = <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="Parser.cs.html#8c264bb718ff180a" class="i method">ParseInput</a>(<a href="#92f7cd9010fe1896" class="i field">ConfigurationBuildInParametersStr</a>, <b>out</b> <span class="r821 r">tokens</span>, <b>out</b> <span class="r822 r">errors</span>);
                    <b>if</b> (<span class="r823 r">sba</span> != <b>null</b>)
                    {
                        <b>if</b> (<a href="#0410eb7a45211f61" class="i field">s_configurationBuildInParameters</a> == <b>null</b>)
                        {
                            <a href="#0410eb7a45211f61" class="i field">s_configurationBuildInParameters</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;();
 
                            <b>foreach</b> (<b>var</b> <span id="r824 rd" class="r824 r">parameterAst</span> <b>in</b> <span class="r823 r">sba</span>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#ffac8f01ede94077" class="i property">Parameters</a>)
                            {
                                <a href="#0410eb7a45211f61" class="i field">s_configurationBuildInParameters</a>.<span class="i">Add</span>((<a href="#bf2a2797225b11b5" class="t t">ParameterAst</a>)<span class="r824 r">parameterAst</span>.<span class="i">Copy</span>());
                            }
                        }
 
                        <b>foreach</b> (<b>var</b> <span id="r825 rd" class="r825 r">attribAst</span> <b>in</b> <span class="r823 r">sba</span>.<a href="#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="#2f9e902bfe8c2c10" class="i property">Attributes</a>)
                        {
                            <a href="#18113ebdd1276640" class="i field">s_configurationBuildInParameterAttrAsts</a>.<span class="i">Add</span>((<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>)<span class="r825 r">attribAst</span>.<span class="i">Copy</span>());
                        }
                    }
                }
 
                <b>return</b> <a href="#18113ebdd1276640" class="i field">s_configurationBuildInParameterAttrAsts</a>;
            }
        }
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <a id="18113ebdd1276640" href="../../R/18113ebdd1276640.html" target="n" data-glyph="46,1" class="i field">s_configurationBuildInParameterAttrAsts</a>;
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <a id="1e4f907d14a48281" href="../../R/1e4f907d14a48281.html" target="n" data-glyph="106,1" class="i property">ConfigurationExtraParameterStatements</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#386bcf1eef0a16b9" class="i field">s_configurationExtraParameterStatements</a> == <b>null</b>)
                {
                    <a href="#386bcf1eef0a16b9" class="i field">s_configurationExtraParameterStatements</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;();
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r826 rd" class="r826 r">tokens</span>;
                    <a href="Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r827 rd" class="r827 r">errors</span>;
                    <a href="#6f963589327835a4" class="k">var</a> <span id="r828 rd" class="r828 r">sba</span> = <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="Parser.cs.html#8c264bb718ff180a" class="i method">ParseInput</a>(<span class="s">@&quot;
                        Import-Module Microsoft.PowerShell.Management -Verbose:$false
                        Import-Module PSDesiredStateConfiguration -Verbose:$false
                        $toBody = @{}+$PSBoundParameters
                        $toBody.Remove(&quot;&quot;OutputPath&quot;&quot;)
                        $toBody.Remove(&quot;&quot;ConfigurationData&quot;&quot;)
                        $ConfigurationData = $psboundparameters[&quot;&quot;ConfigurationData&quot;&quot;]
                        $Outputpath = $psboundparameters[&quot;&quot;Outputpath&quot;&quot;]&quot;</span>, <b>out</b> <span class="r826 r">tokens</span>, <b>out</b> <span class="r827 r">errors</span>);
                    <b>if</b> (<span class="r828 r">sba</span> != <b>null</b>)
                    {
                        <b>foreach</b> (<b>var</b> <span id="r829 rd" class="r829 r">statementAst</span> <b>in</b> <span class="r828 r">sba</span>.<a href="#958e631868900aba" class="i property">EndBlock</a>.<a href="#496f71fcd5c4e6a1" class="i property">Statements</a>)
                        {
                            <a href="#386bcf1eef0a16b9" class="i field">s_configurationExtraParameterStatements</a>.<span class="i">Add</span>((<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>)<span class="r829 r">statementAst</span>.<span class="i">Copy</span>());
                        }
                    }
                }
 
                <b>return</b> <a href="#386bcf1eef0a16b9" class="i field">s_configurationExtraParameterStatements</a>;
            }
        }
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <a id="386bcf1eef0a16b9" href="../../R/386bcf1eef0a16b9.html" target="n" data-glyph="46,1" class="i field">s_configurationExtraParameterStatements</a>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast represents the DynamicKeyword statement.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="2c7580ec5eda8932" href="../../R/2c7580ec5eda8932.html" target="n" data-glyph="0,0" class="t t">DynamicKeywordStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a DynamicKeyword statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r830 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the attribute and ending after the expression being attributed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r831 r">commandElements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A collection of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#22790ae48f5438c6" class="t t">CommandElementAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> used to invoke </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> specific command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r831 r">commandElements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="b5dc863e9504b200" href="../../R/b5dc863e9504b200.html" target="n" data-glyph="72,1" class="t constructor">DynamicKeywordStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r830 rd" class="r830 r">extent</span>,
            <span class="i">IEnumerable</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <span id="r831 rd" class="r831 r">commandElements</span>) : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r830 r">extent</span>)
        {
            <b>if</b> (<span class="r831 r">commandElements</span> == <b>null</b> || !<span class="r831 r">commandElements</span>.<span class="i">Any</span>())
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r831 r">commandElements</span>));
            }
 
            <a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#783dff95585ad1fe" class="i property">CommandElements</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt;(<span class="r831 r">commandElements</span>.<span class="i">ToArray</span>());
            <span class="i">SetParents</span>(<a href="#783dff95585ad1fe" class="i property">CommandElements</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A non-empty collection of command elements represent the content of the</span>
        <span class="c">///</span><span class="c"> DynamicKeyword.</span>
        <span class="c">///</span><span class="c"> It may represents a command, such as “Import-DSCResource”,</span>
        <span class="c">///</span><span class="c"> or DSC resources, then CommandElements includes:</span>
        <span class="c">///</span><span class="c">   (1) Keyword Name</span>
        <span class="c">///</span><span class="c">   (2) InstanceName</span>
        <span class="c">///</span><span class="c">   (3) Body, could be ScriptBlockExpressionAst (for Node keyword) or a HashtableAst (remaining)</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This property is never null and never empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <a id="783dff95585ad1fe" href="../../R/783dff95585ad1fe.html" target="n" data-glyph="102,1" class="i property">CommandElements</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Duplicates the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, allowing it to be composed into other ASTs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A copy of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, with the link to the previous parent removed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="a170ad546c9d81e2" href="../../R/a170ad546c9d81e2.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <span class="i">IEnumerable</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <span id="r832 rd" class="r832 r">commandElements</span> = <span class="i">CopyElements</span>(<a href="#783dff95585ad1fe" class="i property">CommandElements</a>);
            <b>return</b> <b>new</b> <a href="#b5dc863e9504b200" class="t constructor">DynamicKeywordStatementAst</a>(<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r832 r">commandElements</span>)
            {
                <a href="#0f0688a599c6de89" class="i property">Keyword</a> = <a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#0f0688a599c6de89" class="i property">Keyword</a>,
                <a href="#4849619dbe3369d5" class="i property">LCurly</a> = <a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#4849619dbe3369d5" class="i property">LCurly</a>,
                <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a> = <a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>,
                <a href="#42254f2c9f80529f" class="i property">InstanceName</a> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#42254f2c9f80529f" class="i property">InstanceName</a>),
                <a href="#1c0c55ce1a10bab9" class="i property">OriginalInstanceName</a> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#1c0c55ce1a10bab9" class="i property">OriginalInstanceName</a>),
                <a href="#f158e061c28b7505" class="i property">BodyExpression</a> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#f158e061c28b7505" class="i property">BodyExpression</a>),
                <a href="#3ad30598f32e7b03" class="i property">ElementName</a> = <a href="#2c7580ec5eda8932" class="k">this</a>.<a href="#3ad30598f32e7b03" class="i property">ElementName</a>,
            };
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="143689b961f51565" href="../../R/143689b961f51565.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r833 rd" class="r833 r">visitor</span>)
        {
            <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="k">var</a> <span id="r834 rd" class="r834 r">visitor2</span> = <span class="r833 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>;
            <b>return</b> <span class="r834 r">visitor2</span>?.<a href="AstVisitor.cs.html#4fa494ee5b9b8fab" class="i method">VisitDynamicKeywordStatement</a>(<a href="#2c7580ec5eda8932" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="767065750b654d8a" href="../../R/767065750b654d8a.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r835 rd" class="r835 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r836 rd" class="r836 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r837 rd" class="r837 r">visitor2</span> = <span class="r835 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r837 r">visitor2</span> != <b>null</b>)
            {
                <span class="r836 r">action</span> = <span class="r837 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#91de68689e857640" class="i method">VisitDynamicKeywordStatement</a>(<a href="#2c7580ec5eda8932" class="k">this</a>);
                <b>if</b> (<span class="r836 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                    <b>return</b> <span class="r835 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#2c7580ec5eda8932" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            }
 
            <b>if</b> (<span class="r836 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>foreach</b> (<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r838 rd" class="r838 r">elementAst</span> <b>in</b> <a href="#783dff95585ad1fe" class="i property">CommandElements</a>)
                {
                    <span class="r836 r">action</span> = <span class="r838 r">elementAst</span>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r835 r">visitor</span>);
                    <b>if</b> (<span class="r836 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                        <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r835 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#2c7580ec5eda8932" class="k">this</a>, <span class="r836 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Properties/Methods
 
        <b>internal</b> <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <a id="0f0688a599c6de89" href="../../R/0f0688a599c6de89.html" target="n" data-glyph="104,1" class="i property">Keyword</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#edad18475e3899f5" class="i field">_keyword</a>;
            }
 
            <b>set</b>
            {
                <a href="#edad18475e3899f5" class="i field">_keyword</a> = <b>value</b>.<a href="tokenizer.cs.html#652cf530ee20518f" class="i method">Copy</a>();
            }
        }
 
        <b>private</b> <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <a id="edad18475e3899f5" href="../../R/edad18475e3899f5.html" target="n" data-glyph="46,1" class="i field">_keyword</a>;
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="4849619dbe3369d5" href="../../R/4849619dbe3369d5.html" target="n" data-glyph="104,1" class="i property">LCurly</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="914807ae6c6aa6f9" href="../../R/914807ae6c6aa6f9.html" target="n" data-glyph="104,1" class="i property">FunctionName</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="42254f2c9f80529f" href="../../R/42254f2c9f80529f.html" target="n" data-glyph="104,1" class="i property">InstanceName</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="1c0c55ce1a10bab9" href="../../R/1c0c55ce1a10bab9.html" target="n" data-glyph="104,1" class="i property">OriginalInstanceName</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="f158e061c28b7505" href="../../R/f158e061c28b7505.html" target="n" data-glyph="104,1" class="i property">BodyExpression</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal string</b> <a id="3ad30598f32e7b03" href="../../R/3ad30598f32e7b03.html" target="n" data-glyph="104,1" class="i property">ElementName</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a> <a id="37f0608c1bba8f19" href="../../R/37f0608c1bba8f19.html" target="n" data-glyph="46,1" class="i field">_commandCallPipelineAst</a>;
 
        <b>internal</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a> <a id="a2a95b69bc885ea0" href="../../R/a2a95b69bc885ea0.html" target="n" data-glyph="74,1" class="i method">GenerateCommandCallPipelineAst</a>()
        {
            <b>if</b> (<a href="#37f0608c1bba8f19" class="i field">_commandCallPipelineAst</a> != <b>null</b>)
                <b>return</b> <a href="#37f0608c1bba8f19" class="i field">_commandCallPipelineAst</a>;
 
            <span class="c">/////////////////////////////////////////////////////////////////////////</span>
            <span class="c">//</span>
            <span class="c">// Now construct the AST to call the function that defines implements the keywords logic. There are</span>
            <span class="c">// two different types of ASTs that may be generated, depending on the settings in the DynamicKeyword object.</span>
            <span class="c">// The first type uses a fixed set of 4 arguments and has the command with the signature</span>
            <span class="c">//  function moduleName\keyword</span>
            <span class="c">//  {</span>
            <span class="c">//      param (</span>
            <span class="c">//          $KeywordData,       # the DynamicKeyword object processed by this rule.</span>
            <span class="c">//          $Name,              # the value of the name expression syntax element. This may be null for keywords that don&#39;t take a name</span>
            <span class="c">//          $Value,             # the body of the keyword - either a hashtable or a scriptblock</span>
            <span class="c">//          $SourceMetadata     # a string containing the original source line information so that errors</span>
            <span class="c">//      )</span>
            <span class="c">//      # function logic...</span>
            <span class="c">//  }</span>
            <span class="c">//</span>
            <span class="c">// The second type, where the DirectCall flag is set to true, simply calls the command directly.</span>
            <span class="c">// In the original source, the keyword body will be a property collection where the allowed properties</span>
            <span class="c">// in the collection correspond to the parameters on the actual called function.</span>
            <span class="c">//</span>
            <b>var</b> <span id="r839 rd" class="r839 r">cea</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt;();
 
            <span class="c">//</span>
            <span class="c">// First add the name of the command to call. If a module name has been provided</span>
            <span class="c">// then use the module-qualified form of the command name..</span>
            <span class="c">//</span>
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#9757f90b46da4d4e" class="i property">ImplementingModule</a>))
            {
                <span class="r839 r">cea</span>.<span class="i">Add</span>(
                    <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(
                        <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>,
                        <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>));
            }
            <b>else</b>
            {
                <span class="r839 r">cea</span>.<span class="i">Add</span>(
                    <b>new</b> <span class="t">StringConstantExpressionAst</span>(
                        <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <a href="#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#9757f90b46da4d4e" class="i property">ImplementingModule</a> + <span class="s">&#39;\\&#39;</span> + <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>,
                        <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>));
            }
 
            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r840 rd" class="r840 r">expr</span> = <a href="#f158e061c28b7505" class="i property">BodyExpression</a>;
            <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r841 rd" class="r841 r">hashtable</span> = <span class="r840 r">expr</span> <b>as</b> <a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a>;
            <b>if</b> (<a href="#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#b4ebddb633c81f5b" class="i property">DirectCall</a>)
            {
                <span class="c">// If this keyword takes a name, then add it as the parameter -InstanceName</span>
                <b>if</b> (<a href="#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> != <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f4392d4c8185a4f0" class="i field">NoName</a>)
                {
                    <span class="r839 r">cea</span>.<span class="i">Add</span>(
                        <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(
                            <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <span class="s">&quot;InstanceName&quot;</span>,
                            <a href="#42254f2c9f80529f" class="i property">InstanceName</a>,
                            <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
                }
 
                <span class="c">//</span>
                <span class="c">// If it&#39;s a direct call keyword, then we just unravel the properties</span>
                <span class="c">// in the hash literal expression and map them to parameters.</span>
                <span class="c">// We&#39;ve already checked to make sure that they&#39;re all valid names.</span>
                <span class="c">//</span>
                <b>if</b> (<span class="r841 r">hashtable</span> != <b>null</b>)
                {
                    <b>bool</b> <span id="r842 rd" class="r842 r">isHashtableValid</span> = <b>true</b>;
                    <span class="c">//</span>
                    <span class="c">// If it&#39;s a hash table, validate that only valid members have been specified.</span>
                    <span class="c">//</span>
                    <b>foreach</b> (<b>var</b> <span id="r843 rd" class="r843 r">keyValueTuple</span> <b>in</b> <span class="r841 r">hashtable</span>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>)
                    {
                        <a href="#e18e1bad255cd022" class="k">var</a> <span id="r844 rd" class="r844 r">propName</span> = <span class="r843 r">keyValueTuple</span>.<span class="i">Item1</span> <b>as</b> <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                        <b>if</b> (<span class="r844 r">propName</span> == <b>null</b>)
                        {
                            <span class="r842 r">isHashtableValid</span> = <b>false</b>;
                            <b>break</b>;
                        }
                        <b>else</b>
                        {
                            <b>if</b> (!<a href="#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#5381d21bcf0af976" class="i property">Properties</a>.<span class="i">ContainsKey</span>(<span class="r844 r">propName</span>.<a href="#a6dc72732a1c7e0d" class="i property">Value</a>))
                            {
                                <span class="r842 r">isHashtableValid</span> = <b>false</b>;
                                <b>break</b>;
                            }
                        }
 
                        <b>if</b> (<span class="r843 r">keyValueTuple</span>.<span class="i">Item2</span> <b>is</b> <a href="#e02a155b7afded8b" class="t t">ErrorStatementAst</a>)
                        {
                            <span class="r842 r">isHashtableValid</span> = <b>false</b>;
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r842 r">isHashtableValid</span>)
                    {
                        <span class="c">// Construct the real parameters if Hashtable is valid</span>
                        <b>foreach</b> (<b>var</b> <span id="r845 rd" class="r845 r">keyValueTuple</span> <b>in</b> <span class="r841 r">hashtable</span>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>)
                        {
                            <a href="#e18e1bad255cd022" class="k">var</a> <span id="r846 rd" class="r846 r">propName</span> = (<a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r845 r">keyValueTuple</span>.<span class="i">Item1</span>;
                            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r847 rd" class="r847 r">propValue</span> = <b>new</b> <a href="#ee5a380f086fe18d" class="t constructor">SubExpressionAst</a>(
                                <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>new</b> <span class="t">StatementBlockAst</span>(
                                    <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                    <b>new</b> <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>[] { (<a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>)<span class="r845 r">keyValueTuple</span>.<span class="i">Item2</span>.<span class="i">Copy</span>() }, <b>null</b>));
 
                            <span class="r839 r">cea</span>.<span class="i">Add</span>(
                                <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(
                                    <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                    <span class="r846 r">propName</span>.<a href="#a6dc72732a1c7e0d" class="i property">Value</a>,
                                    <span class="r847 r">propValue</span>,
                                    <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// Construct a fake parameter with the HashtableAst to be its value, so that</span>
                        <span class="c">// tab completion on the property names would work.</span>
                        <span class="r839 r">cea</span>.<span class="i">Add</span>(
                            <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(
                                <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <span class="s">&quot;InvalidPropertyHashtable&quot;</span>,
                                <span class="r841 r">hashtable</span>,
                                <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
                    }
                }
            }
            <b>else</b>
            {
                <span class="c">//</span>
                <span class="c">// Add the -KeywordData parameter using the expression</span>
                <span class="c">//  ([type](&quot;System.Management.Automation.Language.DynamicKeyword&quot;))::GetKeyword(name)</span>
                <span class="c">// To invoke the method to get the keyword data object for that keyword.</span>
                <span class="c">//</span>
                <a href="#be11dcb1e53f56b8" class="k">var</a> <span id="r848 rd" class="r848 r">indexExpr</span> = <b>new</b> <span class="t">InvokeMemberExpressionAst</span>(
                    <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>new</b> <a href="#ead902e37b5f71c3" class="t constructor">TypeExpressionAst</a>(
                        <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>new</b> <span class="t">TypeName</span>(
                            <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>typeof</b>(<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>).<span class="i">FullName</span>)),
                    <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(
                        <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <span class="s">&quot;GetKeyword&quot;</span>,
                        <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>),
                    <b>new</b> <span class="i">List</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;
                        {
                            <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(
                                <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>,
                                <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>)
                        },
                    <b>true</b>);
 
                <span class="r839 r">cea</span>.<span class="i">Add</span>(
                    <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(
                        <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <span class="s">&quot;KeywordData&quot;</span>,
                        <span class="r848 r">indexExpr</span>,
                        <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
 
                <span class="c">//</span>
                <span class="c">// Add the -Name parameter</span>
                <span class="c">//</span>
                <span class="r839 r">cea</span>.<span class="i">Add</span>(
                    <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(
                        <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <span class="s">&quot;Name&quot;</span>,
                        <a href="#42254f2c9f80529f" class="i property">InstanceName</a>,
                        <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
 
                <span class="c">//</span>
                <span class="c">// Add the -Value parameter</span>
                <span class="c">//</span>
                <span class="r839 r">cea</span>.<span class="i">Add</span>(
                    <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(
                        <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <span class="s">&quot;Value&quot;</span>,
                        <span class="r840 r">expr</span>,
                        <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
 
                <span class="c">//</span>
                <span class="c">// Add the -SourceMetadata parameter</span>
                <span class="c">//</span>
                <b>string</b> <span id="r849 rd" class="r849 r">sourceMetadata</span> = <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>
                                        + <span class="s">&quot;::&quot;</span> + <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a>
                                        + <span class="s">&quot;::&quot;</span> + <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>
                                        + <span class="s">&quot;::&quot;</span> + <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
                <span class="r839 r">cea</span>.<span class="i">Add</span>(
                    <b>new</b> <a href="#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(
                        <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;SourceMetadata&quot;</span>,
                        <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(
                            <a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <span class="r849 r">sourceMetadata</span>,
                            <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>),
                        <a href="#4849619dbe3369d5" class="i property">LCurly</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
            }
 
            <span class="c">//</span>
            <span class="c">// Build the final statement - a pipeline containing a single element with is a CommandAst</span>
            <span class="c">// containing the command we&#39;ve built up.</span>
            <span class="c">//</span>
            <a href="#a310aaa1e0374ddd" class="k">var</a> <span id="r850 rd" class="r850 r">cmdAst</span> = <b>new</b> <span class="t">CommandAst</span>(<a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r839 r">cea</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>, <b>null</b>);
            <span class="r850 r">cmdAst</span>.<a href="#38c09f0576bc413e" class="i property">DefiningKeyword</a> = <a href="#0f0688a599c6de89" class="i property">Keyword</a>;
            <a href="#37f0608c1bba8f19" class="i field">_commandCallPipelineAst</a> = <b>new</b> <a href="#208c7297a3426413" class="t constructor">PipelineAst</a>(<a href="#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r850 r">cmdAst</span>, <span class="r683 r">background</span>: <b>false</b>);
            <b>return</b> <a href="#37f0608c1bba8f19" class="i field">_commandCallPipelineAst</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Statements
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Expressions
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An abstract base class that represents all PowerShell expressions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="78a833319fe635b4" href="../../R/78a833319fe635b4.html" target="n" data-glyph="0,0" class="t t">ExpressionAst</a> : <a href="#22790ae48f5438c6" class="t t">CommandElementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the fields common to all expressions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r851 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r851 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <a id="29919c675f78fdb0" href="../../R/29919c675f78fdb0.html" target="n" data-glyph="75,1" class="t constructor">ExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r851 rd" class="r851 r">extent</span>)
            : <a href="#ece7ecc8f9bc663a" class="k">base</a>(<span class="r851 r">extent</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> By default, the static type of an expression is unknown and hence we assume </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(object)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">Type</span> <a id="966dd684e99eeda0" href="../../R/966dd684e99eeda0.html" target="n" data-glyph="102,1" class="i property">StaticType</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<b>object</b>); } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determine if the results of ParenExpression/SubExpression should be preserved in case of exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> We should preserve the partial output in case of exception only if the SubExpression/ParenExpression meets following conditions:</span>
        <span class="c">///</span><span class="c">  1. the SubExpr/ParenExpr is the first expression, and the only element in a pipeline</span>
        <span class="c">///</span><span class="c">  2. the pipeline&#39;s parent is a StatementBlockAst or NamedBlockAst. e.g. $(1; throw 2) OR if (true) { $(1; throw 2) }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="9735bf42b0a863cd" href="../../R/9735bf42b0a863cd.html" target="n" data-glyph="74,1" class="i method">ShouldPreserveOutputInCaseOfException</a>()
        {
            <a href="#a9797c05604b61e8" class="k">var</a> <span id="r852 rd" class="r852 r">parenExpr</span> = <a href="#78a833319fe635b4" class="k">this</a> <b>as</b> <a href="#a9797c05604b61e8" class="t t">ParenExpressionAst</a>;
            <a href="#e6552a77ab32112a" class="k">var</a> <span id="r853 rd" class="r853 r">subExpr</span> = <a href="#78a833319fe635b4" class="k">this</a> <b>as</b> <a href="#e6552a77ab32112a" class="t t">SubExpressionAst</a>;
 
            <b>if</b> (<span class="r852 r">parenExpr</span> == <b>null</b> &amp;&amp; <span class="r853 r">subExpr</span> == <b>null</b>)
            {
                <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
            }
 
            <b>if</b> (!(<a href="#78a833319fe635b4" class="k">this</a>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r854 rd" class="r854 r">commandExpr</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="#785915ec8547ce9f" class="k">var</a> <span id="r855 rd" class="r855 r">pipelineAst</span> = <span class="r854 r">commandExpr</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="#785915ec8547ce9f" class="t t">PipelineAst</a>;
            <b>if</b> (<span class="r855 r">pipelineAst</span> == <b>null</b> || <span class="r855 r">pipelineAst</span>.<a href="#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span> &gt; 1)
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="#a9797c05604b61e8" class="k">var</a> <span id="r856 rd" class="r856 r">parenExpressionAst</span> = <span class="r855 r">pipelineAst</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="#a9797c05604b61e8" class="t t">ParenExpressionAst</a>;
            <b>if</b> (<span class="r856 r">parenExpressionAst</span> != <b>null</b>)
            {
                <b>return</b> <span class="r856 r">parenExpressionAst</span>.<a href="#9735bf42b0a863cd" class="i method">ShouldPreserveOutputInCaseOfException</a>();
            }
            <b>else</b>
            {
                <b>return</b> (<span class="r855 r">pipelineAst</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> || <span class="r855 r">pipelineAst</span>.<a href="#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="#61c97c02c53bf32d" class="t t">NamedBlockAst</a>);
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a ternary expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$a ? 1 : 2</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="75320d2e9ca587ab" href="../../R/75320d2e9ca587ab.html" target="n" data-glyph="0,0" class="t t">TernaryExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the a ternary expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r857 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r858 r">condition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The condition operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r859 r">ifTrue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The if clause.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r860 r">ifFalse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The else clause.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="adda7d3b76cf30cd" href="../../R/adda7d3b76cf30cd.html" target="n" data-glyph="72,1" class="t constructor">TernaryExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r857 rd" class="r857 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r858 rd" class="r858 r">condition</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r859 rd" class="r859 r">ifTrue</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r860 rd" class="r860 r">ifFalse</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r857 r">extent</span>)
        {
            <a href="#8fe864cc3d568de7" class="i property">Condition</a> = <span class="r858 r">condition</span> ?? <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r858 r">condition</span>));
            <a href="#c679b2d23aba3af3" class="i property">IfTrue</a> = <span class="r859 r">ifTrue</span> ?? <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r859 r">ifTrue</span>));
            <a href="#6aa8ec2dcb9934c3" class="i property">IfFalse</a> = <span class="r860 r">ifFalse</span> ?? <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r860 r">ifFalse</span>));
 
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#8fe864cc3d568de7" class="i property">Condition</a>);
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#c679b2d23aba3af3" class="i property">IfTrue</a>);
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#6aa8ec2dcb9934c3" class="i property">IfFalse</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ast for the condition of the ternary expression. The property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="8fe864cc3d568de7" href="../../R/8fe864cc3d568de7.html" target="n" data-glyph="102,1" class="i property">Condition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ast for the if-operand of the ternary expression. The property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="c679b2d23aba3af3" href="../../R/c679b2d23aba3af3.html" target="n" data-glyph="102,1" class="i property">IfTrue</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ast for the else-operand of the ternary expression. The property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="6aa8ec2dcb9934c3" href="../../R/6aa8ec2dcb9934c3.html" target="n" data-glyph="102,1" class="i property">IfFalse</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the TernaryExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">return</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retirns a copy of the ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">return</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="5e073145293ae915" href="../../R/5e073145293ae915.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r861 rd" class="r861 r">newCondition</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#75320d2e9ca587ab" class="k">this</a>.<a href="#8fe864cc3d568de7" class="i property">Condition</a>);
            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r862 rd" class="r862 r">newIfTrue</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#75320d2e9ca587ab" class="k">this</a>.<a href="#c679b2d23aba3af3" class="i property">IfTrue</a>);
            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r863 rd" class="r863 r">newIfFalse</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#75320d2e9ca587ab" class="k">this</a>.<a href="#6aa8ec2dcb9934c3" class="i property">IfFalse</a>);
            <b>return</b> <b>new</b> <a href="#adda7d3b76cf30cd" class="t constructor">TernaryExpressionAst</a>(<a href="#75320d2e9ca587ab" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r861 r">newCondition</span>, <span class="r862 r">newIfTrue</span>, <span class="r863 r">newIfFalse</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="49a80891e2651be9" href="../../R/49a80891e2651be9.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r864 rd" class="r864 r">visitor</span>)
        {
            <b>if</b> (<span class="r864 r">visitor</span> <b>is</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a> <span id="r865 rd" class="r865 r">visitor2</span>)
            {
                <b>return</b> <span class="r865 r">visitor2</span>.<a href="AstVisitor.cs.html#5d329b30bb4d779c" class="i method">VisitTernaryExpression</a>(<a href="#75320d2e9ca587ab" class="k">this</a>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="3361801f9f3641d5" href="../../R/3361801f9f3641d5.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r866 rd" class="r866 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r867 rd" class="r867 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <b>if</b> (<span class="r866 r">visitor</span> <b>is</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a> <span id="r868 rd" class="r868 r">visitor2</span>)
            {
                <span class="r867 r">action</span> = <span class="r868 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#df70390a0ed5e3af" class="i method">VisitTernaryExpression</a>(<a href="#75320d2e9ca587ab" class="k">this</a>);
                <b>if</b> (<span class="r867 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                {
                    <b>return</b> <span class="r866 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#75320d2e9ca587ab" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
                }
            }
 
            <b>if</b> (<span class="r867 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r867 r">action</span> = <a href="#8fe864cc3d568de7" class="i property">Condition</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r866 r">visitor</span>);
            }
 
            <b>if</b> (<span class="r867 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r867 r">action</span> = <a href="#c679b2d23aba3af3" class="i property">IfTrue</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r866 r">visitor</span>);
            }
 
            <b>if</b> (<span class="r867 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <span class="r867 r">action</span> = <a href="#6aa8ec2dcb9934c3" class="i property">IfFalse</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r866 r">visitor</span>);
            }
 
            <b>return</b> <span class="r866 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#75320d2e9ca587ab" class="k">this</a>, <span class="r867 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a binary expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$a + $b</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="f3e3848ef2eae593" href="../../R/f3e3848ef2eae593.html" target="n" data-glyph="0,0" class="t t">BinaryExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the binary expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r869 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r870 r">left</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The left hand operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r871 r">operator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The binary operator.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r872 r">right</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The right hand operand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r873 r">errorPosition</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position to report if an error occurs at runtime while evaluating the binary operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r871 r">operator</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not a valid binary operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r869 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r870 r">left</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r872 r">right</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r873 r">errorPosition</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="285ee0c928c6e703" href="../../R/285ee0c928c6e703.html" target="n" data-glyph="72,1" class="t constructor">BinaryExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r869 rd" class="r869 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r870 rd" class="r870 r">left</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r871 rd" class="r871 r">@operator</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r872 rd" class="r872 r">right</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r873 rd" class="r873 r">errorPosition</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r869 r">extent</span>)
        {
            <b>if</b> ((<span class="r871 r">@operator</span>.<a href="token.cs.html#dd86d229f95e81c2" class="i method">GetTraits</a>() &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#359e25a8812963af" class="i field">BinaryOperator</a>) == 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r871 r">@operator</span>));
            }
 
            <b>if</b> (<span class="r870 r">left</span> == <b>null</b> || <span class="r872 r">right</span> == <b>null</b> || <span class="r873 r">errorPosition</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r870 r">left</span> == <b>null</b> ? <span class="s">&quot;left&quot;</span> : <span class="r872 r">right</span> == <b>null</b> ? <span class="s">&quot;right&quot;</span> : <span class="s">&quot;errorPosition&quot;</span>);
            }
 
            <a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#e19b481693ff50d7" class="i property">Left</a> = <span class="r870 r">left</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r870 r">left</span>);
            <a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#d9e9940dedef2ba7" class="i property">Operator</a> = <span class="r871 r">@operator</span>;
            <a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#c43edc792b1ee433" class="i property">Right</a> = <span class="r872 r">right</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r872 r">right</span>);
            <a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#df8f322e70353a62" class="i property">ErrorPosition</a> = <span class="r873 r">errorPosition</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The operator token kind.  The value returned is always a binary operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <a id="d9e9940dedef2ba7" href="../../R/d9e9940dedef2ba7.html" target="n" data-glyph="102,1" class="i property">Operator</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the left hand side of the binary expression.  The property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="e19b481693ff50d7" href="../../R/e19b481693ff50d7.html" target="n" data-glyph="102,1" class="i property">Left</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the right hand side of the binary expression.  The property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="c43edc792b1ee433" href="../../R/c43edc792b1ee433.html" target="n" data-glyph="102,1" class="i property">Right</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position to report an error if an error occurs at runtime.  The property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="df8f322e70353a62" href="../../R/df8f322e70353a62.html" target="n" data-glyph="102,1" class="i property">ErrorPosition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the BinaryExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="c11ebf9bba27ae98" href="../../R/c11ebf9bba27ae98.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r874 rd" class="r874 r">newLeft</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#e19b481693ff50d7" class="i property">Left</a>);
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r875 rd" class="r875 r">newRight</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#c43edc792b1ee433" class="i property">Right</a>);
            <b>return</b> <b>new</b> <a href="#285ee0c928c6e703" class="t constructor">BinaryExpressionAst</a>(<a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r874 r">newLeft</span>, <a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#d9e9940dedef2ba7" class="i property">Operator</a>, <span class="r875 r">newRight</span>, <a href="#f3e3848ef2eae593" class="k">this</a>.<a href="#df8f322e70353a62" class="i property">ErrorPosition</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The result type of the operation.  For most binary operators, the type is unknown until runtime, but</span>
        <span class="c">///</span><span class="c"> xor always results in </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(bool)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="4e2e251ca1948fc2" href="../../R/4e2e251ca1948fc2.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b>
            {
                <b>switch</b> (<a href="#d9e9940dedef2ba7" class="i property">Operator</a>)
                {
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e2a921da8dc5458e" class="i field">Xor</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#14e331a4180e8cfa" class="i field">And</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#eacefffd17e34bf2" class="i field">Or</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7e2491f4694546b3" class="i field">Is</a>:
                        <b>return</b> <b>typeof</b>(<b>bool</b>);
                }
 
                <b>return</b> <b>typeof</b>(<b>object</b>);
            }
        }
 
        <b>internal static readonly</b> <a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>[] <a id="3a02e5cd6377c153" href="../../R/3a02e5cd6377c153.html" target="n" data-glyph="44,1" class="i field">BoolTypeNameArray</a> = <b>new</b> <a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>[] { <b>new</b> <span class="t">PSTypeName</span>(<b>typeof</b>(<b>bool</b>)) };
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="d355883ff138cb91" href="../../R/d355883ff138cb91.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r876 rd" class="r876 r">visitor</span>)
        {
            <b>return</b> <span class="r876 r">visitor</span>.<a href="AstVisitor.cs.html#5e3b4745e2c59cc4" class="i method">VisitBinaryExpression</a>(<a href="#f3e3848ef2eae593" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="78512f522cda17ca" href="../../R/78512f522cda17ca.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r877 rd" class="r877 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r878 rd" class="r878 r">action</span> = <span class="r877 r">visitor</span>.<a href="PreOrderVisitor.cs.html#b882a4dd68b2939b" class="i method">VisitBinaryExpression</a>(<a href="#f3e3848ef2eae593" class="k">this</a>);
            <b>if</b> (<span class="r878 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r877 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f3e3848ef2eae593" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r878 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r878 r">action</span> = <a href="#e19b481693ff50d7" class="i property">Left</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r877 r">visitor</span>);
            <b>if</b> (<span class="r878 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r878 r">action</span> = <a href="#c43edc792b1ee433" class="i property">Right</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r877 r">visitor</span>);
            <b>return</b> <span class="r877 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#f3e3848ef2eae593" class="k">this</a>, <span class="r878 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing an expression with a unary operator.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="ee62c8a99269d267" href="../../R/ee62c8a99269d267.html" target="n" data-glyph="0,0" class="t t">UnaryExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a unary expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r879 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression, including the operator (which may be prefix or postfix.).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r880 r">tokenKind</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The unary operator token kind for the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r881 r">child</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression that the unary operator is applied to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r879 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r881 r">child</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r880 r">tokenKind</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not a valid unary operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="b430512411f55a56" href="../../R/b430512411f55a56.html" target="n" data-glyph="72,1" class="t constructor">UnaryExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r879 rd" class="r879 r">extent</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r880 rd" class="r880 r">tokenKind</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r881 rd" class="r881 r">child</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r879 r">extent</span>)
        {
            <b>if</b> ((<span class="r880 r">tokenKind</span>.<a href="token.cs.html#dd86d229f95e81c2" class="i method">GetTraits</a>() &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#84cb73ac24504e0d" class="i field">UnaryOperator</a>) == 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r880 r">tokenKind</span>));
            }
 
            <b>if</b> (<span class="r881 r">child</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r881 r">child</span>));
            }
 
            <a href="#ee62c8a99269d267" class="k">this</a>.<a href="#1ce84eccd8a75fa0" class="i property">TokenKind</a> = <span class="r880 r">tokenKind</span>;
            <a href="#ee62c8a99269d267" class="k">this</a>.<a href="#ca72754d5d4d5410" class="i property">Child</a> = <span class="r881 r">child</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r881 r">child</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The operator token for the unary expression.  The value returned is always a unary operator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <a id="1ce84eccd8a75fa0" href="../../R/1ce84eccd8a75fa0.html" target="n" data-glyph="102,1" class="i property">TokenKind</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The child expression the unary operator is applied to.  The property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="ca72754d5d4d5410" href="../../R/ca72754d5d4d5410.html" target="n" data-glyph="102,1" class="i property">Child</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the UnaryExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="f6792f7c25208f78" href="../../R/f6792f7c25208f78.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r882 rd" class="r882 r">newChild</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#ee62c8a99269d267" class="k">this</a>.<a href="#ca72754d5d4d5410" class="i property">Child</a>);
            <b>return</b> <b>new</b> <a href="#b430512411f55a56" class="t constructor">UnaryExpressionAst</a>(<a href="#ee62c8a99269d267" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#ee62c8a99269d267" class="k">this</a>.<a href="#1ce84eccd8a75fa0" class="i property">TokenKind</a>, <span class="r882 r">newChild</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(bool)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> if the unary operator is a logical negation, otherwise returns </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(object)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="fea6169af90d061f" href="../../R/fea6169af90d061f.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b>
            {
                <b>return</b> (<a href="#1ce84eccd8a75fa0" class="i property">TokenKind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#95193423aec1ddd7" class="i field">Not</a> || <a href="#1ce84eccd8a75fa0" class="i property">TokenKind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6190040d2f0e7bc3" class="i field">Exclaim</a>)
                    ? <b>typeof</b>(<b>bool</b>)
                    : <b>typeof</b>(<b>object</b>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="f4de14ccb21e9ed5" href="../../R/f4de14ccb21e9ed5.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r883 rd" class="r883 r">visitor</span>)
        {
            <b>return</b> <span class="r883 r">visitor</span>.<a href="AstVisitor.cs.html#8e1c4ed7e6183e39" class="i method">VisitUnaryExpression</a>(<a href="#ee62c8a99269d267" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="bc74dc0e5d6a471b" href="../../R/bc74dc0e5d6a471b.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r884 rd" class="r884 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r885 rd" class="r885 r">action</span> = <span class="r884 r">visitor</span>.<a href="PreOrderVisitor.cs.html#5bcdb4f809a9dbe6" class="i method">VisitUnaryExpression</a>(<a href="#ee62c8a99269d267" class="k">this</a>);
            <b>if</b> (<span class="r885 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r884 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#ee62c8a99269d267" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r885 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r885 r">action</span> = <a href="#ca72754d5d4d5410" class="i property">Child</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r884 r">visitor</span>);
            <b>return</b> <span class="r884 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#ee62c8a99269d267" class="k">this</a>, <span class="r885 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a scriptblock with a keyword name. This is normally allowed only for script workflow.</span>
    <span class="c">///</span><span class="c"> e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">parallel { ... }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">sequence { ... }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="0a993ec4b360d318" href="../../R/0a993ec4b360d318.html" target="n" data-glyph="0,0" class="t t">BlockStatementAst</a> : <a href="#9c25dfdd7f4807b0" class="t t">StatementAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a keyword block expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r886 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r887 r">kind</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r888 r">body</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="716c4965353726f3" href="../../R/716c4965353726f3.html" target="n" data-glyph="72,1" class="t constructor">BlockStatementAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r886 rd" class="r886 r">extent</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r887 rd" class="r887 r">kind</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r888 rd" class="r888 r">body</span>)
            : <a href="#e1bbf1b8e63bd89f" class="k">base</a>(<span class="r886 r">extent</span>)
        {
            <b>if</b> (<span class="r887 r">kind</span> == <b>null</b> || <span class="r888 r">body</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r887 r">kind</span> == <b>null</b> ? <span class="s">&quot;kind&quot;</span> : <span class="s">&quot;body&quot;</span>);
            }
 
            <b>if</b> (<span class="r887 r">kind</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b72ef21ced0e588" class="i field">Sequence</a> &amp;&amp; <span class="r887 r">kind</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2078224c34fc71d1" class="i field">Parallel</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r887 r">kind</span>));
            }
 
            <a href="#0a993ec4b360d318" class="k">this</a>.<a href="#340b3bead04c5562" class="i property">Kind</a> = <span class="r887 r">kind</span>;
            <a href="#0a993ec4b360d318" class="k">this</a>.<a href="#13f21b494b2d40ba" class="i property">Body</a> = <span class="r888 r">body</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r888 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scriptblockexpression that has a keyword applied to it. This property is nerver null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="13f21b494b2d40ba" href="../../R/13f21b494b2d40ba.html" target="n" data-glyph="102,1" class="i property">Body</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The keyword name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="340b3bead04c5562" href="../../R/340b3bead04c5562.html" target="n" data-glyph="102,1" class="i property">Kind</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the BlockStatementAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="e885a1c1c3590b0c" href="../../R/e885a1c1c3590b0c.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#268644c84b225866" class="k">var</a> <span id="r889 rd" class="r889 r">newBody</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#0a993ec4b360d318" class="k">this</a>.<a href="#13f21b494b2d40ba" class="i property">Body</a>);
            <b>return</b> <b>new</b> <a href="#716c4965353726f3" class="t constructor">BlockStatementAst</a>(<a href="#0a993ec4b360d318" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#0a993ec4b360d318" class="k">this</a>.<a href="#340b3bead04c5562" class="i property">Kind</a>, <span class="r889 r">newBody</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="26e61246ace8bdf6" href="../../R/26e61246ace8bdf6.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r890 rd" class="r890 r">visitor</span>)
        {
            <b>return</b> <span class="r890 r">visitor</span>.<a href="AstVisitor.cs.html#14419f4f7a625e73" class="i method">VisitBlockStatement</a>(<a href="#0a993ec4b360d318" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="39c1b31666828010" href="../../R/39c1b31666828010.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r891 rd" class="r891 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r892 rd" class="r892 r">action</span> = <span class="r891 r">visitor</span>.<a href="PreOrderVisitor.cs.html#b005d9e36b1e3a4f" class="i method">VisitBlockStatement</a>(<a href="#0a993ec4b360d318" class="k">this</a>);
            <b>if</b> (<span class="r892 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r891 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#0a993ec4b360d318" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r892 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r892 r">action</span> = <a href="#13f21b494b2d40ba" class="i property">Body</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r891 r">visitor</span>);
            <b>return</b> <span class="r891 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#0a993ec4b360d318" class="k">this</a>, <span class="r892 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an expression with an attribute.  This is normally allowed only on parameters or variables</span>
    <span class="c">///</span><span class="c"> being assigned, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[Parameter()]$PassThru</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[ValidateScript({$true})$abc = 42</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="434eb922ec6ac95b" href="../../R/434eb922ec6ac95b.html" target="n" data-glyph="0,0" class="t t">AttributedExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>, <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an attributed expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r893 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the attribute and ending after the expression being attributed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r894 r">attribute</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The attribute being applied to </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r895 r">child</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r895 r">child</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression being attributed by </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r894 r">attribute</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r893 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r894 r">attribute</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r895 r">child</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="fe01d62af02ff2f7" href="../../R/fe01d62af02ff2f7.html" target="n" data-glyph="72,1" class="t constructor">AttributedExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r893 rd" class="r893 r">extent</span>, <a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <span id="r894 rd" class="r894 r">attribute</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r895 rd" class="r895 r">child</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r893 r">extent</span>)
        {
            <b>if</b> (<span class="r894 r">attribute</span> == <b>null</b> || <span class="r895 r">child</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r894 r">attribute</span> == <b>null</b> ? <span class="s">&quot;attribute&quot;</span> : <span class="s">&quot;child&quot;</span>);
            }
 
            <a href="#434eb922ec6ac95b" class="k">this</a>.<a href="#29f1db02fe3920d7" class="i property">Attribute</a> = <span class="r894 r">attribute</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r894 r">attribute</span>);
            <a href="#434eb922ec6ac95b" class="k">this</a>.<a href="#b2353777e73e35be" class="i property">Child</a> = <span class="r895 r">child</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r895 r">child</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression that has an attribute or type constraint applied to it.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="b2353777e73e35be" href="../../R/b2353777e73e35be.html" target="n" data-glyph="102,1" class="i property">Child</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The attribute or type constraint for this expression.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <a id="29f1db02fe3920d7" href="../../R/29f1db02fe3920d7.html" target="n" data-glyph="102,1" class="i property">Attribute</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the AttributedExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="455ca35892a59b3f" href="../../R/455ca35892a59b3f.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#35c989f6a7b4eace" class="k">var</a> <span id="r896 rd" class="r896 r">newAttribute</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#434eb922ec6ac95b" class="k">this</a>.<a href="#29f1db02fe3920d7" class="i property">Attribute</a>);
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r897 rd" class="r897 r">newChild</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#434eb922ec6ac95b" class="k">this</a>.<a href="#b2353777e73e35be" class="i property">Child</a>);
            <b>return</b> <b>new</b> <a href="#fe01d62af02ff2f7" class="t constructor">AttributedExpressionAst</a>(<a href="#434eb922ec6ac95b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r896 r">newAttribute</span>, <span class="r897 r">newChild</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="268de0fb48ec7a49" href="../../R/268de0fb48ec7a49.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r898 rd" class="r898 r">visitor</span>)
        {
            <b>return</b> <span class="r898 r">visitor</span>.<a href="AstVisitor.cs.html#845e4c2be0b3769f" class="i method">VisitAttributedExpression</a>(<a href="#434eb922ec6ac95b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="ffa3e4ee16e42083" href="../../R/ffa3e4ee16e42083.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r899 rd" class="r899 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r900 rd" class="r900 r">action</span> = <span class="r899 r">visitor</span>.<a href="PreOrderVisitor.cs.html#cea8358c8c4d8aad" class="i method">VisitAttributedExpression</a>(<a href="#434eb922ec6ac95b" class="k">this</a>);
            <b>if</b> (<span class="r900 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r899 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#434eb922ec6ac95b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r900 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r900 r">action</span> = <a href="#29f1db02fe3920d7" class="i property">Attribute</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r899 r">visitor</span>);
            <b>if</b> (<span class="r900 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r900 r">action</span> = <a href="#b2353777e73e35be" class="i property">Child</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r899 r">visitor</span>);
            <b>return</b> <span class="r899 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#434eb922ec6ac95b" class="k">this</a>, <span class="r900 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Code Generation Details
 
        <b>private</b> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a> <a id="1dca3933426f85cb" href="../../R/1dca3933426f85cb.html" target="n" data-glyph="76,1" class="i method">GetActualAssignableAst</a>()
        {
            <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r901 rd" class="r901 r">child</span> = <a href="#434eb922ec6ac95b" class="k">this</a>;
            <a href="#434eb922ec6ac95b" class="k">var</a> <span id="r902 rd" class="r902 r">childAttributeAst</span> = <span class="r901 r">child</span> <b>as</b> <a href="#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>;
            <b>while</b> (<span class="r902 r">childAttributeAst</span> != <b>null</b>)
            {
                <span class="r901 r">child</span> = <span class="r902 r">childAttributeAst</span>.<a href="#b2353777e73e35be" class="i property">Child</a>;
                <span class="r902 r">childAttributeAst</span> = <span class="r901 r">child</span> <b>as</b> <a href="#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>;
            }
 
            <span class="c">// Semantic checks ensure this cast succeeds</span>
            <b>return</b> (<a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>)<span class="r901 r">child</span>;
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <a id="75de10adf266d1f0" href="../../R/75de10adf266d1f0.html" target="n" data-glyph="76,1" class="i method">GetAttributes</a>()
        {
            <b>var</b> <span id="r903 rd" class="r903 r">attributes</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt;();
            <a href="#434eb922ec6ac95b" class="k">var</a> <span id="r904 rd" class="r904 r">childAttributeAst</span> = <a href="#434eb922ec6ac95b" class="k">this</a>;
            <b>while</b> (<span class="r904 r">childAttributeAst</span> != <b>null</b>)
            {
                <span class="r903 r">attributes</span>.<span class="i">Add</span>(<span class="r904 r">childAttributeAst</span>.<a href="#29f1db02fe3920d7" class="i property">Attribute</a>);
                <span class="r904 r">childAttributeAst</span> = <span class="r904 r">childAttributeAst</span>.<a href="#b2353777e73e35be" class="i property">Child</a> <b>as</b> <a href="#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>;
            }
 
            <span class="r903 r">attributes</span>.<span class="i">Reverse</span>();
            <b>return</b> <span class="r903 r">attributes</span>;
        }
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <b>return</b> <a href="#434eb922ec6ac95b" class="k">this</a>;
        }
 
        <span class="i">Expression</span> <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a>.<a id="2cafa55ee1d0e361" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetValue</a>(<a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r905 rd" class="r905 r">compiler</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r906 rd" class="r906 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r907 rd" class="r907 r">temps</span>)
        {
            <b>return</b> (<span class="i">Expression</span>)<a href="#434eb922ec6ac95b" class="k">this</a>.<a href="#268de0fb48ec7a49" class="i method">Accept</a>(<span class="r905 r">compiler</span>);
        }
 
        <span class="i">Expression</span> <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a>.<a href="#e85a96ce4e1c229b" class="i method">SetValue</a>(<a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r908 rd" class="r908 r">compiler</span>, <span class="i">Expression</span> <span id="r909 rd" class="r909 r">rhs</span>)
        {
            <b>var</b> <span id="r910 rd" class="r910 r">attributes</span> = <a href="#75de10adf266d1f0" class="i method">GetAttributes</a>();
            <a href="#41e026a3563ae47a" class="k">var</a> <span id="r911 rd" class="r911 r">assignableValue</span> = <a href="#1dca3933426f85cb" class="i method">GetActualAssignableAst</a>().<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>();
 
            <b>if</b> (!(<span class="r911 r">assignableValue</span> <b>is</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r912 rd" class="r912 r">variableExpr</span>))
            {
                <b>return</b> <span class="r911 r">assignableValue</span>.<a href="#e85a96ce4e1c229b" class="i method">SetValue</a>(<span class="r908 r">compiler</span>, <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="Compiler.cs.html#adb8a45abd1e4e34" class="i method">ConvertValue</a>(<span class="r909 r">rhs</span>, <span class="r910 r">attributes</span>));
            }
 
            <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">CallSetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r912 r">variableExpr</span>.<a href="#d094d170ef781837" class="i property">VariablePath</a>), <span class="r909 r">rhs</span>, <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r910 r">attributes</span>.<span class="i">ToArray</span>()));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Code Generation Details
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a cast expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[wmiclass]&quot;Win32_Process&quot;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="49daf252fdb62723" href="../../R/49daf252fdb62723.html" target="n" data-glyph="0,0" class="t t">ConvertExpressionAst</a> : <a href="#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a cast expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r913 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the type literal and ending after the expression being converted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r914 r">typeConstraint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type to convert to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r915 r">child</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression being converted.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r913 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r914 r">typeConstraint</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r915 r">child</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="0a8a1869daa42cd3" href="../../R/0a8a1869daa42cd3.html" target="n" data-glyph="72,1" class="t constructor">ConvertExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r913 rd" class="r913 r">extent</span>, <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r914 rd" class="r914 r">typeConstraint</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r915 rd" class="r915 r">child</span>)
            : <a href="#fe01d62af02ff2f7" class="k">base</a>(<span class="r913 r">extent</span>, <span class="r914 r">typeConstraint</span>, <span class="r915 r">child</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type to convert to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1721:PropertyNamesShouldNotMatchGetMethods&quot;</span>)]
        <b>public</b> <a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <a id="ecb5959c230c5865" href="../../R/ecb5959c230c5865.html" target="n" data-glyph="102,1" class="i property">Type</a> { <b>get</b> { <b>return</b> (<a href="#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>)<a href="#29f1db02fe3920d7" class="i property">Attribute</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ConvertExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="ef6f7a9429d83390" href="../../R/ef6f7a9429d83390.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#34b9d5dbbaca964d" class="k">var</a> <span id="r916 rd" class="r916 r">newTypeConstraint</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#49daf252fdb62723" class="k">this</a>.<a href="#ecb5959c230c5865" class="i property">Type</a>);
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r917 rd" class="r917 r">newChild</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#49daf252fdb62723" class="k">this</a>.<a href="#b2353777e73e35be" class="i property">Child</a>);
            <b>return</b> <b>new</b> <a href="#0a8a1869daa42cd3" class="t constructor">ConvertExpressionAst</a>(<a href="#49daf252fdb62723" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r916 r">newTypeConstraint</span>, <span class="r917 r">newChild</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The static type produced after the cast is normally the type named by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#ecb5959c230c5865" class="i property">Type</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, but in some cases</span>
        <span class="c">///</span><span class="c"> it may not be, in which, </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Object</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is assumed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="cfcdb8043e5844cc" href="../../R/cfcdb8043e5844cc.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b> { <b>return</b> <a href="#49daf252fdb62723" class="k">this</a>.<a href="#ecb5959c230c5865" class="i property">Type</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="#eba83ef9fd0feedd" class="i method">GetReflectionType</a>() ?? <b>typeof</b>(<b>object</b>); }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="378616e691743a68" href="../../R/378616e691743a68.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r918 rd" class="r918 r">visitor</span>)
        {
            <b>return</b> <span class="r918 r">visitor</span>.<a href="AstVisitor.cs.html#abe59b0a3f85bed6" class="i method">VisitConvertExpression</a>(<a href="#49daf252fdb62723" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e396cb4c72164762" href="../../R/e396cb4c72164762.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r919 rd" class="r919 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r920 rd" class="r920 r">action</span> = <span class="r919 r">visitor</span>.<a href="PreOrderVisitor.cs.html#5643174d67b84197" class="i method">VisitConvertExpression</a>(<a href="#49daf252fdb62723" class="k">this</a>);
            <b>if</b> (<span class="r920 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r919 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#49daf252fdb62723" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r920 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r920 r">action</span> = <a href="#ecb5959c230c5865" class="i property">Type</a>.<a href="#fda3411c37051037" class="i method">InternalVisit</a>(<span class="r919 r">visitor</span>);
            <b>if</b> (<span class="r920 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r920 r">action</span> = <a href="#b2353777e73e35be" class="i property">Child</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r919 r">visitor</span>);
            <b>return</b> <span class="r919 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#49daf252fdb62723" class="k">this</a>, <span class="r920 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Code Generation Details
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <a href="#248562b22b336dec" class="k">var</a> <span id="r921 rd" class="r921 r">varExpr</span> = <a href="#b2353777e73e35be" class="i property">Child</a> <b>as</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>;
            <b>if</b> (<span class="r921 r">varExpr</span> != <b>null</b> &amp;&amp; <span class="r921 r">varExpr</span>.<a href="#d2fd06bce4ae1ac6" class="i property">TupleIndex</a> &gt;= 0)
            {
                <span class="c">// In the common case of a single cast on the lhs of an assignment, we may have saved the type of the</span>
                <span class="c">// variable in the mutable tuple, so conversions will get generated elsewhere, and we can just use</span>
                <span class="c">// the child as the assignable value.</span>
                <b>return</b> <span class="r921 r">varExpr</span>;
            }
 
            <b>return</b> <a href="#49daf252fdb62723" class="k">this</a>;
        }
 
        <b>internal bool</b> <a id="74a22010f70cd6e1" href="../../R/74a22010f70cd6e1.html" target="n" data-glyph="74,1" class="i method">IsRef</a>()
        {
            <b>return</b> <a href="#ecb5959c230c5865" class="i property">Type</a>.<a href="#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="#d299e8e1674e18ab" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;ref&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Code Generation Details
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents accessing a member as a property, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$x.Length</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[int]::MaxValue</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> Most often this is a simple property access, but methods can also be access in this manner, returning an object</span>
    <span class="c">///</span><span class="c"> that supports invoking that member.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="a3e8bc64452a67d0" href="../../R/a3e8bc64452a67d0.html" target="n" data-glyph="0,0" class="t t">MemberExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an ast to reference a property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r922 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the expression before the operator &#39;.&#39; or &#39;::&#39; and ending after</span>
        <span class="c">///</span><span class="c"> membername or expression naming the member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r923 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression before the member access operator &#39;.&#39; or &#39;::&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r924 r">member</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name or expression naming the member to access.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r925 r">static</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the &#39;::&#39; operator was used, false if &#39;.&#39; is used.</span>
        <span class="c">///</span><span class="c"> True if the member access is for a static member, using &#39;::&#39;, false if accessing a member on an instance using &#39;.&#39;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r922 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r923 r">expression</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r924 r">member</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="12093696666cdd51" href="../../R/12093696666cdd51.html" target="n" data-glyph="72,1" class="t constructor">MemberExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r922 rd" class="r922 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r923 rd" class="r923 r">expression</span>, <a href="#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r924 rd" class="r924 r">member</span>, <b>bool</b> <span id="r925 rd" class="r925 r">@static</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r922 r">extent</span>)
        {
            <b>if</b> (<span class="r923 r">expression</span> == <b>null</b> || <span class="r924 r">member</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r923 r">expression</span> == <b>null</b> ? <span class="s">&quot;expression&quot;</span> : <span class="s">&quot;member&quot;</span>);
            }
 
            <a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#22340c1f7f19ecba" class="i property">Expression</a> = <span class="r923 r">expression</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r923 r">expression</span>);
            <a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#2c25418a24e5cfa1" class="i property">Member</a> = <span class="r924 r">member</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r924 r">member</span>);
            <a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#b882770eb12defeb" class="i property">Static</a> = <span class="r925 r">@static</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r926 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the expression before the operator &#39;.&#39;, &#39;::&#39; or &#39;?.&#39; and ending after</span>
        <span class="c">///</span><span class="c"> membername or expression naming the member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r927 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression before the member access operator &#39;.&#39;, &#39;::&#39; or &#39;?.&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r928 r">member</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name or expression naming the member to access.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r929 r">static</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the &#39;::&#39; operator was used, false if &#39;.&#39; or &#39;?.&#39; is used.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r930 r">nullConditional</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if &#39;?.&#39; used.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r926 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r927 r">expression</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r928 r">member</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="123e2cd4ddcd7c76" href="../../R/123e2cd4ddcd7c76.html" target="n" data-glyph="72,1" class="t constructor">MemberExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r926 rd" class="r926 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r927 rd" class="r927 r">expression</span>, <a href="#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r928 rd" class="r928 r">member</span>, <b>bool</b> <span id="r929 rd" class="r929 r">@static</span>, <b>bool</b> <span id="r930 rd" class="r930 r">nullConditional</span>)
            : <a href="#12093696666cdd51" class="k">this</a>(<span class="r926 r">extent</span>, <span class="r927 r">expression</span>, <span class="r928 r">member</span>, <span class="r929 r">@static</span>)
        {
            <a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#2009b5bf3ceaa685" class="i property">NullConditional</a> = <span class="r930 r">nullConditional</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression that produces the value to retrieve the member from.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="22340c1f7f19ecba" href="../../R/22340c1f7f19ecba.html" target="n" data-glyph="102,1" class="i property">Expression</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the member to retrieve.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#22790ae48f5438c6" class="t t">CommandElementAst</a> <a id="2c25418a24e5cfa1" href="../../R/2c25418a24e5cfa1.html" target="n" data-glyph="102,1" class="i property">Member</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the member to return is static, false if the member is an instance member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b882770eb12defeb" href="../../R/b882770eb12defeb.html" target="n" data-glyph="102,1" class="i property">Static</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value indicating true if the operator used is ?. or ?[].</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="2009b5bf3ceaa685" href="../../R/2009b5bf3ceaa685.html" target="n" data-glyph="102,1" class="i property">NullConditional</a> { <b>get</b>; <b>protected set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the MemberExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="c0e6cd3d95babced" href="../../R/c0e6cd3d95babced.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r931 rd" class="r931 r">newExpression</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#22340c1f7f19ecba" class="i property">Expression</a>);
            <a href="#22790ae48f5438c6" class="k">var</a> <span id="r932 rd" class="r932 r">newMember</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#2c25418a24e5cfa1" class="i property">Member</a>);
            <b>return</b> <b>new</b> <a href="#123e2cd4ddcd7c76" class="t constructor">MemberExpressionAst</a>(<a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r931 r">newExpression</span>, <span class="r932 r">newMember</span>, <a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#b882770eb12defeb" class="i property">Static</a>, <a href="#a3e8bc64452a67d0" class="k">this</a>.<a href="#2009b5bf3ceaa685" class="i property">NullConditional</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="90251c60c7aafea8" href="../../R/90251c60c7aafea8.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r933 rd" class="r933 r">visitor</span>)
        {
            <b>return</b> <span class="r933 r">visitor</span>.<a href="AstVisitor.cs.html#0374376df9b8e488" class="i method">VisitMemberExpression</a>(<a href="#a3e8bc64452a67d0" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="59a8412e90767937" href="../../R/59a8412e90767937.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r934 rd" class="r934 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r935 rd" class="r935 r">action</span> = <span class="r934 r">visitor</span>.<a href="PreOrderVisitor.cs.html#4f74eb7199e76703" class="i method">VisitMemberExpression</a>(<a href="#a3e8bc64452a67d0" class="k">this</a>);
            <b>if</b> (<span class="r935 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r934 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a3e8bc64452a67d0" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r935 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r935 r">action</span> = <a href="#22340c1f7f19ecba" class="i property">Expression</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r934 r">visitor</span>);
            <b>if</b> (<span class="r935 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r935 r">action</span> = <a href="#2c25418a24e5cfa1" class="i property">Member</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r934 r">visitor</span>);
            <b>return</b> <span class="r934 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a3e8bc64452a67d0" class="k">this</a>, <span class="r935 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <b>return</b> <b>new</b> <span class="t">MemberAssignableValue</span> { <a href="Compiler.cs.html#636d42a34963f483" class="i property">MemberExpression</a> = <a href="#a3e8bc64452a67d0" class="k">this</a> };
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents the invocation of a method, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$sb.Append(&#39;abc&#39;)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[math]::Sign($i)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="be11dcb1e53f56b8" href="../../R/be11dcb1e53f56b8.html" target="n" data-glyph="0,0" class="t t">InvokeMemberExpressionAst</a> : <a href="#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an instance of a method invocation expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r936 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the expression before the invocation operator and ending with the</span>
        <span class="c">///</span><span class="c"> closing paren after the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r937 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression before the invocation operator (&#39;.&#39;, &#39;::&#39;).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r938 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The method to invoke.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r939 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to pass to the method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r940 r">static</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the invocation is for a static method, using &#39;::&#39;, false if invoking a method on an instance using &#39;.&#39;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r936 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="856c20377086349d" href="../../R/856c20377086349d.html" target="n" data-glyph="72,1" class="t constructor">InvokeMemberExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r936 rd" class="r936 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r937 rd" class="r937 r">expression</span>, <a href="#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r938 rd" class="r938 r">method</span>, <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r939 rd" class="r939 r">arguments</span>, <b>bool</b> <span id="r940 rd" class="r940 r">@static</span>)
            : <a href="#12093696666cdd51" class="k">base</a>(<span class="r936 r">extent</span>, <span class="r937 r">expression</span>, <span class="r938 r">method</span>, <span class="r940 r">@static</span>)
        {
            <b>if</b> (<span class="r939 r">arguments</span> != <b>null</b> &amp;&amp; <span class="r939 r">arguments</span>.<span class="i">Any</span>())
            {
                <a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#0f1554608efc28f3" class="i property">Arguments</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;(<span class="r939 r">arguments</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#0f1554608efc28f3" class="i property">Arguments</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r941 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the expression, starting with the expression before the invocation operator and ending with the</span>
        <span class="c">///</span><span class="c"> closing paren after the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r942 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression before the invocation operator (&#39;.&#39;, &#39;::&#39; or &#39;?.&#39;).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r943 r">method</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The method to invoke.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r944 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to pass to the method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r945 r">static</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the invocation is for a static method, using &#39;::&#39;, false if invoking a method on an instance using &#39;.&#39; or &#39;?.&#39;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r946 r">nullConditional</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the operator used is &#39;?.&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r941 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="3a37cc8cde7f4c4a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvokeMemberExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r941 rd" class="r941 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r942 rd" class="r942 r">expression</span>, <a href="#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r943 rd" class="r943 r">method</span>, <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r944 rd" class="r944 r">arguments</span>, <b>bool</b> <span id="r945 rd" class="r945 r">@static</span>, <b>bool</b> <span id="r946 rd" class="r946 r">nullConditional</span>)
            : <a href="#856c20377086349d" class="k">this</a>(<span class="r941 r">extent</span>, <span class="r942 r">expression</span>, <span class="r943 r">method</span>, <span class="r944 r">arguments</span>, <span class="r945 r">@static</span>)
        {
            <a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#2009b5bf3ceaa685" class="i property">NullConditional</a> = <span class="r946 r">nullConditional</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The non-empty collection of arguments to pass when invoking the method, or null if no arguments were specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="0f1554608efc28f3" href="../../R/0f1554608efc28f3.html" target="n" data-glyph="102,1" class="i property">Arguments</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the InvokeMemberExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="df7c77288975335d" href="../../R/df7c77288975335d.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r947 rd" class="r947 r">newExpression</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#22340c1f7f19ecba" class="i property">Expression</a>);
            <a href="#22790ae48f5438c6" class="k">var</a> <span id="r948 rd" class="r948 r">newMethod</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#2c25418a24e5cfa1" class="i property">Member</a>);
            <b>var</b> <span id="r949 rd" class="r949 r">newArguments</span> = <span class="i">CopyElements</span>(<a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#0f1554608efc28f3" class="i property">Arguments</a>);
            <b>return</b> <b>new</b> <span class="t">InvokeMemberExpressionAst</span>(<a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r947 r">newExpression</span>, <span class="r948 r">newMethod</span>, <span class="r949 r">newArguments</span>, <a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#b882770eb12defeb" class="i property">Static</a>, <a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#2009b5bf3ceaa685" class="i property">NullConditional</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="2244caea68ba8b1e" href="../../R/2244caea68ba8b1e.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r950 rd" class="r950 r">visitor</span>)
        {
            <b>return</b> <span class="r950 r">visitor</span>.<a href="AstVisitor.cs.html#3855eb04c6166cb4" class="i method">VisitInvokeMemberExpression</a>(<a href="#be11dcb1e53f56b8" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="644988d5cee1cd4d" href="../../R/644988d5cee1cd4d.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r951 rd" class="r951 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r952 rd" class="r952 r">action</span> = <span class="r951 r">visitor</span>.<a href="PreOrderVisitor.cs.html#ba51f39c9632b696" class="i method">VisitInvokeMemberExpression</a>(<a href="#be11dcb1e53f56b8" class="k">this</a>);
            <b>if</b> (<span class="r952 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r951 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#be11dcb1e53f56b8" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r952 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r952 r">action</span> = <a href="#be11dcb1e53f56b8" class="k">this</a>.<a href="#9fe2011b73b31a04" class="i method">InternalVisitChildren</a>(<span class="r951 r">visitor</span>);
            <b>return</b> <span class="r951 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#be11dcb1e53f56b8" class="k">this</a>, <span class="r952 r">action</span>);
        }
 
        <b>internal</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="9fe2011b73b31a04" href="../../R/9fe2011b73b31a04.html" target="n" data-glyph="74,1" class="i method">InternalVisitChildren</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r953 rd" class="r953 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r954 rd" class="r954 r">action</span> = <a href="#22340c1f7f19ecba" class="i property">Expression</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r953 r">visitor</span>);
            <b>if</b> (<span class="r954 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r954 r">action</span> = <a href="#2c25418a24e5cfa1" class="i property">Member</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r953 r">visitor</span>);
            <b>if</b> (<span class="r954 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#0f1554608efc28f3" class="i property">Arguments</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r955 rd" class="r955 r">index</span> = 0; <span class="r955 r">index</span> &lt; <a href="#0f1554608efc28f3" class="i property">Arguments</a>.<span class="i">Count</span>; <span class="r955 r">index</span>++)
                {
                    <b>var</b> <span id="r956 rd" class="r956 r">arg</span> = <a href="#0f1554608efc28f3" class="i property">Arguments</a>[<span class="r955 r">index</span>];
                    <span class="r954 r">action</span> = <span class="r956 r">arg</span>.<span class="i">InternalVisit</span>(<span class="r953 r">visitor</span>);
                    <b>if</b> (<span class="r954 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r954 r">action</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <b>return</b> <b>new</b> <span class="t">InvokeMemberAssignableValue</span> { <a href="Compiler.cs.html#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a> = <a href="#be11dcb1e53f56b8" class="k">this</a> };
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents the invocation of a base ctor method from PS class instance ctor, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">class B : A{ B() : base() {} }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="93dc2e4429de8e4e" href="../../R/93dc2e4429de8e4e.html" target="n" data-glyph="0,0" class="t t">BaseCtorInvokeMemberExpressionAst</a> : <a href="#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an instance of a base ctor invocation expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r957 r">baseKeywordExtent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the base keyword, i.e. for</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">class B : A { B() : base(100) {} }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> it will be &quot;base&quot;.</span>
        <span class="c">///</span><span class="c"> Can be empty extent (i.e. for implicit base ctor call).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r958 r">baseCallExtent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the base ctor call expression, i.e. for</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">class B : A { B() : base(100) {} }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> it will be &quot;base(100)&quot;</span>
        <span class="c">///</span><span class="c"> Can be empty extent (i.e. for implicit base ctor call).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r959 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The arguments to pass to the ctor.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="36e187267e1ce179" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">BaseCtorInvokeMemberExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r957 rd" class="r957 r">baseKeywordExtent</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r958 rd" class="r958 r">baseCallExtent</span>, <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r959 rd" class="r959 r">arguments</span>)
            : <a href="#856c20377086349d" class="k">base</a>(
                <span class="r958 r">baseCallExtent</span>,
                <b>new</b> <a href="#ca2f2cf1331a5386" class="t constructor">VariableExpressionAst</a>(<span class="r957 r">baseKeywordExtent</span>, <span class="s">&quot;this&quot;</span>, <b>false</b>),
                <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r957 r">baseKeywordExtent</span>, <span class="s">&quot;.ctor&quot;</span>, <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>),
                <span class="r959 r">arguments</span>,
                <span class="r940 r">@static</span>: <b>false</b>)
        {
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="84575eaa0d082406" href="../../R/84575eaa0d082406.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r960 rd" class="r960 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <span id="r961 rd" class="r961 r">action</span> = <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="k">var</a> <span id="r962 rd" class="r962 r">visitor2</span> = <span class="r960 r">visitor</span> <b>as</b> <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>;
            <b>if</b> (<span class="r962 r">visitor2</span> != <b>null</b>)
            {
                <span class="r961 r">action</span> = <span class="r962 r">visitor2</span>.<a href="PreOrderVisitor.cs.html#70c8a788fd0f6e3a" class="i method">VisitBaseCtorInvokeMemberExpression</a>(<a href="#93dc2e4429de8e4e" class="k">this</a>);
                <b>if</b> (<span class="r961 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                    <b>return</b> <span class="r960 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#93dc2e4429de8e4e" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            }
 
            <b>if</b> (<span class="r961 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r961 r">action</span> = <a href="#93dc2e4429de8e4e" class="k">this</a>.<a href="#9fe2011b73b31a04" class="i method">InternalVisitChildren</a>(<span class="r960 r">visitor</span>);
            <b>return</b> <span class="r960 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#93dc2e4429de8e4e" class="k">this</a>, <span class="r961 r">action</span>);
        }
 
        <b>internal override object</b> <a id="13635bafee98fccd" href="../../R/13635bafee98fccd.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r963 rd" class="r963 r">visitor</span>)
        {
            <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="k">var</a> <span id="r964 rd" class="r964 r">visitor2</span> = <span class="r963 r">visitor</span> <b>as</b> <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>;
            <b>return</b> <span class="r964 r">visitor2</span>?.<a href="AstVisitor.cs.html#49f88f2bc99de4e1" class="i method">VisitBaseCtorInvokeMemberExpression</a>(<a href="#93dc2e4429de8e4e" class="k">this</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The name and attributes of a type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="a422e1772da6dbc8" href="../../R/a422e1772da6dbc8.html" target="n" data-glyph="48,0" class="t t">ITypeName</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The full name of the type, including any namespace and assembly name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b> <a id="15c64a580f477707" href="../../R/15c64a580f477707.html" target="n" data-glyph="102,1" class="i property">FullName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the type, including any namespace, but not including the assembly name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b> <a id="d299e8e1674e18ab" href="../../R/d299e8e1674e18ab.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the assembly, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b>? <a id="0bd4331ca891bb41" href="../../R/0bd4331ca891bb41.html" target="n" data-glyph="102,1" class="i property">AssemblyName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the type names an array, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>bool</b> <a id="aec5b41131664213" href="../../R/aec5b41131664213.html" target="n" data-glyph="102,1" class="i property">IsArray</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the type names a closed generic type (has generic type arguments), false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>bool</b> <a id="a5af9e9e8aa8706e" href="../../R/a5af9e9e8aa8706e.html" target="n" data-glyph="102,1" class="i property">IsGeneric</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that this typename represents, if such a type exists, null otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i">Type</span>? <a id="eba83ef9fd0feedd" href="../../R/eba83ef9fd0feedd.html" target="n" data-glyph="72,1" class="i method">GetReflectionType</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Assuming the typename is an attribute, returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that this typename represents.</span>
        <span class="c">///</span><span class="c"> By convention, the typename may omit the suffix &quot;Attribute&quot;.  Lookup will attempt to resolve the type as is,</span>
        <span class="c">///</span><span class="c"> and if that fails, the suffix &quot;Attribute&quot; will be appended.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i">Type</span>? <a id="32e4c2eb2fe24684" href="../../R/32e4c2eb2fe24684.html" target="n" data-glyph="72,1" class="i method">GetReflectionAttributeType</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="2b8e897172d31016" href="../../R/2b8e897172d31016.html" target="n" data-glyph="102,1" class="i property">Extent</a> { <b>get</b>; }
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>internal interface</b> <a id="17ce99e65ddcd5ec" href="../../R/17ce99e65ddcd5ec.html" target="n" data-glyph="50,0" class="t t">ISupportsTypeCaching</a>
    {
        <span class="i">Type</span>? <a id="d64781556b926659" href="../../R/d64781556b926659.html" target="n" data-glyph="102,1" class="i property">CachedType</a> { <b>get</b>; <b>set</b>; }
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A simple type that is not an array or does not have generic arguments.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="83b43c1855a09e15" href="../../R/83b43c1855a09e15.html" target="n" data-glyph="0,0" class="t t">TypeName</a> : <a href="#a422e1772da6dbc8" class="t t">ITypeName</a>, <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>
    {
        <b>internal readonly string</b> <a id="f3d19c8c63d7748d" href="../../R/f3d19c8c63d7748d.html" target="n" data-glyph="44,1" class="i field">_name</a>;
        <b>internal</b> <span class="i">Type</span> <a id="45a6c8765239e712" href="../../R/45a6c8765239e712.html" target="n" data-glyph="44,1" class="i field">_type</a>;
        <b>internal readonly</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="d51431753c355b34" href="../../R/d51431753c355b34.html" target="n" data-glyph="44,1" class="i field">_extent</a>;
        <b>internal</b> <a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <a id="6cfa32d15ba13d9d" href="../../R/6cfa32d15ba13d9d.html" target="n" data-glyph="44,1" class="i field">_typeDefinitionAst</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a simple typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r965 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the typename.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r966 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r966 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or the empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r966 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains characters that are only allowed in a generic or array typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="1bbc28f331464eab" href="../../R/1bbc28f331464eab.html" target="n" data-glyph="72,1" class="t constructor">TypeName</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r965 rd" class="r965 r">extent</span>, <b>string</b> <span id="r966 rd" class="r966 r">name</span>)
        {
            <b>if</b> (<span class="r965 r">extent</span> == <b>null</b> || <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r966 r">name</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r965 r">extent</span> == <b>null</b> ? <span class="s">&quot;extent&quot;</span> : <span class="s">&quot;name&quot;</span>);
            }
 
            <b>var</b> <span id="r967 rd" class="r967 r">c</span> = <span class="r966 r">name</span>[0];
            <b>if</b> (<span class="r967 r">c</span> == <span class="s">&#39;[&#39;</span> || <span class="r967 r">c</span> == <span class="s">&#39;]&#39;</span> || <span class="r967 r">c</span> == <span class="s">&#39;,&#39;</span>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r966 r">name</span>));
            }
 
            <b>int</b> <span id="r968 rd" class="r968 r">backtick</span> = <span class="r966 r">name</span>.<span class="i">IndexOf</span>(<span class="s">&#39;`&#39;</span>);
            <b>if</b> (<span class="r968 r">backtick</span> != -1)
            {
                <span class="r966 r">name</span> = <span class="r966 r">name</span>.<span class="i">Replace</span>(<span class="s">&quot;``&quot;</span>, <span class="s">&quot;`&quot;</span>);
            }
 
            <a href="#83b43c1855a09e15" class="k">this</a>.<a href="#d51431753c355b34" class="i field">_extent</a> = <span class="r965 r">extent</span>;
            <a href="#83b43c1855a09e15" class="k">this</a>.<a href="#f3d19c8c63d7748d" class="i field">_name</a> = <span class="r966 r">name</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a typename with an assembly specification.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r969 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the typename.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r970 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r971 r">assembly</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The assembly the type belongs to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r969 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r970 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r971 r">assembly</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or the empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r970 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains characters that are only allowed in a generic or array typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="f6430e74ef3d1e35" href="../../R/f6430e74ef3d1e35.html" target="n" data-glyph="72,1" class="t constructor">TypeName</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r969 rd" class="r969 r">extent</span>, <b>string</b> <span id="r970 rd" class="r970 r">name</span>, <b>string</b> <span id="r971 rd" class="r971 r">assembly</span>)
            : <a href="#1bbc28f331464eab" class="k">this</a>(<span class="r969 r">extent</span>, <span class="r970 r">name</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r971 r">assembly</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r971 r">assembly</span>));
            }
 
            <a href="#e32629caa327873e" class="i property">AssemblyName</a> = <span class="r971 r">assembly</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the full name of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="5d27e8e58d692064" href="../../R/5d27e8e58d692064.html" target="n" data-glyph="102,1" class="i property">FullName</a> { <b>get</b> { <b>return</b> <a href="#e32629caa327873e" class="i property">AssemblyName</a> != <b>null</b> ? <a href="#f3d19c8c63d7748d" class="i field">_name</a> + <span class="s">&quot;,&quot;</span> + <a href="#e32629caa327873e" class="i property">AssemblyName</a> : <a href="#f3d19c8c63d7748d" class="i field">_name</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the name of the type, w/o any assembly name if one was specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="a9592c89dfa9c9ad" href="../../R/a9592c89dfa9c9ad.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b> { <b>return</b> <a href="#f3d19c8c63d7748d" class="i field">_name</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the assembly, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="e32629caa327873e" href="../../R/e32629caa327873e.html" target="n" data-glyph="102,1" class="i property">AssemblyName</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Always returns false, array typenames are instances of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#8588eb9308b68261" class="t t">ArrayTypeName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="bf19d1f202a15f67" href="../../R/bf19d1f202a15f67.html" target="n" data-glyph="102,1" class="i property">IsArray</a> { <b>get</b> { <b>return</b> <b>false</b>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Always returns false, generic typenames are instances of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d3e3939e37307477" class="t t">GenericTypeName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4b5908dab7764471" href="../../R/4b5908dab7764471.html" target="n" data-glyph="102,1" class="i property">IsGeneric</a> { <b>get</b> { <b>return</b> <b>false</b>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="1ce6d6f63fe6922f" href="../../R/1ce6d6f63fe6922f.html" target="n" data-glyph="102,1" class="i property">Extent</a> { <b>get</b> { <b>return</b> <a href="#d51431753c355b34" class="i field">_extent</a>; } }
 
        <b>internal bool</b> <a id="c3248e79a2c8f624" href="../../R/c3248e79a2c8f624.html" target="n" data-glyph="74,1" class="i method">HasDefaultCtor</a>()
        {
            <b>if</b> (<a href="#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a> == <b>null</b>)
            {
                <span class="i">Type</span> <span id="r972 rd" class="r972 r">reflectionType</span> = <a href="#0ef2ca70518b0aa3" class="i method">GetReflectionType</a>();
                <b>if</b> (<span class="r972 r">reflectionType</span> == <b>null</b>)
                {
                    <span class="c">// we are pessimistic about default ctor presence.</span>
                    <b>return</b> <b>false</b>;
                }
 
                <b>return</b> <span class="r972 r">reflectionType</span>.<a href="../../utils/ExtensionMethods.cs.html#066e8afd9c6503e7" class="i method">HasDefaultCtor</a>();
            }
 
            <b>bool</b> <span id="r973 rd" class="r973 r">hasExplicitCtor</span> = <b>false</b>;
            <b>foreach</b> (<b>var</b> <span id="r974 rd" class="r974 r">member</span> <b>in</b> <a href="#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a>.<a href="#9f439131b4d83a32" class="i property">Members</a>)
            {
                <a href="#0c4f2db9a681a977" class="k">var</a> <span id="r975 rd" class="r975 r">function</span> = <span class="r974 r">member</span> <b>as</b> <a href="#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
                <b>if</b> (<span class="r975 r">function</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r975 r">function</span>.<a href="#4faa75be8a2eed76" class="i property">IsConstructor</a>)
                    {
                        <span class="c">// TODO: add check for default values, once default values for parameters supported</span>
                        <b>if</b> (<span class="r975 r">function</span>.<a href="#f958ae4f9695b021" class="i property">Parameters</a>.<span class="i">Count</span> == 0)
                        {
                            <b>return</b> <b>true</b>;
                        }
 
                        <span class="r973 r">hasExplicitCtor</span> = <b>true</b>;
                    }
                }
            }
            <span class="c">// implicit ctor is default as well</span>
            <b>return</b> !<span class="r973 r">hasExplicitCtor</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> from a typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if possible, null otherwise.  Null may be returned for valid typenames if the assembly</span>
        <span class="c">///</span><span class="c"> containing the type has not been loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="0ef2ca70518b0aa3" href="../../R/0ef2ca70518b0aa3.html" target="n" data-glyph="72,1" class="i method">GetReflectionType</a>()
        {
            <b>if</b> (<a href="#45a6c8765239e712" class="i field">_type</a> == <b>null</b>)
            {
                <span class="i">Exception</span> <span id="r976 rd" class="r976 r">e</span>;
                <span class="i">Type</span> <span id="r977 rd" class="r977 r">type</span> = <a href="#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a> != <b>null</b> ? <a href="#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a>.<a href="#238185060b3af590" class="i property">Type</a> : <a href="TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="TypeResolver.cs.html#ccee6c3af985d76a" class="i method">ResolveTypeName</a>(<a href="#83b43c1855a09e15" class="k">this</a>, <b>out</b> <span class="r976 r">e</span>);
                <b>if</b> (<span class="r977 r">type</span> != <b>null</b>)
                {
                    <b>try</b>
                    {
                        <b>var</b> <span id="r978 rd" class="r978 r">unused</span> = <span class="r977 r">type</span>.<span class="i">TypeHandle</span>;
                    }
                    <b>catch</b> (<span class="i">NotSupportedException</span>)
                    {
                        <span class="c">// If the value of &#39;type&#39; comes from typeBuilder.AsType(), then the value of &#39;type.GetTypeInfo()&#39;</span>
                        <span class="c">// is actually the TypeBuilder instance itself. This is the same on both FullCLR and CoreCLR.</span>
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a> != <b>null</b>, <span class="s">&quot;_typeDefinitionAst can never be null&quot;</span>);
                        <b>return</b> <span class="r977 r">type</span>;
                    }
 
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#45a6c8765239e712" class="i field">_type</a>, <span class="r977 r">type</span>, <b>null</b>);
                }
            }
 
            <b>return</b> <a href="#45a6c8765239e712" class="i field">_type</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> this type represents, assuming the type is an attribute.  The suffix</span>
        <span class="c">///</span><span class="c"> &quot;Attribute&quot; may be appended, if necessary, to resolve the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if possible, null otherwise.  Null may be returned for valid typenames if the assembly</span>
        <span class="c">///</span><span class="c"> containing the type has not been loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="0b105574439f5067" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetReflectionAttributeType</a>()
        {
            <b>var</b> <span id="r979 rd" class="r979 r">result</span> = <a href="#0ef2ca70518b0aa3" class="i method">GetReflectionType</a>();
            <b>if</b> (<span class="r979 r">result</span> == <b>null</b> || !<b>typeof</b>(<span class="i">Attribute</span>).<span class="i">IsAssignableFrom</span>(<span class="r979 r">result</span>))
            {
                <a href="#83b43c1855a09e15" class="k">var</a> <span id="r980 rd" class="r980 r">attrTypeName</span> = <b>new</b> <span class="t">TypeName</span>(<a href="#d51431753c355b34" class="i field">_extent</a>, <a href="#5d27e8e58d692064" class="i property">FullName</a> + <span class="s">&quot;Attribute&quot;</span>);
                <span class="r979 r">result</span> = <span class="r980 r">attrTypeName</span>.<a href="#0ef2ca70518b0aa3" class="i method">GetReflectionType</a>();
                <b>if</b> (<span class="r979 r">result</span> != <b>null</b> &amp;&amp; !<b>typeof</b>(<span class="i">Attribute</span>).<span class="i">IsAssignableFrom</span>(<span class="r979 r">result</span>))
                {
                    <span class="r979 r">result</span> = <b>null</b>;
                }
            }
 
            <b>return</b> <span class="r979 r">result</span>;
        }
 
        <b>internal void</b> <a id="bdc0f0e8930989ab" href="../../R/bdc0f0e8930989ab.html" target="n" data-glyph="74,1" class="i method">SetTypeDefinition</a>(<a href="#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r981 rd" class="r981 r">typeDefinitionAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a> == <b>null</b>, <span class="s">&quot;Class definition is already set and cannot be changed&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#45a6c8765239e712" class="i field">_type</a> == <b>null</b>, <span class="s">&quot;Cannot set class definition if type is already resolved&quot;</span>);
            <a href="#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a> = <span class="r981 r">typeDefinitionAst</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Simply return the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5d27e8e58d692064" class="i property">FullName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="b91c00481da0d1ac" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#5d27e8e58d692064" class="i property">FullName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override bool</b> <a id="8aec16d83be71754" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r982 rd" class="r982 r">obj</span>)
        {
            <b>if</b> (!(<span class="r982 r">obj</span> <b>is</b> <a href="#83b43c1855a09e15" class="t t">TypeName</a> <span id="r983 rd" class="r983 r">other</span>))
                <b>return</b> <b>false</b>;
 
            <b>if</b> (!<a href="#f3d19c8c63d7748d" class="i field">_name</a>.<span class="i">Equals</span>(<span class="r983 r">other</span>.<a href="#f3d19c8c63d7748d" class="i field">_name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<a href="#e32629caa327873e" class="i property">AssemblyName</a> == <b>null</b>)
                <b>return</b> <span class="r983 r">other</span>.<a href="#e32629caa327873e" class="i property">AssemblyName</a> == <b>null</b>;
 
            <b>if</b> (<span class="r983 r">other</span>.<a href="#e32629caa327873e" class="i property">AssemblyName</a> == <b>null</b>)
                <b>return</b> <b>false</b>;
 
            <b>return</b> <a href="#e32629caa327873e" class="i property">AssemblyName</a>.<span class="i">Equals</span>(<span class="r983 r">other</span>.<a href="#e32629caa327873e" class="i property">AssemblyName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override int</b> <a id="42e60365caebb89b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>var</b> <span id="r984 rd" class="r984 r">stringComparer</span> = <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>;
            <b>var</b> <span id="r985 rd" class="r985 r">nameHashCode</span> = <span class="r984 r">stringComparer</span>.<span class="i">GetHashCode</span>(<a href="#f3d19c8c63d7748d" class="i field">_name</a>);
            <b>if</b> (<a href="#e32629caa327873e" class="i property">AssemblyName</a> == <b>null</b>)
                <b>return</b> <span class="r985 r">nameHashCode</span>;
 
            <b>return</b> <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">CombineHashCodes</span>(<span class="r985 r">nameHashCode</span>, <span class="r984 r">stringComparer</span>.<span class="i">GetHashCode</span>(<a href="#e32629caa327873e" class="i property">AssemblyName</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the type names a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r986 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns true if the type names a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">  This helper function is now used to check &#39;Void&#39; type only;</span>
        <span class="c">///</span><span class="c">  Other types may not work, for example, &#39;int&#39;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="106759acb9255ee9" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsType</a>(<span class="i">Type</span> <span id="r986 rd" class="r986 r">type</span>)
        {
            <b>string</b> <span id="r987 rd" class="r987 r">fullTypeName</span> = <span class="r986 r">type</span>.<span class="i">FullName</span>;
            <b>if</b> (<span class="r987 r">fullTypeName</span>.<span class="i">Equals</span>(<a href="#a9592c89dfa9c9ad" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <b>true</b>;
            <b>int</b> <span id="r988 rd" class="r988 r">lastDotIndex</span> = <span class="r987 r">fullTypeName</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;.&#39;</span>);
            <b>if</b> (<span class="r988 r">lastDotIndex</span> &gt;= 0)
            {
                <b>return</b> <span class="r987 r">fullTypeName</span>.<span class="i">AsSpan</span>(<span class="r988 r">lastDotIndex</span> + 1).<span class="i">Equals</span>(<a href="#a9592c89dfa9c9ad" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="i">Type</span> <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>.<a id="e7169dba4f98188d" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">CachedType</a>
        {
            <b>get</b> { <b>return</b> <a href="#45a6c8765239e712" class="i field">_type</a>; }
 
            <b>set</b> { <a href="#45a6c8765239e712" class="i field">_type</a> = <b>value</b>; }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represent a closed generic type including its arguments.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="d3e3939e37307477" href="../../R/d3e3939e37307477.html" target="n" data-glyph="0,0" class="t t">GenericTypeName</a> : <a href="#a422e1772da6dbc8" class="t t">ITypeName</a>, <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>
    {
        <b>private string</b> <a id="e1944c61377fc6f7" href="../../R/e1944c61377fc6f7.html" target="n" data-glyph="46,1" class="i field">_cachedFullName</a>;
        <b>private</b> <span class="i">Type</span> <a id="de52cc10b26a11af" href="../../R/de52cc10b26a11af.html" target="n" data-glyph="46,1" class="i field">_cachedType</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a generic type name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r989 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the generic typename.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r990 r">genericTypeName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the generic class.  The name does not need to include the backtick and number of expected arguments,</span>
        <span class="c">///</span><span class="c"> (e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">System.Collections.Generic.Dictionary`2</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, but the backtick and number be included.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r991 r">genericArguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The list of typenames that represent the arguments to the generic type named by </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r990 r">genericTypeName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r990 r">genericTypeName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r991 r">genericArguments</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r991 r">genericArguments</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="bbeadaeb6a5e5c91" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">GenericTypeName</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r989 rd" class="r989 r">extent</span>, <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r990 rd" class="r990 r">genericTypeName</span>, <span class="i">IEnumerable</span>&lt;<a href="#a422e1772da6dbc8" class="t t">ITypeName</a>&gt; <span id="r991 rd" class="r991 r">genericArguments</span>)
        {
            <b>if</b> (<span class="r990 r">genericTypeName</span> == <b>null</b> || <span class="r989 r">extent</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r989 r">extent</span> == <b>null</b> ? <span class="s">&quot;extent&quot;</span> : <span class="s">&quot;genericTypeName&quot;</span>);
            }
 
            <b>if</b> (<span class="r991 r">genericArguments</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r991 r">genericArguments</span>));
            }
 
            <a href="#7ad88e134d957f32" class="i property">Extent</a> = <span class="r989 r">extent</span>;
            <a href="#d3e3939e37307477" class="k">this</a>.<a href="#a0e9895f5c1358ce" class="i property">TypeName</a> = <span class="r990 r">genericTypeName</span>;
            <a href="#d3e3939e37307477" class="k">this</a>.<a href="#c3319d29a1b29f46" class="i property">GenericArguments</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#a422e1772da6dbc8" class="t t">ITypeName</a>&gt;(<span class="r991 r">genericArguments</span>.<span class="i">ToArray</span>());
 
            <b>if</b> (<a href="#d3e3939e37307477" class="k">this</a>.<a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r991 r">genericArguments</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the typename, using PowerShell syntax for generic type arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="5e697722713093d0" href="../../R/5e697722713093d0.html" target="n" data-glyph="102,1" class="i property">FullName</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#e1944c61377fc6f7" class="i field">_cachedFullName</a> == <b>null</b>)
                {
                    <span class="i">StringBuilder</span> <span id="r992 rd" class="r992 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
                    <span class="r992 r">sb</span>.<span class="i">Append</span>(<a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#d299e8e1674e18ab" class="i property">Name</a>);
                    <span class="r992 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
                    <b>bool</b> <span id="r993 rd" class="r993 r">first</span> = <b>true</b>;
                    <b>for</b> (<b>int</b> <span id="r994 rd" class="r994 r">index</span> = 0; <span class="r994 r">index</span> &lt; <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>; <span class="r994 r">index</span>++)
                    {
                        <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r995 rd" class="r995 r">typename</span> = <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>[<span class="r994 r">index</span>];
                        <b>if</b> (!<span class="r993 r">first</span>)
                        {
                            <span class="r992 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                        }
 
                        <span class="r993 r">first</span> = <b>false</b>;
                        <span class="r992 r">sb</span>.<span class="i">Append</span>(<span class="r995 r">typename</span>.<a href="#15c64a580f477707" class="i property">FullName</a>);
                    }
 
                    <span class="r992 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
                    <b>var</b> <span id="r996 rd" class="r996 r">assemblyName</span> = <a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#0bd4331ca891bb41" class="i property">AssemblyName</a>;
                    <b>if</b> (<span class="r996 r">assemblyName</span> != <b>null</b>)
                    {
                        <span class="r992 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                        <span class="r992 r">sb</span>.<span class="i">Append</span>(<span class="r996 r">assemblyName</span>);
                    }
 
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#e1944c61377fc6f7" class="i field">_cachedFullName</a>, <span class="r992 r">sb</span>.<span class="i">ToString</span>(), <b>null</b>);
                }
 
                <b>return</b> <a href="#e1944c61377fc6f7" class="i field">_cachedFullName</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the type, including any namespace, but not including the assembly name, using PowerShell syntax for generic type arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="55ac33cf13b79e70" href="../../R/55ac33cf13b79e70.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <span class="i">StringBuilder</span> <span id="r997 rd" class="r997 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <span class="r997 r">sb</span>.<span class="i">Append</span>(<a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#d299e8e1674e18ab" class="i property">Name</a>);
                <span class="r997 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
                <b>bool</b> <span id="r998 rd" class="r998 r">first</span> = <b>true</b>;
                <b>for</b> (<b>int</b> <span id="r999 rd" class="r999 r">index</span> = 0; <span class="r999 r">index</span> &lt; <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>; <span class="r999 r">index</span>++)
                {
                    <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r1000 rd" class="r1000 r">typename</span> = <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>[<span class="r999 r">index</span>];
                    <b>if</b> (!<span class="r998 r">first</span>)
                    {
                        <span class="r997 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                    }
 
                    <span class="r998 r">first</span> = <b>false</b>;
                    <span class="r997 r">sb</span>.<span class="i">Append</span>(<span class="r1000 r">typename</span>.<a href="#d299e8e1674e18ab" class="i property">Name</a>);
                }
 
                <span class="r997 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
                <b>return</b> <span class="r997 r">sb</span>.<span class="i">ToString</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the assembly, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="0985021c9926f92e" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AssemblyName</a> { <b>get</b> { <b>return</b> <a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#0bd4331ca891bb41" class="i property">AssemblyName</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Always returns false because this class does not represent arrays.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="c325a9a71521bcf7" href="../../R/c325a9a71521bcf7.html" target="n" data-glyph="102,1" class="i property">IsArray</a> { <b>get</b> { <b>return</b> <b>false</b>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Always returns true because this class represents generics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="f03d1dda96194d76" href="../../R/f03d1dda96194d76.html" target="n" data-glyph="102,1" class="i property">IsGeneric</a> { <b>get</b> { <b>return</b> <b>true</b>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The typename that specifies the generic class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="a0e9895f5c1358ce" href="../../R/a0e9895f5c1358ce.html" target="n" data-glyph="102,1" class="i property">TypeName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The generic arguments for this typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#a422e1772da6dbc8" class="t t">ITypeName</a>&gt; <a id="c3319d29a1b29f46" href="../../R/c3319d29a1b29f46.html" target="n" data-glyph="102,1" class="i property">GenericArguments</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="7ad88e134d957f32" href="../../R/7ad88e134d957f32.html" target="n" data-glyph="102,1" class="i property">Extent</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that this typename represents, if such a type exists, null otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="d837bccc47d979c3" href="../../R/d837bccc47d979c3.html" target="n" data-glyph="72,1" class="i method">GetReflectionType</a>()
        {
            <b>if</b> (<a href="#de52cc10b26a11af" class="i field">_cachedType</a> == <b>null</b>)
            {
                <span class="i">Type</span> <span id="r1001 rd" class="r1001 r">generic</span> = <span class="i">GetGenericType</span>(<a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#eba83ef9fd0feedd" class="i method">GetReflectionType</a>());
 
                <b>if</b> (<span class="r1001 r">generic</span> != <b>null</b> &amp;&amp; <span class="r1001 r">generic</span>.<span class="i">ContainsGenericParameters</span>)
                {
                    <b>var</b> <span id="r1002 rd" class="r1002 r">argumentList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Type</span>&gt;();
                    <b>foreach</b> (<b>var</b> <span id="r1003 rd" class="r1003 r">arg</span> <b>in</b> <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>)
                    {
                        <b>var</b> <span id="r1004 rd" class="r1004 r">type</span> = <span class="r1003 r">arg</span>.<span class="i">GetReflectionType</span>();
                        <b>if</b> (<span class="r1004 r">type</span> == <b>null</b>)
                            <b>return</b> <b>null</b>;
                        <span class="r1002 r">argumentList</span>.<span class="i">Add</span>(<span class="r1004 r">type</span>);
                    }
 
                    <b>try</b>
                    {
                        <b>var</b> <span id="r1005 rd" class="r1005 r">type</span> = <span class="r1001 r">generic</span>.<span class="i">MakeGenericType</span>(<span class="r1002 r">argumentList</span>.<span class="i">ToArray</span>());
                        <b>try</b>
                        {
                            <span class="c">// We don&#39;t need the TypeHandle, but it&#39;s a good indication that a type doesn&#39;t</span>
                            <span class="c">// support reflection which we need for many things.  So if this throws, we</span>
                            <span class="c">// won&#39;t cache the type.  This situation arises while defining a type that</span>
                            <span class="c">// refers to itself somehow (e.g. returns an instance of this type, array of</span>
                            <span class="c">// this type, or this type as a generic parameter.)</span>
                            <span class="c">// By not caching, we&#39;ll eventually get the real reflection capable type after</span>
                            <span class="c">// the type is fully defined.</span>
                            <b>var</b> <span id="r1006 rd" class="r1006 r">unused</span> = <span class="r1005 r">type</span>.<span class="i">TypeHandle</span>;
                        }
                        <b>catch</b> (<span class="i">NotSupportedException</span>)
                        {
                            <b>return</b> <span class="r1005 r">type</span>;
                        }
 
                        <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#de52cc10b26a11af" class="i field">_cachedType</a>, <span class="r1005 r">type</span>, <b>null</b>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                        <span class="c">// We don&#39;t want to throw exception from GetReflectionType</span>
                    }
                }
            }
 
            <b>return</b> <a href="#de52cc10b26a11af" class="i field">_cachedType</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the actual generic type if it&#39;s necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1007 r">generic</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Type</span> <a id="3afbf0ead19c861b" href="../../R/3afbf0ead19c861b.html" target="n" data-glyph="74,1" class="i method">GetGenericType</a>(<span class="i">Type</span> <span id="r1007 rd" class="r1007 r">generic</span>)
        {
            <b>if</b> (<span class="r1007 r">generic</span> == <b>null</b> || !<span class="r1007 r">generic</span>.<span class="i">ContainsGenericParameters</span>)
            {
                <b>if</b> (!<a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#15c64a580f477707" class="i property">FullName</a>.<span class="i">Contains</span>(<span class="s">&#39;`&#39;</span>))
                {
                    <a href="#83b43c1855a09e15" class="k">var</a> <span id="r1008 rd" class="r1008 r">newTypeName</span> = <b>new</b> <span class="t">TypeName</span>(<a href="#7ad88e134d957f32" class="i property">Extent</a>,
                        <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}`{1}&quot;</span>, <a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#15c64a580f477707" class="i property">FullName</a>, <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>));
                    <span class="r1007 r">generic</span> = <span class="r1008 r">newTypeName</span>.<a href="#0ef2ca70518b0aa3" class="i method">GetReflectionType</a>();
                }
            }
 
            <b>return</b> <span class="r1007 r">generic</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> this type represents, assuming the type is an attribute.  The suffix</span>
        <span class="c">///</span><span class="c"> &quot;Attribute&quot; may be appended, if necessary, to resolve the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if possible, null otherwise.  Null may be returned for valid typenames if the assembly</span>
        <span class="c">///</span><span class="c"> containing the type has not been loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="26a2afb2a65f77c5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetReflectionAttributeType</a>()
        {
            <span class="i">Type</span> <span id="r1009 rd" class="r1009 r">type</span> = <a href="#d837bccc47d979c3" class="i method">GetReflectionType</a>();
            <b>if</b> (<span class="r1009 r">type</span> == <b>null</b>)
            {
                <span class="i">Type</span> <span id="r1010 rd" class="r1010 r">generic</span> = <a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#32e4c2eb2fe24684" class="i method">GetReflectionAttributeType</a>();
                <b>if</b> (<span class="r1010 r">generic</span> == <b>null</b> || !<span class="r1010 r">generic</span>.<span class="i">ContainsGenericParameters</span>)
                {
                    <b>if</b> (!<a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#15c64a580f477707" class="i property">FullName</a>.<span class="i">Contains</span>(<span class="s">&#39;`&#39;</span>))
                    {
                        <a href="#83b43c1855a09e15" class="k">var</a> <span id="r1011 rd" class="r1011 r">newTypeName</span> = <b>new</b> <span class="t">TypeName</span>(<a href="#7ad88e134d957f32" class="i property">Extent</a>,
                            <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}Attribute`{1}&quot;</span>, <a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<a href="#15c64a580f477707" class="i property">FullName</a>, <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>));
                        <span class="r1010 r">generic</span> = <span class="r1011 r">newTypeName</span>.<a href="#0ef2ca70518b0aa3" class="i method">GetReflectionType</a>();
                    }
                }
 
                <b>if</b> (<span class="r1010 r">generic</span> != <b>null</b> &amp;&amp; <span class="r1010 r">generic</span>.<span class="i">ContainsGenericParameters</span>)
                {
                    <span class="r1009 r">type</span> = <span class="r1010 r">generic</span>.<span class="i">MakeGenericType</span>((<b>from</b> <span class="i">arg</span> <b>in</b> <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a> <b>select</b> <span class="i">arg</span>.<span class="i">GetReflectionType</span>()).<span class="i">ToArray</span>());
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#de52cc10b26a11af" class="i field">_cachedType</a>, <span class="r1009 r">type</span>, <b>null</b>);
                }
            }
 
            <b>return</b> <span class="r1009 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Simply return the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5e697722713093d0" class="i property">FullName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="58dc8f619e4b5d83" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#5e697722713093d0" class="i property">FullName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override bool</b> <a id="ef7679dcc083a731" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r1012 rd" class="r1012 r">obj</span>)
        {
            <b>if</b> (!(<span class="r1012 r">obj</span> <b>is</b> <a href="#d3e3939e37307477" class="t t">GenericTypeName</a> <span id="r1013 rd" class="r1013 r">other</span>))
                <b>return</b> <b>false</b>;
 
            <b>if</b> (!<a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<span class="i">Equals</span>(<span class="r1013 r">other</span>.<a href="#a0e9895f5c1358ce" class="i property">TypeName</a>))
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span> != <span class="r1013 r">other</span>.<a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>)
                <b>return</b> <b>false</b>;
 
            <b>var</b> <span id="r1014 rd" class="r1014 r">count</span> = <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>;
            <b>for</b> (<b>int</b> <span id="r1015 rd" class="r1015 r">i</span> = 0; <span class="r1015 r">i</span> &lt; <span class="r1014 r">count</span>; <span class="r1015 r">i</span>++)
            {
                <b>if</b> (!<a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>[<span class="r1015 r">i</span>].<span class="i">Equals</span>(<span class="r1013 r">other</span>.<a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>[<span class="r1015 r">i</span>]))
                    <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override int</b> <a id="09442e041ce158b5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>int</b> <span id="r1016 rd" class="r1016 r">hash</span> = <a href="#a0e9895f5c1358ce" class="i property">TypeName</a>.<span class="i">GetHashCode</span>();
            <b>var</b> <span id="r1017 rd" class="r1017 r">count</span> = <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>;
            <b>for</b> (<b>int</b> <span id="r1018 rd" class="r1018 r">i</span> = 0; <span class="r1018 r">i</span> &lt; <span class="r1017 r">count</span>; <span class="r1018 r">i</span>++)
            {
                <span class="r1016 r">hash</span> = <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">CombineHashCodes</span>(<span class="r1016 r">hash</span>, <a href="#c3319d29a1b29f46" class="i property">GenericArguments</a>[<span class="r1018 r">i</span>].<span class="i">GetHashCode</span>());
            }
 
            <b>return</b> <span class="r1016 r">hash</span>;
        }
 
        <span class="i">Type</span> <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>.<a id="762bcc093c2297e8" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">CachedType</a>
        {
            <b>get</b> { <b>return</b> <a href="#de52cc10b26a11af" class="i field">_cachedType</a>; }
 
            <b>set</b> { <a href="#de52cc10b26a11af" class="i field">_cachedType</a> = <b>value</b>; }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents the name of an array type including the dimensions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="8588eb9308b68261" href="../../R/8588eb9308b68261.html" target="n" data-glyph="0,0" class="t t">ArrayTypeName</a> : <a href="#a422e1772da6dbc8" class="t t">ITypeName</a>, <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>
    {
        <b>private string</b> <a id="535a5a463b135de7" href="../../R/535a5a463b135de7.html" target="n" data-glyph="46,1" class="i field">_cachedFullName</a>;
        <b>private</b> <span class="i">Type</span> <a id="726f5650e2cc0681" href="../../R/726f5650e2cc0681.html" target="n" data-glyph="46,1" class="i field">_cachedType</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an ArrayTypeName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1019 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the array typename.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1020 r">elementType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the element type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1021 r">rank</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The number of dimensions in the array.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1019 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1020 r">elementType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1021 r">rank</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is 0 or negative.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="b7ddb3bddac03e32" href="../../R/b7ddb3bddac03e32.html" target="n" data-glyph="72,1" class="t constructor">ArrayTypeName</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1019 rd" class="r1019 r">extent</span>, <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r1020 rd" class="r1020 r">elementType</span>, <b>int</b> <span id="r1021 rd" class="r1021 r">rank</span>)
        {
            <b>if</b> (<span class="r1019 r">extent</span> == <b>null</b> || <span class="r1020 r">elementType</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r1019 r">extent</span> == <b>null</b> ? <span class="s">&quot;extent&quot;</span> : <span class="s">&quot;name&quot;</span>);
            }
 
            <b>if</b> (<span class="r1021 r">rank</span> &lt;= 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r1021 r">rank</span>));
            }
 
            <a href="#79b58aa2cece930a" class="i property">Extent</a> = <span class="r1019 r">extent</span>;
            <a href="#8588eb9308b68261" class="k">this</a>.<a href="#4a80f9d745dc9309" class="i property">Rank</a> = <span class="r1021 r">rank</span>;
            <a href="#8588eb9308b68261" class="k">this</a>.<a href="#0f81729ec1838610" class="i property">ElementType</a> = <span class="r1020 r">elementType</span>;
        }
 
        <b>private string</b> <a id="fcad04c0b444ad91" href="../../R/fcad04c0b444ad91.html" target="n" data-glyph="76,1" class="i method">GetName</a>(<b>bool</b> <span id="r1022 rd" class="r1022 r">includeAssemblyName</span>)
        {
            <span class="i">StringBuilder</span> <span id="r1023 rd" class="r1023 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>try</b>
            {
                <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
                <span class="r1023 r">sb</span>.<span class="i">Append</span>(<a href="#0f81729ec1838610" class="i property">ElementType</a>.<a href="#d299e8e1674e18ab" class="i property">Name</a>);
                <span class="r1023 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
                <b>if</b> (<a href="#4a80f9d745dc9309" class="i property">Rank</a> &gt; 1)
                {
                    <span class="r1023 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>, <a href="#4a80f9d745dc9309" class="i property">Rank</a> - 1);
                }
 
                <span class="r1023 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
                <b>if</b> (<span class="r1022 r">includeAssemblyName</span>)
                {
                    <b>var</b> <span id="r1024 rd" class="r1024 r">assemblyName</span> = <a href="#0f81729ec1838610" class="i property">ElementType</a>.<a href="#0bd4331ca891bb41" class="i property">AssemblyName</a>;
                    <b>if</b> (<span class="r1024 r">assemblyName</span> != <b>null</b>)
                    {
                        <span class="r1023 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                        <span class="r1023 r">sb</span>.<span class="i">Append</span>(<span class="r1024 r">assemblyName</span>);
                    }
                }
            }
            <b>catch</b> (<span class="i">InsufficientExecutionStackException</span>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/ExecutionExceptions.cs.html#307fba193d900178" class="t constructor">ScriptCallDepthException</a>();
            }
 
            <b>return</b> <span class="r1023 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the typename, using PowerShell syntax for the array dimensions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="268598ba03b773a8" href="../../R/268598ba03b773a8.html" target="n" data-glyph="102,1" class="i property">FullName</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#535a5a463b135de7" class="i field">_cachedFullName</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#535a5a463b135de7" class="i field">_cachedFullName</a>, <a href="#fcad04c0b444ad91" class="i method">GetName</a>(<span class="r1022 r">includeAssemblyName</span>: <b>true</b>), <b>null</b>);
                }
 
                <b>return</b> <a href="#535a5a463b135de7" class="i field">_cachedFullName</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the type, including any namespace, but not including the assembly name, using PowerShell syntax for the array dimensions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b8c99570a9db3819" href="../../R/b8c99570a9db3819.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> { <b>return</b> <a href="#fcad04c0b444ad91" class="i method">GetName</a>(<span class="r1022 r">includeAssemblyName</span>: <b>false</b>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the assembly, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ccdcd92d3daaef81" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AssemblyName</a> { <b>get</b> { <b>return</b> <a href="#0f81729ec1838610" class="i property">ElementType</a>.<a href="#0bd4331ca891bb41" class="i property">AssemblyName</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true always as this class represents arrays.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="24a097c2a3f4e3e7" href="../../R/24a097c2a3f4e3e7.html" target="n" data-glyph="102,1" class="i property">IsArray</a> { <b>get</b> { <b>return</b> <b>true</b>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns false always as this class never represents generics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="0bc42011ae6baa6c" href="../../R/0bc42011ae6baa6c.html" target="n" data-glyph="102,1" class="i property">IsGeneric</a> { <b>get</b> { <b>return</b> <b>false</b>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The element type of the array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="0f81729ec1838610" href="../../R/0f81729ec1838610.html" target="n" data-glyph="102,1" class="i property">ElementType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The rank of the array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="4a80f9d745dc9309" href="../../R/4a80f9d745dc9309.html" target="n" data-glyph="102,1" class="i property">Rank</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="79b58aa2cece930a" href="../../R/79b58aa2cece930a.html" target="n" data-glyph="102,1" class="i property">Extent</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that this typename represents, if such a type exists, null otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="64b2a4d530b6ea36" href="../../R/64b2a4d530b6ea36.html" target="n" data-glyph="72,1" class="i method">GetReflectionType</a>()
        {
            <b>try</b>
            {
                <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
                <b>if</b> (<a href="#726f5650e2cc0681" class="i field">_cachedType</a> == <b>null</b>)
                {
                    <span class="i">Type</span> <span id="r1025 rd" class="r1025 r">elementType</span> = <a href="#0f81729ec1838610" class="i property">ElementType</a>.<a href="#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
                    <b>if</b> (<span class="r1025 r">elementType</span> != <b>null</b>)
                    {
                        <span class="i">Type</span> <span id="r1026 rd" class="r1026 r">type</span> = <a href="#4a80f9d745dc9309" class="i property">Rank</a> == 1 ? <span class="r1025 r">elementType</span>.<span class="i">MakeArrayType</span>() : <span class="r1025 r">elementType</span>.<span class="i">MakeArrayType</span>(<a href="#4a80f9d745dc9309" class="i property">Rank</a>);
                        <b>try</b>
                        {
                            <span class="c">// We don&#39;t need the TypeHandle, but it&#39;s a good indication that a type doesn&#39;t</span>
                            <span class="c">// support reflection which we need for many things.  So if this throws, we</span>
                            <span class="c">// won&#39;t cache the type.  This situation arises while defining a type that</span>
                            <span class="c">// refers to itself somehow (e.g. returns an instance of this type, array of</span>
                            <span class="c">// this type, or this type as a generic parameter.)</span>
                            <span class="c">// By not caching, we&#39;ll eventually get the real reflection capable type after</span>
                            <span class="c">// the type is fully defined.</span>
                            <b>var</b> <span id="r1027 rd" class="r1027 r">unused</span> = <span class="r1026 r">type</span>.<span class="i">TypeHandle</span>;
                        }
                        <b>catch</b> (<span class="i">NotSupportedException</span>)
                        {
                            <b>return</b> <span class="r1026 r">type</span>;
                        }
 
                        <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#726f5650e2cc0681" class="i field">_cachedType</a>, <span class="r1026 r">type</span>, <b>null</b>);
                    }
                }
            }
            <b>catch</b> (<span class="i">InsufficientExecutionStackException</span>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/ExecutionExceptions.cs.html#307fba193d900178" class="t constructor">ScriptCallDepthException</a>();
            }
 
            <b>return</b> <a href="#726f5650e2cc0681" class="i field">_cachedType</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Always return null, arrays can never be an attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="18c5db975ebb8966" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetReflectionAttributeType</a>()
        {
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Simply return the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#268598ba03b773a8" class="i property">FullName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="c2dd8b0534dfb81e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#268598ba03b773a8" class="i property">FullName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override bool</b> <a id="26074fad432a0622" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r1028 rd" class="r1028 r">obj</span>)
        {
            <b>if</b> (!(<span class="r1028 r">obj</span> <b>is</b> <a href="#8588eb9308b68261" class="t t">ArrayTypeName</a> <span id="r1029 rd" class="r1029 r">other</span>))
                <b>return</b> <b>false</b>;
 
            <b>return</b> <a href="#0f81729ec1838610" class="i property">ElementType</a>.<span class="i">Equals</span>(<span class="r1029 r">other</span>.<a href="#0f81729ec1838610" class="i property">ElementType</a>) &amp;&amp; <a href="#4a80f9d745dc9309" class="i property">Rank</a> == <span class="r1029 r">other</span>.<a href="#4a80f9d745dc9309" class="i property">Rank</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override int</b> <a id="5dd68413cca307ee" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>return</b> <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">CombineHashCodes</span>(<a href="#0f81729ec1838610" class="i property">ElementType</a>.<span class="i">GetHashCode</span>(), <a href="#4a80f9d745dc9309" class="i property">Rank</a>.<span class="i">GetHashCode</span>());
        }
 
        <span class="i">Type</span> <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>.<a id="084a4d5ba9bc21e8" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">CachedType</a>
        {
            <b>get</b> { <b>return</b> <a href="#726f5650e2cc0681" class="i field">_cachedType</a>; }
 
            <b>set</b> { <a href="#726f5650e2cc0681" class="i field">_cachedType</a> = <b>value</b>; }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A class that allows a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to be used directly in the PowerShell ast.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="31f87cbf583d7af1" href="../../R/31f87cbf583d7af1.html" target="n" data-glyph="0,0" class="t t">ReflectionTypeName</a> : <a href="#a422e1772da6dbc8" class="t t">ITypeName</a>, <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>
    {
        <b>private readonly</b> <span class="i">Type</span> <a id="77f2d6b0ce5d4e76" href="../../R/77f2d6b0ce5d4e76.html" target="n" data-glyph="46,1" class="i field">_type</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a typename from a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1030 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type to wrap.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1030 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="0ebf85aaf186500c" href="../../R/0ebf85aaf186500c.html" target="n" data-glyph="72,1" class="t constructor">ReflectionTypeName</a>(<span class="i">Type</span> <span id="r1030 rd" class="r1030 r">type</span>)
        {
            <b>if</b> (<span class="r1030 r">type</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1030 r">type</span>));
            }
 
            <a href="#77f2d6b0ce5d4e76" class="i field">_type</a> = <span class="r1030 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the typename in PowerShell syntax.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="a1edcfea89af546c" href="../../R/a1edcfea89af546c.html" target="n" data-glyph="102,1" class="i property">FullName</a> { <b>get</b> { <b>return</b> <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="../MshObject.cs.html#edc1ecfda5d75ea9" class="i method">Type</a>(<a href="#77f2d6b0ce5d4e76" class="i field">_type</a>); } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the typename in PowerShell syntax.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="fb56ee4d5c72dd3d" href="../../R/fb56ee4d5c72dd3d.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b> { <b>return</b> <a href="#a1edcfea89af546c" class="i property">FullName</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the assembly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="bf9c4482fc5daabf" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AssemblyName</a> { <b>get</b> { <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a>.<span class="i">Assembly</span>.<span class="i">FullName</span>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the type is an array, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="e61e53838ad3d65e" href="../../R/e61e53838ad3d65e.html" target="n" data-glyph="102,1" class="i property">IsArray</a> { <b>get</b> { <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a>.<span class="i">IsArray</span>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the type is a generic, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="d5b73354bc53e44c" href="../../R/d5b73354bc53e44c.html" target="n" data-glyph="102,1" class="i property">IsGeneric</a> { <b>get</b> { <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a>.<span class="i">IsGenericType</span>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The extent of the typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="50643dc38e1665c1" href="../../R/50643dc38e1665c1.html" target="n" data-glyph="102,1" class="i property">Extent</a> { <b>get</b> { <b>return</b> <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for this typename.  Never returns null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="8660218c8729783e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetReflectionType</a>()
        {
            <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Assuming the typename is an attribute, returns the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that this typename represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="47b1a359c69fd506" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetReflectionAttributeType</a>()
        {
            <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Simply return the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a1edcfea89af546c" class="i property">FullName</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of the type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="188a7411f95352e2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#a1edcfea89af546c" class="i property">FullName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override bool</b> <a id="04bfcbfc780ae443" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r1031 rd" class="r1031 r">obj</span>)
        {
            <b>if</b> (!(<span class="r1031 r">obj</span> <b>is</b> <a href="#31f87cbf583d7af1" class="t t">ReflectionTypeName</a> <span id="r1032 rd" class="r1032 r">other</span>))
                <b>return</b> <b>false</b>;
            <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a> == <span class="r1032 r">other</span>.<a href="#77f2d6b0ce5d4e76" class="i field">_type</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>public override int</b> <a id="e12530df696de0b5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a>.<span class="i">GetHashCode</span>();
        }
 
        <span class="i">Type</span> <a href="#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>.<a id="a9aeae5d25272d62" href="../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">CachedType</a>
        {
            <b>get</b> { <b>return</b> <a href="#77f2d6b0ce5d4e76" class="i field">_type</a>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(); }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a type literal expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">[int]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="bf258955590d49b7" href="../../R/bf258955590d49b7.html" target="n" data-glyph="0,0" class="t t">TypeExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a type literal expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1033 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the typename, including the opening and closing square braces.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1034 r">typeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The typename for the constructed ast.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1033 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1034 r">typeName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="ead902e37b5f71c3" href="../../R/ead902e37b5f71c3.html" target="n" data-glyph="72,1" class="t constructor">TypeExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1033 rd" class="r1033 r">extent</span>, <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r1034 rd" class="r1034 r">typeName</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1033 r">extent</span>)
        {
            <b>if</b> (<span class="r1034 r">typeName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1034 r">typeName</span>));
            }
 
            <a href="#bf258955590d49b7" class="k">this</a>.<a href="#c43447ab6269441a" class="i property">TypeName</a> = <span class="r1034 r">typeName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the type.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="c43447ab6269441a" href="../../R/c43447ab6269441a.html" target="n" data-glyph="102,1" class="i property">TypeName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the TypeExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="0696e0d873ccf779" href="../../R/0696e0d873ccf779.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#ead902e37b5f71c3" class="t constructor">TypeExpressionAst</a>(<a href="#bf258955590d49b7" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#bf258955590d49b7" class="k">this</a>.<a href="#c43447ab6269441a" class="i property">TypeName</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The static type of a type literal is always </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(Type)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="d2663fd153bc839b" href="../../R/d2663fd153bc839b.html" target="n" data-glyph="102,1" class="i property">StaticType</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<span class="i">Type</span>); } }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="71481275477bae8a" href="../../R/71481275477bae8a.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1035 rd" class="r1035 r">visitor</span>)
        {
            <b>return</b> <span class="r1035 r">visitor</span>.<a href="AstVisitor.cs.html#5285b09706577384" class="i method">VisitTypeExpression</a>(<a href="#bf258955590d49b7" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="02f099062da283c7" href="../../R/02f099062da283c7.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1036 rd" class="r1036 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1037 rd" class="r1037 r">action</span> = <span class="r1036 r">visitor</span>.<a href="PreOrderVisitor.cs.html#c5325256b507dcce" class="i method">VisitTypeExpression</a>(<a href="#bf258955590d49b7" class="k">this</a>);
            <b>return</b> <span class="r1036 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#bf258955590d49b7" class="k">this</a>, (<span class="r1037 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> ? <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> : <span class="r1037 r">action</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing a variable reference, either normal references, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$true</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, or splatted references</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">@PSBoundParameters</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="248562b22b336dec" href="../../R/248562b22b336dec.html" target="n" data-glyph="0,0" class="t t">VariableExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>, <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a variable reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1038 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1039 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable.  A leading &#39;$&#39; or &#39;@&#39; is not removed, those characters are assumed to be part of</span>
        <span class="c">///</span><span class="c"> the variable name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1040 r">splatted</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if splatting, like </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">@PSBoundParameters</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">, false otherwise, like </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$false</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1038 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1039 r">variableName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null, or if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1039 r">variableName</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is an empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>)]
        <b>public</b> <a id="ca2f2cf1331a5386" href="../../R/ca2f2cf1331a5386.html" target="n" data-glyph="72,1" class="t constructor">VariableExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1038 rd" class="r1038 r">extent</span>, <b>string</b> <span id="r1039 rd" class="r1039 r">variableName</span>, <b>bool</b> <span id="r1040 rd" class="r1040 r">splatted</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1038 r">extent</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1039 r">variableName</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1039 r">variableName</span>));
            }
 
            <a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a> = <b>new</b> <a href="../VariablePath.cs.html#6f51a22b7d168e83" class="t constructor">VariablePath</a>(<span class="r1039 r">variableName</span>);
            <a href="#248562b22b336dec" class="k">this</a>.<a href="#7f1485a08eb97fcc" class="i property">Splatted</a> = <span class="r1040 r">splatted</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a variable reference from a token.  Used from the parser.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7703a30c5cc584b7" href="../../R/7703a30c5cc584b7.html" target="n" data-glyph="74,1" class="t constructor">VariableExpressionAst</a>(<a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a> <span id="r1041 rd" class="r1041 r">token</span>)
            : <a href="#aead8965a3ad2e1e" class="k">this</a>(<span class="r1041 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r1041 r">token</span>.<a href="token.cs.html#d5a3911ea8b02b43" class="i property">VariablePath</a>, (<span class="r1041 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4fc017e5ff76f173" class="i field">SplattedVariable</a>))
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a variable reference with an existing VariablePath (rather than construct a new one.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1042 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1043 r">variablePath</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>)]
        <b>public</b> <a id="aead8965a3ad2e1e" href="../../R/aead8965a3ad2e1e.html" target="n" data-glyph="72,1" class="t constructor">VariableExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1042 rd" class="r1042 r">extent</span>, <a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r1043 rd" class="r1043 r">variablePath</span>, <b>bool</b> <span id="r1044 rd" class="r1044 r">splatted</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1042 r">extent</span>)
        {
            <b>if</b> (<span class="r1043 r">variablePath</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1043 r">variablePath</span>));
            }
 
            <a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a> = <span class="r1043 r">variablePath</span>;
            <a href="#248562b22b336dec" class="k">this</a>.<a href="#7f1485a08eb97fcc" class="i property">Splatted</a> = <span class="r1044 r">splatted</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <a id="d094d170ef781837" href="../../R/d094d170ef781837.html" target="n" data-glyph="102,1" class="i property">VariablePath</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if splatting syntax was used, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>)]
        <b>public bool</b> <a id="7f1485a08eb97fcc" href="../../R/7f1485a08eb97fcc.html" target="n" data-glyph="102,1" class="i property">Splatted</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the variable is one of $true, $false and $null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if it is a constant variable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="1f31fa8ef6d4e586" href="../../R/1f31fa8ef6d4e586.html" target="n" data-glyph="72,1" class="i method">IsConstantVariable</a>()
        {
            <b>if</b> (<a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a>)
            {
                <b>string</b> <span id="r1045 rd" class="r1045 r">name</span> = <a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>;
                <b>if</b> (<span class="r1045 r">name</span>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#bc3a5c92bd98b407" class="i field">True</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                    <span class="r1045 r">name</span>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#0d63e40a08074c09" class="i field">False</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                    <span class="r1045 r">name</span>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#d67486c961066178" class="i field">Null</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the VariableExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="0605a55615ca0143" href="../../R/0605a55615ca0143.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#aead8965a3ad2e1e" class="t constructor">VariableExpressionAst</a>(<a href="#248562b22b336dec" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>, <a href="#248562b22b336dec" class="k">this</a>.<a href="#7f1485a08eb97fcc" class="i property">Splatted</a>);
        }
 
        <b>internal bool</b> <a id="72f62de88f6f2378" href="../../R/72f62de88f6f2378.html" target="n" data-glyph="74,1" class="i method">IsSafeVariableReference</a>(<span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r1046 rd" class="r1046 r">validVariables</span>, <b>ref bool</b> <span id="r1047 rd" class="r1047 r">usesParameter</span>)
        {
            <b>bool</b> <span id="r1048 rd" class="r1048 r">ok</span> = <b>false</b>;
 
            <b>if</b> (<a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="VariableAnalysis.cs.html#e3b11791a094c005" class="i method">IsAnyLocal</a>())
            {
                <b>var</b> <span id="r1049 rd" class="r1049 r">varName</span> = <a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>;
                <b>if</b> (((<span class="r1046 r">validVariables</span> != <b>null</b>) &amp;&amp; <span class="r1046 r">validVariables</span>.<span class="i">Contains</span>(<span class="r1049 r">varName</span>)) ||
                    <span class="r1049 r">varName</span>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#114eb154e0b62af0" class="i field">Args</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r1048 r">ok</span> = <b>true</b>;
                    <span class="r1047 r">usesParameter</span> = <b>true</b>;
                }
                <b>else</b>
                {
                    <span class="r1048 r">ok</span> = !<a href="#248562b22b336dec" class="k">this</a>.<a href="#7f1485a08eb97fcc" class="i property">Splatted</a>
                         &amp;&amp; <a href="#248562b22b336dec" class="k">this</a>.<a href="#1f31fa8ef6d4e586" class="i method">IsConstantVariable</a>();
                }
            }
 
            <b>return</b> <span class="r1048 r">ok</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="499f314a461dd3be" href="../../R/499f314a461dd3be.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1050 rd" class="r1050 r">visitor</span>)
        {
            <b>return</b> <span class="r1050 r">visitor</span>.<a href="AstVisitor.cs.html#707fd0f879c30409" class="i method">VisitVariableExpression</a>(<a href="#248562b22b336dec" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f6111212a2587de2" href="../../R/f6111212a2587de2.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1051 rd" class="r1051 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1052 rd" class="r1052 r">action</span> = <span class="r1051 r">visitor</span>.<a href="PreOrderVisitor.cs.html#41a4cdb02cc112b2" class="i method">VisitVariableExpression</a>(<a href="#248562b22b336dec" class="k">this</a>);
            <b>return</b> <span class="r1051 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#248562b22b336dec" class="k">this</a>, (<span class="r1052 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> ? <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> : <span class="r1052 r">action</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Code Generation Details
 
        <b>internal int</b> <a id="d2fd06bce4ae1ac6" href="../../R/d2fd06bce4ae1ac6.html" target="n" data-glyph="104,1" class="i property">TupleIndex</a> { <b>get</b>; <b>set</b>; } = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#6aefafdf223b7beb" class="i field">Unanalyzed</a>;
 
        <b>internal bool</b> <a id="9290d5785ce9caf6" href="../../R/9290d5785ce9caf6.html" target="n" data-glyph="104,1" class="i property">Automatic</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="b89fc366bed34f46" href="../../R/b89fc366bed34f46.html" target="n" data-glyph="104,1" class="i property">Assigned</a> { <b>get</b>; <b>set</b>; }
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <b>return</b> <a href="#248562b22b336dec" class="k">this</a>;
        }
 
        <span class="i">Expression</span> <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a>.<a id="ecb70276c1d725f4" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetValue</a>(<a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r1053 rd" class="r1053 r">compiler</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r1054 rd" class="r1054 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r1055 rd" class="r1055 r">temps</span>)
        {
            <b>return</b> (<span class="i">Expression</span>)<span class="r1053 r">compiler</span>.<a href="Compiler.cs.html#a09bf19f91a25276" class="i method">VisitVariableExpression</a>(<a href="#248562b22b336dec" class="k">this</a>);
        }
 
        <span class="i">Expression</span> <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a>.<a href="#e85a96ce4e1c229b" class="i method">SetValue</a>(<a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r1056 rd" class="r1056 r">compiler</span>, <span class="i">Expression</span> <span id="r1057 rd" class="r1057 r">rhs</span>)
        {
            <b>if</b> (<a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a> &amp;&amp; <a href="#248562b22b336dec" class="k">this</a>.<a href="#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#d67486c961066178" class="i field">Null</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <span class="r1057 r">rhs</span>;
            }
 
            <span class="i">IEnumerable</span>&lt;<span class="i">PropertyInfo</span>&gt; <span id="r1058 rd" class="r1058 r">tupleAccessPath</span>;
            <b>bool</b> <span id="r1059 rd" class="r1059 r">localInTuple</span>;
            <span class="i">Type</span> <span id="r1060 rd" class="r1060 r">targetType</span> = <a href="#66a67f0fdaef4b7f" class="i method">GetVariableType</a>(<span class="r1056 r">compiler</span>, <b>out</b> <span class="r1058 r">tupleAccessPath</span>, <b>out</b> <span class="r1059 r">localInTuple</span>);
 
            <span class="c">// Value types must be copied on assignment (if they are mutable), boxed or not.  This preserves language</span>
            <span class="c">// semantics from V1/V2, and might be slightly more natural for a dynamic language.</span>
            <span class="c">// To generate good code, we assume any object or PSObject could be a boxed value type, and generate a dynamic</span>
            <span class="c">// site to handle copying as necessary.  Given this assumption, here are the possibilities:</span>
            <span class="c">//</span>
            <span class="c">//     - rhs is reference type</span>
            <span class="c">//         * just convert to lhs type</span>
            <span class="c">//     - rhs is value type</span>
            <span class="c">//         * lhs type is value type, copy made by simple assignment</span>
            <span class="c">//         * lhs type is object, copy is made by boxing, also handled in simple assignment</span>
            <span class="c">//     - rhs is boxed value type</span>
            <span class="c">//         * lhs type is value type, copy is made by unboxing conversion</span>
            <span class="c">//         * lhs type is object/psobject, copy must be made dynamically (boxed value type can&#39;t be known statically)</span>
            <b>var</b> <span id="r1061 rd" class="r1061 r">rhsType</span> = <span class="r1057 r">rhs</span>.<span class="i">Type</span>;
            <b>if</b> (<span class="r1059 r">localInTuple</span> &amp;&amp;
                (<span class="r1060 r">targetType</span> == <b>typeof</b>(<b>object</b>) || <span class="r1060 r">targetType</span> == <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)) &amp;&amp;
                (<span class="r1061 r">rhsType</span> == <b>typeof</b>(<b>object</b>) || <span class="r1061 r">rhsType</span> == <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)))
            {
                <span class="r1057 r">rhs</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#0cc44259d9b27d72" class="t t">PSVariableAssignmentBinder</a>.<a href="../runtime/Binding/Binders.cs.html#db50495b4c0f96e6" class="i method">Get</a>(), <b>typeof</b>(<b>object</b>), <span class="r1057 r">rhs</span>);
            }
 
            <span class="r1057 r">rhs</span> = <span class="r1057 r">rhs</span>.<a href="Compiler.cs.html#623da12beb9db704" class="i method">Convert</a>(<span class="r1060 r">targetType</span>);
 
            <b>if</b> (!<span class="r1059 r">localInTuple</span>)
            {
                <b>return</b> <a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">CallSetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<a href="#d094d170ef781837" class="i property">VariablePath</a>), <span class="r1057 r">rhs</span>);
            }
 
            <span class="i">Expression</span> <span id="r1062 rd" class="r1062 r">lhs</span> = <span class="r1056 r">compiler</span>.<a href="Compiler.cs.html#60079b222ae29e0d" class="i property">LocalVariablesParameter</a>;
            <b>foreach</b> (<b>var</b> <span id="r1063 rd" class="r1063 r">property</span> <b>in</b> <span class="r1058 r">tupleAccessPath</span>)
            {
                <span class="r1062 r">lhs</span> = <span class="i">Expression</span>.<span class="i">Property</span>(<span class="r1062 r">lhs</span>, <span class="r1063 r">property</span>);
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r1062 r">lhs</span>, <span class="r1057 r">rhs</span>);
        }
 
        <b>internal</b> <span class="i">Type</span> <a id="66a67f0fdaef4b7f" href="../../R/66a67f0fdaef4b7f.html" target="n" data-glyph="74,1" class="i method">GetVariableType</a>(<a href="Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r1064 rd" class="r1064 r">compiler</span>, <b>out</b> <span class="i">IEnumerable</span>&lt;<span class="i">PropertyInfo</span>&gt; <span id="r1065 rd" class="r1065 r">tupleAccessPath</span>, <b>out bool</b> <span id="r1066 rd" class="r1066 r">localInTuple</span>)
        {
            <span class="i">Type</span> <span id="r1067 rd" class="r1067 r">targetType</span> = <b>null</b>;
            <span class="r1066 r">localInTuple</span> = <a href="#d2fd06bce4ae1ac6" class="i property">TupleIndex</a> &gt;= 0 &amp;&amp;
                                (<span class="r1064 r">compiler</span>.<a href="Compiler.cs.html#57ac2e55a5b17eb3" class="i property">Optimize</a> || <a href="#d2fd06bce4ae1ac6" class="i property">TupleIndex</a> &lt; (<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#d64e69972d70be92" class="i field">NumberOfAutomaticVariables</a>);
            <span class="r1065 r">tupleAccessPath</span> = <b>null</b>;
            <b>if</b> (<span class="r1066 r">localInTuple</span>)
            {
                <span class="r1065 r">tupleAccessPath</span> = <a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<a href="../runtime/MutableTuple.cs.html#7b3f5dc3830e707f" class="i method">GetAccessPath</a>(<span class="r1064 r">compiler</span>.<a href="Compiler.cs.html#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>, <a href="#d2fd06bce4ae1ac6" class="i property">TupleIndex</a>);
                <span class="r1067 r">targetType</span> = <span class="r1065 r">tupleAccessPath</span>.<span class="i">Last</span>().<span class="i">PropertyType</span>;
            }
            <b>else</b>
            {
                <span class="r1067 r">targetType</span> = <b>typeof</b>(<b>object</b>);
            }
 
            <b>return</b> <span class="r1067 r">targetType</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Code Generation Details
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast representing constant values, such as numbers.  Constant values mean truly constant, as in, the value is</span>
    <span class="c">///</span><span class="c"> always the same.  Expandable strings with variable references (e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">&quot;$val&quot;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">) or sub-expressions</span>
    <span class="c">///</span><span class="c"> (e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">&quot;$(1)&quot;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">) are not considered constant.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="ebd8ad798cde7861" href="../../R/ebd8ad798cde7861.html" target="n" data-glyph="0,0" class="t t">ConstantExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a constant expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1068 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the constant.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1069 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the constant.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1068 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="e66e5aa53121afdc" href="../../R/e66e5aa53121afdc.html" target="n" data-glyph="72,1" class="t constructor">ConstantExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1068 rd" class="r1068 r">extent</span>, <b>object</b> <span id="r1069 rd" class="r1069 r">value</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1068 r">extent</span>)
        {
            <a href="#ebd8ad798cde7861" class="k">this</a>.<a href="#8e2d2054af044253" class="i property">Value</a> = <span class="r1069 r">value</span>;
        }
 
        <b>internal</b> <a id="362090dc6e396bbc" href="../../R/362090dc6e396bbc.html" target="n" data-glyph="74,1" class="t constructor">ConstantExpressionAst</a>(<a href="token.cs.html#71038a309db9781f" class="t t">NumberToken</a> <span id="r1070 rd" class="r1070 r">token</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1070 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>)
        {
            <a href="#ebd8ad798cde7861" class="k">this</a>.<a href="#8e2d2054af044253" class="i property">Value</a> = <span class="r1070 r">token</span>.<a href="token.cs.html#e451e512705875f9" class="i property">Value</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the constant.  This property is null only if the expression represents the null constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="8e2d2054af044253" href="../../R/8e2d2054af044253.html" target="n" data-glyph="102,1" class="i property">Value</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ConstantExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="b96f36caca9b9cad" href="../../R/b96f36caca9b9cad.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#e66e5aa53121afdc" class="t constructor">ConstantExpressionAst</a>(<a href="#ebd8ad798cde7861" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#ebd8ad798cde7861" class="k">this</a>.<a href="#8e2d2054af044253" class="i property">Value</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The static type of a constant is whatever type the value is, or if null, then assume it&#39;s </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(object)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="499ea06e07fb9bb8" href="../../R/499ea06e07fb9bb8.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b> { <b>return</b> <a href="#8e2d2054af044253" class="i property">Value</a> != <b>null</b> ? <a href="#8e2d2054af044253" class="i property">Value</a>.<span class="i">GetType</span>() : <b>typeof</b>(<b>object</b>); }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="b768518e2e35aa9d" href="../../R/b768518e2e35aa9d.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1071 rd" class="r1071 r">visitor</span>)
        {
            <b>return</b> <span class="r1071 r">visitor</span>.<a href="AstVisitor.cs.html#eb0df3c990d2a34b" class="i method">VisitConstantExpression</a>(<a href="#ebd8ad798cde7861" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="34e67f8fc7ae287d" href="../../R/34e67f8fc7ae287d.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1072 rd" class="r1072 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1073 rd" class="r1073 r">action</span> = <span class="r1072 r">visitor</span>.<a href="PreOrderVisitor.cs.html#c04fefcb412c14c3" class="i method">VisitConstantExpression</a>(<a href="#ebd8ad798cde7861" class="k">this</a>);
            <b>return</b> <span class="r1072 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#ebd8ad798cde7861" class="k">this</a>, (<span class="r1073 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> ? <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> : <span class="r1073 r">action</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The kind of string constant.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="9280da14e6db65ed" href="../../R/9280da14e6db65ed.html" target="n" data-glyph="18,0" class="t t"><span id="df1c65a60a0f6d52">StringConstantType</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string enclosed in single quotes, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">&#39;some text&#39;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9cd69ce5e01bdb24" href="../../R/9cd69ce5e01bdb24.html" target="n" data-glyph="24,1" class="i field">SingleQuoted</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A here string enclosed in single quotes, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> @&#39;</span>
        <span class="c">///</span><span class="c"> a here string</span>
        <span class="c">///</span><span class="c"> &#39;@</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4842ba317017d613" href="../../R/4842ba317017d613.html" target="n" data-glyph="24,1" class="i field">SingleQuotedHereString</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string enclosed in double quotes, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">&quot;some text&quot;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f67f871ab7fadb8a" href="../../R/f67f871ab7fadb8a.html" target="n" data-glyph="24,1" class="i field">DoubleQuoted</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A here string enclosed in double quotes, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> @&quot;</span>
        <span class="c">///</span><span class="c"> a here string</span>
        <span class="c">///</span><span class="c"> &quot;@</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7d8b29b78e0d555b" href="../../R/7d8b29b78e0d555b.html" target="n" data-glyph="24,1" class="i field">DoubleQuotedHereString</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string like token not enclosed in any quotes.  This usually includes a command name or command argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7902d7b060b16556" href="../../R/7902d7b060b16556.html" target="n" data-glyph="24,1" class="i field">BareWord</a>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a constant string expression that is always constant.  This includes both single and</span>
    <span class="c">///</span><span class="c"> double quoted strings, but the double quoted strings will not be scanned for variable references and sub-expressions.</span>
    <span class="c">///</span><span class="c"> If expansion of the string is required, use </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="e18e1bad255cd022" href="../../R/e18e1bad255cd022.html" target="n" data-glyph="0,0" class="t t">StringConstantExpressionAst</a> : <a href="#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a string constant expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1074 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the string constant, including quotes.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1075 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1076 r">stringConstantType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1074 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1075 r">value</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="9347f3b86ace4042" href="../../R/9347f3b86ace4042.html" target="n" data-glyph="72,1" class="t constructor">StringConstantExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1074 rd" class="r1074 r">extent</span>, <b>string</b> <span id="r1075 rd" class="r1075 r">value</span>, <a href="#9280da14e6db65ed" class="t t">StringConstantType</a> <span id="r1076 rd" class="r1076 r">stringConstantType</span>)
            : <a href="#e66e5aa53121afdc" class="k">base</a>(<span class="r1074 r">extent</span>, <span class="r1075 r">value</span>)
        {
            <b>if</b> (<span class="r1075 r">value</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1075 r">value</span>));
            }
 
            <a href="#e18e1bad255cd022" class="k">this</a>.<a href="#de305f3ed8002148" class="i property">StringConstantType</a> = <span class="r1076 r">stringConstantType</span>;
        }
 
        <b>internal</b> <a id="e7861490ceaad5be" href="../../R/e7861490ceaad5be.html" target="n" data-glyph="74,1" class="t constructor">StringConstantExpressionAst</a>(<a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a> <span id="r1077 rd" class="r1077 r">token</span>)
            : <a href="#e66e5aa53121afdc" class="k">base</a>(<span class="r1077 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r1077 r">token</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>)
        {
            <a href="#e18e1bad255cd022" class="k">this</a>.<a href="#de305f3ed8002148" class="i property">StringConstantType</a> = <a href="#c4649561a47453b5" class="i method">MapTokenKindToStringConstantKind</a>(<span class="r1077 r">token</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type of string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a> <a id="de305f3ed8002148" href="../../R/de305f3ed8002148.html" target="n" data-glyph="102,1" class="i property">StringConstantType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the string, not including the quotes used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <b>new</b> <b>string</b> <a id="a6dc72732a1c7e0d" href="../../R/a6dc72732a1c7e0d.html" target="n" data-glyph="102,1" class="i property">Value</a> { <b>get</b> { <b>return</b> (<b>string</b>)<a href="#ebd8ad798cde7861" class="k">base</a>.<a href="#8e2d2054af044253" class="i property">Value</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the StringConstantExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="64e82c1e30b3274e" href="../../R/64e82c1e30b3274e.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<a href="#e18e1bad255cd022" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#e18e1bad255cd022" class="k">this</a>.<a href="#a6dc72732a1c7e0d" class="i property">Value</a>, <a href="#e18e1bad255cd022" class="k">this</a>.<a href="#de305f3ed8002148" class="i property">StringConstantType</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type of a StringConstantExpressionAst is always </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(string)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="89ef8c242e126fbc" href="../../R/89ef8c242e126fbc.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b> { <b>return</b> <b>typeof</b>(<b>string</b>); }
        }
 
        <b>internal static</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a> <a id="c4649561a47453b5" href="../../R/c4649561a47453b5.html" target="n" data-glyph="74,1" class="i method">MapTokenKindToStringConstantKind</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r1078 rd" class="r1078 r">token</span>)
        {
            <b>switch</b> (<span class="r1078 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4e0d26e8d7050abc" class="i field">StringExpandable</a>:
                    <b>return</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#f67f871ab7fadb8a" class="i field">DoubleQuoted</a>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a6a2bdb661c2a296" class="i field">HereStringLiteral</a>:
                    <b>return</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#4842ba317017d613" class="i field">SingleQuotedHereString</a>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b3843759239f0c51" class="i field">HereStringExpandable</a>:
                    <b>return</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7d8b29b78e0d555b" class="i field">DoubleQuotedHereString</a>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0c560abdae080116" class="i field">StringLiteral</a>:
                    <b>return</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#9cd69ce5e01bdb24" class="i field">SingleQuoted</a>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>:
                    <b>return</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>;
            }
 
            <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="2fd93ad59d8cd8e7" href="../../R/2fd93ad59d8cd8e7.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1079 rd" class="r1079 r">visitor</span>)
        {
            <b>return</b> <span class="r1079 r">visitor</span>.<a href="AstVisitor.cs.html#9934f82893f92bca" class="i method">VisitStringConstantExpression</a>(<a href="#e18e1bad255cd022" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="0c46d9356ff6a000" href="../../R/0c46d9356ff6a000.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1080 rd" class="r1080 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1081 rd" class="r1081 r">action</span> = <span class="r1080 r">visitor</span>.<a href="PreOrderVisitor.cs.html#451063e4cfbd6a05" class="i method">VisitStringConstantExpression</a>(<a href="#e18e1bad255cd022" class="k">this</a>);
            <b>return</b> <span class="r1080 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#e18e1bad255cd022" class="k">this</a>, (<span class="r1081 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> ? <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> : <span class="r1081 r">action</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a double quoted string (here string or normal string) and can have nested variable</span>
    <span class="c">///</span><span class="c"> references or sub-expressions, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">&quot;Name: $name`nAge: $([DateTime]::Now.Year - $dob.Year)&quot;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="dac25e1530bb8b85" href="../../R/dac25e1530bb8b85.html" target="n" data-glyph="0,0" class="t t">ExpandableStringExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an expandable string.  The value is scanned for nested variable references and expressions</span>
        <span class="c">///</span><span class="c"> which are evaluated at runtime when this ast is compiled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1082 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1083 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The unexpanded value of the string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1084 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The kind of string, must be one of</span><span class="c">&lt;</span><span class="c">list</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#f67f871ab7fadb8a" class="i field">DoubleQuoted</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7d8b29b78e0d555b" class="i field">DoubleQuotedHereString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">list</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1083 r">value</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1082 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="d7e6f61cb7780810" href="../../R/d7e6f61cb7780810.html" target="n" data-glyph="72,1" class="t constructor">ExpandableStringExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1082 rd" class="r1082 r">extent</span>,
                                             <b>string</b> <span id="r1083 rd" class="r1083 r">value</span>,
                                             <a href="#9280da14e6db65ed" class="t t">StringConstantType</a> <span id="r1084 rd" class="r1084 r">type</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1082 r">extent</span>)
        {
            <b>if</b> (<span class="r1083 r">value</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1083 r">value</span>));
            }
 
            <b>if</b> (<span class="r1084 r">type</span> != <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#f67f871ab7fadb8a" class="i field">DoubleQuoted</a> &amp;&amp; <span class="r1084 r">type</span> != <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7d8b29b78e0d555b" class="i field">DoubleQuotedHereString</a>
                &amp;&amp; <span class="r1084 r">type</span> != <a href="#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="#7902d7b060b16556" class="i field">BareWord</a>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r1084 r">type</span>));
            }
 
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r1085 rd" class="r1085 r">ast</span> = <span class="i n">Language</span>.<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="Parser.cs.html#e08021455ac48035" class="i method">ScanString</a>(<span class="r1083 r">value</span>);
            <a href="#dac25e1530bb8b85" class="k">var</a> <span id="r1086 rd" class="r1086 r">expandableStringAst</span> = <span class="r1085 r">ast</span> <b>as</b> <a href="#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a>;
            <b>if</b> (<span class="r1086 r">expandableStringAst</span> != <b>null</b>)
            {
                <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#b2f43eb7778a1d9a" class="i property">FormatExpression</a> = <span class="r1086 r">expandableStringAst</span>.<a href="#b2f43eb7778a1d9a" class="i property">FormatExpression</a>;
                <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a> = <span class="r1086 r">expandableStringAst</span>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a>;
            }
            <b>else</b>
            {
                <span class="c">// We always compile to a format expression.  In the rare case that some external code (this can&#39;t happen</span>
                <span class="c">// internally) passes in a string that doesn&#39;t require any expansion, we still need to generate code that</span>
                <span class="c">// works.  This is slow as the ast is a string constant, but it should be rare.</span>
                <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#b2f43eb7778a1d9a" class="i property">FormatExpression</a> = <span class="s">&quot;{0}&quot;</span>;
                <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;(<b>new</b>[] { <span class="r1085 r">ast</span> });
            }
 
            <span class="c">// Set parents properly</span>
            <b>for</b> (<b>int</b> <span id="r1087 rd" class="r1087 r">i</span> = 0; <span class="r1087 r">i</span> &lt; <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a>.<span class="i">Count</span>; <span class="r1087 r">i</span>++)
            {
                <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a>[<span class="r1087 r">i</span>].<span class="i">ClearParent</span>();
            }
 
            <span class="i">SetParents</span>(<a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a>);
 
            <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#969f667812636ecf" class="i property">Value</a> = <span class="r1083 r">value</span>;
            <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#65d512276737c07d" class="i property">StringConstantType</a> = <span class="r1084 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an expandable string expression from a string token.  Used from the parser after parsing</span>
        <span class="c">///</span><span class="c"> the nested tokens.  This method is internal mainly so we can avoid validating </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1088 r">formatString</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6e53fa4ec9fc01e3" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ExpandableStringExpressionAst</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r1089 rd" class="r1089 r">token</span>, <b>string</b> <span id="r1090 rd" class="r1090 r">value</span>, <b>string</b> <span id="r1088 rd" class="r1088 r">formatString</span>, <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r1091 rd" class="r1091 r">nestedExpressions</span>)
            : <a href="#86907c7e1900ef47" class="k">this</a>(<span class="r1089 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r1090 r">value</span>, <span class="r1088 r">formatString</span>,
                   <a href="#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>
                        .<a href="#c4649561a47453b5" class="i method">MapTokenKindToStringConstantKind</a>(<span class="r1089 r">token</span>),
                   <span class="r1091 r">nestedExpressions</span>)
        {
        }
 
        <b>private</b> <a id="86907c7e1900ef47" href="../../R/86907c7e1900ef47.html" target="n" data-glyph="76,1" class="t constructor">ExpandableStringExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1092 rd" class="r1092 r">extent</span>, <b>string</b> <span id="r1093 rd" class="r1093 r">value</span>, <b>string</b> <span id="r1094 rd" class="r1094 r">formatString</span>,
                                              <a href="#9280da14e6db65ed" class="t t">StringConstantType</a> <span id="r1095 rd" class="r1095 r">type</span>, <span class="i">IEnumerable</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r1096 rd" class="r1096 r">nestedExpressions</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1092 r">extent</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r1096 r">nestedExpressions</span> != <b>null</b> &amp;&amp; <span class="r1096 r">nestedExpressions</span>.<span class="i">Any</span>(), <span class="s">&quot;Must specify non-empty expressions.&quot;</span>);
 
            <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#b2f43eb7778a1d9a" class="i property">FormatExpression</a> = <span class="r1094 r">formatString</span>;
            <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#969f667812636ecf" class="i property">Value</a> = <span class="r1093 r">value</span>;
            <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#65d512276737c07d" class="i property">StringConstantType</a> = <span class="r1095 r">type</span>;
            <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;(<span class="r1096 r">nestedExpressions</span>.<span class="i">ToArray</span>());
            <span class="i">SetParents</span>(<a href="#7a52821c53f08528" class="i property">NestedExpressions</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of string, not including the quote characters and without any variables replaced.</span>
        <span class="c">///</span><span class="c"> This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="969f667812636ecf" href="../../R/969f667812636ecf.html" target="n" data-glyph="102,1" class="i property">Value</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type of string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#9280da14e6db65ed" class="t t">StringConstantType</a> <a id="65d512276737c07d" href="../../R/65d512276737c07d.html" target="n" data-glyph="102,1" class="i property">StringConstantType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A non-empty collection of expressions contained within the string.  The nested expressions are always either</span>
        <span class="c">///</span><span class="c"> instances of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#248562b22b336dec" class="t t">VariableExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e6552a77ab32112a" class="t t">SubExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="7a52821c53f08528" href="../../R/7a52821c53f08528.html" target="n" data-glyph="102,1" class="i property">NestedExpressions</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ExpandableStringExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="ef3a2f100a687503" href="../../R/ef3a2f100a687503.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r1097 rd" class="r1097 r">newNestedExpressions</span> = <span class="i">CopyElements</span>(<a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#7a52821c53f08528" class="i property">NestedExpressions</a>);
            <b>return</b> <b>new</b> <span class="t">ExpandableStringExpressionAst</span>(<a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#969f667812636ecf" class="i property">Value</a>, <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#b2f43eb7778a1d9a" class="i property">FormatExpression</a>, <a href="#dac25e1530bb8b85" class="k">this</a>.<a href="#65d512276737c07d" class="i property">StringConstantType</a>, <span class="r1097 r">newNestedExpressions</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type of a StringConstantExpressionAst is always </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(string)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="76fe2bf788a7a29b" href="../../R/76fe2bf788a7a29b.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b> { <b>return</b> <b>typeof</b>(<b>string</b>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format expression needed to execute this ast.  It is generated by the scanner, it is not provided by clients.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="b2f43eb7778a1d9a" href="../../R/b2f43eb7778a1d9a.html" target="n" data-glyph="104,1" class="i property">FormatExpression</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="ecb7eb56e7034e48" href="../../R/ecb7eb56e7034e48.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1098 rd" class="r1098 r">visitor</span>)
        {
            <b>return</b> <span class="r1098 r">visitor</span>.<a href="AstVisitor.cs.html#b26af0b9640bcff4" class="i method">VisitExpandableStringExpression</a>(<a href="#dac25e1530bb8b85" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1e929ee94799ab8f" href="../../R/1e929ee94799ab8f.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1099 rd" class="r1099 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1100 rd" class="r1100 r">action</span> = <span class="r1099 r">visitor</span>.<a href="PreOrderVisitor.cs.html#cf46bd0deec79306" class="i method">VisitExpandableStringExpression</a>(<a href="#dac25e1530bb8b85" class="k">this</a>);
            <b>if</b> (<span class="r1100 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1099 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#dac25e1530bb8b85" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1100 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> &amp;&amp; <a href="#7a52821c53f08528" class="i property">NestedExpressions</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r1101 rd" class="r1101 r">index</span> = 0; <span class="r1101 r">index</span> &lt; <a href="#7a52821c53f08528" class="i property">NestedExpressions</a>.<span class="i">Count</span>; <span class="r1101 r">index</span>++)
                {
                    <b>var</b> <span id="r1102 rd" class="r1102 r">exprAst</span> = <a href="#7a52821c53f08528" class="i property">NestedExpressions</a>[<span class="r1101 r">index</span>];
                    <span class="r1100 r">action</span> = <span class="r1102 r">exprAst</span>.<span class="i">InternalVisit</span>(<span class="r1099 r">visitor</span>);
                    <b>if</b> (<span class="r1100 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r1099 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#dac25e1530bb8b85" class="k">this</a>, <span class="r1100 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an anonymous script block expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">{ dir }</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="5ec0737db546f4f5" href="../../R/5ec0737db546f4f5.html" target="n" data-glyph="0,0" class="t t">ScriptBlockExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a script block expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1103 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the script block, from the opening curly brace to the closing curly brace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1104 r">scriptBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The script block.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1103 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1104 r">scriptBlock</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="dd24d41ff02dddc5" href="../../R/dd24d41ff02dddc5.html" target="n" data-glyph="72,1" class="t constructor">ScriptBlockExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1103 rd" class="r1103 r">extent</span>, <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r1104 rd" class="r1104 r">scriptBlock</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1103 r">extent</span>)
        {
            <b>if</b> (<span class="r1104 r">scriptBlock</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1104 r">scriptBlock</span>));
            }
 
            <a href="#5ec0737db546f4f5" class="k">this</a>.<a href="#3155915865e15c92" class="i property">ScriptBlock</a> = <span class="r1104 r">scriptBlock</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r1104 r">scriptBlock</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ast for the scriptblock that this ast represent.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="3155915865e15c92" href="../../R/3155915865e15c92.html" target="n" data-glyph="102,1" class="i property">ScriptBlock</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ScriptBlockExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="45f40c516effa091" href="../../R/45f40c516effa091.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#6f963589327835a4" class="k">var</a> <span id="r1105 rd" class="r1105 r">newScriptBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#5ec0737db546f4f5" class="k">this</a>.<a href="#3155915865e15c92" class="i property">ScriptBlock</a>);
            <b>return</b> <b>new</b> <a href="#dd24d41ff02dddc5" class="t constructor">ScriptBlockExpressionAst</a>(<a href="#5ec0737db546f4f5" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1105 r">newScriptBlock</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The result of a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is always </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#3155915865e15c92" class="i property">ScriptBlock</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="840694a2b59af863" href="../../R/840694a2b59af863.html" target="n" data-glyph="102,1" class="i property">StaticType</a>
        {
            <b>get</b> { <b>return</b> <b>typeof</b>(<a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>); }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="8ac554ad848f70c0" href="../../R/8ac554ad848f70c0.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1106 rd" class="r1106 r">visitor</span>)
        {
            <b>return</b> <span class="r1106 r">visitor</span>.<a href="AstVisitor.cs.html#863749d82bb0379f" class="i method">VisitScriptBlockExpression</a>(<a href="#5ec0737db546f4f5" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="c1cfb05d7c5cce33" href="../../R/c1cfb05d7c5cce33.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1107 rd" class="r1107 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1108 rd" class="r1108 r">action</span> = <span class="r1107 r">visitor</span>.<a href="PreOrderVisitor.cs.html#943c26e88de3ebbd" class="i method">VisitScriptBlockExpression</a>(<a href="#5ec0737db546f4f5" class="k">this</a>);
            <b>if</b> (<span class="r1108 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1107 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#5ec0737db546f4f5" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1108 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r1108 r">action</span> = <a href="#3155915865e15c92" class="i property">ScriptBlock</a>.<a href="#360723934e684b68" class="i method">InternalVisit</a>(<span class="r1107 r">visitor</span>);
            <b>return</b> <span class="r1107 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#5ec0737db546f4f5" class="k">this</a>, <span class="r1108 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an array literal expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">1,2,3</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.  An array expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">@(dir)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> is represented by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#6bb067a9fcfafabf" class="t t">ArrayExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.  An array literal expression can be constructed from a single</span>
    <span class="c">///</span><span class="c"> element, as happens with the unary comma operator, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">,4</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="0e44bc9125134006" href="../../R/0e44bc9125134006.html" target="n" data-glyph="0,0" class="t t">ArrayLiteralAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an array literal expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1109 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of all of the elements.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1110 r">elements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The collection of asts that represent the array literal.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1109 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1110 r">elements</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or is an empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="ed734b087837d213" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ArrayLiteralAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1109 rd" class="r1109 r">extent</span>, <span class="i">IList</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r1110 rd" class="r1110 r">elements</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1109 r">extent</span>)
        {
            <b>if</b> (<span class="r1110 r">elements</span> == <b>null</b> || <span class="r1110 r">elements</span>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r1110 r">elements</span>));
            }
 
            <a href="#0e44bc9125134006" class="k">this</a>.<a href="#1b2cdef74794d8b9" class="i property">Elements</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;(<span class="r1110 r">elements</span>);
            <span class="i">SetParents</span>(<a href="#1b2cdef74794d8b9" class="i property">Elements</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The non-empty collection of asts of the elements of the array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="1b2cdef74794d8b9" href="../../R/1b2cdef74794d8b9.html" target="n" data-glyph="102,1" class="i property">Elements</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ArrayLiteralAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="4e7b3ca376279f6f" href="../../R/4e7b3ca376279f6f.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <b>var</b> <span id="r1111 rd" class="r1111 r">newElements</span> = <span class="i">CopyElements</span>(<a href="#0e44bc9125134006" class="k">this</a>.<a href="#1b2cdef74794d8b9" class="i property">Elements</a>);
            <b>return</b> <b>new</b> <span class="t">ArrayLiteralAst</span>(<a href="#0e44bc9125134006" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1111 r">newElements</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The result of an </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0e44bc9125134006" class="t t">ArrayLiteralAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is always </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(object[])</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="af9b657e5f02a255" href="../../R/af9b657e5f02a255.html" target="n" data-glyph="102,1" class="i property">StaticType</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<b>object</b>[]); } }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="5de36d40233a3c2f" href="../../R/5de36d40233a3c2f.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1112 rd" class="r1112 r">visitor</span>)
        {
            <b>return</b> <span class="r1112 r">visitor</span>.<a href="AstVisitor.cs.html#b8a617326d852d0a" class="i method">VisitArrayLiteral</a>(<a href="#0e44bc9125134006" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1c9261a0dac61940" href="../../R/1c9261a0dac61940.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1113 rd" class="r1113 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1114 rd" class="r1114 r">action</span> = <span class="r1113 r">visitor</span>.<a href="PreOrderVisitor.cs.html#1487059713069a69" class="i method">VisitArrayLiteral</a>(<a href="#0e44bc9125134006" class="k">this</a>);
            <b>if</b> (<span class="r1114 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1113 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#0e44bc9125134006" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1114 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r1115 rd" class="r1115 r">index</span> = 0; <span class="r1115 r">index</span> &lt; <a href="#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>; <span class="r1115 r">index</span>++)
                {
                    <b>var</b> <span id="r1116 rd" class="r1116 r">element</span> = <a href="#1b2cdef74794d8b9" class="i property">Elements</a>[<span class="r1115 r">index</span>];
                    <span class="r1114 r">action</span> = <span class="r1116 r">element</span>.<span class="i">InternalVisit</span>(<span class="r1113 r">visitor</span>);
                    <b>if</b> (<span class="r1114 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r1113 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#0e44bc9125134006" class="k">this</a>, <span class="r1114 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <b>return</b> <b>new</b> <span class="t">ArrayAssignableValue</span> { <a href="Compiler.cs.html#bc5abcb4f50e2342" class="i property">ArrayLiteral</a> = <a href="#0e44bc9125134006" class="k">this</a> };
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a hash literal, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">@{a = 1}</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="fd6e450f68cfd52b" href="../../R/fd6e450f68cfd52b.html" target="n" data-glyph="0,0" class="t t">HashtableAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <b>private static readonly</b> <span class="i">ReadOnlyCollection</span>&lt;<span class="i">KeyValuePair</span>&gt; <a id="ac168ca62be4e96d" href="../../R/ac168ca62be4e96d.html" target="n" data-glyph="46,1" class="i field">s_emptyKeyValuePairs</a> = <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<span class="i">KeyValuePair</span>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a hash literal ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1117 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the literal, from &#39;@{&#39; to the closing &#39;}&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1118 r">keyValuePairs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The optionally null or empty list of key/value pairs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1117 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1006:DoNotNestGenericTypesInMemberSignatures&quot;</span>)]
        <b>public</b> <a id="db319c52cbe31c66" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">HashtableAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1117 rd" class="r1117 r">extent</span>, <span class="i">IEnumerable</span>&lt;<span class="i">KeyValuePair</span>&gt; <span id="r1118 rd" class="r1118 r">keyValuePairs</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1117 r">extent</span>)
        {
            <b>if</b> (<span class="r1118 r">keyValuePairs</span> != <b>null</b>)
            {
                <a href="#fd6e450f68cfd52b" class="k">this</a>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<span class="i">KeyValuePair</span>&gt;(<span class="r1118 r">keyValuePairs</span>.<span class="i">ToArray</span>());
                <span class="i">SetParents</span>(<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>);
            }
            <b>else</b>
            {
                <a href="#fd6e450f68cfd52b" class="k">this</a>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a> = <a href="#ac168ca62be4e96d" class="i field">s_emptyKeyValuePairs</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pairs of key names and asts for values used to construct the hash table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1006:DoNotNestGenericTypesInMemberSignatures&quot;</span>)]
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<span class="i">KeyValuePair</span>&gt; <a id="87313f35bc2b66d9" href="../../R/87313f35bc2b66d9.html" target="n" data-glyph="102,1" class="i property">KeyValuePairs</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the HashtableAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="8bc8e3826317f072" href="../../R/8bc8e3826317f072.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <span class="i">List</span>&lt;<span class="i">KeyValuePair</span>&gt; <span id="r1119 rd" class="r1119 r">newKeyValuePairs</span> = <b>null</b>;
            <b>if</b> (<a href="#fd6e450f68cfd52b" class="k">this</a>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r1119 r">newKeyValuePairs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">KeyValuePair</span>&gt;(<a href="#fd6e450f68cfd52b" class="k">this</a>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>.<span class="i">Count</span>);
                <b>for</b> (<b>int</b> <span id="r1120 rd" class="r1120 r">i</span> = 0; <span class="r1120 r">i</span> &lt; <a href="#fd6e450f68cfd52b" class="k">this</a>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>.<span class="i">Count</span>; <span class="r1120 r">i</span>++)
                {
                    <b>var</b> <span id="r1121 rd" class="r1121 r">keyValuePair</span> = <a href="#fd6e450f68cfd52b" class="k">this</a>.<a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>[<span class="r1120 r">i</span>];
                    <span class="r27 r t">var</span> <span id="r1122 rd" class="r1122 r">newKey</span> = <span class="i">CopyElement</span>(<span class="r1121 r">keyValuePair</span>.<span class="i">Item1</span>);
                    <span class="r27 r t">var</span> <span id="r1123 rd" class="r1123 r">newValue</span> = <span class="i">CopyElement</span>(<span class="r1121 r">keyValuePair</span>.<span class="i">Item2</span>);
                    <span class="r1119 r">newKeyValuePairs</span>.<span class="i">Add</span>(<span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r1122 r">newKey</span>, <span class="r1123 r">newValue</span>));
                }
            }
 
            <b>return</b> <b>new</b> <span class="t">HashtableAst</span>(<a href="#fd6e450f68cfd52b" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1119 r">newKeyValuePairs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The result type of a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#fd6e450f68cfd52b" class="t t">HashtableAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is always </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Hashtable</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="cb3d9cb53c195291" href="../../R/cb3d9cb53c195291.html" target="n" data-glyph="102,1" class="i property">StaticType</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<span class="i">Hashtable</span>); } }
 
        <span class="c">// Indicates that this ast was constructed as part of a schematized object instead of just a plain hash literal.</span>
        <b>internal bool</b> <a id="6706cae89a393ac3" href="../../R/6706cae89a393ac3.html" target="n" data-glyph="104,1" class="i property">IsSchemaElement</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="f49d00cbf126371c" href="../../R/f49d00cbf126371c.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1124 rd" class="r1124 r">visitor</span>)
        {
            <b>return</b> <span class="r1124 r">visitor</span>.<a href="AstVisitor.cs.html#b247b898e4c2e1f8" class="i method">VisitHashtable</a>(<a href="#fd6e450f68cfd52b" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f933d3e6dc2e3f98" href="../../R/f933d3e6dc2e3f98.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1125 rd" class="r1125 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1126 rd" class="r1126 r">action</span> = <span class="r1125 r">visitor</span>.<a href="PreOrderVisitor.cs.html#69aaff7850c10ed8" class="i method">VisitHashtable</a>(<a href="#fd6e450f68cfd52b" class="k">this</a>);
            <b>if</b> (<span class="r1126 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1125 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#fd6e450f68cfd52b" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1126 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
            {
                <b>for</b> (<b>int</b> <span id="r1127 rd" class="r1127 r">index</span> = 0; <span class="r1127 r">index</span> &lt; <a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>.<span class="i">Count</span>; <span class="r1127 r">index</span>++)
                {
                    <b>var</b> <span id="r1128 rd" class="r1128 r">keyValuePairAst</span> = <a href="#87313f35bc2b66d9" class="i property">KeyValuePairs</a>[<span class="r1127 r">index</span>];
                    <span class="r1126 r">action</span> = <span class="r1128 r">keyValuePairAst</span>.<span class="i">Item1</span>.<span class="i">InternalVisit</span>(<span class="r1125 r">visitor</span>);
                    <b>if</b> (<span class="r1126 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                    <span class="r1126 r">action</span> = <span class="r1128 r">keyValuePairAst</span>.<span class="i">Item2</span>.<span class="i">InternalVisit</span>(<span class="r1125 r">visitor</span>);
                    <b>if</b> (<span class="r1126 r">action</span> != <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>) <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r1125 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#fd6e450f68cfd52b" class="k">this</a>, <span class="r1126 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an array expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">@(1)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.  The array literal (e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">1,2,3</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">) is</span>
    <span class="c">///</span><span class="c"> represented by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0e44bc9125134006" class="t t">ArrayLiteralAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="6bb067a9fcfafabf" href="../../R/6bb067a9fcfafabf.html" target="n" data-glyph="0,0" class="t t">ArrayExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an expression that forces the result to be an array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1129 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression, including the opening &#39;@(&#39; and closing &#39;)&#39;.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1130 r">statementBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The statements executed as part of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1129 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1130 r">statementBlock</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="af3aa3b81046afbd" href="../../R/af3aa3b81046afbd.html" target="n" data-glyph="72,1" class="t constructor">ArrayExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1129 rd" class="r1129 r">extent</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r1130 rd" class="r1130 r">statementBlock</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1129 r">extent</span>)
        {
            <b>if</b> (<span class="r1130 r">statementBlock</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1130 r">statementBlock</span>));
            }
 
            <a href="#6bb067a9fcfafabf" class="k">this</a>.<a href="#ccfc39397cd3e8e5" class="i property">SubExpression</a> = <span class="r1130 r">statementBlock</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r1130 r">statementBlock</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression/statements represented by this sub-expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="ccfc39397cd3e8e5" href="../../R/ccfc39397cd3e8e5.html" target="n" data-glyph="102,1" class="i property">SubExpression</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ArrayExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="6b86cc3392ddc3df" href="../../R/6b86cc3392ddc3df.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#268644c84b225866" class="k">var</a> <span id="r1131 rd" class="r1131 r">newStatementBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#6bb067a9fcfafabf" class="k">this</a>.<a href="#ccfc39397cd3e8e5" class="i property">SubExpression</a>);
            <b>return</b> <b>new</b> <a href="#af3aa3b81046afbd" class="t constructor">ArrayExpressionAst</a>(<a href="#6bb067a9fcfafabf" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1131 r">newStatementBlock</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The result of an ArrayExpressionAst is always </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">typeof(object[])</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Type</span> <a id="84e920a13840f3d2" href="../../R/84e920a13840f3d2.html" target="n" data-glyph="102,1" class="i property">StaticType</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<b>object</b>[]); } }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="b82aba4d947c9a1d" href="../../R/b82aba4d947c9a1d.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1132 rd" class="r1132 r">visitor</span>)
        {
            <b>return</b> <span class="r1132 r">visitor</span>.<a href="AstVisitor.cs.html#ac2bf2bb0dd8aac6" class="i method">VisitArrayExpression</a>(<a href="#6bb067a9fcfafabf" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="a439c4876457e54d" href="../../R/a439c4876457e54d.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1133 rd" class="r1133 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1134 rd" class="r1134 r">action</span> = <span class="r1133 r">visitor</span>.<a href="PreOrderVisitor.cs.html#ce0da16601fd23ae" class="i method">VisitArrayExpression</a>(<a href="#6bb067a9fcfafabf" class="k">this</a>);
            <b>if</b> (<span class="r1134 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1133 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#6bb067a9fcfafabf" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1134 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r1134 r">action</span> = <a href="#ccfc39397cd3e8e5" class="i property">SubExpression</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r1133 r">visitor</span>);
            <b>return</b> <span class="r1133 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#6bb067a9fcfafabf" class="k">this</a>, <span class="r1134 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an expression (or pipeline) that is enclosed in parentheses, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">(1)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">(dir)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Paren&quot;</span>)]
    <b>public class</b> <a id="a9797c05604b61e8" href="../../R/a9797c05604b61e8.html" target="n" data-glyph="0,0" class="t t">ParenExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a parenthesized expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1135 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression, including the opening and closing parentheses.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1136 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The pipeline (or expression) enclosed in parentheses.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1135 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1136 r">pipeline</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="e5300f124d1ef239" href="../../R/e5300f124d1ef239.html" target="n" data-glyph="72,1" class="t constructor">ParenExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1135 rd" class="r1135 r">extent</span>, <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r1136 rd" class="r1136 r">pipeline</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1135 r">extent</span>)
        {
            <b>if</b> (<span class="r1136 r">pipeline</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1136 r">pipeline</span>));
            }
 
            <a href="#a9797c05604b61e8" class="k">this</a>.<a href="#021e323175cb804d" class="i property">Pipeline</a> = <span class="r1136 r">pipeline</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r1136 r">pipeline</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline (which is frequently but not always an expression) for this parenthesized expression.</span>
        <span class="c">///</span><span class="c"> This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="021e323175cb804d" href="../../R/021e323175cb804d.html" target="n" data-glyph="102,1" class="i property">Pipeline</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the ParenExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="4352d59b7f9a85e3" href="../../R/4352d59b7f9a85e3.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#86812479028959b8" class="k">var</a> <span id="r1137 rd" class="r1137 r">newPipeline</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#a9797c05604b61e8" class="k">this</a>.<a href="#021e323175cb804d" class="i property">Pipeline</a>);
            <b>return</b> <b>new</b> <a href="#e5300f124d1ef239" class="t constructor">ParenExpressionAst</a>(<a href="#a9797c05604b61e8" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1137 r">newPipeline</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="2c8399b3fb051514" href="../../R/2c8399b3fb051514.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1138 rd" class="r1138 r">visitor</span>)
        {
            <b>return</b> <span class="r1138 r">visitor</span>.<a href="AstVisitor.cs.html#466fb01f4f8a3f54" class="i method">VisitParenExpression</a>(<a href="#a9797c05604b61e8" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1a158d8407d10c97" href="../../R/1a158d8407d10c97.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1139 rd" class="r1139 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1140 rd" class="r1140 r">action</span> = <span class="r1139 r">visitor</span>.<a href="PreOrderVisitor.cs.html#ea68064e66a277dd" class="i method">VisitParenExpression</a>(<a href="#a9797c05604b61e8" class="k">this</a>);
            <b>if</b> (<span class="r1140 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1139 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a9797c05604b61e8" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1140 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r1140 r">action</span> = <a href="#021e323175cb804d" class="i property">Pipeline</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r1139 r">visitor</span>);
            <b>return</b> <span class="r1139 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#a9797c05604b61e8" class="k">this</a>, <span class="r1140 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <b>return</b> ((<a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>)<a href="#021e323175cb804d" class="i property">Pipeline</a>.<a href="#158661f5f6c8db6d" class="i method">GetPureExpression</a>()).<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>();
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a subexpression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$(1)</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
    <b>public class</b> <a id="e6552a77ab32112a" href="../../R/e6552a77ab32112a.html" target="n" data-glyph="0,0" class="t t">SubExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a subexpression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1141 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1142 r">statementBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1141 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1142 r">statementBlock</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="ee5a380f086fe18d" href="../../R/ee5a380f086fe18d.html" target="n" data-glyph="72,1" class="t constructor">SubExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1141 rd" class="r1141 r">extent</span>, <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r1142 rd" class="r1142 r">statementBlock</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1141 r">extent</span>)
        {
            <b>if</b> (<span class="r1142 r">statementBlock</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1142 r">statementBlock</span>));
            }
 
            <a href="#e6552a77ab32112a" class="k">this</a>.<a href="#ec0bda1def565114" class="i property">SubExpression</a> = <span class="r1142 r">statementBlock</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r1142 r">statementBlock</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression/statements represented by this sub-expression.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
        <b>public</b> <a href="#268644c84b225866" class="t t">StatementBlockAst</a> <a id="ec0bda1def565114" href="../../R/ec0bda1def565114.html" target="n" data-glyph="102,1" class="i property">SubExpression</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the SubExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="9e6fe33608dfc564" href="../../R/9e6fe33608dfc564.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#268644c84b225866" class="k">var</a> <span id="r1143 rd" class="r1143 r">newStatementBlock</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#e6552a77ab32112a" class="k">this</a>.<a href="#ec0bda1def565114" class="i property">SubExpression</a>);
            <b>return</b> <b>new</b> <a href="#ee5a380f086fe18d" class="t constructor">SubExpressionAst</a>(<a href="#e6552a77ab32112a" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1143 r">newStatementBlock</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="bd32c2a388923726" href="../../R/bd32c2a388923726.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1144 rd" class="r1144 r">visitor</span>)
        {
            <b>return</b> <span class="r1144 r">visitor</span>.<a href="AstVisitor.cs.html#4c80c612e19a6c00" class="i method">VisitSubExpression</a>(<a href="#e6552a77ab32112a" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="867ad308c08490af" href="../../R/867ad308c08490af.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1145 rd" class="r1145 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1146 rd" class="r1146 r">action</span> = <span class="r1145 r">visitor</span>.<a href="PreOrderVisitor.cs.html#52bdb5545a3b5b24" class="i method">VisitSubExpression</a>(<a href="#e6552a77ab32112a" class="k">this</a>);
            <b>if</b> (<span class="r1146 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1145 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#e6552a77ab32112a" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1146 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r1146 r">action</span> = <a href="#ec0bda1def565114" class="i property">SubExpression</a>.<a href="#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r1145 r">visitor</span>);
            <b>return</b> <span class="r1145 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#e6552a77ab32112a" class="k">this</a>, <span class="r1146 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents a &quot;using&quot; expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$using:pshome</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="42d36b88817a807f" href="../../R/42d36b88817a807f.html" target="n" data-glyph="0,0" class="t t">UsingExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a using expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1147 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the using expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1148 r">expressionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The sub-expression of the using expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1147 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1148 r">expressionAst</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="6a83e62c29bc3272" href="../../R/6a83e62c29bc3272.html" target="n" data-glyph="72,1" class="t constructor">UsingExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1147 rd" class="r1147 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1148 rd" class="r1148 r">expressionAst</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1147 r">extent</span>)
        {
            <b>if</b> (<span class="r1148 r">expressionAst</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1148 r">expressionAst</span>));
            }
 
            <a href="#4ab6dd3c695bb345" class="i property">RuntimeUsingIndex</a> = -1;
            <a href="#42d36b88817a807f" class="k">this</a>.<a href="#eb8bbf44ea3ab101" class="i property">SubExpression</a> = <span class="r1148 r">expressionAst</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<a href="#eb8bbf44ea3ab101" class="i property">SubExpression</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression represented by this using expression.  This property is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="eb8bbf44ea3ab101" href="../../R/eb8bbf44ea3ab101.html" target="n" data-glyph="102,1" class="i property">SubExpression</a> { <b>get</b>; }
 
        <span class="c">// Used from code gen to get the value from a well known location.</span>
        <b>internal int</b> <a id="4ab6dd3c695bb345" href="../../R/4ab6dd3c695bb345.html" target="n" data-glyph="104,1" class="i property">RuntimeUsingIndex</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the UsingExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="91c24cfea3ee708a" href="../../R/91c24cfea3ee708a.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r1149 rd" class="r1149 r">newExpression</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#42d36b88817a807f" class="k">this</a>.<a href="#eb8bbf44ea3ab101" class="i property">SubExpression</a>);
            <a href="#42d36b88817a807f" class="k">var</a> <span id="r1150 rd" class="r1150 r">newUsingExpression</span> = <b>new</b> <a href="#6a83e62c29bc3272" class="t constructor">UsingExpressionAst</a>(<a href="#42d36b88817a807f" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1149 r">newExpression</span>);
            <span class="r1150 r">newUsingExpression</span>.<a href="#4ab6dd3c695bb345" class="i property">RuntimeUsingIndex</a> = <a href="#42d36b88817a807f" class="k">this</a>.<a href="#4ab6dd3c695bb345" class="i property">RuntimeUsingIndex</a>;
            <b>return</b> <span class="r1150 r">newUsingExpression</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> UsingExpression Utilities
 
        <b>internal const string</b> <a id="3331acd12e22a1c8" href="../../R/3331acd12e22a1c8.html" target="n" data-glyph="8,1" class="i field">UsingPrefix</a> = <span class="s">&quot;__using_&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the underlying &quot;using variable&quot; from a UsingExpressionAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1151 r">usingExpressionAst</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A UsingExpressionAst</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The underlying VariableExpressionAst of the UsingExpression</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1011:ConsiderPassingBaseTypesAsParameters&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;We want to get the underlying variable only for the UsingExpressionAst.&quot;</span>)]
        <b>public static</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <a id="5f7670b30a24be4f" href="../../R/5f7670b30a24be4f.html" target="n" data-glyph="72,1" class="i method">ExtractUsingVariable</a>(<a href="#42d36b88817a807f" class="t t">UsingExpressionAst</a> <span id="r1151 rd" class="r1151 r">usingExpressionAst</span>)
        {
            <b>if</b> (<span class="r1151 r">usingExpressionAst</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r1151 r">usingExpressionAst</span>));
            }
 
            <b>return</b> <a href="#fd398202c1714656" class="i method">ExtractUsingVariableImpl</a>(<span class="r1151 r">usingExpressionAst</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A UsingExpressionAst must contains a VariableExpressionAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1152 r">expression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <a id="fd398202c1714656" href="../../R/fd398202c1714656.html" target="n" data-glyph="76,1" class="i method">ExtractUsingVariableImpl</a>(<a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1152 rd" class="r1152 r">expression</span>)
        {
            <a href="#42d36b88817a807f" class="k">var</a> <span id="r1153 rd" class="r1153 r">usingExpr</span> = <span class="r1152 r">expression</span> <b>as</b> <a href="#42d36b88817a807f" class="t t">UsingExpressionAst</a>;
            <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r1154 rd" class="r1154 r">variableExpr</span>;
 
            <b>if</b> (<span class="r1153 r">usingExpr</span> != <b>null</b>)
            {
                <span class="r1154 r">variableExpr</span> = <span class="r1153 r">usingExpr</span>.<a href="#eb8bbf44ea3ab101" class="i property">SubExpression</a> <b>as</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                <b>if</b> (<span class="r1154 r">variableExpr</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r1154 r">variableExpr</span>;
                }
 
                <b>return</b> <a href="#fd398202c1714656" class="i method">ExtractUsingVariableImpl</a>(<span class="r1153 r">usingExpr</span>.<a href="#eb8bbf44ea3ab101" class="i property">SubExpression</a>);
            }
 
            <a href="#4587e325068530ec" class="k">var</a> <span id="r1155 rd" class="r1155 r">indexExpr</span> = <span class="r1152 r">expression</span> <b>as</b> <a href="#4587e325068530ec" class="t t">IndexExpressionAst</a>;
            <b>if</b> (<span class="r1155 r">indexExpr</span> != <b>null</b>)
            {
                <span class="r1154 r">variableExpr</span> = <span class="r1155 r">indexExpr</span>.<a href="#4340a50f115f7fdd" class="i property">Target</a> <b>as</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                <b>if</b> (<span class="r1154 r">variableExpr</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r1154 r">variableExpr</span>;
                }
 
                <b>return</b> <a href="#fd398202c1714656" class="i method">ExtractUsingVariableImpl</a>(<span class="r1155 r">indexExpr</span>.<a href="#4340a50f115f7fdd" class="i property">Target</a>);
            }
 
            <a href="#a3e8bc64452a67d0" class="k">var</a> <span id="r1156 rd" class="r1156 r">memberExpr</span> = <span class="r1152 r">expression</span> <b>as</b> <a href="#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>;
            <b>if</b> (<span class="r1156 r">memberExpr</span> != <b>null</b>)
            {
                <span class="r1154 r">variableExpr</span> = <span class="r1156 r">memberExpr</span>.<a href="#22340c1f7f19ecba" class="i property">Expression</a> <b>as</b> <a href="#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                <b>if</b> (<span class="r1154 r">variableExpr</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r1154 r">variableExpr</span>;
                }
 
                <b>return</b> <a href="#fd398202c1714656" class="i method">ExtractUsingVariableImpl</a>(<span class="r1156 r">memberExpr</span>.<a href="#22340c1f7f19ecba" class="i property">Expression</a>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;We should always be able to get a VariableExpressionAst from a UsingExpressionAst&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> UsingExpression Utilities
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="822a8cf3f742479c" href="../../R/822a8cf3f742479c.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1157 rd" class="r1157 r">visitor</span>)
        {
            <b>return</b> <span class="r1157 r">visitor</span>.<a href="AstVisitor.cs.html#85b9c92c1df43524" class="i method">VisitUsingExpression</a>(<a href="#42d36b88817a807f" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="dc6d1445d0c92671" href="../../R/dc6d1445d0c92671.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1158 rd" class="r1158 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1159 rd" class="r1159 r">action</span> = <span class="r1158 r">visitor</span>.<a href="PreOrderVisitor.cs.html#5fb864af0893873b" class="i method">VisitUsingExpression</a>(<a href="#42d36b88817a807f" class="k">this</a>);
            <b>if</b> (<span class="r1159 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1158 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#42d36b88817a807f" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1159 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r1159 r">action</span> = <a href="#eb8bbf44ea3ab101" class="i property">SubExpression</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r1158 r">visitor</span>);
            <b>return</b> <span class="r1158 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#42d36b88817a807f" class="k">this</a>, <span class="r1159 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ast that represents an index expression, e.g. </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">$a[0]</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="4587e325068530ec" href="../../R/4587e325068530ec.html" target="n" data-glyph="0,0" class="t t">IndexExpressionAst</a> : <a href="#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an ast for an index expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1160 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1161 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression being indexed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1162 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The index expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1160 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1161 r">target</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1162 r">index</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="060c0d725efdde2b" href="../../R/060c0d725efdde2b.html" target="n" data-glyph="72,1" class="t constructor">IndexExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1160 rd" class="r1160 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1161 rd" class="r1161 r">target</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1162 rd" class="r1162 r">index</span>)
            : <a href="#29919c675f78fdb0" class="k">base</a>(<span class="r1160 r">extent</span>)
        {
            <b>if</b> (<span class="r1161 r">target</span> == <b>null</b> || <span class="r1162 r">index</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="r1161 r">target</span> == <b>null</b> ? <span class="s">&quot;target&quot;</span> : <span class="s">&quot;index&quot;</span>);
            }
 
            <a href="#4587e325068530ec" class="k">this</a>.<a href="#4340a50f115f7fdd" class="i property">Target</a> = <span class="r1161 r">target</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r1161 r">target</span>);
            <a href="#4587e325068530ec" class="k">this</a>.<a href="#2e5c6ad17318d78c" class="i property">Index</a> = <span class="r1162 r">index</span>;
            <a href="#16b383c9efa28c6a" class="i method">SetParent</a>(<span class="r1162 r">index</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4587e325068530ec" class="t t">IndexExpressionAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1163 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The extent of the expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1164 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression being indexed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1165 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The index expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1166 r">nullConditional</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Access the index only if the target is not null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1163 r">extent</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1164 r">target</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1165 r">index</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="feffe271856401b8" href="../../R/feffe271856401b8.html" target="n" data-glyph="72,1" class="t constructor">IndexExpressionAst</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1163 rd" class="r1163 r">extent</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1164 rd" class="r1164 r">target</span>, <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1165 rd" class="r1165 r">index</span>, <b>bool</b> <span id="r1166 rd" class="r1166 r">nullConditional</span>)
            : <a href="#060c0d725efdde2b" class="k">this</a>(<span class="r1163 r">extent</span>, <span class="r1164 r">target</span>, <span class="r1165 r">index</span>)
        {
            <a href="#4587e325068530ec" class="k">this</a>.<a href="#bc0ffb37ea25c82b" class="i property">NullConditional</a> = <span class="r1166 r">nullConditional</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the ast for the expression being indexed.  This value is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="4340a50f115f7fdd" href="../../R/4340a50f115f7fdd.html" target="n" data-glyph="102,1" class="i property">Target</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the ast for the index expression.  This value is never null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="2e5c6ad17318d78c" href="../../R/2e5c6ad17318d78c.html" target="n" data-glyph="102,1" class="i property">Index</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value indicating whether ?[] operator is being used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="bc0ffb37ea25c82b" href="../../R/bc0ffb37ea25c82b.html" target="n" data-glyph="102,1" class="i property">NullConditional</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the IndexExpressionAst instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#d47621d83efd14de" class="t t">Ast</a> <a id="e435df9f26801889" href="../../R/e435df9f26801889.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r1167 rd" class="r1167 r">newTarget</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4587e325068530ec" class="k">this</a>.<a href="#4340a50f115f7fdd" class="i property">Target</a>);
            <a href="#78a833319fe635b4" class="k">var</a> <span id="r1168 rd" class="r1168 r">newIndex</span> = <a href="#1e6d1dbcf15d3377" class="i method">CopyElement</a>(<a href="#4587e325068530ec" class="k">this</a>.<a href="#2e5c6ad17318d78c" class="i property">Index</a>);
            <b>return</b> <b>new</b> <a href="#feffe271856401b8" class="t constructor">IndexExpressionAst</a>(<a href="#4587e325068530ec" class="k">this</a>.<a href="#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r1167 r">newTarget</span>, <span class="r1168 r">newIndex</span>, <a href="#4587e325068530ec" class="k">this</a>.<a href="#bc0ffb37ea25c82b" class="i property">NullConditional</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Visitors
 
        <b>internal override object</b> <a id="86cd73c2cae4a4ec" href="../../R/86cd73c2cae4a4ec.html" target="n" data-glyph="74,1" class="i method">Accept</a>(<a href="AstVisitor.cs.html#735848148c592aff" class="t t">ICustomAstVisitor</a> <span id="r1169 rd" class="r1169 r">visitor</span>)
        {
            <b>return</b> <span class="r1169 r">visitor</span>.<a href="AstVisitor.cs.html#e9b2ecb66d819cf6" class="i method">VisitIndexExpression</a>(<a href="#4587e325068530ec" class="k">this</a>);
        }
 
        <b>internal override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="ccd80ec3f98bed41" href="../../R/ccd80ec3f98bed41.html" target="n" data-glyph="74,1" class="i method">InternalVisit</a>(<a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a> <span id="r1170 rd" class="r1170 r">visitor</span>)
        {
            <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="k">var</a> <span id="r1171 rd" class="r1171 r">action</span> = <span class="r1170 r">visitor</span>.<a href="PreOrderVisitor.cs.html#1a977109fffadb2b" class="i method">VisitIndexExpression</a>(<a href="#4587e325068530ec" class="k">this</a>);
            <b>if</b> (<span class="r1171 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>)
                <b>return</b> <span class="r1170 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4587e325068530ec" class="k">this</a>, <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>);
            <b>if</b> (<span class="r1171 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r1171 r">action</span> = <a href="#4340a50f115f7fdd" class="i property">Target</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r1170 r">visitor</span>);
            <b>if</b> (<span class="r1171 r">action</span> == <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>)
                <span class="r1171 r">action</span> = <a href="#2e5c6ad17318d78c" class="i property">Index</a>.<a href="#2e9232a83bfd248d" class="i method">InternalVisit</a>(<span class="r1170 r">visitor</span>);
            <b>return</b> <span class="r1170 r">visitor</span>.<a href="PreOrderVisitor.cs.html#8c0505eeaaba3f62" class="i method">CheckForPostAction</a>(<a href="#4587e325068530ec" class="k">this</a>, <span class="r1171 r">action</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Visitors
 
        <a href="#41e026a3563ae47a" class="t t">IAssignableValue</a> <a href="#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>.<a href="#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>()
        {
            <b>return</b> <b>new</b> <span class="t">IndexAssignableValue</span> { <a href="Compiler.cs.html#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a> = <a href="#4587e325068530ec" class="k">this</a> };
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Expressions
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Help
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The help content specified via help comments for a given script or script function.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="3e2184322a40858b" href="../../R/3e2184322a40858b.html" target="n" data-glyph="0,0" class="t t"><span id="19787d2137f7bac3">CommentHelpInfo</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .SYNOPSIS section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="9fb981483b6cfea2" href="../../R/9fb981483b6cfea2.html" target="n" data-glyph="102,1" class="i property">Synopsis</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .DESCRIPTION section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="88ab497dc62f47b9" href="../../R/88ab497dc62f47b9.html" target="n" data-glyph="102,1" class="i property">Description</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .NOTES section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="fd80f49d3ec18f99" href="../../R/fd80f49d3ec18f99.html" target="n" data-glyph="102,1" class="i property">Notes</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content for each parameter where help content is specified.  The</span>
        <span class="c">///</span><span class="c"> key is the parameter name, the value is the help content.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TODO, Changing this to an IDictionary because ReadOnlyDictionary is available only in .NET 4.5</span>
        <span class="c">///</span><span class="c"> This is a temporary workaround and will be fixed later. Tracked by Win8: 354135</span>
        <b>public</b> <span class="i">IDictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="7d4f8979d0c9326b" href="../../R/7d4f8979d0c9326b.html" target="n" data-glyph="102,1" class="i property">Parameters</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content from all of the specified .LINK sections.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="5da48b0738510678" href="../../R/5da48b0738510678.html" target="n" data-glyph="102,1" class="i property">Links</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content from all of the specified .EXAMPLE sections.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="1ad5da22c573510e" href="../../R/1ad5da22c573510e.html" target="n" data-glyph="102,1" class="i property">Examples</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content from all of the specified .INPUT sections.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="d6cb863f280cd7d7" href="../../R/d6cb863f280cd7d7.html" target="n" data-glyph="102,1" class="i property">Inputs</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content from all of the specified .OUTPUT sections.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt; <a id="29ede4444c2cb907" href="../../R/29ede4444c2cb907.html" target="n" data-glyph="102,1" class="i property">Outputs</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .COMPONENT section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="cb4c19f87dc14259" href="../../R/cb4c19f87dc14259.html" target="n" data-glyph="102,1" class="i property">Component</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .ROLE section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ebeb60b9dfba1bfa" href="../../R/ebeb60b9dfba1bfa.html" target="n" data-glyph="102,1" class="i property">Role</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .FUNCTIONALITY section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ccec49d8bf11a221" href="../../R/ccec49d8bf11a221.html" target="n" data-glyph="102,1" class="i property">Functionality</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .FORWARDHELPTARGETNAME section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="277f28a24e95d3df" href="../../R/277f28a24e95d3df.html" target="n" data-glyph="102,1" class="i property">ForwardHelpTargetName</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .FORWARDHELPCATEGORY section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="800a9ccb321be2f7" href="../../R/800a9ccb321be2f7.html" target="n" data-glyph="102,1" class="i property">ForwardHelpCategory</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .REMOTEHELPRUNSPACE section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="19edcb8587e5c4c5" href="../../R/19edcb8587e5c4c5.html" target="n" data-glyph="102,1" class="i property">RemoteHelpRunspace</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The help content of the .MAMLHELPFILE section, if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Maml&quot;</span>)]
        <b>public string</b> <a id="b44760123b0e9e51" href="../../R/b44760123b0e9e51.html" target="n" data-glyph="102,1" class="i property">MamlHelpFile</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the help info as a comment block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="6a1442834682436d" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetCommentBlock</a>()
        {
            <b>var</b> <span id="r1172 rd" class="r1172 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;&lt;#&quot;</span>);
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#9fb981483b6cfea2" class="i property">Synopsis</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.SYNOPSIS&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#9fb981483b6cfea2" class="i property">Synopsis</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#88ab497dc62f47b9" class="i property">Description</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.DESCRIPTION&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#88ab497dc62f47b9" class="i property">Description</a>);
            }
 
            <b>foreach</b> (<b>var</b> <span id="r1173 rd" class="r1173 r">parameter</span> <b>in</b> <a href="#7d4f8979d0c9326b" class="i property">Parameters</a>)
            {
                <span class="r1172 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;.PARAMETER &quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="r1173 r">parameter</span>.<span class="i">Key</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="r1173 r">parameter</span>.<span class="i">Value</span>);
            }
 
            <b>for</b> (<b>int</b> <span id="r1174 rd" class="r1174 r">index</span> = 0; <span class="r1174 r">index</span> &lt; <a href="#d6cb863f280cd7d7" class="i property">Inputs</a>.<span class="i">Count</span>; <span class="r1174 r">index</span>++)
            {
                <b>var</b> <span id="r1175 rd" class="r1175 r">input</span> = <a href="#d6cb863f280cd7d7" class="i property">Inputs</a>[<span class="r1174 r">index</span>];
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.INPUTS&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="r1175 r">input</span>);
            }
 
            <b>for</b> (<b>int</b> <span id="r1176 rd" class="r1176 r">index</span> = 0; <span class="r1176 r">index</span> &lt; <a href="#29ede4444c2cb907" class="i property">Outputs</a>.<span class="i">Count</span>; <span class="r1176 r">index</span>++)
            {
                <b>var</b> <span id="r1177 rd" class="r1177 r">output</span> = <a href="#29ede4444c2cb907" class="i property">Outputs</a>[<span class="r1176 r">index</span>];
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.OUTPUTS&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="r1177 r">output</span>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#fd80f49d3ec18f99" class="i property">Notes</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.NOTES&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#fd80f49d3ec18f99" class="i property">Notes</a>);
            }
 
            <b>for</b> (<b>int</b> <span id="r1178 rd" class="r1178 r">index</span> = 0; <span class="r1178 r">index</span> &lt; <a href="#1ad5da22c573510e" class="i property">Examples</a>.<span class="i">Count</span>; <span class="r1178 r">index</span>++)
            {
                <b>var</b> <span id="r1179 rd" class="r1179 r">example</span> = <a href="#1ad5da22c573510e" class="i property">Examples</a>[<span class="r1178 r">index</span>];
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.EXAMPLE&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="r1179 r">example</span>);
            }
 
            <b>for</b> (<b>int</b> <span id="r1180 rd" class="r1180 r">index</span> = 0; <span class="r1180 r">index</span> &lt; <a href="#5da48b0738510678" class="i property">Links</a>.<span class="i">Count</span>; <span class="r1180 r">index</span>++)
            {
                <b>var</b> <span id="r1181 rd" class="r1181 r">link</span> = <a href="#5da48b0738510678" class="i property">Links</a>[<span class="r1180 r">index</span>];
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.LINK&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="r1181 r">link</span>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#277f28a24e95d3df" class="i property">ForwardHelpTargetName</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;.FORWARDHELPTARGETNAME &quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#277f28a24e95d3df" class="i property">ForwardHelpTargetName</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#800a9ccb321be2f7" class="i property">ForwardHelpCategory</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;.FORWARDHELPCATEGORY &quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#800a9ccb321be2f7" class="i property">ForwardHelpCategory</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#19edcb8587e5c4c5" class="i property">RemoteHelpRunspace</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;.REMOTEHELPRUNSPACE &quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#19edcb8587e5c4c5" class="i property">RemoteHelpRunspace</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#cb4c19f87dc14259" class="i property">Component</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.COMPONENT&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#cb4c19f87dc14259" class="i property">Component</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#ebeb60b9dfba1bfa" class="i property">Role</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.ROLE&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#ebeb60b9dfba1bfa" class="i property">Role</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#ccec49d8bf11a221" class="i property">Functionality</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;.FUNCTIONALITY&quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#ccec49d8bf11a221" class="i property">Functionality</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#b44760123b0e9e51" class="i property">MamlHelpFile</a>))
            {
                <span class="r1172 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;.EXTERNALHELP &quot;</span>);
                <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<a href="#b44760123b0e9e51" class="i property">MamlHelpFile</a>);
            }
 
            <span class="r1172 r">sb</span>.<span class="i">AppendLine</span>(<span class="s">&quot;#&gt;&quot;</span>);
            <b>return</b> <span class="r1172 r">sb</span>.<span class="i">ToString</span>();
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Help
}
</pre></td></tr></table></div></body></html>
