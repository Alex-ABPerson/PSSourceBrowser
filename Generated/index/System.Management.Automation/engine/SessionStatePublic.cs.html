<!DOCTYPE html>
<html><head><title>SessionStatePublic.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(375);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/SessionStatePublic.cs" target="_top">engine\SessionStatePublic.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Exposes the APIs to manipulate the providers, Runspace data, and location to the Cmdlet base class.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="0a202aa6b2d52930" href="../R/0a202aa6b2d52930.html" target="n" data-glyph="0,0" class="t t">SessionState</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The internal constructor for this object. It should be the only one that gets called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">sessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of SessionState that the APIs should work against.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">sessionState</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="45f5fbc7afc57ae4" href="../R/45f5fbc7afc57ae4.html" target="n" data-glyph="74,1" class="t constructor">SessionState</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r0 rd" class="r0 r">sessionState</span>)
        {
            <b>if</b> (<span class="r0 r">sessionState</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">sessionState</span>));
            }
 
            <a href="#6916d955fc938c2b" class="i field">_sessionState</a> = <span class="r0 r">sessionState</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The internal constructor for this object. It should be the only one that gets called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of ExecutionContext whose EngineSessionState represents the parent session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">createAsChild</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the session state should be created as a child session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">linkToGlobal</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the session state should be linked to the global scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">context</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="b5c2a459b4a3ca3e" href="../R/b5c2a459b4a3ca3e.html" target="n" data-glyph="74,1" class="t constructor">SessionState</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r1 rd" class="r1 r">context</span>, <b>bool</b> <span id="r2 rd" class="r2 r">createAsChild</span>, <b>bool</b> <span id="r3 rd" class="r3 r">linkToGlobal</span>)
        {
            <b>if</b> (<span class="r1 r">context</span> == <b>null</b>)
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;ExecutionContext&quot;</span>);
 
            <b>if</b> (<span class="r2 r">createAsChild</span>)
            {
                <a href="#6916d955fc938c2b" class="i field">_sessionState</a> = <b>new</b> <a href="SessionState.cs.html#bfa6a7a1d31f0eed" class="t constructor">SessionStateInternal</a>(<span class="r1 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>, <span class="r3 r">linkToGlobal</span>, <span class="r1 r">context</span>);
            }
            <b>else</b>
            {
                <a href="#6916d955fc938c2b" class="i field">_sessionState</a> = <b>new</b> <a href="SessionState.cs.html#5ccb828c0af0ef80" class="t constructor">SessionStateInternal</a>(<span class="r1 r">context</span>);
            }
 
            <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#e8d61ec8e5e7bb28" class="i property">PublicSessionState</a> = <a href="#0a202aa6b2d52930" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a new session state object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="aa2af37a23893dcb" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SessionState</a>()
        {
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r4 rd" class="r4 r">ecFromTLS</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>if</b> (<span class="r4 r">ecFromTLS</span> == <b>null</b>)
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;ExecutionContext&quot;</span>);
 
            <a href="#6916d955fc938c2b" class="i field">_sessionState</a> = <b>new</b> <a href="SessionState.cs.html#5ccb828c0af0ef80" class="t constructor">SessionStateInternal</a>(<span class="r4 r">ecFromTLS</span>);
            <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#e8d61ec8e5e7bb28" class="i property">PublicSessionState</a> = <a href="#0a202aa6b2d52930" class="k">this</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the APIs to access drives.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="DriveInterfaces.cs.html#af7db3a0f716ab5e" class="t t">DriveManagementIntrinsics</a> <a id="49ff6e2d0769f2e2" href="../R/49ff6e2d0769f2e2.html" target="n" data-glyph="102,1" class="i property">Drive</a>
        {
            <b>get</b> { <b>return</b> <a href="#851b7650d1c44815" class="i field">_drive</a> ??= <b>new</b> <a href="DriveInterfaces.cs.html#ca5868922f70eb22" class="t constructor">DriveManagementIntrinsics</a>(<a href="#6916d955fc938c2b" class="i field">_sessionState</a>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the APIs to access providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="ProviderInterfaces.cs.html#5df802574bbd2fbe" class="t t">CmdletProviderManagementIntrinsics</a> <a id="e315bf3657b55810" href="../R/e315bf3657b55810.html" target="n" data-glyph="102,1" class="i property">Provider</a>
        {
            <b>get</b> { <b>return</b> <a href="#aef007459384cf41" class="i field">_provider</a> ??= <b>new</b> <a href="ProviderInterfaces.cs.html#12594820e7fd2f9e" class="t constructor">CmdletProviderManagementIntrinsics</a>(<a href="#6916d955fc938c2b" class="i field">_sessionState</a>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the APIs to access paths and location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="PathInterfaces.cs.html#2a45e8d71562122c" class="t t">PathIntrinsics</a> <a id="3390cfbbdcffb036" href="../R/3390cfbbdcffb036.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> { <b>return</b> <a href="#76b6ed166cdb5512" class="i field">_path</a> ??= <b>new</b> <a href="PathInterfaces.cs.html#4bbb8f2978e03aa7" class="t constructor">PathIntrinsics</a>(<a href="#6916d955fc938c2b" class="i field">_sessionState</a>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the APIs to access variables in session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="VariableInterfaces.cs.html#a66e215a6e6c92d5" class="t t">PSVariableIntrinsics</a> <a id="0198da5eba13cb75" href="../R/0198da5eba13cb75.html" target="n" data-glyph="102,1" class="i property">PSVariable</a>
        {
            <b>get</b> { <b>return</b> <a href="#9f869da0efc9023f" class="i field">_variable</a> ??= <b>new</b> <a href="VariableInterfaces.cs.html#dedb6766ebadabc3" class="t constructor">PSVariableIntrinsics</a>(<a href="#6916d955fc938c2b" class="i field">_sessionState</a>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get/set constraints for this execution environment.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="f2800307140e1fec" href="../R/f2800307140e1fec.html" target="n" data-glyph="102,1" class="i property">LanguageMode</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#c13642db000f9224" class="i property">LanguageMode</a>; }
 
            <b>set</b> { <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#c13642db000f9224" class="i property">LanguageMode</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true the PowerShell debugger will use FullLanguage mode, otherwise it will use the current language mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b3edfad11658a9f1" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">UseFullLanguageModeInDebugger</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#4118a8d5bc432193" class="i property">UseFullLanguageModeInDebugger</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public proxy for the list of scripts that are allowed to be run. If the name &quot;*&quot;</span>
        <span class="c">///</span><span class="c"> is in the list, then all scripts can be run. (This is the default.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="df2a7915392b39a5" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Scripts</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#36447cb8e57fac9f" class="i property">Scripts</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public proxy for the list of applications that are allowed to be run. If the name &quot;*&quot;</span>
        <span class="c">///</span><span class="c"> is in the list, then all applications can be run. (This is the default.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="f4105c3588a93978" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Applications</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#27ddff158f6adc5b" class="i property">Applications</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module associated with this session state instance...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="9eb32463309cfecb" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Module</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#1900efdc2f293d5a" class="i property">Module</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider intrinsics for this session state instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="CmdletFamilyProviderInterfaces.cs.html#7e7c55aa110a0320" class="t t">ProviderIntrinsics</a> <a id="43a21166aa0ed2d8" href="../R/43a21166aa0ed2d8.html" target="n" data-glyph="102,1" class="i property">InvokeProvider</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#90da109969600d24" class="i property">InvokeProvider</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command invocation intrinsics for this session state instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="MshCmdlet.cs.html#444c098e64ffcf20" class="t t">CommandInvocationIntrinsics</a> <a id="236f6ceba41f8f3e" href="../R/236f6ceba41f8f3e.html" target="n" data-glyph="102,1" class="i property">InvokeCommand</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>.<a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#27c4e82ba7216ff8" class="i property">EngineIntrinsics</a>.<a href="EngineIntrinsics.cs.html#9e6ba5466d2a8889" class="i property">InvokeCommand</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Utility to check the visibility of an object based on the current</span>
        <span class="c">///</span><span class="c"> command origin. If the object implements IHasSessionStateEntryVisibility</span>
        <span class="c">///</span><span class="c"> then the check will be made. If the check fails, then an exception will be thrown...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The command origin value to check against...</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">valueToCheck</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="f73a87d524011168" href="../R/f73a87d524011168.html" target="n" data-glyph="72,1" class="i method">ThrowIfNotVisible</a>(<a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r5 rd" class="r5 r">origin</span>, <b>object</b> <span id="r6 rd" class="r6 r">valueToCheck</span>)
        {
            <a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a> <span id="r7 rd" class="r7 r">exception</span>;
            <b>if</b> (!<a href="#2eba2d21fd64fd51" class="i method">IsVisible</a>(<span class="r5 r">origin</span>, <span class="r6 r">valueToCheck</span>))
            {
                <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r8 rd" class="r8 r">sv</span> = <span class="r6 r">valueToCheck</span> <b>as</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>;
                <b>if</b> (<span class="r8 r">sv</span> != <b>null</b>)
                {
                    <span class="r7 r">exception</span> =
                       <b>new</b> <span class="t">SessionStateException</span>(
                           <span class="r8 r">sv</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>,
                           <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#2c22962ab516ef3f" class="i field">Variable</a>,
                           <span class="s">&quot;VariableIsPrivate&quot;</span>,
                           <span class="i">SessionStateStrings</span>.<span class="i">VariableIsPrivate</span>,
                           <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#26ba13af79d30a75" class="i field">PermissionDenied</a>);
 
                    <b>throw</b> <span class="r7 r">exception</span>;
                }
 
                <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r9 rd" class="r9 r">cinfo</span> = <span class="r6 r">valueToCheck</span> <b>as</b> <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
                <b>if</b> (<span class="r9 r">cinfo</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r10 rd" class="r10 r">commandName</span> = <span class="r9 r">cinfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                    <b>if</b> (<span class="r10 r">commandName</span> != <b>null</b>)
                    {
                        <span class="c">// If we have a name, use it in the error message</span>
                        <span class="r7 r">exception</span> =
                            <b>new</b> <span class="t">SessionStateException</span>(
                                <span class="r10 r">commandName</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#7c724c55ba545cab" class="i field">Command</a>,
                                <span class="s">&quot;NamedCommandIsPrivate&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">NamedCommandIsPrivate</span>,
                                <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#26ba13af79d30a75" class="i field">PermissionDenied</a>);
                    }
                    <b>else</b>
                    {
                        <span class="r7 r">exception</span> =
                            <b>new</b> <span class="t">SessionStateException</span>(
                                <b>string</b>.<span class="i">Empty</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#7c724c55ba545cab" class="i field">Command</a>,
                                <span class="s">&quot;CommandIsPrivate&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">CommandIsPrivate</span>,
                                <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#26ba13af79d30a75" class="i field">PermissionDenied</a>);
                    }
 
                    <b>throw</b> <span class="r7 r">exception</span>;
                }
 
                <span class="c">// Catch all error for other types of resources...</span>
                <span class="r7 r">exception</span> =
                    <b>new</b> <span class="t">SessionStateException</span>(
                        <b>null</b>,
                        <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#abbfdd2f8608059e" class="i field">Resource</a>,
                        <span class="s">&quot;ResourceIsPrivate&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">ResourceIsPrivate</span>,
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#26ba13af79d30a75" class="i field">PermissionDenied</a>);
 
                <b>throw</b> <span class="r7 r">exception</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks the visibility of an object based on the command origin argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The origin to check against.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">valueToCheck</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns true if the object is visible, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="2eba2d21fd64fd51" href="../R/2eba2d21fd64fd51.html" target="n" data-glyph="72,1" class="i method">IsVisible</a>(<a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r11 rd" class="r11 r">origin</span>, <b>object</b> <span id="r12 rd" class="r12 r">valueToCheck</span>)
        {
            <b>if</b> (<span class="r11 r">origin</span> == <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>)
                <b>return</b> <b>true</b>;
            <a href="#4b8be05a8447db04" class="t t">IHasSessionStateEntryVisibility</a> <span id="r13 rd" class="r13 r">obj</span> = <span class="r12 r">valueToCheck</span> <b>as</b> <a href="#4b8be05a8447db04" class="t t">IHasSessionStateEntryVisibility</a>;
            <b>if</b> (<span class="r13 r">obj</span> != <b>null</b>)
            {
                <b>return</b> (<span class="r13 r">obj</span>.<a href="#1eea4a1757393cfb" class="i property">Visibility</a> == <a href="#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="#74d8ba664c504563" class="i field">Public</a>);
            }
 
            <b>return</b> <b>true</b>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks the visibility of an object based on the command origin argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The origin to check against.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">variable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns true if the object is visible, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="e31dde9f5c89a7b2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsVisible</a>(<a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r14 rd" class="r14 r">origin</span>, <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r15 rd" class="r15 r">variable</span>)
        {
            <b>if</b> (<span class="r14 r">origin</span> == <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>)
                <b>return</b> <b>true</b>;
            <b>if</b> (<span class="r15 r">variable</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r15 r">variable</span>));
            }
 
            <b>return</b> (<span class="r15 r">variable</span>.<a href="ShellVariable.cs.html#4e70252485bbcc8b" class="i property">Visibility</a> == <a href="#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="#74d8ba664c504563" class="i field">Public</a>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks the visibility of an object based on the command origin argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The origin to check against.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The command to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns true if the object is visible, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="0e40bae2be4870b9" href="../R/0e40bae2be4870b9.html" target="n" data-glyph="72,1" class="i method">IsVisible</a>(<a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r16 rd" class="r16 r">origin</span>, <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r17 rd" class="r17 r">commandInfo</span>)
        {
            <b>if</b> (<span class="r16 r">origin</span> == <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>)
                <b>return</b> <b>true</b>;
            <b>if</b> (<span class="r17 r">commandInfo</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r17 r">commandInfo</span>));
            }
 
            <b>return</b> (<span class="r17 r">commandInfo</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> == <a href="#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="#74d8ba664c504563" class="i field">Public</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a reference to the &quot;real&quot; session state object instead of the facade.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <a id="9be0303086619111" href="../R/9be0303086619111.html" target="n" data-glyph="104,1" class="i property">Internal</a>
        {
            <b>get</b> { <b>return</b> <a href="#6916d955fc938c2b" class="i field">_sessionState</a>; }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private data
 
        <b>private readonly</b> <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <a id="6916d955fc938c2b" href="../R/6916d955fc938c2b.html" target="n" data-glyph="46,1" class="i field">_sessionState</a>;
        <b>private</b> <a href="DriveInterfaces.cs.html#af7db3a0f716ab5e" class="t t">DriveManagementIntrinsics</a> <a id="851b7650d1c44815" href="../R/851b7650d1c44815.html" target="n" data-glyph="46,1" class="i field">_drive</a>;
        <b>private</b> <a href="ProviderInterfaces.cs.html#5df802574bbd2fbe" class="t t">CmdletProviderManagementIntrinsics</a> <a id="aef007459384cf41" href="../R/aef007459384cf41.html" target="n" data-glyph="46,1" class="i field">_provider</a>;
        <b>private</b> <a href="PathInterfaces.cs.html#2a45e8d71562122c" class="t t">PathIntrinsics</a> <a id="76b6ed166cdb5512" href="../R/76b6ed166cdb5512.html" target="n" data-glyph="46,1" class="i field">_path</a>;
        <b>private</b> <a href="VariableInterfaces.cs.html#a66e215a6e6c92d5" class="t t">PSVariableIntrinsics</a> <a id="9f869da0efc9023f" href="../R/9f869da0efc9023f.html" target="n" data-glyph="46,1" class="i field">_variable</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private data
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This enum defines the visibility of execution environment elements...</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="3acdda74c688180a" href="../R/3acdda74c688180a.html" target="n" data-glyph="18,0" class="t t"><span id="9f352bd1b80034e7">SessionStateEntryVisibility</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Entries are visible to requests from outside the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="74d8ba664c504563" href="../R/74d8ba664c504563.html" target="n" data-glyph="24,1" class="i field">Public</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Entries are not visible to requests from outside the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9412d519f56b8001" href="../R/9412d519f56b8001.html" target="n" data-glyph="24,1" class="i field">Private</a> = 1
    }
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>internal interface</b> <a id="4b8be05a8447db04" href="../R/4b8be05a8447db04.html" target="n" data-glyph="50,0" class="t t">IHasSessionStateEntryVisibility</a>
    {
        <a href="#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="1eea4a1757393cfb" href="../R/1eea4a1757393cfb.html" target="n" data-glyph="102,1" class="i property">Visibility</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This enum defines what subset of the PowerShell language is permitted when</span>
    <span class="c">///</span><span class="c"> calling into this execution environment.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="450052824aba2e3f" href="../R/450052824aba2e3f.html" target="n" data-glyph="18,0" class="t t"><span id="42f0ade4854fd75f">PSLanguageMode</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All PowerShell language elements are available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="eec721eb8c02f156" href="../R/eec721eb8c02f156.html" target="n" data-glyph="24,1" class="i field">FullLanguage</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A subset of language elements are available to external requests.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ea8105287b8c6b25" href="../R/ea8105287b8c6b25.html" target="n" data-glyph="24,1" class="i field">RestrictedLanguage</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Commands containing script text to evaluate are not allowed. You can only</span>
        <span class="c">///</span><span class="c"> call commands using the Runspace APIs when in this mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a659f53717c16b4b" href="../R/a659f53717c16b4b.html" target="n" data-glyph="24,1" class="i field">NoLanguage</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Exposes a subset of the PowerShell language that limits itself to core PowerShell</span>
        <span class="c">///</span><span class="c"> types, does not support method invocation (except on those types), and does not</span>
        <span class="c">///</span><span class="c"> support property setters (except on those types).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9f1205fe78117fc2" href="../R/9f1205fe78117fc2.html" target="n" data-glyph="24,1" class="i field">ConstrainedLanguage</a> = 3
    }
}
</pre></td></tr></table></div></body></html>
