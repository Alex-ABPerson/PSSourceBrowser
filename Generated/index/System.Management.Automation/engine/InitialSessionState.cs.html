<!DOCTYPE html>
<html><head><title>InitialSessionState.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(5602);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/InitialSessionState.cs" target="_top">engine\InitialSessionState.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Tracing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Provider</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Security</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>using</b> <span class="t">Debug</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>
{
    <b>internal static class</b> <a id="cfe22c535276a044" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">EarlyStartup</a>
    {
        <b>internal static void</b> <a id="1f83ed6f9cacbbe0" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Init</a>()
        {
            <span class="c">// Code added here should:</span>
            <span class="c">//   * run every time we start PowerSHell</span>
            <span class="c">//   * have high CPU cost</span>
            <span class="c">//   * be ordered from most expensive to least expensive, or at least needed earliest</span>
            <span class="c">//   * this method should return quickly, so all work should be run in one or more tasks.</span>
            <span class="c">//   * code called from here should correctly handle being called twice, in case initialization</span>
            <span class="c">//     is needed in the main code path before the task completes.</span>
            <span class="c">//</span>
            <span class="c">// Code added here should not:</span>
            <span class="c">//   * count on running - not all hosts will call this method</span>
            <span class="c">//   * have high disk cost</span>
 
            <span class="c">// We shouldn&#39;t create too many tasks.</span>
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <span class="c">// Amsi initialize can be a little slow</span>
            <span class="i">Task</span>.<span class="i">Run</span>(() =&gt; <a href="../security/SecuritySupport.cs.html#da6cbabe35a18e75" class="t t">AmsiUtils</a>.<span class="i">WinScanContent</span>(<span class="i">content</span>: <b>string</b>.<span class="i">Empty</span>, <span class="i">sourceMetadata</span>: <b>string</b>.<span class="i">Empty</span>, <span class="i">warmUp</span>: <b>true</b>));
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
            <span class="c">// One other task for other stuff that&#39;s faster, but still a little slow.</span>
            <span class="i">Task</span>.<span class="i">Run</span>(() =&gt;
            {
                <span class="c">// Loading the resources for System.Management.Automation can be expensive, so force that to</span>
                <span class="c">// happen early on a background thread.</span>
                <b>_</b> = <span class="i">RunspaceInit</span>.<span class="i">OutputEncodingDescription</span>;
 
                <span class="c">// This will init some tables and could load some assemblies.</span>
                <b>_</b> = <a href="parser/TypeResolver.cs.html#c299defb2b5f7804" class="t t">TypeAccelerators</a>.<a href="parser/TypeResolver.cs.html#38876ce446a25d57" class="i field">builtinTypeAccelerators</a>;
 
                <span class="c">// This will init some tables and could load some assemblies.</span>
                <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<b>null</b>);
            });
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Baseclass for defining elements that can be added</span>
    <span class="c">///</span><span class="c"> to an InitialSessionState object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="e74d4df9b9eaad36" href="../R/e74d4df9b9eaad36.html" target="n" data-glyph="0,0" class="t t">InitialSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ctor so that each derived class has a name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="249a623c6625bfe1" href="../R/249a623c6625bfe1.html" target="n" data-glyph="75,1" class="t constructor">InitialSessionStateEntry</a>(<b>string</b> <span id="r0 rd" class="r0 r">name</span>)
        {
            <a href="#c5f3f5b848ea98cd" class="i property">Name</a> = <span class="r0 r">name</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of this entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="c5f3f5b848ea98cd" href="../R/c5f3f5b848ea98cd.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The SnapIn to load from initially.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="a63d54bd9a0897a7" href="../R/a63d54bd9a0897a7.html" target="n" data-glyph="102,1" class="i property">PSSnapIn</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal void</b> <a id="99958292d139cf3e" href="../R/99958292d139cf3e.html" target="n" data-glyph="74,1" class="i method">SetPSSnapIn</a>(<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r1 rd" class="r1 r">psSnapIn</span>)
        {
            <a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a> = <span class="r1 r">psSnapIn</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The SnapIn to load from initially.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="a3328f1f3a3a9605" href="../R/a3328f1f3a3a9605.html" target="n" data-glyph="102,1" class="i property">Module</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal void</b> <a id="47559105ce54572d" href="../R/47559105ce54572d.html" target="n" data-glyph="74,1" class="i method">SetModule</a>(<a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r2 rd" class="r2 r">module</span>)
        {
            <a href="#a3328f1f3a3a9605" class="i property">Module</a> = <span class="r2 r">module</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object...</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="6951104b4bb27d00" href="../R/6951104b4bb27d00.html" target="n" data-glyph="72,1" class="i method">Clone</a>();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class to constrain session state entries.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="19b875558acd7f23" href="../R/19b875558acd7f23.html" target="n" data-glyph="0,0" class="t t">ConstrainedSessionStateEntry</a> : <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">visibility</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="3fc5d1b57744e428" href="../R/3fc5d1b57744e428.html" target="n" data-glyph="75,1" class="t constructor">ConstrainedSessionStateEntry</a>(<b>string</b> <span id="r3 rd" class="r3 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r4 rd" class="r4 r">visibility</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="r3 r">name</span>)
        {
            <a href="#190a59133ab9a4ce" class="i property">Visibility</a> = <span class="r4 r">visibility</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="190a59133ab9a4ce" href="../R/190a59133ab9a4ce.html" target="n" data-glyph="102,1" class="i property">Visibility</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Command class so that all the commands can derive off this one.</span>
    <span class="c">///</span><span class="c"> Adds the flexibility of adding additional derived class,</span>
    <span class="c">///</span><span class="c"> such as ProxyCommand for Exchange.</span>
    <span class="c">///</span><span class="c"> Derived classes - Alias, Application, Cmdlet, Function, Script.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="480a10ec8ac9df7b" href="../R/480a10ec8ac9df7b.html" target="n" data-glyph="0,0" class="t t">SessionStateCommandEntry</a> : <a href="#19b875558acd7f23" class="t t">ConstrainedSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Base constructor for all SessionState commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="f4b4feb08bfe40d6" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">SessionStateCommandEntry</a>(<b>string</b> <span id="r5 rd" class="r5 r">name</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r5 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">visibility</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected internal</b> <a id="6a0a7a84ea204fd0" href="../R/6a0a7a84ea204fd0.html" target="n" data-glyph="75,1" class="t constructor">SessionStateCommandEntry</a>(<b>string</b> <span id="r6 rd" class="r6 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r7 rd" class="r7 r">visibility</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r6 r">name</span>, <span class="r7 r">visibility</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the type of the command using an enum</span>
        <span class="c">///</span><span class="c"> instead of requiring a full reflection type check.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <a id="b86d5dd7cdc3f952" href="../R/b86d5dd7cdc3f952.html" target="n" data-glyph="102,1" class="i property">CommandType</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is internal so it can be set by the engine code...</span>
        <span class="c">///</span><span class="c"> This is used to specify whether this command was imported or not</span>
        <span class="c">///</span><span class="c"> If noClobber is specified during Import-Module, it is set to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="cc7c5811dcdf0890" href="../R/cc7c5811dcdf0890.html" target="n" data-glyph="44,1" class="i field">_isImported</a> = <b>true</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Type file configuration entry...</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="02c5fb84a39526f6" href="../R/02c5fb84a39526f6.html" target="n" data-glyph="0,0" class="t t">SessionStateTypeEntry</a> : <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads all entries from the types file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">fileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="6607e0d8b4d498c7" href="../R/6607e0d8b4d498c7.html" target="n" data-glyph="72,1" class="t constructor">SessionStateTypeEntry</a>(<b>string</b> <span id="r8 rd" class="r8 r">fileName</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="r8 r">fileName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r8 r">fileName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r8 r">fileName</span>));
            }
 
            <a href="#335a66dec2c02166" class="i property">FileName</a> = <span class="r8 r">fileName</span>.<span class="i">Trim</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads all the types specified in the typeTable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="55eb2fba4cf6a1c4" href="../R/55eb2fba4cf6a1c4.html" target="n" data-glyph="72,1" class="t constructor">SessionStateTypeEntry</a>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r9 rd" class="r9 r">typeTable</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="s">&quot;*&quot;</span>)
        {
            <b>if</b> (<span class="r9 r">typeTable</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r9 r">typeTable</span>));
            }
 
            <a href="#083bf959ec73da96" class="i property">TypeTable</a> = <span class="r9 r">typeTable</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads all entries from the typeData.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">typeData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">isRemove</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8b3879bc60890433" href="../R/8b3879bc60890433.html" target="n" data-glyph="72,1" class="t constructor">SessionStateTypeEntry</a>(<a href="TypeTable.cs.html#944f6440e7a4331e" class="t t">TypeData</a> <span id="r10 rd" class="r10 r">typeData</span>, <b>bool</b> <span id="r11 rd" class="r11 r">isRemove</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="s">&quot;*&quot;</span>)
        {
            <b>if</b> (<span class="r10 r">typeData</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r10 r">typeData</span>));
            }
 
            <a href="#c270310d11113ea9" class="i property">TypeData</a> = <span class="r10 r">typeData</span>;
            <a href="#981a0debab1b3e9c" class="i property">IsRemove</a> = <span class="r11 r">isRemove</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="e8b2747a7254bc94" href="../R/e8b2747a7254bc94.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#02c5fb84a39526f6" class="t t">SessionStateTypeEntry</a> <span id="r12 rd" class="r12 r">entry</span>;
            <b>if</b> (<a href="#335a66dec2c02166" class="i property">FileName</a> != <b>null</b>)
            {
                <span class="r12 r">entry</span> = <b>new</b> <a href="#6607e0d8b4d498c7" class="t constructor">SessionStateTypeEntry</a>(<a href="#335a66dec2c02166" class="i property">FileName</a>);
            }
            <b>else</b> <b>if</b> (<a href="#083bf959ec73da96" class="i property">TypeTable</a> != <b>null</b>)
            {
                <span class="r12 r">entry</span> = <b>new</b> <a href="#55eb2fba4cf6a1c4" class="t constructor">SessionStateTypeEntry</a>(<a href="#083bf959ec73da96" class="i property">TypeTable</a>);
            }
            <b>else</b>
            {
                <span class="r12 r">entry</span> = <b>new</b> <a href="#8b3879bc60890433" class="t constructor">SessionStateTypeEntry</a>(<a href="#c270310d11113ea9" class="i property">TypeData</a>, <a href="#981a0debab1b3e9c" class="i property">IsRemove</a>);
            }
 
            <span class="r12 r">entry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<a href="#02c5fb84a39526f6" class="k">this</a>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>);
            <span class="r12 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#02c5fb84a39526f6" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r12 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pathname of the types.ps1xml file. This can be null if</span>
        <span class="c">///</span><span class="c"> TypeTable constructor or TypeData constructor is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="335a66dec2c02166" href="../R/335a66dec2c02166.html" target="n" data-glyph="102,1" class="i property">FileName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeTable specified with constructor. This can be null if</span>
        <span class="c">///</span><span class="c"> FileName constructor or TypeData constructor is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="083bf959ec73da96" href="../R/083bf959ec73da96.html" target="n" data-glyph="102,1" class="i property">TypeTable</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeData we want to update with. This can be null if</span>
        <span class="c">///</span><span class="c"> FileName constructor or TypeTable constructor is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="TypeTable.cs.html#944f6440e7a4331e" class="t t">TypeData</a> <a id="c270310d11113ea9" href="../R/c270310d11113ea9.html" target="n" data-glyph="102,1" class="i property">TypeData</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The operation will be done on the typedata. This is only</span>
        <span class="c">///</span><span class="c"> meaningful when the TypeData constructor is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="981a0debab1b3e9c" href="../R/981a0debab1b3e9c.html" target="n" data-glyph="102,1" class="i property">IsRemove</a> { <b>get</b>; }
 
        <span class="c">// So that we can specify the type information on the fly,</span>
        <span class="c">// without using Types.ps1xml file</span>
        <span class="c">// public SessionStateTypeEntry(string name, xmlreader definition);</span>
        <span class="c">// public string Definition { get; }</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Format file configuration entry...</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="6166917bdff50809" href="../R/6166917bdff50809.html" target="n" data-glyph="0,0" class="t t">SessionStateFormatEntry</a> : <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads the entire formats file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">fileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="96ae628367065642" href="../R/96ae628367065642.html" target="n" data-glyph="72,1" class="t constructor">SessionStateFormatEntry</a>(<b>string</b> <span id="r13 rd" class="r13 r">fileName</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="s">&quot;*&quot;</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r13 r">fileName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r13 r">fileName</span>));
            }
 
            <a href="#f6108e84d6fcb004" class="i property">FileName</a> = <span class="r13 r">fileName</span>.<span class="i">Trim</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads all the format data specified in the formatTable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">formattable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="17357034946e1ef0" href="../R/17357034946e1ef0.html" target="n" data-glyph="72,1" class="t constructor">SessionStateFormatEntry</a>(<a href="../FormatAndOutput/common/DisplayDatabase/FormatTable.cs.html#c256da57a361dada" class="t t">FormatTable</a> <span id="r14 rd" class="r14 r">formattable</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="s">&quot;*&quot;</span>)
        {
            <b>if</b> (<span class="r14 r">formattable</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r14 r">formattable</span>));
            }
 
            <a href="#f35524b7b8c189d4" class="i property">Formattable</a> = <span class="r14 r">formattable</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Loads all the format data specified in the typeDefinition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">typeDefinition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="0d5d644502ef40e2" href="../R/0d5d644502ef40e2.html" target="n" data-glyph="72,1" class="t constructor">SessionStateFormatEntry</a>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f507ec3cc270989a" class="t t">ExtendedTypeDefinition</a> <span id="r15 rd" class="r15 r">typeDefinition</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="s">&quot;*&quot;</span>)
        {
            <b>if</b> (<span class="r15 r">typeDefinition</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r15 r">typeDefinition</span>));
            }
 
            <a href="#95b6a8b5869f7682" class="i property">FormatData</a> = <span class="r15 r">typeDefinition</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="0b411b5d7a3b62b8" href="../R/0b411b5d7a3b62b8.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a> <span id="r16 rd" class="r16 r">entry</span>;
 
            <b>if</b> (<a href="#f6108e84d6fcb004" class="i property">FileName</a> != <b>null</b>)
            {
                <span class="r16 r">entry</span> = <b>new</b> <a href="#96ae628367065642" class="t constructor">SessionStateFormatEntry</a>(<a href="#f6108e84d6fcb004" class="i property">FileName</a>);
            }
            <b>else</b> <b>if</b> (<a href="#f35524b7b8c189d4" class="i property">Formattable</a> != <b>null</b>)
            {
                <span class="r16 r">entry</span> = <b>new</b> <a href="#17357034946e1ef0" class="t constructor">SessionStateFormatEntry</a>(<a href="#f35524b7b8c189d4" class="i property">Formattable</a>);
            }
            <b>else</b>
            {
                <span class="r16 r">entry</span> = <b>new</b> <a href="#0d5d644502ef40e2" class="t constructor">SessionStateFormatEntry</a>(<a href="#95b6a8b5869f7682" class="i property">FormatData</a>);
            }
 
            <span class="r16 r">entry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<a href="#6166917bdff50809" class="k">this</a>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>);
            <span class="r16 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#6166917bdff50809" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r16 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the format file referenced by this entry...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="f6108e84d6fcb004" href="../R/f6108e84d6fcb004.html" target="n" data-glyph="102,1" class="i property">FileName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The FormatTable specified with constructor. This can be null if</span>
        <span class="c">///</span><span class="c"> FileName constructor is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../FormatAndOutput/common/DisplayDatabase/FormatTable.cs.html#c256da57a361dada" class="t t">FormatTable</a> <a id="f35524b7b8c189d4" href="../R/f35524b7b8c189d4.html" target="n" data-glyph="102,1" class="i property">Formattable</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The FormatData specified with constructor.</span>
        <span class="c">///</span><span class="c"> This can be null if the FileName or FormatTable constructors are used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f507ec3cc270989a" class="t t">ExtendedTypeDefinition</a> <a id="95b6a8b5869f7682" href="../R/95b6a8b5869f7682.html" target="n" data-glyph="102,1" class="i property">FormatData</a> { <b>get</b>; }
 
        <span class="c">// So that we can specify the format information on the fly,</span>
        <span class="c">// without using Format.ps1xml file</span>
        <span class="c">// public SessionStateFormatEntry(string name, xmlreader definition);</span>
        <span class="c">// public string Definition { get; }</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An assembly to load for this sessionstate...</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="94d9e7cde4269029" href="../R/94d9e7cde4269029.html" target="n" data-glyph="0,0" class="t t">SessionStateAssemblyEntry</a> : <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a named entry for the assembly to load with both the</span>
        <span class="c">///</span><span class="c"> name and the path to the assembly as a backup.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the assembly to load.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">fileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the assembly to use as an alternative.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="f7e880a795c5c912" href="../R/f7e880a795c5c912.html" target="n" data-glyph="72,1" class="t constructor">SessionStateAssemblyEntry</a>(<b>string</b> <span id="r17 rd" class="r17 r">name</span>, <b>string</b> <span id="r18 rd" class="r18 r">fileName</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="r17 r">name</span>)
        {
            <a href="#59415471a204963b" class="i property">FileName</a> = <span class="r18 r">fileName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a named entry for the assembly to load, specifying</span>
        <span class="c">///</span><span class="c"> just the name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the assembly to load.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="63e4668395cc229c" href="../R/63e4668395cc229c.html" target="n" data-glyph="72,1" class="t constructor">SessionStateAssemblyEntry</a>(<b>string</b> <span id="r19 rd" class="r19 r">name</span>)
            : <a href="#249a623c6625bfe1" class="k">base</a>(<span class="r19 r">name</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="f8e4dcf10d1182e6" href="../R/f8e4dcf10d1182e6.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a> <span id="r20 rd" class="r20 r">entry</span> = <b>new</b> <a href="#f7e880a795c5c912" class="t constructor">SessionStateAssemblyEntry</a>(<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <a href="#59415471a204963b" class="i property">FileName</a>);
            <span class="r20 r">entry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<a href="#94d9e7cde4269029" class="k">this</a>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>);
            <span class="r20 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#94d9e7cde4269029" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r20 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the assembly file name...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="59415471a204963b" href="../R/59415471a204963b.html" target="n" data-glyph="102,1" class="i property">FileName</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> List a cmdlet to add to this session state entry.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="0b9bc88597e005fb" href="../R/0b9bc88597e005fb.html" target="n" data-glyph="0,0" class="t t">SessionStateCmdletEntry</a> : <a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">implementingType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">helpFileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4d9ae226c8c55e34" href="../R/4d9ae226c8c55e34.html" target="n" data-glyph="72,1" class="t constructor">SessionStateCmdletEntry</a>(<b>string</b> <span id="r21 rd" class="r21 r">name</span>, <span class="i">Type</span> <span id="r22 rd" class="r22 r">implementingType</span>, <b>string</b> <span id="r23 rd" class="r23 r">helpFileName</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r21 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#41fc8f2889edf406" class="i property">ImplementingType</a> = <span class="r22 r">implementingType</span>;
            <a href="#42aafda58947f789" class="i property">HelpFileName</a> = <span class="r23 r">helpFileName</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">implementingType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">helpFileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">visibility</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="4bc6101fc079600c" href="../R/4bc6101fc079600c.html" target="n" data-glyph="74,1" class="t constructor">SessionStateCmdletEntry</a>(<b>string</b> <span id="r24 rd" class="r24 r">name</span>, <span class="i">Type</span> <span id="r25 rd" class="r25 r">implementingType</span>, <b>string</b> <span id="r26 rd" class="r26 r">helpFileName</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r27 rd" class="r27 r">visibility</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r24 r">name</span>, <span class="r27 r">visibility</span>)
        {
            <a href="#41fc8f2889edf406" class="i property">ImplementingType</a> = <span class="r25 r">implementingType</span>;
            <a href="#42aafda58947f789" class="i property">HelpFileName</a> = <span class="r26 r">helpFileName</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="76615fbd6ac85ce6" href="../R/76615fbd6ac85ce6.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r28 rd" class="r28 r">entry</span> = <b>new</b> <a href="#4bc6101fc079600c" class="t constructor">SessionStateCmdletEntry</a>(<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <a href="#41fc8f2889edf406" class="i property">ImplementingType</a>, <a href="#42aafda58947f789" class="i property">HelpFileName</a>, <a href="#190a59133ab9a4ce" class="i property">Visibility</a>);
            <span class="r28 r">entry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<a href="#0b9bc88597e005fb" class="k">this</a>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>);
            <span class="r28 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#0b9bc88597e005fb" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r28 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="41fc8f2889edf406" href="../R/41fc8f2889edf406.html" target="n" data-glyph="102,1" class="i property">ImplementingType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="42aafda58947f789" href="../R/42aafda58947f789.html" target="n" data-glyph="102,1" class="i property">HelpFileName</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="236a07b6fd3f0e39" href="../R/236a07b6fd3f0e39.html" target="n" data-glyph="0,0" class="t t">SessionStateProviderEntry</a> : <a href="#19b875558acd7f23" class="t t">ConstrainedSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">implementingType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">helpFileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="0b6d058465f1677f" href="../R/0b6d058465f1677f.html" target="n" data-glyph="72,1" class="t constructor">SessionStateProviderEntry</a>(<b>string</b> <span id="r29 rd" class="r29 r">name</span>, <span class="i">Type</span> <span id="r30 rd" class="r30 r">implementingType</span>, <b>string</b> <span id="r31 rd" class="r31 r">helpFileName</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r29 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#bcdd2ec5da2607ba" class="i property">ImplementingType</a> = <span class="r30 r">implementingType</span>;
            <a href="#ec3922c91455de72" class="i property">HelpFileName</a> = <span class="r31 r">helpFileName</span>;
        }
 
        <b>internal</b> <a id="6ef451270d1fbc5d" href="../R/6ef451270d1fbc5d.html" target="n" data-glyph="74,1" class="t constructor">SessionStateProviderEntry</a>(<b>string</b> <span id="r32 rd" class="r32 r">name</span>, <span class="i">Type</span> <span id="r33 rd" class="r33 r">implementingType</span>, <b>string</b> <span id="r34 rd" class="r34 r">helpFileName</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r35 rd" class="r35 r">visibility</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r32 r">name</span>, <span class="r35 r">visibility</span>)
        {
            <a href="#bcdd2ec5da2607ba" class="i property">ImplementingType</a> = <span class="r33 r">implementingType</span>;
            <a href="#ec3922c91455de72" class="i property">HelpFileName</a> = <span class="r34 r">helpFileName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="acb83e01c656d6ae" href="../R/acb83e01c656d6ae.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r36 rd" class="r36 r">entry</span> = <b>new</b> <a href="#6ef451270d1fbc5d" class="t constructor">SessionStateProviderEntry</a>(<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <a href="#bcdd2ec5da2607ba" class="i property">ImplementingType</a>, <a href="#ec3922c91455de72" class="i property">HelpFileName</a>, <a href="#236a07b6fd3f0e39" class="k">this</a>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a>);
            <span class="r36 r">entry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<a href="#236a07b6fd3f0e39" class="k">this</a>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>);
            <span class="r36 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#236a07b6fd3f0e39" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r36 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="bcdd2ec5da2607ba" href="../R/bcdd2ec5da2607ba.html" target="n" data-glyph="102,1" class="i property">ImplementingType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ec3922c91455de72" href="../R/ec3922c91455de72.html" target="n" data-glyph="102,1" class="i property">HelpFileName</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="12337c12cd2f1655" href="../R/12337c12cd2f1655.html" target="n" data-glyph="0,0" class="t t">SessionStateScriptEntry</a> : <a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a session state command entry instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="3a9f48339203789d" href="../R/3a9f48339203789d.html" target="n" data-glyph="72,1" class="t constructor">SessionStateScriptEntry</a>(<b>string</b> <span id="r37 rd" class="r37 r">path</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r37 r">path</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#115c82d31987b9b7" class="i property">Path</a> = <span class="r37 r">path</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a session state command entry instance with the specified visibility.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">visibility</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Visibility of the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="bb407c7b7c528370" href="../R/bb407c7b7c528370.html" target="n" data-glyph="74,1" class="t constructor">SessionStateScriptEntry</a>(<b>string</b> <span id="r38 rd" class="r38 r">path</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r39 rd" class="r39 r">visibility</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r38 r">path</span>, <span class="r39 r">visibility</span>)
        {
            <a href="#115c82d31987b9b7" class="i property">Path</a> = <span class="r38 r">path</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="5e982ee332ace39e" href="../R/5e982ee332ace39e.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#12337c12cd2f1655" class="t t">SessionStateScriptEntry</a> <span id="r40 rd" class="r40 r">entry</span> = <b>new</b> <a href="#bb407c7b7c528370" class="t constructor">SessionStateScriptEntry</a>(<a href="#115c82d31987b9b7" class="i property">Path</a>, <a href="#190a59133ab9a4ce" class="i property">Visibility</a>);
            <span class="r40 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#12337c12cd2f1655" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r40 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="115c82d31987b9b7" href="../R/115c82d31987b9b7.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="3164e16488ced1ed" href="../R/3164e16488ced1ed.html" target="n" data-glyph="0,0" class="t t">SessionStateAliasEntry</a> : <a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define an alias entry to add to the initial session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the alias entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">definition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command it resolves to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4bd20ec48e504a74" href="../R/4bd20ec48e504a74.html" target="n" data-glyph="72,1" class="t constructor">SessionStateAliasEntry</a>(<b>string</b> <span id="r41 rd" class="r41 r">name</span>, <b>string</b> <span id="r42 rd" class="r42 r">definition</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r41 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#297512f106ee62c3" class="i property">Definition</a> = <span class="r42 r">definition</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define an alias entry to add to the initial session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the alias entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">definition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command it resolves to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A description of the purpose of the alias.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="2727131b1bd042d0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SessionStateAliasEntry</a>(<b>string</b> <span id="r43 rd" class="r43 r">name</span>, <b>string</b> <span id="r44 rd" class="r44 r">definition</span>, <b>string</b> <span id="r45 rd" class="r45 r">description</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r43 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#297512f106ee62c3" class="i property">Definition</a> = <span class="r44 r">definition</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a>;
            <a href="#447c05237d17c835" class="i property">Description</a> = <span class="r45 r">description</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define an alias entry to add to the initial session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the alias entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">definition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command it resolves to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A description of the purpose of the alias.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Options defining the scope visibility, readonly and constant.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="aacd5d8e74250ee7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SessionStateAliasEntry</a>(<b>string</b> <span id="r46 rd" class="r46 r">name</span>, <b>string</b> <span id="r47 rd" class="r47 r">definition</span>, <b>string</b> <span id="r48 rd" class="r48 r">description</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r49 rd" class="r49 r">options</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r46 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#297512f106ee62c3" class="i property">Definition</a> = <span class="r47 r">definition</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a>;
            <a href="#447c05237d17c835" class="i property">Description</a> = <span class="r48 r">description</span>;
            <a href="#a42733e1fa40471e" class="i property">Options</a> = <span class="r49 r">options</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define an alias entry to add to the initial session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the alias entry to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">definition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command it resolves to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A description of the purpose of the alias.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Options defining the scope visibility, readonly and constant.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">visibility</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="99c934c9c34c5ab5" href="../R/99c934c9c34c5ab5.html" target="n" data-glyph="74,1" class="t constructor">SessionStateAliasEntry</a>(<b>string</b> <span id="r50 rd" class="r50 r">name</span>, <b>string</b> <span id="r51 rd" class="r51 r">definition</span>, <b>string</b> <span id="r52 rd" class="r52 r">description</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r53 rd" class="r53 r">options</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r54 rd" class="r54 r">visibility</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r50 r">name</span>, <span class="r54 r">visibility</span>)
        {
            <a href="#297512f106ee62c3" class="i property">Definition</a> = <span class="r51 r">definition</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a>;
            <a href="#447c05237d17c835" class="i property">Description</a> = <span class="r52 r">description</span>;
            <a href="#a42733e1fa40471e" class="i property">Options</a> = <span class="r53 r">options</span>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="81afaf7e4b7986d5" href="../R/81afaf7e4b7986d5.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a> <span id="r55 rd" class="r55 r">entry</span> = <b>new</b> <a href="#99c934c9c34c5ab5" class="t constructor">SessionStateAliasEntry</a>(<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <a href="#297512f106ee62c3" class="i property">Definition</a>, <a href="#447c05237d17c835" class="i property">Description</a>, <a href="#a42733e1fa40471e" class="i property">Options</a>, <a href="#190a59133ab9a4ce" class="i property">Visibility</a>);
            <span class="r55 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#3164e16488ced1ed" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r55 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string defining the body of this alias...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="297512f106ee62c3" href="../R/297512f106ee62c3.html" target="n" data-glyph="102,1" class="i property">Definition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string describing this alias...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="447c05237d17c835" href="../R/447c05237d17c835.html" target="n" data-glyph="102,1" class="i property">Description</a> { <b>get</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Options controling scope visibility and setability for this entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <a id="a42733e1fa40471e" href="../R/a42733e1fa40471e.html" target="n" data-glyph="102,1" class="i property">Options</a> { <b>get</b>; } = <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="eac0c2c0c238d4f8" href="../R/eac0c2c0c238d4f8.html" target="n" data-glyph="0,0" class="t t">SessionStateApplicationEntry</a> : <a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to define a permitted script in this session state. If the path is</span>
        <span class="c">///</span><span class="c"> &quot;*&quot;, then any path is permitted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The full path to the application.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="14a66570cd93b0f4" href="../R/14a66570cd93b0f4.html" target="n" data-glyph="72,1" class="t constructor">SessionStateApplicationEntry</a>(<b>string</b> <span id="r56 rd" class="r56 r">path</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r56 r">path</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#a3e8a804e4103471" class="i property">Path</a> = <span class="r56 r">path</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#f4fc4c6de9082bc5" class="i field">Application</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to define a permitted script in this session state. If the path is</span>
        <span class="c">///</span><span class="c"> &quot;*&quot;, then any path is permitted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The full path to the application.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">visibility</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sets the external visibility of the path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="383b24c152b1a5cc" href="../R/383b24c152b1a5cc.html" target="n" data-glyph="74,1" class="t constructor">SessionStateApplicationEntry</a>(<b>string</b> <span id="r57 rd" class="r57 r">path</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r58 rd" class="r58 r">visibility</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r57 r">path</span>, <span class="r58 r">visibility</span>)
        {
            <a href="#a3e8a804e4103471" class="i property">Path</a> = <span class="r57 r">path</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#f4fc4c6de9082bc5" class="i field">Application</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="6c5dfedb63466c72" href="../R/6c5dfedb63466c72.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#eac0c2c0c238d4f8" class="t t">SessionStateApplicationEntry</a> <span id="r59 rd" class="r59 r">entry</span> = <b>new</b> <a href="#383b24c152b1a5cc" class="t constructor">SessionStateApplicationEntry</a>(<a href="#a3e8a804e4103471" class="i property">Path</a>, <a href="#190a59133ab9a4ce" class="i property">Visibility</a>);
            <span class="r59 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#eac0c2c0c238d4f8" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r59 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path to this application...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="a3e8a804e4103471" href="../R/a3e8a804e4103471.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="24449f380379f027" href="../R/24449f380379f027.html" target="n" data-glyph="0,0" class="t t">SessionStateFunctionEntry</a> : <a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents a function definition in an Initial session state object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">definition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The definition of the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Options controlling scope-related elements of this object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">helpFile</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the help file associated with the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="fc407b14c1e89918" href="../R/fc407b14c1e89918.html" target="n" data-glyph="72,1" class="t constructor">SessionStateFunctionEntry</a>(<b>string</b> <span id="r60 rd" class="r60 r">name</span>, <b>string</b> <span id="r61 rd" class="r61 r">definition</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r62 rd" class="r62 r">options</span>, <b>string</b> <span id="r63 rd" class="r63 r">helpFile</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r60 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#966c1b827713f324" class="i property">Definition</a> = <span class="r61 r">definition</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a>;
            <a href="#2517aa46af982da4" class="i property">Options</a> = <span class="r62 r">options</span>;
            <a href="#76dc29438cc77053" class="i property">ScriptBlock</a> = <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#adfac0fa7bf5725f" class="i method">Create</a>(<a href="#966c1b827713f324" class="i property">Definition</a>);
            <a href="#76dc29438cc77053" class="i property">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#5e76a9fb0d1a7f12" class="i property">LanguageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
 
            <a href="#59788cdb33190362" class="i property">HelpFile</a> = <span class="r63 r">helpFile</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents a function definition in an Initial session state object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">definition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The definition of the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">helpFile</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the help file associated with the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8f00e2d7431409e7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SessionStateFunctionEntry</a>(<b>string</b> <span id="r64 rd" class="r64 r">name</span>, <b>string</b> <span id="r65 rd" class="r65 r">definition</span>, <b>string</b> <span id="r66 rd" class="r66 r">helpFile</span>)
            : <a href="#fc407b14c1e89918" class="k">this</a>(<span class="r64 r">name</span>, <span class="r65 r">definition</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>, <span class="r66 r">helpFile</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents a function definition in an Initial session state object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">definition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The definition of the function.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="bc476ab00cd4640b" href="../R/bc476ab00cd4640b.html" target="n" data-glyph="72,1" class="t constructor">SessionStateFunctionEntry</a>(<b>string</b> <span id="r67 rd" class="r67 r">name</span>, <b>string</b> <span id="r68 rd" class="r68 r">definition</span>)
            : <a href="#fc407b14c1e89918" class="k">this</a>(<span class="r67 r">name</span>, <span class="r68 r">definition</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is an internal copy constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="99aaead324190b87" href="../R/99aaead324190b87.html" target="n" data-glyph="74,1" class="t constructor">SessionStateFunctionEntry</a>(<b>string</b> <span id="r69 rd" class="r69 r">name</span>, <b>string</b> <span id="r70 rd" class="r70 r">definition</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r71 rd" class="r71 r">options</span>,
            <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r72 rd" class="r72 r">visibility</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r73 rd" class="r73 r">scriptBlock</span>, <b>string</b> <span id="r74 rd" class="r74 r">helpFile</span>)
            : <a href="#6a0a7a84ea204fd0" class="k">base</a>(<span class="r69 r">name</span>, <span class="r72 r">visibility</span>)
        {
            <a href="#966c1b827713f324" class="i property">Definition</a> = <span class="r70 r">definition</span>;
            <a href="#b86d5dd7cdc3f952" class="i property">CommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a>;
            <a href="#2517aa46af982da4" class="i property">Options</a> = <span class="r71 r">options</span>;
            <a href="#76dc29438cc77053" class="i property">ScriptBlock</a> = <span class="r73 r">scriptBlock</span>;
            <a href="#59788cdb33190362" class="i property">HelpFile</a> = <span class="r74 r">helpFile</span>;
        }
 
        <b>internal static</b> <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a> <a id="bac9a5c925503f9b" href="../R/bac9a5c925503f9b.html" target="n" data-glyph="74,1" class="i method">GetDelayParsedFunctionEntry</a>(<b>string</b> <span id="r75 rd" class="r75 r">name</span>, <b>string</b> <span id="r76 rd" class="r76 r">definition</span>, <b>bool</b> <span id="r77 rd" class="r77 r">isProductCode</span>, <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <span id="r78 rd" class="r78 r">languageMode</span>)
        {
            <a href="#24449f380379f027" class="k">var</a> <span id="r79 rd" class="r79 r">fnEntry</span> = <a href="#09642dac506b3c56" class="i method">GetDelayParsedFunctionEntry</a>(<span class="r75 r">name</span>, <span class="r76 r">definition</span>, <span class="r77 r">isProductCode</span>);
            <span class="r79 r">fnEntry</span>.<a href="#76dc29438cc77053" class="i property">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#5e76a9fb0d1a7f12" class="i property">LanguageMode</a> = <span class="r78 r">languageMode</span>;
            <b>return</b> <span class="r79 r">fnEntry</span>;
        }
 
        <b>internal static</b> <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a> <a id="09642dac506b3c56" href="../R/09642dac506b3c56.html" target="n" data-glyph="74,1" class="i method">GetDelayParsedFunctionEntry</a>(<b>string</b> <span id="r80 rd" class="r80 r">name</span>, <b>string</b> <span id="r81 rd" class="r81 r">definition</span>, <b>bool</b> <span id="r82 rd" class="r82 r">isProductCode</span>)
        {
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="k">var</a> <span id="r83 rd" class="r83 r">sb</span> = <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#5855871887dc8453" class="i method">CreateDelayParsedScriptBlock</a>(<span class="r81 r">definition</span>, <span class="r82 r">isProductCode</span>);
            <b>return</b> <b>new</b> <a href="#99aaead324190b87" class="t constructor">SessionStateFunctionEntry</a>(<span class="r80 r">name</span>, <span class="r81 r">definition</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>, <span class="r83 r">sb</span>, <b>null</b>);
        }
 
        <b>internal static</b> <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a> <a id="d074067fb6fc9051" href="../R/d074067fb6fc9051.html" target="n" data-glyph="74,1" class="i method">GetDelayParsedFunctionEntry</a>(<b>string</b> <span id="r84 rd" class="r84 r">name</span>, <b>string</b> <span id="r85 rd" class="r85 r">definition</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r86 rd" class="r86 r">sb</span>)
        {
            <b>return</b> <b>new</b> <a href="#99aaead324190b87" class="t constructor">SessionStateFunctionEntry</a>(<span class="r84 r">name</span>, <span class="r85 r">definition</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>, <span class="r86 r">sb</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="d3935b3f343f2711" href="../R/d3935b3f343f2711.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a> <span id="r87 rd" class="r87 r">entry</span> = <b>new</b> <a href="#99aaead324190b87" class="t constructor">SessionStateFunctionEntry</a>(<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <a href="#966c1b827713f324" class="i property">Definition</a>, <a href="#2517aa46af982da4" class="i property">Options</a>, <a href="#190a59133ab9a4ce" class="i property">Visibility</a>, <a href="#76dc29438cc77053" class="i property">ScriptBlock</a>, <a href="#59788cdb33190362" class="i property">HelpFile</a>);
            <span class="r87 r">entry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<a href="#24449f380379f027" class="k">this</a>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>);
            <b>return</b> <span class="r87 r">entry</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the name of the help file associated with the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e154d5dff9333d37" href="../R/e154d5dff9333d37.html" target="n" data-glyph="74,1" class="i method">SetHelpFile</a>(<b>string</b> <span id="r88 rd" class="r88 r">help</span>)
        {
            <a href="#59788cdb33190362" class="i property">HelpFile</a> = <span class="r88 r">help</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string to use to define this function...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="966c1b827713f324" href="../R/966c1b827713f324.html" target="n" data-glyph="102,1" class="i property">Definition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block for this function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="76dc29438cc77053" href="../R/76dc29438cc77053.html" target="n" data-glyph="104,1" class="i property">ScriptBlock</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Options controling scope visibility and setability for this entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <a id="2517aa46af982da4" href="../R/2517aa46af982da4.html" target="n" data-glyph="102,1" class="i property">Options</a> { <b>get</b>; } = <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the help file associated with the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="59788cdb33190362" href="../R/59788cdb33190362.html" target="n" data-glyph="102,1" class="i property">HelpFile</a> { <b>get</b>; <b>private set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="e9cb85ffa57e9548" href="../R/e9cb85ffa57e9548.html" target="n" data-glyph="0,0" class="t t">SessionStateVariableEntry</a> : <a href="#19b875558acd7f23" class="t t">ConstrainedSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is used to define a variable that should be created when</span>
        <span class="c">///</span><span class="c"> the runspace is opened. Note - if this object is cloned,</span>
        <span class="c">///</span><span class="c"> then the clone will contain a reference to the original object</span>
        <span class="c">///</span><span class="c"> not a clone of it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to set the variable to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A descriptive string to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="6c3963d3cd1a6cc3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SessionStateVariableEntry</a>(<b>string</b> <span id="r89 rd" class="r89 r">name</span>, <b>object</b> <span id="r90 rd" class="r90 r">value</span>, <b>string</b> <span id="r91 rd" class="r91 r">description</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r89 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#aba39087490e68e6" class="i property">Value</a> = <span class="r90 r">value</span>;
            <a href="#224f1cd8e7066c04" class="i property">Description</a> = <span class="r91 r">description</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is used to define a variable that should be created when</span>
        <span class="c">///</span><span class="c"> the runspace is opened. Note - if this object is cloned,</span>
        <span class="c">///</span><span class="c"> then the clone will contain a reference to the original object</span>
        <span class="c">///</span><span class="c"> not a clone of it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to set the variable to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A descriptive string to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Options like readonly, constant, allscope, etc.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="9be00875f9b1020d" href="../R/9be00875f9b1020d.html" target="n" data-glyph="72,1" class="t constructor">SessionStateVariableEntry</a>(<b>string</b> <span id="r92 rd" class="r92 r">name</span>, <b>object</b> <span id="r93 rd" class="r93 r">value</span>, <b>string</b> <span id="r94 rd" class="r94 r">description</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r95 rd" class="r95 r">options</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r92 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#aba39087490e68e6" class="i property">Value</a> = <span class="r93 r">value</span>;
            <a href="#224f1cd8e7066c04" class="i property">Description</a> = <span class="r94 r">description</span>;
            <a href="#c9c5e0f45aad68f8" class="i property">Options</a> = <span class="r95 r">options</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is used to define a variable that should be created when</span>
        <span class="c">///</span><span class="c"> the runspace is opened. Note - if this object is cloned,</span>
        <span class="c">///</span><span class="c"> then the clone will contain a reference to the original object</span>
        <span class="c">///</span><span class="c"> not a clone of it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to set the variable to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A descriptive string to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Options like readonly, constant, allscope, etc.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A list of attributes to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="27e744dd02ded935" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SessionStateVariableEntry</a>(<b>string</b> <span id="r96 rd" class="r96 r">name</span>, <b>object</b> <span id="r97 rd" class="r97 r">value</span>, <b>string</b> <span id="r98 rd" class="r98 r">description</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r99 rd" class="r99 r">options</span>, <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <span id="r100 rd" class="r100 r">attributes</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r96 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#aba39087490e68e6" class="i property">Value</a> = <span class="r97 r">value</span>;
            <a href="#224f1cd8e7066c04" class="i property">Description</a> = <span class="r98 r">description</span>;
            <a href="#c9c5e0f45aad68f8" class="i property">Options</a> = <span class="r99 r">options</span>;
            <a href="#4131302275b59fb8" class="i field">_attributes</a> = <span class="r100 r">attributes</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is used to define a variable that should be created when</span>
        <span class="c">///</span><span class="c"> the runspace is opened. Note - if this object is cloned,</span>
        <span class="c">///</span><span class="c"> then the clone will contain a reference to the original object</span>
        <span class="c">///</span><span class="c"> not a clone of it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to set the variable to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A descriptive string to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Options like readonly, constant, allscope, etc.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">attribute</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A single attribute to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="fd6486f0bf8776c9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">SessionStateVariableEntry</a>(<b>string</b> <span id="r101 rd" class="r101 r">name</span>, <b>object</b> <span id="r102 rd" class="r102 r">value</span>, <b>string</b> <span id="r103 rd" class="r103 r">description</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r104 rd" class="r104 r">options</span>, <span class="i">Attribute</span> <span id="r105 rd" class="r105 r">attribute</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r101 r">name</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
        {
            <a href="#aba39087490e68e6" class="i property">Value</a> = <span class="r102 r">value</span>;
            <a href="#224f1cd8e7066c04" class="i property">Description</a> = <span class="r103 r">description</span>;
            <a href="#c9c5e0f45aad68f8" class="i property">Options</a> = <span class="r104 r">options</span>;
            <a href="#4131302275b59fb8" class="i field">_attributes</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;();
            <a href="#4131302275b59fb8" class="i field">_attributes</a>.<span class="i">Add</span>(<span class="r105 r">attribute</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is used to define a variable that should be created when</span>
        <span class="c">///</span><span class="c"> the runspace is opened. Note - if this object is cloned,</span>
        <span class="c">///</span><span class="c"> then the clone will contain a reference to the original object</span>
        <span class="c">///</span><span class="c"> not a clone of it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to set the variable to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A descriptive string to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Options like readonly, constant, allscope, etc.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">attributes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A single attribute to attach to the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">visibility</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="9fbc237e16b48af7" href="../R/9fbc237e16b48af7.html" target="n" data-glyph="74,1" class="t constructor">SessionStateVariableEntry</a>(<b>string</b> <span id="r106 rd" class="r106 r">name</span>, <b>object</b> <span id="r107 rd" class="r107 r">value</span>, <b>string</b> <span id="r108 rd" class="r108 r">description</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r109 rd" class="r109 r">options</span>, <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <span id="r110 rd" class="r110 r">attributes</span>, <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <span id="r111 rd" class="r111 r">visibility</span>)
            : <a href="#3fc5d1b57744e428" class="k">base</a>(<span class="r106 r">name</span>, <span class="r111 r">visibility</span>)
        {
            <a href="#aba39087490e68e6" class="i property">Value</a> = <span class="r107 r">value</span>;
            <a href="#224f1cd8e7066c04" class="i property">Description</a> = <span class="r108 r">description</span>;
            <a href="#c9c5e0f45aad68f8" class="i property">Options</a> = <span class="r109 r">options</span>;
            <a href="#4131302275b59fb8" class="i field">_attributes</a> = <span class="r110 r">attributes</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow-clone this object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a> <a id="59a65cc312e71c86" href="../R/59a65cc312e71c86.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <span class="c">// Copy the attribute collection if necessary...</span>
            <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <span id="r112 rd" class="r112 r">attrs</span> = <b>null</b>;
            <b>if</b> (<a href="#4131302275b59fb8" class="i field">_attributes</a> != <b>null</b> &amp;&amp; <a href="#4131302275b59fb8" class="i field">_attributes</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r112 r">attrs</span> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;(<a href="#4131302275b59fb8" class="i field">_attributes</a>);
            }
 
            <b>return</b> <b>new</b> <a href="#9fbc237e16b48af7" class="t constructor">SessionStateVariableEntry</a>(<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <a href="#aba39087490e68e6" class="i property">Value</a>, <a href="#224f1cd8e7066c04" class="i property">Description</a>, <a href="#c9c5e0f45aad68f8" class="i property">Options</a>, <span class="r112 r">attrs</span>, <a href="#190a59133ab9a4ce" class="i property">Visibility</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value to bind to this variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="aba39087490e68e6" href="../R/aba39087490e68e6.html" target="n" data-glyph="102,1" class="i property">Value</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The description associated with this variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="224f1cd8e7066c04" href="../R/224f1cd8e7066c04.html" target="n" data-glyph="102,1" class="i property">Description</a> { <b>get</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The options associated with this variable (e.g. readonly, allscope, etc.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <a id="c9c5e0f45aad68f8" href="../R/c9c5e0f45aad68f8.html" target="n" data-glyph="102,1" class="i property">Options</a> { <b>get</b>; } = <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The attributes that will be attached to this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <a id="fe528c10a1448fbb" href="../R/fe528c10a1448fbb.html" target="n" data-glyph="102,1" class="i property">Attributes</a>
        {
            <b>get</b> { <b>return</b> <a href="#4131302275b59fb8" class="i field">_attributes</a> ??= <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;(); }
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <a id="4131302275b59fb8" href="../R/4131302275b59fb8.html" target="n" data-glyph="46,1" class="i field">_attributes</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="d3dc56d6666ca9c3" href="../R/d3dc56d6666ca9c3.html" target="n" data-glyph="0,0" class="t t">InitialSessionStateEntryCollection</a>&lt;<span id="r113 rd t" class="r113 r t">T</span>&gt; : <span class="i">IEnumerable</span>&lt;<span class="r113 r t">T</span>&gt; <b>where</b> <span class="r113 r t">T</span> : <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create an empty collection...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="e636b417165a85b5" href="../R/e636b417165a85b5.html" target="n" data-glyph="72,1" class="t constructor">InitialSessionStateEntryCollection</a>()
        {
            <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create an new collection, copying in the passed items...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">items</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4aba610f9f8c0e34" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InitialSessionStateEntryCollection</a>(<span class="i">IEnumerable</span>&lt;<span class="r113 r t">T</span>&gt; <span id="r114 rd" class="r114 r">items</span>)
        {
            <b>if</b> (<span class="r114 r">items</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r114 r">items</span>));
            }
 
            <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt;();
 
            <b>foreach</b> (<span class="r113 r t">T</span> <span id="r115 rd" class="r115 r">item</span> <b>in</b> <span class="r114 r">items</span>)
            {
                <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">Add</span>(<span class="r115 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clone this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned collection.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<span class="r113 r t">T</span>&gt; <a id="e37d6cbda3711bb5" href="../R/e37d6cbda3711bb5.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<span class="r113 r t">T</span>&gt; <span id="r116 rd" class="r116 r">result</span>;
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <span class="r116 r">result</span> = <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<span class="r113 r t">T</span>&gt;();
 
                <b>foreach</b> (<span class="r113 r t">T</span> <span id="r117 rd" class="r117 r">item</span> <b>in</b> <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>)
                {
                    <span class="r116 r">result</span>.<a href="#048e6fba5da66395" class="i method">Add</a>((<span class="r113 r t">T</span>)<span class="r117 r">item</span>.<span class="i">Clone</span>());
                }
            }
 
            <b>return</b> <span class="r116 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reset the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a1bd9475751e8d74" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">Clear</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a count of the number of items in the collection...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="c6493cb5fe089abd" href="../R/c6493cb5fe089abd.html" target="n" data-glyph="102,1" class="i property">Count</a>
        {
            <b>get</b> { <b>return</b> <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">Count</span>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="r113 r t">T</span> <a id="3d898a31812ca39e" href="../R/3d898a31812ca39e.html" target="n" data-glyph="102,1" class="k">this</a>[<b>int</b> <span id="r118 rd" class="r118 r">index</span>]
        {
            <b>get</b>
            {
                <span class="r113 r t">T</span> <span id="r119 rd" class="r119 r">result</span>;
                <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
                {
                    <span class="r119 r">result</span> = <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>[<span class="r118 r">index</span>];
                }
 
                <b>return</b> <span class="r119 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To find the entries based on name.</span>
        <span class="c">///</span><span class="c"> Why collection - Different SnapIn/modules and same entity names.</span>
        <span class="c">///</span><span class="c"> If used on command collection entry, then for the same name, one can have multiple output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt; <a id="8a6a2b8d34f0d716" href="../R/8a6a2b8d34f0d716.html" target="n" data-glyph="102,1" class="k">this</a>[<b>string</b> <span id="r120 rd" class="r120 r">name</span>]
        {
            <b>get</b>
            {
                <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt; <span id="r121 rd" class="r121 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt;();
                <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
                {
                    <b>foreach</b> (<span class="r113 r t">T</span> <span id="r122 rd" class="r122 r">element</span> <b>in</b> <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>)
                    {
                        <b>if</b> (<span class="r122 r">element</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="r120 r">name</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r121 r">result</span>.<span class="i">Add</span>(<span class="r122 r">element</span>);
                        }
                    }
                }
 
                <b>return</b> <span class="r121 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Find entries based on string name which can include wildcards.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt; <a id="f4cd69ee4353c4ac" href="../R/f4cd69ee4353c4ac.html" target="n" data-glyph="74,1" class="i method">LookUpByName</a>(<b>string</b> <span id="r123 rd" class="r123 r">name</span>)
        {
            <b>if</b> (<span class="r123 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r123 r">name</span>));
            }
 
            <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt; <span id="r124 rd" class="r124 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt;();
            <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r125 rd" class="r125 r">namePattern</span> = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r123 r">name</span>, <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <b>foreach</b> (<span class="r113 r t">T</span> <span id="r126 rd" class="r126 r">element</span> <b>in</b> <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>)
                {
                    <b>if</b> (<span class="r125 r">namePattern</span>.<span class="i">IsMatch</span>(<span class="r126 r">element</span>.<span class="i">Name</span>))
                    {
                        <span class="r124 r">result</span>.<span class="i">Add</span>(<span class="r126 r">element</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r124 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="db54cea4d8acd00a" href="../R/db54cea4d8acd00a.html" target="n" data-glyph="72,1" class="i method">RemoveItem</a>(<b>int</b> <span id="r127 rd" class="r127 r">index</span>)
        {
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">RemoveAt</span>(<span class="r127 r">index</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove a number of items starting at the specified index.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">count</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a0cfc2d69c6d0eb4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">RemoveItem</a>(<b>int</b> <span id="r128 rd" class="r128 r">index</span>, <b>int</b> <span id="r129 rd" class="r129 r">count</span>)
        {
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <b>while</b> (<span class="r129 r">count</span>-- &gt; 0)
                {
                    <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">RemoveAt</span>(<span class="r128 r">index</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the collection...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="9c6f481e94fc74d5" href="../R/9c6f481e94fc74d5.html" target="n" data-glyph="72,1" class="i method">Clear</a>()
        {
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">Clear</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This overload exists so that we can remove items based on the item name, rather than</span>
        <span class="c">///</span><span class="c"> its position in the collection. The type argument can be null but we&#39;ll throw an error if</span>
        <span class="c">///</span><span class="c"> we can&#39;t distinguish between multiple entries of the same name but different types</span>
        <span class="c">///</span><span class="c"> and the type hasn&#39;t been specified.</span>
        <span class="c">///</span><span class="c"> BUGBUG - brucepay - the throw thing is not implemented yet...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the element to remove.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of object to remove, can be null to remove any type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="07ae5d946695a03c" href="../R/07ae5d946695a03c.html" target="n" data-glyph="72,1" class="i method">Remove</a>(<b>string</b> <span id="r130 rd" class="r130 r">name</span>, <b>object</b> <span id="r131 rd" class="r131 r">type</span>)
        {
            <b>if</b> (<span class="r130 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r130 r">name</span>));
            }
 
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <span class="i">Type</span> <span id="r132 rd" class="r132 r">objType</span> = <b>null</b>;
 
                <b>if</b> (<span class="r131 r">type</span> != <b>null</b>)
                {
                    <span class="r132 r">objType</span> = <span class="r131 r">type</span> <b>as</b> <span class="i">Type</span> ?? <span class="r131 r">type</span>.<span class="i">GetType</span>();
                }
 
                <span class="c">// Work backwards through the collection...</span>
                <b>for</b> (<b>int</b> <span id="r133 rd" class="r133 r">i</span> = <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">Count</span> - 1; <span class="r133 r">i</span> &gt;= 0; <span class="r133 r">i</span>--)
                {
                    <span class="r113 r t">T</span> <span id="r134 rd" class="r134 r">element</span> = <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>[<span class="r133 r">i</span>];
                    <b>if</b> (<span class="r134 r">element</span> == <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>if</b> ((<span class="r132 r">objType</span> == <b>null</b> || <span class="r134 r">element</span>.<span class="i">GetType</span>() == <span class="r132 r">objType</span>) &amp;&amp;
                        <b>string</b>.<span class="i">Equals</span>(<span class="r134 r">element</span>.<span class="i">Name</span>, <span class="r130 r">name</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">RemoveAt</span>(<span class="r133 r">i</span>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add an item to this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The item to add...</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="048e6fba5da66395" href="../R/048e6fba5da66395.html" target="n" data-glyph="72,1" class="i method">Add</a>(<span class="r113 r t">T</span> <span id="r135 rd" class="r135 r">item</span>)
        {
            <b>if</b> (<span class="r135 r">item</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r135 r">item</span>));
            }
 
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">Add</span>(<span class="r135 r">item</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add items to this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">items</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d0fff4d5edd0f5ac" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<span class="i">IEnumerable</span>&lt;<span class="r113 r t">T</span>&gt; <span id="r136 rd" class="r136 r">items</span>)
        {
            <b>if</b> (<span class="r136 r">items</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r136 r">items</span>));
            }
 
            <b>lock</b> (<a href="#470a12df2c011e66" class="i field">_syncObject</a>)
            {
                <b>foreach</b> (<span class="r113 r t">T</span> <span id="r137 rd" class="r137 r">element</span> <b>in</b> <span class="r136 r">items</span>)
                {
                    <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">Add</span>(<span class="r137 r">element</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get enumerator for this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> Enumerator work is not thread safe by default. Any code trying</span>
        <span class="c">///</span><span class="c"> to do enumeration on this collection should lock it first.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Need to document this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <span class="i">IEnumerator</span> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">IEnumerable</span>.<a id="967b1dc0a21de535" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">GetEnumerator</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get enumerator for this collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> Enumerator work is not thread safe by default. Any code trying</span>
        <span class="c">///</span><span class="c"> to do enumeration on this collection should lock it first.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Need to document this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <span class="i">IEnumerator</span>&lt;<span class="r113 r t">T</span>&gt; <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>.<span class="i">IEnumerable</span>&lt;<span class="r113 r t">T</span>&gt;.<a id="3db2c8f1d23c95c6" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#3e8e93ad71702bda" class="i field">_internalCollection</a>.<span class="i">GetEnumerator</span>();
        }
 
        <b>private readonly</b> <span class="i">Collection</span>&lt;<span class="r113 r t">T</span>&gt; <a id="3e8e93ad71702bda" href="../R/3e8e93ad71702bda.html" target="n" data-glyph="46,1" class="i field">_internalCollection</a>;
 
        <span class="c">// object to use for locking</span>
        <b>private readonly object</b> <a id="470a12df2c011e66" href="../R/470a12df2c011e66.html" target="n" data-glyph="46,1" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Allows you to define the set of elements that should be</span>
    <span class="c">///</span><span class="c"> present when Session State is created.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b17f88d4755d5fd7" href="../R/b17f88d4755d5fd7.html" target="n" data-glyph="0,0" class="t t">InitialSessionState</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helper methods for restricting commands needed by implicit and interactive remoting
 
        <b>private static void</b> <a id="602e3a9bdb3c6de8" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RemoveDisallowedEntries</a>&lt;<span id="r138 rd t" class="r138 r t">T</span>&gt;(<a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<span class="r138 r t">T</span>&gt; <span id="r139 rd" class="r139 r">list</span>, <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r140 rd" class="r140 r">allowedNames</span>, <span class="i">Func</span>&lt;<span class="r138 r t">T</span>, <b>string</b>&gt; <span id="r141 rd" class="r141 r">nameGetter</span>)
            <b>where</b> <span class="r138 r t">T</span> : <a href="#e74d4df9b9eaad36" class="t t">InitialSessionStateEntry</a>
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r142 rd" class="r142 r">namesToRemove</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<span class="r138 r t">T</span> <span id="r143 rd" class="r143 r">entry</span> <b>in</b> <span class="r139 r">list</span>)
            {
                <b>string</b> <span id="r144 rd" class="r144 r">entryName</span> = <span class="r141 r">nameGetter</span>(<span class="r143 r">entry</span>);
 
                <span class="c">// if entryName is not present in allowedNames list, then remove it</span>
                <b>if</b> (!<span class="r140 r">allowedNames</span>.<span class="i">Exists</span>(<span id="r145 rd" class="r145 r">allowedName</span> =&gt; <span class="r145 r">allowedName</span>.<span class="i">Equals</span>(<span class="r144 r">entryName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <span class="r142 r">namesToRemove</span>.<span class="i">Add</span>(<span class="r143 r">entry</span>.<span class="i">Name</span>);
                }
            }
 
            <b>foreach</b> (<b>string</b> <span id="r146 rd" class="r146 r">nameToRemove</span> <b>in</b> <span class="r142 r">namesToRemove</span>)
            {
                <span class="r139 r">list</span>.<a href="#07ae5d946695a03c" class="i method">Remove</a>(<span class="r146 r">nameToRemove</span>, <b>null</b> <span class="c">/* remove any type with this name */</span>);
            }
        }
 
        <b>private static void</b> <a id="c774ab7e7d35cdd3" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">MakeDisallowedEntriesPrivate</a>&lt;<span id="r147 rd t" class="r147 r t">T</span>&gt;(<a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<span class="r147 r t">T</span>&gt; <span id="r148 rd" class="r148 r">list</span>, <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r149 rd" class="r149 r">allowedNames</span>, <span class="i">Func</span>&lt;<span class="r147 r t">T</span>, <b>string</b>&gt; <span id="r150 rd" class="r150 r">nameGetter</span>)
            <b>where</b> <span class="r147 r t">T</span> : <a href="#19b875558acd7f23" class="t t">ConstrainedSessionStateEntry</a>
        {
            <b>foreach</b> (<span class="r147 r t">T</span> <span id="r151 rd" class="r151 r">entry</span> <b>in</b> <span class="r148 r">list</span>)
            {
                <b>string</b> <span id="r152 rd" class="r152 r">entryName</span> = <span class="r150 r">nameGetter</span>(<span class="r151 r">entry</span>);
 
                <span class="c">// Aliases to allowed commands are OK</span>
                <a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a> <span id="r153 rd" class="r153 r">aliasEntry</span> = <span class="r151 r">entry</span> <b>as</b> <a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>;
                <b>if</b> (<span class="r153 r">aliasEntry</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r149 r">allowedNames</span>.<span class="i">Exists</span>(<span id="r154 rd" class="r154 r">allowedName</span> =&gt; <span class="r154 r">allowedName</span>.<span class="i">Equals</span>(<span class="r153 r">aliasEntry</span>.<a href="#297512f106ee62c3" class="i property">Definition</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                    {
                        <span class="r153 r">aliasEntry</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>;
                        <b>continue</b>;
                    }
                }
 
                <span class="c">// if entryName is not present in allowedNames list, then remove it</span>
                <b>if</b> (!<span class="r149 r">allowedNames</span>.<span class="i">Exists</span>(<span id="r155 rd" class="r155 r">allowedName</span> =&gt; <span class="r155 r">allowedName</span>.<span class="i">Equals</span>(<span class="r152 r">entryName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <span class="r151 r">entry</span>.<span class="i">Visibility</span> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an initial session state from a PSSC configuration file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r156 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the PSSC session configuration file.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="545126c8546d4da9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateFromSessionConfigurationFile</a>(<b>string</b> <span id="r156 rd" class="r156 r">path</span>)
        {
            <b>return</b> <a href="#4b58619a48805094" class="i method">CreateFromSessionConfigurationFile</a>(<span class="r156 r">path</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an initial session state from a PSSC configuration file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r157 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the PSSC session configuration file.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r158 r">roleVerifier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The verifier that PowerShell should call to determine if groups in the Role entry apply to the</span>
        <span class="c">///</span><span class="c"> target session. If you have a WindowsPrincipal for a user, for example, create a Function that</span>
        <span class="c">///</span><span class="c"> checks windowsPrincipal.IsInRole().</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="4b58619a48805094" href="../R/4b58619a48805094.html" target="n" data-glyph="72,1" class="i method">CreateFromSessionConfigurationFile</a>(<b>string</b> <span id="r157 rd" class="r157 r">path</span>, <span class="i">Func</span>&lt;<b>string</b>, <b>bool</b>&gt; <span id="r158 rd" class="r158 r">roleVerifier</span>)
        {
            <span class="i n">Remoting</span>.<a href="remoting/fanin/InitialSessionStateProvider.cs.html#fc3ecbf6d041a5ca" class="t t">DISCPowerShellConfiguration</a> <span id="r159 rd" class="r159 r">discConfiguration</span> = <b>new</b> <span class="i n">Remoting</span>.<a href="remoting/fanin/InitialSessionStateProvider.cs.html#13640ca6a221c25b" class="t constructor">DISCPowerShellConfiguration</a>(<span class="r157 r">path</span>, <span class="r158 r">roleVerifier</span>);
            <b>return</b> <span class="r159 r">discConfiguration</span>.<a href="remoting/fanin/InitialSessionStateProvider.cs.html#9189a516bf555054" class="i method">GetInitialSessionState</a>(<b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance that exposes only the minimal</span>
        <span class="c">///</span><span class="c"> set of commands needed by give set of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r160 r">sessionCapabilities</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> All commands that are not needed are made private in order to minimize the attack surface.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r160 r">sessionCapabilities</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> What capabilities the session should have.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="307c0a1bbe64082c" href="../R/307c0a1bbe64082c.html" target="n" data-glyph="72,1" class="i method">CreateRestricted</a>(<a href="CommandMetadata.cs.html#bb52d235a01f7719" class="t t">SessionCapabilities</a> <span id="r160 rd" class="r160 r">sessionCapabilities</span>)
        {
            <span class="c">// only remote server has been requested</span>
            <b>if</b> (<span class="r160 r">sessionCapabilities</span> == <a href="CommandMetadata.cs.html#bb52d235a01f7719" class="t t">SessionCapabilities</a>.<a href="CommandMetadata.cs.html#b2234cfd6d5d5d27" class="i field">RemoteServer</a>)
            {
                <b>return</b> <a href="#de0d1a21ba608e2e" class="i method">CreateRestrictedForRemoteServer</a>();
            }
 
            <b>return</b> <a href="#6aee0258f9ef7599" class="i method">Create</a>();
        }
 
        <b>private static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="de0d1a21ba608e2e" href="../R/de0d1a21ba608e2e.html" target="n" data-glyph="76,1" class="i method">CreateRestrictedForRemoteServer</a>()
        {
            <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r161 rd" class="r161 r">iss</span> = <a href="#6aee0258f9ef7599" class="i method">Create</a>();
            <span class="r161 r">iss</span>.<a href="#053ed0a367a038fa" class="i property">LanguageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>;
            <span class="r161 r">iss</span>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a> = <b>true</b>;
            <span class="r161 r">iss</span>.<a href="#5a7555d31e4be67b" class="i property">UseFullLanguageModeInDebugger</a> = <b>false</b>;
 
            <span class="r161 r">iss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<a href="#5dd8211b20a972f7" class="i field">BuiltInFunctions</a>);
            <span class="r161 r">iss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<a href="#bfe09e88d9dff691" class="i property">BuiltInAliases</a>);
 
            <span class="c">// Load the default snapins - all commands will be private by default.</span>
            <span class="i">Collection</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <span id="r162 rd" class="r162 r">defaultSnapins</span> = <a href="../singleshell/config/MshSnapinInfo.cs.html#b036b8d90fff7faa" class="t t">PSSnapInReader</a>.<a href="../singleshell/config/MshSnapinInfo.cs.html#e508dc80c5619134" class="i method">ReadEnginePSSnapIns</a>();
            <b>foreach</b> (<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r163 rd" class="r163 r">si</span> <b>in</b> <span class="r162 r">defaultSnapins</span>)
            {
                <span class="c">// ImportPSSnapIn always sets &quot;out warning&quot; to &quot;null&quot;;  all our internal calls ignore/discard &quot;out warning&quot;</span>
                <a href="../singleshell/config/MshSnapinLoadException.cs.html#ea3dcb3a13c557ee" class="t t">PSSnapInException</a> <span id="r164 rd" class="r164 r">warning</span>;
                <span class="r161 r">iss</span>.<a href="#3669b3b4b8f85a68" class="i method">ImportPSSnapIn</a>(<span class="r163 r">si</span>, <b>out</b> <span class="r164 r">warning</span>);
            }
 
            <span class="c">// restrict what gets exposed</span>
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r165 rd" class="r165 r">allowedCommands</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <span class="c">// required by implicit remoting and interactive remoting</span>
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Get-Command&quot;</span>);
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Get-FormatData&quot;</span>);
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Clear-Host&quot;</span>);
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Select-Object&quot;</span>); <span class="c">// used to serialize exactly the properties that we need (+ at the right depth)</span>
            <span class="c">// used if available by implicit remoting</span>
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Get-Help&quot;</span>); <span class="c">// used when displaying help for implicit remoting proxy functions</span>
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Measure-Object&quot;</span>); <span class="c">// used to have nice progress bars when import/export-pssession is running</span>
            <span class="c">// required by interactive remoting</span>
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Out-Default&quot;</span>); <span class="c">// appended to every command line</span>
            <span class="r165 r">allowedCommands</span>.<span class="i">Add</span>(<span class="s">&quot;Exit-PSSession&quot;</span>); <span class="c">// used by the user to exit the session</span>
 
            <span class="c">// We don&#39;t remove these entries so that they can be called by commands in the runspace.</span>
            <span class="c">// Setting them to &#39;Private&#39; ensures that the user can&#39;t call them.</span>
            <span class="i">MakeDisallowedEntriesPrivate</span>(
                <span class="r161 r">iss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>,
                <span class="r165 r">allowedCommands</span>,
                <span id="r166 rd" class="r166 r">commandEntry</span> =&gt; <span class="r166 r">commandEntry</span>.<span class="i">Name</span>);
 
            <span class="c">// Ensure that only PowerShell core formats are included in the restricted session.</span>
            <a href="#0d3ee9944600fcdd" class="i method">IncludePowerShellCoreFormats</a>(<span class="r161 r">iss</span>);
 
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r167 rd" class="r167 r">allowedTypes</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <span class="r167 r">allowedTypes</span>.<span class="i">Add</span>(<span class="s">&quot;types.ps1xml&quot;</span>);
            <span class="r167 r">allowedTypes</span>.<span class="i">Add</span>(<span class="s">&quot;typesV3.ps1xml&quot;</span>);
            <span class="i">RemoveDisallowedEntries</span>(
                <span class="r161 r">iss</span>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>,
                <span class="r167 r">allowedTypes</span>,
                <span id="r168 rd" class="r168 r">typeEntry</span> =&gt; <span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r168 r">typeEntry</span>.<span class="i">FileName</span>));
 
            <span class="c">// No providers are visible by default</span>
            <b>foreach</b> (<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r169 rd" class="r169 r">provider</span> <b>in</b> <span class="r161 r">iss</span>.<a href="#901a2e8b67c4db16" class="i property">Providers</a>)
            {
                <span class="r169 r">provider</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
            }
 
            <span class="c">// Add built-in variables.</span>
            <span class="r161 r">iss</span>.<a href="#fb98d8254252d236" class="i property">Variables</a>.<span class="i">Add</span>(<a href="#522fcdaff0993921" class="i field">BuiltInVariables</a>);
 
            <span class="c">// wrap some commands in a proxy function to restrict their parameters</span>
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a>&gt; <span id="r170 rd" class="r170 r">proxyFunction</span> <b>in</b> <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a>.<a href="CommandMetadata.cs.html#4424bbe0e916cad7" class="i method">GetRestrictedCommands</a>(<a href="CommandMetadata.cs.html#bb52d235a01f7719" class="t t">SessionCapabilities</a>.<a href="CommandMetadata.cs.html#b2234cfd6d5d5d27" class="i field">RemoteServer</a>))
            {
                <b>string</b> <span id="r171 rd" class="r171 r">commandName</span> = <span class="r170 r">proxyFunction</span>.<span class="i">Key</span>;
 
                <span class="c">// make the cmdlet private</span>
                <span class="i">Collection</span>&lt;<a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>&gt; <span id="r172 rd" class="r172 r">originalCmdlet</span> = <span class="r161 r">iss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a><a href="#8a6a2b8d34f0d716">[</a><span class="r171 r">commandName</span>];
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r172 r">originalCmdlet</span> != <b>null</b>, <span class="s">&quot;Proxied cmdlets should be imported at this point&quot;</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r172 r">originalCmdlet</span>.<span class="i">Count</span> == 1, <span class="s">&quot;Exactly one cmdlet with a given name&quot;</span>);
                <span class="r172 r">originalCmdlet</span>[0].<span class="i">Visibility</span> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
 
                <span class="c">// and add a public proxy function</span>
                <b>string</b> <span id="r173 rd" class="r173 r">proxyBody</span> = <a href="ProxyCommand.cs.html#d53207f43e14c0fe" class="t t">ProxyCommand</a>.<span class="i">Create</span>(<span class="r170 r">proxyFunction</span>.<span class="i">Value</span>, <b>string</b>.<span class="i">Empty</span>, <b>false</b>);
                <span class="r161 r">iss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<b>new</b> <a href="#bc476ab00cd4640b" class="t constructor">SessionStateFunctionEntry</a>(<span class="r171 r">commandName</span>, <span class="r173 r">proxyBody</span>));
            }
 
            <b>return</b> <span class="r161 r">iss</span>;
        }
 
        <span class="c">// Porting note: moved to Platform so we have one list to maintain</span>
        <b>private static readonly string</b>[] <a id="6284f794679adce4" href="../R/6284f794679adce4.html" target="n" data-glyph="46,1" class="i field">s_PSCoreFormatFileNames</a> = <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#105908610838278e" class="i field">FormatFileNames</a>.<span class="i">ToArray</span>();
 
        <b>private static void</b> <a id="0d3ee9944600fcdd" href="../R/0d3ee9944600fcdd.html" target="n" data-glyph="76,1" class="i method">IncludePowerShellCoreFormats</a>(<a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r174 rd" class="r174 r">iss</span>)
        {
            <b>string</b> <span id="r175 rd" class="r175 r">psHome</span> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#c677cc800603f8f5" class="i property">DefaultPowerShellAppBase</a>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r175 r">psHome</span>))
            {
                <b>return</b>;
            }
 
            <span class="r174 r">iss</span>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<a href="#9c6f481e94fc74d5" class="i method">Clear</a>();
            <b>foreach</b> (<b>var</b> <span id="r176 rd" class="r176 r">coreFormat</span> <b>in</b> <a href="#6284f794679adce4" class="i field">s_PSCoreFormatFileNames</a>)
            {
                <span class="r174 r">iss</span>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<b>new</b> <span class="t">SessionStateFormatEntry</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<span class="r175 r">psHome</span>, <span class="r176 r">coreFormat</span>)));
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ctor for Custom-Shell - Do we need this?</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="52198a26650d32be" href="../R/52198a26650d32be.html" target="n" data-glyph="75,1" class="t constructor">InitialSessionState</a>()
        {
        }
 
        <span class="c">// Creates an empty EE</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an empty InitialSessionState object...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="6aee0258f9ef7599" href="../R/6aee0258f9ef7599.html" target="n" data-glyph="72,1" class="i method">Create</a>()
        {
            <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r177 rd" class="r177 r">iss</span> = <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
 
            <span class="c">// TODO: the following code is probably needed for the hosted constrained runspace</span>
            <span class="c">// There are too many things that depend on the built-in variables. At the same time,</span>
            <span class="c">// these variables can&#39;t be public or they become a security issue.</span>
            <span class="c">// This change still needs to be spec-reviewed before turning it on. It also seems to</span>
            <span class="c">// be causing test failures - i suspect due to lack test isolation - brucepay Mar 06/2008</span>
<span class="k preprocess">#</span><span class="k preprocess">if</span> <b>false</b>
<span class="e">            // Add the default variables and make them private...
            iss.AddVariables(BuiltInVariables);
            foreach (SessionStateVariableEntry v in iss.Variables)
            {
                v.Visibility = SessionStateEntryVisibility.Private;
            }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
            <b>return</b> <span class="r177 r">iss</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates the default PowerShell one with default cmdlets, provider etc.</span>
        <span class="c">///</span><span class="c"> BuiltIn functions, aliases need to be available through default</span>
        <span class="c">///</span><span class="c"> InitialSessionstate constructor. Need to have this discussion for packaging as well.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="212e45c73accc163" href="../R/212e45c73accc163.html" target="n" data-glyph="72,1" class="i method">CreateDefault</a>()
        {
            <span class="c">// Read all of the registered PSSnapins</span>
            <span class="i">Collection</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <span id="r178 rd" class="r178 r">defaultSnapins</span>;
            <a href="../singleshell/config/MshSnapinLoadException.cs.html#ea3dcb3a13c557ee" class="t t">PSSnapInException</a> <span id="r179 rd" class="r179 r">warning</span>;
 
            <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r180 rd" class="r180 r">ss</span> = <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
 
            <span class="r180 r">ss</span>.<a href="#fb98d8254252d236" class="i property">Variables</a>.<span class="i">Add</span>(<a href="#522fcdaff0993921" class="i field">BuiltInVariables</a>);
            <span class="r180 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<b>new</b> <a href="#14a66570cd93b0f4" class="t constructor">SessionStateApplicationEntry</a>(<span class="s">&quot;*&quot;</span>));
            <span class="r180 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<b>new</b> <a href="#3a9f48339203789d" class="t constructor">SessionStateScriptEntry</a>(<span class="s">&quot;*&quot;</span>));
            <span class="r180 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<a href="#5dd8211b20a972f7" class="i field">BuiltInFunctions</a>);
            <span class="r180 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<a href="#bfe09e88d9dff691" class="i property">BuiltInAliases</a>);
 
            <span class="r178 r">defaultSnapins</span> = <a href="../singleshell/config/MshSnapinInfo.cs.html#b036b8d90fff7faa" class="t t">PSSnapInReader</a>.<a href="../singleshell/config/MshSnapinInfo.cs.html#e508dc80c5619134" class="i method">ReadEnginePSSnapIns</a>();
 
            <b>foreach</b> (<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r181 rd" class="r181 r">si</span> <b>in</b> <span class="r178 r">defaultSnapins</span>)
            {
                <b>try</b>
                {
                    <span class="r180 r">ss</span>.<a href="#3669b3b4b8f85a68" class="i method">ImportPSSnapIn</a>(<span class="r181 r">si</span>, <b>out</b> <span class="r179 r">warning</span>);
                }
                <b>catch</b> (<a href="../singleshell/config/MshSnapinLoadException.cs.html#ea3dcb3a13c557ee" class="t t">PSSnapInException</a>)
                {
                    <b>throw</b>;
                }
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <span class="c">// NOTE:</span>
                <span class="c">// This code is for testing a module-based shell. It is only available when the shell is complied</span>
                <span class="c">// in debug mode and is not intended to be a feature.</span>
                <span class="c">// July 31 2008 - brucepay</span>
                <span class="c">// Only load the core snapins at this point...</span>
                <b>if</b> (<span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;PowerShellMinimal&quot;</span>) != <b>null</b>)
                {
                    <b>if</b> (<span class="r181 r">si</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Microsoft.PowerShell.Host&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <b>break</b>;
                }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
 
            <span class="c">// Remove duplicated assemblies</span>
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r182 rd" class="r182 r">assemblyList</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;();
 
            <b>for</b> (<b>int</b> <span id="r183 rd" class="r183 r">i</span> = <span class="r180 r">ss</span>.<a href="#501914944d122594" class="i property">Assemblies</a>.<a href="#c6493cb5fe089abd" class="i property">Count</a> - 1; <span class="r183 r">i</span> &gt;= 0; <span class="r183 r">i</span>--)
            {
                <b>string</b> <span id="r184 rd" class="r184 r">assembly</span> = <span class="r180 r">ss</span>.<a href="#501914944d122594" class="i property">Assemblies</a><a href="#3d898a31812ca39e">[</a><span class="r183 r">i</span>].<a href="#59415471a204963b" class="i property">FileName</a>;
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r184 r">assembly</span>))
                {
                    <b>if</b> (<span class="r182 r">assemblyList</span>.<span class="i">Contains</span>(<span class="r184 r">assembly</span>))
                    {
                        <span class="r180 r">ss</span>.<a href="#501914944d122594" class="i property">Assemblies</a>.<a href="#db54cea4d8acd00a" class="i method">RemoveItem</a>(<span class="r183 r">i</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r182 r">assemblyList</span>.<span class="i">Add</span>(<span class="r184 r">assembly</span>);
                    }
                }
            }
 
            <span class="r180 r">ss</span>.<a href="#053ed0a367a038fa" class="i property">LanguageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
            <span class="r180 r">ss</span>.<a href="#a89af1fd0f2f5c0e" class="i property">AuthorizationManager</a> = <b>new</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecurityManager.cs.html#391541be43bac856" class="t constructor">PSAuthorizationManager</a>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#afe3ed92dba2b2b0" class="i field">DefaultPowerShellShellID</a>);
 
            <b>return</b> <span class="r180 r">ss</span>.<a href="#9976cba0f7f0ac54" class="i method">Clone</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates the default PowerShell one with default cmdlets, provider etc.</span>
        <span class="c">///</span><span class="c"> The default cmdlets, provider, etc are loaded via Modules.</span>
        <span class="c">///</span><span class="c"> For loading Microsoft.PowerShell.Core module only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="904bc85f721c6764" href="../R/904bc85f721c6764.html" target="n" data-glyph="72,1" class="i method">CreateDefault2</a>()
        {
            <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r185 rd" class="r185 r">ss</span> = <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
 
            <span class="r185 r">ss</span>.<a href="#fb98d8254252d236" class="i property">Variables</a>.<span class="i">Add</span>(<a href="#522fcdaff0993921" class="i field">BuiltInVariables</a>);
            <span class="r185 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<b>new</b> <a href="#14a66570cd93b0f4" class="t constructor">SessionStateApplicationEntry</a>(<span class="s">&quot;*&quot;</span>));
            <span class="r185 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<b>new</b> <a href="#3a9f48339203789d" class="t constructor">SessionStateScriptEntry</a>(<span class="s">&quot;*&quot;</span>));
            <span class="r185 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<a href="#5dd8211b20a972f7" class="i field">BuiltInFunctions</a>);
            <span class="r185 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<a href="#bfe09e88d9dff691" class="i property">BuiltInAliases</a>);
 
            <span class="r185 r">ss</span>.<a href="#2596e8ca74c2f5f0" class="i method">ImportCorePSSnapIn</a>();
            <span class="r185 r">ss</span>.<a href="#053ed0a367a038fa" class="i property">LanguageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
            <span class="r185 r">ss</span>.<a href="#a89af1fd0f2f5c0e" class="i property">AuthorizationManager</a> = <b>new</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecurityManager.cs.html#391541be43bac856" class="t constructor">PSAuthorizationManager</a>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#afe3ed92dba2b2b0" class="i field">DefaultPowerShellShellID</a>);
 
            <b>return</b> <span class="r185 r">ss</span>.<a href="#9976cba0f7f0ac54" class="i method">Clone</a>();
        }
 
        <b>internal static bool</b> <a id="7c1caf70ca3d20ee" href="../R/7c1caf70ca3d20ee.html" target="n" data-glyph="74,1" class="i method">IsEngineModule</a>(<b>string</b> <span id="r186 rd" class="r186 r">moduleName</span>)
        {
            <b>return</b> <a href="#b3b528389a386e63" class="i field">EngineModules</a>.<span class="i">Contains</span>(<span class="r186 r">moduleName</span>) || <a href="#acfd49442ea85a4e" class="i field">NestedEngineModules</a>.<span class="i">Contains</span>(<span class="r186 r">moduleName</span>);
        }
 
        <b>internal static bool</b> <a id="0a30f4c48c11c2a7" href="../R/0a30f4c48c11c2a7.html" target="n" data-glyph="74,1" class="i method">IsNestedEngineModule</a>(<b>string</b> <span id="r187 rd" class="r187 r">moduleName</span>)
        {
            <b>return</b> <a href="#acfd49442ea85a4e" class="i field">NestedEngineModules</a>.<span class="i">Contains</span>(<span class="r187 r">moduleName</span>);
        }
 
        <b>internal static bool</b> <a id="54c0c8343b390c35" href="../R/54c0c8343b390c35.html" target="n" data-glyph="74,1" class="i method">IsConstantEngineModule</a>(<b>string</b> <span id="r188 rd" class="r188 r">moduleName</span>)
        {
            <b>return</b> <a href="#abc33d152fda84b1" class="i field">ConstantEngineModules</a>.<span class="i">Contains</span>(<span class="r188 r">moduleName</span>) || <a href="#2bbb609913ad2675" class="i field">ConstantEngineNestedModules</a>.<span class="i">Contains</span>(<span class="r188 r">moduleName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clone this InitialSessionState object. The collections are</span>
        <span class="c">///</span><span class="c"> recursively cloned as well as the elements in the collections.</span>
        <span class="c">///</span><span class="c"> Note however, that the contents of the individual entries</span>
        <span class="c">///</span><span class="c"> are not deep-cloned. This is only an issue for variable</span>
        <span class="c">///</span><span class="c"> entries which may have reference types. These objects</span>
        <span class="c">///</span><span class="c"> will be added by reference rather than by value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="9976cba0f7f0ac54" href="../R/9976cba0f7f0ac54.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r189 rd" class="r189 r">ss</span> = <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
 
            <span class="r189 r">ss</span>.<a href="#fb98d8254252d236" class="i property">Variables</a>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#fb98d8254252d236" class="i property">Variables</a>.<a href="#e37d6cbda3711bb5" class="i method">Clone</a>());
            <span class="r189 r">ss</span>.<a href="#fd320e175dc61ca2" class="i property">EnvironmentVariables</a>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#fd320e175dc61ca2" class="i property">EnvironmentVariables</a>.<a href="#e37d6cbda3711bb5" class="i method">Clone</a>());
            <span class="r189 r">ss</span>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#e37d6cbda3711bb5" class="i method">Clone</a>());
            <span class="r189 r">ss</span>.<a href="#501914944d122594" class="i property">Assemblies</a>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#501914944d122594" class="i property">Assemblies</a>.<a href="#e37d6cbda3711bb5" class="i method">Clone</a>());
            <span class="r189 r">ss</span>.<a href="#901a2e8b67c4db16" class="i property">Providers</a>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#901a2e8b67c4db16" class="i property">Providers</a>.<a href="#e37d6cbda3711bb5" class="i method">Clone</a>());
            <span class="r189 r">ss</span>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<a href="#e37d6cbda3711bb5" class="i method">Clone</a>());
            <span class="r189 r">ss</span>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<a href="#e37d6cbda3711bb5" class="i method">Clone</a>());
 
            <b>foreach</b> (<b>string</b> <span id="r190 rd" class="r190 r">startupScript</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4074645df9605a16" class="i property">StartupScripts</a>)
            {
                <span class="r189 r">ss</span>.<a href="#4074645df9605a16" class="i property">StartupScripts</a>.<span class="i">Add</span>(<span class="r190 r">startupScript</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r191 rd" class="r191 r">unresolvedCommandsToExpose</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#b128cdc6af34af14" class="i property">UnresolvedCommandsToExpose</a>)
            {
                <span class="r189 r">ss</span>.<a href="#b128cdc6af34af14" class="i property">UnresolvedCommandsToExpose</a>.<span class="i">Add</span>(<span class="r191 r">unresolvedCommandsToExpose</span>);
            }
 
            <b>foreach</b> (<span class="i">Hashtable</span> <span id="r192 rd" class="r192 r">dynamicVariableToDefine</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#6495f363726e5904" class="i property">DynamicVariablesToDefine</a>)
            {
                <span class="r189 r">ss</span>.<a href="#6495f363726e5904" class="i property">DynamicVariablesToDefine</a>.<span class="i">Add</span>(<span class="r192 r">dynamicVariableToDefine</span>);
            }
 
            <b>foreach</b> (<b>var</b> <span id="r193 rd" class="r193 r">pair</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#f99479288a54ef17" class="i property">CommandModifications</a>)
            {
                <span class="r189 r">ss</span>.<a href="#f99479288a54ef17" class="i property">CommandModifications</a>.<span class="i">Add</span>(<span class="r193 r">pair</span>.<span class="i">Key</span>, <span class="r193 r">pair</span>.<span class="i">Value</span>);
            }
 
            <span class="r189 r">ss</span>.<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a>;
            <span class="r189 r">ss</span>.<a href="#a89af1fd0f2f5c0e" class="i property">AuthorizationManager</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#a89af1fd0f2f5c0e" class="i property">AuthorizationManager</a>;
            <span class="r189 r">ss</span>.<a href="#053ed0a367a038fa" class="i property">LanguageMode</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#053ed0a367a038fa" class="i property">LanguageMode</a>;
            <span class="r189 r">ss</span>.<a href="#91f2e76aef046d1e" class="i property">TranscriptDirectory</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#91f2e76aef046d1e" class="i property">TranscriptDirectory</a>;
            <span class="r189 r">ss</span>.<a href="#50b5fd24b0a675b4" class="i property">UserDriveEnabled</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#50b5fd24b0a675b4" class="i property">UserDriveEnabled</a>;
            <span class="r189 r">ss</span>.<a href="#d6b8923f60fe362d" class="i property">UserDriveUserName</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#d6b8923f60fe362d" class="i property">UserDriveUserName</a>;
            <span class="r189 r">ss</span>.<a href="#260c85af5e497081" class="i property">UserDriveMaximumSize</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#260c85af5e497081" class="i property">UserDriveMaximumSize</a>;
 
            <b>if</b> (<a href="#24109095720bda22" class="i field">_wasExecutionPolicySet</a>)
            {
                <span class="r189 r">ss</span>.<a href="#88f2d379b0e326cd" class="i property">ExecutionPolicy</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#88f2d379b0e326cd" class="i property">ExecutionPolicy</a>;
            }
 
            <span class="r189 r">ss</span>.<a href="#5a7555d31e4be67b" class="i property">UseFullLanguageModeInDebugger</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#5a7555d31e4be67b" class="i property">UseFullLanguageModeInDebugger</a>;
            <span class="r189 r">ss</span>.<a href="#2496a3df8744996f" class="i property">ThreadOptions</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#2496a3df8744996f" class="i property">ThreadOptions</a>;
            <span class="r189 r">ss</span>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>;
            <span class="r189 r">ss</span>.<a href="#640e70a6a98fabbf" class="i property">ApartmentState</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#640e70a6a98fabbf" class="i property">ApartmentState</a>;
 
            <b>foreach</b> (<a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r194 rd" class="r194 r">modSpec</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>)
            {
                <span class="r189 r">ss</span>.<a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>.<span class="i">Add</span>(<span class="r194 r">modSpec</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r195 rd" class="r195 r">mod</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4825fe007c6fa7d1" class="i property">CoreModulesToImport</a>)
            {
                <span class="r189 r">ss</span>.<a href="#4825fe007c6fa7d1" class="i property">CoreModulesToImport</a>.<span class="i">Add</span>(<span class="r195 r">mod</span>);
            }
 
            <span class="r189 r">ss</span>.<a href="#d12e46183b35df33" class="i property">DisableFormatUpdates</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#d12e46183b35df33" class="i property">DisableFormatUpdates</a>;
 
            <b>foreach</b> (<b>var</b> <span id="r196 rd" class="r196 r">s</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#63420b5d815e7587" class="i field">defaultSnapins</a>)
            {
                <span class="r189 r">ss</span>.<a href="#63420b5d815e7587" class="i field">defaultSnapins</a>.<span class="i">Add</span>(<span class="r196 r">s</span>);
            }
 
            <b>foreach</b> (<b>var</b> <span id="r197 rd" class="r197 r">s</span> <b>in</b> <a href="#3d3246dc9d19522a" class="i property">ImportedSnapins</a>)
            {
                <span class="r189 r">ss</span>.<a href="#3d3246dc9d19522a" class="i property">ImportedSnapins</a>.<span class="i">Add</span>(<span class="r197 r">s</span>.<span class="i">Key</span>, <span class="r197 r">s</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <span class="r189 r">ss</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Want to get away from SnapIn and console file. Have modules and assemblies instead.</span>
        <span class="c">///</span><span class="c"> Specify the registered SnapIn name or name collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r198 r">snapInName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="cee3f24b30c4f413" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Create</a>(<b>string</b> <span id="r198 rd" class="r198 r">snapInName</span>)
        {
            <b>return</b> <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r199 r">snapInNameCollection</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r200 r">warning</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="9eac7109989e76b4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Create</a>(<b>string</b>[] <span id="r199 rd" class="r199 r">snapInNameCollection</span>, <b>out</b> <a href="../singleshell/config/MshConsoleLoadException.cs.html#05a293fe76d34feb" class="t t">PSConsoleLoadException</a> <span id="r200 rd" class="r200 r">warning</span>)
        {
            <span class="r200 r">warning</span> = <b>null</b>;
            <b>return</b> <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r201 r">snapInPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r202 r">warnings</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="6703737d893155e8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateFrom</a>(<b>string</b> <span id="r201 rd" class="r201 r">snapInPath</span>, <b>out</b> <a href="../singleshell/config/MshConsoleLoadException.cs.html#05a293fe76d34feb" class="t t">PSConsoleLoadException</a> <span id="r202 rd" class="r202 r">warnings</span>)
        {
            <span class="r202 r">warnings</span> = <b>null</b>;
            <b>return</b> <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r203 r">snapInPathCollection</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r204 r">warnings</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="92e42abb5b29952f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateFrom</a>(<b>string</b>[] <span id="r203 rd" class="r203 r">snapInPathCollection</span>, <b>out</b> <a href="../singleshell/config/MshConsoleLoadException.cs.html#05a293fe76d34feb" class="t t">PSConsoleLoadException</a> <span id="r204 rd" class="r204 r">warnings</span>)
        {
            <span class="r204 r">warnings</span> = <b>null</b>;
            <b>return</b> <b>new</b> <a href="#52198a26650d32be" class="t constructor">InitialSessionState</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the language mode to be used for this session state instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="053ed0a367a038fa" href="../R/053ed0a367a038fa.html" target="n" data-glyph="102,1" class="i property">LanguageMode</a> { <b>get</b>; <b>set</b>; } = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the directory to be used for collection session transcripts.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="91f2e76aef046d1e" href="../R/91f2e76aef046d1e.html" target="n" data-glyph="102,1" class="i property">TranscriptDirectory</a> { <b>get</b>; <b>set</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when session opted for a User PSDrive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="50b5fd24b0a675b4" href="../R/50b5fd24b0a675b4.html" target="n" data-glyph="104,1" class="i property">UserDriveEnabled</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User name for the user drive.  This will be part of the root path for the User PSDrive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="d6b8923f60fe362d" href="../R/d6b8923f60fe362d.html" target="n" data-glyph="104,1" class="i property">UserDriveUserName</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional maximum size value for User drive (in bytes).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal long</b> <a id="260c85af5e497081" href="../R/260c85af5e497081.html" target="n" data-glyph="104,1" class="i property">UserDriveMaximumSize</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Forces all session script input parameters to have validation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="55a5ce7472319152" href="../R/55a5ce7472319152.html" target="n" data-glyph="104,1" class="i property">EnforceInputParameterValidation</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the execution policy to be used for this session state instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecuritySupport.cs.html#73c2048fc177fabf" class="t t">ExecutionPolicy</a> <a id="88f2d379b0e326cd" href="../R/88f2d379b0e326cd.html" target="n" data-glyph="102,1" class="i property">ExecutionPolicy</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#52d6cd34d1058459" class="i field">_executionPolicy</a>;
            }
 
            <b>set</b>
            {
                <a href="#52d6cd34d1058459" class="i field">_executionPolicy</a> = <b>value</b>;
                <a href="#24109095720bda22" class="i field">_wasExecutionPolicySet</a> = <b>true</b>;
            }
        }
 
        <b>private</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecuritySupport.cs.html#73c2048fc177fabf" class="t t">ExecutionPolicy</a> <a id="52d6cd34d1058459" href="../R/52d6cd34d1058459.html" target="n" data-glyph="46,1" class="i field">_executionPolicy</a> = <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecuritySupport.cs.html#73c2048fc177fabf" class="t t">ExecutionPolicy</a>.<a href="../security/SecuritySupport.cs.html#c8b152ee17192868" class="i field">Default</a>;
        <b>private bool</b> <a id="24109095720bda22" href="../R/24109095720bda22.html" target="n" data-glyph="46,1" class="i field">_wasExecutionPolicySet</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true the PowerShell debugger will use FullLanguage mode, otherwise it will use the current language mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="5a7555d31e4be67b" href="../R/5a7555d31e4be67b.html" target="n" data-glyph="102,1" class="i property">UseFullLanguageModeInDebugger</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ApartmentState of the thread used to execute commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ApartmentState</span> <a id="640e70a6a98fabbf" href="../R/640e70a6a98fabbf.html" target="n" data-glyph="102,1" class="i property">ApartmentState</a> { <b>get</b>; <b>set</b>; } = <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#8d461e5a29a5440d" class="i field">DefaultApartmentState</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property determines whether a new thread is created for each invocation of a command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a> <a id="2496a3df8744996f" href="../R/2496a3df8744996f.html" target="n" data-glyph="102,1" class="i property">ThreadOptions</a> { <b>get</b>; <b>set</b>; } = <a href="hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a>.<a href="hostifaces/Connection.cs.html#84e3ebfc04cbd4e5" class="i field">Default</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this property is set and there was a runspace creation error, then</span>
        <span class="c">///</span><span class="c"> throw an exception, otherwise just continue creating the runspace even though it may</span>
        <span class="c">///</span><span class="c"> be in an inconsistent state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="259e8aa509ac9e00" href="../R/259e8aa509ac9e00.html" target="n" data-glyph="102,1" class="i property">ThrowOnRunspaceOpenError</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property will be set only if we are refreshing the Type/Format settings by calling UpdateTypes/UpdateFormats directly.</span>
        <span class="c">///</span><span class="c"> In this case, we should wait until all type/format entries get processed. After that, if there were errors</span>
        <span class="c">///</span><span class="c"> generated, we throw them as an exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="97adcb7e4a250b21" href="../R/97adcb7e4a250b21.html" target="n" data-glyph="44,1" class="i field">RefreshTypeAndFormatSetting</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the authorization manager to be used for this session state instance.</span>
        <span class="c">///</span><span class="c"> If no authorization manager is specified, then the default authorization manager</span>
        <span class="c">///</span><span class="c"> for PowerShell will be used which checks the ExecutionPolicy before running a command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="SecurityManagerBase.cs.html#971c00f0dacd0dc9" class="t t">AuthorizationManager</a> <a id="a89af1fd0f2f5c0e" href="../R/a89af1fd0f2f5c0e.html" target="n" data-glyph="102,1" class="i property">AuthorizationManager</a> { <b>get</b>; <b>set</b>; } = <b>new</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecurityManager.cs.html#391541be43bac856" class="t constructor">PSAuthorizationManager</a>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#afe3ed92dba2b2b0" class="i field">DefaultPowerShellShellID</a>);
 
        <b>internal</b> <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <a id="0deb330e2322b7d3" href="../R/0deb330e2322b7d3.html" target="n" data-glyph="44,1" class="i field">Host</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a list of modules to import when the runspace is created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r205 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The modules to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public void</b> <a id="e1bc402ae6a0a4c8" href="../R/e1bc402ae6a0a4c8.html" target="n" data-glyph="72,1" class="i method">ImportPSModule</a>(<b>params string</b>[] <span id="r205 rd" class="r205 r">name</span>)
        {
            <b>if</b> (<span class="r205 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r205 r">name</span>));
            }
 
            <b>foreach</b> (<b>string</b> <span id="r206 rd" class="r206 r">n</span> <b>in</b> <span class="r205 r">name</span>)
            {
                <a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>.<span class="i">Add</span>(<b>new</b> <a href="Modules/ModuleSpecification.cs.html#8bf2c91f2abc8759" class="t constructor">ModuleSpecification</a>(<span class="r206 r">n</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears ImportPSModule list.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="34ddb482c890c7a1" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ClearPSModules</a>()
        {
            <a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>.<span class="i">Clear</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a list of modules to import when the runspace is created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">modules</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The modules, whose specifications are specified by </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">modules</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> to add.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="6f8f3f059ab2c386" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ImportPSModule</a>(<span class="i">IEnumerable</span>&lt;<a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <span id="r207 rd" class="r207 r">modules</span>)
        {
            <b>if</b> (<span class="r207 r">modules</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r207 r">modules</span>));
            }
 
            <b>foreach</b> (<b>var</b> <span id="r208 rd" class="r208 r">moduleSpecification</span> <b>in</b> <span class="r207 r">modules</span>)
            {
                <a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>.<span class="i">Add</span>(<span class="r208 r">moduleSpecification</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Imports all the modules from the specified module path by default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Path from which all modules need to be imported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="0e1aa5e6e69b90a1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ImportPSModulesFromPath</a>(<b>string</b> <span id="r209 rd" class="r209 r">path</span>)
        {
            <b>string</b> <span id="r210 rd" class="r210 r">expandedpath</span> = <span class="i">Environment</span>.<span class="i">ExpandEnvironmentVariables</span>(<span class="r209 r">path</span>);
            <b>var</b> <span id="r211 rd" class="r211 r">availableModuleFiles</span> = <a href="Modules/ModuleUtils.cs.html#623e3612c4173093" class="t t">ModuleUtils</a>.<a href="Modules/ModuleUtils.cs.html#22019dd71502c60e" class="i method">GetDefaultAvailableModuleFiles</a>(<span class="r210 r">expandedpath</span>);
            <span class="i">ImportPSModule</span>(<span class="r211 r">availableModuleFiles</span>.<span class="i">ToArray</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a list of core modules to import when the runspace is created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The modules to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="1cd051d4dca164cc" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ImportPSCoreModule</a>(<b>string</b>[] <span id="r212 rd" class="r212 r">name</span>)
        {
            <b>if</b> (<span class="r212 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r212 r">name</span>));
            }
 
            <b>foreach</b> (<b>string</b> <span id="r213 rd" class="r213 r">n</span> <b>in</b> <span class="r212 r">name</span>)
            {
                <a href="#4825fe007c6fa7d1" class="i property">CoreModulesToImport</a>.<span class="i">Add</span>(<span class="r213 r">n</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Imported modules.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <a id="13bb2417a9e5277e" href="../R/13bb2417a9e5277e.html" target="n" data-glyph="102,1" class="i property">Modules</a>
        {
            <b>get</b> { <b>return</b> <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;(<a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>); }
        }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <a id="88f2194fd3b340ef" href="../R/88f2194fd3b340ef.html" target="n" data-glyph="104,1" class="i property">ModuleSpecificationsToImport</a> { <b>get</b>; } = <b>new</b> <span class="i">Collection</span>&lt;<a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;();
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <a id="3d3246dc9d19522a" href="../R/3d3246dc9d19522a.html" target="n" data-glyph="104,1" class="i property">ImportedSnapins</a> { <b>get</b>; } = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dictionary of core modules to import on runspace creation...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="4825fe007c6fa7d1" href="../R/4825fe007c6fa7d1.html" target="n" data-glyph="104,1" class="i property">CoreModulesToImport</a> { <b>get</b>; } = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The list of assemblies to load...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a>&gt; <a id="501914944d122594" href="../R/501914944d122594.html" target="n" data-glyph="102,1" class="i property">Assemblies</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#2ee447558deab843" class="i field">_assemblies</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#2ee447558deab843" class="i field">_assemblies</a>, <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#2ee447558deab843" class="i field">_assemblies</a>;
            }
        }
 
        <b>private</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a>&gt; <a id="2ee447558deab843" href="../R/2ee447558deab843.html" target="n" data-glyph="46,1" class="i field">_assemblies</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of types to use for this session state instance...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#02c5fb84a39526f6" class="t t">SessionStateTypeEntry</a>&gt; <a id="0f0c3a5adb4b1776" href="../R/0f0c3a5adb4b1776.html" target="n" data-glyph="102,1" class="i property">Types</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#2e34e6bd477a6a86" class="i field">_types</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#2e34e6bd477a6a86" class="i field">_types</a>, <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#02c5fb84a39526f6" class="t t">SessionStateTypeEntry</a>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#2e34e6bd477a6a86" class="i field">_types</a>;
            }
        }
 
        <b>private</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#02c5fb84a39526f6" class="t t">SessionStateTypeEntry</a>&gt; <a id="2e34e6bd477a6a86" href="../R/2e34e6bd477a6a86.html" target="n" data-glyph="46,1" class="i field">_types</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a>&gt; <a id="4e7657f066102cad" href="../R/4e7657f066102cad.html" target="n" data-glyph="102,1" class="i property">Formats</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#d938fc9c6eb18ef2" class="i field">_formats</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#d938fc9c6eb18ef2" class="i field">_formats</a>, <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#d938fc9c6eb18ef2" class="i field">_formats</a>;
            }
        }
 
        <b>private</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a>&gt; <a id="d938fc9c6eb18ef2" href="../R/d938fc9c6eb18ef2.html" target="n" data-glyph="46,1" class="i field">_formats</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If set to true, disables any updates to format table. This includes disabling</span>
        <span class="c">///</span><span class="c"> format table updates through Update-FormatData, Import-Module etc.</span>
        <span class="c">///</span><span class="c"> All the disabling happens silently ie., the user will not get any exception.</span>
        <span class="c">///</span><span class="c"> By default, this is set to False.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="d12e46183b35df33" href="../R/d12e46183b35df33.html" target="n" data-glyph="102,1" class="i property">DisableFormatUpdates</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <a id="901a2e8b67c4db16" href="../R/901a2e8b67c4db16.html" target="n" data-glyph="102,1" class="i property">Providers</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#e7bd6966e16e4f5b" class="i field">_providers</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#e7bd6966e16e4f5b" class="i field">_providers</a>, <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#e7bd6966e16e4f5b" class="i field">_providers</a>;
            }
        }
 
        <b>private</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <a id="e7bd6966e16e4f5b" href="../R/e7bd6966e16e4f5b.html" target="n" data-glyph="46,1" class="i field">_providers</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of commands (Alias, Application, Cmdlets, Function, Script) for this entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>&gt; <a id="2d45d0b0db0079ba" href="../R/2d45d0b0db0079ba.html" target="n" data-glyph="102,1" class="i property">Commands</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#0261f044cb8ac245" class="i field">_commands</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#0261f044cb8ac245" class="i field">_commands</a>, <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#0261f044cb8ac245" class="i field">_commands</a>;
            }
        }
 
        <b>private</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>&gt; <a id="0261f044cb8ac245" href="../R/0261f044cb8ac245.html" target="n" data-glyph="46,1" class="i field">_commands</a>;
 
        <b>internal</b> <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a> <a id="cef2c573c113a1c8" href="../R/cef2c573c113a1c8.html" target="n" data-glyph="104,1" class="i property">DefaultCommandVisibility</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="b128cdc6af34af14" href="../R/b128cdc6af34af14.html" target="n" data-glyph="104,1" class="i property">UnresolvedCommandsToExpose</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#10e6d3cfa2f9d576" class="i field">_unresolvedCommandsToExpose</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#10e6d3cfa2f9d576" class="i field">_unresolvedCommandsToExpose</a>, <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>), <b>null</b>);
                }
 
                <b>return</b> <a href="#10e6d3cfa2f9d576" class="i field">_unresolvedCommandsToExpose</a>;
            }
        }
 
        <b>private</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="10e6d3cfa2f9d576" href="../R/10e6d3cfa2f9d576.html" target="n" data-glyph="46,1" class="i field">_unresolvedCommandsToExpose</a>;
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Hashtable</span>&gt; <a id="f99479288a54ef17" href="../R/f99479288a54ef17.html" target="n" data-glyph="104,1" class="i property">CommandModifications</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#1affc72f46ea9c56" class="i field">_commandModifications</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#1affc72f46ea9c56" class="i field">_commandModifications</a>, <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Hashtable</span>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>), <b>null</b>);
                }
 
                <b>return</b> <a href="#1affc72f46ea9c56" class="i field">_commandModifications</a>;
            }
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Hashtable</span>&gt; <a id="1affc72f46ea9c56" href="../R/1affc72f46ea9c56.html" target="n" data-glyph="46,1" class="i field">_commandModifications</a>;
 
        <b>internal</b> <span class="i">List</span>&lt;<span class="i">Hashtable</span>&gt; <a id="6495f363726e5904" href="../R/6495f363726e5904.html" target="n" data-glyph="104,1" class="i property">DynamicVariablesToDefine</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#ba9809f2609be049" class="i field">_dynamicVariablesToDefine</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#ba9809f2609be049" class="i field">_dynamicVariablesToDefine</a>, <b>new</b> <span class="i">List</span>&lt;<span class="i">Hashtable</span>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#ba9809f2609be049" class="i field">_dynamicVariablesToDefine</a>;
            }
        }
 
        <b>private</b> <span class="i">List</span>&lt;<span class="i">Hashtable</span>&gt; <a id="ba9809f2609be049" href="../R/ba9809f2609be049.html" target="n" data-glyph="46,1" class="i field">_dynamicVariablesToDefine</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>&gt; <a id="fb98d8254252d236" href="../R/fb98d8254252d236.html" target="n" data-glyph="102,1" class="i property">Variables</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#f9758fb17c295cd9" class="i field">_variables</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#f9758fb17c295cd9" class="i field">_variables</a>, <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#f9758fb17c295cd9" class="i field">_variables</a>;
            }
        }
 
        <b>private</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>&gt; <a id="f9758fb17c295cd9" href="../R/f9758fb17c295cd9.html" target="n" data-glyph="46,1" class="i field">_variables</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>&gt; <a id="fd320e175dc61ca2" href="../R/fd320e175dc61ca2.html" target="n" data-glyph="102,1" class="i property">EnvironmentVariables</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#1f9133120fe5e7dd" class="i field">_environmentVariables</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#1f9133120fe5e7dd" class="i field">_environmentVariables</a>, <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#1f9133120fe5e7dd" class="i field">_environmentVariables</a>;
            }
        }
 
        <b>private</b> <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>&gt; <a id="1f9133120fe5e7dd" href="../R/1f9133120fe5e7dd.html" target="n" data-glyph="46,1" class="i field">_environmentVariables</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="4074645df9605a16" href="../R/4074645df9605a16.html" target="n" data-glyph="102,1" class="i property">StartupScripts</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#970bca3f4229f58f" class="i field">_startupScripts</a> == <b>null</b>)
                {
                    <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#970bca3f4229f58f" class="i field">_startupScripts</a>, <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(), <b>null</b>);
                }
 
                <b>return</b> <a href="#970bca3f4229f58f" class="i field">_startupScripts</a>;
            }
        }
 
        <b>private</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="970bca3f4229f58f" href="../R/970bca3f4229f58f.html" target="n" data-glyph="46,1" class="i field">_startupScripts</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;();
 
        <b>private readonly object</b> <a id="079ee4a0c5c6339e" href="../R/079ee4a0c5c6339e.html" target="n" data-glyph="46,1" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();
 
        <b>internal void</b> <a id="760b053de3dbd6be" href="../R/760b053de3dbd6be.html" target="n" data-glyph="74,1" class="i method">Bind</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r214 rd" class="r214 r">context</span>, <b>bool</b> <span id="r215 rd" class="r215 r">updateOnly</span>, <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r216 rd" class="r216 r">module</span>, <b>bool</b> <span id="r217 rd" class="r217 r">noClobber</span>, <b>bool</b> <span id="r218 rd" class="r218 r">local</span>, <b>bool</b> <span id="r219 rd" class="r219 r">setLocation</span>)
        {
            <a href="#0deb330e2322b7d3" class="i field">Host</a> = <span class="r214 r">context</span>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>;
            <b>lock</b> (<a href="#079ee4a0c5c6339e" class="i field">_syncObject</a>)
            {
                <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r220 rd" class="r220 r">ss</span> = <span class="r214 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
 
                <span class="c">// Clear the application and script collections...</span>
                <b>if</b> (!<span class="r215 r">updateOnly</span>)
                {
                    <span class="r220 r">ss</span>.<a href="SessionState.cs.html#27ddff158f6adc5b" class="i property">Applications</a>.<span class="i">Clear</span>();
                    <span class="r220 r">ss</span>.<a href="SessionState.cs.html#36447cb8e57fac9f" class="i property">Scripts</a>.<span class="i">Clear</span>();
                }
 
                <span class="c">// If the initial session state made some commands private by way of</span>
                <span class="c">// VisibleCmdlets / etc., then change the default command visibility for</span>
                <span class="c">// the session state so that newly imported modules aren&#39;t exposed accidentally.</span>
                <b>if</b> (<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a> == <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>)
                {
                    <span class="r220 r">ss</span>.<a href="SessionState.cs.html#d788418311c2eafb" class="i field">DefaultCommandVisibility</a> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
                }
 
                <b>try</b>
                {
                    <span class="c">// Load assemblies before anything else - we may need to resolve types in the loaded</span>
                    <span class="c">// assemblies as part of loading formats or types, and that can&#39;t be done in parallel.</span>
                    <a href="#1d38fc10d995df3f" class="i method">Bind_LoadAssemblies</a>(<span class="r214 r">context</span>);
 
                    <b>var</b> <span id="r221 rd" class="r221 r">actions</span> = <b>new</b> <span class="i">Action</span>[]
                    {
                        () =&gt; <a href="#2489e7bcb7847dd9" class="i method">Bind_UpdateTypes</a>(<span class="r214 r">context</span>, <span class="r215 r">updateOnly</span>),
                        () =&gt; <a href="#89b7bc7e0084ab89" class="i method">Bind_UpdateFormats</a>(<span class="r214 r">context</span>, <span class="r215 r">updateOnly</span>),
                        () =&gt; <a href="#a4716197a771b66e" class="i method">Bind_BindCommands</a>(<span class="r216 r">module</span>, <span class="r217 r">noClobber</span>, <span class="r218 r">local</span>, <span class="r220 r">ss</span>),
                        () =&gt; <a href="#7557fb3393976420" class="i method">Bind_LoadProviders</a>(<span class="r220 r">ss</span>),
                        () =&gt; <a href="#de6f71f20afc4d91" class="i method">Bind_SetVariables</a>(<span class="r220 r">ss</span>),
                        <span class="i">Bind_SetEnvironment</span>
                    };
 
                    <b>if</b> (<span class="r215 r">updateOnly</span>)
                    {
                        <span class="c">// We&#39;re typically called to import a module. It seems like this could</span>
                        <span class="c">// still happen in parallel, but calls to WriteError on the wrong thread</span>
                        <span class="c">// get silently swallowed, so instead just run the actions serially on this thread.</span>
                        <b>foreach</b> (<b>var</b> <span id="r222 rd" class="r222 r">action</span> <b>in</b> <span class="r221 r">actions</span>)
                        {
                            <span class="r222 r">action</span>();
                        }
                    }
                    <b>else</b>
                    {
                        <span class="i">Parallel</span>.<span class="i">Invoke</span>(<span class="r221 r">actions</span>);
                    }
                }
                <b>catch</b> (<span class="i">AggregateException</span> <span id="r223 rd" class="r223 r">e</span>)
                {
                    <span class="r223 r">e</span> = <span class="r223 r">e</span>.<span class="i">Flatten</span>();
                    <b>foreach</b> (<b>var</b> <span id="r224 rd" class="r224 r">exception</span> <b>in</b> <span class="r223 r">e</span>.<span class="i">InnerExceptions</span>)
                    {
                        <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<span class="i">LogEngineHealthEvent</span>(
                            <span class="r214 r">context</span>,
                            <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#584342f4380a5ed3" class="i field">EVENT_ID_CONFIGURATION_FAILURE</a>,
                            <span class="r224 r">exception</span>,
                            <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
                    }
 
                    <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
                    {
                        <span class="c">// Just throw the first error</span>
                        <b>throw</b> <span class="r223 r">e</span>.<span class="i">InnerExceptions</span>[0];
                    }
 
                    <span class="r214 r">context</span>.<span class="i">ReportEngineStartupError</span>(<span class="r223 r">e</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r225 rd" class="r225 r">e</span>)
                {
                    <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#fae9c9c125cac563" class="i method">LogEngineHealthEvent</a>(
                        <span class="r214 r">context</span>,
                        <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#584342f4380a5ed3" class="i field">EVENT_ID_CONFIGURATION_FAILURE</a>,
                        <span class="r225 r">e</span>,
                        <a href="../logging/MshLog.cs.html#2b721dd17d857439" class="t t">Severity</a>.<a href="../logging/MshLog.cs.html#1440d51070db4217" class="i field">Warning</a>);
 
                    <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
                    {
                        <b>throw</b>;
                    }
 
                    <span class="r214 r">context</span>.<span class="i">ReportEngineStartupError</span>(<span class="r225 r">e</span>.<span class="i">Message</span>);
                }
 
                <span class="c">// Set the language mode</span>
                <b>if</b> (!<span class="r215 r">updateOnly</span>)
                {
                    <span class="r220 r">ss</span>.<a href="SessionState.cs.html#c13642db000f9224" class="i property">LanguageMode</a> = <a href="#053ed0a367a038fa" class="i property">LanguageMode</a>;
                }
 
                <span class="c">// Set the execution policy</span>
                <b>if</b> (<a href="#24109095720bda22" class="i field">_wasExecutionPolicySet</a>)
                {
                    <b>string</b> <span id="r226 rd" class="r226 r">shellId</span> = <span class="r214 r">context</span>.<a href="ExecutionContext.cs.html#347758c52bbd3a07" class="i property">ShellID</a>;
                    <a href="../security/SecuritySupport.cs.html#5c234bd2337db61c" class="t t">SecuritySupport</a>.<a href="../security/SecuritySupport.cs.html#520b7f8d921f5404" class="i method">SetExecutionPolicy</a>(<span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecuritySupport.cs.html#a2a8c6696f673043" class="t t">ExecutionPolicyScope</a>.<a href="../security/SecuritySupport.cs.html#0b046bc9f6673ceb" class="i field">Process</a>, <a href="#88f2d379b0e326cd" class="i property">ExecutionPolicy</a>, <span class="r226 r">shellId</span>);
                }
            }
 
            <a href="#b0eed19828ed022d" class="i method">SetSessionStateDrive</a>(<span class="r214 r">context</span>, <span class="r227 r">setLocation</span>: <span class="r219 r">setLocation</span>);
        }
 
        <b>private void</b> <a id="de6f71f20afc4d91" href="../R/de6f71f20afc4d91.html" target="n" data-glyph="76,1" class="i method">Bind_SetVariables</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r228 rd" class="r228 r">ss</span>)
        {
            <b>bool</b> <span id="r229 rd" class="r229 r">etwEnabled</span> = <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r229 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#d578d2cad21298b9" class="i method">LoadVariablesStart</a>();
            }
 
            <span class="c">// Add all of the variables to session state...</span>
            <b>foreach</b> (<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a> <span id="r230 rd" class="r230 r">var</span> <b>in</b> <a href="#fb98d8254252d236" class="i property">Variables</a>)
            {
                <span class="r228 r">ss</span>.<a href="SessionStateVariableAPIs.cs.html#30ca54e03c72ec00" class="i method">AddSessionStateEntry</a>(<span class="r230 r">var</span>);
            }
 
            <b>if</b> (<span class="r229 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#1f83e45af7e0ce4f" class="i method">LoadVariablesStop</a>();
            }
        }
 
        <b>private void</b> <a id="12c26e4030df6a87" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Bind_SetEnvironment</a>()
        {
            <b>bool</b> <span id="r231 rd" class="r231 r">etwEnabled</span> = <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r231 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#0e59f17cb501c9ce" class="i method">LoadEnvironmentVariablesStart</a>();
            }
 
            <b>foreach</b> (<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a> <span id="r232 rd" class="r232 r">var</span> <b>in</b> <a href="#fd320e175dc61ca2" class="i property">EnvironmentVariables</a>)
            {
                <span class="i">Environment</span>.<span class="i">SetEnvironmentVariable</span>(<span class="r232 r">var</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="r232 r">var</span>.<a href="#aba39087490e68e6" class="i property">Value</a>.<span class="i">ToString</span>());
            }
 
            <b>if</b> (<span class="r231 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#90f51a245c266a03" class="i method">LoadEnvironmentVariablesStop</a>();
            }
        }
 
        <b>private void</b> <a id="2489e7bcb7847dd9" href="../R/2489e7bcb7847dd9.html" target="n" data-glyph="76,1" class="i method">Bind_UpdateTypes</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r233 rd" class="r233 r">context</span>, <b>bool</b> <span id="r234 rd" class="r234 r">updateOnly</span>)
        {
            <b>bool</b> <span id="r235 rd" class="r235 r">etwEnabled</span> = <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r235 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#ba77396f00b2b92b" class="i method">UpdateTypeTableStart</a>();
            }
 
            <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#9c0409e753e2228b" class="i method">UpdateTypes</a>(<span class="r233 r">context</span>, <span class="r234 r">updateOnly</span>);
            <b>if</b> (<span class="r235 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#c5a688a273456543" class="i method">UpdateTypeTableStop</a>();
            }
        }
 
        <b>private void</b> <a id="89b7bc7e0084ab89" href="../R/89b7bc7e0084ab89.html" target="n" data-glyph="76,1" class="i method">Bind_UpdateFormats</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r236 rd" class="r236 r">context</span>, <b>bool</b> <span id="r237 rd" class="r237 r">updateOnly</span>)
        {
            <b>bool</b> <span id="r238 rd" class="r238 r">etwEnabled</span> = <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r238 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#916b8faf20103c39" class="i method">UpdateFormatTableStart</a>();
            }
 
            <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#6a9371cd77e6c41f" class="i method">UpdateFormats</a>(<span class="r236 r">context</span>, <span class="r237 r">updateOnly</span>);
 
            <b>if</b> (<span class="r238 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#fd2b0c9ccbcd9486" class="i method">UpdateFormatTableStop</a>();
            }
        }
 
        <b>private void</b> <a id="7557fb3393976420" href="../R/7557fb3393976420.html" target="n" data-glyph="76,1" class="i method">Bind_LoadProviders</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r239 rd" class="r239 r">ss</span>)
        {
            <b>bool</b> <span id="r240 rd" class="r240 r">etwEnabled</span> = <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r240 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#8ac76730e6b161e6" class="i method">LoadProvidersStart</a>();
            }
 
            <span class="c">// Add all of the providers to session state...</span>
            <b>foreach</b> (<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r241 rd" class="r241 r">provider</span> <b>in</b> <a href="#901a2e8b67c4db16" class="i property">Providers</a>)
            {
                <b>if</b> (<span class="r240 r">etwEnabled</span>)
                {
                    <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#798bbe7b8814f024" class="i method">LoadProviderStart</a>(<span class="r241 r">provider</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>);
                }
 
                <span class="r239 r">ss</span>.<a href="SessionStateProviderAPIs.cs.html#365f0e3eed5536c0" class="i method">AddSessionStateEntry</a>(<span class="r241 r">provider</span>);
                <b>if</b> (<span class="r240 r">etwEnabled</span>)
                {
                    <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#a483346e02c61697" class="i method">LoadProviderStop</a>(<span class="r241 r">provider</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>);
                }
            }
 
            <b>if</b> (<span class="r240 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#25ec41023a49a25f" class="i method">LoadProvidersStop</a>();
            }
        }
 
        <b>private void</b> <a id="a4716197a771b66e" href="../R/a4716197a771b66e.html" target="n" data-glyph="76,1" class="i method">Bind_BindCommands</a>(<a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r242 rd" class="r242 r">module</span>, <b>bool</b> <span id="r243 rd" class="r243 r">noClobber</span>, <b>bool</b> <span id="r244 rd" class="r244 r">local</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r245 rd" class="r245 r">ss</span>)
        {
            <b>bool</b> <span id="r246 rd" class="r246 r">etwEnabled</span> = <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r246 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#8c5c14571e4651a9" class="i method">LoadCommandsStart</a>();
            }
 
            <b>foreach</b> (<a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a> <span id="r247 rd" class="r247 r">cmd</span> <b>in</b> <a href="#2d45d0b0db0079ba" class="i property">Commands</a>)
            {
                <b>if</b> (<span class="r246 r">etwEnabled</span>)
                {
                    <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#4985ae7c74cd7be6" class="i method">LoadCommandStart</a>(<span class="r247 r">cmd</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>);
                }
 
                <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r248 rd" class="r248 r">ssce</span> = <span class="r247 r">cmd</span> <b>as</b> <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>;
                <b>if</b> (<span class="r248 r">ssce</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r243 r">noClobber</span> &amp;&amp; <a href="Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="Modules/ModuleCmdletBase.cs.html#9e9417dca7aca62e" class="i method">CommandFound</a>(<span class="r248 r">ssce</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="r245 r">ss</span>))
                    {
                        <span class="r248 r">ssce</span>.<a href="#cc7c5811dcdf0890" class="i field">_isImported</a> = <b>false</b>;
                        <b>continue</b>;
                    }
 
                    <span class="r245 r">ss</span>.<a href="SessionState.cs.html#81d2e0b6e53ec4fa" class="i method">AddSessionStateEntry</a>(<span class="r248 r">ssce</span>, <span class="r244 r">local</span>);
 
                    <span class="r247 r">cmd</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<span class="r242 r">module</span>);
                    <b>continue</b>;
                }
 
                <span class="r247 r">cmd</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<span class="r242 r">module</span>);
 
                <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a> <span id="r249 rd" class="r249 r">ssfe</span> = <span class="r247 r">cmd</span> <b>as</b> <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>;
                <b>if</b> (<span class="r249 r">ssfe</span> != <b>null</b>)
                {
                    <span class="r245 r">ss</span>.<a href="SessionStateFunctionAPIs.cs.html#b740d427d5de79dc" class="i method">AddSessionStateEntry</a>(<span class="r249 r">ssfe</span>);
                    <b>continue</b>;
                }
 
                <a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a> <span id="r250 rd" class="r250 r">ssae</span> = <span class="r247 r">cmd</span> <b>as</b> <a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>;
                <b>if</b> (<span class="r250 r">ssae</span> != <b>null</b>)
                {
                    <span class="r245 r">ss</span>.<a href="SessionStateAliasAPIs.cs.html#67dc96276d612c64" class="i method">AddSessionStateEntry</a>(<span class="r250 r">ssae</span>, <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#17a9ff531b8319f7" class="i field">Local</a>);
                    <b>continue</b>;
                }
 
                <a href="#eac0c2c0c238d4f8" class="t t">SessionStateApplicationEntry</a> <span id="r251 rd" class="r251 r">ssappe</span> = <span class="r247 r">cmd</span> <b>as</b> <a href="#eac0c2c0c238d4f8" class="t t">SessionStateApplicationEntry</a>;
                <b>if</b> (<span class="r251 r">ssappe</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r251 r">ssappe</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a> == <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
                    {
                        <span class="r245 r">ss</span>.<a href="SessionState.cs.html#fa6382c5e2c3f311" class="i method">AddSessionStateEntry</a>(<span class="r251 r">ssappe</span>);
                    }
 
                    <b>continue</b>;
                }
 
                <a href="#12337c12cd2f1655" class="t t">SessionStateScriptEntry</a> <span id="r252 rd" class="r252 r">ssse</span> = <span class="r247 r">cmd</span> <b>as</b> <a href="#12337c12cd2f1655" class="t t">SessionStateScriptEntry</a>;
                <b>if</b> (<span class="r252 r">ssse</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r252 r">ssse</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a> == <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
                    {
                        <span class="r245 r">ss</span>.<a href="SessionState.cs.html#66e895e0d3b41629" class="i method">AddSessionStateEntry</a>(<span class="r252 r">ssse</span>);
                    }
 
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r246 r">etwEnabled</span>)
                {
                    <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#ddd9a1437e3f6899" class="i method">LoadCommandStop</a>(<span class="r247 r">cmd</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>);
                }
            }
 
            <b>if</b> (<span class="r246 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#32a88e13eb2ca01e" class="i method">LoadCommandsStop</a>();
            }
        }
 
        <b>private void</b> <a id="1d38fc10d995df3f" href="../R/1d38fc10d995df3f.html" target="n" data-glyph="76,1" class="i method">Bind_LoadAssemblies</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r253 rd" class="r253 r">context</span>)
        {
            <b>bool</b> <span id="r254 rd" class="r254 r">etwEnabled</span> = <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r254 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#51ccf96a87770b7a" class="i method">LoadAssembliesStart</a>();
            }
 
            <span class="c">// Load the assemblies and initialize the assembly cache...</span>
            <b>foreach</b> (<a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a> <span id="r255 rd" class="r255 r">ssae</span> <b>in</b> <a href="#501914944d122594" class="i property">Assemblies</a>)
            {
                <b>if</b> (<span class="r254 r">etwEnabled</span>) <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#685867b77ec22143" class="i method">LoadAssemblyStart</a>(<span class="r255 r">ssae</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="r255 r">ssae</span>.<a href="#59415471a204963b" class="i property">FileName</a>);
                <span class="i">Exception</span> <span id="r256 rd" class="r256 r">error</span> = <b>null</b>;
                <span class="i">Assembly</span> <span id="r257 rd" class="r257 r">asm</span> = <span class="r253 r">context</span>.<a href="ExecutionContext.cs.html#bc1bafaf5d7b0ca2" class="i method">AddAssembly</a>(<span class="r255 r">ssae</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="r255 r">ssae</span>.<a href="#59415471a204963b" class="i property">FileName</a>, <b>out</b> <span class="r256 r">error</span>);
 
                <b>if</b> (<span class="r257 r">asm</span> == <b>null</b> || <span class="r256 r">error</span> != <b>null</b>)
                {
                    <span class="c">// If no module was found but there was no specific error, then</span>
                    <span class="c">// create a not found error.</span>
                    <b>if</b> (<span class="r256 r">error</span> == <b>null</b>)
                    {
                        <b>string</b> <span id="r258 rd" class="r258 r">msg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<b>global</b>::<span class="i">Modules</span>.<span class="i">ModuleAssemblyFound</span>, <span class="r255 r">ssae</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>);
                        <span class="r256 r">error</span> = <b>new</b> <span class="i">DllNotFoundException</span>(<span class="r258 r">msg</span>);
                    }
 
                    <span class="c">// If this occurs while loading a module manifest, just</span>
                    <span class="c">// throw the exception instead of writing it out...</span>
                    <b>if</b> ((!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r253 r">context</span>.<a href="ExecutionContext.cs.html#a362f3393ffdf245" class="i property">ModuleBeingProcessed</a>) &amp;&amp;
                         <span class="i">Path</span>.<span class="i">GetExtension</span>(<span class="r253 r">context</span>.<a href="ExecutionContext.cs.html#a362f3393ffdf245" class="i property">ModuleBeingProcessed</a>)
                             .<span class="i">Equals</span>(
                                 <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#35afed2e7cb8ba9d" class="i field">PowerShellDataFileExtension</a>,
                                 <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) ||
                        <a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
                    {
                        <b>throw</b> <span class="r256 r">error</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r253 r">context</span>.<span class="i">ReportEngineStartupError</span>(<span class="r256 r">error</span>.<span class="i">Message</span>);
                    }
                }
 
                <b>if</b> (<span class="r254 r">etwEnabled</span>)
                {
                    <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#744d8407249a781c" class="i method">LoadAssemblyStop</a>(<span class="r255 r">ssae</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="r255 r">ssae</span>.<a href="#59415471a204963b" class="i property">FileName</a>);
                }
            }
 
            <b>if</b> (<span class="r254 r">etwEnabled</span>)
            {
                <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a>.<a href="#d10c972f303cf36c" class="i field">Log</a>.<a href="#4991c6101c3dc943" class="i method">LoadAssembliesStop</a>();
            }
        }
 
        <b>internal</b> <span class="i">Exception</span> <a id="ba61cb4c92c13fe7" href="../R/ba61cb4c92c13fe7.html" target="n" data-glyph="74,1" class="i method">BindRunspace</a>(<a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r259 rd" class="r259 r">initializedRunspace</span>, <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <span id="r260 rd" class="r260 r">runspaceInitTracer</span>)
        {
            <span class="c">// Get the initial list of public commands from session in a lazy way, so that we can defer</span>
            <span class="c">// the work until it&#39;s actually needed.</span>
            <span class="c">//</span>
            <span class="c">// We could use Lazy&lt;&gt; with an initializer for the same purpose, but we can save allocations</span>
            <span class="c">// by using the local function. It avoids allocating the delegate, and it&#39;s more efficient on</span>
            <span class="c">// capturing variables from the enclosing scope by using a struct.</span>
            <span class="i">HashSet</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt; <span id="r261 rd" class="r261 r">publicCommands</span> = <b>null</b>;
            <span class="i">HashSet</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt; <a id="16563132bc565790" href="../R/16563132bc565790.html" target="n" data-glyph="76,2" class="i method">GetPublicCommands</a>()
            {
                <b>if</b> (<span class="r261 r">publicCommands</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r261 r">publicCommands</span>;
                }
 
                <span class="r261 r">publicCommands</span> = <b>new</b> <span class="i">HashSet</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt;();
                <b>foreach</b> (<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r262 rd" class="r262 r">sessionCommand</span> <b>in</b> <span class="r259 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="SessionStatePublic.cs.html#236f6ceba41f8f3e" class="i property">InvokeCommand</a>.<span class="i">GetCommands</span>(
                            <span class="i">name</span>: <span class="s">&quot;*&quot;</span>,
                            <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#7837d2f5f0343c5e" class="i field">Filter</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>,
                            <span class="i">nameIsPattern</span>: <b>true</b>))
                {
                    <b>if</b> (<span class="r262 r">sessionCommand</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> == <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
                    {
                        <span class="r261 r">publicCommands</span>.<span class="i">Add</span>(<span class="r262 r">sessionCommand</span>);
                    }
                }
 
                <b>return</b> <span class="r261 r">publicCommands</span>;
            }
 
            <b>var</b> <span id="r263 rd" class="r263 r">unresolvedCmdsToExpose</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#b128cdc6af34af14" class="i property">UnresolvedCommandsToExpose</a>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>if</b> (<a href="#4825fe007c6fa7d1" class="i property">CoreModulesToImport</a>.<span class="i">Count</span> &gt; 0 || <span class="r263 r">unresolvedCmdsToExpose</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// If a user has any module with the same name as that of the core module( or nested module inside the core module)</span>
                <span class="c">// in his module path, then that will get loaded instead of the actual nested module (from the GAC - in our case)</span>
                <span class="c">// Hence, searching only from the system module path while loading the core modules</span>
                <span class="i">ProcessModulesToImport</span>(<span class="r259 r">initializedRunspace</span>, <a href="#4825fe007c6fa7d1" class="i property">CoreModulesToImport</a>, <a href="Modules/ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="Modules/ModuleIntrinsics.cs.html#f7332eb7c199d50c" class="i method">GetPSHomeModulePath</a>(), <a href="#16563132bc565790" class="i method">GetPublicCommands</a>(), <span class="r263 r">unresolvedCmdsToExpose</span>);
            }
 
            <span class="c">// Win8:328748 - functions defined in global scope end up in a module</span>
            <span class="c">// Since we import the core modules, EngineSessionState&#39;s module is set to the last imported module. So, if a function is defined in global scope, it ends up in that module.</span>
            <span class="c">// Setting the module to null fixes that.</span>
            <span class="r259 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#1900efdc2f293d5a" class="i property">Module</a> = <b>null</b>;
 
            <b>if</b> (<a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>.<span class="i">Count</span> &gt; 0 || <span class="r263 r">unresolvedCmdsToExpose</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">Exception</span> <span id="r264 rd" class="r264 r">moduleImportException</span> = <span class="i">ProcessModulesToImport</span>(<span class="r259 r">initializedRunspace</span>, <a href="#88f2194fd3b340ef" class="i property">ModuleSpecificationsToImport</a>, <b>string</b>.<span class="i">Empty</span>, <a href="#16563132bc565790" class="i method">GetPublicCommands</a>(), <span class="r263 r">unresolvedCmdsToExpose</span>);
                <b>if</b> (<span class="r264 r">moduleImportException</span> != <b>null</b>)
                {
                    <span class="r260 r">runspaceInitTracer</span>.<span class="i">WriteLine</span>(
                        <span class="s">&quot;Runspace open failed while loading module: First error {1}&quot;</span>,
                        <span class="r264 r">moduleImportException</span>);
                    <b>return</b> <span class="r264 r">moduleImportException</span>;
                }
            }
 
            <span class="c">// If we still have unresolved commands after importing specified modules, then try finding associated module for</span>
            <span class="c">// each unresolved command and import that module.</span>
            <b>if</b> (<span class="r263 r">unresolvedCmdsToExpose</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>string</b>[] <span id="r265 rd" class="r265 r">foundModuleList</span> = <span class="i">GetModulesForUnResolvedCommands</span>(<span class="r263 r">unresolvedCmdsToExpose</span>, <span class="r259 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>);
                <b>if</b> (<span class="r265 r">foundModuleList</span>.<span class="i">Length</span> &gt; 0)
                {
                    <span class="i">ProcessModulesToImport</span>(<span class="r259 r">initializedRunspace</span>, <span class="r265 r">foundModuleList</span>, <b>string</b>.<span class="i">Empty</span>, <a href="#16563132bc565790" class="i method">GetPublicCommands</a>(), <span class="r263 r">unresolvedCmdsToExpose</span>);
                }
            }
 
            <span class="c">// Process dynamic variables if any are defined.</span>
            <b>if</b> (<a href="#6495f363726e5904" class="i property">DynamicVariablesToDefine</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#755a7ab9a977b3a8" class="i method">ProcessDynamicVariables</a>(<span class="r259 r">initializedRunspace</span>);
            }
 
            <span class="c">// Process command modifications if any are defined.</span>
            <b>if</b> (<a href="#f99479288a54ef17" class="i property">CommandModifications</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#5412266af65a332b" class="i method">ProcessCommandModifications</a>(<span class="r259 r">initializedRunspace</span>);
            }
 
            <span class="c">// Process the &#39;User:&#39; drive if &#39;UserDriveEnabled&#39; is set.</span>
            <b>if</b> (<a href="#50b5fd24b0a675b4" class="i property">UserDriveEnabled</a>)
            {
                <span class="i">Exception</span> <span id="r266 rd" class="r266 r">userDriveException</span> = <a href="#c3f93d7d3ed6a835" class="i method">ProcessUserDrive</a>(<span class="r259 r">initializedRunspace</span>);
                <b>if</b> (<span class="r266 r">userDriveException</span> != <b>null</b>)
                {
                    <span class="r260 r">runspaceInitTracer</span>.<span class="i">WriteLine</span>(
                        <span class="s">&quot;Runspace open failed while processing user drive with error {1}&quot;</span>,
                        <span class="r266 r">userDriveException</span>);
 
                    <span class="i">Exception</span> <span id="r267 rd" class="r267 r">result</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="r266 r">userDriveException</span>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">UserDriveProcessingThrewTerminatingError</span>, <span class="r266 r">userDriveException</span>.<span class="i">Message</span>);
                    <b>return</b> <span class="r267 r">result</span>;
                }
            }
 
            <span class="c">// Process startup scripts</span>
            <b>if</b> (<a href="#4074645df9605a16" class="i property">StartupScripts</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">Exception</span> <span id="r268 rd" class="r268 r">startupScriptException</span> = <a href="#043c8fe540ea6576" class="i method">ProcessStartupScripts</a>(<span class="r259 r">initializedRunspace</span>);
                <b>if</b> (<span class="r268 r">startupScriptException</span> != <b>null</b>)
                {
                    <span class="r260 r">runspaceInitTracer</span>.<span class="i">WriteLine</span>(
                        <span class="s">&quot;Runspace open failed while running startup script: First error {1}&quot;</span>,
                        <span class="r268 r">startupScriptException</span>);
 
                    <span class="i">Exception</span> <span id="r269 rd" class="r269 r">result</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="r268 r">startupScriptException</span>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">StartupScriptThrewTerminatingError</span>, <span class="r268 r">startupScriptException</span>.<span class="i">Message</span>);
                    <b>return</b> <span class="r269 r">result</span>;
                }
            }
 
            <span class="c">// Start transcribing</span>
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#91f2e76aef046d1e" class="i property">TranscriptDirectory</a>))
            {
                <b>using</b> (<a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r270 rd" class="r270 r">psToInvoke</span> = <a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
                {
                    <span class="r270 r">psToInvoke</span>.<a href="hostifaces/PowerShell.cs.html#f68f5b3ba7949aa4" class="i method">AddCommand</a>(<b>new</b> <a href="hostifaces/Command.cs.html#6c075592cf04e686" class="t constructor">Command</a>(<span class="s">&quot;Start-Transcript&quot;</span>)).<a href="hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;OutputDirectory&quot;</span>, <a href="#91f2e76aef046d1e" class="i property">TranscriptDirectory</a>);
                    <span class="i">Exception</span> <span id="r271 rd" class="r271 r">exceptionToReturn</span> = <a href="#a7f4e0b3669d238a" class="i method">ProcessPowerShellCommand</a>(<span class="r270 r">psToInvoke</span>, <span class="r259 r">initializedRunspace</span>);
                    <b>if</b> (<span class="r271 r">exceptionToReturn</span> != <b>null</b>)
                    {
                        <span class="c">// ThrowOnRunspaceOpenError handling is done by ProcessPowerShellCommand</span>
                        <b>return</b> <span class="r271 r">exceptionToReturn</span>;
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static string</b>[] <a id="24fe47b632612992" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetModulesForUnResolvedCommands</a>(<span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r272 rd" class="r272 r">unresolvedCommands</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r273 rd" class="r273 r">context</span>)
        {
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r274 rd" class="r274 r">modulesToImport</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r275 rd" class="r275 r">commandsToResolve</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>var</b> <span id="r276 rd" class="r276 r">unresolvedCommand</span> <b>in</b> <span class="r272 r">unresolvedCommands</span>)
            {
                <b>string</b> <span id="r277 rd" class="r277 r">moduleName</span>;
                <b>string</b> <span id="r278 rd" class="r278 r">command</span> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">ParseCommandName</span>(<span class="r276 r">unresolvedCommand</span>, <b>out</b> <span class="r277 r">moduleName</span>);
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r277 r">moduleName</span>))
                {
                    <span class="c">// Skip fully qualified module names since they are already processed.</span>
                    <b>continue</b>;
                }
 
                <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r278 r">command</span>))
                {
                    <span class="c">// Skip names with wild cards.</span>
                    <b>continue</b>;
                }
 
                <span class="r275 r">commandsToResolve</span>.<span class="i">Add</span>(<span class="r278 r">command</span>);
            }
 
            <b>if</b> (<span class="r275 r">commandsToResolve</span>.<span class="i">Count</span> &gt; 0)
            {
                <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r279 rd" class="r279 r">restoreRunspace</span> = <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>;
                <b>try</b>
                {
                    <span class="c">// Create a temporary default runspace for the analysis cache to use.</span>
                    <b>using</b> (<a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r280 rd" class="r280 r">tempRunspace</span> = <a href="hostifaces/ConnectionFactory.cs.html#c5fbe142e4e21218" class="t t">RunspaceFactory</a>.<a href="hostifaces/ConnectionFactory.cs.html#d1898b5d69d8413b" class="i method">CreateRunspace</a>())
                    {
                        <span class="r280 r">tempRunspace</span>.<a href="hostifaces/Connection.cs.html#61f55439fb78f2fe" class="i method">Open</a>();
                        <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <span class="r280 r">tempRunspace</span>;
 
                        <b>foreach</b> (<b>var</b> <span id="r281 rd" class="r281 r">unresolvedCommand</span> <b>in</b> <span class="r275 r">commandsToResolve</span>)
                        {
                            <span class="c">// Use the analysis cache to find the first module containing the unresolved command.</span>
                            <b>foreach</b> (<b>string</b> <span id="r282 rd" class="r282 r">modulePath</span> <b>in</b> <a href="Modules/ModuleUtils.cs.html#623e3612c4173093" class="t t">ModuleUtils</a>.<a href="Modules/ModuleUtils.cs.html#2c015e257649873c" class="i method">GetDefaultAvailableModuleFiles</a>(<span class="r283 r">isForAutoDiscovery</span>: <b>true</b>, <span class="r273 r">context</span>))
                            {
                                <b>string</b> <span id="r284 rd" class="r284 r">expandedModulePath</span> = <span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetFullPath</span>(<span class="r282 r">modulePath</span>);
                                <b>var</b> <span id="r285 rd" class="r285 r">exportedCommands</span> = <a href="Modules/AnalysisCache.cs.html#e469d7c6575d3464" class="t t">AnalysisCache</a>.<a href="Modules/AnalysisCache.cs.html#c5534fd9817cef4e" class="i method">GetExportedCommands</a>(<span class="r284 r">expandedModulePath</span>, <b>false</b>, <span class="r273 r">context</span>);
 
                                <b>if</b> (<span class="r285 r">exportedCommands</span> != <b>null</b> &amp;&amp; <span class="r285 r">exportedCommands</span>.<span class="i">ContainsKey</span>(<span class="r281 r">unresolvedCommand</span>))
                                {
                                    <span class="r274 r">modulesToImport</span>.<span class="i">Add</span>(<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="r284 r">expandedModulePath</span>));
                                    <b>break</b>;
                                }
                            }
                        }
                    }
                }
                <b>finally</b>
                {
                    <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <span class="r279 r">restoreRunspace</span>;
                }
            }
 
            <b>return</b> <span class="r274 r">modulesToImport</span>.<span class="i">ToArray</span>&lt;<b>string</b>&gt;();
        }
 
        <b>private void</b> <a id="5412266af65a332b" href="../R/5412266af65a332b.html" target="n" data-glyph="76,1" class="i method">ProcessCommandModifications</a>(<a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r286 rd" class="r286 r">initializedRunspace</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r287 rd" class="r287 r">pair</span> <b>in</b> <a href="#f99479288a54ef17" class="i property">CommandModifications</a>)
            {
                <b>string</b> <span id="r288 rd" class="r288 r">commandName</span> = <span class="r287 r">pair</span>.<span class="i">Key</span>;
                <span class="i">Hashtable</span> <span id="r289 rd" class="r289 r">commandModification</span> = <span class="r287 r">pair</span>.<span class="i">Value</span>;
 
                <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r290 rd" class="r290 r">existingCommand</span> = <span class="r286 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#c43f0c90447752e8" class="i property">SessionStateProxy</a>.<a href="hostifaces/Connection.cs.html#7b4fd642c95f5526" class="i property">InvokeCommand</a>.<a href="MshCmdlet.cs.html#3ffcadf864210a8f" class="i method">GetCommand</a>(<span class="r288 r">commandName</span>, <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a>);
                <b>if</b> (<span class="r290 r">existingCommand</span> == <b>null</b>)
                {
                    <span class="c">// Could not find the command - just continue, rather than generating an error. This could just be a missing module</span>
                    <span class="c">// or something similar.</span>
                    <b>continue</b>;
                }
 
                <span class="c">// If we are wrapping a function, rename it.</span>
                <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r291 rd" class="r291 r">commandAsFunction</span> = <span class="r290 r">existingCommand</span> <b>as</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>;
                <b>if</b> (<span class="r291 r">commandAsFunction</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r292 rd" class="r292 r">newCommandName</span> = <span class="r291 r">commandAsFunction</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a> + <span class="s">&quot;_&quot;</span> + <span class="i">Guid</span>.<span class="i">NewGuid</span>().<span class="i">ToString</span>(<span class="s">&quot;N&quot;</span>);
                    <span class="r291 r">commandAsFunction</span>.<a href="CommandInfo.cs.html#16f61f52a82b9c39" class="i method">Rename</a>(<span class="r292 r">newCommandName</span>);
                    <span class="r286 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#0cb72e1b3b779c82" class="i property">FunctionTable</a>.<span class="i">Add</span>(<span class="r292 r">newCommandName</span>, <span class="r291 r">commandAsFunction</span>);
                    <span class="r286 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#0cb72e1b3b779c82" class="i property">FunctionTable</a>.<span class="i">Remove</span>(<span class="r288 r">commandName</span>);
                    <span class="r290 r">existingCommand</span> = <span class="r286 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#c43f0c90447752e8" class="i property">SessionStateProxy</a>.<a href="hostifaces/Connection.cs.html#7b4fd642c95f5526" class="i property">InvokeCommand</a>.<a href="MshCmdlet.cs.html#3ffcadf864210a8f" class="i method">GetCommand</a>(<span class="r292 r">newCommandName</span>, <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a>);
                }
 
                <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r293 rd" class="r293 r">metadata</span> = <b>new</b> <a href="CommandMetadata.cs.html#67fe3aba634d5055" class="t constructor">CommandMetadata</a>(<span class="r290 r">existingCommand</span>);
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r294 rd" class="r294 r">unprocessedCommandModifications</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>foreach</b> (<b>string</b> <span id="r295 rd" class="r295 r">commandModificationParameter</span> <b>in</b> <span class="r289 r">commandModification</span>.<span class="i">Keys</span>)
                {
                    <span class="r294 r">unprocessedCommandModifications</span>.<span class="i">Add</span>(<span class="r295 r">commandModificationParameter</span>);
                }
 
                <span class="c">// Visit all parameters of the command we&#39;re wrapping</span>
                <b>foreach</b> (<b>string</b> <span id="r296 rd" class="r296 r">existingParameter</span> <b>in</b> <span class="r293 r">metadata</span>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>.<span class="i">Keys</span>.<span class="i">ToArray</span>&lt;<b>string</b>&gt;())
                {
                    <span class="c">// If it&#39;s not allowed, remove it</span>
                    <b>if</b> (!<span class="r289 r">commandModification</span>.<span class="i">ContainsKey</span>(<span class="r296 r">existingParameter</span>))
                    {
                        <span class="r293 r">metadata</span>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>.<span class="i">Remove</span>(<span class="r296 r">existingParameter</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Remember that we&#39;ve processed this parameter, so that we can add the remainder</span>
                        <span class="c">// as virtual command modifications over (what we must assume to be) dynamic parameters.</span>
                        <span class="r294 r">unprocessedCommandModifications</span>.<span class="i">Remove</span>(<span class="r296 r">existingParameter</span>);
 
                        <a href="#dc36cd8e5d9bf72a" class="i method">ProcessCommandModification</a>(<span class="r289 r">commandModification</span>, <span class="r293 r">metadata</span>, <span class="r296 r">existingParameter</span>);
                    }
                }
 
                <span class="c">// Now, process the command modifications that the user requested (but there was no parameter</span>
                <span class="c">// in the cmdlet that matched the requested parameter)</span>
                <b>foreach</b> (<b>string</b> <span id="r297 rd" class="r297 r">unprocessedCommandModification</span> <b>in</b> <span class="r294 r">unprocessedCommandModifications</span>)
                {
                    <a href="#dc36cd8e5d9bf72a" class="i method">ProcessCommandModification</a>(<span class="r289 r">commandModification</span>, <span class="r293 r">metadata</span>, <span class="r297 r">unprocessedCommandModification</span>);
                }
 
                <b>string</b> <span id="r298 rd" class="r298 r">proxyBody</span> = <a href="ProxyCommand.cs.html#d53207f43e14c0fe" class="t t">ProxyCommand</a>.<span class="i">Create</span>(<span class="r293 r">metadata</span>, <b>string</b>.<span class="i">Empty</span>, <b>false</b>);
                <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r299 rd" class="r299 r">proxyScriptBlock</span> = <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#adfac0fa7bf5725f" class="i method">Create</a>(<span class="r298 r">proxyBody</span>);
                <span class="r299 r">proxyScriptBlock</span>.<a href="lang/scriptblock.cs.html#5e76a9fb0d1a7f12" class="i property">LanguageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
 
                <span class="r286 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#0cb72e1b3b779c82" class="i property">FunctionTable</a>.<span class="i">Add</span>(
                    <span class="r288 r">commandName</span>, <b>new</b> <a href="FunctionInfo.cs.html#daf907e5a42ad149" class="t constructor">FunctionInfo</a>(<span class="r288 r">commandName</span>, <span class="r299 r">proxyScriptBlock</span>, <span class="r286 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process a command modification for a specific parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r300 r">commandModification</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The hashtable of command modifications for this command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r301 r">metadata</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The metadata for the command being processed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r302 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The parameter being modified.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="dc36cd8e5d9bf72a" href="../R/dc36cd8e5d9bf72a.html" target="n" data-glyph="76,1" class="i method">ProcessCommandModification</a>(<span class="i">Hashtable</span> <span id="r300 rd" class="r300 r">commandModification</span>, <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r301 rd" class="r301 r">metadata</span>, <b>string</b> <span id="r302 rd" class="r302 r">parameterName</span>)
        {
            <span class="c">// If the metadata doesn&#39;t actually contain the parameter, then we need to create one.</span>
            <b>if</b> (!<span class="r301 r">metadata</span>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>.<span class="i">ContainsKey</span>(<span class="r302 r">parameterName</span>))
            {
                <span class="r301 r">metadata</span>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>[<span class="r302 r">parameterName</span>] = <b>new</b> <a href="TypeMetadata.cs.html#65e0a2cab6ea9bce" class="t constructor">ParameterMetadata</a>(<span class="r302 r">parameterName</span>);
            }
 
            <span class="c">// Add validation attributes</span>
            <span class="i">Hashtable</span> <span id="r303 rd" class="r303 r">parameterValidations</span> = (<span class="i">Hashtable</span>)<span class="r300 r">commandModification</span>[<span class="r302 r">parameterName</span>];
            <b>foreach</b> (<b>object</b> <span id="r304 rd" class="r304 r">parameterValidation</span> <b>in</b> <span class="r303 r">parameterValidations</span>.<span class="i">Keys</span>)
            {
                <b>string</b>[] <span id="r305 rd" class="r305 r">parameterValidationValues</span> =
                    ((<span class="i">HashSet</span>&lt;<b>string</b>&gt;)<span class="r303 r">parameterValidations</span>[<span class="r304 r">parameterValidation</span>]).<span class="i">ToList</span>&lt;<b>string</b>&gt;().<span class="i">ToArray</span>();
 
                <b>switch</b> (<span class="r304 r">parameterValidation</span>.<span class="i">ToString</span>())
                {
                    <b>case</b> <span class="s">&quot;ValidateSet&quot;</span>:
                        <a href="Attributes.cs.html#33a6a027748d30a4" class="t t">ValidateSetAttribute</a> <span id="r306 rd" class="r306 r">validateSet</span> = <b>new</b> <a href="Attributes.cs.html#e156071d7c94ccee" class="t constructor">ValidateSetAttribute</a>(<span class="r305 r">parameterValidationValues</span>);
                        <span class="r301 r">metadata</span>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>[<span class="r302 r">parameterName</span>].<span class="i">Attributes</span>.<span class="i">Add</span>(<span class="r306 r">validateSet</span>);
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&quot;ValidatePattern&quot;</span>:
                        <b>string</b> <span id="r307 rd" class="r307 r">pattern</span> = <span class="s">&quot;^(&quot;</span> + <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;|&quot;</span>, <span class="r305 r">parameterValidationValues</span>) + <span class="s">&quot;)$&quot;</span>;
                        <a href="Attributes.cs.html#03062544c856ad82" class="t t">ValidatePatternAttribute</a> <span id="r308 rd" class="r308 r">validatePattern</span> = <b>new</b> <a href="Attributes.cs.html#33866253d829c106" class="t constructor">ValidatePatternAttribute</a>(<span class="r307 r">pattern</span>);
                        <span class="r301 r">metadata</span>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>[<span class="r302 r">parameterName</span>].<span class="i">Attributes</span>.<span class="i">Add</span>(<span class="r308 r">validatePattern</span>);
                        <b>break</b>;
                }
            }
        }
 
        <b>private</b> <span class="i">Exception</span> <a id="755a7ab9a977b3a8" href="../R/755a7ab9a977b3a8.html" target="n" data-glyph="76,1" class="i method">ProcessDynamicVariables</a>(<a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r309 rd" class="r309 r">initializedRunspace</span>)
        {
            <b>foreach</b> (<span class="i">Hashtable</span> <span id="r310 rd" class="r310 r">variable</span> <b>in</b> <a href="#6495f363726e5904" class="i property">DynamicVariablesToDefine</a>)
            {
                <b>if</b> (<span class="r310 r">variable</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;Name&quot;</span>))
                {
                    <b>string</b> <span id="r311 rd" class="r311 r">name</span> = <span class="r310 r">variable</span>[<span class="s">&quot;Name&quot;</span>].<span class="i">ToString</span>();
                    <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r312 rd" class="r312 r">sb</span> = <span class="r310 r">variable</span>[<span class="s">&quot;Value&quot;</span>] <b>as</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>;
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r311 r">name</span>) &amp;&amp; (<span class="r312 r">sb</span> != <b>null</b>))
                    {
                        <span class="r312 r">sb</span>.<a href="lang/scriptblock.cs.html#d25a345294fd74f0" class="i property">SessionStateInternal</a> = <span class="r309 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
 
                        <b>using</b> (<a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r313 rd" class="r313 r">psToInvoke</span> = <a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
                        {
                            <span class="r313 r">psToInvoke</span>.<a href="hostifaces/PowerShell.cs.html#f68f5b3ba7949aa4" class="i method">AddCommand</a>(<b>new</b> <a href="hostifaces/Command.cs.html#6c075592cf04e686" class="t constructor">Command</a>(<span class="s">&quot;Invoke-Command&quot;</span>)).<a href="hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;ScriptBlock&quot;</span>, <span class="r312 r">sb</span>).<a href="hostifaces/PowerShell.cs.html#ad181c9dec5e4ffa" class="i method">AddParameter</a>(<span class="s">&quot;NoNewScope&quot;</span>);
                            <span class="r313 r">psToInvoke</span>.<a href="hostifaces/PowerShell.cs.html#f68f5b3ba7949aa4" class="i method">AddCommand</a>(<b>new</b> <a href="hostifaces/Command.cs.html#6c075592cf04e686" class="t constructor">Command</a>(<span class="s">&quot;Set-Variable&quot;</span>)).<a href="hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Name&quot;</span>, <span class="r311 r">name</span>);
 
                            <span class="i">Exception</span> <span id="r314 rd" class="r314 r">exceptionToReturn</span> = <a href="#a7f4e0b3669d238a" class="i method">ProcessPowerShellCommand</a>(<span class="r313 r">psToInvoke</span>, <span class="r309 r">initializedRunspace</span>);
                            <b>if</b> (<span class="r314 r">exceptionToReturn</span> != <b>null</b>)
                            {
                                <span class="c">// ThrowOnRunspaceOpenError handling is done by ProcessPowerShellCommand</span>
                                <b>return</b> <span class="r314 r">exceptionToReturn</span>;
                            }
                        }
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <span class="i">Exception</span> <a id="c3f93d7d3ed6a835" href="../R/c3f93d7d3ed6a835.html" target="n" data-glyph="76,1" class="i method">ProcessUserDrive</a>(<a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r315 rd" class="r315 r">initializedRunspace</span>)
        {
            <span class="i">Exception</span> <span id="r316 rd" class="r316 r">ex</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r317 rd" class="r317 r">fileSystemProviders</span> = <span class="r315 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateProviderAPIs.cs.html#12503655514931e1" class="i property">Providers</a>[<span class="s">&quot;FileSystem&quot;</span>];
                <b>if</b> (<span class="r317 r">fileSystemProviders</span>.<span class="i">Count</span> == 0)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">UserDriveCannotGetFileSystemProvider</span>);
                }
 
                <span class="c">// Create the User drive path directory in current user local appdata location:</span>
                <span class="c">// SystemDrive\Users\[user]\AppData\Local\Microsoft\PowerShell\DriveRoots\[UserName]</span>
                <span class="c">// Or for virtual accounts</span>
                <span class="c">// WinDir\System32\Microsoft\PowerShell\DriveRoots\[UserName]</span>
                <b>string</b> <span id="r318 rd" class="r318 r">directoryName</span> = <a href="#2a37d15e5c29f3ea" class="i method">MakeUserNamePath</a>();
                <b>string</b> <span id="r319 rd" class="r319 r">userDrivePath</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#4dfab0cd608f3fa0" class="i field">CacheDirectory</a>, <span class="s">&quot;DriveRoots&quot;</span>, <span class="r318 r">directoryName</span>);
 
                <span class="c">// Create directory if it doesn&#39;t exist.</span>
                <b>if</b> (!<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r319 r">userDrivePath</span>))
                {
                    <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Directory</span>.<span class="i">CreateDirectory</span>(<span class="r319 r">userDrivePath</span>);
                }
 
                <span class="c">// Create the PSDrive.</span>
                <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="k">var</a> <span id="r320 rd" class="r320 r">newDriveInfo</span> = <b>new</b> <span class="t">PSDriveInfo</span>(
                    <span class="s">&quot;User&quot;</span>,
                    <span class="r317 r">fileSystemProviders</span>[0],
                    <span class="r319 r">userDrivePath</span>,
                    <b>null</b>,
                    <b>null</b>);
                <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="k">var</a> <span id="r321 rd" class="r321 r">userDriveInfo</span> = <span class="r315 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="SessionStatePublic.cs.html#49ff6e2d0769f2e2" class="i property">Drive</a>.<a href="DriveInterfaces.cs.html#659ad4bd1da114ed" class="i method">New</a>(<span class="r320 r">newDriveInfo</span>, <b>null</b>);
 
                <span class="c">// Set User drive maximum size.  Default maximum size is 50MB</span>
                <span class="r321 r">userDriveInfo</span>.<a href="DataStoreAdapter.cs.html#6a62fe0912be2006" class="i property">MaximumSize</a> = (<a href="#260c85af5e497081" class="i property">UserDriveMaximumSize</a> &gt; 0) ? <a href="#260c85af5e497081" class="i property">UserDriveMaximumSize</a> : 50000000;
            }
            <b>catch</b> (<span class="i">ArgumentNullException</span> <span id="r322 rd" class="r322 r">e</span>) { <span class="r316 r">ex</span> = <span class="r322 r">e</span>; }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r323 rd" class="r323 r">e</span>) { <span class="r316 r">ex</span> = <span class="r323 r">e</span>; }
            <b>catch</b> (<span class="i">NotSupportedException</span> <span id="r324 rd" class="r324 r">e</span>) { <span class="r316 r">ex</span> = <span class="r324 r">e</span>; }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a> <span id="r325 rd" class="r325 r">e</span>) { <span class="r316 r">ex</span> = <span class="r325 r">e</span>; }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r326 rd" class="r326 r">e</span>) { <span class="r316 r">ex</span> = <span class="r326 r">e</span>; }
            <b>catch</b> (<span class="i">KeyNotFoundException</span> <span id="r327 rd" class="r327 r">e</span>) { <span class="r316 r">ex</span> = <span class="r327 r">e</span>; }
            <b>catch</b> (<span class="i">IOException</span> <span id="r328 rd" class="r328 r">e</span>) { <span class="r316 r">ex</span> = <span class="r328 r">e</span>; }
            <b>catch</b> (<span class="i">UnauthorizedAccessException</span> <span id="r329 rd" class="r329 r">e</span>) { <span class="r316 r">ex</span> = <span class="r329 r">e</span>; }
 
            <b>return</b> <span class="r316 r">ex</span>;
        }
 
        <b>private string</b> <a id="2a37d15e5c29f3ea" href="../R/2a37d15e5c29f3ea.html" target="n" data-glyph="76,1" class="i method">MakeUserNamePath</a>()
        {
            <span class="c">// Use the user name passed to initial session state if available, or</span>
            <span class="c">// otherwise use the current user name.</span>
            <b>var</b> <span id="r330 rd" class="r330 r">userName</span> = !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#d6b8923f60fe362d" class="i property">UserDriveUserName</a>)
                ? <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#d6b8923f60fe362d" class="i property">UserDriveUserName</a>
                <span class="c">// domain\user on Windows, just user on Unix</span>
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">                : Environment.UserName;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                : <span class="i">Environment</span>.<span class="i">UserDomainName</span> + <span class="s">&quot;_&quot;</span> + <span class="i">Environment</span>.<span class="i">UserName</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
            <span class="c">// Ensure that user name contains no invalid path characters.</span>
            <span class="c">// MSDN indicates that logon names cannot contain any of these invalid characters,</span>
            <span class="c">// but this check will ensure safety.</span>
            <b>if</b> (<span class="r330 r">userName</span>.<span class="i">IndexOfAny</span>(<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetInvalidPathChars</span>()) &gt; -1)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidUserDriveName</span>);
            }
 
            <b>return</b> <span class="r330 r">userName</span>;
        }
 
        <b>private</b> <span class="i">Exception</span> <a id="043c8fe540ea6576" href="../R/043c8fe540ea6576.html" target="n" data-glyph="76,1" class="i method">ProcessStartupScripts</a>(<a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r331 rd" class="r331 r">initializedRunspace</span>)
        {
            <b>foreach</b> (<b>string</b> <span id="r332 rd" class="r332 r">startupScript</span> <b>in</b> <a href="#4074645df9605a16" class="i property">StartupScripts</a>)
            {
                <b>using</b> (<a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r333 rd" class="r333 r">psToInvoke</span> = <a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
                {
                    <span class="r333 r">psToInvoke</span>.<a href="hostifaces/PowerShell.cs.html#f68f5b3ba7949aa4" class="i method">AddCommand</a>(<b>new</b> <a href="hostifaces/Command.cs.html#7daa1db0ede574c4" class="t constructor">Command</a>(<span class="r332 r">startupScript</span>, <b>false</b>, <b>false</b>));
 
                    <span class="i">Exception</span> <span id="r334 rd" class="r334 r">exceptionToReturn</span> = <a href="#a7f4e0b3669d238a" class="i method">ProcessPowerShellCommand</a>(<span class="r333 r">psToInvoke</span>, <span class="r331 r">initializedRunspace</span>);
                    <b>if</b> (<span class="r334 r">exceptionToReturn</span> != <b>null</b>)
                    {
                        <span class="c">// ThrowOnRunspaceOpenError handling is done by ProcessPowerShellCommand</span>
                        <b>return</b> <span class="r334 r">exceptionToReturn</span>;
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <span class="i">Exception</span> <a id="a7f4e0b3669d238a" href="../R/a7f4e0b3669d238a.html" target="n" data-glyph="76,1" class="i method">ProcessPowerShellCommand</a>(<a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r335 rd" class="r335 r">psToInvoke</span>, <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r336 rd" class="r336 r">initializedRunspace</span>)
        {
            <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <span id="r337 rd" class="r337 r">originalLanguageMode</span> = <span class="r336 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#c43f0c90447752e8" class="i property">SessionStateProxy</a>.<a href="hostifaces/Connection.cs.html#ccb77bd743e72d6c" class="i property">LanguageMode</a>;
 
            <b>try</b>
            {
                <span class="r336 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#c43f0c90447752e8" class="i property">SessionStateProxy</a>.<a href="hostifaces/Connection.cs.html#ccb77bd743e72d6c" class="i property">LanguageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
 
                <span class="r335 r">psToInvoke</span>.<a href="hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> = <span class="r336 r">initializedRunspace</span>;
 
                <b>foreach</b> (<a href="hostifaces/Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r338 rd" class="r338 r">command</span> <b>in</b> <span class="r335 r">psToInvoke</span>.<a href="hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>)
                {
                    <span class="r338 r">command</span>.<a href="hostifaces/Command.cs.html#73389144dc40bfb1" class="i property">CommandOrigin</a> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
                }
 
                <b>try</b>
                {
                    <span class="r335 r">psToInvoke</span>.<a href="hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r339 rd" class="r339 r">e</span>)
                {
                    <b>if</b> (<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
                    {
                        <b>return</b> <span class="r339 r">e</span>;
                    }
                }
            }
            <b>finally</b>
            {
                <span class="c">// Restore the langauge mode, but not if it was altered by the startup script itself.</span>
                <b>if</b> (<span class="r336 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#c43f0c90447752e8" class="i property">SessionStateProxy</a>.<a href="hostifaces/Connection.cs.html#ccb77bd743e72d6c" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>)
                {
                    <span class="r336 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#c43f0c90447752e8" class="i property">SessionStateProxy</a>.<a href="hostifaces/Connection.cs.html#ccb77bd743e72d6c" class="i property">LanguageMode</a> = <span class="r337 r">originalLanguageMode</span>;
                }
            }
 
            <b>if</b> (<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
            {
                <span class="c">// find out if there are any error records reported. If there is one, report the error..</span>
                <span class="c">// this will result in the runspace getting closed/broken.</span>
                <span class="i">ArrayList</span> <span id="r340 rd" class="r340 r">errorList</span> = (<span class="i">ArrayList</span>)<span class="r336 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#ade98325afa63ad9" class="i property">GetExecutionContext</a>.<a href="ExecutionContext.cs.html#9f5bde284d161965" class="i property">DollarErrorVariable</a>;
                <b>if</b> (<span class="r340 r">errorList</span>.<span class="i">Count</span> &gt; 0)
                {
                    <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r341 rd" class="r341 r">lastErrorRecord</span> = <span class="r340 r">errorList</span>[0] <b>as</b> <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>;
                    <b>if</b> (<span class="r341 r">lastErrorRecord</span> != <b>null</b>)
                    {
                        <b>return</b> <b>new</b> <span class="i">Exception</span>(<span class="r341 r">lastErrorRecord</span>.<a href="ErrorPackage.cs.html#cab659be098926dd" class="i method">ToString</a>());
                    }
                    <b>else</b>
                    {
                        <span class="i">Exception</span> <span id="r342 rd" class="r342 r">lastException</span> = <span class="r340 r">errorList</span>[0] <b>as</b> <span class="i">Exception</span>;
                        <b>if</b> (<span class="r342 r">lastException</span> != <b>null</b>)
                        {
                            <b>return</b> <span class="r342 r">lastException</span>;
                        }
                        <b>else</b>
                        {
                            <b>return</b> <b>new</b> <span class="i">Exception</span>(<span class="r340 r">errorList</span>[0].<span class="i">ToString</span>());
                        }
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <a href="hostifaces/LocalConnection.cs.html#133b866dbfdce22e" class="t t">RunspaceOpenModuleLoadException</a> <a id="c5d1546ecc32084e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessModulesToImport</a>(
            <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r343 rd" class="r343 r">initializedRunspace</span>,
            <span class="i">IEnumerable</span> <span id="r344 rd" class="r344 r">moduleList</span>,
            <b>string</b> <span id="r345 rd" class="r345 r">path</span>,
            <span class="i">HashSet</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt; <span id="r346 rd" class="r346 r">publicCommands</span>,
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r347 rd" class="r347 r">unresolvedCmdsToExpose</span>)
        {
            <a href="hostifaces/LocalConnection.cs.html#133b866dbfdce22e" class="t t">RunspaceOpenModuleLoadException</a> <span id="r348 rd" class="r348 r">exceptionToReturn</span> = <b>null</b>;
 
            <b>foreach</b> (<b>object</b> <span id="r349 rd" class="r349 r">module</span> <b>in</b> <span class="r344 r">moduleList</span>)
            {
                <b>string</b> <span id="r350 rd" class="r350 r">moduleName</span> = <span class="r349 r">module</span> <b>as string</b>;
                <b>if</b> (<span class="r350 r">moduleName</span> != <b>null</b>)
                {
                    <span class="r348 r">exceptionToReturn</span> = <a href="#03f1dffd15fd22f1" class="i method">ProcessOneModule</a>(<span class="r343 r">initializedRunspace</span>, <span class="r350 r">moduleName</span>, <b>null</b>, <span class="r345 r">path</span>, <span class="r346 r">publicCommands</span>);
                }
                <b>else</b>
                {
                    <a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r351 rd" class="r351 r">moduleSpecification</span> = <span class="r349 r">module</span> <b>as</b> <a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>;
                    <b>if</b> (<span class="r351 r">moduleSpecification</span> != <b>null</b>)
                    {
                        <b>if</b> ((<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#ad460cb887264b84" class="i property">RequiredVersion</a> == <b>null</b>) &amp;&amp; (<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#b7b161dc81e4fbe9" class="i property">Version</a> == <b>null</b>) &amp;&amp; (<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a> == <b>null</b>) &amp;&amp; (<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#062a45e81a3542d6" class="i property">Guid</a> == <b>null</b>))
                        {
                            <span class="c">// if only name is specified in the module spec, just try import the module</span>
                            <span class="c">// ie., don&#39;t take the performance overhead of calling GetModule.</span>
                            <span class="r348 r">exceptionToReturn</span> = <a href="#03f1dffd15fd22f1" class="i method">ProcessOneModule</a>(<span class="r343 r">initializedRunspace</span>, <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>, <b>null</b>, <span class="r345 r">path</span>, <span class="r346 r">publicCommands</span>);
                        }
                        <b>else</b>
                        {
                            <span class="i">Collection</span>&lt;<a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt; <span id="r352 rd" class="r352 r">moduleInfos</span> = <a href="Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="Modules/ModuleCmdletBase.cs.html#b9b9dc933360a626" class="i method">GetModuleIfAvailable</a>(<span class="r351 r">moduleSpecification</span>, <span class="r343 r">initializedRunspace</span>);
 
                            <b>if</b> (<span class="r352 r">moduleInfos</span> != <b>null</b> &amp;&amp; <span class="r352 r">moduleInfos</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <span class="r348 r">exceptionToReturn</span> = <span class="i">ProcessOneModule</span>(<span class="r343 r">initializedRunspace</span>, <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>, <span class="r352 r">moduleInfos</span>[0], <span class="r345 r">path</span>, <span class="r346 r">publicCommands</span>);
                            }
                            <b>else</b>
                            {
                                <b>var</b> <span id="r353 rd" class="r353 r">version</span> = <span class="s">&quot;0.0.0.0&quot;</span>;
 
                                <b>if</b> (<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#ad460cb887264b84" class="i property">RequiredVersion</a> != <b>null</b>)
                                {
                                    <span class="r353 r">version</span> = <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#ad460cb887264b84" class="i property">RequiredVersion</a>.<span class="i">ToString</span>();
                                }
                                <b>else</b> <b>if</b> (<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#b7b161dc81e4fbe9" class="i property">Version</a> != <b>null</b>)
                                {
                                    <span class="r353 r">version</span> = <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#b7b161dc81e4fbe9" class="i property">Version</a>.<span class="i">ToString</span>();
                                    <b>if</b> (<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a> != <b>null</b>)
                                    {
                                        <span class="r353 r">version</span> = <span class="r353 r">version</span> + <span class="s">&quot; - &quot;</span> + <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a>;
                                    }
                                }
                                <b>else</b> <b>if</b> (<span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a> != <b>null</b>)
                                {
                                    <span class="r353 r">version</span> = <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a>;
                                }
 
                                <b>string</b> <span id="r354 rd" class="r354 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(
                                    <b>global</b>::<span class="i">Modules</span>.<span class="i">RequiredModuleNotFoundWrongGuidVersion</span>,
                                    <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>,
                                    <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#062a45e81a3542d6" class="i property">Guid</a>,
                                    <span class="r353 r">version</span>);
                                <a href="hostifaces/LocalConnection.cs.html#133b866dbfdce22e" class="t t">RunspaceOpenModuleLoadException</a> <span id="r355 rd" class="r355 r">rome</span> = <b>new</b> <a href="hostifaces/LocalConnection.cs.html#585243cd63f8d78c" class="t constructor">RunspaceOpenModuleLoadException</a>(<span class="r354 r">message</span>);
                                <span class="r348 r">exceptionToReturn</span> = <a href="#02a81a29be06edda" class="i method">ValidateAndReturnRunspaceOpenModuleLoadException</a>(<b>null</b>, <span class="r351 r">moduleSpecification</span>.<a href="Modules/ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>, <span class="r355 r">rome</span>);
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Debug</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;ProcessImportModule can import a module using name or module specification.&quot;</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r348 r">exceptionToReturn</span> == <b>null</b>)
            {
                <span class="c">// Now go through the list of commands not yet resolved to ensure they are public if requested</span>
                <b>foreach</b> (<b>string</b> <span id="r356 rd" class="r356 r">unresolvedCommand</span> <b>in</b> <span class="r347 r">unresolvedCmdsToExpose</span>.<span class="i">ToArray</span>&lt;<b>string</b>&gt;())
                {
                    <b>string</b> <span id="r357 rd" class="r357 r">moduleName</span>;
                    <b>string</b> <span id="r358 rd" class="r358 r">commandToMakeVisible</span> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#65b18cb655761e08" class="i method">ParseCommandName</a>(<span class="r356 r">unresolvedCommand</span>, <b>out</b> <span class="r357 r">moduleName</span>);
                    <b>bool</b> <span id="r359 rd" class="r359 r">found</span> = <b>false</b>;
 
                    <b>foreach</b> (<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r360 rd" class="r360 r">cmd</span> <b>in</b> <a href="#229a0a354ce13eab" class="i method">LookupCommands</a>(<span class="r358 r">commandToMakeVisible</span>, <span class="r357 r">moduleName</span>, <span class="r343 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>))
                    {
                        <b>if</b> (!<span class="r359 r">found</span>)
                        {
                            <span class="r359 r">found</span> = <b>true</b>;
                        }
 
                        <b>try</b>
                        {
                            <span class="c">// Special case for wild card lookups.</span>
                            <span class="c">// &quot;Import-Module&quot; or &quot;ipmo&quot; cannot be visible when exposing commands via VisibleCmdlets, etc.</span>
                            <b>if</b> ((<span class="r360 r">cmd</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Import-Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                                 (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r360 r">cmd</span>.<a href="CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>) &amp;&amp; <span class="r360 r">cmd</span>.<a href="CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>.<span class="i">Equals</span>(<span class="s">&quot;Microsoft.PowerShell.Core&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))) ||
                                 <span class="r360 r">cmd</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;ipmo&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                                )
                            {
                                <span class="r360 r">cmd</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>;
                            }
                            <b>else</b>
                            {
                                <span class="r360 r">cmd</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> = <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>;
                                <span class="r346 r">publicCommands</span>.<span class="i">Add</span>(<span class="r360 r">cmd</span>);
                            }
                        }
                        <b>catch</b> (<a href="../utils/MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a>)
                        {
                            <span class="c">// Some CommandInfo derivations throw on the Visibility setter.</span>
                        }
                    }
 
                    <b>if</b> (<span class="r359 r">found</span> &amp;&amp; !<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r358 r">commandToMakeVisible</span>))
                    {
                        <span class="r347 r">unresolvedCmdsToExpose</span>.<span class="i">Remove</span>(<span class="r356 r">unresolvedCommand</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r348 r">exceptionToReturn</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method to search for commands matching the provided commandPattern.</span>
        <span class="c">///</span><span class="c"> Supports wild cards and if the commandPattern contains wildcard characters then multiple</span>
        <span class="c">///</span><span class="c"> results can be returned.  Otherwise a single (and first) match will be returned.</span>
        <span class="c">///</span><span class="c"> If a moduleName is provided then only commands associated with that module will be returned.</span>
        <span class="c">///</span><span class="c"> Only public commands are searched to start with.  If no results are found then a search on</span>
        <span class="c">///</span><span class="c"> internal commands is performed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r361 r">commandPattern</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r362 r">moduleName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r363 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt; <a id="229a0a354ce13eab" href="../R/229a0a354ce13eab.html" target="n" data-glyph="76,1" class="i method">LookupCommands</a>(
            <b>string</b> <span id="r361 rd" class="r361 r">commandPattern</span>,
            <b>string</b> <span id="r362 rd" class="r362 r">moduleName</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r363 rd" class="r363 r">context</span>)
        {
            <b>bool</b> <span id="r364 rd" class="r364 r">isWildCardPattern</span> = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r361 r">commandPattern</span>);
            <b>var</b> <span id="r365 rd" class="r365 r">searchOptions</span> = <span class="r364 r">isWildCardPattern</span> ?
                <a href="CommandSearcher.cs.html#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="CommandSearcher.cs.html#038d9150e27f9fdf" class="i field">CommandNameIsPattern</a> | <a href="CommandSearcher.cs.html#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="CommandSearcher.cs.html#315f95f2041e0da1" class="i field">ResolveFunctionPatterns</a> | <a href="CommandSearcher.cs.html#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="CommandSearcher.cs.html#dcf3e09a7e1c6cc7" class="i field">SearchAllScopes</a> :
                <a href="CommandSearcher.cs.html#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="CommandSearcher.cs.html#315f95f2041e0da1" class="i field">ResolveFunctionPatterns</a> | <a href="CommandSearcher.cs.html#a5748603008affdc" class="t t">SearchResolutionOptions</a>.<a href="CommandSearcher.cs.html#dcf3e09a7e1c6cc7" class="i field">SearchAllScopes</a>;
 
            <b>bool</b> <span id="r366 rd" class="r366 r">found</span> = <b>false</b>;
            <b>bool</b> <span id="r367 rd" class="r367 r">haveModuleName</span> = !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r362 r">moduleName</span>);
 
            <span class="c">// Start with public search</span>
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r368 rd" class="r368 r">cmdOrigin</span> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#66a89eb31c003ba5" class="i field">Runspace</a>;
            <b>while</b> (<b>true</b>)
            {
                <b>foreach</b> (<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r369 rd" class="r369 r">commandInfo</span> <b>in</b> <span class="r363 r">context</span>.<a href="ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="SessionStatePublic.cs.html#236f6ceba41f8f3e" class="i property">InvokeCommand</a>.<span class="i">GetCommands</span>(<span class="r361 r">commandPattern</span>, <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#d7f466cfbbd45cdb" class="i field">All</a>, <span class="r365 r">searchOptions</span>, <span class="r368 r">cmdOrigin</span>))
                {
                    <span class="c">// If module name is provided then use it to restrict returned results.</span>
                    <b>if</b> (<span class="r367 r">haveModuleName</span> &amp;&amp; !<span class="r362 r">moduleName</span>.<span class="i">Equals</span>(<span class="r369 r">commandInfo</span>.<a href="CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <b>if</b> (!<span class="r366 r">found</span>)
                    {
                        <span class="r366 r">found</span> = <b>true</b>;
                    }
 
                    <b>yield</b> <b>return</b> <span class="r369 r">commandInfo</span>;
 
                    <span class="c">// Return first match unless a wild card pattern is submitted.</span>
                    <b>if</b> (!<span class="r364 r">isWildCardPattern</span>)
                    {
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r366 r">found</span> || (<span class="r368 r">cmdOrigin</span> == <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>))
                {
                    <b>break</b>;
                }
 
                <span class="c">// Next try internal search.</span>
                <span class="r368 r">cmdOrigin</span> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r370 r">moduleInfoToLoad</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null, import module using </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r371 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">. Otherwise,</span>
        <span class="c">///</span><span class="c"> import module using </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r370 r">moduleInfoToLoad</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="hostifaces/LocalConnection.cs.html#133b866dbfdce22e" class="t t">RunspaceOpenModuleLoadException</a> <a id="03f1dffd15fd22f1" href="../R/03f1dffd15fd22f1.html" target="n" data-glyph="76,1" class="i method">ProcessOneModule</a>(<a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r372 rd" class="r372 r">initializedRunspace</span>, <b>string</b> <span id="r371 rd" class="r371 r">name</span>, <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r370 rd" class="r370 r">moduleInfoToLoad</span>, <b>string</b> <span id="r373 rd" class="r373 r">path</span>, <span class="i">HashSet</span>&lt;<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>&gt; <span id="r374 rd" class="r374 r">publicCommands</span>)
        {
            <b>using</b> (<a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r375 rd" class="r375 r">pse</span> = <a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
            {
                <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r376 rd" class="r376 r">c</span> = <b>new</b> <span class="t">CmdletInfo</span>(<span class="s">&quot;Import-Module&quot;</span>, <b>typeof</b>(<a href="Modules/ImportModuleCommand.cs.html#4a6e75cbbfb65b34" class="t t">ImportModuleCommand</a>), <b>null</b>, <b>null</b>, <span class="r372 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>);
                <a href="hostifaces/Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r377 rd" class="r377 r">cmd</span> = <b>new</b> <a href="hostifaces/Command.cs.html#7afd6fbc88a9b688" class="t constructor">Command</a>(<span class="r376 r">c</span>);
                <b>if</b> (<span class="r370 r">moduleInfoToLoad</span> != <b>null</b>)
                {
                    <span class="r377 r">cmd</span>.<a href="hostifaces/Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="hostifaces/Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<span class="s">&quot;ModuleInfo&quot;</span>, <span class="r370 r">moduleInfoToLoad</span>);
                    <span class="r371 r">name</span> = <span class="r370 r">moduleInfoToLoad</span>.<a href="Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>;
                }
                <b>else</b>
                {
                    <span class="c">// If FullyQualifiedPath is supplied then use it.</span>
                    <span class="c">// In this scenario, the FullyQualifiedPath would</span>
                    <span class="c">// refer to $pshome\Modules location where core</span>
                    <span class="c">// modules are deployed.</span>
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r373 r">path</span>))
                    {
                        <span class="r371 r">name</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r373 r">path</span>, <span class="r371 r">name</span>);
                    }
 
                    <span class="r377 r">cmd</span>.<a href="hostifaces/Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="hostifaces/Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<span class="s">&quot;Name&quot;</span>, <span class="r371 r">name</span>);
                }
 
                <b>if</b> (!<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
                {
                    <span class="r377 r">cmd</span>.<a href="hostifaces/Command.cs.html#1d4f6e54a09e8991" class="i method">MergeMyResults</a>(<a href="hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="hostifaces/Command.cs.html#4934ee6f6f8db020" class="i field">Error</a>, <a href="hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="hostifaces/Command.cs.html#c8d2233323d43e84" class="i field">Output</a>);
                }
 
                <span class="r375 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#f68f5b3ba7949aa4" class="i method">AddCommand</a>(<span class="r377 r">cmd</span>);
 
                <b>if</b> (!<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
                {
                    <span class="r376 r">c</span> = <b>new</b> <span class="t">CmdletInfo</span>(<span class="s">&quot;Out-Default&quot;</span>, <b>typeof</b>(<a href="../FormatAndOutput/out-console/OutConsole.cs.html#c9bb0040912f3314" class="t t">OutDefaultCommand</a>), <b>null</b>, <b>null</b>, <span class="r372 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>);
                    <span class="r375 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#f68f5b3ba7949aa4" class="i method">AddCommand</a>(<b>new</b> <a href="hostifaces/Command.cs.html#7afd6fbc88a9b688" class="t constructor">Command</a>(<span class="r376 r">c</span>));
                }
 
                <span class="r375 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> = <span class="r372 r">initializedRunspace</span>;
                <span class="c">// Module import should be run in FullLanguage mode since it is running in</span>
                <span class="c">// a trusted context.</span>
                <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="k">var</a> <span id="r378 rd" class="r378 r">savedLanguageMode</span> = <span class="r375 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a>;
                <span class="r375 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
                <b>try</b>
                {
                    <span class="r375 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
                }
                <b>finally</b>
                {
                    <span class="r375 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> = <span class="r378 r">savedLanguageMode</span>;
                }
 
                <span class="c">// Lock down the command visibility to respect default command visibility</span>
                <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a> != <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>)
                {
                    <b>foreach</b> (<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r379 rd" class="r379 r">importedCommand</span> <b>in</b> <span class="r372 r">initializedRunspace</span>.<a href="hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="SessionStatePublic.cs.html#236f6ceba41f8f3e" class="i property">InvokeCommand</a>.<span class="i">GetCommands</span>(
                        <span class="i">name</span>: <span class="s">&quot;*&quot;</span>,
                        <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#7837d2f5f0343c5e" class="i field">Filter</a> | <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>,
                        <b>true</b>))
                    {
                        <b>try</b>
                        {
                            <span class="c">// All commands except for the initial session public commands should be made private.</span>
                            <b>if</b> ((<span class="r379 r">importedCommand</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> != <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a>) &amp;&amp;
                                !<span class="r374 r">publicCommands</span>.<span class="i">Contains</span>(<span class="r379 r">importedCommand</span>))
                            {
                                <span class="r379 r">importedCommand</span>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a>;
                            }
                        }
                        <b>catch</b> (<a href="../utils/MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a>)
                        {
                            <span class="c">// Some CommandInfo derivations throw on the Visibility setter.</span>
                        }
                    }
                }
 
                <span class="c">// Now see if there were any errors. Because the only way we have to</span>
                <span class="c">// return an error at this point is a single exception, we&#39;ll take the first</span>
                <span class="c">// error and throw it...</span>
                <b>return</b> <a href="#02a81a29be06edda" class="i method">ValidateAndReturnRunspaceOpenModuleLoadException</a>(<span class="r375 r">pse</span>, <span class="r371 r">name</span>, <b>null</b>);
            }
        }
 
        <b>private</b> <a href="hostifaces/LocalConnection.cs.html#133b866dbfdce22e" class="t t">RunspaceOpenModuleLoadException</a> <a id="02a81a29be06edda" href="../R/02a81a29be06edda.html" target="n" data-glyph="76,1" class="i method">ValidateAndReturnRunspaceOpenModuleLoadException</a>(<a href="hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r380 rd" class="r380 r">pse</span>, <b>string</b> <span id="r381 rd" class="r381 r">moduleName</span>, <a href="hostifaces/LocalConnection.cs.html#133b866dbfdce22e" class="t t">RunspaceOpenModuleLoadException</a> <span id="r382 rd" class="r382 r">exception</span>)
        {
            <span class="c">// Only throw the exception if ThrowOnRunspaceOpenError is set.</span>
            <b>if</b> (<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
            {
                <a href="hostifaces/LocalConnection.cs.html#133b866dbfdce22e" class="t t">RunspaceOpenModuleLoadException</a> <span id="r383 rd" class="r383 r">rome</span> = <b>null</b>;
                <b>if</b> (<span class="r382 r">exception</span> != <b>null</b>)
                {
                    <span class="r383 r">rome</span> = <span class="r382 r">exception</span>;
                }
                <b>else</b> <b>if</b> (<span class="r380 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="hostifaces/PowerShell.cs.html#ae04a604c26c6f7d" class="i property">Error</a>.<a href="hostifaces/PSDataCollection.cs.html#e7cb43bbebbb4aca" class="i property">Count</a> &gt; 0)
                {
                    <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r384 rd" class="r384 r">er</span>;
                    <span class="i">Exception</span> <span id="r385 rd" class="r385 r">firstError</span>;
                    <span class="c">// Merge errors from pse.Streams and errors</span>
                    <a href="hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r386 rd" class="r386 r">mergedErrors</span> = <b>new</b> <a href="hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
                    <span class="r384 r">er</span> = <span class="r380 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="hostifaces/PowerShell.cs.html#ae04a604c26c6f7d" class="i property">Error</a>[0];
                    <span class="r385 r">firstError</span> = <span class="r384 r">er</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>;
                    <b>foreach</b> (<b>var</b> <span id="r387 rd" class="r387 r">e</span> <b>in</b> <span class="r380 r">pse</span>.<a href="hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="hostifaces/PowerShell.cs.html#ae04a604c26c6f7d" class="i property">Error</a>)
                    {
                        <span class="r386 r">mergedErrors</span>.<span class="i">Add</span>(<span class="r387 r">e</span>);
                    }
 
                    <span class="r383 r">rome</span> = <b>new</b> <a href="hostifaces/LocalConnection.cs.html#313d9cae77838ee0" class="t constructor">RunspaceOpenModuleLoadException</a>(<span class="r381 r">moduleName</span>, <span class="r386 r">mergedErrors</span>);
                }
 
                <b>if</b> (<span class="r383 r">rome</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r383 r">rome</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reinitializes elements of the associated runspace to their initial values.</span>
        <span class="c">///</span><span class="c"> This allows for runspace reuse with minimal chance for contamination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r388 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b6f400e7fe271e69" href="../R/b6f400e7fe271e69.html" target="n" data-glyph="74,1" class="i method">ResetRunspaceState</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r388 rd" class="r388 r">context</span>)
        {
            <b>lock</b> (<a href="#079ee4a0c5c6339e" class="i field">_syncObject</a>)
            {
                <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r389 rd" class="r389 r">ss</span> = <span class="r388 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
 
                <span class="c">// Reset the global variable table</span>
                <span class="r389 r">ss</span>.<a href="SessionState.cs.html#22ae9da371b8c065" class="i method">InitializeSessionStateInternalSpecialVariables</a>(<b>true</b>);
 
                <span class="c">// Add the built-in variables</span>
                <b>foreach</b> (<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a> <span id="r390 rd" class="r390 r">e</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="#522fcdaff0993921" class="i field">BuiltInVariables</a>)
                {
                    <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r391 rd" class="r391 r">v</span> = <b>new</b> <a href="ShellVariable.cs.html#625143e6f8b57a29" class="t constructor">PSVariable</a>(
                        <span class="r390 r">e</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>,
                        <span class="r390 r">e</span>.<a href="#aba39087490e68e6" class="i property">Value</a>,
                        <span class="r390 r">e</span>.<a href="#c9c5e0f45aad68f8" class="i property">Options</a>, <span class="r390 r">e</span>.<a href="#fe528c10a1448fbb" class="i property">Attributes</a>,
                        <span class="r390 r">e</span>.<a href="#224f1cd8e7066c04" class="i property">Description</a>)
                    { <a href="ShellVariable.cs.html#4e70252485bbcc8b" class="i property">Visibility</a> = <span class="r390 r">e</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a> };
                    <span class="r389 r">ss</span>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r390 r">e</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="r391 r">v</span>, <b>false</b>, <b>true</b>, <span class="r389 r">ss</span>, <span class="r392 r">fastPath</span>: <b>true</b>);
                }
 
                <span class="r389 r">ss</span>.<a href="SessionState.cs.html#34f35d9e375204aa" class="i method">InitializeFixedVariables</a>();
 
                <span class="c">// Then re-initialize it with variables to session state...</span>
                <b>foreach</b> (<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a> <span id="r393 rd" class="r393 r">e</span> <b>in</b> <a href="#fb98d8254252d236" class="i property">Variables</a>)
                {
                    <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r394 rd" class="r394 r">v</span> = <b>new</b> <a href="ShellVariable.cs.html#625143e6f8b57a29" class="t constructor">PSVariable</a>(
                        <span class="r393 r">e</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>,
                        <span class="r393 r">e</span>.<a href="#aba39087490e68e6" class="i property">Value</a>,
                        <span class="r393 r">e</span>.<a href="#c9c5e0f45aad68f8" class="i property">Options</a>,
                        <span class="r393 r">e</span>.<a href="#fe528c10a1448fbb" class="i property">Attributes</a>,
                        <span class="r393 r">e</span>.<a href="#224f1cd8e7066c04" class="i property">Description</a>)
                    { <a href="ShellVariable.cs.html#4e70252485bbcc8b" class="i property">Visibility</a> = <span class="r393 r">e</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a> };
                    <span class="r389 r">ss</span>.<a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#82151a5a9031dac4" class="i method">SetVariable</a>(<span class="r393 r">e</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="r394 r">v</span>, <b>false</b>, <b>true</b>, <span class="r389 r">ss</span>, <span class="r392 r">fastPath</span>: <b>true</b>);
                }
 
                <a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="#904ebe339bf5f1c9" class="i method">CreateQuestionVariable</a>(<span class="r388 r">context</span>);
 
                <span class="c">// Reset the path for this runspace.</span>
                <a href="#b0eed19828ed022d" class="i method">SetSessionStateDrive</a>(<span class="r388 r">context</span>, <b>true</b>);
 
                <span class="c">// Reset the event, transaction and debug managers.</span>
                <span class="r388 r">context</span>.<a href="ExecutionContext.cs.html#e2918cff2882c87b" class="i method">ResetManagers</a>();
 
                <span class="c">// Reset tracing/debugging to the off state.</span>
                <span class="r388 r">context</span>.<a href="ExecutionContext.cs.html#0b681c156010f201" class="i property">PSDebugTraceLevel</a> = 0;
                <span class="r388 r">context</span>.<a href="ExecutionContext.cs.html#0ee8614c19edc283" class="i property">PSDebugTraceStep</a> = <b>false</b>;
            }
        }
 
        <b>internal static void</b> <a id="b0eed19828ed022d" href="../R/b0eed19828ed022d.html" target="n" data-glyph="74,1" class="i method">SetSessionStateDrive</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r395 rd" class="r395 r">context</span>, <b>bool</b> <span id="r227 rd" class="r227 r">setLocation</span>)
        {
            <span class="c">// Set the starting location to the current process working directory</span>
            <span class="c">// Ignore any errors as the file system provider may not be loaded or</span>
            <span class="c">// a drive with the same name as the real file system drive may not have</span>
            <span class="c">// been mounted.</span>
            <b>try</b>
            {
                <b>bool</b> <span id="r396 rd" class="r396 r">proceedWithSetLocation</span> = <b>true</b>;
 
                <b>if</b> (<span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateProviderAPIs.cs.html#6dd27d6ba191948d" class="i property">ProviderCount</a> &gt; 0)
                {
                    <span class="c">// NTRAID#Windows Out Of Band Releases-908481-2005/07/01-JeffJon</span>
                    <span class="c">// Make sure we have a CurrentDrive set so that we can deal with</span>
                    <span class="c">// UNC paths</span>
 
                    <b>if</b> (<span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a> == <b>null</b>)
                    {
                        <b>bool</b> <span id="r397 rd" class="r397 r">fsDriveSet</span> = <b>false</b>;
                        <b>try</b>
                        {
                            <span class="c">// Set the current drive to the first FileSystem drive if it exists.</span>
                            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r398 rd" class="r398 r">fsProvider</span> = <span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateProviderAPIs.cs.html#02cfdb64abb0b450" class="i method">GetSingleProvider</a>(<span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>);
 
                            <span class="i">Collection</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <span id="r399 rd" class="r399 r">fsDrives</span> = <span class="r398 r">fsProvider</span>.<a href="DataStoreAdapterProvider.cs.html#162e003b03796a90" class="i property">Drives</a>;
                            <b>if</b> (<span class="r399 r">fsDrives</span> != <b>null</b> &amp;&amp; <span class="r399 r">fsDrives</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a> = <span class="r399 r">fsDrives</span>[0];
                                <span class="r397 r">fsDriveSet</span> = <b>true</b>;
                            }
                        }
                        <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a>)
                        {
                        }
 
                        <b>if</b> (!<span class="r397 r">fsDriveSet</span>)
                        {
                            <span class="i">Collection</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <span id="r400 rd" class="r400 r">allDrives</span> = <span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateDriveAPIs.cs.html#033714dcbf40ff39" class="i method">Drives</a>(<b>null</b>);
 
                            <b>if</b> (<span class="r400 r">allDrives</span> != <b>null</b> &amp;&amp; <span class="r400 r">allDrives</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a> = <span class="r400 r">allDrives</span>[0];
                            }
                            <b>else</b>
                            {
                                <a href="../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a> <span id="r401 rd" class="r401 r">itemNotFound</span> =
                                    <b>new</b> <span class="t">ItemNotFoundException</span>(<span class="i">Directory</span>.<span class="i">GetCurrentDirectory</span>(), <span class="s">&quot;PathNotFound&quot;</span>, <span class="i">SessionStateStrings</span>.<span class="i">PathNotFound</span>);
 
                                <span class="r395 r">context</span>.<span class="i">ReportEngineStartupError</span>(<span class="r401 r">itemNotFound</span>);
                                <span class="r396 r">proceedWithSetLocation</span> = <b>false</b>;
                            }
                        }
                    }
 
                    <b>if</b> (<span class="r396 r">proceedWithSetLocation</span> &amp;&amp; <span class="r227 r">setLocation</span>)
                    {
                        <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r402 rd" class="r402 r">providerContext</span> = <b>new</b> <a href="../namespaces/CoreCommandContext.cs.html#8a0e078b40b2fd0e" class="t constructor">CmdletProviderContext</a>(<span class="r395 r">context</span>);
 
                        <b>try</b>
                        {
                            <span class="r402 r">providerContext</span>.<a href="../namespaces/CoreCommandContext.cs.html#b9edf955d3776935" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                            <span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">SetLocation</span>(<span class="i">Directory</span>.<span class="i">GetCurrentDirectory</span>(), <span class="r402 r">providerContext</span>);
                        }
                        <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a>)
                        {
                            <span class="c">// If we can&#39;t access the Environment.CurrentDirectory, we may be in an AppContainer. Set the</span>
                            <span class="c">// default drive to $pshome</span>
                            <b>string</b> <span id="r403 rd" class="r403 r">defaultPath</span> = <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="i">Environment</span>.<span class="i">ProcessPath</span>);
                            <span class="r395 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateLocationAPIs.cs.html#86a28d48a13c204c" class="i method">SetLocation</a>(<span class="r403 r">defaultPath</span>, <span class="r402 r">providerContext</span>);
                        }
                    }
                }
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
            }
        }
 
        <b>internal static void</b> <a id="904ebe339bf5f1c9" href="../R/904ebe339bf5f1c9.html" target="n" data-glyph="74,1" class="i method">CreateQuestionVariable</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r404 rd" class="r404 r">context</span>)
        {
            <a href="QuestionMarkVariable.cs.html#385993133a55aecc" class="t t">QuestionMarkVariable</a> <span id="r405 rd" class="r405 r">qv</span> = <b>new</b> <a href="QuestionMarkVariable.cs.html#994eabaaf999d508" class="t constructor">QuestionMarkVariable</a>(<span class="r404 r">context</span>);
            <span class="r404 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#c51929c50489420f" class="i method">SetVariableAtScope</a>(<span class="r405 r">qv</span>, <span class="s">&quot;global&quot;</span>, <b>true</b>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove anything that would have been bound by this ISS instance.</span>
        <span class="c">///</span><span class="c"> At this point, it removes assemblies and cmdlet entries at the top level.</span>
        <span class="c">///</span><span class="c"> It also removes types and formats.</span>
        <span class="c">///</span><span class="c"> The other entry types - functions, variables, aliases</span>
        <span class="c">///</span><span class="c"> are not removed by this function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r406 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="68d7b8f622c9537d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Unbind</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r406 rd" class="r406 r">context</span>)
        {
            <b>lock</b> (<a href="#079ee4a0c5c6339e" class="i field">_syncObject</a>)
            {
                <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r407 rd" class="r407 r">ss</span> = <span class="r406 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
 
                <span class="c">// Remove the assemblies from the assembly cache...</span>
                <b>foreach</b> (<a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a> <span id="r408 rd" class="r408 r">ssae</span> <b>in</b> <a href="#501914944d122594" class="i property">Assemblies</a>)
                {
                    <span class="r406 r">context</span>.<a href="ExecutionContext.cs.html#d4be0d947e406cfb" class="i method">RemoveAssembly</a>(<span class="r408 r">ssae</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>);
                }
 
                <span class="c">// Remove all of the commands from the top-level session state.</span>
                <b>foreach</b> (<a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a> <span id="r409 rd" class="r409 r">cmd</span> <b>in</b> <a href="#2d45d0b0db0079ba" class="i property">Commands</a>)
                {
                    <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r410 rd" class="r410 r">ssce</span> = <span class="r409 r">cmd</span> <b>as</b> <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>;
                    <b>if</b> (<span class="r410 r">ssce</span> != <b>null</b>)
                    {
                        <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt; <span id="r411 rd" class="r411 r">matches</span>;
                        <b>if</b> (<span class="r406 r">context</span>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>.<a href="SessionStateCmdletAPIs.cs.html#45b521c66dc38967" class="i method">GetCmdletTable</a>().<span class="i">TryGetValue</span>(<span class="r410 r">ssce</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <b>out</b> <span class="r411 r">matches</span>))
                        {
                            <span class="c">// Remove the name from the list...</span>
                            <b>for</b> (<b>int</b> <span id="r412 rd" class="r412 r">i</span> = <span class="r411 r">matches</span>.<span class="i">Count</span> - 1; <span class="r412 r">i</span> &gt;= 0; <span class="r412 r">i</span>--)
                            {
                                <b>if</b> (<span class="r411 r">matches</span>[<span class="r412 r">i</span>].<span class="i">ModuleName</span>.<span class="i">Equals</span>(<span class="r409 r">cmd</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>))
                                {
                                    <b>string</b> <span id="r413 rd" class="r413 r">name</span> = <span class="r411 r">matches</span>[<span class="r412 r">i</span>].<span class="i">Name</span>;
                                    <span class="r411 r">matches</span>.<span class="i">RemoveAt</span>(<span class="r412 r">i</span>);
                                    <span class="r406 r">context</span>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>.<a href="SessionStateCmdletAPIs.cs.html#55d771022d76852e" class="i method">RemoveCmdlet</a>(<span class="r413 r">name</span>, <span class="r412 r">i</span>,  <span class="c">/*force*/</span> <b>true</b>);
                                }
                            }
                            <span class="c">// And remove the entry if the list is now empty...</span>
                            <b>if</b> (<span class="r411 r">matches</span>.<span class="i">Count</span> == 0)
                            {
                                <span class="r406 r">context</span>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>.<a href="SessionStateCmdletAPIs.cs.html#38fb0ca0069d7f30" class="i method">RemoveCmdletEntry</a>(<span class="r410 r">ssce</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <b>true</b>);
                            }
                        }
 
                        <b>continue</b>;
                    }
                }
 
                <span class="c">// Remove all of the providers from the top-level provider table.</span>
                <b>if</b> (<a href="#e7bd6966e16e4f5b" class="i field">_providers</a> != <b>null</b> &amp;&amp; <a href="#e7bd6966e16e4f5b" class="i field">_providers</a>.<a href="#c6493cb5fe089abd" class="i property">Count</a> &gt; 0)
                {
                    <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;&gt; <span id="r414 rd" class="r414 r">providerTable</span> = <span class="r406 r">context</span>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>.<a href="SessionStateProviderAPIs.cs.html#12503655514931e1" class="i property">Providers</a>;
 
                    <b>foreach</b> (<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r415 rd" class="r415 r">sspe</span> <b>in</b> <a href="#e7bd6966e16e4f5b" class="i field">_providers</a>)
                    {
                        <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r416 rd" class="r416 r">pl</span>;
                        <b>if</b> (<span class="r414 r">providerTable</span>.<span class="i">TryGetValue</span>(<span class="r415 r">sspe</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <b>out</b> <span class="r416 r">pl</span>))
                        {
                            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r416 r">pl</span> != <b>null</b>, <span class="s">&quot;There should never be a null list of entries in the provider table&quot;</span>);
                            <span class="c">// For each provider with the same name...</span>
                            <b>for</b> (<b>int</b> <span id="r417 rd" class="r417 r">i</span> = <span class="r416 r">pl</span>.<span class="i">Count</span> - 1; <span class="r417 r">i</span> &gt;= 0; <span class="r417 r">i</span>--)
                            {
                                <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r418 rd" class="r418 r">pi</span> = <span class="r416 r">pl</span>[<span class="r417 r">i</span>];
 
                                <span class="c">// If it was implemented by this entry, remove it</span>
                                <b>if</b> (<span class="r418 r">pi</span>.<a href="DataStoreAdapterProvider.cs.html#3801e8e136516894" class="i property">ImplementingType</a> == <span class="r415 r">sspe</span>.<a href="#bcdd2ec5da2607ba" class="i property">ImplementingType</a>)
                                {
                                    <a href="#15f40fcb70b722f7" class="i method">RemoveAllDrivesForProvider</a>(<span class="r418 r">pi</span>, <span class="r406 r">context</span>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>);
                                    <span class="r416 r">pl</span>.<span class="i">RemoveAt</span>(<span class="r417 r">i</span>);
                                }
                            }
 
                            <span class="c">// If there are no providers left with this name, remove the key.</span>
                            <b>if</b> (<span class="r416 r">pl</span>.<span class="i">Count</span> == 0)
                            {
                                <span class="r414 r">providerTable</span>.<span class="i">Remove</span>(<span class="r415 r">sspe</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>);
                            }
                        }
                    }
                }
 
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r419 rd" class="r419 r">formatFilesToRemove</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4e7657f066102cad" class="i property">Formats</a> != <b>null</b>)
                {
                    <span class="r419 r">formatFilesToRemove</span>.<span class="i">AddRange</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<span class="i">Select</span>(<b>static</b> <span id="r420 rd" class="r420 r">f</span> =&gt; <span class="r420 r">f</span>.<span class="i">FileName</span>));
                }
 
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r421 rd" class="r421 r">typeFilesToRemove</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a> != <b>null</b>)
                {
                    <span class="r421 r">typeFilesToRemove</span>.<span class="i">AddRange</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<span class="i">Select</span>(<b>static</b> <span id="r422 rd" class="r422 r">t</span> =&gt; <span class="r422 r">t</span>.<span class="i">FileName</span>));
                }
 
                <span class="i">RemoveTypesAndFormats</span>(<span class="r406 r">context</span>, <span class="r419 r">formatFilesToRemove</span>, <span class="r421 r">typeFilesToRemove</span>);
            }
        }
 
        <b>internal static void</b> <a id="52014912aaa46fe0" href="../R/52014912aaa46fe0.html" target="n" data-glyph="74,1" class="i method">RemoveTypesAndFormats</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r423 rd" class="r423 r">context</span>, <span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r424 rd" class="r424 r">formatFilesToRemove</span>, <span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r425 rd" class="r425 r">typeFilesToRemove</span>)
        {
            <span class="c">// The formats and types tables are implemented in such a way that</span>
            <span class="c">// we can&#39;t simply remove an entry. We need to edit the list, clear the</span>
            <span class="c">// exiting composed table and then rebuild the entire table.</span>
            <b>if</b> (<span class="r424 r">formatFilesToRemove</span> != <b>null</b> &amp;&amp; <span class="r424 r">formatFilesToRemove</span>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#d3dc56d6666ca9c3" class="k">var</a> <span id="r426 rd" class="r426 r">newFormats</span> = <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a>&gt;();
                <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r427 rd" class="r427 r">formatFilesToRemoveSet</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="r424 r">formatFilesToRemove</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>foreach</b> (<a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a> <span id="r428 rd" class="r428 r">entry</span> <b>in</b> <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>)
                {
                    <b>if</b> (!<span class="r427 r">formatFilesToRemoveSet</span>.<span class="i">Contains</span>(<span class="r428 r">entry</span>.<a href="#f6108e84d6fcb004" class="i property">FileName</a>))
                    {
                        <span class="r426 r">newFormats</span>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r428 r">entry</span>);
                    }
                }
 
                <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<a href="#9c6f481e94fc74d5" class="i method">Clear</a>();
                <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<span class="i">Add</span>(<span class="r426 r">newFormats</span>);
                <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#6a9371cd77e6c41f" class="i method">UpdateFormats</a>(<span class="r423 r">context</span>, <b>false</b>);
            }
 
            <b>if</b> (<span class="r425 r">typeFilesToRemove</span> != <b>null</b> &amp;&amp; <span class="r425 r">typeFilesToRemove</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// The types table has the same issue as the format table - we need to rebuild the entire table.</span>
                <a href="#d3dc56d6666ca9c3" class="k">var</a> <span id="r429 rd" class="r429 r">newTypes</span> = <b>new</b> <a href="#e636b417165a85b5" class="t constructor">InitialSessionStateEntryCollection</a>&lt;<a href="#02c5fb84a39526f6" class="t t">SessionStateTypeEntry</a>&gt;();
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r430 rd" class="r430 r">resolvedTypeFilesToRemove</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>foreach</b> (<b>var</b> <span id="r431 rd" class="r431 r">typeFile</span> <b>in</b> <span class="r425 r">typeFilesToRemove</span>)
                {
                    <span class="r430 r">resolvedTypeFilesToRemove</span>.<span class="i">Add</span>(<a href="Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<span class="i">ResolveRootedFilePath</span>(<span class="r431 r">typeFile</span>, <span class="r423 r">context</span>) ?? <span class="r431 r">typeFile</span>);
                }
 
                <b>foreach</b> (<a href="#02c5fb84a39526f6" class="t t">SessionStateTypeEntry</a> <span id="r432 rd" class="r432 r">entry</span> <b>in</b> <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>)
                {
                    <b>if</b> (<span class="r432 r">entry</span>.<a href="#335a66dec2c02166" class="i property">FileName</a> == <b>null</b>)
                    {
                        <span class="c">// The entry is associated with a TypeData instance</span>
                        <span class="r429 r">newTypes</span>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r432 r">entry</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Resolving the file path because the path to the types file in module manifest is now specified as</span>
                        <span class="c">// ..\..\types.ps1xml which expands to C:\Windows\System32\WindowsPowerShell\v1.0\Modules\Microsoft.PowerShell.Core\..\..\types.ps1xml</span>
                        <b>string</b> <span id="r433 rd" class="r433 r">filePath</span> = <a href="Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="Modules/ModuleCmdletBase.cs.html#9910dbba4c162701" class="i method">ResolveRootedFilePath</a>(<span class="r432 r">entry</span>.<a href="#335a66dec2c02166" class="i property">FileName</a>, <span class="r423 r">context</span>) ?? <span class="r432 r">entry</span>.<a href="#335a66dec2c02166" class="i property">FileName</a>;
                        <b>if</b> (!<span class="r430 r">resolvedTypeFilesToRemove</span>.<span class="i">Contains</span>(<span class="r433 r">filePath</span>))
                        {
                            <span class="r429 r">newTypes</span>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r432 r">entry</span>);
                        }
                    }
                }
 
                <span class="c">// If there are any types that need to be added to the typetable, update them.</span>
                <span class="c">// Else, clear the typetable</span>
                <b>if</b> (<span class="r429 r">newTypes</span>.<a href="#c6493cb5fe089abd" class="i property">Count</a> &gt; 0)
                {
                    <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<a href="#9c6f481e94fc74d5" class="i method">Clear</a>();
                    <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<span class="i">Add</span>(<span class="r429 r">newTypes</span>);
                    <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#9c0409e753e2228b" class="i method">UpdateTypes</a>(<span class="r423 r">context</span>, <b>false</b>);
                }
                <b>else</b>
                {
                    <span class="r423 r">context</span>.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>.<a href="TypeTable.cs.html#c882292dc184b86e" class="i method">Clear</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Update the type metadata loaded into this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r434 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context for the runspace to update.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r435 r">updateOnly</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true, re-initialize the metadata collection...</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="9c0409e753e2228b" href="../R/9c0409e753e2228b.html" target="n" data-glyph="74,1" class="i method">UpdateTypes</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r434 rd" class="r434 r">context</span>, <b>bool</b> <span id="r435 rd" class="r435 r">updateOnly</span>)
        {
            <b>if</b> (<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<a href="#c6493cb5fe089abd" class="i property">Count</a> == 1)
            {
                <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r436 rd" class="r436 r">typeTable</span> = <a href="#0f0c3a5adb4b1776" class="i property">Types</a>[0].<a href="#083bf959ec73da96" class="i property">TypeTable</a>;
                <b>if</b> (<span class="r436 r">typeTable</span> != <b>null</b>)
                {
                    <span class="c">// reuse the TypeTable instance specified in the sste.</span>
                    <span class="c">// this essentially allows for TypeTable sharing across</span>
                    <span class="c">// multiple runspaces.</span>
 
                    <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a> = <span class="r436 r">typeTable</span>;
 
                    <a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<a href="#9c6f481e94fc74d5" class="i method">Clear</a>();
                    <a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<span class="i">Add</span>(<span class="r436 r">typeTable</span>.<a href="TypeTable.cs.html#84efaf5a69a073ae" class="i field">typesInfo</a>);
 
                    <b>return</b>;
                }
            }
 
            <b>if</b> (!<span class="r435 r">updateOnly</span>)
            {
                <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>.<a href="TypeTable.cs.html#c882292dc184b86e" class="i method">Clear</a>();
            }
 
            <span class="i">ConcurrentBag</span>&lt;<b>string</b>&gt; <span id="r437 rd" class="r437 r">errors</span> = <b>new</b> <span class="i">ConcurrentBag</span>&lt;<b>string</b>&gt;();
            <span class="c">// Use at most 3 locks (we don&#39;t expect contention on that many cores anyways,</span>
            <span class="c">// and typically we&#39;ll be processing just 2 or 3 files anyway, hence capacity=3.</span>
            <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <span id="r438 rd" class="r438 r">filesProcessed</span> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(
                    <span class="i">concurrencyLevel</span>: 3,
                    <span class="i">capacity</span>: 3,
                    <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <span class="i">Parallel</span>.<span class="i">ForEach</span>(
                <a href="#0f0c3a5adb4b1776" class="i property">Types</a>,
                <span id="r439 rd" class="r439 r">sste</span> =&gt;
            {
                <span class="c">// foreach (var sste in Types)</span>
                <b>if</b> (<span class="r439 r">sste</span>.<span class="i">FileName</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r438 r">filesProcessed</span>.<span class="i">TryAdd</span>(<span class="r439 r">sste</span>.<span class="i">FileName</span>, <b>null</b>))
                    {
                        <b>string</b> <span id="r440 rd" class="r440 r">moduleName</span> = <b>string</b>.<span class="i">Empty</span>;
                        <b>if</b> (<span class="r439 r">sste</span>.<span class="i">PSSnapIn</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r439 r">sste</span>.<span class="i">PSSnapIn</span>.<span class="i">Name</span>))
                        {
                            <span class="r440 r">moduleName</span> = <span class="r439 r">sste</span>.<span class="i">PSSnapIn</span>.<span class="i">Name</span>;
                        }
 
                        <b>bool</b> <span id="r441 rd" class="r441 r">unused</span>;
                        <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>.<span class="i">Update</span>(<span class="r440 r">moduleName</span>, <span class="r439 r">sste</span>.<span class="i">FileName</span>, <span class="r437 r">errors</span>, <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#d04f29dfc80b1390" class="i property">AuthorizationManager</a>, <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>, <b>out</b> <span class="r441 r">unused</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r439 r">sste</span>.<span class="i">TypeTable</span> != <b>null</b>)
                {
                    <span class="c">// We get here only if it&#39;s NOT updating the existing type table</span>
                    <span class="c">// because we cannot do the update with a type table instance</span>
                    <span class="r437 r">errors</span>.<span class="i">Add</span>(<span class="i">TypesXmlStrings</span>.<span class="i">TypeTableCannotCoExist</span>);
                }
                <b>else</b>
                {
                    <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>.<span class="i">Update</span>(<span class="r439 r">sste</span>.<span class="i">TypeData</span>, <span class="r437 r">errors</span>, <span class="r439 r">sste</span>.<span class="i">IsRemove</span>);
                }
            });
 
            <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>.<a href="TypeTable.cs.html#ed43df276566cb56" class="i method">ClearConsolidatedMembers</a>();
 
            <b>if</b> (<span class="r435 r">updateOnly</span>)
            {
                <span class="c">// Put the SessionStateTypeEntry into the cache if we are updating the type table</span>
                <b>foreach</b> (<b>var</b> <span id="r442 rd" class="r442 r">sste</span> <b>in</b> <a href="#0f0c3a5adb4b1776" class="i property">Types</a>)
                {
                    <span class="r434 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<span class="i">Add</span>(<span class="r442 r">sste</span>);
                }
            }
 
            <b>if</b> (!<span class="r437 r">errors</span>.<span class="i">IsEmpty</span>)
            {
                <b>var</b> <span id="r443 rd" class="r443 r">allErrors</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <span class="r443 r">allErrors</span>.<span class="i">Append</span>(<span class="s">&#39;\n&#39;</span>);
                <b>foreach</b> (<b>string</b> <span id="r444 rd" class="r444 r">error</span> <b>in</b> <span class="r437 r">errors</span>)
                {
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r444 r">error</span>))
                    {
                        <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a> || <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#97adcb7e4a250b21" class="i field">RefreshTypeAndFormatSetting</a>)
                        {
                            <span class="r443 r">allErrors</span>.<span class="i">Append</span>(<span class="r444 r">error</span>);
                            <span class="r443 r">allErrors</span>.<span class="i">Append</span>(<span class="s">&#39;\n&#39;</span>);
                        }
                        <b>else</b>
                        {
                            <span class="r434 r">context</span>.<span class="i">ReportEngineStartupError</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">TypesXmlError</span>, <span class="r444 r">error</span>);
                        }
                    }
                }
 
                <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a>)
                {
                    <b>string</b> <span id="r445 rd" class="r445 r">resource</span> = <span class="i">ExtendedTypeSystem</span>.<span class="i">TypesXmlError</span>;
                    <span class="i">ThrowTypeOrFormatErrors</span>(<span class="r445 r">resource</span>, <span class="r443 r">allErrors</span>.<span class="i">ToString</span>(), <span class="s">&quot;ErrorsUpdatingTypes&quot;</span>);
                }
 
                <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#97adcb7e4a250b21" class="i field">RefreshTypeAndFormatSetting</a>)
                {
                    <b>string</b> <span id="r446 rd" class="r446 r">resource</span> = <span class="i">ExtendedTypeSystem</span>.<span class="i">TypesXmlError</span>;
                    <span class="i">ThrowTypeOrFormatErrors</span>(<span class="r446 r">resource</span>, <span class="r443 r">allErrors</span>.<span class="i">ToString</span>(), <span class="s">&quot;ErrorsUpdatingTypes&quot;</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Update the formatting information for a runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r447 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The execution context for the runspace to be updated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r448 r">update</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if we only want to add stuff, false if we want to reinitialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="6a9371cd77e6c41f" href="../R/6a9371cd77e6c41f.html" target="n" data-glyph="74,1" class="i method">UpdateFormats</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r447 rd" class="r447 r">context</span>, <b>bool</b> <span id="r448 rd" class="r448 r">update</span>)
        {
            <b>if</b> (<a href="#d12e46183b35df33" class="i property">DisableFormatUpdates</a> || <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<a href="#c6493cb5fe089abd" class="i property">Count</a> == 0)
            {
                <b>return</b>;
            }
 
            <span class="i">Collection</span>&lt;<a href="../utils/FormatAndTypeDataHelper.cs.html#9a5294f32203c826" class="t t">PSSnapInTypeAndFormatErrors</a>&gt; <span id="r449 rd" class="r449 r">entries</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../utils/FormatAndTypeDataHelper.cs.html#9a5294f32203c826" class="t t">PSSnapInTypeAndFormatErrors</a>&gt;();
            <a href="#d3dc56d6666ca9c3" class="t t">InitialSessionStateEntryCollection</a>&lt;<a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a>&gt; <span id="r450 rd" class="r450 r">formatsToLoad</span>;
 
            <span class="c">// If we&#39;re just updating the current runspace, then we&#39;ll add our entries</span>
            <span class="c">// to the current list otherwise, we&#39;ll build a new list...</span>
            <b>if</b> (<span class="r448 r">update</span> &amp;&amp; <span class="r447 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a> != <b>null</b>)
            {
                <span class="r450 r">formatsToLoad</span> = <span class="r447 r">context</span>.<a href="ExecutionContext.cs.html#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>;
                <span class="r450 r">formatsToLoad</span>.<span class="i">Add</span>(<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>);
            }
            <b>else</b>
            {
                <span class="r450 r">formatsToLoad</span> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>;
            }
 
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r451 rd" class="r451 r">filesProcessed</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a> <span id="r452 rd" class="r452 r">ssfe</span> <b>in</b> <span class="r450 r">formatsToLoad</span>)
            {
                <b>string</b> <span id="r453 rd" class="r453 r">name</span> = <span class="r452 r">ssfe</span>.<a href="#f6108e84d6fcb004" class="i property">FileName</a>;
                <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r454 rd" class="r454 r">snapin</span> = <span class="r452 r">ssfe</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>;
                <b>if</b> (<span class="r454 r">snapin</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r454 r">snapin</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>))
                {
                    <span class="r453 r">name</span> = <span class="r454 r">snapin</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>;
                }
 
                <b>if</b> (<span class="r452 r">ssfe</span>.<a href="#f35524b7b8c189d4" class="i property">Formattable</a> != <b>null</b>)
                {
                    <b>if</b> (<span class="r450 r">formatsToLoad</span>.<a href="#c6493cb5fe089abd" class="i property">Count</a> == 1)
                    {
                        <span class="r447 r">context</span>.<a href="ExecutionContext.cs.html#40afda0efcb0cad4" class="i property">FormatDBManager</a> = <span class="r452 r">ssfe</span>.<a href="#f35524b7b8c189d4" class="i property">Formattable</a>.<a href="../FormatAndOutput/common/DisplayDatabase/FormatTable.cs.html#37a0086697775545" class="i property">FormatDBManager</a>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// if a SharedFormatTable is allowed then only one</span>
                        <span class="c">// entry can be specified.</span>
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">FormatAndOutXmlLoadingStrings</span>.<span class="i">FormatTableCannotCoExist</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r452 r">ssfe</span>.<a href="#95b6a8b5869f7682" class="i property">FormatData</a> != <b>null</b>)
                {
                    <span class="r449 r">entries</span>.<span class="i">Add</span>(<b>new</b> <a href="../utils/FormatAndTypeDataHelper.cs.html#3f0af8d84b0cf7a5" class="t constructor">PSSnapInTypeAndFormatErrors</a>(<span class="r453 r">name</span>, <span class="r452 r">ssfe</span>.<a href="#95b6a8b5869f7682" class="i property">FormatData</a>));
                }
                <b>else</b>
                {
                    <b>if</b> (!<span class="r451 r">filesProcessed</span>.<span class="i">Contains</span>(<span class="r452 r">ssfe</span>.<a href="#f6108e84d6fcb004" class="i property">FileName</a>))
                    {
                        <span class="r451 r">filesProcessed</span>.<span class="i">Add</span>(<span class="r452 r">ssfe</span>.<a href="#f6108e84d6fcb004" class="i property">FileName</a>);
                        <span class="r449 r">entries</span>.<span class="i">Add</span>(<b>new</b> <a href="../utils/FormatAndTypeDataHelper.cs.html#fb5970c6792eb6e5" class="t constructor">PSSnapInTypeAndFormatErrors</a>(<span class="r453 r">name</span>, <span class="r452 r">ssfe</span>.<a href="#f6108e84d6fcb004" class="i property">FileName</a>));
                    }
                }
            }
 
            <b>if</b> (<span class="r449 r">entries</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r447 r">context</span>.<a href="ExecutionContext.cs.html#40afda0efcb0cad4" class="i property">FormatDBManager</a>.<a href="../FormatAndOutput/common/DisplayDatabase/typeDataManager.cs.html#23c44a65d4d48d25" class="i method">UpdateDataBase</a>(<span class="r449 r">entries</span>, <span class="r447 r">context</span>.<a href="ExecutionContext.cs.html#d04f29dfc80b1390" class="i property">AuthorizationManager</a>, <span class="r447 r">context</span>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>, <b>true</b>);
 
                <b>var</b> <span id="r455 rd" class="r455 r">allErrors</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="s">&quot;\n&quot;</span>);
                <b>bool</b> <span id="r456 rd" class="r456 r">hasErrors</span> = <b>false</b>;
 
                <span class="c">// Now see if there were any errors in the format files and report them</span>
                <span class="c">// if this is the case...</span>
                <b>foreach</b> (<a href="../utils/FormatAndTypeDataHelper.cs.html#9a5294f32203c826" class="t t">PSSnapInTypeAndFormatErrors</a> <span id="r457 rd" class="r457 r">entry</span> <b>in</b> <span class="r449 r">entries</span>)
                {
                    <b>if</b> (<span class="r457 r">entry</span>.<a href="../utils/FormatAndTypeDataHelper.cs.html#d82bf3db07160a39" class="i property">Errors</a> != <b>null</b> &amp;&amp; !<span class="r457 r">entry</span>.<a href="../utils/FormatAndTypeDataHelper.cs.html#d82bf3db07160a39" class="i property">Errors</a>.<span class="i">IsEmpty</span>)
                    {
                        <b>foreach</b> (<b>string</b> <span id="r458 rd" class="r458 r">error</span> <b>in</b> <span class="r457 r">entry</span>.<a href="../utils/FormatAndTypeDataHelper.cs.html#d82bf3db07160a39" class="i property">Errors</a>)
                        {
                            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r458 r">error</span>))
                            {
                                <span class="r456 r">hasErrors</span> = <b>true</b>;
                                <b>if</b> (<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a> || <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#97adcb7e4a250b21" class="i field">RefreshTypeAndFormatSetting</a>)
                                {
                                    <span class="r455 r">allErrors</span>.<span class="i">Append</span>(<span class="r458 r">error</span>);
                                    <span class="r455 r">allErrors</span>.<span class="i">Append</span>(<span class="s">&#39;\n&#39;</span>);
                                }
                                <b>else</b>
                                {
                                    <span class="r447 r">context</span>.<span class="i">ReportEngineStartupError</span>(<span class="i">FormatAndOutXmlLoadingStrings</span>.<span class="i">FormatLoadingErrors</span>, <span class="r458 r">error</span>);
                                }
                            }
                        }
                    }
                }
 
                <b>if</b> ((<a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#259e8aa509ac9e00" class="i property">ThrowOnRunspaceOpenError</a> || <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#97adcb7e4a250b21" class="i field">RefreshTypeAndFormatSetting</a>) &amp;&amp; <span class="r456 r">hasErrors</span>)
                {
                    <b>string</b> <span id="r459 rd" class="r459 r">resource</span> = <span class="i">FormatAndOutXmlLoadingStrings</span>.<span class="i">FormatLoadingErrors</span>;
                    <span class="i">ThrowTypeOrFormatErrors</span>(<span class="r459 r">resource</span>, <span class="r455 r">allErrors</span>.<span class="i">ToString</span>(), <span class="s">&quot;ErrorsUpdatingFormats&quot;</span>);
                }
            }
        }
 
        <b>private static void</b> <a id="d7fb9442fa431e80" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ThrowTypeOrFormatErrors</a>(<b>string</b> <span id="r460 rd" class="r460 r">resourceString</span>, <b>string</b> <span id="r461 rd" class="r461 r">errorMsg</span>, <b>string</b> <span id="r462 rd" class="r462 r">errorId</span>)
        {
            <b>string</b> <span id="r463 rd" class="r463 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../utils/StringUtil.cs.html#6dd43165d0b5d92f" class="i method">Format</a>(<span class="r460 r">resourceString</span>, <span class="r461 r">errorMsg</span>);
            <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="k">var</a> <span id="r464 rd" class="r464 r">ex</span> = <b>new</b> <a href="../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<span class="r463 r">message</span>);
            <span class="r464 r">ex</span>.<a href="../utils/RuntimeException.cs.html#f25affe9a215ccc0" class="i method">SetErrorId</a>(<span class="r462 r">errorId</span>);
            <b>throw</b> <span class="r464 r">ex</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Need to have SnapIn support till we move to modules.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r465 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r466 r">warning</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">Obsolete</span>(<span class="s">&quot;Custom PSSnapIn is deprecated. Please use a module instead.&quot;</span>, <b>true</b>)]
        <b>public</b> <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="a3e46b709c2b20d4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ImportPSSnapIn</a>(<b>string</b> <span id="r465 rd" class="r465 r">name</span>, <b>out</b> <a href="../singleshell/config/MshSnapinLoadException.cs.html#ea3dcb3a13c557ee" class="t t">PSSnapInException</a> <span id="r466 rd" class="r466 r">warning</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r465 r">name</span>))
            {
                <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r465 r">name</span>));
            }
 
            <span class="c">// Check whether the mshsnapin is present in the registry.</span>
            <span class="c">// TODO: Note the hard-coded version number here, this was part of the SingleShell</span>
            <span class="c">// implementation and should be refactored.</span>
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r467 rd" class="r467 r">newPSSnapIn</span> = <a href="../singleshell/config/MshSnapinInfo.cs.html#b036b8d90fff7faa" class="t t">PSSnapInReader</a>.<a href="../singleshell/config/MshSnapinInfo.cs.html#8ac2780a30babc4f" class="i method">Read</a>(<span class="s">&quot;2&quot;</span>, <span class="r465 r">name</span>);
 
            <b>if</b> (!<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">IsPSVersionSupported</span>(<span class="r467 r">newPSSnapIn</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#eccaf10188e41976" class="i property">PSVersion</a>.<span class="i">ToString</span>()))
            {
                <a href="#04af3fc88e7d089a" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;MshSnapin {0} and current monad engine&#39;s versions don&#39;t match.&quot;</span>, <span class="r465 r">name</span>);
 
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(
                    <span class="s">&quot;mshSnapInID&quot;</span>,
                    <span class="i">ConsoleInfoErrorStrings</span>.<span class="i">AddPSSnapInBadMonadVersion</span>,
                    <span class="r467 r">newPSSnapIn</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#eccaf10188e41976" class="i property">PSVersion</a>.<span class="i">ToString</span>(),
                    <span class="s">&quot;2.0&quot;</span>);
            }
 
            <span class="c">// Now actually load the snapin...</span>
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r468 rd" class="r468 r">snapin</span> = <a href="#3669b3b4b8f85a68" class="i method">ImportPSSnapIn</a>(<span class="r467 r">newPSSnapIn</span>, <b>out</b> <span class="r466 r">warning</span>);
            <b>if</b> (<span class="r468 r">snapin</span> != <b>null</b>)
            {
                <a href="#3d3246dc9d19522a" class="i property">ImportedSnapins</a>.<span class="i">Add</span>(<span class="r468 r">snapin</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>, <span class="r468 r">snapin</span>);
            }
 
            <b>return</b> <span class="r468 r">snapin</span>;
        }
 
        <b>internal</b> <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="2596e8ca74c2f5f0" href="../R/2596e8ca74c2f5f0.html" target="n" data-glyph="74,1" class="i method">ImportCorePSSnapIn</a>()
        {
            <span class="c">// Load Microsoft.PowerShell.Core as a snapin</span>
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r469 rd" class="r469 r">coreSnapin</span> = <a href="../singleshell/config/MshSnapinInfo.cs.html#b036b8d90fff7faa" class="t t">PSSnapInReader</a>.<a href="../singleshell/config/MshSnapinInfo.cs.html#b458c58d8c08f4e3" class="i method">ReadCoreEngineSnapIn</a>();
            <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#63420b5d815e7587" class="i field">defaultSnapins</a>.<span class="i">Add</span>(<span class="r469 r">coreSnapin</span>);
            <b>try</b>
            {
                <a href="../singleshell/config/MshSnapinLoadException.cs.html#ea3dcb3a13c557ee" class="t t">PSSnapInException</a> <span id="r470 rd" class="r470 r">warning</span>;
                <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#3669b3b4b8f85a68" class="i method">ImportPSSnapIn</a>(<span class="r469 r">coreSnapin</span>, <b>out</b> <span class="r470 r">warning</span>);
            }
            <b>catch</b> (<a href="../singleshell/config/MshSnapinLoadException.cs.html#ea3dcb3a13c557ee" class="t t">PSSnapInException</a>)
            {
                <b>throw</b>;
            }
 
            <b>return</b> <span class="r469 r">coreSnapin</span>;
        }
 
        <b>internal</b> <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="3669b3b4b8f85a68" href="../R/3669b3b4b8f85a68.html" target="n" data-glyph="74,1" class="i method">ImportPSSnapIn</a>(<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r471 rd" class="r471 r">psSnapInInfo</span>, <b>out</b> <a href="../singleshell/config/MshSnapinLoadException.cs.html#ea3dcb3a13c557ee" class="t t">PSSnapInException</a> <span id="r472 rd" class="r472 r">warning</span>)
        {
            <span class="c">// See if the snapin is already loaded. If has been then there will be an entry in the</span>
            <span class="c">// Assemblies list for it already...</span>
            <b>bool</b> <span id="r473 rd" class="r473 r">reload</span> = <b>true</b>;
 
            <b>foreach</b> (<a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a> <span id="r474 rd" class="r474 r">ae</span> <b>in</b> <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#501914944d122594" class="i property">Assemblies</a>)
            {
                <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r475 rd" class="r475 r">loadedPSSnapInInfo</span> = <span class="r474 r">ae</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>;
                <b>if</b> (<span class="r475 r">loadedPSSnapInInfo</span> != <b>null</b>)
                {
                    <span class="c">// See if the assembly-qualified names match and return the existing PSSnapInInfo</span>
                    <span class="c">// if they do.</span>
                    <b>string</b> <span id="r476 rd" class="r476 r">loadedSnapInName</span> = <span class="r474 r">ae</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>;
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r476 r">loadedSnapInName</span>)
                        &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r476 r">loadedSnapInName</span>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="i n">System</span>.<span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r472 r">warning</span> = <b>null</b>;
 
                        <span class="c">// the previous implementation used to return the</span>
                        <span class="c">// same loaded snap-in value. This results in the</span>
                        <span class="c">// commands/types/formats exposed in the snap-in</span>
                        <span class="c">// to be not populated in the InitialSessionState</span>
                        <span class="c">// object. This is being fixed</span>
                        <span class="r473 r">reload</span> = <b>false</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt; <span id="r477 rd" class="r477 r">cmdlets</span> = <b>null</b>;
            <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt; <span id="r478 rd" class="r478 r">aliases</span> = <b>null</b>;
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <span id="r479 rd" class="r479 r">providers</span> = <b>null</b>;
 
            <b>if</b> (<span class="r471 r">psSnapInInfo</span> == <b>null</b>)
            {
                <span class="i">ArgumentNullException</span> <span id="r480 rd" class="r480 r">e</span> = <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r471 r">psSnapInInfo</span>));
                <b>throw</b> <span class="r480 r">e</span>;
            }
 
            <span class="i">Assembly</span> <span id="r481 rd" class="r481 r">assembly</span> = <b>null</b>;
            <b>string</b> <span id="r482 rd" class="r482 r">helpFile</span> = <b>null</b>;
 
            <b>if</b> (<span class="r473 r">reload</span>)
            {
                <a href="#04af3fc88e7d089a" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Loading assembly for psSnapIn {0}&quot;</span>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>);
 
                <span class="r481 r">assembly</span> = <a href="#d3c7a3a0a3314c6f" class="t t">PSSnapInHelpers</a>.<a href="#fc1f929f2722ffe3" class="i method">LoadPSSnapInAssembly</a>(<span class="r471 r">psSnapInInfo</span>);
 
                <b>if</b> (<span class="r481 r">assembly</span> == <b>null</b>)
                {
                    <a href="#04af3fc88e7d089a" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;Loading assembly for psSnapIn {0} failed&quot;</span>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>);
                    <span class="r472 r">warning</span> = <b>null</b>;
                    <b>return</b> <b>null</b>; <span class="c">// BUGBUG - should add something to the warnings list here instead of quitting...</span>
                }
 
                <a href="#04af3fc88e7d089a" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Loading assembly for psSnapIn {0} succeeded&quot;</span>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>);
 
                <a href="#d3c7a3a0a3314c6f" class="t t">PSSnapInHelpers</a>.<a href="#da146dc0f1032bdf" class="i method">AnalyzePSSnapInAssembly</a>(<span class="r481 r">assembly</span>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>, <span class="r471 r">psSnapInInfo</span>, <span class="r483 r">moduleInfo</span>: <b>null</b>, <b>out</b> <span class="r477 r">cmdlets</span>, <b>out</b> <span class="r478 r">aliases</span>, <b>out</b> <span class="r479 r">providers</span>, <b>out</b> <span class="r482 r">helpFile</span>);
            }
 
            <span class="c">// We skip checking if the file exists when it&#39;s in $PSHOME because of magic</span>
            <span class="c">// where we have the former contents of those files built into the engine directly.</span>
            <b>var</b> <span id="r484 rd" class="r484 r">psHome</span> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#c677cc800603f8f5" class="i property">DefaultPowerShellAppBase</a>;
 
            <b>foreach</b> (<b>string</b> <span id="r485 rd" class="r485 r">file</span> <b>in</b> <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#e35c7867f8d42d8a" class="i property">Types</a>)
            {
                <b>string</b> <span id="r486 rd" class="r486 r">path</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>, <span class="r485 r">file</span>);
 
                <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r484 r">psHome</span>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                    &amp;&amp; !<span class="i">File</span>.<span class="i">Exists</span>(<span class="r486 r">path</span>))
                {
                    <span class="c">// Remove the application base directory if assembly doesn&#39;t exist in it.</span>
                    <span class="r486 r">path</span> = <span class="r485 r">file</span>;
                }
 
                <a href="#02c5fb84a39526f6" class="t t">SessionStateTypeEntry</a> <span id="r487 rd" class="r487 r">typeEntry</span> = <b>new</b> <a href="#6607e0d8b4d498c7" class="t constructor">SessionStateTypeEntry</a>(<span class="r486 r">path</span>);
                <span class="r487 r">typeEntry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<span class="r471 r">psSnapInInfo</span>);
                <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#0f0c3a5adb4b1776" class="i property">Types</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r487 r">typeEntry</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r488 rd" class="r488 r">file</span> <b>in</b> <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#97d12a57dedcadc2" class="i property">Formats</a>)
            {
                <b>string</b> <span id="r489 rd" class="r489 r">path</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>, <span class="r488 r">file</span>);
 
                <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r484 r">psHome</span>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                    &amp;&amp; !<span class="i">File</span>.<span class="i">Exists</span>(<span class="r489 r">path</span>))
                {
                    <span class="r489 r">path</span> = <span class="r488 r">file</span>;
                }
 
                <a href="#6166917bdff50809" class="t t">SessionStateFormatEntry</a> <span id="r490 rd" class="r490 r">formatEntry</span> = <b>new</b> <a href="#96ae628367065642" class="t constructor">SessionStateFormatEntry</a>(<span class="r489 r">path</span>);
                <span class="r490 r">formatEntry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<span class="r471 r">psSnapInInfo</span>);
                <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#4e7657f066102cad" class="i property">Formats</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r490 r">formatEntry</span>);
            }
 
            <a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a> <span id="r491 rd" class="r491 r">assemblyEntry</span> = <b>new</b> <a href="#f7e880a795c5c912" class="t constructor">SessionStateAssemblyEntry</a>(<span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#129cc76c8c0bf832" class="i property">AbsoluteModulePath</a>);
 
            <span class="r491 r">assemblyEntry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<span class="r471 r">psSnapInInfo</span>);
 
            <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#501914944d122594" class="i property">Assemblies</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r491 r">assemblyEntry</span>);
 
            <span class="c">// entry from types.ps1xml references a type (Microsoft.PowerShell.Commands.SecurityDescriptorCommandsBase) in this assembly</span>
            <b>if</b> (<span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>.<span class="i">Equals</span>(<a href="#98d20723748cfbf6" class="i field">CoreSnapin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r491 r">assemblyEntry</span> = <b>new</b> <a href="#f7e880a795c5c912" class="t constructor">SessionStateAssemblyEntry</a>(<span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>, <b>null</b>);
                <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#501914944d122594" class="i property">Assemblies</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r491 r">assemblyEntry</span>);
            }
 
            <b>if</b> (<span class="r477 r">cmdlets</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r492 rd" class="r492 r">cmdlet</span> <b>in</b> <span class="r477 r">cmdlets</span>.<span class="i">Values</span>)
                {
                    <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r493 rd" class="r493 r">newEntry</span> = (<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>)<span class="r492 r">cmdlet</span>.<a href="#76615fbd6ac85ce6" class="i method">Clone</a>();
                    <span class="r493 r">newEntry</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a>;
 
                    <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r493 r">newEntry</span>);
                }
            }
 
            <b>if</b> (<span class="r478 r">aliases</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r494 rd" class="r494 r">cmdletAliasesEntry</span> <b>in</b> <span class="r478 r">aliases</span>.<span class="i">Values</span>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r495 rd" class="r495 r">sessionStateAliasEntry</span> <b>in</b> <span class="r494 r">cmdletAliasesEntry</span>)
                    {
                        <span class="r495 r">sessionStateAliasEntry</span>.<span class="i">Visibility</span> = <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#cef2c573c113a1c8" class="i property">DefaultCommandVisibility</a>;
                        <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<span class="r495 r">sessionStateAliasEntry</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r479 r">providers</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r496 rd" class="r496 r">provider</span> <b>in</b> <span class="r479 r">providers</span>.<span class="i">Values</span>)
                {
                    <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#901a2e8b67c4db16" class="i property">Providers</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r496 r">provider</span>);
                }
            }
 
            <span class="r472 r">warning</span> = <b>null</b>;
 
            <span class="c">// Add help file information for built-in functions</span>
            <b>if</b> (<span class="r471 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>.<span class="i">Equals</span>(<a href="#98d20723748cfbf6" class="i field">CoreSnapin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>foreach</b> (<a href="#24449f380379f027" class="k">var</a> <span id="r497 rd" class="r497 r">f</span> <b>in</b> <a href="#5dd8211b20a972f7" class="i field">BuiltInFunctions</a>)
                {
                    <span class="i">Collection</span>&lt;<a href="#480a10ec8ac9df7b" class="t t">SessionStateCommandEntry</a>&gt; <span id="r498 rd" class="r498 r">funcList</span> = <a href="#2d45d0b0db0079ba" class="i property">Commands</a><a href="#8a6a2b8d34f0d716">[</a><span class="r497 r">f</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>];
                    <b>foreach</b> (<b>var</b> <span id="r499 rd" class="r499 r">func</span> <b>in</b> <span class="r498 r">funcList</span>)
                    {
                        <b>if</b> (<span class="r499 r">func</span> <b>is</b> <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>)
                        {
                            ((<a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>)<span class="r499 r">func</span>).<a href="#e154d5dff9333d37" class="i method">SetHelpFile</a>(<span class="r482 r">helpFile</span>);
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r471 r">psSnapInInfo</span>;
        }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <a id="af331358903f5801" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetPSSnapIn</a>(<b>string</b> <span id="r500 rd" class="r500 r">psSnapinName</span>)
        {
            <span class="i">List</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <span id="r501 rd" class="r501 r">loadedSnapins</span> = <b>null</b>;
            <b>foreach</b> (<b>var</b> <span id="r502 rd" class="r502 r">defaultSnapin</span> <b>in</b> <a href="#63420b5d815e7587" class="i field">defaultSnapins</a>)
            {
                <b>if</b> (<span class="r502 r">defaultSnapin</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="r500 r">psSnapinName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>if</b> (<span class="r501 r">loadedSnapins</span> == <b>null</b>)
                    {
                        <span class="r501 r">loadedSnapins</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt;();
                    }
 
                    <span class="r501 r">loadedSnapins</span>.<span class="i">Add</span>(<span class="r502 r">defaultSnapin</span>);
                }
            }
 
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r503 rd" class="r503 r">importedSnapin</span> = <b>null</b>;
            <b>if</b> (<a href="#3d3246dc9d19522a" class="i property">ImportedSnapins</a>.<span class="i">TryGetValue</span>(<span class="r500 r">psSnapinName</span>, <b>out</b> <span class="r503 r">importedSnapin</span>))
            {
                <b>if</b> (<span class="r501 r">loadedSnapins</span> == <b>null</b>)
                {
                    <span class="r501 r">loadedSnapins</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt;();
                }
 
                <span class="r501 r">loadedSnapins</span>.<span class="i">Add</span>(<span class="r503 r">importedSnapin</span>);
            }
 
            <b>return</b> <span class="r501 r">loadedSnapins</span>;
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2001:AvoidCallingProblematicMethods&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;System.Reflection.Assembly.LoadFrom&quot;</span>)]
        <b>internal static</b> <span class="i">Assembly</span> <a id="63920562a13a568c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LoadAssemblyFromFile</a>(<b>string</b> <span id="r504 rd" class="r504 r">fileName</span>)
        {
            <a href="#04af3fc88e7d089a" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Loading assembly for psSnapIn {0}&quot;</span>, <span class="r504 r">fileName</span>);
 
            <span class="i">Assembly</span> <span id="r505 rd" class="r505 r">assembly</span> = <span class="i">Assembly</span>.<span class="i">LoadFrom</span>(<span class="r504 r">fileName</span>);
            <b>if</b> (<span class="r505 r">assembly</span> == <b>null</b>)
            {
                <a href="#04af3fc88e7d089a" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;Loading assembly for psSnapIn {0} failed&quot;</span>, <span class="r504 r">fileName</span>);
                <b>return</b> <b>null</b>;
            }
 
            <a href="#04af3fc88e7d089a" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Loading assembly for psSnapIn {0} succeeded&quot;</span>, <span class="r504 r">fileName</span>);
 
            <b>return</b> <span class="r505 r">assembly</span>;
        }
 
        <b>internal void</b> <a id="16c2d865cbb0f5ba" href="../R/16c2d865cbb0f5ba.html" target="n" data-glyph="74,1" class="i method">ImportCmdletsFromAssembly</a>(<span class="i">Assembly</span> <span id="r506 rd" class="r506 r">assembly</span>, <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r507 rd" class="r507 r">module</span>)
        {
            <b>if</b> (<span class="r506 r">assembly</span> == <b>null</b>)
            {
                <span class="i">ArgumentNullException</span> <span id="r508 rd" class="r508 r">e</span> = <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r506 r">assembly</span>));
                <b>throw</b> <span class="r508 r">e</span>;
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt; <span id="r509 rd" class="r509 r">cmdlets</span> = <b>null</b>;
            <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt; <span id="r510 rd" class="r510 r">aliases</span> = <b>null</b>;
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <span id="r511 rd" class="r511 r">providers</span> = <b>null</b>;
 
            <b>string</b> <span id="r512 rd" class="r512 r">assemblyPath</span> = <span class="r506 r">assembly</span>.<span class="i">Location</span>;
            <a href="#d3c7a3a0a3314c6f" class="t t">PSSnapInHelpers</a>.<a href="#da146dc0f1032bdf" class="i method">AnalyzePSSnapInAssembly</a>(<span class="r506 r">assembly</span>, <span class="r512 r">assemblyPath</span>, <span class="r513 r">psSnapInInfo</span>: <b>null</b>, <span class="r507 r">module</span>, <b>out</b> <span class="r509 r">cmdlets</span>, <b>out</b> <span class="r510 r">aliases</span>, <b>out</b> <span class="r511 r">providers</span>, <span class="r514 r">helpFile</span>: <b>out _</b>);
 
            <span class="c">// If this is an in-memory assembly, don&#39;t added it to the list of AssemblyEntries</span>
            <span class="c">// since it can&#39;t be loaded by path or name</span>
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r506 r">assembly</span>.<span class="i">Location</span>))
            {
                <a href="#94d9e7cde4269029" class="t t">SessionStateAssemblyEntry</a> <span id="r515 rd" class="r515 r">assemblyEntry</span> = <b>new</b> <span class="t">SessionStateAssemblyEntry</span>(<span class="r506 r">assembly</span>.<span class="i">FullName</span>, <span class="r512 r">assemblyPath</span>);
                <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#501914944d122594" class="i property">Assemblies</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r515 r">assemblyEntry</span>);
            }
 
            <b>if</b> (<span class="r509 r">cmdlets</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r516 rd" class="r516 r">cmdlet</span> <b>in</b> <span class="r509 r">cmdlets</span>.<span class="i">Values</span>)
                {
                    <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r516 r">cmdlet</span>);
                }
            }
 
            <b>if</b> (<span class="r510 r">aliases</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r517 rd" class="r517 r">cmdletAliasesEntry</span> <b>in</b> <span class="r510 r">aliases</span>.<span class="i">Values</span>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r518 rd" class="r518 r">sessionStateAliasEntry</span> <b>in</b> <span class="r517 r">cmdletAliasesEntry</span>)
                    {
                        <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#2d45d0b0db0079ba" class="i property">Commands</a>.<span class="i">Add</span>(<span class="r518 r">sessionStateAliasEntry</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r511 r">providers</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r519 rd" class="r519 r">provider</span> <b>in</b> <span class="r511 r">providers</span>.<span class="i">Values</span>)
                {
                    <a href="#b17f88d4755d5fd7" class="k">this</a>.<a href="#901a2e8b67c4db16" class="i property">Providers</a>.<a href="#048e6fba5da66395" class="i method">Add</a>(<span class="r519 r">provider</span>);
                }
            }
        }
 
        <span class="c">// Now define a bunch of functions that describe the rest of the default session state...</span>
        <b>internal const string</b> <a id="5f35a6e393befada" href="../R/5f35a6e393befada.html" target="n" data-glyph="8,1" class="i field">FormatEnumerationLimit</a> = <span class="s">&quot;FormatEnumerationLimit&quot;</span>;
        <b>internal const int</b> <a id="4d3f35f31f97da63" href="../R/4d3f35f31f97da63.html" target="n" data-glyph="8,1" class="i field">DefaultFormatEnumerationLimit</a> = 4;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the default function to use for tab expansion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly string</b> <a id="92dfd636251cdb45" href="../R/92dfd636251cdb45.html" target="n" data-glyph="46,1" class="i field">s_tabExpansionFunctionText</a> = <span class="s">@&quot;
&lt;# Options include:
     RelativeFilePaths - [bool]
         Always resolve file paths using Resolve-Path -Relative.
         The default is to use some heuristics to guess if relative or absolute is better.
 
   To customize your own custom options, pass a hashtable to CompleteInput, e.g.
         return [System.Management.Automation.CommandCompletion]::CompleteInput($inputScript, $cursorColumn,
             @{ RelativeFilePaths=$false }
#&gt;
 
[CmdletBinding(DefaultParameterSetName = &#39;ScriptInputSet&#39;)]
Param(
    [Parameter(ParameterSetName = &#39;ScriptInputSet&#39;, Mandatory = $true, Position = 0)]
    [string] $inputScript,
 
    [Parameter(ParameterSetName = &#39;ScriptInputSet&#39;, Position = 1)]
    [int] $cursorColumn = $inputScript.Length,
 
    [Parameter(ParameterSetName = &#39;AstInputSet&#39;, Mandatory = $true, Position = 0)]
    [System.Management.Automation.Language.Ast] $ast,
 
    [Parameter(ParameterSetName = &#39;AstInputSet&#39;, Mandatory = $true, Position = 1)]
    [System.Management.Automation.Language.Token[]] $tokens,
 
    [Parameter(ParameterSetName = &#39;AstInputSet&#39;, Mandatory = $true, Position = 2)]
    [System.Management.Automation.Language.IScriptPosition] $positionOfCursor,
 
    [Parameter(ParameterSetName = &#39;ScriptInputSet&#39;, Position = 2)]
    [Parameter(ParameterSetName = &#39;AstInputSet&#39;, Position = 3)]
    [Hashtable] $options = $null
)
 
End
{
    if ($psCmdlet.ParameterSetName -eq &#39;ScriptInputSet&#39;)
    {
        return [System.Management.Automation.CommandCompletion]::CompleteInput(
            &lt;#inputScript#&gt;  $inputScript,
            &lt;#cursorColumn#&gt; $cursorColumn,
            &lt;#options#&gt;      $options)
    }
    else
    {
        return [System.Management.Automation.CommandCompletion]::CompleteInput(
            &lt;#ast#&gt;              $ast,
            &lt;#tokens#&gt;           $tokens,
            &lt;#positionOfCursor#&gt; $positionOfCursor,
            &lt;#options#&gt;          $options)
    }
}
        &quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the default function to use for clear-host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="602c55768af7f5e7" href="../R/602c55768af7f5e7.html" target="n" data-glyph="74,1" class="i method">GetClearHostFunctionText</a>()
        {
            <b>if</b> (<a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#a0395f876114b36d" class="i property">IsWindows</a>)
            {
                <span class="c">// use $RawUI so this works over remoting where there isn&#39;t a physical console</span>
                <b>return</b> <span class="s">@&quot;
$RawUI = $Host.UI.RawUI
$RawUI.CursorPosition = @{X=0;Y=0}
$RawUI.SetBufferContents(
    @{Top = -1; Bottom = -1; Right = -1; Left = -1},
    @{Character = &#39; &#39;; ForegroundColor = $rawui.ForegroundColor; BackgroundColor = $rawui.BackgroundColor})
# .Link
# https://go.microsoft.com/fwlink/?LinkID=2096480
# .ExternalHelp System.Management.Automation.dll-help.xml
&quot;</span>;
            }
            <b>else</b>
            {
                <span class="c">// Porting note: non-Windows platforms use `clear`</span>
                <b>return</b> <span class="s">@&quot;
[Console]::Write((
    &amp; (Get-Command -CommandType Application clear | Select-Object -First 1).Definition
))
# .Link
# https://go.microsoft.com/fwlink/?LinkID=2096480
# .ExternalHelp System.Management.Automation.dll-help.xml
&quot;</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the default function to use for man/help. It uses</span>
        <span class="c">///</span><span class="c"> splatting to pass in the parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="5b774e720f2875d4" href="../R/5b774e720f2875d4.html" target="n" data-glyph="74,1" class="i method">GetHelpPagingFunctionText</a>()
        {
            <span class="c">// We used to generate the text for this function so you could add a parameter</span>
            <span class="c">// to Get-Help and not worry about adding it here.  That was a little slow at</span>
            <span class="c">// startup, so it&#39;s hard coded, with a test to make sure the parameters match.</span>
            <b>return</b> <span class="s">@&quot;
&lt;#
.FORWARDHELPTARGETNAME Get-Help
.FORWARDHELPCATEGORY Cmdlet
#&gt;
[CmdletBinding(DefaultParameterSetName=&#39;AllUsersView&#39;, HelpUri=&#39;https://go.microsoft.com/fwlink/?LinkID=113316&#39;)]
param(
    [Parameter(Position=0, ValueFromPipelineByPropertyName=$true)]
    [string]
    ${Name},
 
    [string]
    ${Path},
 
    [ValidateSet(&#39;Alias&#39;,&#39;Cmdlet&#39;,&#39;Provider&#39;,&#39;General&#39;,&#39;FAQ&#39;,&#39;Glossary&#39;,&#39;HelpFile&#39;,&#39;ScriptCommand&#39;,&#39;Function&#39;,&#39;Filter&#39;,&#39;ExternalScript&#39;,&#39;All&#39;,&#39;DefaultHelp&#39;,&#39;DscResource&#39;,&#39;Class&#39;,&#39;Configuration&#39;)]
    [string[]]
    ${Category},
 
    [Parameter(ParameterSetName=&#39;DetailedView&#39;, Mandatory=$true)]
    [switch]
    ${Detailed},
 
    [Parameter(ParameterSetName=&#39;AllUsersView&#39;)]
    [switch]
    ${Full},
 
    [Parameter(ParameterSetName=&#39;Examples&#39;, Mandatory=$true)]
    [switch]
    ${Examples},
 
    [Parameter(ParameterSetName=&#39;Parameters&#39;, Mandatory=$true)]
    [string[]]
    ${Parameter},
 
    [string[]]
    ${Component},
 
    [string[]]
    ${Functionality},
 
    [string[]]
    ${Role},
 
    [Parameter(ParameterSetName=&#39;Online&#39;, Mandatory=$true)]
    [switch]
    ${Online},
 
    [Parameter(ParameterSetName=&#39;ShowWindow&#39;, Mandatory=$true)]
    [switch]
    ${ShowWindow})
 
    # Display the full help topic by default but only for the AllUsersView parameter set.
    if (($psCmdlet.ParameterSetName -eq &#39;AllUsersView&#39;) -and !$Full) {
        $PSBoundParameters[&#39;Full&#39;] = $true
    }
 
    # Nano needs to use Unicode, but Windows and Linux need the default
    $OutputEncoding = if ([System.Management.Automation.Platform]::IsNanoServer -or [System.Management.Automation.Platform]::IsIoT) {
        [System.Text.Encoding]::Unicode
    } else {
        [System.Console]::OutputEncoding
    }
 
    $help = Get-Help @PSBoundParameters
 
    # If a list of help is returned or AliasHelpInfo (because it is small), don&#39;t pipe to more
    $psTypeNames = ($help | Select-Object -First 1).PSTypeNames
    if ($psTypeNames -Contains &#39;HelpInfoShort&#39; -Or $psTypeNames -Contains &#39;AliasHelpInfo&#39;)
    {
        $help
    }
    elseif ($help -ne $null)
    {
        # By default use more on Windows and less on Linux.
        if ($IsWindows) {
            $pagerCommand = &#39;more.com&#39;
            $pagerArgs = $null
        }
        else {
            $pagerCommand = &#39;less&#39;
            # PSNativeCommandArgumentPassing arguments should be constructed differently.
            if ($EnabledExperimentalFeatures -contains &#39;PSNativeCommandArgumentPassing&#39;) {
                $pagerArgs = &#39;-s&#39;,&#39;-P&#39;,&#39;Page %db?B of %D:.\. Press h for help or q to quit\.&#39;
            }
            else {
                $pagerArgs = &#39;-Ps&quot;&quot;Page %db?B of %D:.\. Press h for help or q to quit\.$&quot;&quot;&#39;
            }
        }
 
        # Respect PAGER environment variable which allows user to specify a custom pager.
        # Ignore a pure whitespace PAGER value as that would cause the tokenizer to return 0 tokens.
        if (![string]::IsNullOrWhitespace($env:PAGER)) {
            if (Get-Command $env:PAGER -ErrorAction Ignore) {
                # Entire PAGER value corresponds to a single command.
                $pagerCommand = $env:PAGER
                $pagerArgs = $null
            }
            else {
                # PAGER value is not a valid command, check if PAGER command and arguments have been specified.
                # Tokenize the specified $env:PAGER value. Ignore tokenizing errors since any errors may be valid
                # argument syntax for the paging utility.
                $errs = $null
                $tokens = [System.Management.Automation.PSParser]::Tokenize($env:PAGER, [ref]$errs)
 
                $customPagerCommand = $tokens[0].Content
                if (!(Get-Command $customPagerCommand -ErrorAction Ignore)) {
                    # Custom pager command is invalid, issue a warning.
                    Write-Warning &quot;&quot;Custom-paging utility command not found. Ignoring command specified in `$env:PAGER: $env:PAGER&quot;&quot;
                }
                else {
                    # This approach will preserve all the pagers args.
                    $pagerCommand = $customPagerCommand
                    $pagerArgs = if ($tokens.Count -gt 1) {$env:PAGER.Substring($tokens[1].Start)} else {$null}
                }
            }
        }
 
        $pagerCommandInfo = Get-Command -Name $pagerCommand -ErrorAction Ignore
        if ($pagerCommandInfo -eq $null) {
            $help
        }
        elseif ($pagerCommandInfo.CommandType -eq &#39;Application&#39;) {
            # If the pager is an application, format the output width before sending to the app.
            $consoleWidth = [System.Math]::Max([System.Console]::WindowWidth, 20)
 
            if ($pagerArgs) {
                # Start the pager arguments directly if the PSNativeCommandArgumentPassing feature is enabled.
                # Otherwise, supply pager arguments to an application without any PowerShell parsing of the arguments.
                # Leave environment variable to help user debug arguments supplied in $env:PAGER.
                if ($EnabledExperimentalFeatures -contains &#39;PSNativeCommandArgumentPassing&#39;) {
                    $help | Out-String -Stream -Width ($consoleWidth - 1) | &amp; $pagerCommand $pagerArgs
                }
                else {
                    $env:__PSPAGER_ARGS = $pagerArgs
                    $help | Out-String -Stream -Width ($consoleWidth - 1) | &amp; $pagerCommand --% %__PSPAGER_ARGS%
                }
            }
            else {
                $help | Out-String -Stream -Width ($consoleWidth - 1) | &amp; $pagerCommand
            }
        }
        else {
            # The pager command is a PowerShell function, script or alias, so pipe directly into it.
            $help | &amp; $pagerCommand $pagerArgs
        }
    }
&quot;</span>;
        }
 
        <b>internal static string</b> <a id="3f95060966cac4c2" href="../R/3f95060966cac4c2.html" target="n" data-glyph="74,1" class="i method">GetMkdirFunctionText</a>()
        {
            <b>return</b> <span class="s">@&quot;
&lt;#
.FORWARDHELPTARGETNAME New-Item
.FORWARDHELPCATEGORY Cmdlet
#&gt;
 
[CmdletBinding(DefaultParameterSetName=&#39;pathSet&#39;,
    SupportsShouldProcess=$true,
    SupportsTransactions=$true,
    ConfirmImpact=&#39;Medium&#39;)]
    [OutputType([System.IO.DirectoryInfo])]
param(
    [Parameter(ParameterSetName=&#39;nameSet&#39;, Position=0, ValueFromPipelineByPropertyName=$true)]
    [Parameter(ParameterSetName=&#39;pathSet&#39;, Mandatory=$true, Position=0, ValueFromPipelineByPropertyName=$true)]
    [System.String[]]
    ${Path},
 
    [Parameter(ParameterSetName=&#39;nameSet&#39;, Mandatory=$true, ValueFromPipelineByPropertyName=$true)]
    [AllowNull()]
    [AllowEmptyString()]
    [System.String]
    ${Name},
 
    [Parameter(ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]
    [System.Object]
    ${Value},
 
    [Switch]
    ${Force},
 
    [Parameter(ValueFromPipelineByPropertyName=$true)]
    [System.Management.Automation.PSCredential]
    ${Credential}
)
 
begin {
    $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand(&#39;New-Item&#39;, [System.Management.Automation.CommandTypes]::Cmdlet)
    $scriptCmd = {&amp; $wrappedCmd -Type Directory @PSBoundParameters }
 
    $steppablePipeline = $scriptCmd.GetSteppablePipeline()
    $steppablePipeline.Begin($PSCmdlet)
}
 
process {
    $steppablePipeline.Process($_)
}
 
end {
    $steppablePipeline.End()
}
 
&quot;</span>;
        }
 
        <b>internal static string</b> <a id="281bdc86fef10031" href="../R/281bdc86fef10031.html" target="n" data-glyph="74,1" class="i method">GetOSTFunctionText</a>()
        {
            <b>return</b> <span class="s">@&quot;
[CmdletBinding()]
param(
    [ValidateRange(2, 2147483647)]
    [int]
    ${Width},
 
    [Parameter(ValueFromPipeline=$true)]
    [psobject]
    ${InputObject})
 
begin {
    $PSBoundParameters[&#39;Stream&#39;] = $true
    $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand(&#39;Out-String&#39;,[System.Management.Automation.CommandTypes]::Cmdlet)
    $scriptCmd = {&amp; $wrappedCmd @PSBoundParameters }
 
    $steppablePipeline = $scriptCmd.GetSteppablePipeline($myInvocation.CommandOrigin)
    $steppablePipeline.Begin($PSCmdlet)
}
 
process {
    $steppablePipeline.Process($_)
}
 
end {
    $steppablePipeline.End()
}
&lt;#
.ForwardHelpTargetName Out-String
.ForwardHelpCategory Cmdlet
#&gt;
&quot;</span>;
        }
 
        <b>internal const</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="b71dc68e025852e1" href="../R/b71dc68e025852e1.html" target="n" data-glyph="8,1" class="i field">DefaultDebugPreference</a> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>;
        <b>internal const</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="696119533aff8946" href="../R/696119533aff8946.html" target="n" data-glyph="8,1" class="i field">DefaultErrorActionPreference</a> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
        <b>internal const</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="336c233a9506636d" href="../R/336c233a9506636d.html" target="n" data-glyph="8,1" class="i field">DefaultProgressPreference</a> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
        <b>internal const</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="bffa8c5f990b643d" href="../R/bffa8c5f990b643d.html" target="n" data-glyph="8,1" class="i field">DefaultVerbosePreference</a> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>;
        <b>internal const</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="ce925c70ad875bb8" href="../R/ce925c70ad875bb8.html" target="n" data-glyph="8,1" class="i field">DefaultWarningPreference</a> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
        <b>internal const</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="3968cbd8e157630a" href="../R/3968cbd8e157630a.html" target="n" data-glyph="8,1" class="i field">DefaultInformationPreference</a> = <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#e5c6f06e809b81d8" class="i field">SilentlyContinue</a>;
 
        <b>internal const</b> <a href="CommandBase.cs.html#6ad61b5ca84237a4" class="t t">ErrorView</a> <a id="79a9f4e24636b639" href="../R/79a9f4e24636b639.html" target="n" data-glyph="8,1" class="i field">DefaultErrorView</a> = <a href="CommandBase.cs.html#6ad61b5ca84237a4" class="t t">ErrorView</a>.<a href="CommandBase.cs.html#ddb866735af3539e" class="i field">ConciseView</a>;
        <b>internal const bool</b> <a id="929c3d342e2d5118" href="../R/929c3d342e2d5118.html" target="n" data-glyph="8,1" class="i field">DefaultWhatIfPreference</a> = <b>false</b>;
        <b>internal const</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <a id="48990b5efe099274" href="../R/48990b5efe099274.html" target="n" data-glyph="8,1" class="i field">DefaultConfirmPreference</a> = <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#903c76852fac275a" class="i field">High</a>;
 
        <b>static</b> <a id="a27a31dd841d336a" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">InitialSessionState</a>()
        {
            <b>var</b> <span id="r520 rd" class="r520 r">builtinVariables</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>&gt;()
            {
                <span class="c">// Engine variables that should be precreated before running profile</span>
                <span class="c">// Bug fix for Win7:2202228 Engine halts if initial command fulls up variable table</span>
                <span class="c">// Anytime a new variable that the engine depends on to run is added, this table</span>
                <span class="c">// must be updated...</span>
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#82b3d4142eac8714" class="i field">LastToken</a>, <b>null</b>, <b>string</b>.<span class="i">Empty</span>),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#f2947960751e5103" class="i field">FirstToken</a>, <b>null</b>, <b>string</b>.<span class="i">Empty</span>),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#e26b5bc296deb24a" class="i field">StackTrace</a>, <b>null</b>, <b>string</b>.<span class="i">Empty</span>),
 
                <span class="c">// Variable which controls the output rendering</span>
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#e63f1bfcb6a78662" class="i field">PSStyle</a>,
                    <a href="../FormatAndOutput/common/PSStyle.cs.html#340d221c8aa09678" class="t t">PSStyle</a>.<a href="../FormatAndOutput/common/PSStyle.cs.html#f7875006d0bc55f1" class="i property">Instance</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">PSStyleDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>),
 
                <span class="c">// Variable which controls the encoding for piping data to a NativeCommand</span>
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#bb5d6096c1674a47" class="i field">OutputEncoding</a>,
                    <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#7a7127f6fafd6bca" class="i field">utf8NoBom</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">OutputEncodingDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Text</span>.<span class="i">Encoding</span>))),
 
                <span class="c">// Preferences</span>
                <span class="c">//</span>
                <span class="c">// NTRAID#Windows Out Of Band Releases-931461-2006/03/13</span>
                <span class="c">// ArgumentTypeConverterAttribute is applied to these variables,</span>
                <span class="c">// but this only reaches the global variable.  If these are</span>
                <span class="c">// redefined in script scope etc, the type conversion</span>
                <span class="c">// is not applicable.</span>
                <span class="c">//</span>
                <span class="c">// Variables typed to ActionPreference</span>
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#1dc6d0b6ca855b5c" class="i field">ConfirmPreference</a>,
                    <a href="#48990b5efe099274" class="i field">DefaultConfirmPreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">ConfirmPreferenceDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#3ecf813aedf13c39" class="i field">DebugPreference</a>,
                    <a href="#b71dc68e025852e1" class="i field">DefaultDebugPreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">DebugPreferenceDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#f4d93c1b717d12cd" class="i field">ErrorActionPreference</a>,
                    <a href="#696119533aff8946" class="i field">DefaultErrorActionPreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">ErrorActionPreferenceDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#017ab5e7aa7f6b46" class="i field">ProgressPreference</a>,
                    <a href="#336c233a9506636d" class="i field">DefaultProgressPreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">ProgressPreferenceDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#59d2623dad9ecb93" class="i field">VerbosePreference</a>,
                    <a href="#bffa8c5f990b643d" class="i field">DefaultVerbosePreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">VerbosePreferenceDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#6a78d87d27cf4dce" class="i field">WarningPreference</a>,
                    <a href="#ce925c70ad875bb8" class="i field">DefaultWarningPreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">WarningPreferenceDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#f3fdc14b8224bdd2" class="i field">InformationPreference</a>,
                    <a href="#3968cbd8e157630a" class="i field">DefaultInformationPreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">InformationPreferenceDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#e005bcbeaa714718" class="i field">ErrorView</a>,
                    <a href="#79a9f4e24636b639" class="i field">DefaultErrorView</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">ErrorViewDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                    <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#6ad61b5ca84237a4" class="t t">ErrorView</a>))),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#6eea7ed6e3e2c9a0" class="i field">NestedPromptLevel</a>,
                    0,
                    <span class="i">RunspaceInit</span>.<span class="i">NestedPromptLevelDescription</span>),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#d7b9d247040f9009" class="i field">WhatIfPreference</a>,
                    <a href="#929c3d342e2d5118" class="i field">DefaultWhatIfPreference</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">WhatIfPreferenceDescription</span>),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="#5f35a6e393befada" class="i field">FormatEnumerationLimit</a>,
                    <a href="#4d3f35f31f97da63" class="i field">DefaultFormatEnumerationLimit</a>,
                    <span class="i">RunspaceInit</span>.<span class="i">FormatEnumerationLimitDescription</span>),
 
                <span class="c">// variable for PSEmailServer</span>
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#0ef41ecd789f13af" class="i field">PSEmailServer</a>,
                    <b>string</b>.<span class="i">Empty</span>,
                    <span class="i">RunspaceInit</span>.<span class="i">PSEmailServerDescription</span>),
 
                <span class="c">// Start: Variables which control remoting behavior</span>
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#079ce7151f202fe2" class="i field">DEFAULT_SESSION_OPTION</a>,
                    <b>new</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#90c789cd47314cbe" class="t constructor">PSSessionOption</a>(),
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">PSDefaultSessionOptionDescription</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#29b2fa6c9fbf2888" class="i field">PSSessionConfigurationName</a>,
                    <span class="s">&quot;http://schemas.microsoft.com/powershell/Microsoft.PowerShell&quot;</span>,
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">PSSessionConfigurationName</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>),
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#a1c6d60fab04f08b" class="i field">PSSessionApplicationName</a>,
                    <span class="s">&quot;wsman&quot;</span>,
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">PSSessionAppName</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>),
                <span class="c">// End: Variables which control remoting behavior</span>
 
                <span class="k preprocess">#</span><span class="k preprocess">region</span> Platform
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#80180eb1827dc6ee" class="i field">IsLinux</a>,
                    <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#99a87a41a4637eed" class="i property">IsLinux</a>,
                    <b>string</b>.<span class="i">Empty</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>),
 
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#1aa45b781285793e" class="i field">IsMacOS</a>,
                    <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#560f200299e30e2b" class="i property">IsMacOS</a>,
                    <b>string</b>.<span class="i">Empty</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>),
 
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#9c0be7f2e9af433d" class="i field">IsWindows</a>,
                    <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#a0395f876114b36d" class="i property">IsWindows</a>,
                    <b>string</b>.<span class="i">Empty</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>),
 
                <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#32bd5546226b1082" class="i field">IsCoreCLR</a>,
                    <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#898d4d8b25dd0230" class="i property">IsCoreCLR</a>,
                    <b>string</b>.<span class="i">Empty</span>,
                    <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>),
                <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
            };
 
            <b>if</b> (<a href="ExperimentalFeature/ExperimentalFeature.cs.html#6626da1ebcb2b206" class="t t">ExperimentalFeature</a>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#e292001e34f610da" class="i method">IsEnabled</a>(<a href="ExperimentalFeature/ExperimentalFeature.cs.html#6626da1ebcb2b206" class="t t">ExperimentalFeature</a>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#4eee14643cf93543" class="i field">PSNativeCommandErrorActionPreferenceFeatureName</a>))
            {
                <span class="r520 r">builtinVariables</span>.<span class="i">Add</span>(
                    <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                        <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#5099c8283070aa0f" class="i field">PSNativeCommandUseErrorActionPreference</a>,
                        <span class="i">value</span>: <b>false</b>,
                        <span class="i">RunspaceInit</span>.<span class="i">PSNativeCommandUseErrorActionPreferenceDescription</span>,
                        <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                        <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<b>bool</b>))));
            }
 
            <b>if</b> (<a href="ExperimentalFeature/ExperimentalFeature.cs.html#6626da1ebcb2b206" class="t t">ExperimentalFeature</a>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#e292001e34f610da" class="i method">IsEnabled</a>(<a href="ExperimentalFeature/ExperimentalFeature.cs.html#6626da1ebcb2b206" class="t t">ExperimentalFeature</a>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#314e0211569fb33f" class="i field">PSNativeCommandArgumentPassingFeatureName</a>))
            {
                <span class="r520 r">builtinVariables</span>.<span class="i">Add</span>(
                    <b>new</b> <span class="t">SessionStateVariableEntry</span>(
                        <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#7877ce393dd494e1" class="i field">NativeArgumentPassing</a>,
                        <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#a0395f876114b36d" class="i property">IsWindows</a> ? <a href="CommandBase.cs.html#4ada58665c21257f" class="t t">NativeArgumentPassingStyle</a>.<a href="CommandBase.cs.html#6f661de747849cb6" class="i field">Windows</a> : <a href="CommandBase.cs.html#4ada58665c21257f" class="t t">NativeArgumentPassingStyle</a>.<a href="CommandBase.cs.html#45d4fb4669438d72" class="i field">Standard</a>,
                        <span class="i">RunspaceInit</span>.<span class="i">NativeCommandArgumentPassingDescription</span>,
                        <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>,
                        <b>new</b> <span class="t">ArgumentTypeConverterAttribute</span>(<b>typeof</b>(<a href="CommandBase.cs.html#4ada58665c21257f" class="t t">NativeArgumentPassingStyle</a>))));
            }
 
            <a href="#522fcdaff0993921" class="i field">BuiltInVariables</a> = <span class="r520 r">builtinVariables</span>.<span class="i">ToArray</span>();
        }
 
        <b>internal static readonly</b> <a href="#e9cb85ffa57e9548" class="t t">SessionStateVariableEntry</a>[] <a id="522fcdaff0993921" href="../R/522fcdaff0993921.html" target="n" data-glyph="44,1" class="i field">BuiltInVariables</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a new array of alias entries everytime it&#39;s called. This</span>
        <span class="c">///</span><span class="c"> can&#39;t be static because the elements may be mutated in different session</span>
        <span class="c">///</span><span class="c"> state objects so each session state must have a copy of the entry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>[] <a id="bfe09e88d9dff691" href="../R/bfe09e88d9dff691.html" target="n" data-glyph="104,1" class="i property">BuiltInAliases</a>
        {
            <b>get</b>
            {
                <span class="c">// Too many AllScope entries hurts performance because an entry is</span>
                <span class="c">// created in each new scope, so we limit the use of AllScope to the</span>
                <span class="c">// most commonly used commands - primarily so command lookup is faster,</span>
                <span class="c">// though if we speed up command lookup significantly, then removing</span>
                <span class="c">// AllScope for all of these aliases makes sense.</span>
 
                <b>const</b> <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r521 rd" class="r521 r">AllScope</span> = <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>;
                <b>const</b> <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r522 rd" class="r522 r">ReadOnly_AllScope</span> = <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>;
                <b>const</b> <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r523 rd" class="r523 r">ReadOnly</span> = <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>;
 
                <b>return</b> <b>new</b> <a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>[] {
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;foreach&quot;</span>, <span class="s">&quot;ForEach-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r522 r">ReadOnly_AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;%&quot;</span>, <span class="s">&quot;ForEach-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r522 r">ReadOnly_AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;where&quot;</span>, <span class="s">&quot;Where-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r522 r">ReadOnly_AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;?&quot;</span>, <span class="s">&quot;Where-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r522 r">ReadOnly_AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;clc&quot;</span>, <span class="s">&quot;Clear-Content&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;cli&quot;</span>, <span class="s">&quot;Clear-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;clp&quot;</span>, <span class="s">&quot;Clear-ItemProperty&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;clv&quot;</span>, <span class="s">&quot;Clear-Variable&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;cpi&quot;</span>, <span class="s">&quot;Copy-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;cvpa&quot;</span>, <span class="s">&quot;Convert-Path&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;dbp&quot;</span>, <span class="s">&quot;Disable-PSBreakpoint&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ebp&quot;</span>, <span class="s">&quot;Enable-PSBreakpoint&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;epal&quot;</span>, <span class="s">&quot;Export-Alias&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;epcsv&quot;</span>, <span class="s">&quot;Export-Csv&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;fl&quot;</span>, <span class="s">&quot;Format-List&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ft&quot;</span>, <span class="s">&quot;Format-Table&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;fw&quot;</span>, <span class="s">&quot;Format-Wide&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gal&quot;</span>, <span class="s">&quot;Get-Alias&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gbp&quot;</span>, <span class="s">&quot;Get-PSBreakpoint&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gc&quot;</span>, <span class="s">&quot;Get-Content&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gci&quot;</span>, <span class="s">&quot;Get-ChildItem&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gcm&quot;</span>, <span class="s">&quot;Get-Command&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gdr&quot;</span>, <span class="s">&quot;Get-PSDrive&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gcs&quot;</span>, <span class="s">&quot;Get-PSCallStack&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ghy&quot;</span>, <span class="s">&quot;Get-History&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gi&quot;</span>, <span class="s">&quot;Get-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gl&quot;</span>, <span class="s">&quot;Get-Location&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gm&quot;</span>, <span class="s">&quot;Get-Member&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gmo&quot;</span>, <span class="s">&quot;Get-Module&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gp&quot;</span>, <span class="s">&quot;Get-ItemProperty&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gpv&quot;</span>, <span class="s">&quot;Get-ItemPropertyValue&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gps&quot;</span>, <span class="s">&quot;Get-Process&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;group&quot;</span>, <span class="s">&quot;Group-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gu&quot;</span>, <span class="s">&quot;Get-Unique&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gv&quot;</span>, <span class="s">&quot;Get-Variable&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;iex&quot;</span>, <span class="s">&quot;Invoke-Expression&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ihy&quot;</span>, <span class="s">&quot;Invoke-History&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ii&quot;</span>, <span class="s">&quot;Invoke-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ipmo&quot;</span>, <span class="s">&quot;Import-Module&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ipal&quot;</span>, <span class="s">&quot;Import-Alias&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ipcsv&quot;</span>, <span class="s">&quot;Import-Csv&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;measure&quot;</span>, <span class="s">&quot;Measure-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;mi&quot;</span>, <span class="s">&quot;Move-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;mp&quot;</span>, <span class="s">&quot;Move-ItemProperty&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;nal&quot;</span>, <span class="s">&quot;New-Alias&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ndr&quot;</span>, <span class="s">&quot;New-PSDrive&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ni&quot;</span>, <span class="s">&quot;New-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;nv&quot;</span>, <span class="s">&quot;New-Variable&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;nmo&quot;</span>, <span class="s">&quot;New-Module&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;oh&quot;</span>, <span class="s">&quot;Out-Host&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rbp&quot;</span>, <span class="s">&quot;Remove-PSBreakpoint&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rdr&quot;</span>, <span class="s">&quot;Remove-PSDrive&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ri&quot;</span>, <span class="s">&quot;Remove-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rni&quot;</span>, <span class="s">&quot;Rename-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rnp&quot;</span>, <span class="s">&quot;Rename-ItemProperty&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rp&quot;</span>, <span class="s">&quot;Remove-ItemProperty&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rmo&quot;</span>, <span class="s">&quot;Remove-Module&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rv&quot;</span>, <span class="s">&quot;Remove-Variable&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gerr&quot;</span>, <span class="s">&quot;Get-Error&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rvpa&quot;</span>, <span class="s">&quot;Resolve-Path&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sal&quot;</span>, <span class="s">&quot;Set-Alias&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sbp&quot;</span>, <span class="s">&quot;Set-PSBreakpoint&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;select&quot;</span>, <span class="s">&quot;Select-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r522 r">ReadOnly_AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;si&quot;</span>, <span class="s">&quot;Set-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sl&quot;</span>, <span class="s">&quot;Set-Location&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sp&quot;</span>, <span class="s">&quot;Set-ItemProperty&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;saps&quot;</span>, <span class="s">&quot;Start-Process&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;spps&quot;</span>, <span class="s">&quot;Stop-Process&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sv&quot;</span>, <span class="s">&quot;Set-Variable&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <span class="c">// Web cmdlets aliases</span>
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;irm&quot;</span>, <span class="s">&quot;Invoke-RestMethod&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;iwr&quot;</span>, <span class="s">&quot;Invoke-WebRequest&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
<span class="c">// Porting note: #if !UNIX is used to disable aliases for cmdlets which conflict with Linux / macOS</span>
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                    <span class="c">// ac is a native command on macOS</span>
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ac&quot;</span>, <span class="s">&quot;Add-Content&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;clear&quot;</span>, <span class="s">&quot;Clear-Host&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;compare&quot;</span>, <span class="s">&quot;Compare-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;cpp&quot;</span>, <span class="s">&quot;Copy-ItemProperty&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;diff&quot;</span>, <span class="s">&quot;Compare-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;gsv&quot;</span>, <span class="s">&quot;Get-Service&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sleep&quot;</span>, <span class="s">&quot;Start-Sleep&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sort&quot;</span>, <span class="s">&quot;Sort-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;start&quot;</span>, <span class="s">&quot;Start-Process&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;sasv&quot;</span>, <span class="s">&quot;Start-Service&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;spsv&quot;</span>, <span class="s">&quot;Stop-Service&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;tee&quot;</span>, <span class="s">&quot;Tee-Object&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;write&quot;</span>, <span class="s">&quot;Write-Output&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <span class="c">// These were transferred from the &quot;transferred from the profile&quot; section</span>
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;cat&quot;</span>, <span class="s">&quot;Get-Content&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;cp&quot;</span>, <span class="s">&quot;Copy-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;ls&quot;</span>, <span class="s">&quot;Get-ChildItem&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;man&quot;</span>, <span class="s">&quot;help&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;mount&quot;</span>, <span class="s">&quot;New-PSDrive&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;mv&quot;</span>, <span class="s">&quot;Move-Item&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;ps&quot;</span>, <span class="s">&quot;Get-Process&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;rm&quot;</span>, <span class="s">&quot;Remove-Item&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;rmdir&quot;</span>, <span class="s">&quot;Remove-Item&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;cnsn&quot;</span>, <span class="s">&quot;Connect-PSSession&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;dnsn&quot;</span>, <span class="s">&quot;Disconnect-PSSession&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;ogv&quot;</span>, <span class="s">&quot;Out-GridView&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;shcm&quot;</span>, <span class="s">&quot;Show-Command&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                    <span class="c">// Bash built-ins we purposefully keep even if they override native commands</span>
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;cd&quot;</span>, <span class="s">&quot;Set-Location&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;dir&quot;</span>, <span class="s">&quot;Get-ChildItem&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;echo&quot;</span>, <span class="s">&quot;Write-Output&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;fc&quot;</span>, <span class="s">&quot;Format-Custom&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;kill&quot;</span>, <span class="s">&quot;Stop-Process&quot;</span>),
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;pwd&quot;</span>, <span class="s">&quot;Get-Location&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;type&quot;</span>, <span class="s">&quot;Get-Content&quot;</span>),
<span class="c">// #if !CORECLR is used to disable aliases for cmdlets which are not available on OneCore or not appropriate for PSCore6 due to conflicts</span>
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span>
<span class="e">                    new SessionStateAliasEntry(&quot;gwmi&quot;, &quot;Get-WmiObject&quot;, string.Empty, ReadOnly),
                    new SessionStateAliasEntry(&quot;iwmi&quot;, &quot;Invoke-WMIMethod&quot;, string.Empty, ReadOnly),
                    new SessionStateAliasEntry(&quot;ise&quot;, &quot;powershell_ise.exe&quot;, string.Empty, ReadOnly),
                    new SessionStateAliasEntry(&quot;rwmi&quot;, &quot;Remove-WMIObject&quot;, string.Empty, ReadOnly),
                    new SessionStateAliasEntry(&quot;sc&quot;, &quot;Set-Content&quot;, string.Empty, ReadOnly),
                    new SessionStateAliasEntry(&quot;swmi&quot;, &quot;Set-WMIInstance&quot;, string.Empty, ReadOnly),
                    new SessionStateAliasEntry(&quot;trcm&quot;, &quot;Trace-Command&quot;, string.Empty, ReadOnly),
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
                    <span class="c">// Aliases transferred from the profile</span>
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;h&quot;</span>, <span class="s">&quot;Get-History&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;history&quot;</span>, <span class="s">&quot;Get-History&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;md&quot;</span>, <span class="s">&quot;mkdir&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;popd&quot;</span>, <span class="s">&quot;Pop-Location&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;pushd&quot;</span>, <span class="s">&quot;Push-Location&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;r&quot;</span>, <span class="s">&quot;Invoke-History&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;cls&quot;</span>, <span class="s">&quot;Clear-Host&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;chdir&quot;</span>, <span class="s">&quot;Set-Location&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;copy&quot;</span>, <span class="s">&quot;Copy-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;del&quot;</span>, <span class="s">&quot;Remove-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;erase&quot;</span>, <span class="s">&quot;Remove-Item&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;move&quot;</span>, <span class="s">&quot;Move-Item&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r521 r">AllScope</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;rd&quot;</span>, <span class="s">&quot;Remove-Item&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;ren&quot;</span>, <span class="s">&quot;Rename-Item&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;set&quot;</span>, <span class="s">&quot;Set-Variable&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;icm&quot;</span>, <span class="s">&quot;Invoke-Command&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;clhy&quot;</span>, <span class="s">&quot;Clear-History&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <span class="c">// Job Specific aliases</span>
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;gjb&quot;</span>, <span class="s">&quot;Get-Job&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;rcjb&quot;</span>, <span class="s">&quot;Receive-Job&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;rjb&quot;</span>, <span class="s">&quot;Remove-Job&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;sajb&quot;</span>, <span class="s">&quot;Start-Job&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;spjb&quot;</span>, <span class="s">&quot;Stop-Job&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;wjb&quot;</span>, <span class="s">&quot;Wait-Job&quot;</span>),
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span>
<span class="e">                    new SessionStateAliasEntry(&quot;sujb&quot;, &quot;Suspend-Job&quot;),
                    new SessionStateAliasEntry(&quot;rujb&quot;, &quot;Resume-Job&quot;),
                    // Remoting Cmdlets Specific aliases
                    new SessionStateAliasEntry(&quot;npssc&quot;, &quot;New-PSSessionConfigurationFile&quot;, string.Empty, ReadOnly),
                    new SessionStateAliasEntry(&quot;ipsn&quot;, &quot;Import-PSSession&quot;),
                    new SessionStateAliasEntry(&quot;epsn&quot;, &quot;Export-PSSession&quot;),
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;nsn&quot;</span>, <span class="s">&quot;New-PSSession&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;gsn&quot;</span>, <span class="s">&quot;Get-PSSession&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;rsn&quot;</span>, <span class="s">&quot;Remove-PSSession&quot;</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;etsn&quot;</span>, <span class="s">&quot;Enter-PSSession&quot;</span>),
                    <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="s">&quot;rcsn&quot;</span>, <span class="s">&quot;Receive-PSSession&quot;</span>, <b>string</b>.<span class="i">Empty</span>, <span class="r523 r">ReadOnly</span>),
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;exsn&quot;</span>, <span class="s">&quot;Exit-PSSession&quot;</span>),
                    <span class="c">// Win8: 121662/169179 Add &quot;sls&quot; alias for Select-String cmdlet</span>
                    <span class="c">//   - do not use AllScope - this causes errors in profiles that set this somewhat commonly used alias.</span>
                    <b>new</b> <a href="#4bd20ec48e504a74" class="t constructor">SessionStateAliasEntry</a>(<span class="s">&quot;sls&quot;</span>, <span class="s">&quot;Select-String&quot;</span>),
                };
            }
        }
 
        <b>internal const string</b> <a id="e7d42b444a6c9bfe" href="../R/e7d42b444a6c9bfe.html" target="n" data-glyph="8,1" class="i field">DefaultPromptFunctionText</a> = <span class="s">@&quot;
&quot;&quot;PS $($executionContext.SessionState.Path.CurrentLocation)$(&#39;&gt;&#39; * ($nestedPromptLevel + 1)) &quot;&quot;;
# .Link
# https://go.microsoft.com/fwlink/?LinkID=225750
# .ExternalHelp System.Management.Automation.dll-help.xml
&quot;</span>;
 
        <b>internal const string</b> <a id="5ac705b531ee22e0" href="../R/5ac705b531ee22e0.html" target="n" data-glyph="8,1" class="i field">DefaultSetDriveFunctionText</a> = <span class="s">&quot;Set-Location $MyInvocation.MyCommand.Name&quot;</span>;
 
        <b>internal static readonly</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="806cfb73b9b08cb5" href="../R/806cfb73b9b08cb5.html" target="n" data-glyph="44,1" class="i field">SetDriveScriptBlock</a> = <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#5855871887dc8453" class="i method">CreateDelayParsedScriptBlock</a>(<a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <span class="r524 r">isProductCode</span>: <b>true</b>);
 
        <b>private static readonly</b> <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="50080bfd1902bea0" href="../R/50080bfd1902bea0.html" target="n" data-glyph="46,1" class="i field">systemLanguageMode</a> = (<a href="../security/wldpNativeMethods.cs.html#6b51558a7a8cde26" class="t t">SystemPolicy</a>.<a href="../security/wldpNativeMethods.cs.html#2c0da8883146dab2" class="i method">GetSystemLockdownPolicy</a>() == <a href="../security/wldpNativeMethods.cs.html#9f0915f7b351778e" class="t t">SystemEnforcementMode</a>.<a href="../security/wldpNativeMethods.cs.html#5d74206001d0b817" class="i field">Enforce</a>) ? <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a> : <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
 
        <b>internal static readonly</b> <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>[] <a id="5dd8211b20a972f7" href="../R/5dd8211b20a972f7.html" target="n" data-glyph="44,1" class="i field">BuiltInFunctions</a> = <b>new</b> <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>[]
        {
           <span class="c">// Functions that don&#39;t require full language mode</span>
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;cd..&quot;</span>, <span class="s">&quot;Set-Location ..&quot;</span>, <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="#50080bfd1902bea0" class="i field">systemLanguageMode</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;cd\\&quot;</span>, <span class="s">&quot;Set-Location \\&quot;</span>, <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="#50080bfd1902bea0" class="i field">systemLanguageMode</a>),
            <span class="c">// Win8: 320909. Retaining the original definition to ensure backward compatability.</span>
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<span class="i">GetDelayParsedFunctionEntry</span>(<span class="s">&quot;Pause&quot;</span>,
                <b>string</b>.<span class="i">Concat</span>(<span class="s">&quot;$null = Read-Host &#39;&quot;</span>, <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<span class="i">EscapeSingleQuotedStringContent</span>(<span class="i">RunspaceInit</span>.<span class="i">PauseDefinitionString</span>), <span class="s">&quot;&#39;&quot;</span>), <span class="i">isProductCode</span>: <b>true</b>, <span class="i">languageMode</span>: <a href="#50080bfd1902bea0" class="i field">systemLanguageMode</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;help&quot;</span>, <a href="#5b774e720f2875d4" class="i method">GetHelpPagingFunctionText</a>(), <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="#50080bfd1902bea0" class="i field">systemLanguageMode</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;prompt&quot;</span>, <a href="#e7d42b444a6c9bfe" class="i field">DefaultPromptFunctionText</a>, <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="#50080bfd1902bea0" class="i field">systemLanguageMode</a>),
 
            <span class="c">// Functions that require full language mode and are trusted</span>
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;Clear-Host&quot;</span>, <a href="#602c55768af7f5e7" class="i method">GetClearHostFunctionText</a>(), <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;TabExpansion2&quot;</span>, <a href="#92dfd636251cdb45" class="i field">s_tabExpansionFunctionText</a>, <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;oss&quot;</span>, <a href="#281bdc86fef10031" class="i method">GetOSTFunctionText</a>(), <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>),
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <span class="c">// Porting note: we remove mkdir on Linux because of a conflict</span>
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#bac9a5c925503f9b" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;mkdir&quot;</span>, <a href="#3f95060966cac4c2" class="i method">GetMkdirFunctionText</a>(), <span class="r77 r">isProductCode</span>: <b>true</b>, <span class="r78 r">languageMode</span>: <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>),
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <span class="c">// Porting note: we remove the drive functions from Linux because they make no sense in that environment</span>
            <span class="c">// Default drives</span>
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;A:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;B:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;C:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;D:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;E:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;F:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;G:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;H:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;I:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;J:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;K:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;L:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;M:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;N:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;O:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;P:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;Q:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;R:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;S:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;T:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;U:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;V:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;W:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;X:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;Y:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>),
            <a href="#24449f380379f027" class="t t">SessionStateFunctionEntry</a>.<a href="#d074067fb6fc9051" class="i method">GetDelayParsedFunctionEntry</a>(<span class="s">&quot;Z:&quot;</span>, <a href="#5ac705b531ee22e0" class="i field">DefaultSetDriveFunctionText</a>, <a href="#806cfb73b9b08cb5" class="i field">SetDriveScriptBlock</a>)
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        };
 
        <b>internal static void</b> <a id="15f40fcb70b722f7" href="../R/15f40fcb70b722f7.html" target="n" data-glyph="74,1" class="i method">RemoveAllDrivesForProvider</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r525 rd" class="r525 r">pi</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r526 rd" class="r526 r">ssi</span>)
        {
            <b>foreach</b> (<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r527 rd" class="r527 r">di</span> <b>in</b> <span class="r526 r">ssi</span>.<a href="SessionStateDriveAPIs.cs.html#4a709421313fe1ad" class="i method">GetDrivesForProvider</a>(<span class="r525 r">pi</span>.<a href="DataStoreAdapterProvider.cs.html#91a8d08ee3ba5a61" class="i property">FullName</a>))
            {
                <b>try</b>
                {
                    <span class="r526 r">ssi</span>.<a href="SessionStateDriveAPIs.cs.html#efe8494b1eb76744" class="i method">RemoveDrive</a>(<span class="r527 r">di</span>, <b>true</b>, <b>null</b>);
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                }
            }
        }
 
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="04af3fc88e7d089a" href="../R/04af3fc88e7d089a.html" target="n" data-glyph="46,1" class="i field">s_PSSnapInTracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#24b0f68d5add3eb3" class="i method">GetTracer</a>(<span class="s">&quot;PSSnapInLoadUnload&quot;</span>, <span class="s">&quot;Loading and unloading mshsnapins&quot;</span>, <b>false</b>);
 
        <b>internal static readonly string</b> <a id="98d20723748cfbf6" href="../R/98d20723748cfbf6.html" target="n" data-glyph="44,1" class="i field">CoreSnapin</a> = <span class="s">&quot;Microsoft.PowerShell.Core&quot;</span>;
        <b>internal static readonly string</b> <a id="b79f06e1ca564512" href="../R/b79f06e1ca564512.html" target="n" data-glyph="44,1" class="i field">CoreModule</a> = <span class="s">&quot;Microsoft.PowerShell.Core&quot;</span>;
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <a id="63420b5d815e7587" href="../R/63420b5d815e7587.html" target="n" data-glyph="44,1" class="i field">defaultSnapins</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt;();
 
        <span class="c">// The list of engine modules to create warnings when you try to remove them</span>
        <b>internal static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="b3b528389a386e63" href="../R/b3b528389a386e63.html" target="n" data-glyph="44,1" class="i field">EngineModules</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                <span class="s">&quot;Microsoft.PowerShell.Utility&quot;</span>,
                <span class="s">&quot;Microsoft.PowerShell.Management&quot;</span>,
                <span class="s">&quot;Microsoft.PowerShell.Diagnostics&quot;</span>,
                <span class="s">&quot;Microsoft.PowerShell.Host&quot;</span>,
                <span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>,
                <span class="s">&quot;Microsoft.WSMan.Management&quot;</span>
            };
 
        <b>internal static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="acfd49442ea85a4e" href="../R/acfd49442ea85a4e.html" target="n" data-glyph="44,1" class="i field">NestedEngineModules</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                <span class="s">&quot;Microsoft.PowerShell.Commands.Utility&quot;</span>,
                <span class="s">&quot;Microsoft.PowerShell.Commands.Management&quot;</span>,
                <span class="s">&quot;Microsoft.PowerShell.Commands.Diagnostics&quot;</span>,
                <span class="s">&quot;Microsoft.PowerShell.ConsoleHost&quot;</span>
            };
 
        <b>internal static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="cf4f1d248b979d75" href="../R/cf4f1d248b979d75.html" target="n" data-glyph="44,1" class="i field">EngineModuleNestedModuleMapping</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                { <span class="s">&quot;Microsoft.PowerShell.Utility&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Utility&quot;</span>},
                { <span class="s">&quot;Microsoft.PowerShell.Management&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Management&quot;</span>},
                { <span class="s">&quot;Microsoft.PowerShell.Diagnostics&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Diagnostics&quot;</span>},
                { <span class="s">&quot;Microsoft.PowerShell.Host&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.ConsoleHost&quot;</span>},
            };
 
        <b>internal static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="eb45b4c46816632c" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">NestedModuleEngineModuleMapping</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                { <span class="s">&quot;Microsoft.PowerShell.Commands.Utility&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Utility&quot;</span>},
                { <span class="s">&quot;Microsoft.PowerShell.Commands.Management&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Management&quot;</span>},
                { <span class="s">&quot;Microsoft.PowerShell.Commands.Diagnostics&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Diagnostics&quot;</span>},
                { <span class="s">&quot;Microsoft.PowerShell.ConsoleHost&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Host&quot;</span>},
                { <span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>},
                { <span class="s">&quot;Microsoft.WSMan.Management&quot;</span>, <span class="s">&quot;Microsoft.WSMan.Management&quot;</span>},
            };
 
        <span class="c">// The list of engine modules that we will not allow users to remove</span>
        <b>internal static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="abc33d152fda84b1" href="../R/abc33d152fda84b1.html" target="n" data-glyph="44,1" class="i field">ConstantEngineModules</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                <a href="#b79f06e1ca564512" class="i field">CoreModule</a>,
            };
 
        <span class="c">// The list of nested engine modules that we will not allow users to remove</span>
        <b>internal static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="2bbb609913ad2675" href="../R/2bbb609913ad2675.html" target="n" data-glyph="44,1" class="i field">ConstantEngineNestedModules</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                <span class="s">&quot;System.Management.Automation&quot;</span>,
            };
 
        <b>internal static string</b> <a id="fcd5235df79af3f8" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetNestedModuleDllName</a>(<b>string</b> <span id="r528 rd" class="r528 r">moduleName</span>)
        {
            <b>string</b> <span id="r529 rd" class="r529 r">result</span> = <b>null</b>;
 
            <b>if</b> (!<a href="#cf4f1d248b979d75" class="i field">EngineModuleNestedModuleMapping</a>.<span class="i">TryGetValue</span>(<span class="r528 r">moduleName</span>, <b>out</b> <span class="r529 r">result</span>))
            {
                <span class="r529 r">result</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>return</b> <span class="r529 r">result</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Set of helper methods fro loading assemblies containing cmdlets...</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="d3c7a3a0a3314c6f" href="../R/d3c7a3a0a3314c6f.html" target="n" data-glyph="2,0" class="t t">PSSnapInHelpers</a>
    {
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2001:AvoidCallingProblematicMethods&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;System.Reflection.Assembly.LoadFrom&quot;</span>)]
        <b>internal static</b> <span class="i">Assembly</span> <a id="fc1f929f2722ffe3" href="../R/fc1f929f2722ffe3.html" target="n" data-glyph="74,1" class="i method">LoadPSSnapInAssembly</a>(<a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r530 rd" class="r530 r">psSnapInInfo</span>)
        {
            <span class="i">Assembly</span> <span id="r531 rd" class="r531 r">assembly</span> = <b>null</b>;
            <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Loading assembly from GAC. Assembly Name: {0}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>);
 
            <b>try</b>
            {
                <span class="r531 r">assembly</span> = <span class="i">Assembly</span>.<span class="i">Load</span>(<b>new</b> <span class="i">AssemblyName</span>(<span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>));
            }
            <b>catch</b> (<span class="i">BadImageFormatException</span> <span id="r532 rd" class="r532 r">e</span>)
            {
                <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">TraceWarning</span>(<span class="s">&quot;Not able to load assembly {0}: {1}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="r532 r">e</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">FileNotFoundException</span> <span id="r533 rd" class="r533 r">e</span>)
            {
                <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">TraceWarning</span>(<span class="s">&quot;Not able to load assembly {0}: {1}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="r533 r">e</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">FileLoadException</span> <span id="r534 rd" class="r534 r">e</span>)
            {
                <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">TraceWarning</span>(<span class="s">&quot;Not able to load assembly {0}: {1}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="r534 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>if</b> (<span class="r531 r">assembly</span> != <b>null</b>)
            {
                <b>return</b> <span class="r531 r">assembly</span>;
            }
 
            <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Loading assembly from path: {0}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>);
 
            <b>try</b>
            {
                <span class="i">AssemblyName</span> <span id="r535 rd" class="r535 r">assemblyName</span> = <span class="i">AssemblyName</span>.<span class="i">GetAssemblyName</span>(<span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#129cc76c8c0bf832" class="i property">AbsoluteModulePath</a>);
 
                <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r535 r">assemblyName</span>.<span class="i">FullName</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>string</b> <span id="r536 rd" class="r536 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ConsoleInfoErrorStrings</span>.<span class="i">PSSnapInAssemblyNameMismatch</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#129cc76c8c0bf832" class="i property">AbsoluteModulePath</a>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>);
                    <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="r536 r">message</span>);
                    <b>throw</b> <b>new</b> <a href="../singleshell/config/MshSnapinLoadException.cs.html#06c1289faddb818b" class="t constructor">PSSnapInException</a>(<span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>, <span class="r536 r">message</span>);
                }
 
                <span class="r531 r">assembly</span> = <span class="i">Assembly</span>.<span class="i">LoadFrom</span>(<span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#129cc76c8c0bf832" class="i property">AbsoluteModulePath</a>);
            }
            <b>catch</b> (<span class="i">FileLoadException</span> <span id="r537 rd" class="r537 r">e</span>)
            {
                <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Not able to load assembly {0}: {1}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="r537 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSSnapInException</span>(<span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>, <span class="r537 r">e</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">BadImageFormatException</span> <span id="r538 rd" class="r538 r">e</span>)
            {
                <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Not able to load assembly {0}: {1}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="r538 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSSnapInException</span>(<span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>, <span class="r538 r">e</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">FileNotFoundException</span> <span id="r539 rd" class="r539 r">e</span>)
            {
                <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Not able to load assembly {0}: {1}&quot;</span>, <span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ad98c4c4a02154bb" class="i property">AssemblyName</a>, <span class="r539 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSSnapInException</span>(<span class="r530 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>, <span class="r539 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>return</b> <span class="r531 r">assembly</span>;
        }
 
        <b>private static bool</b> <a id="a228cad8f399fd7d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">TryGetCustomAttribute</a>&lt;<span id="r540 rd t" class="r540 r t">T</span>&gt;(<span class="i">Type</span> <span id="r541 rd" class="r541 r">decoratedType</span>, <b>out</b> <span class="r540 r t">T</span> <span id="r542 rd" class="r542 r">attribute</span>) <b>where</b> <span class="r540 r t">T</span> : <span class="i">Attribute</span>
        {
            <b>var</b> <span id="r543 rd" class="r543 r">attributes</span> = <span class="r541 r">decoratedType</span>.<span class="i">GetCustomAttributes</span>&lt;<span class="r540 r t">T</span>&gt;(<span class="i">inherit</span>: <b>false</b>);
            <span class="r542 r">attribute</span> = <span class="r543 r">attributes</span>.<span class="i">FirstOrDefault</span>();
            <b>return</b> <span class="r542 r">attribute</span> != <b>null</b>;
        }
 
        <b>internal static void</b> <a id="da146dc0f1032bdf" href="../R/da146dc0f1032bdf.html" target="n" data-glyph="74,1" class="i method">AnalyzePSSnapInAssembly</a>(
            <span class="i">Assembly</span> <span id="r544 rd" class="r544 r">assembly</span>,
            <b>string</b> <span id="r545 rd" class="r545 r">name</span>,
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r513 rd" class="r513 r">psSnapInInfo</span>,
            <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r483 rd" class="r483 r">moduleInfo</span>,
            <b>out</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt; <span id="r546 rd" class="r546 r">cmdlets</span>,
            <b>out</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt; <span id="r547 rd" class="r547 r">aliases</span>,
            <b>out</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <span id="r548 rd" class="r548 r">providers</span>,
            <b>out string</b> <span id="r514 rd" class="r514 r">helpFile</span>)
        {
            <span class="r514 r">helpFile</span> = <b>null</b>;
            <b>if</b> (<span class="r544 r">assembly</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r544 r">assembly</span>));
            }
 
            <span class="r546 r">cmdlets</span> = <b>null</b>;
            <span class="r547 r">aliases</span> = <b>null</b>;
            <span class="r548 r">providers</span> = <b>null</b>;
 
            <span class="c">// See if this assembly has already been scanned...</span>
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt;&gt; <span id="r549 rd" class="r549 r">cachedCmdlets</span>;
            <b>if</b> (<a href="#ceac48876c99cbde" class="i field">s_cmdletCache</a>.<span class="i">Value</span>.<span class="i">TryGetValue</span>(<span class="r544 r">assembly</span>, <b>out</b> <span class="r549 r">cachedCmdlets</span>))
            {
                <span class="r546 r">cmdlets</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt;(<span class="r549 r">cachedCmdlets</span>.<span class="i">Count</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <span class="r547 r">aliases</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt;(<span class="r549 r">cachedCmdlets</span>.<span class="i">Count</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                <b>foreach</b> (<b>var</b> <span id="r550 rd" class="r550 r">pair</span> <b>in</b> <span class="r549 r">cachedCmdlets</span>)
                {
                    <b>var</b> <span id="r551 rd" class="r551 r">key</span> = <span class="r550 r">pair</span>.<span class="i">Key</span>;
                    <b>var</b> <span id="r552 rd" class="r552 r">entry</span> = <span class="r550 r">pair</span>.<span class="i">Value</span>;
                    <b>if</b> (<span class="r552 r">entry</span>.<span class="i">Item1</span>.<span class="i">PSSnapIn</span> == <b>null</b> &amp;&amp; <span class="r513 r">psSnapInInfo</span> != <b>null</b>)
                    {
                        <span class="r552 r">entry</span>.<span class="i">Item1</span>.<span class="i">SetPSSnapIn</span>(<span class="r513 r">psSnapInInfo</span>);
                    }
 
                    <a href="#0b9bc88597e005fb" class="k">var</a> <span id="r553 rd" class="r553 r">newEntry</span> = (<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>)<span class="r552 r">entry</span>.<span class="i">Item1</span>.<span class="i">Clone</span>();
                    <b>if</b> (<span class="r553 r">newEntry</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a> != <b>null</b> &amp;&amp; <span class="r513 r">psSnapInInfo</span> == <b>null</b>)
                    {
                        <span class="r553 r">newEntry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<b>null</b>);
                    }
 
                    <span class="r546 r">cmdlets</span>[<span class="r551 r">key</span>] = <span class="r553 r">newEntry</span>;
 
                    <b>if</b> (<span class="r552 r">entry</span>.<span class="i">Item2</span> != <b>null</b>)
                    {
                        <b>var</b> <span id="r554 rd" class="r554 r">aliasList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;();
                        <b>foreach</b> (<b>var</b> <span id="r555 rd" class="r555 r">alias</span> <b>in</b> <span class="r552 r">entry</span>.<span class="i">Item2</span>)
                        {
                            <b>if</b> (<span class="r555 r">alias</span>.<span class="i">PSSnapIn</span> == <b>null</b> &amp;&amp; <span class="r513 r">psSnapInInfo</span> != <b>null</b>)
                            {
                                <span class="r555 r">alias</span>.<span class="i">SetPSSnapIn</span>(<span class="r513 r">psSnapInInfo</span>);
                            }
 
                            <a href="#3164e16488ced1ed" class="k">var</a> <span id="r556 rd" class="r556 r">newAliasEntry</span> = (<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>)<span class="r555 r">alias</span>.<span class="i">Clone</span>();
                            <b>if</b> (<span class="r556 r">newAliasEntry</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a> != <b>null</b> &amp;&amp; <span class="r513 r">psSnapInInfo</span> == <b>null</b>)
                            {
                                <span class="r556 r">newAliasEntry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<b>null</b>);
                            }
 
                            <span class="r554 r">aliasList</span>.<span class="i">Add</span>(<span class="r556 r">newAliasEntry</span>);
                        }
 
                        <span class="r547 r">aliases</span>[<span class="r551 r">key</span>] = <span class="r554 r">aliasList</span>;
                    }
                }
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <span id="r557 rd" class="r557 r">cachedProviders</span>;
            <b>if</b> (<a href="#337195dc88d7b05a" class="i field">s_providerCache</a>.<span class="i">Value</span>.<span class="i">TryGetValue</span>(<span class="r544 r">assembly</span>, <b>out</b> <span class="r557 r">cachedProviders</span>))
            {
                <span class="r548 r">providers</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt;(<a href="#337195dc88d7b05a" class="i field">s_providerCache</a>.<span class="i">Value</span>.<span class="i">Count</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>foreach</b> (<b>var</b> <span id="r558 rd" class="r558 r">pair</span> <b>in</b> <span class="r557 r">cachedProviders</span>)
                {
                    <b>var</b> <span id="r559 rd" class="r559 r">key</span> = <span class="r558 r">pair</span>.<span class="i">Key</span>;
                    <b>var</b> <span id="r560 rd" class="r560 r">entry</span> = <span class="r558 r">pair</span>.<span class="i">Value</span>;
                    <b>if</b> (<span class="r560 r">entry</span>.<span class="i">PSSnapIn</span> == <b>null</b> &amp;&amp; <span class="r513 r">psSnapInInfo</span> != <b>null</b>)
                    {
                        <span class="r560 r">entry</span>.<span class="i">SetPSSnapIn</span>(<span class="r513 r">psSnapInInfo</span>);
                    }
 
                    <a href="#236a07b6fd3f0e39" class="k">var</a> <span id="r561 rd" class="r561 r">newEntry</span> = (<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>)<span class="r560 r">entry</span>.<span class="i">Clone</span>();
                    <b>if</b> (<span class="r561 r">newEntry</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a> != <b>null</b> &amp;&amp; <span class="r513 r">psSnapInInfo</span> == <b>null</b>)
                    {
                        <span class="r561 r">newEntry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<b>null</b>);
                    }
 
                    <span class="r548 r">providers</span>[<span class="r559 r">key</span>] = <span class="r561 r">newEntry</span>;
                }
            }
 
            <b>string</b> <span id="r562 rd" class="r562 r">assemblyPath</span> = <span class="r544 r">assembly</span>.<span class="i">Location</span>;
            <b>if</b> (<span class="r546 r">cmdlets</span> != <b>null</b> || <span class="r548 r">providers</span> != <b>null</b>)
            {
                <b>if</b> (!<a href="#bec470eac5992d02" class="i field">s_assembliesWithModuleInitializerCache</a>.<span class="i">Value</span>.<span class="i">ContainsKey</span>(<span class="r544 r">assembly</span>))
                {
                    <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Returning cached cmdlet and provider entries for {0}&quot;</span>, <span class="r562 r">assemblyPath</span>);
                    <b>return</b>;
                }
                <b>else</b>
                {
                    <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Executing IModuleAssemblyInitializer.Import for {0}&quot;</span>, <span class="r562 r">assemblyPath</span>);
                    <b>var</b> <span id="r563 rd" class="r563 r">assemblyTypes</span> = <a href="#463ed3c09a8737cd" class="i method">GetAssemblyTypes</a>(<span class="r544 r">assembly</span>, <span class="r545 r">name</span>);
                    <a href="#2ebebe0d3caee9cf" class="i method">ExecuteModuleInitializer</a>(<span class="r544 r">assembly</span>, <span class="r563 r">assemblyTypes</span>);
                    <b>return</b>;
                }
            }
 
            <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Analyzing assembly {0} for cmdlet and providers&quot;</span>, <span class="r562 r">assemblyPath</span>);
            <span class="r514 r">helpFile</span> = <a href="#1bf21456755fe960" class="i method">GetHelpFile</a>(<span class="r562 r">assemblyPath</span>);
 
            <b>if</b> (<span class="r513 r">psSnapInInfo</span> != <b>null</b> &amp;&amp; <span class="r513 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>.<span class="i">Equals</span>(<a href="#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="#98d20723748cfbf6" class="i field">CoreSnapin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#5ff642a1bbe25993" class="i method">InitializeCoreCmdletsAndProviders</a>(<span class="r513 r">psSnapInInfo</span>, <b>out</b> <span class="r546 r">cmdlets</span>, <b>out</b> <span class="r548 r">providers</span>, <span class="r514 r">helpFile</span>);
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <span class="c">// Make sure the pre-built cmdlet and provider tables match what reflection finds.  This will help</span>
                <span class="c">// avoid issues where you add a cmdlet but forget to update the table in InitializeCoreCmdletsAndProviders.</span>
 
                <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt; <span id="r564 rd" class="r564 r">cmdletsCheck</span> = <b>null</b>;
                <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <span id="r565 rd" class="r565 r">providersCheck</span> = <b>null</b>;
                <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt; <span id="r566 rd" class="r566 r">aliasesCheck</span> = <b>null</b>;
                <a href="#b815982f08e69af9" class="i method">AnalyzeModuleAssemblyWithReflection</a>(<span class="r544 r">assembly</span>, <span class="r545 r">name</span>, <span class="r513 r">psSnapInInfo</span>, <span class="r483 r">moduleInfo</span>, <span class="r514 r">helpFile</span>, <b>ref</b> <span class="r564 r">cmdletsCheck</span>, <b>ref</b> <span class="r566 r">aliasesCheck</span>, <b>ref</b> <span class="r565 r">providersCheck</span>);
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r566 r">aliasesCheck</span> == <b>null</b>, <span class="s">&quot;InitializeCoreCmdletsAndProviders assumes no aliases are defined in System.Management.Automation.dll&quot;</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r565 r">providersCheck</span>.<span class="i">Count</span> == <span class="r548 r">providers</span>.<span class="i">Count</span>, <span class="s">&quot;new Provider added to System.Management.Automation.dll - update InitializeCoreCmdletsAndProviders&quot;</span>);
                <b>foreach</b> (<b>var</b> <span id="r567 rd" class="r567 r">pair</span> <b>in</b> <span class="r565 r">providersCheck</span>)
                {
                    <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r568 rd" class="r568 r">other</span>;
                    <b>if</b> (<span class="r548 r">providers</span>.<span class="i">TryGetValue</span>(<span class="r567 r">pair</span>.<span class="i">Key</span>, <b>out</b> <span class="r568 r">other</span>))
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<b>object</b>)<span class="r567 r">pair</span>.<span class="i">Value</span>.<span class="i">HelpFileName</span> == (<b>object</b>)<span class="r568 r">other</span>.<a href="#ec3922c91455de72" class="i property">HelpFileName</a>, <span class="s">&quot;Pre-generated Provider help file incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r567 r">pair</span>.<span class="i">Value</span>.<span class="i">ImplementingType</span> == <span class="r568 r">other</span>.<a href="#bcdd2ec5da2607ba" class="i property">ImplementingType</a>, <span class="s">&quot;Pre-generated Provider implementing type incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<b>string</b>.<span class="i">Equals</span>(<span class="r567 r">pair</span>.<span class="i">Value</span>.<span class="i">Name</span>, <span class="r568 r">other</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>), <span class="s">&quot;Pre-generated Provider name incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r567 r">pair</span>.<span class="i">Value</span>.<span class="i">PSSnapIn</span> == <span class="r568 r">other</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>, <span class="s">&quot;Pre-generated Provider snapin type incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r567 r">pair</span>.<span class="i">Value</span>.<span class="i">Module</span> == <span class="r568 r">other</span>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>, <span class="s">&quot;Pre-generated Provider module incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r567 r">pair</span>.<span class="i">Value</span>.<span class="i">Visibility</span> == <span class="r568 r">other</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a>, <span class="s">&quot;Pre-generated Provider visibility incorrect&quot;</span>);
                    }
                    <b>else</b>
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;Missing provider: &quot;</span> + <span class="r567 r">pair</span>.<span class="i">Key</span>);
                    }
                }
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r564 r">cmdletsCheck</span>.<span class="i">Count</span> == <span class="r546 r">cmdlets</span>.<span class="i">Count</span>, <span class="s">&quot;new Cmdlet added to System.Management.Automation.dll - update InitializeCoreCmdletsAndProviders&quot;</span>);
 
                <b>foreach</b> (<b>var</b> <span id="r569 rd" class="r569 r">pair</span> <b>in</b> <span class="r564 r">cmdletsCheck</span>)
                {
                    <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r570 rd" class="r570 r">other</span>;
                    <b>if</b> (<span class="r546 r">cmdlets</span>.<span class="i">TryGetValue</span>(<span class="r569 r">pair</span>.<span class="i">Key</span>, <b>out</b> <span class="r570 r">other</span>))
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<b>object</b>)<span class="r569 r">pair</span>.<span class="i">Value</span>.<span class="i">HelpFileName</span> == (<b>object</b>)<span class="r570 r">other</span>.<a href="#42aafda58947f789" class="i property">HelpFileName</a>, <span class="s">&quot;Pre-generated Provider help file incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r569 r">pair</span>.<span class="i">Value</span>.<span class="i">ImplementingType</span> == <span class="r570 r">other</span>.<a href="#41fc8f2889edf406" class="i property">ImplementingType</a>, <span class="s">&quot;Pre-generated Provider implementing type incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<b>string</b>.<span class="i">Equals</span>(<span class="r569 r">pair</span>.<span class="i">Value</span>.<span class="i">Name</span>, <span class="r570 r">other</span>.<a href="#c5f3f5b848ea98cd" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>), <span class="s">&quot;Pre-generated Provider name incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r569 r">pair</span>.<span class="i">Value</span>.<span class="i">PSSnapIn</span> == <span class="r570 r">other</span>.<a href="#a63d54bd9a0897a7" class="i property">PSSnapIn</a>, <span class="s">&quot;Pre-generated Provider snapin type incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r569 r">pair</span>.<span class="i">Value</span>.<span class="i">Module</span> == <span class="r570 r">other</span>.<a href="#a3328f1f3a3a9605" class="i property">Module</a>, <span class="s">&quot;Pre-generated Provider module incorrect&quot;</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r569 r">pair</span>.<span class="i">Value</span>.<span class="i">Visibility</span> == <span class="r570 r">other</span>.<a href="#190a59133ab9a4ce" class="i property">Visibility</a>, <span class="s">&quot;Pre-generated Provider visibility incorrect&quot;</span>);
                    }
                    <b>else</b>
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;Pre-generated Cmdlet missing: &quot;</span> + <span class="r569 r">pair</span>.<span class="i">Key</span>);
                    }
                }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
            <b>else</b>
            {
                <a href="#b815982f08e69af9" class="i method">AnalyzeModuleAssemblyWithReflection</a>(<span class="r544 r">assembly</span>, <span class="r545 r">name</span>, <span class="r513 r">psSnapInInfo</span>, <span class="r483 r">moduleInfo</span>, <span class="r514 r">helpFile</span>, <b>ref</b> <span class="r546 r">cmdlets</span>, <b>ref</b> <span class="r547 r">aliases</span>, <b>ref</b> <span class="r548 r">providers</span>);
            }
 
            <span class="c">// Cache the cmdlet and provider info for this assembly...</span>
            <span class="c">// We need to cache a clone of this data *before* the</span>
            <span class="c">// module info is set on it since module info can&#39;t be shared</span>
            <span class="c">// across runspaces. When these entries are hit in the cache,</span>
            <span class="c">// copies will be returned to ensure that the cache is never tied to a runspace.</span>
 
            <b>if</b> (<span class="r546 r">cmdlets</span> != <b>null</b>)
            {
                <b>var</b> <span id="r571 rd" class="r571 r">clone</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt;&gt;(<span class="r546 r">cmdlets</span>.<span class="i">Count</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt; <span id="r572 rd" class="r572 r">aliasesCloneList</span> = <b>null</b>;
 
                <b>foreach</b> (<b>var</b> <span id="r573 rd" class="r573 r">entry</span> <b>in</b> <span class="r546 r">cmdlets</span>)
                {
                    <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt; <span id="r574 rd" class="r574 r">aliasEntries</span>;
                    <b>if</b> (<span class="r547 r">aliases</span> != <b>null</b> &amp;&amp; <span class="r547 r">aliases</span>.<span class="i">TryGetValue</span>(<span class="r573 r">entry</span>.<span class="i">Key</span>, <b>out</b> <span class="r574 r">aliasEntries</span>))
                    {
                        <span class="r572 r">aliasesCloneList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;(<span class="r547 r">aliases</span>.<span class="i">Count</span>);
                        <b>foreach</b> (<b>var</b> <span id="r575 rd" class="r575 r">aliasEntry</span> <b>in</b> <span class="r574 r">aliasEntries</span>)
                        {
                            <span class="r572 r">aliasesCloneList</span>.<span class="i">Add</span>((<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>)<span class="r575 r">aliasEntry</span>.<span class="i">Clone</span>());
                        }
                    }
 
                    <span class="r571 r">clone</span>[<span class="r573 r">entry</span>.<span class="i">Key</span>] = <b>new</b> <span class="i">Tuple</span>&lt;<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt;((<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>)<span class="r573 r">entry</span>.<span class="i">Value</span>.<span class="i">Clone</span>(), <span class="r572 r">aliasesCloneList</span>);
                }
 
                <a href="#ceac48876c99cbde" class="i field">s_cmdletCache</a>.<span class="i">Value</span>[<span class="r544 r">assembly</span>] = <span class="r571 r">clone</span>;
            }
 
            <b>if</b> (<span class="r548 r">providers</span> != <b>null</b>)
            {
                <b>var</b> <span id="r576 rd" class="r576 r">clone</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt;(<span class="r548 r">providers</span>.<span class="i">Count</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>foreach</b> (<b>var</b> <span id="r577 rd" class="r577 r">entry</span> <b>in</b> <span class="r548 r">providers</span>)
                {
                    <span class="r576 r">clone</span>[<span class="r577 r">entry</span>.<span class="i">Key</span>] = (<a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>)<span class="r577 r">entry</span>.<span class="i">Value</span>.<span class="i">Clone</span>();
                }
 
                <a href="#337195dc88d7b05a" class="i field">s_providerCache</a>.<span class="i">Value</span>[<span class="r544 r">assembly</span>] = <span class="r576 r">clone</span>;
            }
        }
 
        <b>private static void</b> <a id="b815982f08e69af9" href="../R/b815982f08e69af9.html" target="n" data-glyph="76,1" class="i method">AnalyzeModuleAssemblyWithReflection</a>(
            <span class="i">Assembly</span> <span id="r578 rd" class="r578 r">assembly</span>,
            <b>string</b> <span id="r579 rd" class="r579 r">name</span>,
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r580 rd" class="r580 r">psSnapInInfo</span>,
            <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r581 rd" class="r581 r">moduleInfo</span>,
            <b>string</b> <span id="r582 rd" class="r582 r">helpFile</span>,
            <b>ref</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt; <span id="r583 rd" class="r583 r">cmdlets</span>,
            <b>ref</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt; <span id="r584 rd" class="r584 r">aliases</span>,
            <b>ref</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <span id="r585 rd" class="r585 r">providers</span>)
        {
            <b>var</b> <span id="r586 rd" class="r586 r">assemblyTypes</span> = <a href="#463ed3c09a8737cd" class="i method">GetAssemblyTypes</a>(<span class="r578 r">assembly</span>, <span class="r579 r">name</span>);
            <a href="#2ebebe0d3caee9cf" class="i method">ExecuteModuleInitializer</a>(<span class="r578 r">assembly</span>, <span class="r586 r">assemblyTypes</span>);
 
            <b>foreach</b> (<span class="i">Type</span> <span id="r587 rd" class="r587 r">type</span> <b>in</b> <span class="r586 r">assemblyTypes</span>)
            {
                <b>if</b> (!<a href="#ade0ca8b41abde88" class="i method">HasDefaultConstructor</a>(<span class="r587 r">type</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="c">// Check for cmdlets</span>
                <b>if</b> (<a href="#3366bdea332c3f9d" class="i method">IsCmdletClass</a>(<span class="r587 r">type</span>) &amp;&amp; <span class="i">TryGetCustomAttribute</span>(<span class="r587 r">type</span>, <b>out</b> <a href="Attributes.cs.html#1c6b89ca87d7bfea" class="t t">CmdletAttribute</a> <span id="r588 rd" class="r588 r">cmdletAttribute</span>))
                {
                    <b>if</b> (<span class="i">TryGetCustomAttribute</span>(<span class="r587 r">type</span>, <b>out</b> <a href="ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a> <span id="r589 rd" class="r589 r">expAttribute</span>) &amp;&amp; <span class="r589 r">expAttribute</span>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#5f379d0c61d42350" class="i property">ToHide</a>)
                    {
                        <span class="c">// If &#39;ExperimentalAttribute&#39; is specified on the cmdlet type and the</span>
                        <span class="c">// effective action at run time is &#39;Hide&#39;, then we ignore the type.</span>
                        <b>continue</b>;
                    }
 
                    <b>string</b> <span id="r590 rd" class="r590 r">cmdletName</span> = <span class="r588 r">cmdletAttribute</span>.<a href="Attributes.cs.html#1897aa9f4581e0e7" class="i property">VerbName</a> + <span class="s">&quot;-&quot;</span> + <span class="r588 r">cmdletAttribute</span>.<a href="Attributes.cs.html#8161a285f9ba64d0" class="i property">NounName</a>;
                    <b>if</b> (<span class="r583 r">cmdlets</span> != <b>null</b> &amp;&amp; <span class="r583 r">cmdlets</span>.<span class="i">ContainsKey</span>(<span class="r590 r">cmdletName</span>))
                    {
                        <b>string</b> <span id="r591 rd" class="r591 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ConsoleInfoErrorStrings</span>.<span class="i">PSSnapInDuplicateCmdlets</span>, <span class="r590 r">cmdletName</span>, <span class="r579 r">name</span>);
                        <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="r591 r">message</span>);
                        <b>throw</b> <b>new</b> <a href="../singleshell/config/MshSnapinLoadException.cs.html#06c1289faddb818b" class="t constructor">PSSnapInException</a>(<span class="r579 r">name</span>, <span class="r591 r">message</span>);
                    }
 
                    <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a> <span id="r592 rd" class="r592 r">cmdlet</span> = <b>new</b> <a href="#4d9ae226c8c55e34" class="t constructor">SessionStateCmdletEntry</a>(<span class="r590 r">cmdletName</span>, <span class="r587 r">type</span>, <span class="r582 r">helpFile</span>);
                    <b>if</b> (<span class="r580 r">psSnapInInfo</span> != <b>null</b>)
                    {
                        <span class="r592 r">cmdlet</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<span class="r580 r">psSnapInInfo</span>);
                    }
 
                    <b>if</b> (<span class="r581 r">moduleInfo</span> != <b>null</b>)
                    {
                        <span class="r592 r">cmdlet</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<span class="r581 r">moduleInfo</span>);
                    }
 
                    <span class="r583 r">cmdlets</span> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                    <span class="r583 r">cmdlets</span>.<span class="i">Add</span>(<span class="r590 r">cmdletName</span>, <span class="r592 r">cmdlet</span>);
 
                    <b>if</b> (<span class="i">TryGetCustomAttribute</span>(<span class="r587 r">type</span>, <b>out</b> <a href="Attributes.cs.html#0fd790dcae0b5382" class="t t">AliasAttribute</a> <span id="r593 rd" class="r593 r">aliasAttribute</span>))
                    {
                        <span class="r584 r">aliases</span> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                        <b>var</b> <span id="r594 rd" class="r594 r">aliasList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;();
                        <b>foreach</b> (<b>var</b> <span id="r595 rd" class="r595 r">alias</span> <b>in</b> <span class="r593 r">aliasAttribute</span>.<a href="Attributes.cs.html#5bfb3ca10725defd" class="i property">AliasNames</a>)
                        {
                            <span class="c">// Alias declared by &#39;AliasAttribute&#39; is set with the option &#39;ScopedItemOptions.None&#39;, because we believe</span>
                            <span class="c">// the users of the cmdlet, instead of the author, should have control of what options applied to an alias</span>
                            <span class="c">// (&#39;ScopedItemOptions.ReadOnly&#39; and/or &#39;ScopedItemOptions.AllScopes&#39;).</span>
                            <a href="#3164e16488ced1ed" class="k">var</a> <span id="r596 rd" class="r596 r">aliasEntry</span> = <b>new</b> <span class="t">SessionStateAliasEntry</span>(<span class="r595 r">alias</span>, <span class="r590 r">cmdletName</span>, <span class="i">description</span>: <b>string</b>.<span class="i">Empty</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>);
                            <b>if</b> (<span class="r580 r">psSnapInInfo</span> != <b>null</b>) { <span class="r596 r">aliasEntry</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<span class="r580 r">psSnapInInfo</span>); }
 
                            <b>if</b> (<span class="r581 r">moduleInfo</span> != <b>null</b>)
                            {
                                <span class="r596 r">aliasEntry</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<span class="r581 r">moduleInfo</span>);
                            }
 
                            <span class="r594 r">aliasList</span>.<span class="i">Add</span>(<span class="r596 r">aliasEntry</span>);
                        }
 
                        <span class="r584 r">aliases</span>.<span class="i">Add</span>(<span class="r590 r">cmdletName</span>, <span class="r594 r">aliasList</span>);
                    }
 
                    <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;{0} from type {1} is added as a cmdlet. &quot;</span>, <span class="r590 r">cmdletName</span>, <span class="r587 r">type</span>.<span class="i">FullName</span>);
                }
                <span class="c">// Check for providers</span>
                <b>else</b> <b>if</b> (<a href="#c69602885dd4c9e6" class="i method">IsProviderClass</a>(<span class="r587 r">type</span>) &amp;&amp; <span class="i">TryGetCustomAttribute</span>(<span class="r587 r">type</span>, <b>out</b> <a href="../namespaces/ProviderDeclarationAttribute.cs.html#aa3c12e112598110" class="t t">CmdletProviderAttribute</a> <span id="r597 rd" class="r597 r">providerAttribute</span>))
                {
                    <b>if</b> (<span class="i">TryGetCustomAttribute</span>(<span class="r587 r">type</span>, <b>out</b> <a href="ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a> <span id="r598 rd" class="r598 r">expAttribute</span>) &amp;&amp; <span class="r598 r">expAttribute</span>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#5f379d0c61d42350" class="i property">ToHide</a>)
                    {
                        <span class="c">// If &#39;ExperimentalAttribute&#39; is specified on the provider type and</span>
                        <span class="c">// the effective action at run time is &#39;Hide&#39;, then we ignore the type.</span>
                        <b>continue</b>;
                    }
 
                    <b>string</b> <span id="r599 rd" class="r599 r">providerName</span> = <span class="r597 r">providerAttribute</span>.<a href="../namespaces/ProviderDeclarationAttribute.cs.html#8de7d7b5e66772c4" class="i property">ProviderName</a>;
                    <b>if</b> (<span class="r585 r">providers</span> != <b>null</b> &amp;&amp; <span class="r585 r">providers</span>.<span class="i">ContainsKey</span>(<span class="r599 r">providerName</span>))
                    {
                        <b>string</b> <span id="r600 rd" class="r600 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ConsoleInfoErrorStrings</span>.<span class="i">PSSnapInDuplicateProviders</span>, <span class="r599 r">providerName</span>, <span class="r580 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>);
                        <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="r600 r">message</span>);
                        <b>throw</b> <b>new</b> <a href="../singleshell/config/MshSnapinLoadException.cs.html#06c1289faddb818b" class="t constructor">PSSnapInException</a>(<span class="r580 r">psSnapInInfo</span>.<a href="../singleshell/config/MshSnapinInfo.cs.html#ebdb1944f8049e83" class="i property">Name</a>, <span class="r600 r">message</span>);
                    }
 
                    <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r601 rd" class="r601 r">provider</span> = <b>new</b> <a href="#0b6d058465f1677f" class="t constructor">SessionStateProviderEntry</a>(<span class="r599 r">providerName</span>, <span class="r587 r">type</span>, <span class="r582 r">helpFile</span>);
                    <b>if</b> (<span class="r580 r">psSnapInInfo</span> != <b>null</b>)
                    {
                        <span class="r601 r">provider</span>.<a href="#99958292d139cf3e" class="i method">SetPSSnapIn</a>(<span class="r580 r">psSnapInInfo</span>);
                    }
 
                    <b>if</b> (<span class="r581 r">moduleInfo</span> != <b>null</b>)
                    {
                        <span class="r601 r">provider</span>.<a href="#47559105ce54572d" class="i method">SetModule</a>(<span class="r581 r">moduleInfo</span>);
                    }
 
                    <span class="r585 r">providers</span> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                    <span class="r585 r">providers</span>.<span class="i">Add</span>(<span class="r599 r">providerName</span>, <span class="r601 r">provider</span>);
 
                    <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;{0} from type {1} is added as a provider. &quot;</span>, <span class="r599 r">providerName</span>, <span class="r587 r">type</span>.<span class="i">FullName</span>);
                }
            }
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;StyleCop.CSharp.SpacingRules&quot;</span>, <span class="s">&quot;SA1001:CommasMustBeSpacedCorrectly&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Reviewed.&quot;</span>)]
        <b>private static void</b> <a id="5ff642a1bbe25993" href="../R/5ff642a1bbe25993.html" target="n" data-glyph="76,1" class="i method">InitializeCoreCmdletsAndProviders</a>(
            <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r602 rd" class="r602 r">psSnapInInfo</span>,
            <b>out</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt; <span id="r603 rd" class="r603 r">cmdlets</span>,
            <b>out</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt; <span id="r604 rd" class="r604 r">providers</span>,
            <b>string</b> <span id="r605 rd" class="r605 r">helpFile</span>)
        {
            <span class="r603 r">cmdlets</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                { <span class="s">&quot;Add-History&quot;</span>,                       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Add-History&quot;</span>, <b>typeof</b>(<a href="hostifaces/History.cs.html#4f23c3d1eb0a52f1" class="t t">AddHistoryCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Clear-History&quot;</span>,                     <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Clear-History&quot;</span>, <b>typeof</b>(<a href="hostifaces/History.cs.html#37514fa1ae47fbfb" class="t t">ClearHistoryCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Debug-Job&quot;</span>,                         <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Debug-Job&quot;</span>, <b>typeof</b>(<a href="remoting/commands/DebugJob.cs.html#1b46d06937256c36" class="t t">DebugJobCommand</a>), <span class="r605 r">helpFile</span>) },
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                { <span class="s">&quot;Disable-PSRemoting&quot;</span>,                <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Disable-PSRemoting&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#62dd6cca42c0ce20" class="t t">DisablePSRemotingCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Enable-PSRemoting&quot;</span>,                 <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Enable-PSRemoting&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#5ee20feca58bd195" class="t t">EnablePSRemotingCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Disable-PSSessionConfiguration&quot;</span>,    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Disable-PSSessionConfiguration&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#44a32a91d25b6f39" class="t t">DisablePSSessionConfigurationCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Enable-PSSessionConfiguration&quot;</span>,     <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Enable-PSSessionConfiguration&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#320cd7da5b3b35ed" class="t t">EnablePSSessionConfigurationCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-PSSessionCapability&quot;</span>,           <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-PSSessionCapability&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#d304a97a9bb37b15" class="t t">GetPSSessionCapabilityCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-PSSessionConfiguration&quot;</span>,        <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-PSSessionConfiguration&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#1dd3de040a657cc9" class="t t">GetPSSessionConfigurationCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;New-PSSessionConfigurationFile&quot;</span>,    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;New-PSSessionConfigurationFile&quot;</span>, <b>typeof</b>(<a href="remoting/commands/NewPSSessionConfigurationFile.cs.html#cfd4d2a25793fd1e" class="t t">NewPSSessionConfigurationFileCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Receive-PSSession&quot;</span>,                 <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Receive-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/ReceivePSSession.cs.html#392bac0d449aef92" class="t t">ReceivePSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Register-PSSessionConfiguration&quot;</span>,   <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Register-PSSessionConfiguration&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#091dc53780f2780a" class="t t">RegisterPSSessionConfigurationCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Unregister-PSSessionConfiguration&quot;</span>, <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Unregister-PSSessionConfiguration&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#d9cf941b779180ee" class="t t">UnregisterPSSessionConfigurationCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Set-PSSessionConfiguration&quot;</span>,        <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Set-PSSessionConfiguration&quot;</span>, <b>typeof</b>(<a href="remoting/commands/CustomShellCommands.cs.html#cc2731857df70643" class="t t">SetPSSessionConfigurationCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Test-PSSessionConfigurationFile&quot;</span>,   <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Test-PSSessionConfigurationFile&quot;</span>, <b>typeof</b>(<a href="remoting/commands/TestPSSessionConfigurationFile.cs.html#f996ff14940bbc92" class="t t">TestPSSessionConfigurationFileCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Connect-PSSession&quot;</span>,                 <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Connect-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/ConnectPSSession.cs.html#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Disconnect-PSSession&quot;</span>,              <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Disconnect-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/DisconnectPSSession.cs.html#ba1ee4b9df5c537f" class="t t">DisconnectPSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                { <span class="s">&quot;Disable-ExperimentalFeature&quot;</span>,       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Disable-ExperimentalFeature&quot;</span>, <b>typeof</b>(<a href="ExperimentalFeature/EnableDisableExperimentalFeatureCommand.cs.html#810d969974afea64" class="t t">DisableExperimentalFeatureCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Enable-ExperimentalFeature&quot;</span>,        <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Enable-ExperimentalFeature&quot;</span>, <b>typeof</b>(<a href="ExperimentalFeature/EnableDisableExperimentalFeatureCommand.cs.html#29345ae5cce381bf" class="t t">EnableExperimentalFeatureCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Enter-PSHostProcess&quot;</span>,               <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Enter-PSHostProcess&quot;</span>, <b>typeof</b>(<a href="remoting/commands/EnterPSHostProcessCommand.cs.html#e47e977008f46371" class="t t">EnterPSHostProcessCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Enter-PSSession&quot;</span>,                   <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Enter-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/PushRunspaceCommand.cs.html#6473c5d5c4356c4e" class="t t">EnterPSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Exit-PSHostProcess&quot;</span>,                <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Exit-PSHostProcess&quot;</span>, <b>typeof</b>(<a href="remoting/commands/EnterPSHostProcessCommand.cs.html#ce760a7dcb4443a3" class="t t">ExitPSHostProcessCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Exit-PSSession&quot;</span>,                    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Exit-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/PopRunspaceCommand.cs.html#55421311edb34243" class="t t">ExitPSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Export-ModuleMember&quot;</span>,               <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Export-ModuleMember&quot;</span>, <b>typeof</b>(<a href="Modules/ExportModuleMemberCommand.cs.html#7356f058a77edb4c" class="t t">ExportModuleMemberCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;ForEach-Object&quot;</span>,                    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;ForEach-Object&quot;</span>, <b>typeof</b>(<a href="InternalCommands.cs.html#e797f6e277ea7817" class="t t">ForEachObjectCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-Command&quot;</span>,                       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-Command&quot;</span>, <b>typeof</b>(<a href="GetCommandCommand.cs.html#ff1a9d86cf34497b" class="t t">GetCommandCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-ExperimentalFeature&quot;</span>,           <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-ExperimentalFeature&quot;</span>, <b>typeof</b>(<a href="ExperimentalFeature/GetExperimentalFeatureCommand.cs.html#cd3cc95510aaa1b5" class="t t">GetExperimentalFeatureCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-Help&quot;</span>,                          <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-Help&quot;</span>, <b>typeof</b>(<a href="../help/HelpCommands.cs.html#eb5836f612b480de" class="t t">GetHelpCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-History&quot;</span>,                       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-History&quot;</span>, <b>typeof</b>(<a href="hostifaces/History.cs.html#ad869538b692aa74" class="t t">GetHistoryCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-Job&quot;</span>,                           <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-Job&quot;</span>, <b>typeof</b>(<a href="remoting/commands/GetJob.cs.html#656f12d497463796" class="t t">GetJobCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-Module&quot;</span>,                        <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-Module&quot;</span>, <b>typeof</b>(<a href="Modules/GetModuleCommand.cs.html#6f6537067f4dfc41" class="t t">GetModuleCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-PSHostProcessInfo&quot;</span>,             <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-PSHostProcessInfo&quot;</span>, <b>typeof</b>(<a href="remoting/commands/EnterPSHostProcessCommand.cs.html#b5fe9e9dcdf2c8bc" class="t t">GetPSHostProcessInfoCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Get-PSSession&quot;</span>,                     <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/getrunspacecommand.cs.html#1ffcae79d01ec9a9" class="t t">GetPSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Import-Module&quot;</span>,                     <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Import-Module&quot;</span>, <b>typeof</b>(<a href="Modules/ImportModuleCommand.cs.html#4a6e75cbbfb65b34" class="t t">ImportModuleCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Invoke-Command&quot;</span>,                    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Invoke-Command&quot;</span>, <b>typeof</b>(<a href="remoting/commands/InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Invoke-History&quot;</span>,                    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Invoke-History&quot;</span>, <b>typeof</b>(<a href="hostifaces/History.cs.html#6b13382e767b6a05" class="t t">InvokeHistoryCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;New-Module&quot;</span>,                        <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;New-Module&quot;</span>, <b>typeof</b>(<a href="Modules/NewModuleCommand.cs.html#8c2a6c2600f3d29c" class="t t">NewModuleCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;New-ModuleManifest&quot;</span>,                <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;New-ModuleManifest&quot;</span>, <b>typeof</b>(<a href="Modules/NewModuleManifestCommand.cs.html#22af511d9f5fc801" class="t t">NewModuleManifestCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;New-PSRoleCapabilityFile&quot;</span>,          <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;New-PSRoleCapabilityFile&quot;</span>, <b>typeof</b>(<a href="remoting/commands/NewPSSessionConfigurationFile.cs.html#da112121e325c8ff" class="t t">NewPSRoleCapabilityFileCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;New-PSSession&quot;</span>,                     <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;New-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/newrunspacecommand.cs.html#04eb0ee815ea8d44" class="t t">NewPSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;New-PSSessionOption&quot;</span>,               <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;New-PSSessionOption&quot;</span>, <b>typeof</b>(<a href="remoting/commands/NewPSSessionOptionCommand.cs.html#67bb4b9392f0875d" class="t t">NewPSSessionOptionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;New-PSTransportOption&quot;</span>,             <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;New-PSTransportOption&quot;</span>, <b>typeof</b>(<a href="remoting/commands/NewPSSessionConfigurationOptionCommand.cs.html#e92cc7e7a38de53f" class="t t">NewPSTransportOptionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Out-Default&quot;</span>,                       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Out-Default&quot;</span>, <b>typeof</b>(<a href="../FormatAndOutput/out-console/OutConsole.cs.html#c9bb0040912f3314" class="t t">OutDefaultCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Out-Host&quot;</span>,                          <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Out-Host&quot;</span>, <b>typeof</b>(<a href="../FormatAndOutput/out-console/OutConsole.cs.html#a58d644f31719ae4" class="t t">OutHostCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Out-Null&quot;</span>,                          <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Out-Null&quot;</span>, <b>typeof</b>(<a href="../FormatAndOutput/out-console/OutConsole.cs.html#f5982690ed7e6594" class="t t">OutNullCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Receive-Job&quot;</span>,                       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Receive-Job&quot;</span>, <b>typeof</b>(<a href="remoting/commands/ReceiveJob.cs.html#23a93f1c27fadeef" class="t t">ReceiveJobCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Register-ArgumentCompleter&quot;</span>,        <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Register-ArgumentCompleter&quot;</span>, <b>typeof</b>(<a href="CommandCompletion/ExtensibleCompletion.cs.html#fa9f3b28abbe462d" class="t t">RegisterArgumentCompleterCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Remove-Job&quot;</span>,                        <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Remove-Job&quot;</span>, <b>typeof</b>(<a href="remoting/commands/RemoveJob.cs.html#61d072004a97a004" class="t t">RemoveJobCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Remove-Module&quot;</span>,                     <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Remove-Module&quot;</span>, <b>typeof</b>(<a href="Modules/RemoveModuleCommand.cs.html#0df8e472ef0ef9c8" class="t t">RemoveModuleCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Remove-PSSession&quot;</span>,                  <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Remove-PSSession&quot;</span>, <b>typeof</b>(<a href="remoting/commands/removerunspacecommand.cs.html#c06ffb3832334309" class="t t">RemovePSSessionCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Save-Help&quot;</span>,                         <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Save-Help&quot;</span>, <b>typeof</b>(<a href="../help/SaveHelpCommand.cs.html#9a5fcbf4e57fe29a" class="t t">SaveHelpCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Set-PSDebug&quot;</span>,                       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Set-PSDebug&quot;</span>, <b>typeof</b>(<a href="InternalCommands.cs.html#ce490dc6232a3ea0" class="t t">SetPSDebugCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Set-StrictMode&quot;</span>,                    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Set-StrictMode&quot;</span>, <b>typeof</b>(<a href="InternalCommands.cs.html#f1d8cd0463c7e7e9" class="t t">SetStrictModeCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Start-Job&quot;</span>,                         <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Start-Job&quot;</span>, <b>typeof</b>(<a href="remoting/commands/StartJob.cs.html#43ad6ab12d386a86" class="t t">StartJobCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Stop-Job&quot;</span>,                          <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Stop-Job&quot;</span>, <b>typeof</b>(<a href="remoting/commands/StopJob.cs.html#346abc5bb471e0bb" class="t t">StopJobCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Test-ModuleManifest&quot;</span>,               <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Test-ModuleManifest&quot;</span>, <b>typeof</b>(<a href="Modules/TestModuleManifestCommand.cs.html#7bf67b688ccb67b7" class="t t">TestModuleManifestCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Update-Help&quot;</span>,                       <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Update-Help&quot;</span>, <b>typeof</b>(<a href="../help/UpdateHelpCommand.cs.html#7b2b9f385aa8a162" class="t t">UpdateHelpCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Wait-Job&quot;</span>,                          <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Wait-Job&quot;</span>, <b>typeof</b>(<a href="remoting/commands/WaitJob.cs.html#347cafad3166fb52" class="t t">WaitJobCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Where-Object&quot;</span>,                      <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Where-Object&quot;</span>, <b>typeof</b>(<a href="InternalCommands.cs.html#dc8bedd211b63a54" class="t t">WhereObjectCommand</a>), <span class="r605 r">helpFile</span>) },
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span>
<span class="e">                { &quot;Add-PSSnapin&quot;,                      new SessionStateCmdletEntry(&quot;Add-PSSnapin&quot;, typeof(AddPSSnapinCommand), helpFile) },
                { &quot;Export-Console&quot;,                    new SessionStateCmdletEntry(&quot;Export-Console&quot;, typeof(ExportConsoleCommand), helpFile) },
                { &quot;Get-PSSnapin&quot;,                      new SessionStateCmdletEntry(&quot;Get-PSSnapin&quot;, typeof(GetPSSnapinCommand), helpFile) },
                { &quot;Remove-PSSnapin&quot;,                   new SessionStateCmdletEntry(&quot;Remove-PSSnapin&quot;, typeof(RemovePSSnapinCommand), helpFile) },
                { &quot;Resume-Job&quot;,                        new SessionStateCmdletEntry(&quot;Resume-Job&quot;, typeof(ResumeJobCommand), helpFile) },
                { &quot;Suspend-Job&quot;,                       new SessionStateCmdletEntry(&quot;Suspend-Job&quot;, typeof(SuspendJobCommand), helpFile) },
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <span class="c">// Not exported, but are added via reflection so added here as well, though maybe they shouldn&#39;t be</span>
                { <span class="s">&quot;Out-LineOutput&quot;</span>,                    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Out-LineOutput&quot;</span>, <b>typeof</b>(<a href="../FormatAndOutput/out-textInterface/OutTextInterface.cs.html#ce8aef1b36e49159" class="t t">OutLineOutputCommand</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Format-Default&quot;</span>,                    <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Format-Default&quot;</span>, <b>typeof</b>(<a href="../FormatAndOutput/format-default/format-default.cs.html#ca2f64f1f70e29ba" class="t t">FormatDefaultCommand</a>), <span class="r605 r">helpFile</span>) },
            };
 
            <b>if</b> (<a href="ExperimentalFeature/ExperimentalFeature.cs.html#6626da1ebcb2b206" class="t t">ExperimentalFeature</a>.<a href="ExperimentalFeature/ExperimentalFeature.cs.html#e292001e34f610da" class="i method">IsEnabled</a>(<span class="s">&quot;PSSubsystemPluginModel&quot;</span>))
            {
                <span class="r603 r">cmdlets</span>.<span class="i">Add</span>(<span class="s">&quot;Get-PSSubsystem&quot;</span>, <b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-PSSubsystem&quot;</span>, <b>typeof</b>(<span class="i n">Subsystem</span>.<a href="Subsystem/Commands/GetPSSubsystemCommand.cs.html#4d2eb754a103dc05" class="t t">GetPSSubsystemCommand</a>), <span class="r605 r">helpFile</span>));
            }
 
            <b>foreach</b> (<b>var</b> <span id="r606 rd" class="r606 r">val</span> <b>in</b> <span class="r603 r">cmdlets</span>.<span class="i">Values</span>)
            {
                <span class="r606 r">val</span>.<span class="i">SetPSSnapIn</span>(<span class="r602 r">psSnapInInfo</span>);
            }
 
            <span class="r604 r">providers</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                { <span class="s">&quot;Registry&quot;</span>,    <b>new</b> <span class="t">SessionStateProviderEntry</span>(<span class="s">&quot;Registry&quot;</span>, <b>typeof</b>(<a href="../P/92d0bdbab09c8afa.html#92d0bdbab09c8afa" class="t t">RegistryProvider</a>), <span class="r605 r">helpFile</span>) },
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                { <span class="s">&quot;Alias&quot;</span>,       <b>new</b> <span class="t">SessionStateProviderEntry</span>(<span class="s">&quot;Alias&quot;</span>, <b>typeof</b>(<a href="../namespaces/AliasProvider.cs.html#a6afe2434375d311" class="t t">AliasProvider</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Environment&quot;</span>, <b>new</b> <span class="t">SessionStateProviderEntry</span>(<span class="s">&quot;Environment&quot;</span>, <b>typeof</b>(<a href="../namespaces/EnvironmentProvider.cs.html#da41ee9c5ba947e2" class="t t">EnvironmentProvider</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;FileSystem&quot;</span> , <b>new</b> <span class="t">SessionStateProviderEntry</span>(<span class="s">&quot;FileSystem&quot;</span>, <b>typeof</b>(<a href="../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Function&quot;</span>,    <b>new</b> <span class="t">SessionStateProviderEntry</span>(<span class="s">&quot;Function&quot;</span>, <b>typeof</b>(<a href="../namespaces/FunctionProvider.cs.html#365f4e35bb79a9bf" class="t t">FunctionProvider</a>), <span class="r605 r">helpFile</span>) },
                { <span class="s">&quot;Variable&quot;</span>,    <b>new</b> <span class="t">SessionStateProviderEntry</span>(<span class="s">&quot;Variable&quot;</span>, <b>typeof</b>(<a href="../namespaces/VariableProvider.cs.html#6f513c34ac441393" class="t t">VariableProvider</a>), <span class="r605 r">helpFile</span>) },
            };
 
            <b>foreach</b> (<b>var</b> <span id="r607 rd" class="r607 r">val</span> <b>in</b> <span class="r604 r">providers</span>.<span class="i">Values</span>)
            {
                <span class="r607 r">val</span>.<span class="i">SetPSSnapIn</span>(<span class="r602 r">psSnapInInfo</span>);
            }
        }
 
        <b>private static void</b> <a id="2ebebe0d3caee9cf" href="../R/2ebebe0d3caee9cf.html" target="n" data-glyph="76,1" class="i method">ExecuteModuleInitializer</a>(<span class="i">Assembly</span> <span id="r608 rd" class="r608 r">assembly</span>, <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <span id="r609 rd" class="r609 r">assemblyTypes</span>)
        {
            <b>foreach</b> (<span class="i">Type</span> <span id="r610 rd" class="r610 r">type</span> <b>in</b> <span class="r609 r">assemblyTypes</span>)
            {
                <b>if</b> (<b>typeof</b>(<a href="Modules/ModuleIntrinsics.cs.html#fd32613ca83d5545" class="t t">IModuleAssemblyInitializer</a>).<span class="i">IsAssignableFrom</span>(<span class="r610 r">type</span>))
                {
                    <a href="#bec470eac5992d02" class="i field">s_assembliesWithModuleInitializerCache</a>.<span class="i">Value</span>[<span class="r608 r">assembly</span>] = <b>true</b>;
                    <a href="Modules/ModuleIntrinsics.cs.html#fd32613ca83d5545" class="k">var</a> <span id="r611 rd" class="r611 r">moduleInitializer</span> = (<a href="Modules/ModuleIntrinsics.cs.html#fd32613ca83d5545" class="t t">IModuleAssemblyInitializer</a>)<span class="i">Activator</span>.<span class="i">CreateInstance</span>(<span class="r610 r">type</span>, <b>true</b>);
                    <span class="r611 r">moduleInitializer</span>.<a href="Modules/ModuleIntrinsics.cs.html#0cf97ea117954e42" class="i method">OnImport</a>();
                }
            }
        }
 
        <b>internal static</b> <span class="i">IEnumerable</span>&lt;<span class="i">Type</span>&gt; <a id="463ed3c09a8737cd" href="../R/463ed3c09a8737cd.html" target="n" data-glyph="74,1" class="i method">GetAssemblyTypes</a>(<span class="i">Assembly</span> <span id="r612 rd" class="r612 r">assembly</span>, <b>string</b> <span id="r613 rd" class="r613 r">name</span>)
        {
            <b>try</b>
            {
                <span class="c">// Return types that are public, non-abstract, non-interface and non-valueType.</span>
                <b>return</b> <span class="r612 r">assembly</span>.<span class="i">ExportedTypes</span>.<span class="i">Where</span>(<b>static</b> <span id="r614 rd" class="r614 r">t</span> =&gt; !<span class="r614 r">t</span>.<span class="i">IsAbstract</span> &amp;&amp; !<span class="r614 r">t</span>.<span class="i">IsInterface</span> &amp;&amp; !<span class="r614 r">t</span>.<span class="i">IsValueType</span>);
            }
            <b>catch</b> (<span class="i">ReflectionTypeLoadException</span> <span id="r615 rd" class="r615 r">e</span>)
            {
                <b>string</b> <span id="r616 rd" class="r616 r">message</span> = <span class="r615 r">e</span>.<span class="i">Message</span> + <span class="s">&quot;\nLoader Exceptions: \n&quot;</span>;
                <b>if</b> (<span class="r615 r">e</span>.<span class="i">LoaderExceptions</span> != <b>null</b>)
                {
                    <b>foreach</b> (<span class="i">Exception</span> <span id="r617 rd" class="r617 r">exception</span> <b>in</b> <span class="r615 r">e</span>.<span class="i">LoaderExceptions</span>)
                    {
                        <span class="r616 r">message</span> += <span class="s">&quot;\n&quot;</span> + <span class="r617 r">exception</span>.<span class="i">Message</span>;
                    }
                }
 
                <a href="#f659475807eea13d" class="i field">s_PSSnapInTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="r616 r">message</span>);
                <b>throw</b> <b>new</b> <a href="../singleshell/config/MshSnapinLoadException.cs.html#06c1289faddb818b" class="t constructor">PSSnapInException</a>(<span class="r613 r">name</span>, <span class="r616 r">message</span>);
            }
        }
 
        <span class="c">// cmdletCache holds the list of cmdlets along with its aliases per each assembly.</span>
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentDictionary</span>&lt;<span class="i">Assembly</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt;&gt;&gt;&gt; <a id="ceac48876c99cbde" href="../R/ceac48876c99cbde.html" target="n" data-glyph="46,1" class="i field">s_cmdletCache</a> =
            <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentDictionary</span>&lt;<span class="i">Assembly</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="#0b9bc88597e005fb" class="t t">SessionStateCmdletEntry</a>, <span class="i">List</span>&lt;<a href="#3164e16488ced1ed" class="t t">SessionStateAliasEntry</a>&gt;&gt;&gt;&gt;&gt;();
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentDictionary</span>&lt;<span class="i">Assembly</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt;&gt;&gt; <a id="337195dc88d7b05a" href="../R/337195dc88d7b05a.html" target="n" data-glyph="46,1" class="i field">s_providerCache</a> =
            <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentDictionary</span>&lt;<span class="i">Assembly</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a>&gt;&gt;&gt;();
 
        <span class="c">// Using a ConcurrentDictionary for this so that we can avoid having a private lock variable. We use only the keys for checking.</span>
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentDictionary</span>&lt;<span class="i">Assembly</span>, <b>bool</b>&gt;&gt; <a id="bec470eac5992d02" href="../R/bec470eac5992d02.html" target="n" data-glyph="46,1" class="i field">s_assembliesWithModuleInitializerCache</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentDictionary</span>&lt;<span class="i">Assembly</span>, <b>bool</b>&gt;&gt;();
 
        [<span class="i">MethodImpl</span>(<span class="i">MethodImplOptions</span>.<span class="i">AggressiveInlining</span>)]
        <b>private static bool</b> <a id="3366bdea332c3f9d" href="../R/3366bdea332c3f9d.html" target="n" data-glyph="76,1" class="i method">IsCmdletClass</a>(<span class="i">Type</span> <span id="r618 rd" class="r618 r">type</span>)
        {
            <b>return</b> <span class="r618 r">type</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>));
        }
 
        [<span class="i">MethodImpl</span>(<span class="i">MethodImplOptions</span>.<span class="i">AggressiveInlining</span>)]
        <b>private static bool</b> <a id="c69602885dd4c9e6" href="../R/c69602885dd4c9e6.html" target="n" data-glyph="76,1" class="i method">IsProviderClass</a>(<span class="i">Type</span> <span id="r619 rd" class="r619 r">type</span>)
        {
            <b>return</b> <span class="r619 r">type</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a>));
        }
 
        [<span class="i">MethodImpl</span>(<span class="i">MethodImplOptions</span>.<span class="i">AggressiveInlining</span>)]
        <b>private static bool</b> <a id="ade0ca8b41abde88" href="../R/ade0ca8b41abde88.html" target="n" data-glyph="76,1" class="i method">HasDefaultConstructor</a>(<span class="i">Type</span> <span id="r620 rd" class="r620 r">type</span>)
        {
            <b>return</b> <span class="r620 r">type</span>.<span class="i">GetConstructor</span>(<span class="i">Type</span>.<span class="i">EmptyTypes</span>) <b>is not null</b>;
        }
 
        [<span class="i">MethodImpl</span>(<span class="i">MethodImplOptions</span>.<span class="i">AggressiveInlining</span>)]
        <b>private static string</b> <a id="1bf21456755fe960" href="../R/1bf21456755fe960.html" target="n" data-glyph="76,1" class="i method">GetHelpFile</a>(<b>string</b> <span id="r621 rd" class="r621 r">assemblyPath</span>)
        {
            <span class="c">// Help files exist only for original module assemblies, not for generated Ngen binaries</span>
            <b>return</b> <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r621 r">assemblyPath</span>).<span class="i">Replace</span>(<span class="s">&quot;.ni.dll&quot;</span>, <span class="s">&quot;.dll&quot;</span>) + <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#4e8f3565be09f2d7" class="i field">HelpFileExtension</a>;
        }
 
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="f659475807eea13d" href="../R/f659475807eea13d.html" target="n" data-glyph="46,1" class="i field">s_PSSnapInTracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#24b0f68d5add3eb3" class="i method">GetTracer</a>(<span class="s">&quot;PSSnapInLoadUnload&quot;</span>, <span class="s">&quot;Loading and unloading mshsnapins&quot;</span>, <b>false</b>);
    }
 
    <span class="c">// Guid is {15d4c170-2f29-5689-a0e2-d95b0c7b4ea0}</span>
 
    [<span class="i">EventSource</span>(<span class="i">Name</span> = <span class="s">&quot;Microsoft-PowerShell-Runspaces&quot;</span>)]
    <b>internal class</b> <a id="81385ea1ee2efc81" href="../R/81385ea1ee2efc81.html" target="n" data-glyph="2,0" class="t t"><span id="ebc6902173c2fd93">RunspaceEventSource</span></a> : <span class="i">EventSource</span>
    {
        <b>internal static readonly</b> <a href="#81385ea1ee2efc81" class="t t">RunspaceEventSource</a> <a id="d10c972f303cf36c" href="../R/d10c972f303cf36c.html" target="n" data-glyph="44,1" class="i field">Log</a> = <b>new</b> <span class="t">RunspaceEventSource</span>();
 
        <b>public void</b> <a id="5ee60f647311846c" href="../R/5ee60f647311846c.html" target="n" data-glyph="72,1" class="i method">OpenRunspaceStart</a>() { <span class="i">WriteEvent</span>(1); }
 
        <b>public void</b> <a id="c339058f0194bee8" href="../R/c339058f0194bee8.html" target="n" data-glyph="72,1" class="i method">OpenRunspaceStop</a>() { <span class="i">WriteEvent</span>(2); }
 
        <b>public void</b> <a id="51ccf96a87770b7a" href="../R/51ccf96a87770b7a.html" target="n" data-glyph="72,1" class="i method">LoadAssembliesStart</a>() { <span class="i">WriteEvent</span>(3); }
 
        <b>public void</b> <a id="4991c6101c3dc943" href="../R/4991c6101c3dc943.html" target="n" data-glyph="72,1" class="i method">LoadAssembliesStop</a>() { <span class="i">WriteEvent</span>(4); }
 
        <b>public void</b> <a id="916b8faf20103c39" href="../R/916b8faf20103c39.html" target="n" data-glyph="72,1" class="i method">UpdateFormatTableStart</a>() { <span class="i">WriteEvent</span>(5); }
 
        <b>public void</b> <a id="fd2b0c9ccbcd9486" href="../R/fd2b0c9ccbcd9486.html" target="n" data-glyph="72,1" class="i method">UpdateFormatTableStop</a>() { <span class="i">WriteEvent</span>(6); }
 
        <b>public void</b> <a id="ba77396f00b2b92b" href="../R/ba77396f00b2b92b.html" target="n" data-glyph="72,1" class="i method">UpdateTypeTableStart</a>() { <span class="i">WriteEvent</span>(7); }
 
        <b>public void</b> <a id="c5a688a273456543" href="../R/c5a688a273456543.html" target="n" data-glyph="72,1" class="i method">UpdateTypeTableStop</a>() { <span class="i">WriteEvent</span>(8); }
 
        <b>public void</b> <a id="8ac76730e6b161e6" href="../R/8ac76730e6b161e6.html" target="n" data-glyph="72,1" class="i method">LoadProvidersStart</a>() { <span class="i">WriteEvent</span>(9); }
 
        <b>public void</b> <a id="25ec41023a49a25f" href="../R/25ec41023a49a25f.html" target="n" data-glyph="72,1" class="i method">LoadProvidersStop</a>() { <span class="i">WriteEvent</span>(10); }
 
        <b>public void</b> <a id="8c5c14571e4651a9" href="../R/8c5c14571e4651a9.html" target="n" data-glyph="72,1" class="i method">LoadCommandsStart</a>() { <span class="i">WriteEvent</span>(11); }
 
        <b>public void</b> <a id="32a88e13eb2ca01e" href="../R/32a88e13eb2ca01e.html" target="n" data-glyph="72,1" class="i method">LoadCommandsStop</a>() { <span class="i">WriteEvent</span>(12); }
 
        <b>public void</b> <a id="d578d2cad21298b9" href="../R/d578d2cad21298b9.html" target="n" data-glyph="72,1" class="i method">LoadVariablesStart</a>() { <span class="i">WriteEvent</span>(13); }
 
        <b>public void</b> <a id="1f83e45af7e0ce4f" href="../R/1f83e45af7e0ce4f.html" target="n" data-glyph="72,1" class="i method">LoadVariablesStop</a>() { <span class="i">WriteEvent</span>(14); }
 
        <b>public void</b> <a id="0e59f17cb501c9ce" href="../R/0e59f17cb501c9ce.html" target="n" data-glyph="72,1" class="i method">LoadEnvironmentVariablesStart</a>() { <span class="i">WriteEvent</span>(15); }
 
        <b>public void</b> <a id="90f51a245c266a03" href="../R/90f51a245c266a03.html" target="n" data-glyph="72,1" class="i method">LoadEnvironmentVariablesStop</a>() { <span class="i">WriteEvent</span>(16); }
 
        <b>public void</b> <a id="685867b77ec22143" href="../R/685867b77ec22143.html" target="n" data-glyph="72,1" class="i method">LoadAssemblyStart</a>(<b>string</b> <span id="r622 rd" class="r622 r">Name</span>, <b>string</b> <span id="r623 rd" class="r623 r">FileName</span>) { <span class="i">WriteEvent</span>(17, <span class="r622 r">Name</span>, <span class="r623 r">FileName</span>); }
 
        <b>public void</b> <a id="744d8407249a781c" href="../R/744d8407249a781c.html" target="n" data-glyph="72,1" class="i method">LoadAssemblyStop</a>(<b>string</b> <span id="r624 rd" class="r624 r">Name</span>, <b>string</b> <span id="r625 rd" class="r625 r">FileName</span>) { <span class="i">WriteEvent</span>(18, <span class="r624 r">Name</span>, <span class="r625 r">FileName</span>); }
 
        <b>public void</b> <a id="ddc299e896353954" href="../R/ddc299e896353954.html" target="n" data-glyph="72,1" class="i method">ProcessFormatFileStart</a>(<b>string</b> <span id="r626 rd" class="r626 r">FileName</span>) { <span class="i">WriteEvent</span>(19, <span class="r626 r">FileName</span>); }
 
        <b>public void</b> <a id="1341ee6f0d9e42eb" href="../R/1341ee6f0d9e42eb.html" target="n" data-glyph="72,1" class="i method">ProcessFormatFileStop</a>(<b>string</b> <span id="r627 rd" class="r627 r">FileName</span>) { <span class="i">WriteEvent</span>(20, <span class="r627 r">FileName</span>); }
 
        <b>public void</b> <a id="0048f9fecc8a7275" href="../R/0048f9fecc8a7275.html" target="n" data-glyph="72,1" class="i method">ProcessTypeFileStart</a>(<b>string</b> <span id="r628 rd" class="r628 r">FileName</span>) { <span class="i">WriteEvent</span>(21, <span class="r628 r">FileName</span>); }
 
        <b>public void</b> <a id="36bf6007f026f893" href="../R/36bf6007f026f893.html" target="n" data-glyph="72,1" class="i method">ProcessTypeFileStop</a>(<b>string</b> <span id="r629 rd" class="r629 r">FileName</span>) { <span class="i">WriteEvent</span>(22, <span class="r629 r">FileName</span>); }
 
        <b>public void</b> <a id="798bbe7b8814f024" href="../R/798bbe7b8814f024.html" target="n" data-glyph="72,1" class="i method">LoadProviderStart</a>(<b>string</b> <span id="r630 rd" class="r630 r">Name</span>) { <span class="i">WriteEvent</span>(23, <span class="r630 r">Name</span>); }
 
        <b>public void</b> <a id="a483346e02c61697" href="../R/a483346e02c61697.html" target="n" data-glyph="72,1" class="i method">LoadProviderStop</a>(<b>string</b> <span id="r631 rd" class="r631 r">Name</span>) { <span class="i">WriteEvent</span>(24, <span class="r631 r">Name</span>); }
 
        <b>public void</b> <a id="4985ae7c74cd7be6" href="../R/4985ae7c74cd7be6.html" target="n" data-glyph="72,1" class="i method">LoadCommandStart</a>(<b>string</b> <span id="r632 rd" class="r632 r">Name</span>) { <span class="i">WriteEvent</span>(25, <span class="r632 r">Name</span>); }
 
        <b>public void</b> <a id="ddd9a1437e3f6899" href="../R/ddd9a1437e3f6899.html" target="n" data-glyph="72,1" class="i method">LoadCommandStop</a>(<b>string</b> <span id="r633 rd" class="r633 r">Name</span>) { <span class="i">WriteEvent</span>(26, <span class="r633 r">Name</span>); }
    }
}
</pre></td></tr></table></div></body></html>
