<!DOCTYPE html>
<html><head><title>IDispatch.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(50);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ComInterop/InteropServices/IDispatch.cs" target="_top">engine\ComInterop\InteropServices\IDispatch.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="c">// The .NET Foundation licenses this file to you under the MIT license.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i">ComTypes</span> = <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>.<span class="i">ComTypes</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">InteropServices</span>
{
    [<span class="i">ComImport</span>]
    [<span class="i">Guid</span>(<a href="../../../../GuidAssembly/R/00020400-0000-0000-c000-000000000046.html" target="n" class="s">&quot;00020400-0000-0000-C000-000000000046&quot;</a>)]
    [<span class="i">InterfaceType</span>(<span class="i">ComInterfaceType</span>.<span class="i">InterfaceIsIUnknown</span>)]
    <b>internal interface</b> <a id="a8a3487f340fafce" href="../../../R/a8a3487f340fafce.html" target="n" data-glyph="50,0" class="t t">IDispatch</a>
    {
        <b>int</b> <a id="4d7ed73f106f9181" href="../../../R/4d7ed73f106f9181.html" target="n" data-glyph="72,1" class="i method">GetTypeInfoCount</a>();
 
        <span class="i">ComTypes</span>.<span class="i">ITypeInfo</span> <a id="cb367f48eac622eb" href="../../../R/cb367f48eac622eb.html" target="n" data-glyph="72,1" class="i method">GetTypeInfo</a>(
            <b>int</b> <span id="r0 rd" class="r0 r">iTInfo</span>,
            <b>int</b> <span id="r1 rd" class="r1 r">lcid</span>);
 
        <b>void</b> <a id="f53452b313ad7f99" href="../../../R/f53452b313ad7f99.html" target="n" data-glyph="72,1" class="i method">GetIDsOfNames</a>(
            <b>ref</b> <span class="i">Guid</span> <span id="r2 rd" class="r2 r">riid</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPArray</span>, <span class="i">ArraySubType</span> = <span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>, <span class="i">SizeParamIndex</span> = 2), <span class="i">In</span>]
            <b>string</b>[] <span id="r3 rd" class="r3 r">rgszNames</span>,
            <b>int</b> <span id="r4 rd" class="r4 r">cNames</span>,
            <b>int</b> <span id="r5 rd" class="r5 r">lcid</span>,
            [<span class="i">Out</span>] <b>int</b>[] <span id="r6 rd" class="r6 r">rgDispId</span>);
 
        <span class="c">// The last 3 parameters of Invoke() are optional and must be defined</span>
        <span class="c">// as IntPtr in C#, since there is no language feature for optional ref/out.</span>
        <b>void</b> <a id="5660c3252e3230dc" href="../../../R/5660c3252e3230dc.html" target="n" data-glyph="72,1" class="i method">Invoke</a>(
            <b>int</b> <span id="r7 rd" class="r7 r">dispIdMember</span>,
            <b>ref</b> <span class="i">Guid</span> <span id="r8 rd" class="r8 r">riid</span>,
            <b>int</b> <span id="r9 rd" class="r9 r">lcid</span>,
            <a href="#963f937c0256d693" class="t t">InvokeFlags</a> <span id="r10 rd" class="r10 r">wFlags</span>,
            <b>ref</b> <span class="i">ComTypes</span>.<span class="i">DISPPARAMS</span> <span id="r11 rd" class="r11 r">pDispParams</span>,
            <span class="c">/* out/optional */</span> <span class="i">IntPtr</span> <span id="r12 rd" class="r12 r">pVarResult</span>,
            <span class="c">/* out/optional */</span> <span class="i">IntPtr</span> <span id="r13 rd" class="r13 r">pExcepInfo</span>,
            <span class="c">/* out/optional */</span> <span class="i">IntPtr</span> <span id="r14 rd" class="r14 r">puArgErr</span>);
    }
 
    [<span class="i">Flags</span>]
    <b>internal enum</b> <a id="963f937c0256d693" href="../../../R/963f937c0256d693.html" target="n" data-glyph="20,0" class="t t"><span id="d1e20c12b95c9b37">InvokeFlags</span></a> : <b>short</b>
    {
        <a id="057ecef77d96b4db" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">DISPATCH_METHOD</a> = 1,
        <a id="cad3f47869994440" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">DISPATCH_PROPERTYGET</a> = 2,
        <a id="ac9995fd1f68c579" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">DISPATCH_PROPERTYPUT</a> = 4,
        <a id="885740c50ee67275" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">DISPATCH_PROPERTYPUTREF</a> = 8
    }
}
</pre></td></tr></table></div></body></html>
