<!DOCTYPE html>
<html><head><title>Variant.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(736);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ComInterop/InteropServices/Variant.cs" target="_top">engine\ComInterop\InteropServices\Variant.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="c">// The .NET Foundation licenses this file to you under the MIT license.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">InteropServices</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Variant is the basic COM type for late-binding. It can contain any other COM data type.</span>
    <span class="c">///</span><span class="c"> This type definition precisely matches the unmanaged data layout so that the struct can be passed</span>
    <span class="c">///</span><span class="c"> to and from COM calls.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Explicit</span>)]
    <b>internal</b> <a href="../../../P/8d6f8cfa0d0f7877.html" target="s" class="k">partial</a> <b>struct</b> <a id="8d6f8cfa0d0f7877" href="../../../R/8d6f8cfa0d0f7877.html" target="n" data-glyph="110,0" class="t t"><span id="f2c7eda1f2b8b3f8">Variant</span></a>
    {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
        <b>static</b> <a id="8ac0a943f8a713c9" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">Variant</a>()
        {
            <span class="c">// Variant size is the size of 4 pointers (16 bytes) on a 32-bit processor,</span>
            <span class="c">// and 3 pointers (24 bytes) on a 64-bit processor.</span>
            <b>int</b> <span id="r0 rd" class="r0 r">variantSize</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>(<b>typeof</b>(<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>));
            <b>if</b> (<span class="i">IntPtr</span>.<span class="i">Size</span> == 4)
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r0 r">variantSize</span> == (4 * <span class="i">IntPtr</span>.<span class="i">Size</span>));
            }
            <b>else</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="i">IntPtr</span>.<span class="i">Size</span> == 8);
                <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r0 r">variantSize</span> == (3 * <span class="i">IntPtr</span>.<span class="i">Size</span>));
            }
        }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">// Most of the data types in the Variant are carried in _typeUnion</span>
        [<span class="i">FieldOffset</span>(0)] <b>private</b> <a href="#86467bbd3154388c" class="t t">TypeUnion</a> <a id="5355ff11744b044e" href="../../../R/5355ff11744b044e.html" target="n" data-glyph="46,1" class="i field">_typeUnion</a>;
 
        <span class="c">// Decimal is the largest data type and it needs to use the space that is normally unused in TypeUnion._wReserved1, etc.</span>
        <span class="c">// Hence, it is declared to completely overlap with TypeUnion. A Decimal does not use the first two bytes, and so</span>
        <span class="c">// TypeUnion._vt can still be used to encode the type.</span>
        [<span class="i">FieldOffset</span>(0)] <b>private decimal</b> <a id="fbc16e848a3e3bdc" href="../../../R/fbc16e848a3e3bdc.html" target="n" data-glyph="46,1" class="i field">_decimal</a>;
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>private struct</b> <a id="86467bbd3154388c" href="../../../R/86467bbd3154388c.html" target="n" data-glyph="112,1" class="t t"><span id="10980f3512ad8422">TypeUnion</span></a>
        {
            <b>public ushort</b> <a id="09b0557669d34c98" href="../../../R/09b0557669d34c98.html" target="n" data-glyph="42,2" class="i field">_vt</a>;
            <b>public ushort</b> <a id="34e18f191207061a" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">_wReserved1</a>;
            <b>public ushort</b> <a id="29b70f4729c48128" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">_wReserved2</a>;
            <b>public ushort</b> <a id="05905004742faf8f" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">_wReserved3</a>;
 
            <b>public</b> <a href="#528ec23df5cb9e70" class="t t">UnionTypes</a> <a id="f0790d4f4da813a4" href="../../../R/f0790d4f4da813a4.html" target="n" data-glyph="42,2" class="i field">_unionTypes</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>private struct</b> <a id="0dd74a3b78de1084" href="../../../R/0dd74a3b78de1084.html" target="n" data-glyph="112,1" class="t t"><span id="764b1a7eb85f9a5b">Record</span></a>
        {
            <b>public</b> <span class="i">IntPtr</span> <a id="f04d51787133e455" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">_record</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="8df3371d40d45406" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">_recordInfo</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Explicit</span>)]
        <b>private struct</b> <a id="528ec23df5cb9e70" href="../../../R/528ec23df5cb9e70.html" target="n" data-glyph="112,1" class="t t"><span id="fe65dd4165a19a9f">UnionTypes</span></a>
        {
            [<span class="i">FieldOffset</span>(0)] <b>public sbyte</b> <a id="6c7403fadf251e27" href="../../../R/6c7403fadf251e27.html" target="n" data-glyph="42,2" class="i field">_i1</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public short</b> <a id="058d454ce7828382" href="../../../R/058d454ce7828382.html" target="n" data-glyph="42,2" class="i field">_i2</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public int</b> <a id="e310e08d8c3d361c" href="../../../R/e310e08d8c3d361c.html" target="n" data-glyph="42,2" class="i field">_i4</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public long</b> <a id="04771d1536a7e29d" href="../../../R/04771d1536a7e29d.html" target="n" data-glyph="42,2" class="i field">_i8</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public byte</b> <a id="e8f0c3f134147b32" href="../../../R/e8f0c3f134147b32.html" target="n" data-glyph="42,2" class="i field">_ui1</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public ushort</b> <a id="1d97328ae8b2821c" href="../../../R/1d97328ae8b2821c.html" target="n" data-glyph="42,2" class="i field">_ui2</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public uint</b> <a id="3a9823b138994bf7" href="../../../R/3a9823b138994bf7.html" target="n" data-glyph="42,2" class="i field">_ui4</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public ulong</b> <a id="9edfb89a1a6fbf26" href="../../../R/9edfb89a1a6fbf26.html" target="n" data-glyph="42,2" class="i field">_ui8</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public int</b> <a id="21a29596dda8e125" href="../../../R/21a29596dda8e125.html" target="n" data-glyph="42,2" class="i field">_int</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public uint</b> <a id="7f00d3e8dc164d26" href="../../../R/7f00d3e8dc164d26.html" target="n" data-glyph="42,2" class="i field">_uint</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public short</b> <a id="96f7e9e739c7f36c" href="../../../R/96f7e9e739c7f36c.html" target="n" data-glyph="42,2" class="i field">_bool</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public int</b> <a id="362b6bff03f04fe2" href="../../../R/362b6bff03f04fe2.html" target="n" data-glyph="42,2" class="i field">_error</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public float</b> <a id="65c979d9d7c9b450" href="../../../R/65c979d9d7c9b450.html" target="n" data-glyph="42,2" class="i field">_r4</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public double</b> <a id="522a0a8abd894669" href="../../../R/522a0a8abd894669.html" target="n" data-glyph="42,2" class="i field">_r8</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public long</b> <a id="ec3c64f56de99067" href="../../../R/ec3c64f56de99067.html" target="n" data-glyph="42,2" class="i field">_cy</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public double</b> <a id="25c2aad8deb9334b" href="../../../R/25c2aad8deb9334b.html" target="n" data-glyph="42,2" class="i field">_date</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public</b> <span class="i">IntPtr</span> <a id="b9943a70b3be5041" href="../../../R/b9943a70b3be5041.html" target="n" data-glyph="42,2" class="i field">_bstr</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public</b> <span class="i">IntPtr</span> <a id="9b02509bb8349dc2" href="../../../R/9b02509bb8349dc2.html" target="n" data-glyph="42,2" class="i field">_unknown</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public</b> <span class="i">IntPtr</span> <a id="6ac1c8bf6b5db2f6" href="../../../R/6ac1c8bf6b5db2f6.html" target="n" data-glyph="42,2" class="i field">_dispatch</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public</b> <span class="i">IntPtr</span> <a id="d3f60a25460a436d" href="../../../R/d3f60a25460a436d.html" target="n" data-glyph="42,2" class="i field">_pvarVal</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public</b> <span class="i">IntPtr</span> <a id="a3320eed532b91cf" href="../../../R/a3320eed532b91cf.html" target="n" data-glyph="42,2" class="i field">_byref</a>;
            [<span class="i">FieldOffset</span>(0)] <b>public</b> <a href="#0dd74a3b78de1084" class="t t">Record</a> <a id="ad9ab70a845a1f1c" href="../../../R/ad9ab70a845a1f1c.html" target="n" data-glyph="42,2" class="i field">_record</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Primitive types are the basic COM types. It includes valuetypes like ints, but also reference types</span>
        <span class="c">///</span><span class="c"> like BStrs. It does not include composite types like arrays and user-defined COM types (IUnknown/IDispatch).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="566346a8e8ba67ac" href="../../../R/566346a8e8ba67ac.html" target="n" data-glyph="72,1" class="i method">IsPrimitiveType</a>(<span class="i">VarEnum</span> <span id="r1 rd" class="r1 r">varEnum</span>)
        {
            <b>switch</b> (<span class="r1 r">varEnum</span>)
            {
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I1</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I2</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I4</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I8</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_INT</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R4</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R8</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_CY</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>:
                    <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>public unsafe void</b> <a id="319b60e807c1fa7a" href="../../../R/319b60e807c1fa7a.html" target="n" data-glyph="72,1" class="i method">CopyFromIndirect</a>(<b>object</b> <span id="r2 rd" class="r2 r">value</span>)
        {
            <span class="i">VarEnum</span> <span id="r3 rd" class="r3 r">vt</span> = (<span class="i">VarEnum</span>)(((<b>int</b>)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#dac97475f7b5bf7d" class="i property">VariantType</a>) &amp; ~((<b>int</b>)<span class="i">VarEnum</span>.<span class="i">VT_BYREF</span>));
 
            <b>if</b> (<span class="r2 r">value</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r3 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span> || <span class="r3 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span> || <span class="r3 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>)
                {
                    *(<span class="i">IntPtr</span>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
                <b>return</b>;
            }
 
            <b>if</b> ((<span class="r3 r">vt</span> &amp; <span class="i">VarEnum</span>.<span class="i">VT_ARRAY</span>) != 0)
            {
                <a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a> <span id="r4 rd" class="r4 r">vArray</span>;
                <span class="i">Marshal</span>.<span class="i">GetNativeVariantForObject</span>(<span class="r2 r">value</span>, (<span class="i">IntPtr</span>)(<b>void</b>*)&amp;<span class="r4 r">vArray</span>);
                *(<span class="i">IntPtr</span>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = <span class="r4 r">vArray</span>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a>;
                <b>return</b>;
            }
 
            <b>switch</b> (<span class="r3 r">vt</span>)
            {
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I1</span>:
                    *(<b>sbyte</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>sbyte</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>:
                    *(<b>byte</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>byte</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I2</span>:
                    *(<b>short</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>short</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>:
                    *(<b>ushort</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>ushort</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>:
                    <span class="c">// VARIANT_TRUE  = -1</span>
                    <span class="c">// VARIANT_FALSE = 0</span>
                    *(<b>short</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>bool</b>)<span class="r2 r">value</span> ? (<b>short</b>)-1 : (<b>short</b>)0;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I4</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_INT</span>:
                    *(<b>int</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>int</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>:
                    *(<b>uint</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>uint</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>:
                    *(<b>int</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = ((<span class="i">ErrorWrapper</span>)<span class="r2 r">value</span>).<span class="i">ErrorCode</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I8</span>:
                    *(<b>long</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>long</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>:
                    *(<b>ulong</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>ulong</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R4</span>:
                    *(<b>float</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>float</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R8</span>:
                    *(<b>double</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>double</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>:
                    *(<b>double</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = ((<span class="i">DateTime</span>)<span class="r2 r">value</span>).<span class="i">ToOADate</span>();
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>:
                    *(<span class="i">IntPtr</span>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = <span class="i">Marshal</span>.<span class="i">GetIUnknownForObject</span>(<span class="r2 r">value</span>);
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>:
                    *(<span class="i">IntPtr</span>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = <span class="i">Marshal</span>.<span class="i">GetComInterfaceForObject</span>&lt;<b>object</b>, <a href="IDispatch.cs.html#a8a3487f340fafce" class="t t">IDispatch</a>&gt;(<span class="r2 r">value</span>);
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>:
                    *(<span class="i">IntPtr</span>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = <span class="i">Marshal</span>.<span class="i">StringToBSTR</span>((<b>string</b>)<span class="r2 r">value</span>);
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_CY</span>:
                    *(<b>long</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = <b>decimal</b>.<span class="i">ToOACurrency</span>((<b>decimal</b>)<span class="r2 r">value</span>);
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>:
                    *(<b>decimal</b>*)<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a> = (<b>decimal</b>)<span class="r2 r">value</span>;
                    <b>break</b>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_VARIANT</span>:
                    <span class="i">Marshal</span>.<span class="i">GetNativeVariantForObject</span>(<span class="r2 r">value</span>, <a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#a3320eed532b91cf" class="i field">_byref</a>);
                    <b>break</b>;
 
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the managed object representing the Variant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public object</b>? <a id="51b3f83970745f12" href="../../../R/51b3f83970745f12.html" target="n" data-glyph="72,1" class="i method">ToObject</a>()
        {
            <span class="c">// Check the simple case upfront</span>
            <b>if</b> (<a href="#d366944fd6f61826" class="i property">IsEmpty</a>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>switch</b> (<a href="#dac97475f7b5bf7d" class="i property">VariantType</a>)
            {
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_NULL</span>:
                    <b>return</b> <span class="i">DBNull</span>.<span class="i">Value</span>;
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I1</span>: <b>return</b> <a href="#ea2cae688bcb119f" class="i property">AsI1</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I2</span>: <b>return</b> <a href="#2c83f4ea7d70e81a" class="i property">AsI2</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I4</span>: <b>return</b> <a href="#6140fd954a909738" class="i property">AsI4</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I8</span>: <b>return</b> <a href="#e4ba8a30c83ea180" class="i property">AsI8</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>: <b>return</b> <a href="#fe634ce032c96366" class="i property">AsUi1</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>: <b>return</b> <a href="#df2c289dd49cb929" class="i property">AsUi2</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>: <b>return</b> <a href="#ed873929794b1a0b" class="i property">AsUi4</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>: <b>return</b> <a href="#0c81e6ed1f0d63e9" class="i property">AsUi8</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_INT</span>: <b>return</b> <a href="#21a0854391ac26f5" class="i property">AsInt</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>: <b>return</b> <a href="#3b7438a430ce4154" class="i property">AsUint</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>: <b>return</b> <a href="#62e95e887c7e1fb6" class="i property">AsBool</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>: <b>return</b> <a href="#0c0d0b6beea59b9a" class="i property">AsError</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R4</span>: <b>return</b> <a href="#fb154b5a0bf16065" class="i property">AsR4</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R8</span>: <b>return</b> <a href="#343c04b28c104074" class="i property">AsR8</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>: <b>return</b> <a href="#56748e083b80db3b" class="i property">AsDecimal</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_CY</span>: <b>return</b> <a href="#71b176626986d7b6" class="i property">AsCy</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>: <b>return</b> <a href="#7558daf978adbbe2" class="i property">AsDate</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>: <b>return</b> <a href="#3bba15a86495c862" class="i property">AsBstr</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>: <b>return</b> <a href="#9cbab7fe1b3183f3" class="i property">AsUnknown</a>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>: <b>return</b> <a href="#43f22204909bf424" class="i property">AsDispatch</a>;
 
                <b>default</b>:
                    <b>unsafe</b>
                    {
                        <b>fixed</b> (<b>void</b>* <span id="r5 rd" class="r5 r">pThis</span> = &amp;<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>)
                        {
                            <b>return</b> <span class="i">Marshal</span>.<span class="i">GetObjectForNativeVariant</span>((<span class="i n">System</span>.<span class="i">IntPtr</span>)<span class="r5 r">pThis</span>);
                        }
                    }
            }
        }
 
        [<span class="i">DllImport</span>(<span class="s">&quot;oleaut32.dll&quot;</span>)]
        <b>internal static extern void</b> <a id="69f31b25bfcc0a75" href="../../../R/69f31b25bfcc0a75.html" target="n" data-glyph="74,1" class="i method">VariantClear</a>(<span class="i">IntPtr</span> <span id="r6 rd" class="r6 r">variant</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Release any unmanaged memory associated with the Variant</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="46f8e97396383ea4" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Clear</a>()
        {
            <span class="c">// We do not need to call OLE32&#39;s VariantClear for primitive types or ByRefs</span>
            <span class="c">// to save ourselves the cost of interop transition.</span>
            <span class="c">// ByRef indicates the memory is not owned by the VARIANT itself while</span>
            <span class="c">// primitive types do not have any resources to free up.</span>
            <span class="c">// Hence, only safearrays, BSTRs, interfaces and user types are</span>
            <span class="c">// handled differently.</span>
            <span class="i">VarEnum</span> <span id="r7 rd" class="r7 r">vt</span> = <a href="#dac97475f7b5bf7d" class="i property">VariantType</a>;
            <b>if</b> ((<span class="r7 r">vt</span> &amp; <span class="i">VarEnum</span>.<span class="i">VT_BYREF</span>) != 0)
            {
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_EMPTY</span>;
            }
            <b>else</b> <b>if</b> (((<span class="r7 r">vt</span> &amp; <span class="i">VarEnum</span>.<span class="i">VT_ARRAY</span>) != 0)
                    || (<span class="r7 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>)
                    || (<span class="r7 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>)
                    || (<span class="r7 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>)
                    || (<span class="r7 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_VARIANT</span>)
                    || (<span class="r7 r">vt</span> == <span class="i">VarEnum</span>.<span class="i">VT_RECORD</span>))
            {
                <b>unsafe</b>
                {
                    <b>fixed</b> (<b>void</b>* <span id="r8 rd" class="r8 r">pThis</span> = &amp;<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>)
                    {
                        <a href="#69f31b25bfcc0a75" class="i method">VariantClear</a>((<span class="i">IntPtr</span>)<span class="r8 r">pThis</span>);
                    }
                }
 
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
            }
            <b>else</b>
            {
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_EMPTY</span>;
            }
        }
 
        <b>public</b> <span class="i">VarEnum</span> <a id="dac97475f7b5bf7d" href="../../../R/dac97475f7b5bf7d.html" target="n" data-glyph="102,1" class="i property">VariantType</a>
        {
            <b>get</b> =&gt; (<span class="i">VarEnum</span>)<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#09b0557669d34c98" class="i field">_vt</a>;
            <b>set</b> =&gt; <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#09b0557669d34c98" class="i field">_vt</a> = (<b>ushort</b>)<b>value</b>;
        }
 
        <b>public bool</b> <a id="d366944fd6f61826" href="../../../R/d366944fd6f61826.html" target="n" data-glyph="102,1" class="i property">IsEmpty</a> =&gt; <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#09b0557669d34c98" class="i field">_vt</a> == ((<b>ushort</b>)<span class="i">VarEnum</span>.<span class="i">VT_EMPTY</span>);
 
        <b>public bool</b> <a id="b85674470a4cd656" href="../../../R/b85674470a4cd656.html" target="n" data-glyph="102,1" class="i property">IsByRef</a> =&gt; (<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#09b0557669d34c98" class="i field">_vt</a> &amp; ((<b>ushort</b>)<span class="i">VarEnum</span>.<span class="i">VT_BYREF</span>)) != 0;
 
        <b>public void</b> <a id="3e564dd3365d4a52" href="../../../R/3e564dd3365d4a52.html" target="n" data-glyph="72,1" class="i method">SetAsNULL</a>()
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
            <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_NULL</span>;
        }
 
        <span class="c">// VT_I1</span>
 
        <b>public sbyte</b> <a id="ea2cae688bcb119f" href="../../../R/ea2cae688bcb119f.html" target="n" data-glyph="102,1" class="i property">AsI1</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_I1</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#6c7403fadf251e27" class="i field">_i1</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_I1</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#6c7403fadf251e27" class="i field">_i1</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_I2</span>
 
        <b>public short</b> <a id="2c83f4ea7d70e81a" href="../../../R/2c83f4ea7d70e81a.html" target="n" data-glyph="102,1" class="i property">AsI2</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_I2</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#058d454ce7828382" class="i field">_i2</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_I2</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#058d454ce7828382" class="i field">_i2</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_I4</span>
 
        <b>public int</b> <a id="6140fd954a909738" href="../../../R/6140fd954a909738.html" target="n" data-glyph="102,1" class="i property">AsI4</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_I4</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#e310e08d8c3d361c" class="i field">_i4</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_I4</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#e310e08d8c3d361c" class="i field">_i4</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_I8</span>
 
        <b>public long</b> <a id="e4ba8a30c83ea180" href="../../../R/e4ba8a30c83ea180.html" target="n" data-glyph="102,1" class="i property">AsI8</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_I8</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#04771d1536a7e29d" class="i field">_i8</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_I8</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#04771d1536a7e29d" class="i field">_i8</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_UI1</span>
 
        <b>public byte</b> <a id="fe634ce032c96366" href="../../../R/fe634ce032c96366.html" target="n" data-glyph="102,1" class="i property">AsUi1</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#e8f0c3f134147b32" class="i field">_ui1</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#e8f0c3f134147b32" class="i field">_ui1</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_UI2</span>
 
        <b>public ushort</b> <a id="df2c289dd49cb929" href="../../../R/df2c289dd49cb929.html" target="n" data-glyph="102,1" class="i property">AsUi2</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#1d97328ae8b2821c" class="i field">_ui2</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#1d97328ae8b2821c" class="i field">_ui2</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_UI4</span>
 
        <b>public uint</b> <a id="ed873929794b1a0b" href="../../../R/ed873929794b1a0b.html" target="n" data-glyph="102,1" class="i property">AsUi4</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#3a9823b138994bf7" class="i field">_ui4</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#3a9823b138994bf7" class="i field">_ui4</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_UI8</span>
 
        <b>public ulong</b> <a id="0c81e6ed1f0d63e9" href="../../../R/0c81e6ed1f0d63e9.html" target="n" data-glyph="102,1" class="i property">AsUi8</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#9edfb89a1a6fbf26" class="i field">_ui8</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#9edfb89a1a6fbf26" class="i field">_ui8</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_INT</span>
 
        <b>public int</b> <a id="21a0854391ac26f5" href="../../../R/21a0854391ac26f5.html" target="n" data-glyph="102,1" class="i property">AsInt</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_INT</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#21a29596dda8e125" class="i field">_int</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_INT</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#21a29596dda8e125" class="i field">_int</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_UINT</span>
 
        <b>public uint</b> <a id="3b7438a430ce4154" href="../../../R/3b7438a430ce4154.html" target="n" data-glyph="102,1" class="i property">AsUint</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#7f00d3e8dc164d26" class="i field">_uint</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#7f00d3e8dc164d26" class="i field">_uint</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_BOOL</span>
 
        <b>public bool</b> <a id="62e95e887c7e1fb6" href="../../../R/62e95e887c7e1fb6.html" target="n" data-glyph="102,1" class="i property">AsBool</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#96f7e9e739c7f36c" class="i field">_bool</a> != 0;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <span class="c">// VARIANT_TRUE  = -1</span>
                <span class="c">// VARIANT_FALSE = 0</span>
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#96f7e9e739c7f36c" class="i field">_bool</a> = <b>value</b> ? (<b>short</b>)-1 : (<b>short</b>)0;
            }
        }
 
        <span class="c">// VT_ERROR</span>
 
        <b>public int</b> <a id="0c0d0b6beea59b9a" href="../../../R/0c0d0b6beea59b9a.html" target="n" data-glyph="102,1" class="i property">AsError</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#362b6bff03f04fe2" class="i field">_error</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#362b6bff03f04fe2" class="i field">_error</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_R4</span>
 
        <b>public float</b> <a id="fb154b5a0bf16065" href="../../../R/fb154b5a0bf16065.html" target="n" data-glyph="102,1" class="i property">AsR4</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_R4</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#65c979d9d7c9b450" class="i field">_r4</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_R4</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#65c979d9d7c9b450" class="i field">_r4</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_R8</span>
 
        <b>public double</b> <a id="343c04b28c104074" href="../../../R/343c04b28c104074.html" target="n" data-glyph="102,1" class="i property">AsR8</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_R8</span>);
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#522a0a8abd894669" class="i field">_r8</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_R8</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#522a0a8abd894669" class="i field">_r8</a> = <b>value</b>;
            }
        }
 
        <span class="c">// VT_DECIMAL</span>
 
        <b>public decimal</b> <a id="56748e083b80db3b" href="../../../R/56748e083b80db3b.html" target="n" data-glyph="102,1" class="i property">AsDecimal</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>);
                <span class="c">// The first byte of Decimal is unused, but usually set to 0</span>
                <a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a> <span id="r9 rd" class="r9 r">v</span> = <a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>;
                <span class="r9 r">v</span>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#09b0557669d34c98" class="i field">_vt</a> = 0;
                <b>return</b> <span class="r9 r">v</span>.<a href="#fbc16e848a3e3bdc" class="i field">_decimal</a>;
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>;
                <a href="#fbc16e848a3e3bdc" class="i field">_decimal</a> = <b>value</b>;
                <span class="c">// _vt overlaps with _decimal, and should be set after setting _decimal</span>
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#09b0557669d34c98" class="i field">_vt</a> = (<b>ushort</b>)<span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>;
            }
        }
 
        <span class="c">// VT_CY</span>
 
        <b>public decimal</b> <a id="71b176626986d7b6" href="../../../R/71b176626986d7b6.html" target="n" data-glyph="102,1" class="i property">AsCy</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_CY</span>);
                <b>return</b> <b>decimal</b>.<span class="i">FromOACurrency</span>(<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#ec3c64f56de99067" class="i field">_cy</a>);
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_CY</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#ec3c64f56de99067" class="i field">_cy</a> = <b>decimal</b>.<span class="i">ToOACurrency</span>(<b>value</b>);
            }
        }
 
        <span class="c">// VT_DATE</span>
 
        <b>public</b> <span class="i">DateTime</span> <a id="7558daf978adbbe2" href="../../../R/7558daf978adbbe2.html" target="n" data-glyph="102,1" class="i property">AsDate</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>);
                <b>return</b> <span class="i">DateTime</span>.<span class="i">FromOADate</span>(<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#25c2aad8deb9334b" class="i field">_date</a>);
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>;
                <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#25c2aad8deb9334b" class="i field">_date</a> = <b>value</b>.<span class="i">ToOADate</span>();
            }
        }
 
        <span class="c">// VT_BSTR</span>
 
        <b>public string</b> <a id="3bba15a86495c862" href="../../../R/3bba15a86495c862.html" target="n" data-glyph="102,1" class="i property">AsBstr</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>);
                <b>return</b> (<b>string</b>)<span class="i">Marshal</span>.<span class="i">PtrToStringBSTR</span>(<a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#b9943a70b3be5041" class="i field">_bstr</a>);
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>;
                <a href="../../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>.<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#b9943a70b3be5041" class="i field">_bstr</a> = <span class="i">Marshal</span>.<span class="i">StringToBSTR</span>(<b>value</b>);
            }
        }
 
        <span class="c">// VT_UNKNOWN</span>
 
        <b>public object</b>? <a id="9cbab7fe1b3183f3" href="../../../R/9cbab7fe1b3183f3.html" target="n" data-glyph="102,1" class="i property">AsUnknown</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>);
                <b>if</b> (<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#9b02509bb8349dc2" class="i field">_unknown</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <b>return</b> <b>null</b>;
                }
                <b>return</b> <span class="i">Marshal</span>.<span class="i">GetObjectForIUnknown</span>(<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#9b02509bb8349dc2" class="i field">_unknown</a>);
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>;
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#9b02509bb8349dc2" class="i field">_unknown</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
                <b>else</b>
                {
                    <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#9b02509bb8349dc2" class="i field">_unknown</a> = <span class="i">Marshal</span>.<span class="i">GetIUnknownForObject</span>(<b>value</b>);
                }
            }
        }
 
        <span class="c">// VT_DISPATCH</span>
 
        <b>public object</b>? <a id="43f22204909bf424" href="../../../R/43f22204909bf424.html" target="n" data-glyph="102,1" class="i property">AsDispatch</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>);
                <b>if</b> (<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#6ac1c8bf6b5db2f6" class="i field">_dispatch</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <b>return</b> <b>null</b>;
                }
                <b>return</b> <span class="i">Marshal</span>.<span class="i">GetObjectForIUnknown</span>(<a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#6ac1c8bf6b5db2f6" class="i field">_dispatch</a>);
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#d366944fd6f61826" class="i property">IsEmpty</a>);
                <a href="#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>;
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#6ac1c8bf6b5db2f6" class="i field">_dispatch</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
                <b>else</b>
                {
                    <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#6ac1c8bf6b5db2f6" class="i field">_dispatch</a> = <span class="i">Marshal</span>.<span class="i">GetComInterfaceForObject</span>&lt;<b>object</b>, <a href="IDispatch.cs.html#a8a3487f340fafce" class="t t">IDispatch</a>&gt;(<b>value</b>);
                }
            }
        }
 
        <b>public</b> <span class="i">IntPtr</span> <a id="0520f7a3246df0a5" href="../../../R/0520f7a3246df0a5.html" target="n" data-glyph="102,1" class="i property">AsByRefVariant</a>
        {
            <b>get</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#dac97475f7b5bf7d" class="i property">VariantType</a> == (<span class="i">VarEnum</span>.<span class="i">VT_BYREF</span> | <span class="i">VarEnum</span>.<span class="i">VT_VARIANT</span>));
                <b>return</b> <a href="#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="#d3f60a25460a436d" class="i field">_pvarVal</a>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
