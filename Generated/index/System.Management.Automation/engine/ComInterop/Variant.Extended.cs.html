<!DOCTYPE html>
<html><head><title>Variant.Extended.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(324);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ComInterop/Variant.Extended.cs" target="_top">engine\ComInterop\Variant.Extended.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="c">// The .NET Foundation licenses this file to you under the MIT license.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">ComInterop</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">InteropServices</span>
{
    <b>internal</b> <a href="../../P/8d6f8cfa0d0f7877.html" target="s" class="k">partial</a> <b>struct</b> <a id="8d6f8cfa0d0f7877" href="../../R/8d6f8cfa0d0f7877.html" target="n" data-glyph="110,0" class="t t"><span id="f2c7eda1f2b8b3f8">Variant</span></a>
    {
        <span class="c">// VT_I1</span>
 
        <b>public void</b> <a id="6ef7c8dad86b299a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefI1</a>(<b>ref sbyte</b> <span id="r0 rd" class="r0 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r0 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_I1</span>);
        }
 
        <span class="c">// VT_I2</span>
 
        <b>public void</b> <a id="c2722d1b3af44d4d" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefI2</a>(<b>ref short</b> <span id="r1 rd" class="r1 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r1 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_I2</span>);
        }
 
        <span class="c">// VT_I4</span>
 
        <b>public void</b> <a id="c6e7cffbf01a422b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefI4</a>(<b>ref int</b> <span id="r2 rd" class="r2 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r2 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_I4</span>);
        }
 
        <span class="c">// VT_I8</span>
 
        <b>public void</b> <a id="3b65009d248a8d3e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefI8</a>(<b>ref long</b> <span id="r3 rd" class="r3 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r3 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_I8</span>);
        }
 
        <span class="c">// VT_UI1</span>
 
        <b>public void</b> <a id="20d9a9b53040afa8" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefUi1</a>(<b>ref byte</b> <span id="r4 rd" class="r4 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r4 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>);
        }
 
        <span class="c">// VT_UI2</span>
 
        <b>public void</b> <a id="4a896916c688dba7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefUi2</a>(<b>ref ushort</b> <span id="r5 rd" class="r5 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r5 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>);
        }
 
        <span class="c">// VT_UI4</span>
 
        <b>public void</b> <a id="5976c04aa5edbf42" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefUi4</a>(<b>ref uint</b> <span id="r6 rd" class="r6 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r6 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>);
        }
 
        <span class="c">// VT_UI8</span>
 
        <b>public void</b> <a id="5fe409b47cc3fcd4" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefUi8</a>(<b>ref ulong</b> <span id="r7 rd" class="r7 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r7 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>);
        }
 
        <span class="c">// VT_INT</span>
 
        <b>public void</b> <a id="5682b8ad014ee555" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefInt</a>(<b>ref int</b> <span id="r8 rd" class="r8 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r8 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_INT</span>);
        }
 
        <span class="c">// VT_UINT</span>
 
        <b>public void</b> <a id="e7563afc929cb7cd" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefUint</a>(<b>ref uint</b> <span id="r9 rd" class="r9 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r9 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>);
        }
 
        <span class="c">// VT_BOOL</span>
 
        <b>public void</b> <a id="390df4e0ba74aec5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefBool</a>(<b>ref short</b> <span id="r10 rd" class="r10 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r10 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>);
        }
 
        <span class="c">// VT_ERROR</span>
 
        <b>public void</b> <a id="2ee265669cea2b5f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefError</a>(<b>ref int</b> <span id="r11 rd" class="r11 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r11 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>);
        }
 
        <span class="c">// VT_R4</span>
 
        <b>public void</b> <a id="ab0b941b24dac2f9" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefR4</a>(<b>ref float</b> <span id="r12 rd" class="r12 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r12 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_R4</span>);
        }
 
        <span class="c">// VT_R8</span>
 
        <b>public void</b> <a id="49c971ba28f00fca" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefR8</a>(<b>ref double</b> <span id="r13 rd" class="r13 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r13 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_R8</span>);
        }
 
        <span class="c">// VT_DECIMAL</span>
 
        <b>public void</b> <a id="f566b54223283abe" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefDecimal</a>(<b>ref decimal</b> <span id="r14 rd" class="r14 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r14 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>);
        }
 
        <span class="c">// VT_CY</span>
 
        <b>public void</b> <a id="7259457996a447a1" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefCy</a>(<b>ref long</b> <span id="r15 rd" class="r15 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r15 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_CY</span>);
        }
 
        <span class="c">// VT_DATE</span>
 
        <b>public void</b> <a id="fd52b5b5e8b58e5e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefDate</a>(<b>ref double</b> <span id="r16 rd" class="r16 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r16 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>);
        }
 
        <span class="c">// VT_BSTR</span>
 
        <b>public void</b> <a id="0d3405331f8fd623" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefBstr</a>(<b>ref</b> <span class="i">IntPtr</span> <span id="r17 rd" class="r17 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r17 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>);
        }
 
        <span class="c">// VT_UNKNOWN</span>
 
        <b>public void</b> <a id="8843783a69e34900" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefUnknown</a>(<b>ref</b> <span class="i">IntPtr</span> <span id="r18 rd" class="r18 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r18 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>);
        }
 
        <span class="c">// VT_DISPATCH</span>
 
        <b>public void</b> <a id="7d4358175bfc8f9b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefDispatch</a>(<b>ref</b> <span class="i">IntPtr</span> <span id="r19 rd" class="r19 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r19 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>);
        }
 
        <span class="c">// VT_VARIANT</span>
 
        <b>public object</b> <a id="240b2f4470bbb80a" href="../../R/240b2f4470bbb80a.html" target="n" data-glyph="102,1" class="i property">AsVariant</a>
        {
            <b>get</b>
            {
                <b>return</b> <span class="i">Marshal</span>.<span class="i">GetObjectForNativeVariant</span>(<a href="ComRuntimeHelpers.cs.html#4f4b31ce559633ec" class="t t">UnsafeMethods</a>.<a href="ComRuntimeHelpers.cs.html#abd69e7b14b8252f" class="i method">ConvertVariantByrefToPtr</a>(<b>ref</b> <a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>));
            }
 
            <b>set</b>
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="InteropServices/Variant.cs.html#d366944fd6f61826" class="i property">IsEmpty</a>); <span class="c">// The setter can only be called once as VariantClear might be needed otherwise</span>
                <b>if</b> (<b>value</b> != <b>null</b>)
                {
                    <a href="ComRuntimeHelpers.cs.html#4f4b31ce559633ec" class="t t">UnsafeMethods</a>.<a href="ComRuntimeHelpers.cs.html#32a2b75df5dbe870" class="i method">InitVariantForObject</a>(<b>value</b>, <b>ref</b> <a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="k">this</a>);
                }
            }
        }
 
        <b>public void</b> <a id="eb68f862519b0d19" href="../../R/eb68f862519b0d19.html" target="n" data-glyph="72,1" class="i method">SetAsByrefVariant</a>(<b>ref</b> <a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a> <span id="r20 rd" class="r20 r">value</span>)
        {
            <span class="i">SetAsByref</span>(<b>ref</b> <span class="r20 r">value</span>, <span class="i">VarEnum</span>.<span class="i">VT_VARIANT</span>);
        }
 
        <span class="c">// constructs a ByRef variant to pass contents of another variant ByRef.</span>
        <b>public unsafe void</b> <a id="767f9807c3b76000" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsByrefVariantIndirect</a>(<b>ref</b> <a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a> <span id="r21 rd" class="r21 r">value</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="InteropServices/Variant.cs.html#d366944fd6f61826" class="i property">IsEmpty</a>); <span class="c">// The setter can only be called once as VariantClear might be needed otherwise</span>
            <span class="i">Debug</span>.<span class="i">Assert</span>((<span class="r21 r">value</span>.<a href="InteropServices/Variant.cs.html#dac97475f7b5bf7d" class="i property">VariantType</a> &amp; <span class="i">VarEnum</span>.<span class="i">VT_BYREF</span>) == 0, <span class="s">&quot;double indirection&quot;</span>);
 
            <b>switch</b> (<span class="r21 r">value</span>.<a href="InteropServices/Variant.cs.html#dac97475f7b5bf7d" class="i property">VariantType</a>)
            {
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_EMPTY</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_NULL</span>:
                    <span class="c">// these cannot combine with VT_BYREF. Should try passing as a variant reference</span>
                    <a href="#eb68f862519b0d19" class="i method">SetAsByrefVariant</a>(<b>ref</b> <span class="r21 r">value</span>);
                    <b>return</b>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_RECORD</span>:
                    <span class="c">// VT_RECORD&#39;s are weird in that regardless of is the VT_BYREF flag is set or not</span>
                    <span class="c">// they have the same internal representation.</span>
                    <a href="InteropServices/Variant.cs.html#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="InteropServices/Variant.cs.html#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="InteropServices/Variant.cs.html#ad9ab70a845a1f1c" class="i field">_record</a> = <span class="r21 r">value</span>.<a href="InteropServices/Variant.cs.html#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="InteropServices/Variant.cs.html#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="InteropServices/Variant.cs.html#ad9ab70a845a1f1c" class="i field">_record</a>;
                    <b>break</b>;
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>:
                    <a href="InteropServices/Variant.cs.html#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="InteropServices/Variant.cs.html#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="InteropServices/Variant.cs.html#a3320eed532b91cf" class="i field">_byref</a> = (<span class="i">IntPtr</span>)<span class="i">Unsafe</span>.<span class="i">AsPointer</span>(<b>ref</b> <span class="r21 r">value</span>.<a href="InteropServices/Variant.cs.html#fbc16e848a3e3bdc" class="i field">_decimal</a>);
                    <b>break</b>;
                <b>default</b>:
                    <a href="InteropServices/Variant.cs.html#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="InteropServices/Variant.cs.html#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="InteropServices/Variant.cs.html#a3320eed532b91cf" class="i field">_byref</a> = (<span class="i">IntPtr</span>)<span class="i">Unsafe</span>.<span class="i">AsPointer</span>(<b>ref</b> <span class="r21 r">value</span>.<a href="InteropServices/Variant.cs.html#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="InteropServices/Variant.cs.html#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="InteropServices/Variant.cs.html#a3320eed532b91cf" class="i field">_byref</a>);
                    <b>break</b>;
            }
            <a href="InteropServices/Variant.cs.html#dac97475f7b5bf7d" class="i property">VariantType</a> = (<span class="r21 r">value</span>.<a href="InteropServices/Variant.cs.html#dac97475f7b5bf7d" class="i property">VariantType</a> | <span class="i">VarEnum</span>.<span class="i">VT_BYREF</span>);
        }
 
        <b>private unsafe void</b> <a id="adb0f2f67c45e8dd" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SetAsByref</a>&lt;<span id="r22 rd t" class="r22 r t">T</span>&gt;(<b>ref</b> <span class="r22 r t">T</span> <span id="r23 rd" class="r23 r">value</span>, <span class="i">VarEnum</span> <span id="r24 rd" class="r24 r">type</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="InteropServices/Variant.cs.html#d366944fd6f61826" class="i property">IsEmpty</a>); <span class="c">// The setter can only be called once as VariantClear might be needed otherwise</span>
            <a href="InteropServices/Variant.cs.html#dac97475f7b5bf7d" class="i property">VariantType</a> = <span class="r24 r">type</span> | <span class="i">VarEnum</span>.<span class="i">VT_BYREF</span>;
            <a href="InteropServices/Variant.cs.html#5355ff11744b044e" class="i field">_typeUnion</a>.<a href="InteropServices/Variant.cs.html#f0790d4f4da813a4" class="i field">_unionTypes</a>.<a href="InteropServices/Variant.cs.html#a3320eed532b91cf" class="i field">_byref</a> = (<span class="i">IntPtr</span>)<span class="i">Unsafe</span>.<span class="i">AsPointer</span>&lt;<span class="r22 r t">T</span>&gt;(<b>ref</b> <span class="r23 r">value</span>);
        }
 
        <b>internal static</b> <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">PropertyInfo</span> <a id="93053aaa872d4585" href="../../R/93053aaa872d4585.html" target="n" data-glyph="74,1" class="i method">GetAccessor</a>(<span class="i">VarEnum</span> <span id="r25 rd" class="r25 r">varType</span>)
        {
            <b>switch</b> (<span class="r25 r">varType</span>)
            {
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I1</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#ea2cae688bcb119f" class="i property">AsI1</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I2</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#2c83f4ea7d70e81a" class="i property">AsI2</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I4</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#6140fd954a909738" class="i property">AsI4</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I8</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#e4ba8a30c83ea180" class="i property">AsI8</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#fe634ce032c96366" class="i property">AsUi1</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#df2c289dd49cb929" class="i property">AsUi2</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#ed873929794b1a0b" class="i property">AsUi4</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#0c81e6ed1f0d63e9" class="i property">AsUi8</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_INT</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#21a0854391ac26f5" class="i property">AsInt</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#3b7438a430ce4154" class="i property">AsUint</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#62e95e887c7e1fb6" class="i property">AsBool</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#0c0d0b6beea59b9a" class="i property">AsError</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R4</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#fb154b5a0bf16065" class="i property">AsR4</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R8</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#343c04b28c104074" class="i property">AsR8</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#56748e083b80db3b" class="i property">AsDecimal</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_CY</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#71b176626986d7b6" class="i property">AsCy</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#7558daf978adbbe2" class="i property">AsDate</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#3bba15a86495c862" class="i property">AsBstr</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#9cbab7fe1b3183f3" class="i property">AsUnknown</a>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="InteropServices/Variant.cs.html#43f22204909bf424" class="i property">AsDispatch</a>));
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_VARIANT</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_RECORD</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_ARRAY</span>:
                    <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="#240b2f4470bbb80a" class="i property">AsVariant</a>));
 
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
            }
        }
 
        <b>internal static</b> <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">MethodInfo</span> <a id="3ee219d8ec8722ec" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetByrefSetter</a>(<span class="i">VarEnum</span> <span id="r26 rd" class="r26 r">varType</span>)
        {
            <b>switch</b> (<span class="r26 r">varType</span>)
            {
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I1</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefI1</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I2</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefI2</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I4</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefI4</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_I8</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefI8</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI1</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefUi1</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI2</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefUi2</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI4</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefUi4</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UI8</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefUi8</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_INT</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefInt</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UINT</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefUint</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BOOL</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefBool</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_ERROR</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefError</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R4</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefR4</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_R8</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefR8</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DECIMAL</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefDecimal</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_CY</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefCy</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DATE</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefDate</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_BSTR</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefBstr</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_UNKNOWN</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefUnknown</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_DISPATCH</span>: <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefDispatch</span>));
 
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_VARIANT</span>:
                    <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefVariant</span>));
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_RECORD</span>:
                <b>case</b> <span class="i">VarEnum</span>.<span class="i">VT_ARRAY</span>:
                    <b>return</b> <b>typeof</b>(<a href="../../P/8d6f8cfa0d0f7877.html#8d6f8cfa0d0f7877" class="t t">Variant</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">SetAsByrefVariantIndirect</span>));
 
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
            }
        }
 
        <b>public override string</b> <a id="8d72850e6929bfec" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;Variant ({0})&quot;</span>, <a href="InteropServices/Variant.cs.html#dac97475f7b5bf7d" class="i property">VariantType</a>);
        }
 
        <b>public void</b> <a id="aae2f588bd5816fe" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetAsIConvertible</a>(<span class="i">IConvertible</span> <span id="r27 rd" class="r27 r">value</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="InteropServices/Variant.cs.html#d366944fd6f61826" class="i property">IsEmpty</a>); <span class="c">// The setter can only be called once as VariantClear might be needed otherwise</span>
 
            <span class="i">TypeCode</span> <span id="r28 rd" class="r28 r">tc</span> = <span class="r27 r">value</span>.<span class="i">GetTypeCode</span>();
            <span class="i">CultureInfo</span> <span id="r29 rd" class="r29 r">ci</span> = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>;
 
            <b>switch</b> (<span class="r28 r">tc</span>)
            {
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Empty</span>: <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Object</span>: <a href="InteropServices/Variant.cs.html#9cbab7fe1b3183f3" class="i property">AsUnknown</a> = <span class="r27 r">value</span>; <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">DBNull</span>: <a href="InteropServices/Variant.cs.html#3e564dd3365d4a52" class="i method">SetAsNULL</a>(); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Boolean</span>: <a href="InteropServices/Variant.cs.html#62e95e887c7e1fb6" class="i property">AsBool</a> = <span class="r27 r">value</span>.<span class="i">ToBoolean</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Char</span>: <a href="InteropServices/Variant.cs.html#df2c289dd49cb929" class="i property">AsUi2</a> = <span class="r27 r">value</span>.<span class="i">ToChar</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">SByte</span>: <a href="InteropServices/Variant.cs.html#ea2cae688bcb119f" class="i property">AsI1</a> = <span class="r27 r">value</span>.<span class="i">ToSByte</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Byte</span>: <a href="InteropServices/Variant.cs.html#fe634ce032c96366" class="i property">AsUi1</a> = <span class="r27 r">value</span>.<span class="i">ToByte</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int16</span>: <a href="InteropServices/Variant.cs.html#2c83f4ea7d70e81a" class="i property">AsI2</a> = <span class="r27 r">value</span>.<span class="i">ToInt16</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt16</span>: <a href="InteropServices/Variant.cs.html#df2c289dd49cb929" class="i property">AsUi2</a> = <span class="r27 r">value</span>.<span class="i">ToUInt16</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int32</span>: <a href="InteropServices/Variant.cs.html#6140fd954a909738" class="i property">AsI4</a> = <span class="r27 r">value</span>.<span class="i">ToInt32</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt32</span>: <a href="InteropServices/Variant.cs.html#ed873929794b1a0b" class="i property">AsUi4</a> = <span class="r27 r">value</span>.<span class="i">ToUInt32</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int64</span>: <a href="InteropServices/Variant.cs.html#e4ba8a30c83ea180" class="i property">AsI8</a> = <span class="r27 r">value</span>.<span class="i">ToInt64</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt64</span>: <a href="InteropServices/Variant.cs.html#e4ba8a30c83ea180" class="i property">AsI8</a> = <span class="r27 r">value</span>.<span class="i">ToInt64</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Single</span>: <a href="InteropServices/Variant.cs.html#fb154b5a0bf16065" class="i property">AsR4</a> = <span class="r27 r">value</span>.<span class="i">ToSingle</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Double</span>: <a href="InteropServices/Variant.cs.html#343c04b28c104074" class="i property">AsR8</a> = <span class="r27 r">value</span>.<span class="i">ToDouble</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Decimal</span>: <a href="InteropServices/Variant.cs.html#56748e083b80db3b" class="i property">AsDecimal</a> = <span class="r27 r">value</span>.<span class="i">ToDecimal</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">DateTime</span>: <a href="InteropServices/Variant.cs.html#7558daf978adbbe2" class="i property">AsDate</a> = <span class="r27 r">value</span>.<span class="i">ToDateTime</span>(<span class="r29 r">ci</span>); <b>break</b>;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">String</span>: <a href="InteropServices/Variant.cs.html#3bba15a86495c862" class="i property">AsBstr</a> = <span class="r27 r">value</span>.<span class="i">ToString</span>(<span class="r29 r">ci</span>); <b>break</b>;
 
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
