<!DOCTYPE html>
<html><head><title>ComInterop.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(59);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ComInterop/ComInterop.cs" target="_top">engine\ComInterop\ComInterop.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Licensed to the .NET Foundation under one or more agreements.</span>
<span class="c">// The .NET Foundation licenses this file to you under the MIT license.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i">ComTypes</span> = <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>.<span class="i">ComTypes</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">ComInterop</span>
{
    [<span class="i">ComImport</span>]
    [<span class="i">InterfaceType</span>(<span class="i">ComInterfaceType</span>.<span class="i">InterfaceIsIUnknown</span>)]
    [<span class="i">Guid</span>(<a href="../../../GuidAssembly/R/00020400-0000-0000-c000-000000000046.html" target="n" class="s">&quot;00020400-0000-0000-C000-000000000046&quot;</a>)]
    <b>internal interface</b> <a id="059da79bb31bc43f" href="../../R/059da79bb31bc43f.html" target="n" data-glyph="50,0" class="t t">IDispatch</a>
    {
        [<span class="i">PreserveSig</span>]
        <b>int</b> <a id="0be07ce78598ca6e" href="../../R/0be07ce78598ca6e.html" target="n" data-glyph="72,1" class="i method">TryGetTypeInfoCount</a>(<b>out uint</b> <span id="r0 rd" class="r0 r">pctinfo</span>);
 
        [<span class="i">PreserveSig</span>]
        <b>int</b> <a id="43a0035d76804c7f" href="../../R/43a0035d76804c7f.html" target="n" data-glyph="72,1" class="i method">TryGetTypeInfo</a>(<b>uint</b> <span id="r1 rd" class="r1 r">iTInfo</span>, <b>int</b> <span id="r2 rd" class="r2 r">lcid</span>, <b>out</b> <span class="i">IntPtr</span> <span id="r3 rd" class="r3 r">info</span>);
 
        [<span class="i">PreserveSig</span>]
        <b>int</b> <a id="da6199839610eaaf" href="../../R/da6199839610eaaf.html" target="n" data-glyph="72,1" class="i method">TryGetIDsOfNames</a>(
            <b>ref</b> <span class="i">Guid</span> <span id="r4 rd" class="r4 r">iid</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPArray</span>, <span class="i">ArraySubType</span> = <span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>, <span class="i">SizeParamIndex</span> = 2)]
            <b>string</b>[] <span id="r5 rd" class="r5 r">names</span>,
            <b>uint</b> <span id="r6 rd" class="r6 r">cNames</span>,
            <b>int</b> <span id="r7 rd" class="r7 r">lcid</span>,
            [<span class="i">Out</span>]
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPArray</span>, <span class="i">ArraySubType</span> = <span class="i">UnmanagedType</span>.<span class="i">I4</span>, <span class="i">SizeParamIndex</span> = 2)]
            <b>int</b>[] <span id="r8 rd" class="r8 r">rgDispId</span>);
 
        [<span class="i">PreserveSig</span>]
        <b>int</b> <a id="d73c2c615834b270" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TryInvoke</a>(
            <b>int</b> <span id="r9 rd" class="r9 r">dispIdMember</span>,
            <b>ref</b> <span class="i">Guid</span> <span id="r10 rd" class="r10 r">riid</span>,
            <b>int</b> <span id="r11 rd" class="r11 r">lcid</span>,
            <span class="i">ComTypes</span>.<span class="i">INVOKEKIND</span> <span id="r12 rd" class="r12 r">wFlags</span>,
            <b>ref</b> <span class="i">ComTypes</span>.<span class="i">DISPPARAMS</span> <span id="r13 rd" class="r13 r">pDispParams</span>,
            <span class="i">IntPtr</span> <span id="r14 rd" class="r14 r">VarResult</span>,
            <span class="i">IntPtr</span> <span id="r15 rd" class="r15 r">pExcepInfo</span>,
            <span class="i">IntPtr</span> <span id="r16 rd" class="r16 r">puArgErr</span>);
    }
 
    [<span class="i">ComImport</span>]
    [<span class="i">InterfaceType</span>(<span class="i">ComInterfaceType</span>.<span class="i">InterfaceIsIUnknown</span>)]
    [<span class="i">Guid</span>(<a href="../../../GuidAssembly/R/b196b283-bab4-101a-b69c-00aa00341d07.html" target="n" class="s">&quot;B196B283-BAB4-101A-B69C-00AA00341D07&quot;</a>)]
    <b>internal interface</b> <a id="bea69bf97a8f673b" href="../../R/bea69bf97a8f673b.html" target="n" data-glyph="50,0" class="t t">IProvideClassInfo</a>
    {
        <b>void</b> <a id="33278ae5225642b8" href="../../R/33278ae5225642b8.html" target="n" data-glyph="72,1" class="i method">GetClassInfo</a>(<b>out</b> <span class="i">IntPtr</span> <span id="r17 rd" class="r17 r">info</span>);
    }
 
    <b>internal static class</b> <a id="46f652ef43c33cbc" href="../../R/46f652ef43c33cbc.html" target="n" data-glyph="2,0" class="t t">ComDispIds</a>
    {
        <b>internal const int</b> <a id="8dfe02ccb4209aff" href="../../R/8dfe02ccb4209aff.html" target="n" data-glyph="8,1" class="i field">DISPID_VALUE</a> = 0;
        <b>internal const int</b> <a id="d0e5b2300ecbcc6f" href="../../R/d0e5b2300ecbcc6f.html" target="n" data-glyph="8,1" class="i field">DISPID_PROPERTYPUT</a> = -3;
        <b>internal const int</b> <a id="079f353d8fd431f9" href="../../R/079f353d8fd431f9.html" target="n" data-glyph="8,1" class="i field">DISPID_NEWENUM</a> = -4;
    }
}
</pre></td></tr></table></div></body></html>
