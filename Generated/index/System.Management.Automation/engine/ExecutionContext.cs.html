<!DOCTYPE html>
<html><head><title>ExecutionContext.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1622);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ExecutionContext.cs" target="_top">engine\ExecutionContext.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class contains the execution context that gets passed</span>
    <span class="c">///</span><span class="c"> around to commands. This is all of the information that lets you get</span>
    <span class="c">///</span><span class="c"> at session state and the host interfaces.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="130bda5418e8559c" href="../R/130bda5418e8559c.html" target="n" data-glyph="2,0" class="t t">ExecutionContext</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The events received by this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="EventManager.cs.html#88db4bace82161f0" class="t t">PSLocalEventManager</a> <a id="67642aa960214ec5" href="../R/67642aa960214ec5.html" target="n" data-glyph="104,1" class="i property">Events</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="57a7d9d22f06323e" href="../R/57a7d9d22f06323e.html" target="n" data-glyph="104,1" class="i property">AutoLoadingModuleInProgress</a> { <b>get</b>; } = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The debugger for the interpreter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a> <a id="3e56b2d709de0d80" href="../R/3e56b2d709de0d80.html" target="n" data-glyph="104,1" class="i property">Debugger</a>
        {
            <b>get</b> { <b>return</b> <a href="#4dc9c33caa8ec2df" class="i field">_debugger</a>; }
        }
 
        <b>internal</b> <a href="debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a> <a id="4dc9c33caa8ec2df" href="../R/4dc9c33caa8ec2df.html" target="n" data-glyph="44,1" class="i field">_debugger</a>;
 
        <b>internal int</b> <a id="00e6fdde4b76eb15" href="../R/00e6fdde4b76eb15.html" target="n" data-glyph="44,1" class="i field">_debuggingMode</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reset or clear the various context managers so the runspace can be reused without contamination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e2918cff2882c87b" href="../R/e2918cff2882c87b.html" target="n" data-glyph="74,1" class="i method">ResetManagers</a>()
        {
            <b>if</b> (<a href="#4dc9c33caa8ec2df" class="i field">_debugger</a> != <b>null</b>)
            {
                <a href="#4dc9c33caa8ec2df" class="i field">_debugger</a>.<a href="debugger/debugger.cs.html#9013326d18e74225" class="i method">ResetDebugger</a>();
            }
 
            <b>if</b> (<a href="#67642aa960214ec5" class="i property">Events</a> != <b>null</b>)
            {
                <a href="#67642aa960214ec5" class="i property">Events</a>.<a href="EventManager.cs.html#a60d9ba6a29ad13b" class="i method">Dispose</a>();
            }
 
            <a href="#67642aa960214ec5" class="i property">Events</a> = <b>new</b> <a href="EventManager.cs.html#7d7e356843375ef8" class="t constructor">PSLocalEventManager</a>(<a href="#130bda5418e8559c" class="k">this</a>);
            <b>if</b> (<a href="#130bda5418e8559c" class="k">this</a>.<a href="#dd411801c1b013c6" class="i field">transactionManager</a> != <b>null</b>)
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#dd411801c1b013c6" class="i field">transactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#ea885a0401b9f379" class="i method">Dispose</a>();
            }
 
            <a href="#130bda5418e8559c" class="k">this</a>.<a href="#dd411801c1b013c6" class="i field">transactionManager</a> = <b>new</b> <span class="t">PSTransactionManager</span>();
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The tracing mode for the interpreter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">True if tracing is turned on, false if it&#39;s turned off.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="0b681c156010f201" href="../R/0b681c156010f201.html" target="n" data-glyph="104,1" class="i property">PSDebugTraceLevel</a>
        {
            <b>get</b>
            {
                <span class="c">// Pretend that tracing is off if ignoreScriptDebug is true</span>
                <b>return</b> <a href="#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a> ? 0 : <a href="#50806c2c0e68c456" class="i field">_debugTraceLevel</a>;
            }
 
            <b>set</b>
            {
                <a href="#50806c2c0e68c456" class="i field">_debugTraceLevel</a> = <b>value</b>;
            }
        }
 
        <b>private int</b> <a id="50806c2c0e68c456" href="../R/50806c2c0e68c456.html" target="n" data-glyph="46,1" class="i field">_debugTraceLevel</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The step mode for the interpreter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">True of stepping is turned on, false if it&#39;s turned off.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="0ee8614c19edc283" href="../R/0ee8614c19edc283.html" target="n" data-glyph="104,1" class="i property">PSDebugTraceStep</a>
        {
            <b>get</b>
            {
                <span class="c">// Pretend that tracing is off if ignoreScriptDebug is true</span>
                <b>return</b> !<a href="#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a> &amp;&amp; <a href="#a3e843512effd92a" class="i field">_debugTraceStep</a>;
            }
 
            <b>set</b>
            {
                <a href="#a3e843512effd92a" class="i field">_debugTraceStep</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="a3e843512effd92a" href="../R/a3e843512effd92a.html" target="n" data-glyph="46,1" class="i field">_debugTraceStep</a>;
 
        <span class="c">// Helper for generated code to handle running w/ no execution context</span>
        <b>internal static bool</b> <a id="034bbcb6ea75b17d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsStrictVersion</a>(<a href="#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r0 rd" class="r0 r">context</span>, <b>int</b> <span id="r1 rd" class="r1 r">majorVersion</span>)
        {
            <b>if</b> (<span class="r0 r">context</span> == <b>null</b>)
            {
                <span class="r0 r">context</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            }
 
            <b>return</b> (<span class="r0 r">context</span> != <b>null</b>) &amp;&amp; <span class="r0 r">context</span>.<a href="#11a9985b406aed68" class="i method">IsStrictVersion</a>(<span class="r1 r">majorVersion</span>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check to see a specific version of strict mode is enabled.  The check is always scoped,</span>
        <span class="c">///</span><span class="c"> even though in version 1 the check was engine wide.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">majorVersion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The version for a strict check about to be performed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="11a9985b406aed68" href="../R/11a9985b406aed68.html" target="n" data-glyph="74,1" class="i method">IsStrictVersion</a>(<b>int</b> <span id="r2 rd" class="r2 r">majorVersion</span>)
        {
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r3 rd" class="r3 r">scope</span> = <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>;
            <b>while</b> (<span class="r3 r">scope</span> != <b>null</b>)
            {
                <span class="c">// If StrictModeVersion is null, we haven&#39;t seen set-strictmode, so check the parent scope.</span>
                <b>if</b> (<span class="r3 r">scope</span>.<a href="SessionStateScope.cs.html#1a4f72ac80cc8c14" class="i property">StrictModeVersion</a> != <b>null</b>)
                {
                    <span class="c">// If StrictModeVersion is not null, just check the major version.  A version of 0</span>
                    <span class="c">// is the same as off to make this a simple check.</span>
                    <b>return</b> (<span class="r3 r">scope</span>.<a href="SessionStateScope.cs.html#1a4f72ac80cc8c14" class="i property">StrictModeVersion</a>.<span class="i">Major</span> &gt;= <span class="r2 r">majorVersion</span>);
                }
                <span class="c">// We shouldn&#39;t check global scope if we were in a module.</span>
                <b>if</b> (<span class="r3 r">scope</span> == <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateScopeAPIs.cs.html#59eeece84e54dc1f" class="i property">ModuleScope</a>)
                {
                    <b>break</b>;
                }
 
                <span class="r3 r">scope</span> = <span class="r3 r">scope</span>.<a href="SessionStateScope.cs.html#ec04fff24436a018" class="i property">Parent</a>;
            }
 
            <span class="c">// set-strictmode hasn&#39;t been used.</span>
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is true if the current statement in the interpreter should be traced...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6cd076ce305ba4ac" href="../R/6cd076ce305ba4ac.html" target="n" data-glyph="104,1" class="i property">ShouldTraceStatement</a>
        {
            <b>get</b>
            {
                <span class="c">// Pretend that tracing is off if ignoreScriptDebug is true</span>
                <b>return</b> !<a href="#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a> &amp;&amp; (<a href="#50806c2c0e68c456" class="i field">_debugTraceLevel</a> &gt; 0 || <a href="#a3e843512effd92a" class="i field">_debugTraceStep</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, then a script command processor should rethrow the exit exception instead of</span>
        <span class="c">///</span><span class="c"> simply capturing it. This is used by the -file option on the console host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="da0268d4cb08ef32" href="../R/da0268d4cb08ef32.html" target="n" data-glyph="104,1" class="i property">ScriptCommandProcessorShouldRethrowExit</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this flag is set to true, script trace output</span>
        <span class="c">///</span><span class="c"> will not be generated regardless of the state of the</span>
        <span class="c">///</span><span class="c"> trace flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The current state of the IgnoreScriptDebug flag.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="49b9b435e62c31c2" href="../R/49b9b435e62c31c2.html" target="n" data-glyph="104,1" class="i property">IgnoreScriptDebug</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the automation engine instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="AutomationEngine.cs.html#0c7ddddd2aba0cae" class="t t">AutomationEngine</a> <a id="7b897dde7067af78" href="../R/7b897dde7067af78.html" target="n" data-glyph="104,1" class="i property">Engine</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal</b> <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="2a82be710f3773ae" href="../R/2a82be710f3773ae.html" target="n" data-glyph="104,1" class="i property">InitialSessionState</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Added for Win8: 336382</span>
        <span class="c">///</span><span class="c"> Contains the name of the previous module that was processed. This</span>
        <span class="c">///</span><span class="c"> allows you to skip this module when doing a lookup.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="0e5d8bea34e7810f" href="../R/0e5d8bea34e7810f.html" target="n" data-glyph="104,1" class="i property">PreviousModuleProcessed</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Added for 4980967</span>
        <span class="c">///</span><span class="c"> Contains the name of the latest module that was imported,</span>
        <span class="c">///</span><span class="c"> Allows &quot;module\function&quot; to call the function from latest imported module instead of randomly choosing the first module in the moduletable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Hashtable</span> <a id="6fbdd167e636c979" href="../R/6fbdd167e636c979.html" target="n" data-glyph="104,1" class="i property">previousModuleImported</a> { <b>get</b>; <b>set</b>; } = <b>new</b> <span class="i">Hashtable</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Contains the name of the module currently being processed. This</span>
        <span class="c">///</span><span class="c"> allows you to skip this module when doing a lookup.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="a362f3393ffdf245" href="../R/a362f3393ffdf245.html" target="n" data-glyph="104,1" class="i property">ModuleBeingProcessed</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authorization manager for this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SecurityManagerBase.cs.html#971c00f0dacd0dc9" class="t t">AuthorizationManager</a> <a id="d04f29dfc80b1390" href="../R/d04f29dfc80b1390.html" target="n" data-glyph="104,1" class="i property">AuthorizationManager</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the appropriate provider names for the default</span>
        <span class="c">///</span><span class="c"> providers based on the type of the shell</span>
        <span class="c">///</span><span class="c"> (single shell or custom shell).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ProviderNames.cs.html#3f6a7ab92cee4236" class="t t">ProviderNames</a> <a id="733af3e5592e5947" href="../R/733af3e5592e5947.html" target="n" data-glyph="104,1" class="i property">ProviderNames</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#4c873a0f9c80df7c" class="i field">_providerNames</a> == <b>null</b>)
                {
                    <a href="#4c873a0f9c80df7c" class="i field">_providerNames</a> = <b>new</b> <span class="t">SingleShellProviderNames</span>();
                }
 
                <b>return</b> <a href="#4c873a0f9c80df7c" class="i field">_providerNames</a>;
            }
        }
 
        <b>private</b> <a href="ProviderNames.cs.html#3f6a7ab92cee4236" class="t t">ProviderNames</a> <a id="4c873a0f9c80df7c" href="../R/4c873a0f9c80df7c.html" target="n" data-glyph="46,1" class="i field">_providerNames</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module information for this engine...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Modules/ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a> <a id="2d3edf63c7afa4b2" href="../R/2d3edf63c7afa4b2.html" target="n" data-glyph="104,1" class="i property">Modules</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the shellID for this runspace...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="347758c52bbd3a07" href="../R/347758c52bbd3a07.html" target="n" data-glyph="104,1" class="i property">ShellID</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#53024d2537af20b5" class="i field">_shellId</a> == <b>null</b>)
                {
                    <span class="c">// Use the ShellID from PSAuthorizationManager before everything else because that&#39;s what&#39;s used</span>
                    <span class="c">// to check execution policy...</span>
                    <b>if</b> (<a href="#d04f29dfc80b1390" class="i property">AuthorizationManager</a> <b>is</b> <a href="../security/SecurityManager.cs.html#824c306feaddc0a9" class="t t">PSAuthorizationManager</a> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#d04f29dfc80b1390" class="i property">AuthorizationManager</a>.<a href="SecurityManagerBase.cs.html#f1f043b7ef903b01" class="i property">ShellId</a>))
                    {
                        <a href="#53024d2537af20b5" class="i field">_shellId</a> = <a href="#d04f29dfc80b1390" class="i property">AuthorizationManager</a>.<a href="SecurityManagerBase.cs.html#f1f043b7ef903b01" class="i property">ShellId</a>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// Finally fall back to the default shell id...</span>
                        <a href="#53024d2537af20b5" class="i field">_shellId</a> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#afe3ed92dba2b2b0" class="i field">DefaultPowerShellShellID</a>;
                    }
                }
 
                <b>return</b> <a href="#53024d2537af20b5" class="i field">_shellId</a>;
            }
        }
 
        <b>private string</b> <a id="53024d2537af20b5" href="../R/53024d2537af20b5.html" target="n" data-glyph="46,1" class="i field">_shellId</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session State with which this instance of engine works.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <a id="07982205e4a6a726" href="../R/07982205e4a6a726.html" target="n" data-glyph="104,1" class="i property">EngineSessionState</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The default or top-level session state instance for the</span>
        <span class="c">///</span><span class="c"> engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <a id="95bc6698d12886ee" href="../R/95bc6698d12886ee.html" target="n" data-glyph="104,1" class="i property">TopLevelSessionState</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the SessionState facade for the internal session state APIs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a> <a id="4502619a6e4808ee" href="../R/4502619a6e4808ee.html" target="n" data-glyph="104,1" class="i property">SessionState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#e8d61ec8e5e7bb28" class="i property">PublicSessionState</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get/set constraints for this execution environment.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="ebe55e376f6c32fa" href="../R/ebe55e376f6c32fa.html" target="n" data-glyph="104,1" class="i property">LanguageMode</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#38191a27361dafc5" class="i field">_languageMode</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// If we&#39;re moving to ConstrainedLanguage, invalidate the binding</span>
                <span class="c">// caches. After that, the binding rules encode the language mode.</span>
                <b>if</b> (<b>value</b> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>)
                {
                    <a href="#6ec645dc27615492" class="i property">HasRunspaceEverUsedConstrainedLanguageMode</a> = <b>true</b>;
 
                    <span class="c">// If &#39;ExecutionContext.HasEverUsedConstrainedLanguage&#39; is already set to True, then we have</span>
                    <span class="c">// already invalidated all cached binders, and binders already started to generate code with</span>
                    <span class="c">// consideration of &#39;LanguageMode&#39;. In such case, we don&#39;t need to invalidate cached binders</span>
                    <span class="c">// again.</span>
                    <span class="c">// Note that when executing script blocks marked as &#39;FullLanguage&#39; in a &#39;ConstrainedLanguage&#39;</span>
                    <span class="c">// environment, we will set and Restore &#39;context.LanguageMode&#39; very often. But we should not</span>
                    <span class="c">// invalidate the cached binders every time we restore to &#39;ConstrainedLanguage&#39;.</span>
                    <b>if</b> (!<a href="#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="#f3a9373a4fcbee98" class="i property">HasEverUsedConstrainedLanguage</a>)
                    {
                        <b>lock</b> (<a href="#68a0b9f30e1a7c92" class="i field">lockObject</a>)
                        {
                            <span class="c">// If another thread has already set &#39;ExecutionContext.HasEverUsedConstrainedLanguage&#39;</span>
                            <span class="c">// while we are waiting on the lock, then nothing needs to be done.</span>
                            <b>if</b> (!<a href="#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="#f3a9373a4fcbee98" class="i property">HasEverUsedConstrainedLanguage</a>)
                            {
                                <a href="runtime/Binding/Binders.cs.html#b33a3e4647e9ce8d" class="t t">PSSetMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#ba4541a8fbb6beec" class="i method">InvalidateCache</a>();
                                <a href="runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#d2965089b6c26107" class="i method">InvalidateCache</a>();
                                <a href="runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<a href="runtime/Binding/Binders.cs.html#1897d5538460e488" class="i method">InvalidateCache</a>();
                                <a href="runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<a href="runtime/Binding/Binders.cs.html#b0329a67974161ce" class="i method">InvalidateCache</a>();
                                <a href="runtime/Binding/Binders.cs.html#f5f4b5dd1e81524d" class="t t">PSGetIndexBinder</a>.<a href="runtime/Binding/Binders.cs.html#78b1e5e356d06aca" class="i method">InvalidateCache</a>();
                                <a href="runtime/Binding/Binders.cs.html#4efa6869376d725f" class="t t">PSSetIndexBinder</a>.<a href="runtime/Binding/Binders.cs.html#4d9ffc6d5940cbcb" class="i method">InvalidateCache</a>();
                                <a href="runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>.<a href="runtime/Binding/Binders.cs.html#fa11d29e2e7f51bf" class="i method">InvalidateCache</a>();
 
                                <span class="c">// Set &#39;HasEverUsedConstrainedLanguage&#39; at the very end to guarantee other threads to wait until</span>
                                <span class="c">// all invalidation operations are done.</span>
                                <a href="#4c0f83bbf3c21b76" class="i property">UntrustedObjects</a> = <b>new</b> <span class="i">ConditionalWeakTable</span>&lt;<b>object</b>, <b>object</b>&gt;();
                                <a href="#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="#f3a9373a4fcbee98" class="i property">HasEverUsedConstrainedLanguage</a> = <b>true</b>;
                            }
                        }
                    }
                }
 
                <span class="c">// Conversion caches don&#39;t have version info / binding rules, so must be</span>
                <span class="c">// cleared every time.</span>
                <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#1992af74786afb21" class="i method">RebuildConversionCache</a>();
 
                <a href="#38191a27361dafc5" class="i field">_languageMode</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="38191a27361dafc5" href="../R/38191a27361dafc5.html" target="n" data-glyph="46,1" class="i field">_languageMode</a> = <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if this runspace has ever used constrained language mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6ec645dc27615492" href="../R/6ec645dc27615492.html" target="n" data-glyph="104,1" class="i property">HasRunspaceEverUsedConstrainedLanguageMode</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate if a parameter binding is happening that transitions the execution from ConstrainedLanguage</span>
        <span class="c">///</span><span class="c"> mode to a trusted FullLanguage command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="800d673aaa498da6" href="../R/800d673aaa498da6.html" target="n" data-glyph="104,1" class="i property">LanguageModeTransitionInParameterBinding</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if we&#39;ve ever used ConstrainedLanguage. If this is the case, then the binding restrictions</span>
        <span class="c">///</span><span class="c"> need to also validate against the language mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="f3a9373a4fcbee98" href="../R/f3a9373a4fcbee98.html" target="n" data-glyph="104,1" class="i property">HasEverUsedConstrainedLanguage</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Variable Tracking
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialized when &#39;ConstrainedLanguage&#39; is applied.</span>
        <span class="c">///</span><span class="c"> The objects contained in this table are considered to be untrusted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">ConditionalWeakTable</span>&lt;<b>object</b>, <b>object</b>&gt; <a id="4c0f83bbf3c21b76" href="../R/4c0f83bbf3c21b76.html" target="n" data-glyph="106,1" class="i property">UntrustedObjects</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper for checking if the given value is marked as untrusted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="174e087008fa944f" href="../R/174e087008fa944f.html" target="n" data-glyph="74,1" class="i method">IsMarkedAsUntrusted</a>(<b>object</b> <span id="r4 rd" class="r4 r">value</span>)
        {
            <b>bool</b> <span id="r5 rd" class="r5 r">result</span> = <b>false</b>;
            <b>var</b> <span id="r6 rd" class="r6 r">baseValue</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r4 r">value</span>);
            <b>if</b> (<span class="r6 r">baseValue</span> != <b>null</b> &amp;&amp; <span class="r6 r">baseValue</span> != <a href="NullString.cs.html#6505e7ba37d945c1" class="t t">NullString</a>.<a href="NullString.cs.html#c6e89370d6a0b11d" class="i property">Value</a>)
            {
                <b>object</b> <span id="r7 rd" class="r7 r">unused</span>;
                <span class="r5 r">result</span> = <a href="#4c0f83bbf3c21b76" class="i property">UntrustedObjects</a>.<span class="i">TryGetValue</span>(<span class="r6 r">baseValue</span>, <b>out</b> <span class="r7 r">unused</span>);
            }
 
            <b>return</b> <span class="r5 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper for marking a value as untrusted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="6ffdecb5ab5d141e" href="../R/6ffdecb5ab5d141e.html" target="n" data-glyph="74,1" class="i method">MarkObjectAsUntrusted</a>(<b>object</b> <span id="r8 rd" class="r8 r">value</span>)
        {
            <span class="c">// If the value is a PSObject, then we mark its base object untrusted</span>
            <b>var</b> <span id="r9 rd" class="r9 r">baseValue</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r8 r">value</span>);
            <b>if</b> (<span class="r9 r">baseValue</span> != <b>null</b> &amp;&amp; <span class="r9 r">baseValue</span> != <a href="NullString.cs.html#6505e7ba37d945c1" class="t t">NullString</a>.<a href="NullString.cs.html#c6e89370d6a0b11d" class="i property">Value</a>)
            {
                <span class="c">// It&#39;s actually setting a key value pair when the key doesn&#39;t exist</span>
                <a href="#4c0f83bbf3c21b76" class="i property">UntrustedObjects</a>.<span class="i">GetValue</span>(<span class="r9 r">baseValue</span>, <b>static</b> <span id="r10 rd" class="r10 r">key</span> =&gt; <b>null</b>);
 
                <b>try</b>
                {
                    <span class="c">// If it&#39;s a PSReference object, we need to also mark the value it&#39;s holding on.</span>
                    <span class="c">// This could result in a recursion if psRef.Value points to itself directly or indirectly, so we check if psRef.Value is already</span>
                    <span class="c">// marked before making a recursive call. The additional check adds extra overhead for handling PSReference object, but it should</span>
                    <span class="c">// be rare in practice.</span>
                    <a href="MshReference.cs.html#7363a2660b89f253" class="k">var</a> <span id="r11 rd" class="r11 r">psRef</span> = <span class="r9 r">baseValue</span> <b>as</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>;
                    <b>if</b> (<span class="r11 r">psRef</span> != <b>null</b> &amp;&amp; !<a href="#174e087008fa944f" class="i method">IsMarkedAsUntrusted</a>(<span class="r11 r">psRef</span>.<a href="MshReference.cs.html#a5028a25660cef18" class="i property">Value</a>))
                    {
                        <a href="#6ffdecb5ab5d141e" class="i method">MarkObjectAsUntrusted</a>(<span class="r11 r">psRef</span>.<a href="MshReference.cs.html#a5028a25660cef18" class="i property">Value</a>);
                    }
                }
                <b>catch</b> { <span class="c">/* psRef.Value may call PSVariable.Value under the hood, which may throw arbitrary exception */</span> }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper for setting the untrusted value of an assignment to either a &#39;Global:&#39; variable, or a &#39;Script:&#39; variable in a module scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is for tracking assignment to global variables and module script scope varaibles in ConstrainedLanguage mode. Those variables</span>
        <span class="c">///</span><span class="c"> can go across boundaries between ConstrainedLanguage and FullLanguage, and make it easy for a trusted script to use data from an untrusted</span>
        <span class="c">///</span><span class="c"> environment. Therefore, in ConstrainedLanguage mode, we need to mark the value objects assigned to those variables as untrusted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="c15a3f5eeeb61bab" href="../R/c15a3f5eeeb61bab.html" target="n" data-glyph="74,1" class="i method">MarkObjectAsUntrustedForVariableAssignment</a>(<a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r12 rd" class="r12 r">variable</span>, <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r13 rd" class="r13 r">scope</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r14 rd" class="r14 r">sessionState</span>)
        {
            <b>if</b> (<span class="r13 r">scope</span>.<a href="SessionStateScope.cs.html#ec04fff24436a018" class="i property">Parent</a> == <b>null</b> ||  <span class="c">// If it&#39;s the global scope, OR</span>
                (<span class="r14 r">sessionState</span>.<a href="SessionState.cs.html#1900efdc2f293d5a" class="i property">Module</a> != <b>null</b> &amp;&amp;  <span class="c">// it&#39;s running in a module AND</span>
                 <span class="r13 r">scope</span>.<a href="SessionStateScope.cs.html#3f4dd09980424f44" class="i property">ScriptScope</a> == <span class="r13 r">scope</span> &amp;&amp; <span class="r13 r">scope</span>.<a href="SessionStateScope.cs.html#ec04fff24436a018" class="i property">Parent</a>.<a href="SessionStateScope.cs.html#ec04fff24436a018" class="i property">Parent</a> == <b>null</b>)) <span class="c">// it&#39;s the module&#39;s script scope (scope.Parent is global scope and scope.ScriptScope points to itself)</span>
            {
                <span class="c">// We are setting value for either a &#39;Global:&#39; variable, or a &#39;Script:&#39; variable within a module in &#39;ConstrainedLanguage&#39; mode.</span>
                <span class="c">// Global variable may be referenced within trusted script block (scriptBlock.LanguageMode == &#39;FullLanguage&#39;), and users could</span>
                <span class="c">// also set a &#39;Script:&#39; variable in a trusted module scope from &#39;ConstrainedLanguage&#39; environment via &#39;&amp; $mo { $script:&lt;var&gt; }&#39;.</span>
                <span class="c">// So we need to mark the value as untrusted.</span>
                <a href="#6ffdecb5ab5d141e" class="i method">MarkObjectAsUntrusted</a>(<span class="r12 r">variable</span>.<a href="ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The result object is assumed generated by operating on the original object.</span>
        <span class="c">///</span><span class="c"> So if the original object is from an untrusted input source, we mark the result object as untrusted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="91bedc10554ff828" href="../R/91bedc10554ff828.html" target="n" data-glyph="74,1" class="i method">PropagateInputSource</a>(<b>object</b> <span id="r15 rd" class="r15 r">originalObject</span>, <b>object</b> <span id="r16 rd" class="r16 r">resultObject</span>, <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <span id="r17 rd" class="r17 r">currentLanguageMode</span>)
        {
            <span class="c">// The untrusted flag is populated only in FullLanguage mode and ConstrainedLanguage has been used in the process before.</span>
            <b>if</b> (<a href="#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="#f3a9373a4fcbee98" class="i property">HasEverUsedConstrainedLanguage</a> &amp;&amp; <span class="r17 r">currentLanguageMode</span> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a> &amp;&amp; <a href="#174e087008fa944f" class="i method">IsMarkedAsUntrusted</a>(<span class="r15 r">originalObject</span>))
            {
                <a href="#6ffdecb5ab5d141e" class="i method">MarkObjectAsUntrusted</a>(<span class="r16 r">resultObject</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true the PowerShell debugger will use FullLanguage mode, otherwise it will use the current language mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="7a174c9b85c175bf" href="../R/7a174c9b85c175bf.html" target="n" data-glyph="104,1" class="i property">UseFullLanguageModeInDebugger</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2a82be710f3773ae" class="i property">InitialSessionState</a> != <b>null</b> &amp;&amp; <a href="#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="InitialSessionState.cs.html#5a7555d31e4be67b" class="i property">UseFullLanguageModeInDebugger</a>;
            }
        }
 
        <b>internal static readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="06d2d8adc383b272" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">ModulesWithJobSourceAdapters</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;
            {
                <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#433d9ed78f584f39" class="i field">ScheduledJobModuleName</a>,
            };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is true if the PSScheduledJob module is loaded for this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="31af3f68067afcdf" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">IsModuleWithJobSourceAdapterLoaded</a>
        {
            <b>get</b>; <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the location globber for the session state for</span>
        <span class="c">///</span><span class="c"> this instance of the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a> <a id="287b499ae3f5652b" href="../R/287b499ae3f5652b.html" target="n" data-glyph="104,1" class="i property">LocationGlobber</a>
        {
            <b>get</b>
            {
                <a href="#d8a90a43da373e3c" class="i field">_locationGlobber</a> = <b>new</b> <a href="../namespaces/LocationGlobber.cs.html#4e39cf9c7f318f61" class="t constructor">LocationGlobber</a>(<a href="#130bda5418e8559c" class="k">this</a>.<a href="#4502619a6e4808ee" class="i property">SessionState</a>);
                <b>return</b> <a href="#d8a90a43da373e3c" class="i field">_locationGlobber</a>;
            }
        }
 
        <b>private</b> <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a> <a id="d8a90a43da373e3c" href="../R/d8a90a43da373e3c.html" target="n" data-glyph="46,1" class="i field">_locationGlobber</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The assemblies that have been loaded for this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Assembly</span>&gt; <a id="1d21e5a1ed78a821" href="../R/1d21e5a1ed78a821.html" target="n" data-glyph="104,1" class="i property">AssemblyCache</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Engine State
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The state for current engine that is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#4bbbd017613e38e6" class="t t">EngineState</a> <a id="a1c978754a850732" href="../R/a1c978754a850732.html" target="n" data-glyph="104,1" class="i property">EngineState</a> { <b>get</b>; <b>set</b>; } = <a href="#4bbbd017613e38e6" class="t t">EngineState</a>.<a href="#908496dce30a5213" class="i field">None</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> GetSetVariable methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a variable out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="3a6f9a48ec862dfb" href="../R/3a6f9a48ec862dfb.html" target="n" data-glyph="74,1" class="i method">GetVariableValue</a>(<a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r18 rd" class="r18 r">path</span>)
        {
            <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r19 rd" class="r19 r">context</span>;
            <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r20 rd" class="r20 r">scope</span>;
            <b>return</b> <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#296e9dd07cdc8e4e" class="i method">GetVariableValue</a>(<span class="r18 r">path</span>, <b>out</b> <span class="r19 r">context</span>, <b>out</b> <span class="r20 r">scope</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a variable out of session state. This calls GetVariable(name) and returns the</span>
        <span class="c">///</span><span class="c"> value unless it is null in which case it returns the defaultValue provided by the caller.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="a3916d7c99d7c52e" href="../R/a3916d7c99d7c52e.html" target="n" data-glyph="74,1" class="i method">GetVariableValue</a>(<a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r21 rd" class="r21 r">path</span>, <b>object</b> <span id="r22 rd" class="r22 r">defaultValue</span>)
        {
            <b>return</b> <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#296e9dd07cdc8e4e" class="i method">GetVariableValue</a>(<span class="r21 r">path</span>, <b>out _</b>, <b>out _</b>) ?? <span class="r22 r">defaultValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set a variable in session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="fa7f7322f772be22" href="../R/fa7f7322f772be22.html" target="n" data-glyph="74,1" class="i method">SetVariable</a>(<a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r23 rd" class="r23 r">path</span>, <b>object</b> <span id="r24 rd" class="r24 r">newValue</span>)
        {
            <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#b40287193f838b0a" class="i method">SetVariable</a>(<span class="r23 r">path</span>, <span class="r24 r">newValue</span>, <b>true</b>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
        }
 
        <b>internal</b> <span class="r25 r t">T</span> <a id="e66ab93387349c55" href="../R/e66ab93387349c55.html" target="n" data-glyph="74,1" class="i method">GetEnumPreference</a>&lt;<span id="r25 rd t" class="r25 r t">T</span>&gt;(<a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r26 rd" class="r26 r">preferenceVariablePath</span>, <span class="r25 r t">T</span> <span id="r27 rd" class="r27 r">defaultPref</span>, <b>out bool</b> <span id="r28 rd" class="r28 r">defaultUsed</span>)
        {
            <b>object</b> <span id="r29 rd" class="r29 r">val</span> = <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#296e9dd07cdc8e4e" class="i method">GetVariableValue</a>(<span class="r26 r">preferenceVariablePath</span>, <b>out _</b>, <b>out _</b>);
            <b>if</b> (<span class="r29 r">val</span> <b>is</b> <span class="r25 r t">T</span>)
            {
                <b>if</b> (<span class="r29 r">val</span> <b>is</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r30 rd" class="r30 r">actionPreferenceValue</span>)
                {
                    <a href="#0e35c0cd9a799b05" class="i method">CheckActionPreference</a>(<span class="r26 r">preferenceVariablePath</span>, <span class="r30 r">actionPreferenceValue</span>, <span class="r27 r">defaultPref</span>);
                }
 
                <span class="r25 r t">T</span> <span id="r31 rd" class="r31 r">convertedResult</span> = (<span class="r25 r t">T</span>)<span class="r29 r">val</span>;
 
                <span class="r28 r">defaultUsed</span> = <b>false</b>;
                <b>return</b> <span class="r31 r">convertedResult</span>;
            }
 
            <span class="r28 r">defaultUsed</span> = <b>true</b>;
            <span class="r25 r t">T</span> <span id="r32 rd" class="r32 r">result</span> = <span class="r27 r">defaultPref</span>;
 
            <b>if</b> (<span class="r29 r">val</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <b>string</b> <span id="r33 rd" class="r33 r">valString</span> = <span class="r29 r">val</span> <b>as string</b>;
                    <b>if</b> (<span class="r33 r">valString</span> != <b>null</b>)
                    {
                        <span class="r32 r">result</span> = (<span class="r25 r t">T</span>)<span class="i">Enum</span>.<span class="i">Parse</span>(<b>typeof</b>(<span class="r25 r t">T</span>), <span class="r33 r">valString</span>, <b>true</b>);
                        <span class="r28 r">defaultUsed</span> = <b>false</b>;
                    }
                    <b>else</b>
                    {
                        <span class="r32 r">result</span> = (<span class="r25 r t">T</span>)<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r29 r">val</span>);
                        <span class="r28 r">defaultUsed</span> = <b>false</b>;
                    }
 
                    <b>if</b> (<span class="r32 r">result</span> <b>is</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r34 rd" class="r34 r">actionPreferenceValue</span>)
                    {
                        <a href="#0e35c0cd9a799b05" class="i method">CheckActionPreference</a>(<span class="r26 r">preferenceVariablePath</span>, <span class="r34 r">actionPreferenceValue</span>, <span class="r27 r">defaultPref</span>);
                    }
                }
                <b>catch</b> (<span class="i">InvalidCastException</span>)
                {
                    <span class="c">// default value is used</span>
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                    <span class="c">// default value is used</span>
                }
            }
 
            <b>return</b> <span class="r32 r">result</span>;
        }
 
        <b>private void</b> <a id="0e35c0cd9a799b05" href="../R/0e35c0cd9a799b05.html" target="n" data-glyph="76,1" class="i method">CheckActionPreference</a>(<a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r35 rd" class="r35 r">preferenceVariablePath</span>, <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r36 rd" class="r36 r">preference</span>, <b>object</b> <span id="r37 rd" class="r37 r">defaultValue</span>)
        {
            <b>if</b> (<span class="r36 r">preference</span> == <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="CommandBase.cs.html#83da45368364b4ff" class="i field">Suspend</a>)
            {
                <span class="c">// ActionPreference.Suspend is reserved for future use. When it is used, reset</span>
                <span class="c">// the variable to its default.</span>
                <b>string</b> <span id="r38 rd" class="r38 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ErrorPackage</span>.<span class="i">ReservedActionPreferenceReplacedError</span>, <span class="r36 r">preference</span>, <span class="r35 r">preferenceVariablePath</span>.<a href="VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>, <span class="r37 r">defaultValue</span>);
                <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#b40287193f838b0a" class="i method">SetVariable</a>(<span class="r35 r">preferenceVariablePath</span>, <span class="r37 r">defaultValue</span>, <b>true</b>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
                <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<span class="r38 r">message</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Same as GetEnumPreference, but for boolean values.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">preferenceVariablePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">defaultPref</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">defaultUsed</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="0aa14c6ccdb7807d" href="../R/0aa14c6ccdb7807d.html" target="n" data-glyph="74,1" class="i method">GetBooleanPreference</a>(<a href="VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r39 rd" class="r39 r">preferenceVariablePath</span>, <b>bool</b> <span id="r40 rd" class="r40 r">defaultPref</span>, <b>out bool</b> <span id="r41 rd" class="r41 r">defaultUsed</span>)
        {
            <b>object</b> <span id="r42 rd" class="r42 r">val</span> = <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#296e9dd07cdc8e4e" class="i method">GetVariableValue</a>(<span class="r39 r">preferenceVariablePath</span>, <b>out _</b>, <b>out _</b>);
            <b>if</b> (<span class="r42 r">val</span> <b>is null</b>)
            {
                <span class="r41 r">defaultUsed</span> = <b>true</b>;
                <b>return</b> <span class="r40 r">defaultPref</span>;
            }
 
            <span class="r41 r">defaultUsed</span> = !<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>(<span class="r42 r">val</span>, <b>out bool</b> <span id="r43 rd" class="r43 r">converted</span>);
            <b>return</b> <span class="r41 r">defaultUsed</span> ? <span class="r40 r">defaultPref</span> : <span class="r43 r">converted</span>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> GetSetVariable methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> HelpSystem
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help system for this engine context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../help/HelpSystem.cs.html#c115cfdd76399004" class="t t">HelpSystem</a> <a id="a86262768086e411" href="../R/a86262768086e411.html" target="n" data-glyph="104,1" class="i property">HelpSystem</a>
        {
            <b>get</b> { <b>return</b> <a href="#0add9c56aca1d34f" class="i field">_helpSystem</a> ??= <b>new</b> <a href="../help/HelpSystem.cs.html#2ccb51801367eff2" class="t constructor">HelpSystem</a>(<a href="#130bda5418e8559c" class="k">this</a>); }
        }
 
        <b>private</b> <a href="../help/HelpSystem.cs.html#c115cfdd76399004" class="t t">HelpSystem</a> <a id="0add9c56aca1d34f" href="../R/0add9c56aca1d34f.html" target="n" data-glyph="46,1" class="i field">_helpSystem</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> FormatAndOutput
        <b>internal object</b> <a id="0114643e37dc9e5d" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">FormatInfo</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>&gt; <a id="7dcc004d95b8908e" href="../R/7dcc004d95b8908e.html" target="n" data-glyph="104,1" class="i property">CustomArgumentCompleters</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>&gt; <a id="2ad8d70b6a762159" href="../R/2ad8d70b6a762159.html" target="n" data-glyph="104,1" class="i property">NativeArgumentCompleters</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Routine to create a command(processor) instance using the factory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command to lookup.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">dotSource</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command processor object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <a id="df39c8180123370b" href="../R/df39c8180123370b.html" target="n" data-glyph="74,1" class="i method">CreateCommand</a>(<b>string</b> <span id="r44 rd" class="r44 r">command</span>, <b>bool</b> <span id="r45 rd" class="r45 r">dotSource</span>)
        {
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r46 rd" class="r46 r">commandOrigin</span> = <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>.<a href="SessionStateScope.cs.html#84d072e625b581f5" class="i property">ScopeOrigin</a>;
            <a href="CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r47 rd" class="r47 r">commandProcessor</span> =
                <a href="#586b706a65389941" class="i property">CommandDiscovery</a>.<span class="i">LookupCommandProcessor</span>(<span class="r44 r">command</span>, <span class="r46 r">commandOrigin</span>, !<span class="r45 r">dotSource</span>);
            <span class="c">// Reset the command origin for script commands... // BUGBUG - dotting can get around command origin checks???</span>
            <b>if</b> (<span class="r47 r">commandProcessor</span> != <b>null</b> &amp;&amp; <span class="r47 r">commandProcessor</span> <b>is</b> <a href="ScriptCommandProcessor.cs.html#d9f57c5c0946b36a" class="t t">ScriptCommandProcessorBase</a>)
            {
                <span class="r47 r">commandProcessor</span>.<a href="CommandProcessorBase.cs.html#f58ee453ebc82f56" class="i property">Command</a>.<a href="CommandBase.cs.html#cfb07a45be8fb7d4" class="i field">CommandOriginInternal</a> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
            }
 
            <b>return</b> <span class="r47 r">commandProcessor</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hold the current command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Reference to command discovery</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <a id="1146573afe2845c8" href="../R/1146573afe2845c8.html" target="n" data-glyph="104,1" class="i property">CurrentCommandProcessor</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Redirect to the CommandDiscovery in the engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Reference to command discovery</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a> <a id="586b706a65389941" href="../R/586b706a65389941.html" target="n" data-glyph="104,1" class="i property">CommandDiscovery</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7b897dde7067af78" class="i property">Engine</a>.<a href="AutomationEngine.cs.html#0daf75a129784612" class="i property">CommandDiscovery</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Interface that should be used for interaction with host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="hostifaces/InternalHost.cs.html#83104f2ad59a19df" class="t t">InternalHost</a> <a id="24a4a46de18d1004" href="../R/24a4a46de18d1004.html" target="n" data-glyph="104,1" class="i property">EngineHostInterface</a>
        {
            <span class="c">// set not provided: it&#39;s not meaningful to change the host post-construction.</span>
            <b>get</b>; <b>private set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Interface to be used for interaction with internal</span>
        <span class="c">///</span><span class="c"> host. InternalHost wraps the host supplied</span>
        <span class="c">///</span><span class="c"> during construction. Use this wrapper to access</span>
        <span class="c">///</span><span class="c"> functionality specific to InternalHost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="hostifaces/InternalHost.cs.html#83104f2ad59a19df" class="t t">InternalHost</a> <a id="ad328d08127401c1" href="../R/ad328d08127401c1.html" target="n" data-glyph="104,1" class="i property">InternalHost</a>
        {
            <b>get</b> { <b>return</b> <a href="#24a4a46de18d1004" class="i property">EngineHostInterface</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Interface to the public API for the engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="EngineIntrinsics.cs.html#e9f6dd7d61246066" class="t t">EngineIntrinsics</a> <a id="27c4e82ba7216ff8" href="../R/27c4e82ba7216ff8.html" target="n" data-glyph="104,1" class="i property">EngineIntrinsics</a>
        {
            <b>get</b> { <b>return</b> <a href="#9cb67cd605a1b301" class="i field">_engineIntrinsics</a> ??= <b>new</b> <a href="EngineIntrinsics.cs.html#af60998bc8ac2bda" class="t constructor">EngineIntrinsics</a>(<a href="#130bda5418e8559c" class="k">this</a>); }
        }
 
        <b>private</b> <a href="EngineIntrinsics.cs.html#e9f6dd7d61246066" class="t t">EngineIntrinsics</a> <a id="9cb67cd605a1b301" href="../R/9cb67cd605a1b301.html" target="n" data-glyph="46,1" class="i field">_engineIntrinsics</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Log context cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../logging/MshLog.cs.html#df31752f5cd4168f" class="t t">LogContextCache</a> <a id="b357c2346f3833f2" href="../R/b357c2346f3833f2.html" target="n" data-glyph="104,1" class="i property">LogContextCache</a> { <b>get</b>; } = <b>new</b> <span class="t">LogContextCache</span>();
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Output pipes
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PipelineWriter provided by the connection object for success output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a> <a id="a4a04adf9736429a" href="../R/a4a04adf9736429a.html" target="n" data-glyph="104,1" class="i property">ExternalSuccessOutput</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PipelineWriter provided by the connection object for error output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a> <a id="b62a014273263f69" href="../R/b62a014273263f69.html" target="n" data-glyph="104,1" class="i property">ExternalErrorOutput</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PipelineWriter provided by the connection object for progress output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a> <a id="e350e8c717bd137f" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">ExternalProgressOutput</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal class</b> <a id="c9eabf4b0724b3fc" href="../R/c9eabf4b0724b3fc.html" target="n" data-glyph="2,1" class="t t">SavedContextData</a>
        {
            <b>private readonly bool</b> <a id="9aad64d9132971e8" href="../R/9aad64d9132971e8.html" target="n" data-glyph="46,2" class="i field">_stepScript</a>;
            <b>private readonly bool</b> <a id="ec5d64c030eb089d" href="../R/ec5d64c030eb089d.html" target="n" data-glyph="46,2" class="i field">_ignoreScriptDebug</a>;
            <b>private readonly int</b> <a id="3850ff89243c1a50" href="../R/3850ff89243c1a50.html" target="n" data-glyph="46,2" class="i field">_PSDebug</a>;
 
            <b>private readonly</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="16fc13c6401319d2" href="../R/16fc13c6401319d2.html" target="n" data-glyph="46,2" class="i field">_shellFunctionErrorOutputPipe</a>;
 
            <b>public</b> <a id="74d3043c90b7139b" href="../R/74d3043c90b7139b.html" target="n" data-glyph="72,2" class="t constructor">SavedContextData</a>(<a href="#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r48 rd" class="r48 r">context</span>)
            {
                <a href="#9aad64d9132971e8" class="i field">_stepScript</a> = <span class="r48 r">context</span>.<a href="#0ee8614c19edc283" class="i property">PSDebugTraceStep</a>;
                <a href="#ec5d64c030eb089d" class="i field">_ignoreScriptDebug</a> = <span class="r48 r">context</span>.<a href="#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a>;
                <a href="#3850ff89243c1a50" class="i field">_PSDebug</a> = <span class="r48 r">context</span>.<a href="#0b681c156010f201" class="i property">PSDebugTraceLevel</a>;
 
                <a href="#16fc13c6401319d2" class="i field">_shellFunctionErrorOutputPipe</a> = <span class="r48 r">context</span>.<a href="#d0ed5d60dd57b004" class="i property">ShellFunctionErrorOutputPipe</a>;
            }
 
            <b>public void</b> <a id="59ddec273ae68ba3" href="../R/59ddec273ae68ba3.html" target="n" data-glyph="72,2" class="i method">RestoreContextData</a>(<a href="#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r49 rd" class="r49 r">context</span>)
            {
                <span class="r49 r">context</span>.<a href="#0ee8614c19edc283" class="i property">PSDebugTraceStep</a> = <a href="#9aad64d9132971e8" class="i field">_stepScript</a>;
                <span class="r49 r">context</span>.<a href="#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a> = <a href="#ec5d64c030eb089d" class="i field">_ignoreScriptDebug</a>;
                <span class="r49 r">context</span>.<a href="#0b681c156010f201" class="i property">PSDebugTraceLevel</a> = <a href="#3850ff89243c1a50" class="i field">_PSDebug</a>;
 
                <span class="r49 r">context</span>.<a href="#d0ed5d60dd57b004" class="i property">ShellFunctionErrorOutputPipe</a> = <a href="#16fc13c6401319d2" class="i field">_shellFunctionErrorOutputPipe</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Host uses this to saves context data when entering a nested prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#c9eabf4b0724b3fc" class="t t">SavedContextData</a> <a id="b3f92b89118fffcf" href="../R/b3f92b89118fffcf.html" target="n" data-glyph="74,1" class="i method">SaveContextData</a>()
        {
            <b>return</b> <b>new</b> <a href="#74d3043c90b7139b" class="t constructor">SavedContextData</a>(<a href="#130bda5418e8559c" class="k">this</a>);
        }
 
        <b>internal void</b> <a id="6a1fab44246ee35d" href="../R/6a1fab44246ee35d.html" target="n" data-glyph="74,1" class="i method">ResetShellFunctionErrorOutputPipe</a>()
        {
            <a href="#d0ed5d60dd57b004" class="i property">ShellFunctionErrorOutputPipe</a> = <b>null</b>;
        }
 
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="ae9b57da47a77bc5" href="../R/ae9b57da47a77bc5.html" target="n" data-glyph="74,1" class="i method">RedirectErrorPipe</a>(<a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <span id="r50 rd" class="r50 r">newPipe</span>)
        {
            <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <span id="r51 rd" class="r51 r">oldPipe</span> = <a href="#d0ed5d60dd57b004" class="i property">ShellFunctionErrorOutputPipe</a>;
            <a href="#d0ed5d60dd57b004" class="i property">ShellFunctionErrorOutputPipe</a> = <span class="r50 r">newPipe</span>;
            <b>return</b> <span class="r51 r">oldPipe</span>;
        }
 
        <b>internal void</b> <a id="3b12142fb72b35b3" href="../R/3b12142fb72b35b3.html" target="n" data-glyph="74,1" class="i method">RestoreErrorPipe</a>(<a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <span id="r52 rd" class="r52 r">pipe</span>)
        {
            <a href="#d0ed5d60dd57b004" class="i property">ShellFunctionErrorOutputPipe</a> = <span class="r52 r">pipe</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reset all of the redirection book keeping variables. This routine should be called when starting to</span>
        <span class="c">///</span><span class="c"> execute a script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="a241f0717ee10092" href="../R/a241f0717ee10092.html" target="n" data-glyph="74,1" class="i method">ResetRedirection</a>()
        {
            <a href="#d0ed5d60dd57b004" class="i property">ShellFunctionErrorOutputPipe</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Function and Script command processors will route their error output to</span>
        <span class="c">///</span><span class="c"> this pipe if set, unless explicitly routed elsewhere. We also keep track</span>
        <span class="c">///</span><span class="c"> of the first time this value is set so we can know if it&#39;s the default</span>
        <span class="c">///</span><span class="c"> error output or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="d0ed5d60dd57b004" href="../R/d0ed5d60dd57b004.html" target="n" data-glyph="104,1" class="i property">ShellFunctionErrorOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Supports expression Warning output redirection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="80808c8f0c80af72" href="../R/80808c8f0c80af72.html" target="n" data-glyph="104,1" class="i property">ExpressionWarningOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Supports expression Verbose output redirection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="885314fe59c875ff" href="../R/885314fe59c875ff.html" target="n" data-glyph="104,1" class="i property">ExpressionVerboseOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Supports expression Verbose output redirection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="51dfb51b5ba2cad5" href="../R/51dfb51b5ba2cad5.html" target="n" data-glyph="104,1" class="i property">ExpressionDebugOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Supports expression Information output redirection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="4cee430a38804d69" href="../R/4cee430a38804d69.html" target="n" data-glyph="104,1" class="i property">ExpressionInformationOutputPipe</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Output pipes
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Append to $error
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Appends the object to $global:error if it&#39;s an error record or exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ErrorRecord or Exception to be written to $global:error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> (get-only) An error occurred accessing $ERROR.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="d09d68410776a624" href="../R/d09d68410776a624.html" target="n" data-glyph="74,1" class="i method">AppendDollarError</a>(<b>object</b> <span id="r53 rd" class="r53 r">obj</span>)
        {
            <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r54 rd" class="r54 r">objAsErrorRecord</span> = <span class="r53 r">obj</span> <b>as</b> <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>;
            <b>if</b> (<span class="r54 r">objAsErrorRecord</span> == <b>null</b> &amp;&amp; <span class="r53 r">obj</span> <b>is not</b> <span class="i">Exception</span>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Object to append was neither an ErrorRecord nor an Exception in ExecutionContext.AppendDollarError&quot;</span>);
                <b>return</b>;
            }
 
            <b>object</b> <span id="r55 rd" class="r55 r">old</span> = <a href="#130bda5418e8559c" class="k">this</a>.<a href="#9f5bde284d161965" class="i property">DollarErrorVariable</a>;
            <span class="i">ArrayList</span> <span id="r56 rd" class="r56 r">arraylist</span> = <span class="r55 r">old</span> <b>as</b> <span class="i">ArrayList</span>;
            <b>if</b> (<span class="r56 r">arraylist</span> == <b>null</b>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;$error should be a global constant ArrayList&quot;</span>);
                <b>return</b>;
            }
 
            <span class="c">// Don&#39;t add the same exception twice...</span>
            <b>if</b> (<span class="r56 r">arraylist</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// There may be exceptions stored directly in which case</span>
                <span class="c">// the direct comparison will catch them...</span>
                <b>if</b> (<span class="r56 r">arraylist</span>[0] == <span class="r53 r">obj</span>)
                    <b>return</b>;
                <span class="c">// otherwise check the exception members of the error records...</span>
                <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r57 rd" class="r57 r">er1</span> = <span class="r56 r">arraylist</span>[0] <b>as</b> <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>;
 
                <b>if</b> (<span class="r57 r">er1</span> != <b>null</b> &amp;&amp; <span class="r54 r">objAsErrorRecord</span> != <b>null</b> &amp;&amp; <span class="r57 r">er1</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a> == <span class="r54 r">objAsErrorRecord</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>)
                    <b>return</b>;
            }
 
            <b>const int</b> <span id="r58 rd" class="r58 r">maxErrorCount</span> = 256;
 
            <b>int</b> <span id="r59 rd" class="r59 r">numToErase</span> = <span class="r56 r">arraylist</span>.<span class="i">Count</span> - (<span class="r58 r">maxErrorCount</span> - 1);
            <b>if</b> (<span class="r59 r">numToErase</span> &gt; 0)
            {
                <span class="r56 r">arraylist</span>.<span class="i">RemoveRange</span>(
                    <span class="r58 r">maxErrorCount</span> - 1,
                    <span class="r59 r">numToErase</span>);
            }
 
            <span class="r56 r">arraylist</span>.<span class="i">Insert</span>(0, <span class="r53 r">obj</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Scope or Commands (in pipeline) Depth Count
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the stack would overflow soon, if so, throw ScriptCallDepthException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#fa64ade1e4dc44f8" class="t t">ScriptCallDepthException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the stack would overflow soon.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="3dcd207b1b77d402" href="../R/3dcd207b1b77d402.html" target="n" data-glyph="74,1" class="i method">CheckStackDepth</a>()
        {
            <b>try</b>
            {
                <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            }
            <b>catch</b> (<span class="i">InsufficientExecutionStackException</span>)
            {
                <b>throw</b> <b>new</b> <a href="../utils/ExecutionExceptions.cs.html#307fba193d900178" class="t constructor">ScriptCallDepthException</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current connection object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="57dfb38f636ad6e9" href="../R/57dfb38f636ad6e9.html" target="n" data-glyph="46,1" class="i field">_currentRunspace</a>;
        <span class="c">// This should be internal, but it need to be friend of remoting dll.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current connection object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="98ee84b98c4d109b" href="../R/98ee84b98c4d109b.html" target="n" data-glyph="104,1" class="i property">CurrentRunspace</a>
        {
            <b>get</b> { <b>return</b> <a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a>; }
 
            <b>set</b> { <a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Each pipeline has a stack of pipeline processor. This method</span>
        <span class="c">///</span><span class="c"> pushes pp in to stack for currently executing pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">pp</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="59f954936236f028" href="../R/59f954936236f028.html" target="n" data-glyph="74,1" class="i method">PushPipelineProcessor</a>(<a href="pipeline.cs.html#5e576bcabfa5c82b" class="t t">PipelineProcessor</a> <span id="r60 rd" class="r60 r">pp</span>)
        {
            <b>if</b> (<a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a> == <b>null</b>)
                <b>return</b>;
            <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a> <span id="r61 rd" class="r61 r">lpl</span> = (<a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>)((<a href="hostifaces/ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a>)<a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a>).<a href="hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>();
            <b>if</b> (<span class="r61 r">lpl</span> == <b>null</b>)
                <b>return</b>;
            <span class="r61 r">lpl</span>.<a href="hostifaces/LocalPipeline.cs.html#e26f018d14abb8bd" class="i property">Stopper</a>.<a href="hostifaces/LocalPipeline.cs.html#93af868f31bb228a" class="i method">Push</a>(<span class="r60 r">pp</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Each pipeline has a stack of pipeline processor. This method pops the</span>
        <span class="c">///</span><span class="c"> top item from the stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e9ca865f4a03c30c" href="../R/e9ca865f4a03c30c.html" target="n" data-glyph="74,1" class="i method">PopPipelineProcessor</a>(<b>bool</b> <span id="r62 rd" class="r62 r">fromSteppablePipeline</span>)
        {
            <b>if</b> (<a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a> == <b>null</b>)
                <b>return</b>;
            <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a> <span id="r63 rd" class="r63 r">lpl</span> = (<a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>)((<a href="hostifaces/ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a>)<a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a>).<a href="hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>();
            <b>if</b> (<span class="r63 r">lpl</span> == <b>null</b>)
                <b>return</b>;
            <span class="r63 r">lpl</span>.<a href="hostifaces/LocalPipeline.cs.html#e26f018d14abb8bd" class="i property">Stopper</a>.<a href="hostifaces/LocalPipeline.cs.html#84e02447e46dfea1" class="i method">Pop</a>(<span class="r62 r">fromSteppablePipeline</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This flag is checked by parser to stop loops etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="bc7d7c4d79ef05e4" href="../R/bc7d7c4d79ef05e4.html" target="n" data-glyph="104,1" class="i property">CurrentPipelineStopping</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a> == <b>null</b>)
                    <b>return</b> <b>false</b>;
                <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a> <span id="r64 rd" class="r64 r">lpl</span> = (<a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>)((<a href="hostifaces/ConnectionBase.cs.html#b5efaa6cd9653c05" class="t t">RunspaceBase</a>)<a href="#57dfb38f636ad6e9" class="i field">_currentRunspace</a>).<a href="hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>();
                <b>if</b> (<span class="r64 r">lpl</span> == <b>null</b>)
                    <b>return</b> <b>false</b>;
                <b>return</b> <span class="r64 r">lpl</span>.<a href="hostifaces/LocalPipeline.cs.html#462590befb121390" class="i property">IsStopping</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True means one of these:</span>
        <span class="c">///</span><span class="c"> 1) there is a trap statement in a dynamically enclosing statement block that might catch an exception.</span>
        <span class="c">///</span><span class="c"> 2) execution happens inside a PS class and exceptions should be propagated all the way up, even if there is no enclosing try-catch-finally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="1d9a57911a3915e8" href="../R/1d9a57911a3915e8.html" target="n" data-glyph="104,1" class="i property">PropagateExceptionsToEnclosingStatementBlock</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <a id="e379042dcc553e8d" href="../R/e379042dcc553e8d.html" target="n" data-glyph="104,1" class="i property">CurrentExceptionBeingHandled</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shortcut to get at $?</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The current value of $? </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="1086e67bac3e5c3a" href="../R/1086e67bac3e5c3a.html" target="n" data-glyph="104,1" class="i property">QuestionMarkVariableValue</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shortcut to get at $error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The current value of $global:error </span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="9f5bde284d161965" href="../R/9f5bde284d161965.html" target="n" data-glyph="104,1" class="i property">DollarErrorVariable</a>
        {
            <b>get</b>
            {
                <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r65 rd" class="r65 r">context</span> = <b>null</b>;
                <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r66 rd" class="r66 r">scope</span> = <b>null</b>;
                <b>object</b> <span id="r67 rd" class="r67 r">resultItem</span> = <b>null</b>;
 
                <b>if</b> (!<a href="#67642aa960214ec5" class="i property">Events</a>.<a href="EventManager.cs.html#2db7fe198f49b713" class="i property">IsExecutingEventAction</a>)
                {
                    <span class="r67 r">resultItem</span> = <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#296e9dd07cdc8e4e" class="i method">GetVariableValue</a>(
                        <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#471bf3f65f86c699" class="i field">ErrorVarPath</a>, <b>out</b> <span class="r65 r">context</span>, <b>out</b> <span class="r66 r">scope</span>);
                }
                <b>else</b>
                {
                    <span class="r67 r">resultItem</span> = <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#296e9dd07cdc8e4e" class="i method">GetVariableValue</a>(
                        <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#6f17a316797f222e" class="i field">EventErrorVarPath</a>, <b>out</b> <span class="r65 r">context</span>, <b>out</b> <span class="r66 r">scope</span>);
                }
 
                <b>return</b> <span class="r67 r">resultItem</span>;
            }
 
            <b>set</b>
            {
                <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#b40287193f838b0a" class="i method">SetVariable</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#471bf3f65f86c699" class="i field">ErrorVarPath</a>, <b>value</b>, <b>true</b>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="dd9d5cf404d56ee7" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">DebugPreferenceVariable</a>
        {
            <b>get</b>
            {
                <b>bool</b> <span id="r68 rd" class="r68 r">defaultUsed</span> = <b>false</b>;
                <b>return</b> <a href="#130bda5418e8559c" class="k">this</a>.<a href="#e66ab93387349c55" class="i method">GetEnumPreference</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#55e5d3a56318ad74" class="i field">DebugPreferenceVarPath</a>,
                    <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#b71dc68e025852e1" class="i field">DefaultDebugPreference</a>,
                    <b>out</b> <span class="r68 r">defaultUsed</span>);
            }
 
            <b>set</b>
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">SetVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#55e5d3a56318ad74" class="i field">DebugPreferenceVarPath</a>,
                    <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<b>value</b>, <b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>),
                    <b>true</b>,
                    <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="36be7acbb08ad495" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">VerbosePreferenceVariable</a>
        {
            <b>get</b>
            {
                <b>bool</b> <span id="r69 rd" class="r69 r">defaultUsed</span> = <b>false</b>;
                <b>return</b> <a href="#130bda5418e8559c" class="k">this</a>.<a href="#e66ab93387349c55" class="i method">GetEnumPreference</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#4f336924853bb007" class="i field">VerbosePreferenceVarPath</a>,
                    <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#bffa8c5f990b643d" class="i field">DefaultVerbosePreference</a>,
                    <b>out</b> <span class="r69 r">defaultUsed</span>);
            }
 
            <b>set</b>
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">SetVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#4f336924853bb007" class="i field">VerbosePreferenceVarPath</a>,
                    <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<b>value</b>, <b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>),
                    <b>true</b>,
                    <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="b6c4f7d12af19123" href="../R/b6c4f7d12af19123.html" target="n" data-glyph="104,1" class="i property">ErrorActionPreferenceVariable</a>
        {
            <b>get</b>
            {
                <b>bool</b> <span id="r70 rd" class="r70 r">defaultUsed</span> = <b>false</b>;
                <b>return</b> <a href="#130bda5418e8559c" class="k">this</a>.<a href="#e66ab93387349c55" class="i method">GetEnumPreference</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#8f0a1d2bb6fc8f1c" class="i field">ErrorActionPreferenceVarPath</a>,
                    <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#696119533aff8946" class="i field">DefaultErrorActionPreference</a>,
                    <b>out</b> <span class="r70 r">defaultUsed</span>);
            }
 
            <b>set</b>
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">SetVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#8f0a1d2bb6fc8f1c" class="i field">ErrorActionPreferenceVarPath</a>,
                    <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<b>value</b>, <b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>),
                    <b>true</b>,
                    <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="9ce3c9f649b1a6c7" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">WarningActionPreferenceVariable</a>
        {
            <b>get</b>
            {
                <b>bool</b> <span id="r71 rd" class="r71 r">defaultUsed</span> = <b>false</b>;
                <b>return</b> <a href="#130bda5418e8559c" class="k">this</a>.<a href="#e66ab93387349c55" class="i method">GetEnumPreference</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#b2fbcbd4ab894191" class="i field">WarningPreferenceVarPath</a>,
                    <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#ce925c70ad875bb8" class="i field">DefaultWarningPreference</a>,
                    <b>out</b> <span class="r71 r">defaultUsed</span>);
            }
 
            <b>set</b>
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">SetVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#b2fbcbd4ab894191" class="i field">WarningPreferenceVarPath</a>,
                    <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<b>value</b>, <b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>),
                    <b>true</b>,
                    <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal</b> <a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <a id="6212fdfa4e4a516d" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">InformationActionPreferenceVariable</a>
        {
            <b>get</b>
            {
                <b>bool</b> <span id="r72 rd" class="r72 r">defaultUsed</span> = <b>false</b>;
                <b>return</b> <a href="#130bda5418e8559c" class="k">this</a>.<a href="#e66ab93387349c55" class="i method">GetEnumPreference</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#793d57f0df2d9a59" class="i field">InformationPreferenceVarPath</a>,
                    <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#3968cbd8e157630a" class="i field">DefaultInformationPreference</a>,
                    <b>out</b> <span class="r72 r">defaultUsed</span>);
            }
 
            <b>set</b>
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">SetVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#793d57f0df2d9a59" class="i field">InformationPreferenceVarPath</a>,
                    <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<b>value</b>, <b>typeof</b>(<a href="CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>),
                    <b>true</b>,
                    <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal object</b> <a id="b36f0300acb0e937" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">WhatIfPreferenceVariable</a>
        {
            <b>get</b>
            {
                <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r73 rd" class="r73 r">context</span> = <b>null</b>;
                <a href="SessionStateScope.cs.html#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r74 rd" class="r74 r">scope</span> = <b>null</b>;
 
                <b>object</b> <span id="r75 rd" class="r75 r">resultItem</span> = <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#296e9dd07cdc8e4e" class="i method">GetVariableValue</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#5d67e100af05cd0e" class="i field">WhatIfPreferenceVarPath</a>,
                    <b>out</b> <span class="r73 r">context</span>,
                    <b>out</b> <span class="r74 r">scope</span>);
 
                <b>return</b> <span class="r75 r">resultItem</span>;
            }
 
            <b>set</b>
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionStateVariableAPIs.cs.html#b40287193f838b0a" class="i method">SetVariable</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#5d67e100af05cd0e" class="i field">WhatIfPreferenceVarPath</a>,
                    <b>value</b>,
                    <b>true</b>,
                    <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <a id="9a7a4c2740c63211" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">ConfirmPreferenceVariable</a>
        {
            <b>get</b>
            {
                <b>bool</b> <span id="r76 rd" class="r76 r">defaultUsed</span> = <b>false</b>;
                <b>return</b> <a href="#130bda5418e8559c" class="k">this</a>.<a href="#e66ab93387349c55" class="i method">GetEnumPreference</a>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#be9a95eb1f87eef7" class="i field">ConfirmPreferenceVarPath</a>,
                    <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#48990b5efe099274" class="i field">DefaultConfirmPreference</a>,
                    <b>out</b> <span class="r76 r">defaultUsed</span>);
            }
 
            <b>set</b>
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<span class="i">SetVariable</span>(
                    <a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#be9a95eb1f87eef7" class="i field">ConfirmPreferenceVarPath</a>,
                    <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<b>value</b>, <b>typeof</b>(<a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>),
                    <b>true</b>,
                    <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>);
            }
        }
 
        <b>internal void</b> <a id="e094046a82e7bd9e" href="../R/e094046a82e7bd9e.html" target="n" data-glyph="74,1" class="i method">RunspaceClosingNotification</a>()
        {
            <a href="#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="SessionState.cs.html#0253fb8c24047450" class="i method">RunspaceClosingNotification</a>();
 
            <b>if</b> (<a href="#4dc9c33caa8ec2df" class="i field">_debugger</a> != <b>null</b>)
            {
                <a href="#4dc9c33caa8ec2df" class="i field">_debugger</a>.<a href="debugger/debugger.cs.html#b898e736ba1b9deb" class="i method">Dispose</a>();
            }
 
            <b>if</b> (<a href="#67642aa960214ec5" class="i property">Events</a> != <b>null</b>)
            {
                <a href="#67642aa960214ec5" class="i property">Events</a>.<a href="EventManager.cs.html#a60d9ba6a29ad13b" class="i method">Dispose</a>();
            }
 
            <a href="#67642aa960214ec5" class="i property">Events</a> = <b>null</b>;
            <b>if</b> (<a href="#130bda5418e8559c" class="k">this</a>.<a href="#dd411801c1b013c6" class="i field">transactionManager</a> != <b>null</b>)
            {
                <a href="#130bda5418e8559c" class="k">this</a>.<a href="#dd411801c1b013c6" class="i field">transactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#ea885a0401b9f379" class="i method">Dispose</a>();
            }
 
            <a href="#130bda5418e8559c" class="k">this</a>.<a href="#dd411801c1b013c6" class="i field">transactionManager</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type table instance for this engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="e05f19c7ccf4ea74" href="../R/e05f19c7ccf4ea74.html" target="n" data-glyph="104,1" class="i property">TypeTable</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#4fca2df834442d31" class="i field">_typeTable</a> == <b>null</b>)
                {
                    <a href="#4fca2df834442d31" class="i field">_typeTable</a> = <b>new</b> <a href="TypeTable.cs.html#ca1efdd8952821e8" class="t constructor">TypeTable</a>();
                    <a href="#88a99fd04df43959" class="i field">_typeTableWeakReference</a> = <b>new</b> <span class="i">WeakReference</span>&lt;<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>&gt;(<a href="#4fca2df834442d31" class="i field">_typeTable</a>);
                }
 
                <b>return</b> <a href="#4fca2df834442d31" class="i field">_typeTable</a>;
            }
 
            <b>set</b>
            {
                <a href="#4fca2df834442d31" class="i field">_typeTable</a> = <b>value</b>;
                <a href="#88a99fd04df43959" class="i field">_typeTableWeakReference</a> = (<b>value</b> != <b>null</b>) ? <b>new</b> <span class="i">WeakReference</span>&lt;<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>&gt;(<b>value</b>) : <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Here for PSObject, should probably not be used elsewhere, maybe not even in PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">WeakReference</span>&lt;<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>&gt; <a id="b6d5904c3eeb0bf5" href="../R/b6d5904c3eeb0bf5.html" target="n" data-glyph="104,1" class="i property">TypeTableWeakReference</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#4fca2df834442d31" class="i field">_typeTable</a> == <b>null</b>)
                {
                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="k">var</a> <span id="r77 rd" class="r77 r">unused</span> = <a href="#e05f19c7ccf4ea74" class="i property">TypeTable</a>;
                }
 
                <b>return</b> <a href="#88a99fd04df43959" class="i field">_typeTableWeakReference</a>;
            }
        }
 
        <b>private</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="4fca2df834442d31" href="../R/4fca2df834442d31.html" target="n" data-glyph="46,1" class="i field">_typeTable</a>;
        <b>private</b> <span class="i">WeakReference</span>&lt;<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>&gt; <a id="88a99fd04df43959" href="../R/88a99fd04df43959.html" target="n" data-glyph="46,1" class="i field">_typeTableWeakReference</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the format info database for this engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../FormatAndOutput/common/DisplayDatabase/typeDataManager.cs.html#1d3a66f3269ff8ee" class="t t">TypeInfoDataBaseManager</a> <a id="40afda0efcb0cad4" href="../R/40afda0efcb0cad4.html" target="n" data-glyph="104,1" class="i property">FormatDBManager</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#a8d29afdce9166ac" class="i field">_formatDBManager</a> == <b>null</b>)
                {
                    <span class="c">// If no Formatter database has been created, then</span>
                    <span class="c">// create and initialize an empty one.</span>
                    <a href="#a8d29afdce9166ac" class="i field">_formatDBManager</a> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/typeDataManager.cs.html#97bf96e8de445170" class="t constructor">TypeInfoDataBaseManager</a>();
                    <a href="#a8d29afdce9166ac" class="i field">_formatDBManager</a>.<a href="../FormatAndOutput/common/DisplayDatabase/typeDataManager.cs.html#aa650e55d880f5f4" class="i method">Update</a>(<a href="#130bda5418e8559c" class="k">this</a>.<a href="#d04f29dfc80b1390" class="i property">AuthorizationManager</a>, <a href="#130bda5418e8559c" class="k">this</a>.<a href="#24a4a46de18d1004" class="i property">EngineHostInterface</a>);
                    <b>if</b> (<a href="#130bda5418e8559c" class="k">this</a>.<a href="#2a82be710f3773ae" class="i property">InitialSessionState</a> != <b>null</b>)
                    {
                        <span class="c">// Win8:418011: Set DisableFormatTableUpdates only after performing the initial update. Otherwise, formatDBManager will be</span>
                        <span class="c">// in bad state.</span>
                        <a href="#a8d29afdce9166ac" class="i field">_formatDBManager</a>.<a href="../FormatAndOutput/common/DisplayDatabase/typeDataManager.cs.html#2bbd80d5ac451320" class="i property">DisableFormatTableUpdates</a> = <a href="#130bda5418e8559c" class="k">this</a>.<a href="#2a82be710f3773ae" class="i property">InitialSessionState</a>.<a href="InitialSessionState.cs.html#d12e46183b35df33" class="i property">DisableFormatUpdates</a>;
                    }
                }
 
                <b>return</b> <a href="#a8d29afdce9166ac" class="i field">_formatDBManager</a>;
            }
 
            <b>set</b>
            {
                <a href="#a8d29afdce9166ac" class="i field">_formatDBManager</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="../FormatAndOutput/common/DisplayDatabase/typeDataManager.cs.html#1d3a66f3269ff8ee" class="t t">TypeInfoDataBaseManager</a> <a id="a8d29afdce9166ac" href="../R/a8d29afdce9166ac.html" target="n" data-glyph="46,1" class="i field">_formatDBManager</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the TransactionManager instance that controls transactions in the current</span>
        <span class="c">///</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a> <a id="d432bf41e44dd9db" href="../R/d432bf41e44dd9db.html" target="n" data-glyph="104,1" class="i property">TransactionManager</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dd411801c1b013c6" class="i field">transactionManager</a>;
            }
        }
 
        <b>internal</b> <a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a> <a id="dd411801c1b013c6" href="../R/dd411801c1b013c6.html" target="n" data-glyph="44,1" class="i field">transactionManager</a>;
 
        <b>internal</b> <span class="i">Assembly</span> <a id="bc1bafaf5d7b0ca2" href="../R/bc1bafaf5d7b0ca2.html" target="n" data-glyph="74,1" class="i method">AddAssembly</a>(<b>string</b> <span id="r78 rd" class="r78 r">name</span>, <b>string</b> <span id="r79 rd" class="r79 r">filename</span>, <b>out</b> <span class="i">Exception</span> <span id="r80 rd" class="r80 r">error</span>)
        {
            <span class="i">Assembly</span> <span id="r81 rd" class="r81 r">loadedAssembly</span> = <a href="#1b77723bbe47e4db" class="i method">LoadAssembly</a>(<span class="r78 r">name</span>, <span class="r79 r">filename</span>, <b>out</b> <span class="r80 r">error</span>);
 
            <b>if</b> (<span class="r81 r">loadedAssembly</span> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <b>if</b> (<a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a>.<span class="i">ContainsKey</span>(<span class="r81 r">loadedAssembly</span>.<span class="i">FullName</span>))
            {
                <span class="c">// we should ignore this assembly.</span>
                <b>return</b> <span class="r81 r">loadedAssembly</span>;
            }
            <span class="c">// We will cache the assembly by both full name and</span>
            <span class="c">// file name</span>
            <a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a>.<span class="i">Add</span>(<span class="r81 r">loadedAssembly</span>.<span class="i">FullName</span>, <span class="r81 r">loadedAssembly</span>);
 
            <b>if</b> (<a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a>.<span class="i">ContainsKey</span>(<span class="r81 r">loadedAssembly</span>.<span class="i">GetName</span>().<span class="i">Name</span>))
            {
                <span class="c">// we should ignore this assembly.</span>
                <b>return</b> <span class="r81 r">loadedAssembly</span>;
            }
 
            <a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a>.<span class="i">Add</span>(<span class="r81 r">loadedAssembly</span>.<span class="i">GetName</span>().<span class="i">Name</span>, <span class="r81 r">loadedAssembly</span>);
            <b>return</b> <span class="r81 r">loadedAssembly</span>;
        }
 
        <b>internal void</b> <a id="d4be0d947e406cfb" href="../R/d4be0d947e406cfb.html" target="n" data-glyph="74,1" class="i method">RemoveAssembly</a>(<b>string</b> <span id="r82 rd" class="r82 r">name</span>)
        {
            <span class="i">Assembly</span> <span id="r83 rd" class="r83 r">loadedAssembly</span>;
            <b>if</b> (<a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a>.<span class="i">TryGetValue</span>(<span class="r82 r">name</span>, <b>out</b> <span class="r83 r">loadedAssembly</span>) &amp;&amp; <span class="r83 r">loadedAssembly</span> != <b>null</b>)
            {
                <a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a>.<span class="i">Remove</span>(<span class="r82 r">name</span>);
 
                <a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a>.<span class="i">Remove</span>(<span class="r83 r">loadedAssembly</span>.<span class="i">GetName</span>().<span class="i">Name</span>);
            }
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2001:AvoidCallingProblematicMethods&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;System.Reflection.Assembly.LoadWithPartialName&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2001:AvoidCallingProblematicMethods&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;System.Reflection.Assembly.LoadFrom&quot;</span>)]
        <b>internal static</b> <span class="i">Assembly</span> <a id="1b77723bbe47e4db" href="../R/1b77723bbe47e4db.html" target="n" data-glyph="74,1" class="i method">LoadAssembly</a>(<b>string</b> <span id="r84 rd" class="r84 r">name</span>, <b>string</b> <span id="r85 rd" class="r85 r">filename</span>, <b>out</b> <span class="i">Exception</span> <span id="r86 rd" class="r86 r">error</span>)
        {
            <span class="c">// First we try to load the assembly based on the filename</span>
            <span class="i">Assembly</span> <span id="r87 rd" class="r87 r">loadedAssembly</span> = <b>null</b>;
            <span class="r86 r">error</span> = <b>null</b>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r85 r">filename</span>))
            {
                <b>try</b>
                {
                    <span class="r87 r">loadedAssembly</span> = <span class="i">Assembly</span>.<span class="i">LoadFrom</span>(<span class="r85 r">filename</span>);
                    <b>return</b> <span class="r87 r">loadedAssembly</span>;
                }
                <b>catch</b> (<span class="i">FileNotFoundException</span> <span id="r88 rd" class="r88 r">fileNotFound</span>)
                {
                    <span class="r86 r">error</span> = <span class="r88 r">fileNotFound</span>;
                }
                <b>catch</b> (<span class="i">FileLoadException</span> <span id="r89 rd" class="r89 r">fileLoadException</span>)
                {
                    <span class="r86 r">error</span> = <span class="r89 r">fileLoadException</span>;
                    <b>return</b> <b>null</b>;
                }
                <b>catch</b> (<span class="i">BadImageFormatException</span> <span id="r90 rd" class="r90 r">badImage</span>)
                {
                    <span class="r86 r">error</span> = <span class="r90 r">badImage</span>;
                    <b>return</b> <b>null</b>;
                }
                <b>catch</b> (<span class="i">SecurityException</span> <span id="r91 rd" class="r91 r">securityException</span>)
                {
                    <span class="r86 r">error</span> = <span class="r91 r">securityException</span>;
                    <b>return</b> <b>null</b>;
                }
            }
 
            <span class="c">// Then we try to load the assembly based on the given name</span>
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r84 r">name</span>))
            {
                <b>string</b> <span id="r92 rd" class="r92 r">fixedName</span> = <b>null</b>;
                <span class="c">// Remove the &#39;.dll&#39; if it&#39;s there...</span>
                <span class="r92 r">fixedName</span> = <span class="r84 r">name</span>.<span class="i">EndsWith</span>(<span class="s">&quot;.dll&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                                ? <span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="r84 r">name</span>)
                                : <span class="r84 r">name</span>;
 
                <b>var</b> <span id="r93 rd" class="r93 r">assemblyString</span> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#4b2ba2d00a0ce944" class="i method">IsPowerShellAssembly</a>(<span class="r92 r">fixedName</span>)
                                         ? <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#ace9457935d64a9e" class="i method">GetPowerShellAssemblyStrongName</a>(<span class="r92 r">fixedName</span>)
                                         : <span class="r92 r">fixedName</span>;
 
                <b>try</b>
                {
                    <span class="r87 r">loadedAssembly</span> = <span class="i">Assembly</span>.<span class="i">Load</span>(<b>new</b> <span class="i">AssemblyName</span>(<span class="r93 r">assemblyString</span>));
                }
                <b>catch</b> (<span class="i">FileNotFoundException</span> <span id="r94 rd" class="r94 r">fileNotFound</span>)
                {
                    <span class="r86 r">error</span> = <span class="r94 r">fileNotFound</span>;
                }
                <b>catch</b> (<span class="i">FileLoadException</span> <span id="r95 rd" class="r95 r">fileLoadException</span>)
                {
                    <span class="r86 r">error</span> = <span class="r95 r">fileLoadException</span>;
                }
                <b>catch</b> (<span class="i">BadImageFormatException</span> <span id="r96 rd" class="r96 r">badImage</span>)
                {
                    <span class="r86 r">error</span> = <span class="r96 r">badImage</span>;
                }
                <b>catch</b> (<span class="i">SecurityException</span> <span id="r97 rd" class="r97 r">securityException</span>)
                {
                    <span class="r86 r">error</span> = <span class="r97 r">securityException</span>;
                }
            }
 
            <span class="c">// If the assembly is loaded, we ignore error as it may come from the filepath loading.</span>
            <b>if</b> (<span class="r87 r">loadedAssembly</span> != <b>null</b>)
            {
                <span class="r86 r">error</span> = <b>null</b>;
            }
 
            <b>return</b> <span class="r87 r">loadedAssembly</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Report an initialization-time error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resource string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="933e4885c75e58a3" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ReportEngineStartupError</a>(<b>string</b> <span id="r98 rd" class="r98 r">resourceString</span>, <b>params object</b>[] <span id="r99 rd" class="r99 r">arguments</span>)
        {
            <b>try</b>
            {
                <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r100 rd" class="r100 r">currentRunningModuleCommand</span>;
                <b>string</b> <span id="r101 rd" class="r101 r">errorId</span>;
                <b>if</b> (<a href="#b10d1e74d346401a" class="i method">IsModuleCommandCurrentlyRunning</a>(<b>out</b> <span class="r100 r">currentRunningModuleCommand</span>, <b>out</b> <span class="r101 r">errorId</span>))
                {
                    <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r102 rd" class="r102 r">rte</span> = <a href="lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<b>null</b>, <b>typeof</b>(<a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <b>null</b>, <span class="r101 r">errorId</span>, <span class="r98 r">resourceString</span>, <span class="r99 r">arguments</span>);
                    <span class="r100 r">currentRunningModuleCommand</span>.<a href="cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r102 r">rte</span>.<a href="../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>, <span class="r102 r">rte</span>));
                }
                <b>else</b>
                {
                    <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r103 rd" class="r103 r">host</span> = <a href="#24a4a46de18d1004" class="i property">EngineHostInterface</a>;
                    <b>if</b> (<span class="r103 r">host</span> == <b>null</b>) <b>return</b>;
                    <a href="hostifaces/MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <span id="r104 rd" class="r104 r">ui</span> = <span class="r103 r">host</span>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>;
                    <b>if</b> (<span class="r104 r">ui</span> == <b>null</b>) <b>return</b>;
                    <span class="r104 r">ui</span>.<a href="hostifaces/MshHostUserInterface.cs.html#c90737c2e1ab652f" class="i method">WriteErrorLine</a>(
                        <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../utils/StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r98 r">resourceString</span>, <span class="r99 r">arguments</span>));
                }
            }
            <b>catch</b> (<span class="i">Exception</span>) <span class="c">// swallow all exceptions</span>
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Report an initialization-time error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">error</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Error to report.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="11a71072bc1e9f4d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ReportEngineStartupError</a>(<b>string</b> <span id="r105 rd" class="r105 r">error</span>)
        {
            <b>try</b>
            {
                <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r106 rd" class="r106 r">currentRunningModuleCommand</span>;
                <b>string</b> <span id="r107 rd" class="r107 r">errorId</span>;
                <b>if</b> (<a href="#b10d1e74d346401a" class="i method">IsModuleCommandCurrentlyRunning</a>(<b>out</b> <span class="r106 r">currentRunningModuleCommand</span>, <b>out</b> <span class="r107 r">errorId</span>))
                {
                    <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r108 rd" class="r108 r">rte</span> = <a href="lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<b>null</b>, <b>typeof</b>(<a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <b>null</b>, <span class="r107 r">errorId</span>, <span class="s">&quot;{0}&quot;</span>, <span class="r105 r">error</span>);
                    <span class="r106 r">currentRunningModuleCommand</span>.<a href="cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r108 r">rte</span>.<a href="../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>, <span class="r108 r">rte</span>));
                }
                <b>else</b>
                {
                    <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r109 rd" class="r109 r">host</span> = <a href="#24a4a46de18d1004" class="i property">EngineHostInterface</a>;
                    <b>if</b> (<span class="r109 r">host</span> == <b>null</b>) <b>return</b>;
                    <a href="hostifaces/MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <span id="r110 rd" class="r110 r">ui</span> = <span class="r109 r">host</span>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>;
                    <b>if</b> (<span class="r110 r">ui</span> == <b>null</b>) <b>return</b>;
                    <span class="r110 r">ui</span>.<a href="hostifaces/MshHostUserInterface.cs.html#c90737c2e1ab652f" class="i method">WriteErrorLine</a>(<span class="r105 r">error</span>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span>) <span class="c">// swallow all exceptions</span>
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Report an initialization-time error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="dc6d233d4e064eaa" href="../R/dc6d233d4e064eaa.html" target="n" data-glyph="74,1" class="i method">ReportEngineStartupError</a>(<span class="i">Exception</span> <span id="r111 rd" class="r111 r">e</span>)
        {
            <b>try</b>
            {
                <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r112 rd" class="r112 r">currentRunningModuleCommand</span>;
                <b>string</b> <span id="r113 rd" class="r113 r">errorId</span>;
                <b>if</b> (<a href="#b10d1e74d346401a" class="i method">IsModuleCommandCurrentlyRunning</a>(<b>out</b> <span class="r112 r">currentRunningModuleCommand</span>, <b>out</b> <span class="r113 r">errorId</span>))
                {
                    <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r114 rd" class="r114 r">error</span> = <b>null</b>;
                    <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="k">var</a> <span id="r115 rd" class="r115 r">rte</span> = <span class="r111 r">e</span> <b>as</b> <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>;
 
                    <span class="r114 r">error</span> = <span class="r115 r">rte</span> != <b>null</b>
                        ? <b>new</b> <span class="t">ErrorRecord</span>(<span class="r115 r">rte</span>.<a href="../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>, <span class="r115 r">rte</span>)
                        : <b>new</b> <a href="ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r111 r">e</span>, <span class="r113 r">errorId</span>, <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#9aa2436d61de1f73" class="i field">OperationStopped</a>, <b>null</b>);
 
                    <span class="r112 r">currentRunningModuleCommand</span>.<a href="cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r114 r">error</span>);
                }
                <b>else</b>
                {
                    <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r116 rd" class="r116 r">host</span> = <a href="#24a4a46de18d1004" class="i property">EngineHostInterface</a>;
                    <b>if</b> (<span class="r116 r">host</span> == <b>null</b>) <b>return</b>;
                    <a href="hostifaces/MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <span id="r117 rd" class="r117 r">ui</span> = <span class="r116 r">host</span>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>;
                    <b>if</b> (<span class="r117 r">ui</span> == <b>null</b>) <b>return</b>;
                    <span class="r117 r">ui</span>.<span class="i">WriteErrorLine</span>(<span class="r111 r">e</span>.<span class="i">Message</span>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span>) <span class="c">// swallow all exceptions</span>
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Report an initialization-time error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3c6ec0a866bc74d8" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ReportEngineStartupError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r118 rd" class="r118 r">errorRecord</span>)
        {
            <b>try</b>
            {
                <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r119 rd" class="r119 r">currentRunningModuleCommand</span>;
                <b>string</b> <span id="r120 rd" class="r120 r">unused</span>;
                <b>if</b> (<a href="#b10d1e74d346401a" class="i method">IsModuleCommandCurrentlyRunning</a>(<b>out</b> <span class="r119 r">currentRunningModuleCommand</span>, <b>out</b> <span class="r120 r">unused</span>))
                {
                    <span class="r119 r">currentRunningModuleCommand</span>.<a href="cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r118 r">errorRecord</span>);
                }
                <b>else</b>
                {
                    <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r121 rd" class="r121 r">host</span> = <a href="#24a4a46de18d1004" class="i property">EngineHostInterface</a>;
                    <b>if</b> (<span class="r121 r">host</span> == <b>null</b>) <b>return</b>;
                    <a href="hostifaces/MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <span id="r122 rd" class="r122 r">ui</span> = <span class="r121 r">host</span>.<a href="hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>;
                    <b>if</b> (<span class="r122 r">ui</span> == <b>null</b>) <b>return</b>;
                    <span class="r122 r">ui</span>.<a href="hostifaces/MshHostUserInterface.cs.html#c90737c2e1ab652f" class="i method">WriteErrorLine</a>(<span class="r118 r">errorRecord</span>.<a href="ErrorPackage.cs.html#cab659be098926dd" class="i method">ToString</a>());
                }
            }
            <b>catch</b> (<span class="i">Exception</span>) <span class="c">// swallow all exceptions</span>
            {
            }
        }
 
        <b>private bool</b> <a id="b10d1e74d346401a" href="../R/b10d1e74d346401a.html" target="n" data-glyph="76,1" class="i method">IsModuleCommandCurrentlyRunning</a>(<b>out</b> <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r123 rd" class="r123 r">command</span>, <b>out string</b> <span id="r124 rd" class="r124 r">errorId</span>)
        {
            <span class="r123 r">command</span> = <b>null</b>;
            <span class="r124 r">errorId</span> = <b>null</b>;
            <b>bool</b> <span id="r125 rd" class="r125 r">result</span> = <b>false</b>;
            <b>if</b> (<a href="#130bda5418e8559c" class="k">this</a>.<a href="#1146573afe2845c8" class="i property">CurrentCommandProcessor</a> != <b>null</b>)
            {
                <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r126 rd" class="r126 r">cmdletInfo</span> = <a href="#130bda5418e8559c" class="k">this</a>.<a href="#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>.<a href="CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a>;
                <b>if</b> ((<b>string</b>.<span class="i">Equals</span>(<span class="r126 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="s">&quot;Import-Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                     <b>string</b>.<span class="i">Equals</span>(<span class="r126 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="s">&quot;Remove-Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) &amp;&amp;
                    <span class="r126 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#1aa74ca244a39308" class="i property">CommandType</a>.<span class="i">Equals</span>(<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>) &amp;&amp;
                    <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#b79f06e1ca564512" class="i field">CoreModule</a>.<span class="i">Equals</span>(<span class="r126 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r125 r">result</span> = <b>true</b>;
                    <span class="r123 r">command</span> = (<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>)<a href="#130bda5418e8559c" class="k">this</a>.<a href="#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>.<a href="CommandProcessorBase.cs.html#f58ee453ebc82f56" class="i property">Command</a>;
                    <span class="r124 r">errorId</span> = <b>string</b>.<span class="i">Equals</span>(<span class="r126 r">cmdletInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="s">&quot;Import-Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                                  ? <span class="s">&quot;Module_ImportModuleError&quot;</span>
                                  : <span class="s">&quot;Module_RemoveModuleError&quot;</span>;
                }
            }
 
            <b>return</b> <span class="r125 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs an Execution context object for Automation Engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">engine</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Engine that hosts this execution context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">hostInterface</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Interface that should be used for interaction with host</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">initialSessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitialSessionState information</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="4801ed00d1ede6d0" href="../R/4801ed00d1ede6d0.html" target="n" data-glyph="74,1" class="t constructor">ExecutionContext</a>(<a href="AutomationEngine.cs.html#0c7ddddd2aba0cae" class="t t">AutomationEngine</a> <span id="r127 rd" class="r127 r">engine</span>, <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r128 rd" class="r128 r">hostInterface</span>, <a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r129 rd" class="r129 r">initialSessionState</span>)
        {
            <a href="#2a82be710f3773ae" class="i property">InitialSessionState</a> = <span class="r129 r">initialSessionState</span>;
            <a href="#d04f29dfc80b1390" class="i property">AuthorizationManager</a> = <span class="r129 r">initialSessionState</span>.<a href="InitialSessionState.cs.html#a89af1fd0f2f5c0e" class="i property">AuthorizationManager</a>;
 
            <a href="#a90c4dff1ab8db8a" class="i method">InitializeCommon</a>(<span class="r127 r">engine</span>, <span class="r128 r">hostInterface</span>);
        }
 
        <b>private void</b> <a id="a90c4dff1ab8db8a" href="../R/a90c4dff1ab8db8a.html" target="n" data-glyph="76,1" class="i method">InitializeCommon</a>(<a href="AutomationEngine.cs.html#0c7ddddd2aba0cae" class="t t">AutomationEngine</a> <span id="r130 rd" class="r130 r">engine</span>, <a href="hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r131 rd" class="r131 r">hostInterface</span>)
        {
            <a href="#7b897dde7067af78" class="i property">Engine</a> = <span class="r130 r">engine</span>;
            <a href="#67642aa960214ec5" class="i property">Events</a> = <b>new</b> <a href="EventManager.cs.html#7d7e356843375ef8" class="t constructor">PSLocalEventManager</a>(<a href="#130bda5418e8559c" class="k">this</a>);
            <a href="#dd411801c1b013c6" class="i field">transactionManager</a> = <b>new</b> <span class="t">PSTransactionManager</span>();
            <a href="#4dc9c33caa8ec2df" class="i field">_debugger</a> = <b>new</b> <a href="debugger/debugger.cs.html#0ecd00e9d3e6ea73" class="t constructor">ScriptDebugger</a>(<a href="#130bda5418e8559c" class="k">this</a>);
 
            <a href="#24a4a46de18d1004" class="i property">EngineHostInterface</a> = <span class="r131 r">hostInterface</span> <b>as</b> <a href="hostifaces/InternalHost.cs.html#83104f2ad59a19df" class="t t">InternalHost</a> ?? <b>new</b> <a href="hostifaces/InternalHost.cs.html#2b5c657f9611aac9" class="t constructor">InternalHost</a>(<span class="r131 r">hostInterface</span>, <a href="#130bda5418e8559c" class="k">this</a>);
 
            <span class="c">// Hook up the assembly cache</span>
            <a href="#1d21e5a1ed78a821" class="i property">AssemblyCache</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Assembly</span>&gt;();
 
            <span class="c">// Initialize the fixed toplevel session state and the current session state</span>
            <a href="#95bc6698d12886ee" class="i property">TopLevelSessionState</a> = <a href="#07982205e4a6a726" class="i property">EngineSessionState</a> = <b>new</b> <a href="SessionState.cs.html#5ccb828c0af0ef80" class="t constructor">SessionStateInternal</a>(<a href="#130bda5418e8559c" class="k">this</a>);
 
            <b>if</b> (<a href="#d04f29dfc80b1390" class="i property">AuthorizationManager</a> == <b>null</b>)
            {
                <span class="c">// if authorizationmanager==null, this means the configuration</span>
                <span class="c">// explicitly asked for dummy authorization manager.</span>
                <a href="#d04f29dfc80b1390" class="i property">AuthorizationManager</a> = <b>new</b> <a href="SecurityManagerBase.cs.html#f572299e9e7a3ced" class="t constructor">AuthorizationManager</a>(<b>null</b>);
            }
 
            <span class="c">// Set up the module intrinsics</span>
            <a href="#2d3edf63c7afa4b2" class="i property">Modules</a> = <b>new</b> <a href="Modules/ModuleIntrinsics.cs.html#cd66803a2ce9edb7" class="t constructor">ModuleIntrinsics</a>(<a href="#130bda5418e8559c" class="k">this</a>);
        }
 
        <b>private static readonly object</b> <a id="68a0b9f30e1a7c92" href="../R/68a0b9f30e1a7c92.html" target="n" data-glyph="46,1" class="i field">lockObject</a> = <b>new</b> <b>object</b>();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enum that defines state of monad engine.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="4bbbd017613e38e6" href="../R/4bbbd017613e38e6.html" target="n" data-glyph="20,0" class="t t"><span id="b377cd9ec07f219b">EngineState</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Engine state is not defined or initialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="908496dce30a5213" href="../R/908496dce30a5213.html" target="n" data-glyph="24,1" class="i field">None</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Engine available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="0cc650217ea48fc0" href="../R/0cc650217ea48fc0.html" target="n" data-glyph="24,1" class="i field">Available</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Engine service is degraded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b30d28e8f8c2c363" href="../R/b30d28e8f8c2c363.html" target="n" data-glyph="24,1" class="i field">Degraded</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Engine is out of service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="224421d9b2dde6b8" href="../R/224421d9b2dde6b8.html" target="n" data-glyph="24,1" class="i field">OutOfService</a> = 3,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Engine is stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4ddc499326dc771a" href="../R/4ddc499326dc771a.html" target="n" data-glyph="24,1" class="i field">Stopped</a> = 4
    }
}
</pre></td></tr></table></div></body></html>
