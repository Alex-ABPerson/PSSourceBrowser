<!DOCTYPE html>
<html><head><title>ErrorPackage.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1847);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ErrorPackage.cs" target="_top">engine\ErrorPackage.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56506
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Resources</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Permissions</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Errors reported by Monad will be in one of these categories.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Do not specify ErrorCategory.NotSpecified when creating an</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> Choose the best match from among the other values.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="0e80a9653d75dd2a" href="../R/0e80a9653d75dd2a.html" target="n" data-glyph="18,0" class="t t"><span id="fbb966f7341727c8">ErrorCategory</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No error category is specified, or the error category is invalid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do not specify ErrorCategory.NotSpecified when creating an</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Choose the best match from among the other values.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="707bbec7a1bb5ead" href="../R/707bbec7a1bb5ead.html" target="n" data-glyph="24,1" class="i field">NotSpecified</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7650567b7604bddc" href="../R/7650567b7604bddc.html" target="n" data-glyph="24,1" class="i field">OpenError</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d200e8733441781d" href="../R/d200e8733441781d.html" target="n" data-glyph="24,1" class="i field">CloseError</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="5c159972bebb9a96" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">DeviceError</a> = 3,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="167e6c3507b9e2a6" href="../R/167e6c3507b9e2a6.html" target="n" data-glyph="24,1" class="i field">DeadlockDetected</a> = 4,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="846d2b572f2c4820" href="../R/846d2b572f2c4820.html" target="n" data-glyph="24,1" class="i field">InvalidArgument</a> = 5,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c855a7c43559f12f" href="../R/c855a7c43559f12f.html" target="n" data-glyph="24,1" class="i field">InvalidData</a> = 6,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b5cba3d51f976bb3" href="../R/b5cba3d51f976bb3.html" target="n" data-glyph="24,1" class="i field">InvalidOperation</a> = 7,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f33f25c3453e2e98" href="../R/f33f25c3453e2e98.html" target="n" data-glyph="24,1" class="i field">InvalidResult</a> = 8,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d213d05331eaaec6" href="../R/d213d05331eaaec6.html" target="n" data-glyph="24,1" class="i field">InvalidType</a> = 9,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b56ca68d755dc414" href="../R/b56ca68d755dc414.html" target="n" data-glyph="24,1" class="i field">MetadataError</a> = 10,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8088845be39ec60c" href="../R/8088845be39ec60c.html" target="n" data-glyph="24,1" class="i field">NotImplemented</a> = 11,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1b53f568895cb17a" href="../R/1b53f568895cb17a.html" target="n" data-glyph="24,1" class="i field">NotInstalled</a> = 12,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object can not be found (file, directory, computer, system resource, etc.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9a72a7d3051ac7c5" href="../R/9a72a7d3051ac7c5.html" target="n" data-glyph="24,1" class="i field">ObjectNotFound</a> = 13,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9aa2436d61de1f73" href="../R/9aa2436d61de1f73.html" target="n" data-glyph="24,1" class="i field">OperationStopped</a> = 14,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="214d0e72bcab7ace" href="../R/214d0e72bcab7ace.html" target="n" data-glyph="24,1" class="i field">OperationTimeout</a> = 15,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7aaf68c3bc19e903" href="../R/7aaf68c3bc19e903.html" target="n" data-glyph="24,1" class="i field">SyntaxError</a> = 16,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="430a0c357a10c85c" href="../R/430a0c357a10c85c.html" target="n" data-glyph="24,1" class="i field">ParserError</a> = 17,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Operation not permitted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="26ba13af79d30a75" href="../R/26ba13af79d30a75.html" target="n" data-glyph="24,1" class="i field">PermissionDenied</a> = 18,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b16842373c579f23" href="../R/b16842373c579f23.html" target="n" data-glyph="24,1" class="i field">ResourceBusy</a> = 19,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="22cb3b8b80f740be" href="../R/22cb3b8b80f740be.html" target="n" data-glyph="24,1" class="i field">ResourceExists</a> = 20,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="cb0471032395958b" href="../R/cb0471032395958b.html" target="n" data-glyph="24,1" class="i field">ResourceUnavailable</a> = 21,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="cad1e0e3e13dc1f3" href="../R/cad1e0e3e13dc1f3.html" target="n" data-glyph="24,1" class="i field">ReadError</a> = 22,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="0c2f4b9c74e5b7c2" href="../R/0c2f4b9c74e5b7c2.html" target="n" data-glyph="24,1" class="i field">WriteError</a> = 23,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A non-Monad command reported an error to its STDERR pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Engine uses this ErrorCategory when it executes a native</span>
        <span class="c">///</span><span class="c"> console applications and captures the errors reported by the</span>
        <span class="c">///</span><span class="c"> native application.  Avoid using ErrorCategory.FromStdErr</span>
        <span class="c">///</span><span class="c"> in other circumstances.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="7220cf1ab14ce47d" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">FromStdErr</a> = 24,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used for security exceptions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f13302898d557be4" href="../R/f13302898d557be4.html" target="n" data-glyph="24,1" class="i field">SecurityError</a> = 25,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The contract of a protocol is not being followed. Should not happen</span>
        <span class="c">///</span><span class="c"> with well-behaved components.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="6e3273016e761a17" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ProtocolError</a> = 26,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The operation depends on a network connection that cannot be</span>
        <span class="c">///</span><span class="c"> established or maintained.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="fb4a3fa436a338ce" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ConnectionError</a> = 27,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Could not authenticate the user to the service. Could mean that the</span>
        <span class="c">///</span><span class="c"> credentials are invalid or the authentication system is not</span>
        <span class="c">///</span><span class="c"> functioning properly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="781727189552c78a" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">AuthenticationError</a> = 28,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal limits prevent the operation from being executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1706f5a396e7e4ad" href="../R/1706f5a396e7e4ad.html" target="n" data-glyph="24,1" class="i field">LimitsExceeded</a> = 29,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Controls on the use of traffic or resources prevent the operation</span>
        <span class="c">///</span><span class="c"> from being executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8524f623c6900112" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">QuotaExceeded</a> = 30,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The operation attempted to use functionality that is currently</span>
        <span class="c">///</span><span class="c"> disabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d359b736fe52d77b" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">NotEnabled</a> = 31,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Contains auxiliary information about an</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="37830dc92d4ac970" href="../R/37830dc92d4ac970.html" target="n" data-glyph="0,0" class="t t">ErrorCategoryInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
        <b>internal</b> <a id="d5bc927f9d1cf9a1" href="../R/d5bc927f9d1cf9a1.html" target="n" data-glyph="74,1" class="t constructor">ErrorCategoryInfo</a>(<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r0 rd" class="r0 r">errorRecord</span>)
        {
            <b>if</b> (<span class="r0 r">errorRecord</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r0 r">errorRecord</span>));
            }
 
            <a href="#e0a8ccd302669733" class="i field">_errorRecord</a> = <span class="r0 r">errorRecord</span>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> for this error</span>
        <b>public</b> <a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <a id="f4073b5e554619ca" href="../R/f4073b5e554619ca.html" target="n" data-glyph="102,1" class="i property">Category</a>
        {
            <b>get</b> { <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#f27b76c7c8455645" class="i field">_category</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text description of the operation which</span>
        <span class="c">///</span><span class="c"> encountered the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">text description of the operation</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> By default, this is the cmdlet name.</span>
        <span class="c">///</span><span class="c"> The default can be overridden by calling Set with a</span>
        <span class="c">///</span><span class="c"> non-empty value, for example &quot;Delete&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="d01c639de81db291" href="../R/d01c639de81db291.html" target="n" data-glyph="102,1" class="i property">Activity</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#0f4e19dafca43646" class="i field">_activityOverride</a>))
                {
                    <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#0f4e19dafca43646" class="i field">_activityOverride</a>;
                }
 
                <b>if</b> (<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a> != <b>null</b>
                    &amp;&amp; (<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a> <b>is</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> || <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a> <b>is</b> <a href="CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a>)
                    &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>)
                    )
                {
                    <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                }
 
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>set</b>
            {
                <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#0f4e19dafca43646" class="i field">_activityOverride</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text description of the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">text description of the error</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> By default, this is the exception type.</span>
        <span class="c">///</span><span class="c"> The default can be overridden by calling Set with a</span>
        <span class="c">///</span><span class="c"> non-empty value, for example &quot;Permission Denied&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="fc99e636c67fec35" href="../R/fc99e636c67fec35.html" target="n" data-glyph="102,1" class="i property">Reason</a>
        {
            <b>get</b>
            {
                <a href="#db80740cfb808d75" class="i field">_reasonIsExceptionType</a> = <b>false</b>;
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#80971f76030da766" class="i field">_reasonOverride</a>))
                {
                    <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#80971f76030da766" class="i field">_reasonOverride</a>;
                }
 
                <b>if</b> (<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#2c2498db91e737eb" class="i property">Exception</a> != <b>null</b>)
                {
                    <a href="#db80740cfb808d75" class="i field">_reasonIsExceptionType</a> = <b>true</b>;
                    <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">GetType</span>().<span class="i">Name</span>;
                }
 
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>set</b>
            {
                <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#80971f76030da766" class="i field">_reasonOverride</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="db80740cfb808d75" href="../R/db80740cfb808d75.html" target="n" data-glyph="46,1" class="i field">_reasonIsExceptionType</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text description of the target object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">text description of the target object</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> By default, this is TargetObject.ToString(), or the empty string</span>
        <span class="c">///</span><span class="c"> if the target object is null.</span>
        <span class="c">///</span><span class="c"> The default can be overridden by calling Set with a</span>
        <span class="c">///</span><span class="c"> non-empty value, for example &quot;John Doe&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="2258f12784435a42" href="../R/2258f12784435a42.html" target="n" data-glyph="102,1" class="i property">TargetName</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#f02d72354a7772ee" class="i field">_targetNameOverride</a>))
                {
                    <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#f02d72354a7772ee" class="i field">_targetNameOverride</a>;
                }
 
                <b>if</b> (<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#61f8d29a1022ac67" class="i property">TargetObject</a> != <b>null</b>)
                {
                    <b>string</b> <span id="r1 rd" class="r1 r">targetInString</span>;
                    <b>try</b>
                    {
                        <span class="r1 r">targetInString</span> = <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#61f8d29a1022ac67" class="i property">TargetObject</a>.<span class="i">ToString</span>();
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                        <span class="r1 r">targetInString</span> = <b>null</b>;
                    }
 
                    <b>return</b> <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#9de5bc146b03ccb1" class="i method">NotNull</a>(<span class="r1 r">targetInString</span>);
                }
 
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>set</b>
            {
                <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#f02d72354a7772ee" class="i field">_targetNameOverride</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text description of the type of the target object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">text description of the type of the target object</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> By default, this is TargetObject.GetType().ToString(),</span>
        <span class="c">///</span><span class="c"> or the empty string if the target object is null.</span>
        <span class="c">///</span><span class="c"> The default can be overridden by calling Set with a</span>
        <span class="c">///</span><span class="c"> non-empty value, for example &quot;Active Directory User&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="f11557f8e48da1ba" href="../R/f11557f8e48da1ba.html" target="n" data-glyph="102,1" class="i property">TargetType</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#5f7237a7a6013c7d" class="i field">_targetTypeOverride</a>))
                {
                    <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#5f7237a7a6013c7d" class="i field">_targetTypeOverride</a>;
                }
 
                <b>if</b> (<a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#61f8d29a1022ac67" class="i property">TargetObject</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#61f8d29a1022ac67" class="i property">TargetObject</a>.<span class="i">GetType</span>().<span class="i">Name</span>;
                }
 
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>set</b>
            {
                <a href="#e0a8ccd302669733" class="i field">_errorRecord</a>.<a href="#5f7237a7a6013c7d" class="i field">_targetTypeOverride</a> = <b>value</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Methods
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Concise text description based on</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a>.<a href="#f4073b5e554619ca" class="i property">Category</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Concise text description.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> GetMessage returns a concise string which categorizes the error,</span>
        <span class="c">///</span><span class="c"> based on</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a>.<a href="#f4073b5e554619ca" class="i property">Category</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> and including the other fields of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> as appropriate.  This string is much shorter</span>
        <span class="c">///</span><span class="c"> than</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#d882fa1d2308673f" class="t t">ErrorDetails</a>.<a href="#589bef4648ccf37a" class="i property">Message</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Exception</span>.<span class="i">Message</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, since it only</span>
        <span class="c">///</span><span class="c"> categorizes the error and does not contain a full description</span>
        <span class="c">///</span><span class="c"> or recommended actions.  The default host will display this</span>
        <span class="c">///</span><span class="c"> string instead of the full message if shell variable</span>
        <span class="c">///</span><span class="c"> $ErrorView is set to &quot;CategoryView&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="2f04722af678053a" href="../R/2f04722af678053a.html" target="n" data-glyph="72,1" class="i method">GetMessage</a>()
        {
            <span class="c">/* Remoting not in E12
            if (!string.IsNullOrEmpty (_errorRecord._serializedErrorCategoryMessageOverride))
                return _errorRecord._serializedErrorCategoryMessageOverride;
            */</span>
 
            <b>return</b> <span class="i">GetMessage</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Concise text description based on</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a>.<a href="#f4073b5e554619ca" class="i property">Category</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">uiCultureInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Culture in which to display message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Concise text description.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> GetMessage returns a concise string which categorizes the error,</span>
        <span class="c">///</span><span class="c"> based on</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a>.<a href="#f4073b5e554619ca" class="i property">Category</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> and including the other fields of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> as appropriate.  This string is much shorter</span>
        <span class="c">///</span><span class="c"> than</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#d882fa1d2308673f" class="t t">ErrorDetails</a>.<a href="#589bef4648ccf37a" class="i property">Message</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Exception</span>.<span class="i">Message</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, since it only</span>
        <span class="c">///</span><span class="c"> categorizes the error and does not contain a full description</span>
        <span class="c">///</span><span class="c"> or recommended actions.  The default host will display this</span>
        <span class="c">///</span><span class="c"> string instead of the full message if shell variable</span>
        <span class="c">///</span><span class="c"> $ErrorView is set to &quot;CategoryView&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ff99b13c888a2f00" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetMessage</a>(<span class="i">CultureInfo</span> <span id="r2 rd" class="r2 r">uiCultureInfo</span>)
        {
            <span class="c">// get template text</span>
            <b>string</b> <span id="r3 rd" class="r3 r">errorCategoryString</span> = <a href="#f4073b5e554619ca" class="i property">Category</a>.<span class="i">ToString</span>();
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r3 r">errorCategoryString</span>))
            {
                <span class="c">// this probably indicates an invalid ErrorCategory value</span>
                <span class="r3 r">errorCategoryString</span> = <b>nameof</b>(<a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="#707bbec7a1bb5ead" class="i field">NotSpecified</a>);
            }
 
            <b>string</b> <span id="r4 rd" class="r4 r">templateText</span> = <span class="i">ErrorCategoryStrings</span>.<span class="i">ResourceManager</span>.<span class="i">GetString</span>(<span class="r3 r">errorCategoryString</span>, <span class="r2 r">uiCultureInfo</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r4 r">templateText</span>))
            {
                <span class="c">// this probably indicates an invalid ErrorCategory value</span>
                <span class="r4 r">templateText</span> = <span class="i">ErrorCategoryStrings</span>.<span class="i">NotSpecified</span>;
            }
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r4 r">templateText</span>),
                <span class="s">&quot;ErrorCategoryStrings.resx resource failure&quot;</span>);
 
            <b>string</b> <span id="r5 rd" class="r5 r">activityInUse</span> = <a href="#f42f4738530848d1" class="i method">Ellipsize</a>(<span class="r2 r">uiCultureInfo</span>, <a href="#d01c639de81db291" class="i property">Activity</a>);
            <b>string</b> <span id="r6 rd" class="r6 r">targetNameInUse</span> = <a href="#f42f4738530848d1" class="i method">Ellipsize</a>(<span class="r2 r">uiCultureInfo</span>, <a href="#2258f12784435a42" class="i property">TargetName</a>);
            <b>string</b> <span id="r7 rd" class="r7 r">targetTypeInUse</span> = <a href="#f42f4738530848d1" class="i method">Ellipsize</a>(<span class="r2 r">uiCultureInfo</span>, <a href="#f11557f8e48da1ba" class="i property">TargetType</a>);
            <span class="c">// if the reason is a exception type name, we should output the whole name</span>
            <b>string</b> <span id="r8 rd" class="r8 r">reasonInUse</span> = <a href="#fc99e636c67fec35" class="i property">Reason</a>;
            <span class="r8 r">reasonInUse</span> = <a href="#db80740cfb808d75" class="i field">_reasonIsExceptionType</a> ? <span class="r8 r">reasonInUse</span> : <a href="#f42f4738530848d1" class="i method">Ellipsize</a>(<span class="r2 r">uiCultureInfo</span>, <span class="r8 r">reasonInUse</span>);
 
            <span class="c">// assemble final string</span>
            <b>try</b>
            {
                <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="r2 r">uiCultureInfo</span>, <span class="r4 r">templateText</span>,
                    <span class="r5 r">activityInUse</span>,
                    <span class="r6 r">targetNameInUse</span>,
                    <span class="r7 r">targetTypeInUse</span>,
                    <span class="r8 r">reasonInUse</span>,
                    <span class="r3 r">errorCategoryString</span>);
            }
            <b>catch</b> (<span class="i">FormatException</span>)
            {
                <span class="r4 r">templateText</span> = <span class="i">ErrorCategoryStrings</span>.<span class="i">InvalidErrorCategory</span>;
 
                <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="r2 r">uiCultureInfo</span>, <span class="r4 r">templateText</span>,
                    <span class="r5 r">activityInUse</span>,
                    <span class="r6 r">targetNameInUse</span>,
                    <span class="r7 r">targetTypeInUse</span>,
                    <span class="r8 r">reasonInUse</span>,
                    <span class="r3 r">errorCategoryString</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Same as</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a>.<a href="#2f04722af678053a" class="i method">GetMessage</a>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Developer-readable identifier.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="1e512c1295228133" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <span class="i">GetMessage</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private
        <span class="c">// back-reference for facade class</span>
        <b>private readonly</b> <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="e0a8ccd302669733" href="../R/e0a8ccd302669733.html" target="n" data-glyph="46,1" class="i field">_errorRecord</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Activity, Reason, TargetName and TargetType strings in</span>
        <span class="c">///</span><span class="c"> ErrorCategoryInfo can be of unlimited length.  In order to</span>
        <span class="c">///</span><span class="c"> control the maximum length of the GetMessage() string, we</span>
        <span class="c">///</span><span class="c"> ellipsize these strings.  The current heuristic is to take</span>
        <span class="c">///</span><span class="c"> strings longer than 40 characters and ellipsize them to</span>
        <span class="c">///</span><span class="c"> the first and last 19 characters plus &quot;...&quot; in the middle.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">uiCultureInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Culture to retrieve template if needed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">original</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Original string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Ellipsized version of string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> &quot;Please do not make this public as ellipsize is not a word.&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="f42f4738530848d1" href="../R/f42f4738530848d1.html" target="n" data-glyph="74,1" class="i method">Ellipsize</a>(<span class="i">CultureInfo</span> <span id="r9 rd" class="r9 r">uiCultureInfo</span>, <b>string</b> <span id="r10 rd" class="r10 r">original</span>)
        {
            <b>if</b> (<span class="r10 r">original</span>.<span class="i">Length</span> &lt;= 40)
            {
                <b>return</b> <span class="r10 r">original</span>;
            }
 
            <span class="c">// We are splitting a string &gt; 40 chars in half, so left and right can be</span>
            <span class="c">// at most 19 characters to include the ellipsis in the middle.</span>
            <b>const int</b> <span id="r11 rd" class="r11 r">MaxHalfWidth</span> = 19;
            <b>string</b> <span id="r12 rd" class="r12 r">first</span> = <span class="r10 r">original</span>.<span class="i">Substring</span>(0, <span class="r11 r">MaxHalfWidth</span>);
            <b>string</b> <span id="r13 rd" class="r13 r">last</span> = <span class="r10 r">original</span>.<span class="i">Substring</span>(<span class="r10 r">original</span>.<span class="i">Length</span> - <span class="r11 r">MaxHalfWidth</span>, <span class="r11 r">MaxHalfWidth</span>);
            <b>return</b>
                <b>string</b>.<span class="i">Format</span>(<span class="r9 r">uiCultureInfo</span>, <span class="i">ErrorPackage</span>.<span class="i">Ellipsize</span>, <span class="r12 r">first</span>, <span class="r13 r">last</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Additional details about an</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> ErrorDetails represents additional details about an</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> starting with a replacement Message.  Clients can use ErrorDetails</span>
    <span class="c">///</span><span class="c"> when they want to display a more specific Message than the one</span>
    <span class="c">///</span><span class="c"> contained in a particular Exception, without having to create</span>
    <span class="c">///</span><span class="c"> a new Exception or define a new Exception class.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> It is permitted to subclass </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d882fa1d2308673f" class="t t">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> but there is no established scenario for doing this, nor has it been tested.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="d882fa1d2308673f" href="../R/d882fa1d2308673f.html" target="n" data-glyph="0,0" class="t t">ErrorDetails</a> : <span class="i">ISerializable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of ErrorDetails specifying a Message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is preferred for Cmdlets to use</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7fe54a607e0a0d61" class="t constructor">ErrorDetails</a>(<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>,<b>string</b>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> for CmdletProviders to use</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0ff662ad5cf950f1" class="t constructor">ErrorDetails</a>(<a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a>,<b>string</b>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> and for other localizable code to use</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ErrorDetails</span>(<span class="i">Assembly</span>,<b>string</b>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> where possible.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="908615d662085fc6" href="../R/908615d662085fc6.html" target="n" data-glyph="72,1" class="t constructor">ErrorDetails</a>(<b>string</b> <span id="r14 rd" class="r14 r">message</span>)
        {
            <a href="#f4acd7f106d108bb" class="i field">_message</a> = <span class="r14 r">message</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> UseResourceId
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of ErrorDetails specifying a Message.</span>
        <span class="c">///</span><span class="c"> This variant is used by cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Cmdlet containing the template string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">baseName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">by default, the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">ResourceManager</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> name</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">resourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> by default, the resourceId in the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">ResourceManager</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">String</span>.<span class="i">Format</span>(<span class="i">IFormatProvider</span>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> insertion parameters</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This variant is a shortcut to build an instance of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#d882fa1d2308673f" class="t t">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> reducing the steps which localizable code generally has to duplicate when it</span>
        <span class="c">///</span><span class="c"> generates a localizable string.  This variant is preferred over</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#908615d662085fc6" class="t constructor">ErrorDetails</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> since the improved</span>
        <span class="c">///</span><span class="c"> information about the error may help enable future scenarios.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This constructor first loads the error message template string using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5c4315de0df8dce1" class="i method">GetResourceString</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The default implementation of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5c4315de0df8dce1" class="i method">GetResourceString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> will load a string resource from the cmdlet assembly using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">baseName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">resourceId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">;</span>
        <span class="c">///</span><span class="c"> however, specific cmdlets can override this behavior</span>
        <span class="c">///</span><span class="c"> by overriding virtual method</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#5c4315de0df8dce1" class="i method">GetResourceString</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> This constructor then inserts the specified args using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">String</span>.<span class="i">Format</span>(<span class="i">IFormatProvider</span>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a id="7fe54a607e0a0d61" href="../R/7fe54a607e0a0d61.html" target="n" data-glyph="72,1" class="t constructor">ErrorDetails</a>(
            <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r15 rd" class="r15 r">cmdlet</span>,
            <b>string</b> <span id="r16 rd" class="r16 r">baseName</span>,
            <b>string</b> <span id="r17 rd" class="r17 r">resourceId</span>,
            <b>params object</b>[] <span id="r18 rd" class="r18 r">args</span>)
        {
            <a href="#f4acd7f106d108bb" class="i field">_message</a> = <a href="#fad5252c64e644d7" class="i method">BuildMessage</a>(<span class="r15 r">cmdlet</span>, <span class="r16 r">baseName</span>, <span class="r17 r">resourceId</span>, <span class="r18 r">args</span>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of ErrorDetails specifying a Message.</span>
        <span class="c">///</span><span class="c"> This variant is used by CmdletProviders.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">resourceSupplier</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resource supplier, most often an instance of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">baseName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">by default, the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">ResourceManager</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> name</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">resourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> by default, the resourceId in the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">ResourceManager</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">String</span>.<span class="i">Format</span>(<span class="i">IFormatProvider</span>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> insertion parameters</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This variant is a shortcut to build an instance of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#d882fa1d2308673f" class="t t">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> reducing the steps which localizable code generally has to duplicate when it</span>
        <span class="c">///</span><span class="c"> generates a localizable string.  This variant is preferred over</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#908615d662085fc6" class="t constructor">ErrorDetails</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> since the improved</span>
        <span class="c">///</span><span class="c"> information about the error may help enable future scenarios.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This constructor first loads a template string using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a>.<a href="#24ea4795ac76fb45" class="i method">GetResourceString</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The default implementation of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a>.<a href="../namespaces/ProviderBase.cs.html#4ac488a9cf396f3f" class="i method">GetResourceString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> will load a string resource from the CmdletProvider assembly using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">baseName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">resourceId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">;</span>
        <span class="c">///</span><span class="c"> however, specific CmdletProviders can override this behavior</span>
        <span class="c">///</span><span class="c"> by overriding virtual method</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a>.<a href="../namespaces/ProviderBase.cs.html#4ac488a9cf396f3f" class="i method">GetResourceString</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> and it is also possible that PSSnapin custom classes</span>
        <span class="c">///</span><span class="c"> which are not instances of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> will implement</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The constructor then inserts the specified args using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">String</span>.<span class="i">Format</span>(<span class="i">IFormatProvider</span>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a id="0ff662ad5cf950f1" href="../R/0ff662ad5cf950f1.html" target="n" data-glyph="72,1" class="t constructor">ErrorDetails</a>(
            <a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a> <span id="r19 rd" class="r19 r">resourceSupplier</span>,
            <b>string</b> <span id="r20 rd" class="r20 r">baseName</span>,
            <b>string</b> <span id="r21 rd" class="r21 r">resourceId</span>,
            <b>params object</b>[] <span id="r22 rd" class="r22 r">args</span>)
        {
            <a href="#f4acd7f106d108bb" class="i field">_message</a> = <a href="#cf2508d654b82edb" class="i method">BuildMessage</a>(<span class="r19 r">resourceSupplier</span>, <span class="r20 r">baseName</span>, <span class="r21 r">resourceId</span>, <span class="r22 r">args</span>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of ErrorDetails specifying a Message.</span>
        <span class="c">///</span><span class="c"> This variant is used by other code without a reference to</span>
        <span class="c">///</span><span class="c"> a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">assembly</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> assembly containing the template string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">baseName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">by default, the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">ResourceManager</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> name</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">resourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> by default, the resourceId in the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">ResourceManager</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">String</span>.<span class="i">Format</span>(<span class="i">IFormatProvider</span>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> insertion parameters</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This variant is a shortcut to build an instance of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#d882fa1d2308673f" class="t t">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> reducing the steps which localizable code generally has to duplicate when it</span>
        <span class="c">///</span><span class="c"> generates a localizable string.  This variant is preferred over</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#908615d662085fc6" class="t constructor">ErrorDetails</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> since the improved</span>
        <span class="c">///</span><span class="c"> information about the error may help enable future scenarios.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This constructor first loads a template string from the assembly using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Resources</span>.<span class="i">ResourceManager</span>.<span class="i">GetString</span>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The constructor then inserts the specified args using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">String</span>.<span class="i">Format</span>(<span class="i">IFormatProvider</span>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a id="e366596f0d7d3a02" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ErrorDetails</a>(
            <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">Assembly</span> <span id="r23 rd" class="r23 r">assembly</span>,
            <b>string</b> <span id="r24 rd" class="r24 r">baseName</span>,
            <b>string</b> <span id="r25 rd" class="r25 r">resourceId</span>,
            <b>params object</b>[] <span id="r26 rd" class="r26 r">args</span>)
        {
            <a href="#f4acd7f106d108bb" class="i field">_message</a> = <a href="#56c24eb893459204" class="i method">BuildMessage</a>(<span class="r23 r">assembly</span>, <span class="r24 r">baseName</span>, <span class="r25 r">resourceId</span>, <span class="r26 r">args</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> UseResourceId
 
        <span class="c">// deep-copy constructor</span>
        <b>internal</b> <a id="1c412b0930a4a913" href="../R/1c412b0930a4a913.html" target="n" data-glyph="74,1" class="t constructor">ErrorDetails</a>(<a href="#d882fa1d2308673f" class="t t">ErrorDetails</a> <span id="r27 rd" class="r27 r">errorDetails</span>)
        {
            <a href="#f4acd7f106d108bb" class="i field">_message</a> = <span class="r27 r">errorDetails</span>.<a href="#f4acd7f106d108bb" class="i field">_message</a>;
            <a href="#0c10d450d07d9745" class="i field">_recommendedAction</a> = <span class="r27 r">errorDetails</span>.<a href="#0c10d450d07d9745" class="i field">_recommendedAction</a>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Serialization
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the ErrorDetails class</span>
        <span class="c">///</span><span class="c"> using data serialized via</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ISerializable</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streaming context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Constructed object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected</b> <a id="6548e7516455bd12" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">ErrorDetails</a>(<span class="i">SerializationInfo</span> <span id="r28 rd" class="r28 r">info</span>,
                               <span class="i">StreamingContext</span> <span id="r29 rd" class="r29 r">context</span>)
        {
            <a href="#f4acd7f106d108bb" class="i field">_message</a> = <span class="r28 r">info</span>.<span class="i">GetString</span>(<span class="s">&quot;ErrorDetails_Message&quot;</span>);
            <a href="#0c10d450d07d9745" class="i field">_recommendedAction</a> = <span class="r28 r">info</span>.<span class="i">GetString</span>(
                <span class="s">&quot;ErrorDetails_RecommendedAction&quot;</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializer for </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ISerializable</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streaming context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="5a5cbf44ea0b5d9f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetObjectData</a>(<span class="i">SerializationInfo</span> <span id="r30 rd" class="r30 r">info</span>, <span class="i">StreamingContext</span> <span id="r31 rd" class="r31 r">context</span>)
        {
            <b>if</b> (<span class="r30 r">info</span> != <b>null</b>)
            {
                <span class="r30 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;ErrorDetails_Message&quot;</span>, <a href="#f4acd7f106d108bb" class="i field">_message</a>);
                <span class="r30 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;ErrorDetails_RecommendedAction&quot;</span>,
                    <a href="#0c10d450d07d9745" class="i field">_recommendedAction</a>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Serialization
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Message which replaces</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Exception</span>.<span class="i">Message</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#2c2498db91e737eb" class="i property">Exception</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When an instance of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> contains a non-null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> and</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#d882fa1d2308673f" class="t t">ErrorDetails</a>.<a href="#589bef4648ccf37a" class="i property">Message</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is non-empty, the default host will display it instead of</span>
        <span class="c">///</span><span class="c"> the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Exception</span>.<span class="i">Message</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#2c2498db91e737eb" class="i property">Exception</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This should be a grammatically correct localized text string, as with</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Exception</span>.<span class="i">Message</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="589bef4648ccf37a" href="../R/589bef4648ccf37a.html" target="n" data-glyph="102,1" class="i property">Message</a>
        {
            <b>get</b> { <b>return</b> <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#9de5bc146b03ccb1" class="i method">NotNull</a>(<a href="#f4acd7f106d108bb" class="i field">_message</a>); }
        }
 
        <b>private readonly string</b> <a id="f4acd7f106d108bb" href="../R/f4acd7f106d108bb.html" target="n" data-glyph="46,1" class="i field">_message</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text describing the recommended action in the event that this error</span>
        <span class="c">///</span><span class="c"> occurs.  This is empty unless the code which generates the error</span>
        <span class="c">///</span><span class="c"> specifies it explicitly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This should be a grammatically correct localized text string.</span>
        <span class="c">///</span><span class="c"> This may be left empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4c5a9230f4299cb9" href="../R/4c5a9230f4299cb9.html" target="n" data-glyph="102,1" class="i property">RecommendedAction</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#9de5bc146b03ccb1" class="i method">NotNull</a>(<a href="#0c10d450d07d9745" class="i field">_recommendedAction</a>);
            }
 
            <b>set</b>
            {
                <a href="#0c10d450d07d9745" class="i field">_recommendedAction</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="0c10d450d07d9745" href="../R/0c10d450d07d9745.html" target="n" data-glyph="46,1" class="i field">_recommendedAction</a> = <b>string</b>.<span class="i">Empty</span>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Properties
        <b>internal</b> <span class="i">Exception</span> <a id="b82f0242bd2d7b72" href="../R/b82f0242bd2d7b72.html" target="n" data-glyph="104,1" class="i property">TextLookupError</a>
        {
            <b>get</b> { <b>return</b> <a href="#8ef1412bea5da922" class="i field">_textLookupError</a>; }
 
            <b>set</b> { <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Exception</span> <a id="8ef1412bea5da922" href="../R/8ef1412bea5da922.html" target="n" data-glyph="46,1" class="i field">_textLookupError</a> <span class="c">/* = null */</span>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ToString
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> As </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Object</span>.<span class="i">ToString</span>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Developer-readable identifier.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="f1489f087ae4ec0f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#589bef4648ccf37a" class="i property">Message</a>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ToString
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private
        <b>private string</b> <a id="fad5252c64e644d7" href="../R/fad5252c64e644d7.html" target="n" data-glyph="76,1" class="i method">BuildMessage</a>(
            <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r32 rd" class="r32 r">cmdlet</span>,
            <b>string</b> <span id="r33 rd" class="r33 r">baseName</span>,
            <b>string</b> <span id="r34 rd" class="r34 r">resourceId</span>,
            <b>params object</b>[] <span id="r35 rd" class="r35 r">args</span>)
        {
            <b>if</b> (<span class="r32 r">cmdlet</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r32 r">cmdlet</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r33 r">baseName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r33 r">baseName</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r34 r">resourceId</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r34 r">resourceId</span>));
            }
 
            <b>string</b> <span id="r36 rd" class="r36 r">template</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>try</b>
            {
                <span class="r36 r">template</span> = <span class="r32 r">cmdlet</span>.<a href="cmdlet.cs.html#5c4315de0df8dce1" class="i method">GetResourceString</a>(<span class="r33 r">baseName</span>, <span class="r34 r">resourceId</span>);
            }
            <b>catch</b> (<span class="i">MissingManifestResourceException</span> <span id="r37 rd" class="r37 r">e</span>)
            {
                <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <span class="r37 r">e</span>;
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// fallback to Exception.Message</span>
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r38 rd" class="r38 r">e</span>)
            {
                <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <span class="r38 r">e</span>;
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// fallback to Exception.Message</span>
            }
 
            <b>return</b> <a href="#affd75e209a25fce" class="i method">BuildMessage</a>(<span class="r36 r">template</span>, <span class="r33 r">baseName</span>, <span class="r34 r">resourceId</span>, <span class="r35 r">args</span>);
        }
 
        <b>private string</b> <a id="cf2508d654b82edb" href="../R/cf2508d654b82edb.html" target="n" data-glyph="76,1" class="i method">BuildMessage</a>(
            <a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a> <span id="r39 rd" class="r39 r">resourceSupplier</span>,
            <b>string</b> <span id="r40 rd" class="r40 r">baseName</span>,
            <b>string</b> <span id="r41 rd" class="r41 r">resourceId</span>,
            <b>params object</b>[] <span id="r42 rd" class="r42 r">args</span>)
        {
            <b>if</b> (<span class="r39 r">resourceSupplier</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r39 r">resourceSupplier</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r40 r">baseName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r40 r">baseName</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r41 r">resourceId</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r41 r">resourceId</span>));
            }
 
            <b>string</b> <span id="r43 rd" class="r43 r">template</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>try</b>
            {
                <span class="r43 r">template</span> = <span class="r39 r">resourceSupplier</span>.<a href="#24ea4795ac76fb45" class="i method">GetResourceString</a>(<span class="r40 r">baseName</span>, <span class="r41 r">resourceId</span>);
            }
            <b>catch</b> (<span class="i">MissingManifestResourceException</span> <span id="r44 rd" class="r44 r">e</span>)
            {
                <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <span class="r44 r">e</span>;
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// fallback to Exception.Message</span>
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r45 rd" class="r45 r">e</span>)
            {
                <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <span class="r45 r">e</span>;
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// fallback to Exception.Message</span>
            }
 
            <b>return</b> <a href="#affd75e209a25fce" class="i method">BuildMessage</a>(<span class="r43 r">template</span>, <span class="r40 r">baseName</span>, <span class="r41 r">resourceId</span>, <span class="r42 r">args</span>);
        }
 
        <b>private string</b> <a id="56c24eb893459204" href="../R/56c24eb893459204.html" target="n" data-glyph="76,1" class="i method">BuildMessage</a>(
            <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">Assembly</span> <span id="r46 rd" class="r46 r">assembly</span>,
            <b>string</b> <span id="r47 rd" class="r47 r">baseName</span>,
            <b>string</b> <span id="r48 rd" class="r48 r">resourceId</span>,
            <b>params object</b>[] <span id="r49 rd" class="r49 r">args</span>)
        {
            <b>if</b> (<span class="r46 r">assembly</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r46 r">assembly</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r47 r">baseName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r47 r">baseName</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r48 r">resourceId</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r48 r">resourceId</span>));
            }
 
            <b>string</b> <span id="r50 rd" class="r50 r">template</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <span class="i">ResourceManager</span> <span id="r51 rd" class="r51 r">manager</span> =
                <a href="../utils/ResourceManagerCache.cs.html#ce506566c7e4a091" class="t t">ResourceManagerCache</a>.<span class="i">GetResourceManager</span>(
                        <span class="r46 r">assembly</span>, <span class="r47 r">baseName</span>);
            <b>try</b>
            {
                <span class="r50 r">template</span> = <span class="r51 r">manager</span>.<span class="i">GetString</span>(
                    <span class="r48 r">resourceId</span>,
                    <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>);
            }
            <b>catch</b> (<span class="i">MissingManifestResourceException</span> <span id="r52 rd" class="r52 r">e</span>)
            {
                <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <span class="r52 r">e</span>;
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// fallback to Exception.Message</span>
            }
 
            <b>return</b> <a href="#affd75e209a25fce" class="i method">BuildMessage</a>(<span class="r50 r">template</span>, <span class="r47 r">baseName</span>, <span class="r48 r">resourceId</span>, <span class="r49 r">args</span>);
        }
 
        <b>private string</b> <a id="affd75e209a25fce" href="../R/affd75e209a25fce.html" target="n" data-glyph="76,1" class="i method">BuildMessage</a>(
            <b>string</b> <span id="r53 rd" class="r53 r">template</span>,
            <b>string</b> <span id="r54 rd" class="r54 r">baseName</span>,
            <b>string</b> <span id="r55 rd" class="r55 r">resourceId</span>,
            <b>params object</b>[] <span id="r56 rd" class="r56 r">args</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r53 r">template</span>))
            {
                <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                    <span class="i">ErrorPackage</span>.<span class="i">ErrorDetailsEmptyTemplate</span>,
                    <span class="r54 r">baseName</span>,
                    <span class="r55 r">resourceId</span>);
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// fallback to Exception.Message</span>
            }
 
            <b>try</b>
            {
                <b>return</b> <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                    <span class="r53 r">template</span>,
                    <span class="r56 r">args</span>);
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r57 rd" class="r57 r">e</span>)
            {
                <a href="#8ef1412bea5da922" class="i field">_textLookupError</a> = <span class="r57 r">e</span>;
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// fallback to Exception.Message</span>
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private
 
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents an error.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An ErrorRecord describes an error.  It extends the usual information</span>
    <span class="c">///</span><span class="c"> in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Exception</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> with the additional information in</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#61f8d29a1022ac67" class="i property">TargetObject</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#ad21d23bc150cd3b" class="i property">CategoryInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, and</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> Non-terminating errors are stored as</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> instances in shell variable</span>
    <span class="c">///</span><span class="c"> $error.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Some terminating errors implement</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#2d342e12f9600886" class="t t">IContainsErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> which gives them an ErrorRecord property containing this additional</span>
    <span class="c">///</span><span class="c"> information.  In this case, ErrorRecord.Exception will be an instance of</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#0468337cc591c6b2" class="t t">ParentContainsErrorRecordException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> rather than the actual exception, to avoid the mutual references.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="fe2b46733a081db9" href="../R/fe2b46733a081db9.html" target="n" data-glyph="0,0" class="t t">ErrorRecord</a> : <span class="i">ISerializable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <b>private</b> <a id="f68d488c188dae72" href="../R/f68d488c188dae72.html" target="n" data-glyph="76,1" class="t constructor">ErrorRecord</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of ErrorRecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is an exception which describes the error.</span>
        <span class="c">///</span><span class="c"> This argument may not be null, but it is not required</span>
        <span class="c">///</span><span class="c"> that the exception have ever been thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This string will be used to construct the FullyQualifiedErrorId,</span>
        <span class="c">///</span><span class="c"> which is a global identifier of the error condition.  Pass a</span>
        <span class="c">///</span><span class="c"> non-empty string which is specific to this error condition in</span>
        <span class="c">///</span><span class="c"> this context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">errorCategory</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the ErrorCategory which best describes the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">targetObject</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the object against which the cmdlet or provider</span>
        <span class="c">///</span><span class="c"> was operating when the error occurred.  This is optional.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="e9334565e5136f43" href="../R/e9334565e5136f43.html" target="n" data-glyph="72,1" class="t constructor">ErrorRecord</a>(
            <span class="i">Exception</span> <span id="r58 rd" class="r58 r">exception</span>,
            <b>string</b> <span id="r59 rd" class="r59 r">errorId</span>,
            <a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <span id="r60 rd" class="r60 r">errorCategory</span>,
            <b>object</b> <span id="r61 rd" class="r61 r">targetObject</span>)
        {
            <b>if</b> (<span class="r58 r">exception</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r58 r">exception</span>));
            }
 
            <b>if</b> (<span class="r59 r">errorId</span> == <b>null</b>)
            {
                <span class="r59 r">errorId</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <span class="c">// targetObject may be null</span>
            <a href="#4abec2a15f02d2e1" class="i field">_error</a> = <span class="r58 r">exception</span>;
            <a href="#59f7c3b1efc13b74" class="i field">_errorId</a> = <span class="r59 r">errorId</span>;
            <a href="#f27b76c7c8455645" class="i field">_category</a> = <span class="r60 r">errorCategory</span>;
            <a href="#80313c2069155b5e" class="i field">_target</a> = <span class="r61 r">targetObject</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Serialization
 
        <span class="c">// We serialize the exception as its original type, ensuring</span>
        <span class="c">// that the ErrorRecord information arrives in full, but taking</span>
        <span class="c">// the risk that it cannot be serialized/deserialized at all if</span>
        <span class="c">// (1) the exception type does not exist on the target machine, or</span>
        <span class="c">// (2) the exception serializer/deserializer fails or is not</span>
        <span class="c">// implemented/supported.</span>
        <span class="c">//</span>
        <span class="c">// We do not attempt to serialize TargetObject.</span>
        <span class="c">//</span>
        <span class="c">// We do not attempt to serialize InvocationInfo.  There is</span>
        <span class="c">// potentially some useful information there, but serializing</span>
        <span class="c">// InvocationInfo, Token, InternalCommand and its subclasses, and</span>
        <span class="c">// CommandInfo and its subclasses is too expensive.</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the ErrorRecord class</span>
        <span class="c">///</span><span class="c"> using data serialized via</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ISerializable</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streaming context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Constructed object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ErrorRecord instances which are serialized using</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ISerializable</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> will only be partially reconstructed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected</b> <a id="663ec25da04932f0" href="../R/663ec25da04932f0.html" target="n" data-glyph="75,1" class="t constructor">ErrorRecord</a>(<span class="i">SerializationInfo</span> <span id="r62 rd" class="r62 r">info</span>,
                              <span class="i">StreamingContext</span> <span id="r63 rd" class="r63 r">context</span>)
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r64 rd" class="r64 r">psObject</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#da1a0c5544c2130d" class="i method">ConstructPSObjectFromSerializationInfo</a>(<span class="r62 r">info</span>, <span class="r63 r">context</span>);
            <a href="#655693f5f92bd834" class="i method">ConstructFromPSObjectForRemoting</a>(<span class="r64 r">psObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserializer for </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ISerializable</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streaming context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="0c95481346119815" href="../R/0c95481346119815.html" target="n" data-glyph="72,1" class="i method">GetObjectData</a>(<span class="i">SerializationInfo</span> <span id="r65 rd" class="r65 r">info</span>, <span class="i">StreamingContext</span> <span id="r66 rd" class="r66 r">context</span>)
        {
            <b>if</b> (<span class="r65 r">info</span> != <b>null</b>)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r67 rd" class="r67 r">psObject</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
 
                <span class="c">// for binary serialization always serialize the extended info</span>
                <a href="#2798c252023217f9" class="i method">ToPSObjectForRemoting</a>(<span class="r67 r">psObject</span>, <b>true</b>);
 
                <span class="r67 r">psObject</span>.<a href="MshObject.cs.html#c365b93cc458b2fe" class="i method">GetObjectData</a>(<span class="r65 r">info</span>, <span class="r66 r">context</span>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Serialization
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Remoting
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsSerialized is set to true if this error record is serialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="6985f92027c1ce07" href="../R/6985f92027c1ce07.html" target="n" data-glyph="46,1" class="i field">_isSerialized</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is this instance serialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6685237eac5a08f0" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">IsSerialized</a> { <b>get</b> =&gt; <a href="#6985f92027c1ce07" class="i field">_isSerialized</a>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Value for FullyQualifiedErrorId in case of serialized error record.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="a68c8a65ae86f32d" href="../R/a68c8a65ae86f32d.html" target="n" data-glyph="46,1" class="i field">_serializedFullyQualifiedErrorId</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Message overridee for CategoryInfo.GetMessage method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="5186af07ffd9da1c" href="../R/5186af07ffd9da1c.html" target="n" data-glyph="44,1" class="i field">_serializedErrorCategoryMessageOverride</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor is used by remoting code to create ErrorRecord.</span>
        <span class="c">///</span><span class="c"> Various information is obtained from serialized ErrorRecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">exception</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">targetObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">fullyQualifiedErrorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">errorCategory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">errorCategory_Activity</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">errorCategory_Reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">errorCategory_TargetName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">errorCategory_TargetType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">errorCategory_Message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">errorDetails_Message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">errorDetails_RecommendedAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="63310140b5760920" href="../R/63310140b5760920.html" target="n" data-glyph="74,1" class="t constructor">ErrorRecord</a>(
            <span class="i">Exception</span> <span id="r68 rd" class="r68 r">exception</span>,
            <b>object</b> <span id="r69 rd" class="r69 r">targetObject</span>,
            <b>string</b> <span id="r70 rd" class="r70 r">fullyQualifiedErrorId</span>,
            <a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <span id="r71 rd" class="r71 r">errorCategory</span>,
            <b>string</b> <span id="r72 rd" class="r72 r">errorCategory_Activity</span>,
            <b>string</b> <span id="r73 rd" class="r73 r">errorCategory_Reason</span>,
            <b>string</b> <span id="r74 rd" class="r74 r">errorCategory_TargetName</span>,
            <b>string</b> <span id="r75 rd" class="r75 r">errorCategory_TargetType</span>,
            <b>string</b> <span id="r76 rd" class="r76 r">errorCategory_Message</span>,
            <b>string</b> <span id="r77 rd" class="r77 r">errorDetails_Message</span>,
            <b>string</b> <span id="r78 rd" class="r78 r">errorDetails_RecommendedAction</span>)
        {
            <a href="#295adedfe021fe52" class="i method">PopulateProperties</a>(
                <span class="r68 r">exception</span>, <span class="r69 r">targetObject</span>, <span class="r70 r">fullyQualifiedErrorId</span>, <span class="r71 r">errorCategory</span>, <span class="r72 r">errorCategory_Activity</span>,
                <span class="r73 r">errorCategory_Reason</span>, <span class="r74 r">errorCategory_TargetName</span>, <span class="r75 r">errorCategory_TargetType</span>,
                <span class="r76 r">errorCategory_Message</span>, <span class="r77 r">errorDetails_Message</span>, <span class="r78 r">errorDetails_RecommendedAction</span>, <b>null</b>);
        }
 
        <b>private void</b> <a id="295adedfe021fe52" href="../R/295adedfe021fe52.html" target="n" data-glyph="76,1" class="i method">PopulateProperties</a>(
            <span class="i">Exception</span> <span id="r79 rd" class="r79 r">exception</span>,
            <b>object</b> <span id="r80 rd" class="r80 r">targetObject</span>,
            <b>string</b> <span id="r81 rd" class="r81 r">fullyQualifiedErrorId</span>,
            <a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <span id="r82 rd" class="r82 r">errorCategory</span>,
            <b>string</b> <span id="r83 rd" class="r83 r">errorCategory_Activity</span>,
            <b>string</b> <span id="r84 rd" class="r84 r">errorCategory_Reason</span>,
            <b>string</b> <span id="r85 rd" class="r85 r">errorCategory_TargetName</span>,
            <b>string</b> <span id="r86 rd" class="r86 r">errorCategory_TargetType</span>,
            <b>string</b> <span id="r87 rd" class="r87 r">errorCategory_Message</span>,
            <b>string</b> <span id="r88 rd" class="r88 r">errorDetails_Message</span>,
            <b>string</b> <span id="r89 rd" class="r89 r">errorDetails_RecommendedAction</span>,
            <b>string</b> <span id="r90 rd" class="r90 r">errorDetails_ScriptStackTrace</span>)
        {
            <b>if</b> (<span class="r79 r">exception</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r79 r">exception</span>));
            }
 
            <b>if</b> (<span class="r81 r">fullyQualifiedErrorId</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r81 r">fullyQualifiedErrorId</span>));
            }
 
            <span class="c">// Mark this error record as serialized</span>
            <a href="#6985f92027c1ce07" class="i field">_isSerialized</a> = <b>true</b>;
            <a href="#4abec2a15f02d2e1" class="i field">_error</a> = <span class="r79 r">exception</span>;
            <a href="#80313c2069155b5e" class="i field">_target</a> = <span class="r80 r">targetObject</span>;
            <a href="#a68c8a65ae86f32d" class="i field">_serializedFullyQualifiedErrorId</a> = <span class="r81 r">fullyQualifiedErrorId</span>;
            <a href="#f27b76c7c8455645" class="i field">_category</a> = <span class="r82 r">errorCategory</span>;
            <a href="#0f4e19dafca43646" class="i field">_activityOverride</a> = <span class="r83 r">errorCategory_Activity</span>;
            <a href="#80971f76030da766" class="i field">_reasonOverride</a> = <span class="r84 r">errorCategory_Reason</span>;
            <a href="#f02d72354a7772ee" class="i field">_targetNameOverride</a> = <span class="r85 r">errorCategory_TargetName</span>;
            <a href="#5f7237a7a6013c7d" class="i field">_targetTypeOverride</a> = <span class="r86 r">errorCategory_TargetType</span>;
            <a href="#5186af07ffd9da1c" class="i field">_serializedErrorCategoryMessageOverride</a> = <span class="r87 r">errorCategory_Message</span>;
            <b>if</b> (<span class="r88 r">errorDetails_Message</span> != <b>null</b>)
            {
                <a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="#908615d662085fc6" class="t constructor">ErrorDetails</a>(<span class="r88 r">errorDetails_Message</span>);
                <b>if</b> (<span class="r89 r">errorDetails_RecommendedAction</span> != <b>null</b>)
                {
                    <a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="#4c5a9230f4299cb9" class="i property">RecommendedAction</a> = <span class="r89 r">errorDetails_RecommendedAction</span>;
                }
            }
 
            <a href="#f0af7a00075e15c2" class="i field">_scriptStackTrace</a> = <span class="r90 r">errorDetails_ScriptStackTrace</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the information about this error record to PSObject as notes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="d16aa6eb75ff130e" href="../R/d16aa6eb75ff130e.html" target="n" data-glyph="74,1" class="i method">ToPSObjectForRemoting</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r91 rd" class="r91 r">dest</span>)
        {
            <a href="#2798c252023217f9" class="i method">ToPSObjectForRemoting</a>(<span class="r91 r">dest</span>, <a href="#b342040c9a68cad7" class="i property">SerializeExtendedInfo</a>);
        }
 
        <b>private void</b> <a id="2798c252023217f9" href="../R/2798c252023217f9.html" target="n" data-glyph="76,1" class="i method">ToPSObjectForRemoting</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r92 rd" class="r92 r">dest</span>, <b>bool</b> <span id="r93 rd" class="r93 r">serializeExtInfo</span>)
        {
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<span class="i">Exception</span>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;Exception&quot;</span>, () =&gt; <a href="#2c2498db91e737eb" class="i property">Exception</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>object</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;TargetObject&quot;</span>, () =&gt; <a href="#61f8d29a1022ac67" class="i property">TargetObject</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;FullyQualifiedErrorId&quot;</span>, () =&gt; <a href="#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;InvocationInfo&quot;</span>, () =&gt; <a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<span class="i">AddNoteProperty</span>&lt;<b>int</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorCategory_Category&quot;</span>, () =&gt; (<b>int</b>)<a href="#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="#f4073b5e554619ca" class="i property">Category</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorCategory_Activity&quot;</span>, () =&gt; <a href="#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="#d01c639de81db291" class="i property">Activity</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorCategory_Reason&quot;</span>, () =&gt; <a href="#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="#fc99e636c67fec35" class="i property">Reason</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorCategory_TargetName&quot;</span>, () =&gt; <a href="#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="#2258f12784435a42" class="i property">TargetName</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorCategory_TargetType&quot;</span>, () =&gt; <a href="#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="#f11557f8e48da1ba" class="i property">TargetType</a>);
            <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<span class="i">AddNoteProperty</span>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorCategory_Message&quot;</span>, () =&gt; <a href="#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<span class="i">GetMessage</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>));
 
            <b>if</b> (<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a> != <b>null</b>)
            {
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorDetails_Message&quot;</span>, () =&gt; <a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="#589bef4648ccf37a" class="i property">Message</a>);
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>string</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorDetails_RecommendedAction&quot;</span>, () =&gt; <a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="#4c5a9230f4299cb9" class="i property">RecommendedAction</a>);
            }
 
            <b>if</b> (!<span class="r93 r">serializeExtInfo</span> || <a href="#fe2b46733a081db9" class="k">this</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a> == <b>null</b>)
            {
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<span class="i">AddNoteProperty</span>(<span class="r92 r">dest</span>, <span class="s">&quot;SerializeExtendedInfo&quot;</span>, () =&gt; <b>false</b>);
            }
            <b>else</b>
            {
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<span class="i">AddNoteProperty</span>(<span class="r92 r">dest</span>, <span class="s">&quot;SerializeExtendedInfo&quot;</span>, () =&gt; <b>true</b>);
                <a href="#fe2b46733a081db9" class="k">this</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#a046fd5ea44698d2" class="i method">ToPSObjectForRemoting</a>(<span class="r92 r">dest</span>);
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>&lt;<b>object</b>&gt;(<span class="r92 r">dest</span>, <span class="s">&quot;PipelineIterationInfo&quot;</span>, () =&gt; <a href="#d518898473f7ace6" class="i property">PipelineIterationInfo</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#fe2b46733a081db9" class="k">this</a>.<a href="#7eba7a71017af1bd" class="i property">ScriptStackTrace</a>))
            {
                <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>(<span class="r92 r">dest</span>, <span class="s">&quot;ErrorDetails_ScriptStackTrace&quot;</span>, () =&gt; <a href="#fe2b46733a081db9" class="k">this</a>.<a href="#7eba7a71017af1bd" class="i property">ScriptStackTrace</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the value for note from mshObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">mshObject</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSObject from which value is fetched.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">note</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name of note whose value is fetched</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> value of note</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static object</b> <a id="700472922c6acc88" href="../R/700472922c6acc88.html" target="n" data-glyph="76,1" class="i method">GetNoteValue</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r94 rd" class="r94 r">mshObject</span>, <b>string</b> <span id="r95 rd" class="r95 r">note</span>)
        {
            <b>if</b> (<span class="r94 r">mshObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r95 r">note</span>] <b>is</b> <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r96 rd" class="r96 r">p</span>)
            {
                <b>return</b> <span class="r96 r">p</span>.<a href="MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>;
            }
            <b>else</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create an ErrorRecord object from serialized ErrorRecord.</span>
        <span class="c">///</span><span class="c"> serializedErrorRecord PSObject is in the format returned</span>
        <span class="c">///</span><span class="c"> by ToPSObjectForRemoting method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">serializedErrorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSObject to convert to ErrorRecord</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ErrorRecord convert from mshObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown if mshObject parameter is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="1232603351a94344" href="../R/1232603351a94344.html" target="n" data-glyph="74,1" class="i method">FromPSObjectForRemoting</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r97 rd" class="r97 r">serializedErrorRecord</span>)
        {
            <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r98 rd" class="r98 r">er</span> = <b>new</b> <a href="#f68d488c188dae72" class="t constructor">ErrorRecord</a>();
            <span class="r98 r">er</span>.<a href="#655693f5f92bd834" class="i method">ConstructFromPSObjectForRemoting</a>(<span class="r97 r">serializedErrorRecord</span>);
            <b>return</b> <span class="r98 r">er</span>;
        }
 
        <b>private void</b> <a id="655693f5f92bd834" href="../R/655693f5f92bd834.html" target="n" data-glyph="76,1" class="i method">ConstructFromPSObjectForRemoting</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r99 rd" class="r99 r">serializedErrorRecord</span>)
        {
            <b>if</b> (<span class="r99 r">serializedErrorRecord</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r99 r">serializedErrorRecord</span>));
            }
 
            <span class="c">// Get Exception</span>
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r100 rd" class="r100 r">serializedException</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;Exception&quot;</span>);
 
            <span class="c">// Get Target object</span>
            <b>object</b> <span id="r101 rd" class="r101 r">targetObject</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>object</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;TargetObject&quot;</span>);
 
            <b>string</b> <span id="r102 rd" class="r102 r">exceptionMessage</span> = <b>null</b>;
            <b>if</b> (<span class="r100 r">serializedException</span> != <b>null</b>)
            {
                <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r103 rd" class="r103 r">messageProperty</span> = <span class="r100 r">serializedException</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Message&quot;</span>] <b>as</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
                <b>if</b> (<span class="r103 r">messageProperty</span> != <b>null</b>)
                {
                    <span class="r102 r">exceptionMessage</span> = <span class="r103 r">messageProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> <b>as string</b>;
                }
            }
 
            <span class="c">// Get FullyQualifiedErrorId</span>
            <b>string</b> <span id="r104 rd" class="r104 r">fullyQualifiedErrorId</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;FullyQualifiedErrorId&quot;</span>) ??
                                           <span class="s">&quot;fullyQualifiedErrorId&quot;</span>;
 
            <span class="c">// Get ErrorCategory...</span>
            <a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <span id="r105 rd" class="r105 r">errorCategory</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;errorCategory_Category&quot;</span>);
 
            <span class="c">// Get Various ErrorCategory fileds</span>
            <b>string</b> <span id="r106 rd" class="r106 r">errorCategory_Activity</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorCategory_Activity&quot;</span>);
            <b>string</b> <span id="r107 rd" class="r107 r">errorCategory_Reason</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorCategory_Reason&quot;</span>);
            <b>string</b> <span id="r108 rd" class="r108 r">errorCategory_TargetName</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorCategory_TargetName&quot;</span>);
            <b>string</b> <span id="r109 rd" class="r109 r">errorCategory_TargetType</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorCategory_TargetType&quot;</span>);
            <b>string</b> <span id="r110 rd" class="r110 r">errorCategory_Message</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorCategory_Message&quot;</span>);
 
            <span class="c">// Get InvocationInfo (optional property)</span>
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r111 rd" class="r111 r">invocationInfo</span> = <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="serialization.cs.html#ddbcb5ecc947a806" class="t t">DeserializingTypeConverter</a>.<a href="serialization.cs.html#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(
                <span class="r99 r">serializedErrorRecord</span>,
                <span class="s">&quot;InvocationInfo&quot;</span>,
                <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="serialization.cs.html#ddbcb5ecc947a806" class="t t">DeserializingTypeConverter</a>.<a href="serialization.cs.html#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="serialization.cs.html#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
 
            <span class="c">// Get Error Detail (these note properties are optional, so can&#39;t right now use RemotingDecoder...)</span>
            <b>string</b> <span id="r112 rd" class="r112 r">errorDetails_Message</span> =
                <a href="#700472922c6acc88" class="i method">GetNoteValue</a>(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorDetails_Message&quot;</span>) <b>as string</b>;
 
            <b>string</b> <span id="r113 rd" class="r113 r">errorDetails_RecommendedAction</span> =
                <a href="#700472922c6acc88" class="i method">GetNoteValue</a>(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorDetails_RecommendedAction&quot;</span>) <b>as string</b>;
 
            <b>string</b> <span id="r114 rd" class="r114 r">errorDetails_ScriptStackTrace</span> =
                <a href="#700472922c6acc88" class="i method">GetNoteValue</a>(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;ErrorDetails_ScriptStackTrace&quot;</span>) <b>as string</b>;
 
            <a href="NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r115 rd" class="r115 r">re</span> = <b>new</b> <a href="NativeCommandProcessor.cs.html#0b6936c7838fa5eb" class="t constructor">RemoteException</a>((!<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r102 r">exceptionMessage</span>)) ? <span class="r102 r">exceptionMessage</span> : <span class="r110 r">errorCategory_Message</span>, <span class="r100 r">serializedException</span>, <span class="r111 r">invocationInfo</span>);
 
            <span class="c">// Create ErrorRecord</span>
            <span class="i">PopulateProperties</span>(
                <span class="r115 r">re</span>,
                <span class="r101 r">targetObject</span>,
                <span class="r104 r">fullyQualifiedErrorId</span>,
                <span class="r105 r">errorCategory</span>,
                <span class="r106 r">errorCategory_Activity</span>,
                <span class="r107 r">errorCategory_Reason</span>,
                <span class="r108 r">errorCategory_TargetName</span>,
                <span class="r109 r">errorCategory_TargetType</span>,
                <span class="r110 r">errorCategory_Message</span>,
                <span class="r112 r">errorDetails_Message</span>,
                <span class="r113 r">errorDetails_RecommendedAction</span>,
                <span class="r114 r">errorDetails_ScriptStackTrace</span>
                );
 
            <span class="r115 r">re</span>.<a href="NativeCommandProcessor.cs.html#fdd226a4f17722db" class="i method">SetRemoteErrorRecord</a>(<a href="#fe2b46733a081db9" class="k">this</a>);
 
            <span class="c">//</span>
            <span class="c">// Get the InvocationInfo</span>
            <span class="c">//</span>
            <a href="#6a6969c3aceb55ae" class="i field">_serializeExtendedInfo</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;SerializeExtendedInfo&quot;</span>);
 
            <b>if</b> (<a href="#6a6969c3aceb55ae" class="i field">_serializeExtendedInfo</a>)
            {
                <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a> = <b>new</b> <a href="InvocationInfo.cs.html#4817611dedebd2b0" class="t constructor">InvocationInfo</a>(<span class="r99 r">serializedErrorRecord</span>);
 
                <span class="i">ArrayList</span> <span id="r116 rd" class="r116 r">iterationInfo</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">ArrayList</span>&gt;(<span class="r99 r">serializedErrorRecord</span>, <span class="s">&quot;PipelineIterationInfo&quot;</span>);
                <b>if</b> (<span class="r116 r">iterationInfo</span> != <b>null</b>)
                {
                    <a href="#9e8472a6d5218ffe" class="i field">_pipelineIterationInfo</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<b>int</b>&gt;((<b>int</b>[])<span class="r116 r">iterationInfo</span>.<span class="i">ToArray</span>(<b>typeof</b>(<span class="i">Int32</span>)));
                }
            }
            <b>else</b>
            {
                <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a> = <b>null</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Remoting
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy constructor, for use when a new wrapper exception wraps an</span>
        <span class="c">///</span><span class="c"> exception which already has an ErrorRecord</span>
        <span class="c">///</span><span class="c"> ErrorCategoryInfo and ErrorDetails are deep-copied, other fields are not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Wrapped ErrorRecord.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">replaceParentContainsErrorRecordException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the wrapped exception contains a ParentContainsErrorRecordException, the new</span>
        <span class="c">///</span><span class="c"> ErrorRecord should have this exception as its Exception instead.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="9d778b0f7802757e" href="../R/9d778b0f7802757e.html" target="n" data-glyph="72,1" class="t constructor">ErrorRecord</a>(<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r117 rd" class="r117 r">errorRecord</span>,
                             <span class="i">Exception</span> <span id="r118 rd" class="r118 r">replaceParentContainsErrorRecordException</span>)
        {
            <b>if</b> (<span class="r117 r">errorRecord</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r117 r">errorRecord</span>));
            }
 
            <b>if</b> (<span class="r118 r">replaceParentContainsErrorRecordException</span> != <b>null</b>
                &amp;&amp; (<span class="r117 r">errorRecord</span>.<a href="#2c2498db91e737eb" class="i property">Exception</a> <b>is</b> <a href="../utils/ExecutionExceptions.cs.html#0468337cc591c6b2" class="t t">ParentContainsErrorRecordException</a>))
            {
                <a href="#4abec2a15f02d2e1" class="i field">_error</a> = <span class="r118 r">replaceParentContainsErrorRecordException</span>;
            }
            <b>else</b>
            {
                <a href="#4abec2a15f02d2e1" class="i field">_error</a> = <span class="r117 r">errorRecord</span>.<a href="#2c2498db91e737eb" class="i property">Exception</a>;
            }
 
            <a href="#80313c2069155b5e" class="i field">_target</a> = <span class="r117 r">errorRecord</span>.<a href="#61f8d29a1022ac67" class="i property">TargetObject</a>;
            <a href="#59f7c3b1efc13b74" class="i field">_errorId</a> = <span class="r117 r">errorRecord</span>.<a href="#59f7c3b1efc13b74" class="i field">_errorId</a>;
            <a href="#f27b76c7c8455645" class="i field">_category</a> = <span class="r117 r">errorRecord</span>.<a href="#f27b76c7c8455645" class="i field">_category</a>;
            <a href="#0f4e19dafca43646" class="i field">_activityOverride</a> = <span class="r117 r">errorRecord</span>.<a href="#0f4e19dafca43646" class="i field">_activityOverride</a>;
            <a href="#80971f76030da766" class="i field">_reasonOverride</a> = <span class="r117 r">errorRecord</span>.<a href="#80971f76030da766" class="i field">_reasonOverride</a>;
            <a href="#f02d72354a7772ee" class="i field">_targetNameOverride</a> = <span class="r117 r">errorRecord</span>.<a href="#f02d72354a7772ee" class="i field">_targetNameOverride</a>;
            <a href="#5f7237a7a6013c7d" class="i field">_targetTypeOverride</a> = <span class="r117 r">errorRecord</span>.<a href="#5f7237a7a6013c7d" class="i field">_targetTypeOverride</a>;
            <b>if</b> (<span class="r117 r">errorRecord</span>.<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a> != <b>null</b>)
            {
                <a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a> = <b>new</b> <a href="#1c412b0930a4a913" class="t constructor">ErrorDetails</a>(<span class="r117 r">errorRecord</span>.<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a>);
            }
 
            <a href="#14b8261653db7b03" class="i method">SetInvocationInfo</a>(<span class="r117 r">errorRecord</span>.<a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a>);
            <a href="#f0af7a00075e15c2" class="i field">_scriptStackTrace</a> = <span class="r117 r">errorRecord</span>.<a href="#f0af7a00075e15c2" class="i field">_scriptStackTrace</a>;
            <a href="#a68c8a65ae86f32d" class="i field">_serializedFullyQualifiedErrorId</a> = <span class="r117 r">errorRecord</span>.<a href="#a68c8a65ae86f32d" class="i field">_serializedFullyQualifiedErrorId</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Override
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap the current ErrorRecord instance</span>
        <span class="c">///</span><span class="c"> A derived class needs to override this method if it contains additional info that needs to be kept when it gets wrapped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">replaceParentContainsErrorRecordException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the wrapped exception contains a ParentContainsErrorRecordException, the new</span>
        <span class="c">///</span><span class="c"> ErrorRecord should have this exception as its Exception instead.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="9e35048d3151c484" href="../R/9e35048d3151c484.html" target="n" data-glyph="74,1" class="i method">WrapException</a>(<span class="i">Exception</span> <span id="r119 rd" class="r119 r">replaceParentContainsErrorRecordException</span>)
        {
            <b>return</b> <b>new</b> <a href="#9d778b0f7802757e" class="t constructor">ErrorRecord</a>(<a href="#fe2b46733a081db9" class="k">this</a>, <span class="r119 r">replaceParentContainsErrorRecordException</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Override
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An Exception describing the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">never null</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Exception</span> <a id="2c2498db91e737eb" href="../R/2c2498db91e737eb.html" target="n" data-glyph="102,1" class="i property">Exception</a>
        {
            <b>get</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#4abec2a15f02d2e1" class="i field">_error</a> != <b>null</b>, <span class="s">&quot;_error is null&quot;</span>);
                <b>return</b> <a href="#4abec2a15f02d2e1" class="i field">_error</a>;
            }
        }
 
        <b>private</b> <span class="i">Exception</span> <a id="4abec2a15f02d2e1" href="../R/4abec2a15f02d2e1.html" target="n" data-glyph="46,1" class="i field">_error</a> <span class="c">/* = null */</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object against which the error occurred.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">may be null</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public object</b> <a id="61f8d29a1022ac67" href="../R/61f8d29a1022ac67.html" target="n" data-glyph="102,1" class="i property">TargetObject</a> { <b>get</b> =&gt; <a href="#80313c2069155b5e" class="i field">_target</a>; }
 
        <b>private object</b> <a id="80313c2069155b5e" href="../R/80313c2069155b5e.html" target="n" data-glyph="46,1" class="i field">_target</a> <span class="c">/* = null */</span>;
 
        <b>internal void</b> <a id="e64056cb0422ee22" href="../R/e64056cb0422ee22.html" target="n" data-glyph="74,1" class="i method">SetTargetObject</a>(<b>object</b> <span id="r120 rd" class="r120 r">target</span>)
        {
            <a href="#80313c2069155b5e" class="i field">_target</a> = <span class="r120 r">target</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Information regarding the ErrorCategory</span>
        <span class="c">///</span><span class="c"> associated with this error, and with the categorized error message</span>
        <span class="c">///</span><span class="c"> for that ErrorCategory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">never null</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a> <a id="ad21d23bc150cd3b" href="../R/ad21d23bc150cd3b.html" target="n" data-glyph="102,1" class="i property">CategoryInfo</a> { <b>get</b> =&gt; <a href="#72d99ad3d98feb87" class="i field">_categoryInfo</a> ??= <b>new</b> <a href="#d5bc927f9d1cf9a1" class="t constructor">ErrorCategoryInfo</a>(<a href="#fe2b46733a081db9" class="k">this</a>); }
 
        <b>private</b> <a href="#37830dc92d4ac970" class="t t">ErrorCategoryInfo</a> <a id="72d99ad3d98feb87" href="../R/72d99ad3d98feb87.html" target="n" data-glyph="46,1" class="i field">_categoryInfo</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> String which uniquely identifies this error condition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">never null</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> FullyQualifiedErrorid identifies this error condition</span>
        <span class="c">///</span><span class="c"> more specifically than either the ErrorCategory</span>
        <span class="c">///</span><span class="c"> or the Exception.  Use FullyQualifiedErrorId to filter specific</span>
        <span class="c">///</span><span class="c"> error conditions, or to associate special handling with specific</span>
        <span class="c">///</span><span class="c"> error conditions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="80d40f16f77d32bb" href="../R/80d40f16f77d32bb.html" target="n" data-glyph="102,1" class="i property">FullyQualifiedErrorId</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#a68c8a65ae86f32d" class="i field">_serializedFullyQualifiedErrorId</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#a68c8a65ae86f32d" class="i field">_serializedFullyQualifiedErrorId</a>;
                }
 
                <b>string</b> <span id="r121 rd" class="r121 r">typeName</span> = <a href="#3b1e5e1f28dc8977" class="i method">GetInvocationTypeName</a>();
                <b>string</b> <span id="r122 rd" class="r122 r">delimiter</span> =
                    (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r121 r">typeName</span>) || <b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#59f7c3b1efc13b74" class="i field">_errorId</a>))
                        ? <b>string</b>.<span class="i">Empty</span>
                        : <span class="s">&quot;,&quot;</span>;
                <b>return</b> <a href="#9de5bc146b03ccb1" class="i method">NotNull</a>(<a href="#59f7c3b1efc13b74" class="i field">_errorId</a>) + <span class="r122 r">delimiter</span> + <a href="#9de5bc146b03ccb1" class="i method">NotNull</a>(<span class="r121 r">typeName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Additional information about the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">may be null</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In particular, ErrorDetails.Message (if present and non-empty)</span>
        <span class="c">///</span><span class="c"> contains a replacement message which should be displayed instead of</span>
        <span class="c">///</span><span class="c"> Exception.Message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#d882fa1d2308673f" class="t t">ErrorDetails</a> <a id="4e9df045b6372ce0" href="../R/4e9df045b6372ce0.html" target="n" data-glyph="102,1" class="i property">ErrorDetails</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Identifies the cmdlet, script, or other command which caused</span>
        <span class="c">///</span><span class="c"> the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">may be null</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="fd1ac7b3462d4426" href="../R/fd1ac7b3462d4426.html" target="n" data-glyph="102,1" class="i property">InvocationInfo</a> { <b>get</b> =&gt; <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a>; }
 
        <b>private</b> <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="8f4b79b3eb83ce67" href="../R/8f4b79b3eb83ce67.html" target="n" data-glyph="46,1" class="i field">_invocationInfo</a> <span class="c">/* = null */</span>;
 
        <b>internal void</b> <a id="14b8261653db7b03" href="../R/14b8261653db7b03.html" target="n" data-glyph="74,1" class="i method">SetInvocationInfo</a>(<a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r123 rd" class="r123 r">invocationInfo</span>)
        {
            <span class="c">// Save the DisplayScriptPosition, if set</span>
            <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r124 rd" class="r124 r">savedDisplayScriptPosition</span> = <b>null</b>;
            <b>if</b> (<a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a> != <b>null</b>)
            {
                <span class="r124 r">savedDisplayScriptPosition</span> = <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a>.<a href="InvocationInfo.cs.html#da1298533340b29e" class="i property">DisplayScriptPosition</a>;
            }
 
            <span class="c">// Assign the invocationInfo</span>
            <b>if</b> (<span class="r123 r">invocationInfo</span> != <b>null</b>)
            {
                <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a> = <b>new</b> <a href="InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<span class="r123 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>, <span class="r123 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>);
                <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a>.<a href="InvocationInfo.cs.html#57f452abf157b50b" class="i property">InvocationName</a> = <span class="r123 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#57f452abf157b50b" class="i property">InvocationName</a>;
                <b>if</b> (<span class="r123 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a> == <b>null</b>)
                {
                    <span class="c">// Pass the history id to new InvocationInfo object of command info is null since history</span>
                    <span class="c">// information cannot be obtained in this case.</span>
                    <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a>.<a href="InvocationInfo.cs.html#6118e67ee157a06b" class="i property">HistoryId</a> = <span class="r123 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#6118e67ee157a06b" class="i property">HistoryId</a>;
                }
            }
 
            <span class="c">// Restore the DisplayScriptPosition</span>
            <b>if</b> (<span class="r124 r">savedDisplayScriptPosition</span> != <b>null</b>)
            {
                <a href="#8f4b79b3eb83ce67" class="i field">_invocationInfo</a>.<a href="InvocationInfo.cs.html#da1298533340b29e" class="i property">DisplayScriptPosition</a> = <span class="r124 r">savedDisplayScriptPosition</span>;
            }
 
            <a href="#f3959861270f09c6" class="i method">LockScriptStackTrace</a>();
 
            <span class="c">//</span>
            <span class="c">// Copy a snapshot of the PipelinePositionInfo from the InvocationInfo to this ErrorRecord</span>
            <span class="c">//</span>
            <b>if</b> (<span class="r123 r">invocationInfo</span> != <b>null</b> &amp;&amp; <span class="r123 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#0696af7afce6ee9b" class="i property">PipelineIterationInfo</a> != <b>null</b>)
            {
                <b>int</b>[] <span id="r125 rd" class="r125 r">snapshot</span> = (<b>int</b>[])<span class="r123 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#0696af7afce6ee9b" class="i property">PipelineIterationInfo</a>.<span class="i">Clone</span>();
 
                <a href="#9e8472a6d5218ffe" class="i field">_pipelineIterationInfo</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<b>int</b>&gt;(<span class="r125 r">snapshot</span>);
            }
        }
 
        <span class="c">// 2005/07/14-913791 &quot;write-error output is confusing and misleading&quot;</span>
        <b>internal bool</b> <a id="b119c9996bde5b66" href="../R/b119c9996bde5b66.html" target="n" data-glyph="104,1" class="i property">PreserveInvocationInfoOnce</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script stack trace for the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="7eba7a71017af1bd" href="../R/7eba7a71017af1bd.html" target="n" data-glyph="102,1" class="i property">ScriptStackTrace</a> { <b>get</b> =&gt; <a href="#f0af7a00075e15c2" class="i field">_scriptStackTrace</a>; }
 
        <b>private string</b> <a id="f0af7a00075e15c2" href="../R/f0af7a00075e15c2.html" target="n" data-glyph="46,1" class="i field">_scriptStackTrace</a>;
 
        <b>internal void</b> <a id="f3959861270f09c6" href="../R/f3959861270f09c6.html" target="n" data-glyph="74,1" class="i method">LockScriptStackTrace</a>()
        {
            <b>if</b> (<a href="#f0af7a00075e15c2" class="i field">_scriptStackTrace</a> != <b>null</b>)
            {
                <b>return</b>;
            }
 
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r126 rd" class="r126 r">context</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>if</b> (<span class="r126 r">context</span> != <b>null</b>)
            {
                <span class="i">StringBuilder</span> <span id="r127 rd" class="r127 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <b>var</b> <span id="r128 rd" class="r128 r">callstack</span> = <span class="r126 r">context</span>.<a href="ExecutionContext.cs.html#3e56b2d709de0d80" class="i property">Debugger</a>.<a href="debugger/debugger.cs.html#6e5b14dde8877cdc" class="i method">GetCallStack</a>();
                <b>bool</b> <span id="r129 rd" class="r129 r">first</span> = <b>true</b>;
                <b>foreach</b> (<b>var</b> <span id="r130 rd" class="r130 r">frame</span> <b>in</b> <span class="r128 r">callstack</span>)
                {
                    <b>if</b> (!<span class="r129 r">first</span>)
                    {
                        <span class="r127 r">sb</span>.<span class="i">Append</span>(<span class="i">Environment</span>.<span class="i">NewLine</span>);
                    }
 
                    <span class="r129 r">first</span> = <b>false</b>;
                    <span class="r127 r">sb</span>.<span class="i">Append</span>(<span class="r130 r">frame</span>.<span class="i">ToString</span>());
                }
 
                <a href="#f0af7a00075e15c2" class="i field">_scriptStackTrace</a> = <span class="r127 r">sb</span>.<span class="i">ToString</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The status of the pipeline when this record was created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<b>int</b>&gt; <a id="d518898473f7ace6" href="../R/d518898473f7ace6.html" target="n" data-glyph="102,1" class="i property">PipelineIterationInfo</a> { <b>get</b> =&gt; <a href="#9e8472a6d5218ffe" class="i field">_pipelineIterationInfo</a>; }
 
        <b>private</b> <span class="i">ReadOnlyCollection</span>&lt;<b>int</b>&gt; <a id="9e8472a6d5218ffe" href="../R/9e8472a6d5218ffe.html" target="n" data-glyph="46,1" class="i field">_pipelineIterationInfo</a> = <a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6addb097ebf2d60e" class="i method">EmptyReadOnlyCollection</a>&lt;<b>int</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether to serialize the InvocationInfo during remote calls.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="b342040c9a68cad7" href="../R/b342040c9a68cad7.html" target="n" data-glyph="104,1" class="i property">SerializeExtendedInfo</a>
        {
            <b>get</b> =&gt; <a href="#6a6969c3aceb55ae" class="i field">_serializeExtendedInfo</a>;
 
            <b>set</b> =&gt; <a href="#6a6969c3aceb55ae" class="i field">_serializeExtendedInfo</a> = <b>value</b>;
        }
 
        <b>private bool</b> <a id="6a6969c3aceb55ae" href="../R/6a6969c3aceb55ae.html" target="n" data-glyph="46,1" class="i field">_serializeExtendedInfo</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private
        <b>private readonly string</b> <a id="59f7c3b1efc13b74" href="../R/59f7c3b1efc13b74.html" target="n" data-glyph="46,1" class="i field">_errorId</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Exposed by ErrorCategoryInfo
        <b>internal</b> <a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <a id="f27b76c7c8455645" href="../R/f27b76c7c8455645.html" target="n" data-glyph="44,1" class="i field">_category</a>;
        <b>internal string</b> <a id="0f4e19dafca43646" href="../R/0f4e19dafca43646.html" target="n" data-glyph="44,1" class="i field">_activityOverride</a>;
        <b>internal string</b> <a id="80971f76030da766" href="../R/80971f76030da766.html" target="n" data-glyph="44,1" class="i field">_reasonOverride</a>;
        <b>internal string</b> <a id="f02d72354a7772ee" href="../R/f02d72354a7772ee.html" target="n" data-glyph="44,1" class="i field">_targetNameOverride</a>;
        <b>internal string</b> <a id="5f7237a7a6013c7d" href="../R/5f7237a7a6013c7d.html" target="n" data-glyph="44,1" class="i field">_targetTypeOverride</a>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Exposed by ErrorCategoryInfo
 
        <b>internal static string</b> <a id="9de5bc146b03ccb1" href="../R/9de5bc146b03ccb1.html" target="n" data-glyph="74,1" class="i method">NotNull</a>(<b>string</b> <span id="r131 rd" class="r131 r">s</span>) =&gt; <span class="r131 r">s</span> ?? <b>string</b>.<span class="i">Empty</span>;
 
        <b>private string</b> <a id="3b1e5e1f28dc8977" href="../R/3b1e5e1f28dc8977.html" target="n" data-glyph="76,1" class="i method">GetInvocationTypeName</a>()
        {
            <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r132 rd" class="r132 r">invocationInfo</span> = <a href="#fe2b46733a081db9" class="k">this</a>.<a href="#fd1ac7b3462d4426" class="i property">InvocationInfo</a>;
            <b>if</b> (<span class="r132 r">invocationInfo</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r133 rd" class="r133 r">commandInfo</span> = <span class="r132 r">invocationInfo</span>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>;
            <b>if</b> (<span class="r133 r">commandInfo</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <a href="CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a> <span id="r134 rd" class="r134 r">scriptInfo</span> = <span class="r133 r">commandInfo</span> <b>as</b> <a href="CommandInfo.cs.html#2ae2bf5bb21a5a53" class="t t">IScriptCommandInfo</a>;
            <b>if</b> (<span class="r134 r">scriptInfo</span> != <b>null</b>)
            {
                <b>return</b> <span class="r133 r">commandInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
            }
 
            <b>if</b> (!(<span class="r133 r">commandInfo</span> <b>is</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r135 rd" class="r135 r">cmdletInfo</span>))
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>return</b> <span class="r135 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a>.<span class="i">FullName</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ToString
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> As </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Object</span>.<span class="i">ToString</span>()<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Developer-readable identifier.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="cab659be098926dd" href="../R/cab659be098926dd.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>if</b> (<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="#589bef4648ccf37a" class="i property">Message</a>))
            {
                <b>return</b> <a href="#4e9df045b6372ce0" class="i property">ErrorDetails</a>.<a href="#589bef4648ccf37a" class="i property">Message</a>;
            }
 
            <b>if</b> (<a href="#2c2498db91e737eb" class="i property">Exception</a> != <b>null</b>)
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">Message</span>))
                {
                    <b>return</b> <a href="#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">Message</span>;
                }
 
                <b>return</b> <a href="#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">ToString</span>();
            }
 
            <b>return</b> <b>base</b>.<span class="i">ToString</span>();
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ToString
 
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Dummy generic class for type inference purposes on typed catch blocks.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r t">TException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Anything that inherits Exception.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="55fed387ba0ef11b" href="../R/55fed387ba0ef11b.html" target="n" data-glyph="2,0" class="t t">ErrorRecord</a>&lt;<span id="r136 rd t" class="r136 r t">TException</span>&gt; : <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <b>where</b> <span class="r136 r t">TException</span> : <span class="i">Exception</span>
    {
        <b>public</b> <b>new</b> <span class="r136 r t">TException</span> <a id="347038940668f916" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Exception</a> { <b>get</b>; }
 
        <b>public</b> <a id="2c096a410c365cc8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ErrorRecord</a>(<span class="i">Exception</span> <span id="r137 rd" class="r137 r">exception</span>, <b>string</b> <span id="r138 rd" class="r138 r">errorId</span>, <a href="#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <span id="r139 rd" class="r139 r">errorCategory</span>, <b>object</b> <span id="r140 rd" class="r140 r">targetObject</span>) : <a href="#e9334565e5136f43" class="k">base</a>(<span class="r137 r">exception</span>, <span class="r138 r">errorId</span>, <span class="r139 r">errorCategory</span>, <span class="r140 r">targetObject</span>)
        {
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implemented by exception classes which contain additional</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> information.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> MSH defines certain exception classes which implement this interface.</span>
    <span class="c">///</span><span class="c"> This includes wrapper exceptions such as</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#7b242746a433b370" class="t t">CmdletInvocationException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> and also MSH engine errors such as</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ExtendedTypeSystemException.cs.html#396f7c7b826437d7" class="t t">GetValueException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> Cmdlets and providers should not define this interface;</span>
    <span class="c">///</span><span class="c"> instead, they should use the</span>
    <span class="c">///</span><span class="c"> WriteError(ErrorRecord) or</span>
    <span class="c">///</span><span class="c"> ThrowTerminatingError(ErrorRecord) methods.</span>
    <span class="c">///</span><span class="c"> The ErrorRecord property will contain an ErrorRecord</span>
    <span class="c">///</span><span class="c"> which contains an instance of</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#0468337cc591c6b2" class="t t">ParentContainsErrorRecordException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> rather than the actual exception.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Do not call WriteError(e.ErrorRecord).</span>
    <span class="c">///</span><span class="c"> The ErrorRecord contained in the ErrorRecord property of</span>
    <span class="c">///</span><span class="c"> an exception which implements IContainsErrorRecord</span>
    <span class="c">///</span><span class="c"> should not be passed directly to WriteError, since it contains</span>
    <span class="c">///</span><span class="c"> a ParentContainsErrorRecordException rather than the real exception.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> It is permitted for PSSnapins to implement custom Exception classes which implement</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2d342e12f9600886" class="t t">IContainsErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> but it is generally preferable for Cmdlets and CmdletProviders to communicate</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#cef340f272a30c6b" class="i property">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> information using</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> or</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a>.<a href="../namespaces/ProviderBase.cs.html#0c753abd524c8d46" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> rather than by throwing an exception which implements</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2d342e12f9600886" class="t t">IContainsErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> Consider implementing</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2d342e12f9600886" class="t t">IContainsErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> in your custom exception only if you throw it from a context</span>
    <span class="c">///</span><span class="c"> where a reference to the active</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> is no longer available.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="2d342e12f9600886" href="../R/2d342e12f9600886.html" target="n" data-glyph="48,0" class="t t">IContainsErrorRecord</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#cef340f272a30c6b" class="i property">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> which provides additional information about the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#cef340f272a30c6b" class="i property">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> instance returned by</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2d342e12f9600886" class="t t">IContainsErrorRecord</a>.<a href="#cef340f272a30c6b" class="i property">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> should contain in its</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="#2c2498db91e737eb" class="i property">Exception</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> property an instance of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#0468337cc591c6b2" class="t t">ParentContainsErrorRecordException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> rather than a reference to the root exception.  This prevents</span>
        <span class="c">///</span><span class="c"> a recursive reference between the exception implementing</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2d342e12f9600886" class="t t">IContainsErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#cef340f272a30c6b" class="i property">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Use the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#cb169e417c53bbd4" class="t constructor">ParentContainsErrorRecordException</a>(<span class="i">Exception</span>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> constructor so that the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#0468337cc591c6b2" class="t t">ParentContainsErrorRecordException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> will have the same</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Exception</span>.<span class="i">Message</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> as the root exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a href="#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="cef340f272a30c6b" href="../R/cef340f272a30c6b.html" target="n" data-glyph="102,1" class="i property">ErrorRecord</a> { <b>get</b>; }
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Objects implementing this interface can be used by</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#0ff662ad5cf950f1" class="t constructor">ErrorDetails</a>(<a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a>,<b>string</b>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> implements this interface.  PSSnapins can implement</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> on their custom classes, but the only purpose would be to permit</span>
    <span class="c">///</span><span class="c"> the custom class to be used in the</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0ff662ad5cf950f1" class="t constructor">ErrorDetails</a>(<a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a>,<b>string</b>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> constructor.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d882fa1d2308673f" class="t t">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> contains special constructor</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0ff662ad5cf950f1" class="t constructor">ErrorDetails</a>(<a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a>,<b>string</b>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> reducing the steps which localizable code generally has to duplicate when it</span>
    <span class="c">///</span><span class="c"> generates a localizable string.  This variant is preferred over</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#908615d662085fc6" class="t constructor">ErrorDetails</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> since the improved</span>
    <span class="c">///</span><span class="c"> information about the error may help enable future scenarios.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="0eedb0202d1641d2" href="../R/0eedb0202d1641d2.html" target="n" data-glyph="48,0" class="t t">IResourceSupplier</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the error message template string corresponding to</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">baseName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">resourceId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the desired behavior is simple string lookup</span>
        <span class="c">///</span><span class="c"> in your assembly, you can use the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ErrorDetails</span>(<span class="i">Assembly</span>,<b>string</b>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> constructor instead and not bother implementing</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Consider implementing </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0eedb0202d1641d2" class="t t">IResourceSupplier</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> if you want more complex behavior.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Insertions will be inserted into the string with</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">String</span>.<span class="i">Format</span>(<span class="i">IFormatProvider</span>,<b>string</b>,<b>object</b>[])<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> to generate the final error message in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d882fa1d2308673f" class="t t">ErrorDetails</a>.<a href="#589bef4648ccf37a" class="i property">Message</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">baseName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The base resource name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">resourceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The resource id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The error message template string corresponding to baseName and resourceId.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>string</b> <a id="24ea4795ac76fb45" href="../R/24ea4795ac76fb45.html" target="n" data-glyph="72,1" class="i method">GetResourceString</a>(<b>string</b> <span id="r141 rd" class="r141 r">baseName</span>, <b>string</b> <span id="r142 rd" class="r142 r">resourceId</span>);
    }
}
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56506
</pre></td></tr></table></div></body></html>
