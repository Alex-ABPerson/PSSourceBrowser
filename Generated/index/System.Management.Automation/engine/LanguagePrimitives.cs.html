<!DOCTYPE html>
<html><head><title>LanguagePrimitives.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(5836);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/LanguagePrimitives.cs" target="_top">engine\LanguagePrimitives.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Data</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>.<span class="i">Expressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Numerics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">Emit</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
<b>using</b> <span class="t">MethodCacheEntry</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="CoreAdapter.cs.html#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
<b>using</b> <span class="i n">System</span>.<span class="i">DirectoryServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> public type converters
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a base class implemented when you need to customize the type conversion for a target class.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> There are two ways of associating the PSTypeConverter with its target class:</span>
    <span class="c">///</span><span class="c">     - Through the type configuration file.</span>
    <span class="c">///</span><span class="c">     - By applying a TypeConverterAttribute to the target class.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Unlike System.ComponentModel.TypeConverter, PSTypeConverter can be applied to a family of types (like all types derived from System.Enum).</span>
    <span class="c">///</span><span class="c"> PSTypeConverter has two main differences from TypeConverter:</span>
    <span class="c">///</span><span class="c">     - It can be applied to a family of types and not only the one type as in TypeConverter. In order to do that</span>
    <span class="c">///</span><span class="c"> ConvertFrom and CanConvertFrom receive destinationType to know to which type specifically we are converting sourceValue.</span>
    <span class="c">///</span><span class="c">     - ConvertTo and ConvertFrom receive formatProvider and ignoreCase.</span>
    <span class="c">///</span><span class="c"> Other differences to System.ComponentModel.TypeConverter:</span>
    <span class="c">///</span><span class="c">     - There is no ITypeDescriptorContext.</span>
    <span class="c">///</span><span class="c">     - This class is abstract</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="89a33fbb336451a1" href="../R/89a33fbb336451a1.html" target="n" data-glyph="0,0" class="t t"><span id="7f683a5a87a4c19d">PSTypeConverter</span></a>
    {
        <b>private static object</b> <a id="5230517265c63651" href="../R/5230517265c63651.html" target="n" data-glyph="76,1" class="i method">GetSourceValueAsObject</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r0 rd" class="r0 r">sourceValue</span>)
        {
            <b>if</b> (<span class="r0 r">sourceValue</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r0 r">sourceValue</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>)
            {
                <b>return</b> <span class="r0 r">sourceValue</span>;
            }
            <b>else</b>
            {
                <b>return</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r0 r">sourceValue</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly *not* of the types supported by this converted to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">One of the types supported by this converter to which the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter should be converted.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, otherwise false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract bool</b> <a id="e1662e14d3b397a8" href="../R/e1662e14d3b397a8.html" target="n" data-glyph="72,1" class="i method">CanConvertFrom</a>(<b>object</b> <span id="r1 rd" class="r1 r">sourceValue</span>, <span class="i">Type</span> <span id="r2 rd" class="r2 r">destinationType</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly *not* of the types supported by this converted to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">One of the types supported by this converter to which the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter should be converted.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, otherwise false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="e539122ff45a9efc" href="../R/e539122ff45a9efc.html" target="n" data-glyph="72,1" class="i method">CanConvertFrom</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r3 rd" class="r3 r">sourceValue</span>, <span class="i">Type</span> <span id="r4 rd" class="r4 r">destinationType</span>)
        {
            <b>return</b> <a href="#89a33fbb336451a1" class="k">this</a>.<a href="#e1662e14d3b397a8" class="i method">CanConvertFrom</a>(<a href="#5230517265c63651" class="i method">GetSourceValueAsObject</a>(<span class="r3 r">sourceValue</span>), <span class="r4 r">destinationType</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly *not* of the types supported by this converted to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">One of the types supported by this converter to which the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter should be converted to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format provider to use like in IFormattable&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidCastException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no conversion was possible.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract object</b> <a id="1d16f6bdc741eeaa" href="../R/1d16f6bdc741eeaa.html" target="n" data-glyph="72,1" class="i method">ConvertFrom</a>(<b>object</b> <span id="r5 rd" class="r5 r">sourceValue</span>, <span class="i">Type</span> <span id="r6 rd" class="r6 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r7 rd" class="r7 r">formatProvider</span>, <b>bool</b> <span id="r8 rd" class="r8 r">ignoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly *not* of the types supported by this converted to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">One of the types supported by this converter to which the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter should be converted to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format provider to use like in IFormattable&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidCastException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no conversion was possible.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual object</b> <a id="08cee750f37adb9f" href="../R/08cee750f37adb9f.html" target="n" data-glyph="72,1" class="i method">ConvertFrom</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r9 rd" class="r9 r">sourceValue</span>, <span class="i">Type</span> <span id="r10 rd" class="r10 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r11 rd" class="r11 r">formatProvider</span>, <b>bool</b> <span id="r12 rd" class="r12 r">ignoreCase</span>)
        {
            <b>return</b> <a href="#89a33fbb336451a1" class="k">this</a>.<a href="#1d16f6bdc741eeaa" class="i method">ConvertFrom</a>(<a href="#5230517265c63651" class="i method">GetSourceValueAsObject</a>(<span class="r9 r">sourceValue</span>), <span class="r10 r">destinationType</span>, <span class="r11 r">formatProvider</span>, <span class="r12 r">ignoreCase</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly from one of the types supported by this converter to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, supposedly not one of the types supported by the converter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, otherwise false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract bool</b> <a id="8fd54171fefec66e" href="../R/8fd54171fefec66e.html" target="n" data-glyph="72,1" class="i method">CanConvertTo</a>(<b>object</b> <span id="r13 rd" class="r13 r">sourceValue</span>, <span class="i">Type</span> <span id="r14 rd" class="r14 r">destinationType</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly from one of the types supported by this converter to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, supposedly not one of the types supported by the converter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, otherwise false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="880f220ee931f65c" href="../R/880f220ee931f65c.html" target="n" data-glyph="72,1" class="i method">CanConvertTo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r15 rd" class="r15 r">sourceValue</span>, <span class="i">Type</span> <span id="r16 rd" class="r16 r">destinationType</span>)
        {
            <b>return</b> <a href="#89a33fbb336451a1" class="k">this</a>.<a href="#8fd54171fefec66e" class="i method">CanConvertTo</a>(<a href="#5230517265c63651" class="i method">GetSourceValueAsObject</a>(<span class="r15 r">sourceValue</span>), <span class="r16 r">destinationType</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly from one of the types supported by this converter to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, supposedly not one of the types supported by the converter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format provider to use like in IFormattable&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">SourceValue converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidCastException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no conversion was possible.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public abstract object</b> <a id="594e01e31d6b6c2c" href="../R/594e01e31d6b6c2c.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>(<b>object</b> <span id="r17 rd" class="r17 r">sourceValue</span>, <span class="i">Type</span> <span id="r18 rd" class="r18 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r19 rd" class="r19 r">formatProvider</span>, <b>bool</b> <span id="r20 rd" class="r20 r">ignoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value supposedly from one of the types supported by this converter to be converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, supposedly not one of the types supported by the converter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format provider to use like in IFormattable&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">SourceValue converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidCastException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no conversion was possible.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public virtual object</b> <a id="a9b4de3a335d5247" href="../R/a9b4de3a335d5247.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r21 rd" class="r21 r">sourceValue</span>, <span class="i">Type</span> <span id="r22 rd" class="r22 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r23 rd" class="r23 r">formatProvider</span>, <b>bool</b> <span id="r24 rd" class="r24 r">ignoreCase</span>)
        {
            <b>return</b> <a href="#89a33fbb336451a1" class="k">this</a>.<a href="#594e01e31d6b6c2c" class="i method">ConvertTo</a>(<a href="#5230517265c63651" class="i method">GetSourceValueAsObject</a>(<span class="r21 r">sourceValue</span>), <span class="r22 r">destinationType</span>, <span class="r23 r">formatProvider</span>, <span class="r24 r">ignoreCase</span>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enables a type that only has conversion from string to be converted from all other</span>
    <span class="c">///</span><span class="c"> types through string.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> It is permitted to subclass </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#583d58364ea0139d" class="t t">ConvertThroughString</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> but there is no established scenario for doing this, nor has it been tested.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>public class</b> <a id="583d58364ea0139d" href="../R/583d58364ea0139d.html" target="n" data-glyph="0,0" class="t t"><span id="a1b5fdefe990463c">ConvertThroughString</span></a> : <a href="#89a33fbb336451a1" class="t t">PSTypeConverter</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This will return false only if sourceValue is string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">False only if sourceValue is string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="bbb3f2c399579613" href="../R/bbb3f2c399579613.html" target="n" data-glyph="72,1" class="i method">CanConvertFrom</a>(<b>object</b> <span id="r25 rd" class="r25 r">sourceValue</span>, <span class="i">Type</span> <span id="r26 rd" class="r26 r">destinationType</span>)
        {
            <span class="c">// This if avoids infinite recursion.</span>
            <b>if</b> (<span class="r25 r">sourceValue</span> <b>is string</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts to destinationType by first converting sourceValue to string</span>
        <span class="c">///</span><span class="c"> and then converting the result to destinationType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type this converter is associated with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The IFormatProvider to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">SourceValue converted to destinationType.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">When no conversion was possible.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="657d6a68655da482" href="../R/657d6a68655da482.html" target="n" data-glyph="72,1" class="i method">ConvertFrom</a>(<b>object</b> <span id="r27 rd" class="r27 r">sourceValue</span>, <span class="i">Type</span> <span id="r28 rd" class="r28 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r29 rd" class="r29 r">formatProvider</span>, <b>bool</b> <span id="r30 rd" class="r30 r">ignoreCase</span>)
        {
            <b>string</b> <span id="r31 rd" class="r31 r">sourceAsString</span> = (<b>string</b>)<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r27 r">sourceValue</span>, <b>typeof</b>(<b>string</b>), <span class="r29 r">formatProvider</span>);
            <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#0c97df7b75910bea" class="i method">ConvertTo</a>(<span class="r31 r">sourceAsString</span>, <span class="r28 r">destinationType</span>, <span class="r29 r">formatProvider</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns false, since this converter is not designed to be used to</span>
        <span class="c">///</span><span class="c"> convert from the type associated with the converted to other types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">False.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="ccc316be27ef635b" href="../R/ccc316be27ef635b.html" target="n" data-glyph="72,1" class="i method">CanConvertTo</a>(<b>object</b> <span id="r32 rd" class="r32 r">sourceValue</span>, <span class="i">Type</span> <span id="r33 rd" class="r33 r">destinationType</span>)
        {
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throws NotSupportedException, since this converter is not designed to be used to</span>
        <span class="c">///</span><span class="c"> convert from the type associated with the converted to other types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The IFormatProvider to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">This method does not return a value.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">NotSupportedException is always thrown.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="2e86ae64d161a308" href="../R/2e86ae64d161a308.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>(<b>object</b> <span id="r34 rd" class="r34 r">sourceValue</span>, <span class="i">Type</span> <span id="r35 rd" class="r35 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r36 rd" class="r36 r">formatProvider</span>, <b>bool</b> <span id="r37 rd" class="r37 r">ignoreCase</span>)
        {
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public type converters
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ranking of versions for comparison purposes (used in overload resolution.)</span>
    <span class="c">///</span><span class="c"> A larger value means the conversion is better.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Note that the lower nibble is all ones for named conversion ranks.  This allows for</span>
    <span class="c">///</span><span class="c"> conversions with rankings in between the named values.  For example, int=&gt;string[]</span>
    <span class="c">///</span><span class="c"> is value dependent, if the conversion from int=&gt;string succeeds, then an array is</span>
    <span class="c">///</span><span class="c"> created, otherwise we try some other conversion.  The int=&gt;string[] conversion should</span>
    <span class="c">///</span><span class="c"> be worse than int=&gt;string, but it is probably better than many other conversions, so</span>
    <span class="c">///</span><span class="c"> we want it to be only slightly worse than int=&gt;string.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> ValueDependent is a flag, but we don&#39;t mark the enum as flags because it really isn&#39;t</span>
    <span class="c">///</span><span class="c"> a flags enum.</span>
    <span class="c">///</span><span class="c"> To make debugging easier, the &quot;in between&quot; conversions are all named, though there are</span>
    <span class="c">///</span><span class="c"> no references in the code.  They all use the suffix S2A which means &quot;scalar to array&quot;.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="7366d8a93041350f" href="../R/7366d8a93041350f.html" target="n" data-glyph="20,0" class="t t"><span id="5e433bade64cf247">ConversionRank</span></a>
    {
        <a id="c8e6b7371e1dec03" href="../R/c8e6b7371e1dec03.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x0000,
        <a id="d745391586c6b2c8" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">UnrelatedArraysS2A</a> = 0x0007,
        <a id="9ae727afff1169c0" href="../R/9ae727afff1169c0.html" target="n" data-glyph="24,1" class="i field">UnrelatedArrays</a> = 0x000F,
        <a id="8a997c5169039adc" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ToStringS2A</a> = 0x0017,
        <a id="2533e8d6de5d8a90" href="../R/2533e8d6de5d8a90.html" target="n" data-glyph="24,1" class="i field">ToString</a> = 0x001F,
        <a id="9613e331a19b3d9b" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">CustomS2A</a> = 0x0027,
        <a id="74c3beb153ee9616" href="../R/74c3beb153ee9616.html" target="n" data-glyph="24,1" class="i field">Custom</a> = 0x002F,
        <a id="13aaa7b7486174e8" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">IConvertibleS2A</a> = 0x0037,
        <a id="6806c359ea616c35" href="../R/6806c359ea616c35.html" target="n" data-glyph="24,1" class="i field">IConvertible</a> = 0x003F,
        <a id="7470fdffa142084b" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ImplicitCastS2A</a> = 0x0047,
        <a id="16af78347d5ada13" href="../R/16af78347d5ada13.html" target="n" data-glyph="24,1" class="i field">ImplicitCast</a> = 0x004F,
        <a id="95db7f8ffc7f3dbf" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ExplicitCastS2A</a> = 0x0057,
        <a id="1ec464ef054dabee" href="../R/1ec464ef054dabee.html" target="n" data-glyph="24,1" class="i field">ExplicitCast</a> = 0x005F,
        <a id="3eed585cbbcd6ac5" href="../R/3eed585cbbcd6ac5.html" target="n" data-glyph="24,1" class="i field">ConstructorS2A</a> = 0x0067,
        <a id="f884ff66af1f97c4" href="../R/f884ff66af1f97c4.html" target="n" data-glyph="24,1" class="i field">Constructor</a> = 0x006F,
        <a id="fcd45ccb39fa69c1" href="../R/fcd45ccb39fa69c1.html" target="n" data-glyph="24,1" class="i field">Create</a> = 0x0073,
        <a id="3fdbd85cbfe5ea17" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ParseS2A</a> = 0x0077,
        <a id="872a928258f53dc3" href="../R/872a928258f53dc3.html" target="n" data-glyph="24,1" class="i field">Parse</a> = 0x007F,
        <a id="7520d1c65b035ad2" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">PSObjectS2A</a> = 0x0087,
        <a id="7ce8a95e771d54af" href="../R/7ce8a95e771d54af.html" target="n" data-glyph="24,1" class="i field">PSObject</a> = 0x008F,
        <a id="8e6dae1ab4c485fe" href="../R/8e6dae1ab4c485fe.html" target="n" data-glyph="24,1" class="i field">LanguageS2A</a> = 0x0097,
        <a id="c4444dad1388a497" href="../R/c4444dad1388a497.html" target="n" data-glyph="24,1" class="i field">Language</a> = 0x009F,
        <a id="ec18e6e3fbcda029" href="../R/ec18e6e3fbcda029.html" target="n" data-glyph="24,1" class="i field">NullToValue</a> = 0x00AF,
        <a id="92e8b910569c4813" href="../R/92e8b910569c4813.html" target="n" data-glyph="24,1" class="i field">NullToRef</a> = 0x00BF,
        <a id="a9b948f5ab077c0d" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">NumericExplicitS2A</a> = 0x00C7,
        <a id="7beaf716047c64c8" href="../R/7beaf716047c64c8.html" target="n" data-glyph="24,1" class="i field">NumericExplicit</a> = 0x00CF,
        <a id="c78e329d5af3ea14" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">NumericExplicit1S2A</a> = 0x00D7,
        <a id="6c6ff0ec53840343" href="../R/6c6ff0ec53840343.html" target="n" data-glyph="24,1" class="i field">NumericExplicit1</a> = 0x00DF,
        <a id="83317da3110d0b03" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">NumericStringS2A</a> = 0x00E7,
        <a id="bcc2ea1096285fba" href="../R/bcc2ea1096285fba.html" target="n" data-glyph="24,1" class="i field">NumericString</a> = 0x00EF,
        <a id="01a2ddaf3750244b" href="../R/01a2ddaf3750244b.html" target="n" data-glyph="24,1" class="i field">NumericImplicitS2A</a> = 0x00F7,
        <a id="2c07b8fc3068341e" href="../R/2c07b8fc3068341e.html" target="n" data-glyph="24,1" class="i field">NumericImplicit</a> = 0x00FF,
        <a id="ea5247ec42277d3c" href="../R/ea5247ec42277d3c.html" target="n" data-glyph="24,1" class="i field">AssignableS2A</a> = 0x0107,
        <a id="6a83ff53b2a840f5" href="../R/6a83ff53b2a840f5.html" target="n" data-glyph="24,1" class="i field">Assignable</a> = 0x010F,
        <a id="9fdd0ce247584f0d" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">IdentityS2A</a> = 0x0117,
        <a id="51b3b36a7d4ddc29" href="../R/51b3b36a7d4ddc29.html" target="n" data-glyph="24,1" class="i field">StringToCharArray</a> = 0x011A,
        <a id="0c841bf014a77138" href="../R/0c841bf014a77138.html" target="n" data-glyph="24,1" class="i field">Identity</a> = 0x011F,
 
        <a id="1a3507a3a3df9a9d" href="../R/1a3507a3a3df9a9d.html" target="n" data-glyph="24,1" class="i field">ValueDependent</a> = 0xFFF7,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines language support methods.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Maintainability&quot;</span>, <span class="s">&quot;CA1506:AvoidExcessiveClassCoupling&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Refactoring LanguagePrimitives takes lot of dev/test effort. Since V1 code is already shipped, we tend to exclude this message.&quot;</span>)]
    <b>public static class</b> <a id="6dac09d64da9900c" href="../R/6dac09d64da9900c.html" target="n" data-glyph="0,0" class="t t">LanguagePrimitives</a>
    {
        [<span class="i">TraceSource</span>(<span class="s">&quot;ETS&quot;</span>, <span class="s">&quot;Extended Type System&quot;</span>)]
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="54018625801279e1" href="../R/54018625801279e1.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;ETS&quot;</span>, <span class="s">&quot;Extended Type System&quot;</span>);
 
        <b>internal delegate void</b> <a id="21598b5c2e54fc8d" href="../R/21598b5c2e54fc8d.html" target="n" data-glyph="14,1" class="t t"><span id="f20f32f0e7f1a712">MemberNotFoundError</span></a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r38 rd" class="r38 r">pso</span>, <span class="i">DictionaryEntry</span> <span id="r39 rd" class="r39 r">property</span>, <span class="i">Type</span> <span id="r40 rd" class="r40 r">resultType</span>);
 
        <b>internal delegate void</b> <a id="7c91f72dbdf7ca36" href="../R/7c91f72dbdf7ca36.html" target="n" data-glyph="14,1" class="t t"><span id="6b16216f4adb09e2">MemberSetValueError</span></a>(<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a> <span id="r41 rd" class="r41 r">e</span>);
 
        <b>internal const string</b> <a id="09ceaaf5116a37fd" href="../R/09ceaaf5116a37fd.html" target="n" data-glyph="8,1" class="i field">OrderedAttribute</a> = <span class="s">&quot;ordered&quot;</span>;
        <b>internal const string</b> <a id="e55dc96379386f6c" href="../R/e55dc96379386f6c.html" target="n" data-glyph="8,1" class="i field">DoublePrecision</a> = <span class="s">&quot;G15&quot;</span>;
        <b>internal const string</b> <a id="69af0728ca460fee" href="../R/69af0728ca460fee.html" target="n" data-glyph="8,1" class="i field">SinglePrecision</a> = <span class="s">&quot;G7&quot;</span>;
 
        <b>internal static void</b> <a id="de88274d889b52c9" href="../R/de88274d889b52c9.html" target="n" data-glyph="74,1" class="i method">CreateMemberNotFoundError</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r42 rd" class="r42 r">pso</span>, <span class="i">DictionaryEntry</span> <span id="r43 rd" class="r43 r">property</span>, <span class="i">Type</span> <span id="r44 rd" class="r44 r">resultType</span>)
        {
            <b>string</b> <span id="r45 rd" class="r45 r">availableProperties</span> = <a href="#ddf4994d76f0a81e" class="i method">GetAvailableProperties</a>(<span class="r42 r">pso</span>);
 
            <b>string</b> <span id="r46 rd" class="r46 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">PropertyNotFound</span>, <span class="r43 r">property</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <span class="r44 r">resultType</span>.<span class="i">FullName</span>, <span class="r45 r">availableProperties</span>);
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Issuing an error message about not being able to create an object from hashtable.&quot;</span>);
            <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r46 r">message</span>);
        }
 
        <b>internal static void</b> <a id="a55e2124628e33f1" href="../R/a55e2124628e33f1.html" target="n" data-glyph="74,1" class="i method">CreateMemberSetValueError</a>(<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a> <span id="r47 rd" class="r47 r">e</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Issuing an error message about not being able to set the properties for an object.&quot;</span>);
            <b>throw</b> <span class="r47 r">e</span>;
        }
 
        <b>static</b> <a id="32f582b1195fa3da" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">LanguagePrimitives</a>()
        {
            <a href="#1992af74786afb21" class="i method">RebuildConversionCache</a>();
            <a href="#6df047365aeda436" class="i method">InitializeGetEnumerableCache</a>();
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span> <span class="c">// AppDomain Not In CoreCLR</span>
<span class="e">            AppDomain.CurrentDomain.AssemblyResolve += AssemblyResolveHelper;
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <b>internal static void</b> <a id="ca1c3c0d5ce72a35" href="../R/ca1c3c0d5ce72a35.html" target="n" data-glyph="74,1" class="i method">UpdateTypeConvertFromTypeTable</a>(<b>string</b> <span id="r48 rd" class="r48 r">typeName</span>)
        {
            <b>lock</b> (<a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>)
            {
                <b>foreach</b> (<b>var</b> <span id="r49 rd" class="r49 r">key</span> <b>in</b> <a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>.<span class="i">Keys</span>)
                {
                    <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r49 r">key</span>.<span class="i">to</span>.<span class="i">FullName</span>, <span class="r48 r">typeName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                        || <b>string</b>.<span class="i">Equals</span>(<span class="r49 r">key</span>.<span class="i">from</span>.<span class="i">FullName</span>, <span class="r48 r">typeName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>.<span class="i">Remove</span>(<span class="r49 r">key</span>);
                    }
                }
 
                <span class="c">// Note we do not clear possibleTypeConverter even when removing.</span>
                <span class="c">//</span>
                <span class="c">// The conversion cache and the possibleTypeConverter cache are process wide, but</span>
                <span class="c">// the type table used for any specific conversion is runspace specific.</span>
                <a href="#5149b15c031a9605" class="i field">s_possibleTypeConverter</a>[<span class="r48 r">typeName</span>] = <b>true</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> GetEnumerable/GetEnumerator
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is a wrapper class that allows us to use the generic IEnumerable</span>
        <span class="c">///</span><span class="c"> implementation of an object when we can&#39;t use it&#39;s non-generic</span>
        <span class="c">///</span><span class="c"> implementation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="a9206e02cbe7e5eb" href="../R/a9206e02cbe7e5eb.html" target="n" data-glyph="4,1" class="t t">EnumerableTWrapper</a> : <span class="i">IEnumerable</span>
        {
            <b>private readonly object</b> <a id="ddee1b5a04d8b12c" href="../R/ddee1b5a04d8b12c.html" target="n" data-glyph="46,2" class="i field">_enumerable</a>;
            <b>private readonly</b> <span class="i">Type</span> <a id="f61be842b14bab08" href="../R/f61be842b14bab08.html" target="n" data-glyph="46,2" class="i field">_enumerableType</a>;
            <b>private</b> <span class="i">DynamicMethod</span> <a id="36e91671cd56f4f5" href="../R/36e91671cd56f4f5.html" target="n" data-glyph="46,2" class="i field">_getEnumerator</a>;
 
            <b>internal</b> <a id="e4ee459dc1e4f552" href="../R/e4ee459dc1e4f552.html" target="n" data-glyph="74,2" class="t constructor">EnumerableTWrapper</a>(<b>object</b> <span id="r50 rd" class="r50 r">enumerable</span>, <span class="i">Type</span> <span id="r51 rd" class="r51 r">enumerableType</span>)
            {
                <a href="#ddee1b5a04d8b12c" class="i field">_enumerable</a> = <span class="r50 r">enumerable</span>;
                <a href="#f61be842b14bab08" class="i field">_enumerableType</a> = <span class="r51 r">enumerableType</span>;
                <a href="#b42ed4e04586e710" class="i method">CreateGetEnumerator</a>();
            }
 
            <b>private void</b> <a id="b42ed4e04586e710" href="../R/b42ed4e04586e710.html" target="n" data-glyph="76,2" class="i method">CreateGetEnumerator</a>()
            {
                <a href="#36e91671cd56f4f5" class="i field">_getEnumerator</a> = <b>new</b> <span class="i">DynamicMethod</span>(<span class="s">&quot;GetEnumerator&quot;</span>, <b>typeof</b>(<b>object</b>),
                    <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>object</b>) }, <b>typeof</b>(<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>).<span class="i">Module</span>, <b>true</b>);
 
                <span class="i">ILGenerator</span> <span id="r52 rd" class="r52 r">emitter</span> = <a href="#36e91671cd56f4f5" class="i field">_getEnumerator</a>.<span class="i">GetILGenerator</span>();
 
                <span class="r52 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ldarg_0</span>);
                <span class="r52 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Castclass</span>, <a href="#f61be842b14bab08" class="i field">_enumerableType</a>);
                <span class="i">MethodInfo</span> <span id="r53 rd" class="r53 r">methodInfo</span> = <a href="#f61be842b14bab08" class="i field">_enumerableType</a>.<span class="i">GetMethod</span>(<span class="s">&quot;GetEnumerator&quot;</span>, <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">Type</span>&gt;());
                <span class="r52 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Callvirt</span>, <span class="r53 r">methodInfo</span>);
                <span class="r52 r">emitter</span>.<span class="i">Emit</span>(<span class="i">OpCodes</span>.<span class="i">Ret</span>);
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerable Members
 
            <b>public</b> <span class="i">IEnumerator</span> <a id="ae2e3b61bf73d9ee" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">GetEnumerator</a>()
            {
                <b>return</b> (<span class="i">IEnumerator</span>)<a href="#36e91671cd56f4f5" class="i field">_getEnumerator</a>.<span class="i">Invoke</span>(<b>null</b>, <b>new</b> <b>object</b>[] { <a href="#ddee1b5a04d8b12c" class="i field">_enumerable</a> });
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        }
 
        <b>private static</b> <span class="i">IEnumerable</span> <a id="7dd47de795beab69" href="../R/7dd47de795beab69.html" target="n" data-glyph="76,1" class="i method">GetEnumerableFromIEnumerableT</a>(<b>object</b> <span id="r54 rd" class="r54 r">obj</span>)
        {
            <b>foreach</b> (<span class="i">Type</span> <span id="r55 rd" class="r55 r">i</span> <b>in</b> <span class="r54 r">obj</span>.<span class="i">GetType</span>().<span class="i">GetInterfaces</span>())
            {
                <b>if</b> (<span class="r55 r">i</span>.<span class="i">IsGenericType</span> &amp;&amp; <span class="r55 r">i</span>.<span class="i">GetGenericTypeDefinition</span>() == <b>typeof</b>(<span class="i">IEnumerable</span>&lt;&gt;))
                {
                    <b>return</b> <b>new</b> <a href="#e4ee459dc1e4f552" class="t constructor">EnumerableTWrapper</a>(<span class="r54 r">obj</span>, <span class="r55 r">i</span>);
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private delegate</b> <span class="i">IEnumerable</span> <a id="cecaa69549a42462" href="../R/cecaa69549a42462.html" target="n" data-glyph="16,1" class="t t"><span id="ba41463ac4d295b6">GetEnumerableDelegate</span></a>(<b>object</b> <span id="r56 rd" class="r56 r">obj</span>);
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#cecaa69549a42462" class="t t">GetEnumerableDelegate</a>&gt; <a id="e52a53530d728969" href="../R/e52a53530d728969.html" target="n" data-glyph="46,1" class="i field">s_getEnumerableCache</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#cecaa69549a42462" class="t t">GetEnumerableDelegate</a>&gt;(32);
 
        <b>private static</b> <a href="#cecaa69549a42462" class="t t">GetEnumerableDelegate</a> <a id="ecfd6e7d99722124" href="../R/ecfd6e7d99722124.html" target="n" data-glyph="76,1" class="i method">GetOrCalculateEnumerable</a>(<span class="i">Type</span> <span id="r57 rd" class="r57 r">type</span>)
        {
            <a href="#cecaa69549a42462" class="t t">GetEnumerableDelegate</a> <span id="r58 rd" class="r58 r">getEnumerable</span> = <b>null</b>;
            <b>lock</b> (<a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>)
            {
                <b>if</b> (!<a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>.<span class="i">TryGetValue</span>(<span class="r57 r">type</span>, <b>out</b> <span class="r58 r">getEnumerable</span>))
                {
                    <span class="r58 r">getEnumerable</span> = <a href="#978172db8dae27dc" class="i method">CalculateGetEnumerable</a>(<span class="r57 r">type</span>);
                    <a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>.<span class="i">Add</span>(<span class="r57 r">type</span>, <span class="r58 r">getEnumerable</span>);
                }
            }
 
            <b>return</b> <span class="r58 r">getEnumerable</span>;
        }
 
        <b>private static void</b> <a id="6df047365aeda436" href="../R/6df047365aeda436.html" target="n" data-glyph="76,1" class="i method">InitializeGetEnumerableCache</a>()
        {
            <b>lock</b> (<a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>)
            {
                <span class="c">// PowerShell doesn&#39;t treat strings as enumerables so just return null.</span>
                <span class="c">// we also want to return null on common numeric types very quickly</span>
                <a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>.<span class="i">Clear</span>();
                <a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>.<span class="i">Add</span>(<b>typeof</b>(<b>string</b>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ReturnNullEnumerable</span>);
                <a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>.<span class="i">Add</span>(<b>typeof</b>(<b>int</b>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ReturnNullEnumerable</span>);
                <a href="#e52a53530d728969" class="i field">s_getEnumerableCache</a>.<span class="i">Add</span>(<b>typeof</b>(<b>double</b>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ReturnNullEnumerable</span>);
            }
        }
 
        <b>internal static bool</b> <a id="db0cc286e8430367" href="../R/db0cc286e8430367.html" target="n" data-glyph="74,1" class="i method">IsTypeEnumerable</a>(<span class="i">Type</span> <span id="r59 rd" class="r59 r">type</span>)
        {
            <b>if</b> (<span class="r59 r">type</span> == <b>null</b>) { <b>return</b> <b>false</b>; }
 
            <a href="#cecaa69549a42462" class="t t">GetEnumerableDelegate</a> <span id="r60 rd" class="r60 r">getEnumerable</span> = <a href="#ecfd6e7d99722124" class="i method">GetOrCalculateEnumerable</a>(<span class="r59 r">type</span>);
            <b>return</b> (<span class="r60 r">getEnumerable</span> != <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4154f2dab1500f16" class="i method">ReturnNullEnumerable</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns True if the language considers obj to be IEnumerable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IEnumerable or IEnumerable-like object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1720:IdentifiersShouldNotContainTypeNames&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;obj&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Since V1 code is already shipped, excluding this message.&quot;</span>)]
        <b>public static bool</b> <a id="d8b2ebf611d896cb" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsObjectEnumerable</a>(<b>object</b> <span id="r61 rd" class="r61 r">obj</span>)
        {
            <b>return</b> <span class="i">IsTypeEnumerable</span>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r61 r">obj</span>)?.<span class="i">GetType</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the IEnumerable of obj or null if the language does not consider obj to be IEnumerable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IEnumerable or IEnumerable-like object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1720:IdentifiersShouldNotContainTypeNames&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;obj&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Since V1 code is already shipped, excluding this message.&quot;</span>)]
        <b>public static</b> <span class="i">IEnumerable</span> <a id="5489692986d47497" href="../R/5489692986d47497.html" target="n" data-glyph="72,1" class="i method">GetEnumerable</a>(<b>object</b> <span id="r62 rd" class="r62 r">obj</span>)
        {
            <span class="r62 r">obj</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r62 r">obj</span>);
            <b>if</b> (<span class="r62 r">obj</span> == <b>null</b>) { <b>return</b> <b>null</b>; }
 
            <a href="#cecaa69549a42462" class="t t">GetEnumerableDelegate</a> <span id="r63 rd" class="r63 r">getEnumerable</span> = <span class="i">GetOrCalculateEnumerable</span>(<span class="r62 r">obj</span>.<span class="i">GetType</span>());
            <b>return</b> <span class="r63 r">getEnumerable</span>(<span class="r62 r">obj</span>);
        }
 
        <b>private static</b> <span class="i">IEnumerable</span> <a id="4154f2dab1500f16" href="../R/4154f2dab1500f16.html" target="n" data-glyph="76,1" class="i method">ReturnNullEnumerable</a>(<b>object</b> <span id="r64 rd" class="r64 r">obj</span>)
        {
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <span class="i">IEnumerable</span> <a id="82427dc2d19ed629" href="../R/82427dc2d19ed629.html" target="n" data-glyph="76,1" class="i method">DataTableEnumerable</a>(<b>object</b> <span id="r65 rd" class="r65 r">obj</span>)
        {
            <b>return</b> (((<span class="i">DataTable</span>)<span class="r65 r">obj</span>).<span class="i">Rows</span>);
        }
 
        <b>private static</b> <span class="i">IEnumerable</span> <a id="81942cfb40e871e0" href="../R/81942cfb40e871e0.html" target="n" data-glyph="76,1" class="i method">TypicalEnumerable</a>(<b>object</b> <span id="r66 rd" class="r66 r">obj</span>)
        {
            <span class="i">IEnumerable</span> <span id="r67 rd" class="r67 r">e</span> = (<span class="i">IEnumerable</span>)<span class="r66 r">obj</span>;
            <b>try</b>
            {
                <span class="c">// Some IEnumerable implementations just return null.  Others</span>
                <span class="c">// raise an exception.  Either of these may have a perfectly</span>
                <span class="c">// good generic implementation, so we&#39;ll try those if the</span>
                <span class="c">// non-generic is no good.</span>
                <b>if</b> (<span class="r67 r">e</span>.<span class="i">GetEnumerator</span>() == <b>null</b>)
                {
                    <b>return</b> <a href="#7dd47de795beab69" class="i method">GetEnumerableFromIEnumerableT</a>(<span class="r66 r">obj</span>);
                }
 
                <b>return</b> <span class="r67 r">e</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r68 rd" class="r68 r">innerException</span>)
            {
                <span class="r67 r">e</span> = <a href="#7dd47de795beab69" class="i method">GetEnumerableFromIEnumerableT</a>(<span class="r66 r">obj</span>);
                <b>if</b> (<span class="r67 r">e</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r67 r">e</span>;
                }
 
                <b>throw</b> <b>new</b> <span class="t">ExtendedTypeSystemException</span>(
                    <span class="s">&quot;ExceptionInGetEnumerator&quot;</span>,
                    <span class="r68 r">innerException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">EnumerationException</span>,
                    <span class="r68 r">innerException</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <a href="#cecaa69549a42462" class="t t">GetEnumerableDelegate</a> <a id="978172db8dae27dc" href="../R/978172db8dae27dc.html" target="n" data-glyph="76,1" class="i method">CalculateGetEnumerable</a>(<span class="i">Type</span> <span id="r69 rd" class="r69 r">objectType</span>)
        {
            <b>if</b> (<b>typeof</b>(<span class="i">DataTable</span>).<span class="i">IsAssignableFrom</span>(<span class="r69 r">objectType</span>))
            {
                <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#82427dc2d19ed629" class="i method">DataTableEnumerable</a>;
            }
 
            <span class="c">// Don&#39;t treat IDictionary or XmlNode as enumerable...</span>
            <b>if</b> (<b>typeof</b>(<span class="i">IEnumerable</span>).<span class="i">IsAssignableFrom</span>(<span class="r69 r">objectType</span>)
                &amp;&amp; !<b>typeof</b>(<span class="i">IDictionary</span>).<span class="i">IsAssignableFrom</span>(<span class="r69 r">objectType</span>)
                &amp;&amp; !<b>typeof</b>(<span class="i">XmlNode</span>).<span class="i">IsAssignableFrom</span>(<span class="r69 r">objectType</span>))
            {
                <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#81942cfb40e871e0" class="i method">TypicalEnumerable</a>;
            }
 
            <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4154f2dab1500f16" class="i method">ReturnNullEnumerable</a>;
        }
 
        <b>private static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <span class="i">IEnumerator</span>&gt;&gt; <a id="ae4d897e93aca0e3" href="../R/ae4d897e93aca0e3.html" target="n" data-glyph="46,1" class="i field">s_getEnumeratorSite</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <span class="i">IEnumerator</span>&gt;&gt;.<span class="i">Create</span>(<a href="runtime/Binding/Binders.cs.html#e3fd1907f899e2b7" class="t t">PSEnumerableBinder</a>.<a href="runtime/Binding/Binders.cs.html#5b720d77314adf15" class="i method">Get</a>());
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the IEnumerator of obj or null if the language does not consider obj as capable of returning an IEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IEnumerable or IEnumerable-like object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">When the act of getting the enumerator throws an exception.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1720:IdentifiersShouldNotContainTypeNames&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;obj&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Since V1 code is already shipped, excluding this message for backward compatibility reasons.&quot;</span>)]
        <b>public static</b> <span class="i">IEnumerator</span> <a id="837b38179d9ca088" href="../R/837b38179d9ca088.html" target="n" data-glyph="72,1" class="i method">GetEnumerator</a>(<b>object</b> <span id="r70 rd" class="r70 r">obj</span>)
        {
            <b>var</b> <span id="r71 rd" class="r71 r">result</span> = <a href="#ae4d897e93aca0e3" class="i field">s_getEnumeratorSite</a>.<span class="i">Target</span>.<span class="i">Invoke</span>(<a href="#ae4d897e93aca0e3" class="i field">s_getEnumeratorSite</a>, <span class="r70 r">obj</span>);
            <b>return</b> (<span class="r71 r">result</span> <b>is</b> <a href="runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<a href="runtime/Operations/MiscOps.cs.html#906468b10c209579" class="t t">NonEnumerableObjectEnumerator</a>) ? <b>null</b> : <span class="r71 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> GetEnumerable/GetEnumerator
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method takes a an arbitrary object and wraps it in a PSDataCollection of PSObject.</span>
        <span class="c">///</span><span class="c"> This simplifies interacting with the PowerShell workflow activities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">inputValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="d725e0c0cd364fb7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetPSDataCollection</a>(<b>object</b> <span id="r72 rd" class="r72 r">inputValue</span>)
        {
            <a href="hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r73 rd" class="r73 r">result</span> = <b>new</b> <a href="hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
            <b>if</b> (<span class="r72 r">inputValue</span> != <b>null</b>)
            {
                <span class="i">IEnumerator</span> <span id="r74 rd" class="r74 r">e</span> = <a href="#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r72 r">inputValue</span>);
                <b>if</b> (<span class="r74 r">e</span> != <b>null</b>)
                {
                    <b>while</b> (<span class="r74 r">e</span>.<span class="i">MoveNext</span>())
                    {
                        <span class="r73 r">result</span>.<span class="i">Add</span>(<span class="r74 r">e</span>.<span class="i">Current</span> == <b>null</b> ? <b>null</b> : <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r74 r">e</span>.<span class="i">Current</span>));
                    }
                }
                <b>else</b>
                {
                    <span class="r73 r">result</span>.<a href="hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r72 r">inputValue</span>));
                }
            }
 
            <span class="r73 r">result</span>.<a href="hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>();
            <b>return</b> <span class="r73 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to compare two objects for equality converting the second to the type of the first, if required.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to compare first to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if first is equal to the second.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <b>new</b> <b>bool</b> <a id="c17cb1e7f80c49b3" href="../R/c17cb1e7f80c49b3.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r75 rd" class="r75 r">first</span>, <b>object</b> <span id="r76 rd" class="r76 r">second</span>)
        {
            <b>return</b> <span class="i">Equals</span>(<span class="r75 r">first</span>, <span class="r76 r">second</span>, <b>false</b>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to compare two objects for equality converting the second to the type of the first, if required.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to compare first to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">used only if first and second are strings</span>
        <span class="c">///</span><span class="c"> to specify the type of string comparison </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if first is equal to the second.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="9f000ef93d79cb2c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r77 rd" class="r77 r">first</span>, <b>object</b> <span id="r78 rd" class="r78 r">second</span>, <b>bool</b> <span id="r79 rd" class="r79 r">ignoreCase</span>)
        {
            <b>return</b> <span class="i">Equals</span>(<span class="r77 r">first</span>, <span class="r78 r">second</span>, <span class="r79 r">ignoreCase</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to compare two objects for equality converting the second to the type of the first, if required.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to compare first to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">used only if first and second are strings</span>
        <span class="c">///</span><span class="c"> to specify the type of string comparison </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">the format/culture to be used. If this parameter is null,</span>
        <span class="c">///</span><span class="c"> CultureInfo.InvariantCulture will be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if first is equal to the second.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="29d97a38e72febf9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r80 rd" class="r80 r">first</span>, <b>object</b> <span id="r81 rd" class="r81 r">second</span>, <b>bool</b> <span id="r82 rd" class="r82 r">ignoreCase</span>, <span class="i">IFormatProvider</span> <span id="r83 rd" class="r83 r">formatProvider</span>)
        {
            <span class="c">// If both first and second are null it returns true.</span>
            <span class="c">// If one is null and the other is not it returns false.</span>
            <span class="c">// if (first.Equals(second)) it returns true otherwise it goes ahead with type conversion operations.</span>
            <span class="c">// If both first and second are strings it returns (string.Compare(firstString, secondString, ignoreCase) == 0).</span>
            <span class="c">// If second can be converted to the type of the first, it does so and returns first.Equals(secondConverted)</span>
            <span class="c">// Otherwise false is returned</span>
 
            <b>if</b> (<span class="r83 r">formatProvider</span> == <b>null</b>)
            {
                <span class="r83 r">formatProvider</span> = <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>;
            }
 
            <b>if</b> (!(<span class="r83 r">formatProvider</span> <b>is</b> <span class="i">CultureInfo</span> <span id="r84 rd" class="r84 r">culture</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r83 r">formatProvider</span>));
            }
 
            <span class="r80 r">first</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r80 r">first</span>);
            <span class="r81 r">second</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r81 r">second</span>);
 
            <b>if</b> (<span class="r80 r">first</span> == <b>null</b>)
            {
                <b>return</b> <span class="r81 r">second</span> == <b>null</b>;
            }
 
            <b>if</b> (<span class="r81 r">second</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>; <span class="c">// first is not null</span>
            }
 
            <b>string</b> <span id="r85 rd" class="r85 r">firstString</span> = <span class="r80 r">first</span> <b>as string</b>;
            <b>string</b> <span id="r86 rd" class="r86 r">secondString</span>;
            <b>if</b> (<span class="r85 r">firstString</span> != <b>null</b>)
            {
                <span class="r86 r">secondString</span> = <span class="r81 r">second</span> <b>as string</b> ?? (<b>string</b>)<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r81 r">second</span>, <b>typeof</b>(<b>string</b>), <span class="r84 r">culture</span>);
                <b>return</b> (<span class="r84 r">culture</span>.<span class="i">CompareInfo</span>.<span class="i">Compare</span>(<span class="r85 r">firstString</span>, <span class="r86 r">secondString</span>,
                                                    <span class="r82 r">ignoreCase</span> ? <span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span> : <span class="i">CompareOptions</span>.<span class="i">None</span>) == 0);
            }
 
            <b>if</b> (<span class="r80 r">first</span>.<span class="i">Equals</span>(<span class="r81 r">second</span>)) <b>return</b> <b>true</b>;
 
            <span class="i">Type</span> <span id="r87 rd" class="r87 r">firstType</span> = <span class="r80 r">first</span>.<span class="i">GetType</span>();
            <span class="i">Type</span> <span id="r88 rd" class="r88 r">secondType</span> = <span class="r81 r">second</span>.<span class="i">GetType</span>();
            <b>int</b> <span id="r89 rd" class="r89 r">firstIndex</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#26600f97d164dd50" class="i method">TypeTableIndex</a>(<span class="r87 r">firstType</span>);
            <b>int</b> <span id="r90 rd" class="r90 r">secondIndex</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#26600f97d164dd50" class="i method">TypeTableIndex</a>(<span class="r88 r">secondType</span>);
            <b>if</b> ((<span class="r89 r">firstIndex</span> != -1) &amp;&amp; (<span class="r90 r">secondIndex</span> != -1))
            {
                <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#841811f9982f5aac" class="i method">NumericCompare</a>(<span class="r80 r">first</span>, <span class="r81 r">second</span>, <span class="r89 r">firstIndex</span>, <span class="r90 r">secondIndex</span>) == 0;
            }
 
            <b>if</b> (<span class="r87 r">firstType</span> == <b>typeof</b>(<b>char</b>) &amp;&amp; <span class="r82 r">ignoreCase</span>)
            {
                <span class="r86 r">secondString</span> = <span class="r81 r">second</span> <b>as string</b>;
                <b>if</b> (<span class="r86 r">secondString</span> != <b>null</b> &amp;&amp; <span class="r86 r">secondString</span>.<span class="i">Length</span> == 1)
                {
                    <b>char</b> <span id="r91 rd" class="r91 r">firstAsUpper</span> = <span class="r84 r">culture</span>.<span class="i">TextInfo</span>.<span class="i">ToUpper</span>((<b>char</b>)<span class="r80 r">first</span>);
                    <b>char</b> <span id="r92 rd" class="r92 r">secondAsUpper</span> = <span class="r84 r">culture</span>.<span class="i">TextInfo</span>.<span class="i">ToUpper</span>(<span class="r86 r">secondString</span>[0]);
                    <b>return</b> <span class="r91 r">firstAsUpper</span>.<span class="i">Equals</span>(<span class="r92 r">secondAsUpper</span>);
                }
                <b>else</b> <b>if</b> (<span class="r88 r">secondType</span> == <b>typeof</b>(<b>char</b>))
                {
                    <b>char</b> <span id="r93 rd" class="r93 r">firstAsUpper</span> = <span class="r84 r">culture</span>.<span class="i">TextInfo</span>.<span class="i">ToUpper</span>((<b>char</b>)<span class="r80 r">first</span>);
                    <b>char</b> <span id="r94 rd" class="r94 r">secondAsUpper</span> = <span class="r84 r">culture</span>.<span class="i">TextInfo</span>.<span class="i">ToUpper</span>((<b>char</b>)<span class="r81 r">second</span>);
                    <b>return</b> <span class="r93 r">firstAsUpper</span>.<span class="i">Equals</span>(<span class="r94 r">secondAsUpper</span>);
                }
            }
 
            <b>try</b>
            {
                <b>object</b> <span id="r95 rd" class="r95 r">secondConverted</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r81 r">second</span>, <span class="r87 r">firstType</span>, <span class="r84 r">culture</span>);
                <b>return</b> <span class="r80 r">first</span>.<span class="i">Equals</span>(<span class="r95 r">secondConverted</span>);
            }
            <b>catch</b> (<span class="i">InvalidCastException</span>)
            {
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method for [Try]Compare to determine object ordering with null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The numeric value to compare to null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">numberIsRightHandSide</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the number to compare is on the right hand side if the comparison.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="c2cc000b3cca7c09" href="../R/c2cc000b3cca7c09.html" target="n" data-glyph="76,1" class="i method">CompareObjectToNull</a>(<b>object</b> <span id="r96 rd" class="r96 r">value</span>, <b>bool</b> <span id="r97 rd" class="r97 r">numberIsRightHandSide</span>)
        {
            <b>var</b> <span id="r98 rd" class="r98 r">i</span> = <span class="r97 r">numberIsRightHandSide</span> ? -1 : 1;
 
            <span class="c">// If it&#39;s a positive number, including 0, it&#39;s greater than null</span>
            <span class="c">// for everything else it&#39;s less than zero...</span>
            <b>switch</b> (<span class="r96 r">value</span>)
            {
                <b>case</b> <span class="i">Int16</span> <span id="r99 rd" class="r99 r">i16</span>: <b>return</b> <span class="i">Math</span>.<span class="i">Sign</span>(<span class="r99 r">i16</span>) &lt; 0 ? -<span class="r98 r">i</span> : <span class="r98 r">i</span>;
                <b>case</b> <span class="i">Int32</span> <span id="r100 rd" class="r100 r">i32</span>: <b>return</b> <span class="i">Math</span>.<span class="i">Sign</span>(<span class="r100 r">i32</span>) &lt; 0 ? -<span class="r98 r">i</span> : <span class="r98 r">i</span>;
                <b>case</b> <span class="i">Int64</span> <span id="r101 rd" class="r101 r">i64</span>: <b>return</b> <span class="i">Math</span>.<span class="i">Sign</span>(<span class="r101 r">i64</span>) &lt; 0 ? -<span class="r98 r">i</span> : <span class="r98 r">i</span>;
                <b>case</b> <b>sbyte</b> <span id="r102 rd" class="r102 r">sby</span>: <b>return</b> <span class="i">Math</span>.<span class="i">Sign</span>(<span class="r102 r">sby</span>) &lt; 0 ? -<span class="r98 r">i</span> : <span class="r98 r">i</span>;
                <b>case</b> <b>float</b> <span id="r103 rd" class="r103 r">f</span>: <b>return</b> <span class="i">Math</span>.<span class="i">Sign</span>(<span class="r103 r">f</span>) &lt; 0 ? -<span class="r98 r">i</span> : <span class="r98 r">i</span>;
                <b>case</b> <b>double</b> <span id="r104 rd" class="r104 r">d</span>: <b>return</b> <span class="i">Math</span>.<span class="i">Sign</span>(<span class="r104 r">d</span>) &lt; 0 ? -<span class="r98 r">i</span> : <span class="r98 r">i</span>;
                <b>case</b> <b>decimal</b> <span id="r105 rd" class="r105 r">de</span>: <b>return</b> <span class="i">Math</span>.<span class="i">Sign</span>(<span class="r105 r">de</span>) &lt; 0 ? -<span class="r98 r">i</span> : <span class="r98 r">i</span>;
                <b>default</b>: <b>return</b> <span class="r98 r">i</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compare first and second, converting second to the</span>
        <span class="c">///</span><span class="c"> type of the first, if necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Second comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Less than zero if first is smaller than second, more than</span>
        <span class="c">///</span><span class="c"> zero if it is greater or zero if they are the same.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">first</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> does not implement IComparable or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">second</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> cannot be converted</span>
        <span class="c">///</span><span class="c"> to the type of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">first</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static int</b> <a id="2bb5d0a887cf373d" href="../R/2bb5d0a887cf373d.html" target="n" data-glyph="72,1" class="i method">Compare</a>(<b>object</b> <span id="r106 rd" class="r106 r">first</span>, <b>object</b> <span id="r107 rd" class="r107 r">second</span>)
        {
            <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">Compare</span>(<span class="r106 r">first</span>, <span class="r107 r">second</span>, <b>false</b>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compare first and second, converting second to the</span>
        <span class="c">///</span><span class="c"> type of the first, if necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Second comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used if both values are strings.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Less than zero if first is smaller than second, more than</span>
        <span class="c">///</span><span class="c"> zero if it is greater or zero if they are the same.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">first</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> does not implement IComparable or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">second</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> cannot be converted</span>
        <span class="c">///</span><span class="c"> to the type of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">first</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static int</b> <a id="5648b6ca9683d707" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Compare</a>(<b>object</b> <span id="r108 rd" class="r108 r">first</span>, <b>object</b> <span id="r109 rd" class="r109 r">second</span>, <b>bool</b> <span id="r110 rd" class="r110 r">ignoreCase</span>)
        {
            <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">Compare</span>(<span class="r108 r">first</span>, <span class="r109 r">second</span>, <span class="r110 r">ignoreCase</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compare first and second, converting second to the</span>
        <span class="c">///</span><span class="c"> type of the first, if necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Second comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used if both values are strings.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used in type conversions and if both values are strings.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Less than zero if first is smaller than second, more than</span>
        <span class="c">///</span><span class="c"> zero if it is greater or zero if they are the same.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">first</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> does not implement IComparable or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">second</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> cannot be converted</span>
        <span class="c">///</span><span class="c"> to the type of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">first</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static int</b> <a id="46a8680515833568" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Compare</a>(<b>object</b> <span id="r111 rd" class="r111 r">first</span>, <b>object</b> <span id="r112 rd" class="r112 r">second</span>, <b>bool</b> <span id="r113 rd" class="r113 r">ignoreCase</span>, <span class="i">IFormatProvider</span> <span id="r114 rd" class="r114 r">formatProvider</span>)
        {
            <b>if</b> (<span class="r114 r">formatProvider</span> == <b>null</b>)
            {
                <span class="r114 r">formatProvider</span> = <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>;
            }
 
            <b>if</b> (!(<span class="r114 r">formatProvider</span> <b>is</b> <span class="i">CultureInfo</span> <span id="r115 rd" class="r115 r">culture</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r114 r">formatProvider</span>));
            }
 
            <span class="r111 r">first</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r111 r">first</span>);
            <span class="r112 r">second</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r112 r">second</span>);
 
            <b>if</b> (<span class="r111 r">first</span> == <b>null</b>)
            {
                <b>return</b> <span class="r112 r">second</span> == <b>null</b> ? 0 : <a href="#c2cc000b3cca7c09" class="i method">CompareObjectToNull</a>(<span class="r112 r">second</span>, <b>true</b>);
            }
 
            <b>if</b> (<span class="r112 r">second</span> == <b>null</b>)
            {
                <b>return</b> <a href="#c2cc000b3cca7c09" class="i method">CompareObjectToNull</a>(<span class="r111 r">first</span>, <b>false</b>);
            }
 
            <b>if</b> (<span class="r111 r">first</span> <b>is string</b> <span id="r116 rd" class="r116 r">firstString</span>)
            {
                <b>string</b> <span id="r117 rd" class="r117 r">secondString</span> = <span class="r112 r">second</span> <b>as string</b>;
                <b>if</b> (<span class="r117 r">secondString</span> == <b>null</b>)
                {
                    <b>try</b>
                    {
                        <span class="r117 r">secondString</span> = (<b>string</b>)<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r112 r">second</span>, <b>typeof</b>(<b>string</b>), <span class="r115 r">culture</span>);
                    }
                    <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a> <span id="r118 rd" class="r118 r">e</span>)
                    {
                        <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r112 r">second</span>), <span class="i">ExtendedTypeSystem</span>.<span class="i">ComparisonFailure</span>,
                                                                 <span class="r111 r">first</span>.<span class="i">ToString</span>(), <span class="r112 r">second</span>.<span class="i">ToString</span>(), <span class="r118 r">e</span>.<span class="i">Message</span>);
                    }
                }
 
                <b>return</b> <span class="r115 r">culture</span>.<span class="i">CompareInfo</span>.<span class="i">Compare</span>(<span class="r116 r">firstString</span>, <span class="r117 r">secondString</span>,
                                                   <span class="r113 r">ignoreCase</span> ? <span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span> : <span class="i">CompareOptions</span>.<span class="i">None</span>);
            }
 
            <span class="i">Type</span> <span id="r119 rd" class="r119 r">firstType</span> = <span class="r111 r">first</span>.<span class="i">GetType</span>();
            <span class="i">Type</span> <span id="r120 rd" class="r120 r">secondType</span> = <span class="r112 r">second</span>.<span class="i">GetType</span>();
            <b>int</b> <span id="r121 rd" class="r121 r">firstIndex</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#26600f97d164dd50" class="i method">TypeTableIndex</a>(<span class="r119 r">firstType</span>);
            <b>int</b> <span id="r122 rd" class="r122 r">secondIndex</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#26600f97d164dd50" class="i method">TypeTableIndex</a>(<span class="r120 r">secondType</span>);
            <b>if</b> ((<span class="r121 r">firstIndex</span> != -1) &amp;&amp; (<span class="r122 r">secondIndex</span> != -1))
            {
                <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#841811f9982f5aac" class="i method">NumericCompare</a>(<span class="r111 r">first</span>, <span class="r112 r">second</span>, <span class="r121 r">firstIndex</span>, <span class="r122 r">secondIndex</span>);
            }
 
            <b>object</b> <span id="r123 rd" class="r123 r">secondConverted</span>;
            <b>try</b>
            {
                <span class="r123 r">secondConverted</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r112 r">second</span>, <span class="r119 r">firstType</span>, <span class="r115 r">culture</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a> <span id="r124 rd" class="r124 r">e</span>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r112 r">second</span>), <span class="i">ExtendedTypeSystem</span>.<span class="i">ComparisonFailure</span>,
                                                         <span class="r111 r">first</span>.<span class="i">ToString</span>(), <span class="r112 r">second</span>.<span class="i">ToString</span>(), <span class="r124 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>if</b> (<span class="r111 r">first</span> <b>is</b> <span class="i">IComparable</span> <span id="r125 rd" class="r125 r">firstComparable</span>)
            {
                <b>return</b> <span class="r125 r">firstComparable</span>.<span class="i">CompareTo</span>(<span class="r123 r">secondConverted</span>);
            }
 
            <b>if</b> (<span class="r111 r">first</span>.<span class="i">Equals</span>(<span class="r112 r">second</span>))
            {
                <b>return</b> 0;
            }
 
            <span class="c">// At this point, we know that they aren&#39;t equal but we have no way of</span>
            <span class="c">// knowing which should compare greater than the other so we throw an exception.</span>
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r111 r">first</span>), <span class="i">ExtendedTypeSystem</span>.<span class="i">NotIcomparable</span>, <span class="r111 r">first</span>.<span class="i">ToString</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tries to compare first and second, converting second to the type of the first, if necessary.</span>
        <span class="c">///</span><span class="c"> If a conversion is needed but fails, false is return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Second comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Less than zero if first is smaller than second, more than</span>
        <span class="c">///</span><span class="c"> zero if it is greater or zero if they are the same.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the comparison was successful, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="8a0958e4b1491198" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TryCompare</a>(<b>object</b> <span id="r126 rd" class="r126 r">first</span>, <b>object</b> <span id="r127 rd" class="r127 r">second</span>, <b>out int</b> <span id="r128 rd" class="r128 r">result</span>)
        {
            <b>return</b> <span class="i">TryCompare</span>(<span class="r126 r">first</span>, <span class="r127 r">second</span>, <span class="i">ignoreCase</span>: <b>false</b>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>out</b> <span class="r128 r">result</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tries to compare first and second, converting second to the type of the first, if necessary.</span>
        <span class="c">///</span><span class="c"> If a conversion is needed but fails, false is return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Second comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used if both values are strings.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r132 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Less than zero if first is smaller than second, more than zero if it is greater or zero if they are the same.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the comparison was successful, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="31c901e3e580f49c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TryCompare</a>(<b>object</b> <span id="r129 rd" class="r129 r">first</span>, <b>object</b> <span id="r130 rd" class="r130 r">second</span>, <b>bool</b> <span id="r131 rd" class="r131 r">ignoreCase</span>, <b>out int</b> <span id="r132 rd" class="r132 r">result</span>)
        {
            <b>return</b> <span class="i">TryCompare</span>(<span class="r129 r">first</span>, <span class="r130 r">second</span>, <span class="r131 r">ignoreCase</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>out</b> <span class="r132 r">result</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tries to compare first and second, converting second to the type of the first, if necessary.</span>
        <span class="c">///</span><span class="c"> If a conversion is needed but fails, false is return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">first</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">First comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Second comparison value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used if both values are strings.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used in type conversions and if both values are strings.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Less than zero if first is smaller than second, more than  zero if it is greater or zero if they are the same.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the comparison was successful, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The parameter </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">formatProvider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CultureInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="1561c0d6dd93b6ea" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TryCompare</a>(<b>object</b> <span id="r133 rd" class="r133 r">first</span>, <b>object</b> <span id="r134 rd" class="r134 r">second</span>, <b>bool</b> <span id="r135 rd" class="r135 r">ignoreCase</span>, <span class="i">IFormatProvider</span> <span id="r136 rd" class="r136 r">formatProvider</span>, <b>out int</b> <span id="r137 rd" class="r137 r">result</span>)
        {
            <span class="r137 r">result</span> = 0;
            <b>if</b> (<span class="r136 r">formatProvider</span> == <b>null</b>)
            {
                <span class="r136 r">formatProvider</span> = <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>;
            }
 
            <b>if</b> (<span class="r136 r">formatProvider</span> <b>is not</b> <span class="i">CultureInfo</span> <span id="r138 rd" class="r138 r">culture</span>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r136 r">formatProvider</span>));
            }
 
            <span class="r133 r">first</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r133 r">first</span>);
            <span class="r134 r">second</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r134 r">second</span>);
 
            <b>if</b> (<span class="r133 r">first</span> == <b>null</b> &amp;&amp; <span class="r134 r">second</span> == <b>null</b>)
            {
                <span class="r137 r">result</span> = 0;
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r133 r">first</span> == <b>null</b>)
            {
                <span class="r137 r">result</span> = <a href="#c2cc000b3cca7c09" class="i method">CompareObjectToNull</a>(<span class="r134 r">second</span>, <b>true</b>);
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r134 r">second</span> == <b>null</b>)
            {
                <span class="c">// If it&#39;s a positive number, including 0, it&#39;s greater than null</span>
                <span class="c">// for everything else it&#39;s less than zero...</span>
                <span class="r137 r">result</span> = <a href="#c2cc000b3cca7c09" class="i method">CompareObjectToNull</a>(<span class="r133 r">first</span>, <b>false</b>);
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r133 r">first</span> <b>is string</b> <span id="r139 rd" class="r139 r">firstString</span>)
            {
                <b>if</b> (<span class="r134 r">second</span> <b>is not string</b> <span id="r140 rd" class="r140 r">secondString</span>)
                {
                    <b>if</b> (!<span class="i">TryConvertTo</span>(<span class="r134 r">second</span>, <span class="r138 r">culture</span>, <b>out</b> <span class="r140 r">secondString</span>))
                    {
                        <b>return</b> <b>false</b>;
                    }
                }
 
                <span class="r137 r">result</span> = <span class="r138 r">culture</span>.<span class="i">CompareInfo</span>.<span class="i">Compare</span>(<span class="r139 r">firstString</span>, <span class="r140 r">secondString</span>, <span class="r135 r">ignoreCase</span> ? <span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span> : <span class="i">CompareOptions</span>.<span class="i">None</span>);
                <b>return</b> <b>true</b>;
            }
 
            <span class="i">Type</span> <span id="r141 rd" class="r141 r">firstType</span> = <span class="r133 r">first</span>.<span class="i">GetType</span>();
            <span class="i">Type</span> <span id="r142 rd" class="r142 r">secondType</span> = <span class="r134 r">second</span>.<span class="i">GetType</span>();
            <b>int</b> <span id="r143 rd" class="r143 r">firstIndex</span> = <a href="#26600f97d164dd50" class="i method">TypeTableIndex</a>(<span class="r141 r">firstType</span>);
            <b>int</b> <span id="r144 rd" class="r144 r">secondIndex</span> = <a href="#26600f97d164dd50" class="i method">TypeTableIndex</a>(<span class="r142 r">secondType</span>);
            <b>if</b> (<span class="r143 r">firstIndex</span> != -1 &amp;&amp; <span class="r144 r">secondIndex</span> != -1)
            {
                <span class="r137 r">result</span> = <a href="#841811f9982f5aac" class="i method">NumericCompare</a>(<span class="r133 r">first</span>, <span class="r134 r">second</span>, <span class="r143 r">firstIndex</span>, <span class="r144 r">secondIndex</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (!<span class="i">TryConvertTo</span>(<span class="r134 r">second</span>, <span class="r141 r">firstType</span>, <span class="r138 r">culture</span>, <b>out object</b> <span id="r145 rd" class="r145 r">secondConverted</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r133 r">first</span> <b>is</b> <span class="i">IComparable</span> <span id="r146 rd" class="r146 r">firstComparable</span>)
            {
                <span class="r137 r">result</span> = <span class="r146 r">firstComparable</span>.<span class="i">CompareTo</span>(<span class="r145 r">secondConverted</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r133 r">first</span>.<span class="i">Equals</span>(<span class="r134 r">second</span>))
            {
                <span class="r137 r">result</span> = 0;
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// At this point, we know that they aren&#39;t equal but we have no way of</span>
            <span class="c">// knowing which should compare greater than the other so we return false.</span>
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the language considers obj to be true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r147 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Obj to verify if it is true.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if obj is true.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1720:IdentifiersShouldNotContainTypeNames&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;obj&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Since V1 code is already shipped, excluding this message for backward compatibility reasons&quot;</span>)]
        <b>public static bool</b> <a id="7b42a860769a8de5" href="../R/7b42a860769a8de5.html" target="n" data-glyph="72,1" class="i method">IsTrue</a>(<b>object</b> <span id="r147 rd" class="r147 r">obj</span>)
        {
            <span class="c">// null is a valid argument - it converts to false...</span>
            <b>if</b> (<span class="r147 r">obj</span> == <b>null</b> || <span class="r147 r">obj</span> == <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                <b>return</b> <b>false</b>;
 
            <span class="r147 r">obj</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r147 r">obj</span>);
 
            <span class="i">Type</span> <span id="r148 rd" class="r148 r">objType</span> = <span class="r147 r">obj</span>.<span class="i">GetType</span>();
 
            <b>if</b> (<span class="r148 r">objType</span> == <b>typeof</b>(<b>bool</b>))
            {
                <b>return</b> (<b>bool</b>)<span class="r147 r">obj</span>;
            }
 
            <b>if</b> (<span class="r148 r">objType</span> == <b>typeof</b>(<b>string</b>))
            {
                <b>return</b> <a href="#0d034360442f5a24" class="i method">IsTrue</a>((<b>string</b>)<span class="r147 r">obj</span>);
            }
 
            <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#e25b1c6d235a82c5" class="i method">IsNumeric</a>(<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r148 r">objType</span>)))
            {
                <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r149 rd" class="r149 r">data</span> = <span class="i">GetConversionData</span>(<span class="r148 r">objType</span>, <b>typeof</b>(<b>bool</b>)) ??
                                       <span class="i">CacheConversion</span>(<span class="r148 r">objType</span>, <b>typeof</b>(<b>bool</b>), <a href="#e3b6ef6a498ee446" class="i method">CreateNumericToBoolConverter</a>(<span class="r148 r">objType</span>), <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <b>return</b> (<b>bool</b>)<span class="r149 r">data</span>.<span class="i">Invoke</span>(<span class="r147 r">obj</span>, <b>typeof</b>(<b>bool</b>), <b>false</b>, <b>null</b>, <b>null</b>, <b>null</b>);
            }
 
            <b>if</b> (<span class="r148 r">objType</span> == <b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>))
                <b>return</b> ((<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>)<span class="r147 r">obj</span>).<a href="MshCmdlet.cs.html#1292a5d1a1a3e8e8" class="i method">ToBool</a>();
 
            <span class="i">IList</span> <span id="r150 rd" class="r150 r">objectArray</span> = <span class="r147 r">obj</span> <b>as</b> <span class="i">IList</span>;
            <b>if</b> (<span class="r150 r">objectArray</span> != <b>null</b>)
            {
                <b>return</b> <a href="#43c054e323f3ca74" class="i method">IsTrue</a>(<span class="r150 r">objectArray</span>);
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>internal static bool</b> <a id="0d034360442f5a24" href="../R/0d034360442f5a24.html" target="n" data-glyph="74,1" class="i method">IsTrue</a>(<b>string</b> <span id="r151 rd" class="r151 r">s</span>)
        {
            <b>return</b> (<span class="r151 r">s</span>.<span class="i">Length</span> != 0);
        }
 
        <b>internal static bool</b> <a id="43c054e323f3ca74" href="../R/43c054e323f3ca74.html" target="n" data-glyph="74,1" class="i method">IsTrue</a>(<span class="i">IList</span> <span id="r152 rd" class="r152 r">objectArray</span>)
        {
            <b>switch</b> (<span class="r152 r">objectArray</span>.<span class="i">Count</span>)
            {
                <span class="c">// a zero length array is false, so condition is false</span>
                <b>case</b> 0:
                    <b>return</b> <b>false</b>;
 
                <span class="c">// if the result is an array of length 1, treat it as a scalar...</span>
                <b>case</b> 1:
                    <span class="c">// A possible implementation would be just</span>
                    <span class="c">// return IsTrue(objectArray[0]);</span>
                    <span class="c">// but since we don&#39;t want this to recurse indefinitely</span>
                    <span class="c">// we explicitly check the case where it would recurse</span>
                    <span class="c">// and deal with it.</span>
                    <b>if</b> (!(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r152 r">objectArray</span>[0]) <b>is</b> <span class="i">IList</span> <span id="r153 rd" class="r153 r">firstElement</span>))
                    {
                        <b>return</b> <span class="i">IsTrue</span>(<span class="r152 r">objectArray</span>[0]);
                    }
 
                    <b>if</b> (<span class="r153 r">firstElement</span>.<span class="i">Count</span> &lt; 1) <b>return</b> <b>false</b>;
 
                    <span class="c">// the first element is an array with more than zero elements</span>
                    <b>return</b> <b>true</b>;
 
                <b>default</b>:
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal routine that determines if an object meets any of our criteria for null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object to test.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the object is null.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="cf665fbdc4612d9d" href="../R/cf665fbdc4612d9d.html" target="n" data-glyph="74,1" class="i method">IsNull</a>(<b>object</b> <span id="r154 rd" class="r154 r">obj</span>)
        {
            <b>return</b> (<span class="r154 r">obj</span> == <b>null</b> || <span class="r154 r">obj</span> == <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Auxiliary for the cases where we want a new PSObject or null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="e9d9a7d7ec7be239" href="../R/e9d9a7d7ec7be239.html" target="n" data-glyph="74,1" class="i method">AsPSObjectOrNull</a>(<b>object</b> <span id="r155 rd" class="r155 r">obj</span>)
        {
            <b>if</b> (<span class="r155 r">obj</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r155 r">obj</span>);
        }
 
        <b>internal static int</b> <a id="26600f97d164dd50" href="../R/26600f97d164dd50.html" target="n" data-glyph="74,1" class="i method">TypeTableIndex</a>(<span class="i">Type</span> <span id="r156 rd" class="r156 r">type</span>)
        {
            <b>switch</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r156 r">type</span>))
            {
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int16</span>: <b>return</b> 0;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int32</span>: <b>return</b> 1;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int64</span>: <b>return</b> 2;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt16</span>: <b>return</b> 3;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt32</span>: <b>return</b> 4;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt64</span>: <b>return</b> 5;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">SByte</span>: <b>return</b> 6;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Byte</span>: <b>return</b> 7;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Single</span>: <b>return</b> 8;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Double</span>: <b>return</b> 9;
                <b>case</b> <span class="i">TypeCode</span>.<span class="i">Decimal</span>: <b>return</b> 10;
                <b>default</b>: <b>return</b> -1;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Table of the largest safe type to which both types can be converted without exceptions.</span>
        <span class="c">///</span><span class="c"> This table is used for numeric comparisons.</span>
        <span class="c">///</span><span class="c"> The 4 entries marked as not used, are explicitly dealt with in NumericCompareDecimal.</span>
        <span class="c">///</span><span class="c"> NumericCompareDecimal exists because doubles and singles can throw</span>
        <span class="c">///</span><span class="c"> an exception when converted to decimal.</span>
        <span class="c">///</span><span class="c"> The order of lines and columns cannot be changed since NumericCompare depends on it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly</b> <span class="i">Type</span>[][] <a id="70d4e8f9566e339a" href="../R/70d4e8f9566e339a.html" target="n" data-glyph="44,1" class="i field">LargestTypeTable</a> = <b>new</b> <span class="i">Type</span>[][]
        {
            <span class="c">//                                       System.Int16            System.Int32            System.Int64            System.UInt16           System.UInt32           System.UInt64           System.SByte            System.Byte             System.Single           System.Double           System.Decimal</span>
            <span class="c">/* System.Int16   */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int16</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int16</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int16</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.Int32   */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.Int64   */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.UInt16  */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt16</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt32</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt64</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt16</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.UInt32  */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt32</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt32</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt64</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt32</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.UInt64  */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt64</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt64</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt64</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt64</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.SByte   */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int16</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">SByte</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int16</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.Byte    */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int16</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int32</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int64</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt16</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt32</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">UInt64</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Int16</span>),   <b>typeof</b>(<span class="i n">System</span>.<span class="i">Byte</span>),    <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
            <span class="c">/* System.Single  */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Single</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>null</b><span class="c">/*not used*/</span>       },
            <span class="c">/* System.Double  */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>),  <b>null</b><span class="c">/*not used*/</span>       },
            <span class="c">/* System.Decimal */</span><b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <b>null</b><span class="c">/*not used*/</span>,       <b>null</b><span class="c">/*not used*/</span>,       <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>) },
        };
 
        <b>private static int</b> <a id="7f31feae89711762" href="../R/7f31feae89711762.html" target="n" data-glyph="76,1" class="i method">NumericCompareDecimal</a>(<b>decimal</b> <span id="r157 rd" class="r157 r">decimalNumber</span>, <b>object</b> <span id="r158 rd" class="r158 r">otherNumber</span>)
        {
            <b>object</b> <span id="r159 rd" class="r159 r">otherDecimal</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r159 r">otherDecimal</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r158 r">otherNumber</span>, <b>typeof</b>(<span class="i n">System</span>.<span class="i">Decimal</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>catch</b> (<span class="i">OverflowException</span>)
            {
                <b>try</b>
                {
                    <b>double</b> <span id="r160 rd" class="r160 r">wasDecimal</span> = (<b>double</b>)<span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r157 r">decimalNumber</span>, <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    <b>double</b> <span id="r161 rd" class="r161 r">otherDouble</span> = (<b>double</b>)<span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r158 r">otherNumber</span>, <b>typeof</b>(<span class="i n">System</span>.<span class="i">Double</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    <b>return</b> ((<span class="i">IComparable</span>)<span class="r160 r">wasDecimal</span>).<span class="i">CompareTo</span>(<span class="r161 r">otherDouble</span>);
                }
                <b>catch</b> (<span class="i">Exception</span>) <span class="c">// We need to catch the generic exception because ChangeType throws unadvertised exceptions</span>
                {
                    <b>return</b> -1;
                }
            }
            <b>catch</b> (<span class="i">Exception</span>) <span class="c">// We need to catch the generic exception because ChangeType throws unadvertised exceptions</span>
            {
                <b>return</b> -1;
            }
 
            <b>return</b> ((<span class="i">IComparable</span>)<span class="r157 r">decimalNumber</span>).<span class="i">CompareTo</span>(<span class="r159 r">otherDecimal</span>);
        }
 
        <b>private static int</b> <a id="841811f9982f5aac" href="../R/841811f9982f5aac.html" target="n" data-glyph="76,1" class="i method">NumericCompare</a>(<b>object</b> <span id="r162 rd" class="r162 r">number1</span>, <b>object</b> <span id="r163 rd" class="r163 r">number2</span>, <b>int</b> <span id="r164 rd" class="r164 r">index1</span>, <b>int</b> <span id="r165 rd" class="r165 r">index2</span>)
        {
            <span class="c">// Conversion from single or double to decimal might throw</span>
            <span class="c">// if the double is greater than the decimal&#39;s maximum so</span>
            <span class="c">// we special case it in NumericCompareDecimal</span>
            <b>if</b> ((<span class="r164 r">index1</span> == 10) &amp;&amp; ((<span class="r165 r">index2</span> == 8) || (<span class="r165 r">index2</span> == 9)))
            {
                <b>return</b> <a href="#7f31feae89711762" class="i method">NumericCompareDecimal</a>((<b>decimal</b>)<span class="r162 r">number1</span>, <span class="r163 r">number2</span>);
            }
 
            <b>if</b> ((<span class="r165 r">index2</span> == 10) &amp;&amp; ((<span class="r164 r">index1</span> == 8) || (<span class="r164 r">index1</span> == 9)))
            {
                <b>return</b> -<a href="#7f31feae89711762" class="i method">NumericCompareDecimal</a>((<b>decimal</b>)<span class="r163 r">number2</span>, <span class="r162 r">number1</span>);
            }
 
            <span class="i">Type</span> <span id="r166 rd" class="r166 r">commonType</span> = <a href="#70d4e8f9566e339a" class="i field">LargestTypeTable</a>[<span class="r164 r">index1</span>][<span class="r165 r">index2</span>];
            <b>object</b> <span id="r167 rd" class="r167 r">number1Converted</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r162 r">number1</span>, <span class="r166 r">commonType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            <b>object</b> <span id="r168 rd" class="r168 r">number2Converted</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r163 r">number2</span>, <span class="r166 r">commonType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            <b>return</b> ((<span class="i">IComparable</span>)<span class="r167 r">number1Converted</span>).<span class="i">CompareTo</span>(<span class="r168 r">number2Converted</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Necessary not to return an integer type code for enums.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">TypeCode</span> <a id="b95fb4b37c36d13d" href="../R/b95fb4b37c36d13d.html" target="n" data-glyph="74,1" class="i method">GetTypeCode</a>(<span class="i">Type</span> <span id="r169 rd" class="r169 r">type</span>)
        {
            <b>return</b> <span class="r169 r">type</span>.<a href="../utils/ExtensionMethods.cs.html#6941492779b390f9" class="i method">GetTypeCode</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Emulates the &quot;As&quot; C# language primitive, but will unwrap</span>
        <span class="c">///</span><span class="c"> the PSObject if required.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type for which to convert</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">castObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object from which to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An object of the specified type, if the conversion was successful.  Returns null otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="r170 r t">T</span> <a id="f3ed5e88fcd03db7" href="../R/f3ed5e88fcd03db7.html" target="n" data-glyph="74,1" class="i method">FromObjectAs</a>&lt;<span id="r170 rd t" class="r170 r t">T</span>&gt;(<b>object</b> <span id="r171 rd" class="r171 r">castObject</span>)
        {
            <span class="r170 r t">T</span> <span id="r172 rd" class="r172 r">returnType</span> = <b>default</b>(<span class="r170 r t">T</span>);
 
            <span class="c">// First, see if we can cast the direct type</span>
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r173 rd" class="r173 r">wrapperObject</span> = <span class="r171 r">castObject</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <b>if</b> (<span class="r173 r">wrapperObject</span> == <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="r172 r">returnType</span> = (<span class="r170 r t">T</span>)<span class="r171 r">castObject</span>;
                }
                <b>catch</b> (<span class="i">InvalidCastException</span>)
                {
                    <span class="r172 r">returnType</span> = <b>default</b>(<span class="r170 r t">T</span>);
                }
            }
            <span class="c">// Then, see if it is an PSObject wrapping the object</span>
            <b>else</b>
            {
                <b>try</b>
                {
                    <span class="r172 r">returnType</span> = (<span class="r170 r t">T</span>)<span class="r173 r">wrapperObject</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>;
                }
                <b>catch</b> (<span class="i">InvalidCastException</span>)
                {
                    <span class="r172 r">returnType</span> = <b>default</b>(<span class="r170 r t">T</span>);
                }
            }
 
            <b>return</b> <span class="r172 r">returnType</span>;
        }
 
        [<span class="i">Flags</span>]
        <b>private enum</b> <a id="37f38eb0e3664a53" href="../R/37f38eb0e3664a53.html" target="n" data-glyph="22,1" class="t t"><span id="c243707234ce7db2">TypeCodeTraits</span></a>
        {
            <a id="6b990e91030e8cb4" href="../R/6b990e91030e8cb4.html" target="n" data-glyph="24,2" class="i field">None</a> = 0x00,
            <a id="f1c2404e53a26bec" href="../R/f1c2404e53a26bec.html" target="n" data-glyph="24,2" class="i field">SignedInteger</a> = 0x01,
            <a id="c8a28ad01e5cdd0f" href="../R/c8a28ad01e5cdd0f.html" target="n" data-glyph="24,2" class="i field">UnsignedInteger</a> = 0x02,
            <a id="2dd2abb455e8868b" href="../R/2dd2abb455e8868b.html" target="n" data-glyph="24,2" class="i field">Floating</a> = 0x04,
            <a id="702ecf648d259230" href="../R/702ecf648d259230.html" target="n" data-glyph="24,2" class="i field">CimIntrinsicType</a> = 0x08,
            <a id="c26efac096c05db8" href="../R/c26efac096c05db8.html" target="n" data-glyph="24,2" class="i field">Decimal</a> = 0x10,
 
            <a id="fc054bd51b3041ba" href="../R/fc054bd51b3041ba.html" target="n" data-glyph="24,2" class="i field">Integer</a> = <a href="#f1c2404e53a26bec" class="i field">SignedInteger</a> | <a href="#c8a28ad01e5cdd0f" class="i field">UnsignedInteger</a>,
            <a id="49d90801c6f7587e" href="../R/49d90801c6f7587e.html" target="n" data-glyph="24,2" class="i field">Numeric</a> = <a href="#fc054bd51b3041ba" class="i field">Integer</a> | <a href="#2dd2abb455e8868b" class="i field">Floating</a> | <a href="#c26efac096c05db8" class="i field">Decimal</a>,
        }
 
        <b>private static readonly</b> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>[] <a id="7af4245684a93c2a" href="../R/7af4245684a93c2a.html" target="n" data-glyph="46,1" class="i field">s_typeCodeTraits</a> = <b>new</b> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>[]
        {
            <span class="c">/* Empty    =  0 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#6b990e91030e8cb4" class="i field">None</a>,
            <span class="c">/* Object   =  1 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#6b990e91030e8cb4" class="i field">None</a>,
            <span class="c">/* DBNull   =  2 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#6b990e91030e8cb4" class="i field">None</a>,
            <span class="c">/* Boolean  =  3 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Char     =  4 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* SByte    =  5 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#f1c2404e53a26bec" class="i field">SignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Byte     =  6 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#c8a28ad01e5cdd0f" class="i field">UnsignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Int16    =  7 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#f1c2404e53a26bec" class="i field">SignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* UInt16   =  8 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#c8a28ad01e5cdd0f" class="i field">UnsignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Int32    =  9 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#f1c2404e53a26bec" class="i field">SignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* UInt32   = 10 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#c8a28ad01e5cdd0f" class="i field">UnsignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Int64    = 11 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#f1c2404e53a26bec" class="i field">SignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* UInt64   = 12 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#c8a28ad01e5cdd0f" class="i field">UnsignedInteger</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Single   = 13 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#2dd2abb455e8868b" class="i field">Floating</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Double   = 14 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#2dd2abb455e8868b" class="i field">Floating</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/* Decimal  = 15 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#c26efac096c05db8" class="i field">Decimal</a>,
            <span class="c">/* DateTime = 16 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#6b990e91030e8cb4" class="i field">None</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
            <span class="c">/*          = 17 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#6b990e91030e8cb4" class="i field">None</a>,
            <span class="c">/* String   = 18 */</span> <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#6b990e91030e8cb4" class="i field">None</a> | <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>,
        };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is a signed integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r174 r">typeCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type code to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is a signed integer, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="aabe01c3319c6528" href="../R/aabe01c3319c6528.html" target="n" data-glyph="74,1" class="i method">IsSignedInteger</a>(<span class="i">TypeCode</span> <span id="r174 rd" class="r174 r">typeCode</span>)
        {
            <b>return</b> (<a href="#7af4245684a93c2a" class="i field">s_typeCodeTraits</a>[(<b>int</b>)<span class="r174 r">typeCode</span>] &amp; <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#f1c2404e53a26bec" class="i field">SignedInteger</a>) != 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is an unsigned integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r175 r">typeCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type code to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is an unsigned integer, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="b3725e7ee052365c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsUnsignedInteger</a>(<span class="i">TypeCode</span> <span id="r175 rd" class="r175 r">typeCode</span>)
        {
            <b>return</b> (<a href="#7af4245684a93c2a" class="i field">s_typeCodeTraits</a>[(<b>int</b>)<span class="r175 r">typeCode</span>] &amp; <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#c8a28ad01e5cdd0f" class="i field">UnsignedInteger</a>) != 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r176 r">typeCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type code to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is integer, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="76ac66e2c6f26c02" href="../R/76ac66e2c6f26c02.html" target="n" data-glyph="74,1" class="i method">IsInteger</a>(<span class="i">TypeCode</span> <span id="r176 rd" class="r176 r">typeCode</span>)
        {
            <b>return</b> (<a href="#7af4245684a93c2a" class="i field">s_typeCodeTraits</a>[(<b>int</b>)<span class="r176 r">typeCode</span>] &amp; <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#fc054bd51b3041ba" class="i field">Integer</a>) != 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is a floating point number.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r177 r">typeCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type code to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is floating point, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="f62e8d50a4f37169" href="../R/f62e8d50a4f37169.html" target="n" data-glyph="74,1" class="i method">IsFloating</a>(<span class="i">TypeCode</span> <span id="r177 rd" class="r177 r">typeCode</span>)
        {
            <b>return</b> (<a href="#7af4245684a93c2a" class="i field">s_typeCodeTraits</a>[(<b>int</b>)<span class="r177 r">typeCode</span>] &amp; <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#2dd2abb455e8868b" class="i field">Floating</a>) != 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is an integer or floating point number.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r178 r">typeCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type code to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is integer or floating point, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="e25b1c6d235a82c5" href="../R/e25b1c6d235a82c5.html" target="n" data-glyph="74,1" class="i method">IsNumeric</a>(<span class="i">TypeCode</span> <span id="r178 rd" class="r178 r">typeCode</span>)
        {
            <b>return</b> (<a href="#7af4245684a93c2a" class="i field">s_typeCodeTraits</a>[(<b>int</b>)<span class="r178 r">typeCode</span>] &amp; <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#49d90801c6f7587e" class="i field">Numeric</a>) != 0;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is a CIM intrinsic type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r179 r">typeCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type code to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is CIM intrinsic type, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="5612566e96a7b943" href="../R/5612566e96a7b943.html" target="n" data-glyph="74,1" class="i method">IsCimIntrinsicScalarType</a>(<span class="i">TypeCode</span> <span id="r179 rd" class="r179 r">typeCode</span>)
        {
            <b>return</b> (<a href="#7af4245684a93c2a" class="i field">s_typeCodeTraits</a>[(<b>int</b>)<span class="r179 r">typeCode</span>] &amp; <a href="#37f38eb0e3664a53" class="t t">TypeCodeTraits</a>.<a href="#702ecf648d259230" class="i field">CimIntrinsicType</a>) != 0;
        }
 
        <b>internal static bool</b> <a id="5abd1e854710c2e4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsCimIntrinsicScalarType</a>(<span class="i">Type</span> <span id="r180 rd" class="r180 r">type</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r180 r">type</span> != <b>null</b>, <span class="s">&quot;Caller should verify type != null&quot;</span>);
 
            <span class="c">// using type code we can cover all intrinsic types from the table</span>
            <span class="c">// on page 11 of DSP0004, except:</span>
            <span class="c">// - TimeSpan part of &quot;datetime&quot;</span>
            <span class="c">// - &lt;classname&gt; ref</span>
            <span class="i">TypeCode</span> <span id="r181 rd" class="r181 r">typeCode</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r180 r">type</span>);
            <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#5612566e96a7b943" class="i method">IsCimIntrinsicScalarType</a>(<span class="r181 r">typeCode</span>) &amp;&amp; !<span class="r180 r">type</span>.<span class="i">IsEnum</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r180 r">type</span> == <b>typeof</b>(<span class="i">TimeSpan</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is one of the boolean types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r182 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is one of boolean types, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="e38962e3de48a9c2" href="../R/e38962e3de48a9c2.html" target="n" data-glyph="74,1" class="i method">IsBooleanType</a>(<span class="i">Type</span> <span id="r182 rd" class="r182 r">type</span>)
        {
            <b>if</b> (<span class="r182 r">type</span> == <b>typeof</b>(<b>bool</b>) ||
                <span class="r182 r">type</span> == <b>typeof</b>(<b>bool</b>?))
                <b>return</b> <b>true</b>;
            <b>else</b>
                <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is one of switch parameter types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r183 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type is one of switch parameter types, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="66af0b95e92145dd" href="../R/66af0b95e92145dd.html" target="n" data-glyph="74,1" class="i method">IsSwitchParameterType</a>(<span class="i">Type</span> <span id="r183 rd" class="r183 r">type</span>)
        {
            <b>if</b> (<span class="r183 r">type</span> == <b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>) || <span class="r183 r">type</span> == <b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>?))
                <b>return</b> <b>true</b>;
            <b>else</b>
                <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if type is one of boolean or switch parameter types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r184 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to check.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if type if one of boolean or switch parameter types,</span>
        <span class="c">///</span><span class="c"> false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="8f1f4a2a4c16a834" href="../R/8f1f4a2a4c16a834.html" target="n" data-glyph="74,1" class="i method">IsBoolOrSwitchParameterType</a>(<span class="i">Type</span> <span id="r184 rd" class="r184 r">type</span>)
        {
            <b>if</b> (<a href="#e38962e3de48a9c2" class="i method">IsBooleanType</a>(<span class="r184 r">type</span>) || <a href="#66af0b95e92145dd" class="i method">IsSwitchParameterType</a>(<span class="r184 r">type</span>))
                <b>return</b> <b>true</b>;
            <b>else</b>
                <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do the necessary conversions when using property or array assignment to a generic dictionary:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">     $dict.Prop = value</span>
        <span class="c">///</span><span class="c">     $dict[$Prop] = value</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The property typically won&#39;t need conversion, but it could.  The value is more likely in</span>
        <span class="c">///</span><span class="c"> need of conversion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r185 r">dictionary</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The dictionary that potentially implement </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">IDictionary</span>&amp;lt;<span class="r186 r t">TKey</span>,<span class="r187 r t">TValue</span>&amp;gt;<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object representing the key.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to assign.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="87223807dc8c920c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DoConversionsForSetInGenericDictionary</a>(<span class="i">IDictionary</span> <span id="r185 rd" class="r185 r">dictionary</span>, <b>ref object</b> <span id="r188 rd" class="r188 r">key</span>, <b>ref object</b> <span id="r189 rd" class="r189 r">value</span>)
        {
            <b>foreach</b> (<span class="i">Type</span> <span id="r190 rd" class="r190 r">i</span> <b>in</b> <span class="r185 r">dictionary</span>.<span class="i">GetType</span>().<span class="i">GetInterfaces</span>())
            {
                <b>if</b> (<span class="r190 r">i</span>.<span class="i">IsGenericType</span> &amp;&amp; <span class="r190 r">i</span>.<span class="i">GetGenericTypeDefinition</span>() == <b>typeof</b>(<span class="i">IDictionary</span>&lt;,&gt;))
                {
                    <span class="c">// If we get here, we know the target implements IDictionary.  We will assume</span>
                    <span class="c">// that the non-generic implementation of the indexer property just forwards</span>
                    <span class="c">// to the generic version, after checking the types of the key and value.</span>
                    <span class="c">// This assumption holds for System.Collections.Generic.Dictionary&lt;TKey,TValue&gt;.</span>
 
                    <span class="c">// If we did not make this assumption, we would be forced to generate code</span>
                    <span class="c">// to call the generic indexer directly, somewhat analogous to what we do</span>
                    <span class="c">// in GetEnumeratorFromIEnumeratorT.</span>
 
                    <span class="i">Type</span>[] <span id="r191 rd" class="r191 r">genericArguments</span> = <span class="r190 r">i</span>.<span class="i">GetGenericArguments</span>();
                    <span class="r188 r">key</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r188 r">key</span>, <span class="r191 r">genericArguments</span>[0], <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    <span class="r189 r">value</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r189 r">value</span>, <span class="r191 r">genericArguments</span>[1], <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> type converter
 
        <b>internal static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="5ccf00d099bd97dd" href="../R/5ccf00d099bd97dd.html" target="n" data-glyph="44,1" class="i field">typeConversion</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#24b0f68d5add3eb3" class="i method">GetTracer</a>(<span class="s">&quot;TypeConversion&quot;</span>, <span class="s">&quot;Traces the type conversion algorithm&quot;</span>, <b>false</b>);
        <b>internal static readonly</b> <a href="#ce2e37c22cd659bb" class="t t">ConversionData</a>&lt;<b>object</b>&gt; <a id="bef924d0a850a813" href="../R/bef924d0a850a813.html" target="n" data-glyph="44,1" class="i field">NoConversion</a> = <b>new</b> <a href="#12b2b1e2fcd7a4bf" class="t constructor">ConversionData</a>&lt;<b>object</b>&gt;(<a href="#e305b87a9a31c9e7" class="i method">ConvertNoConversion</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>);
 
        <b>private static</b> <span class="i">TypeConverter</span> <a id="82b3fc38df9ae7be" href="../R/82b3fc38df9ae7be.html" target="n" data-glyph="76,1" class="i method">GetIntegerSystemConverter</a>(<span class="i">Type</span> <span id="r192 rd" class="r192 r">type</span>)
        {
            <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<span class="i">Int16</span>))
            {
                <b>return</b> <b>new</b> <span class="i">Int16Converter</span>();
            }
            <b>else</b> <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<span class="i">Int32</span>))
            {
                <b>return</b> <b>new</b> <span class="i">Int32Converter</span>();
            }
            <b>else</b> <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<span class="i">Int64</span>))
            {
                <b>return</b> <b>new</b> <span class="i">Int64Converter</span>();
            }
            <b>else</b> <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<span class="i">UInt16</span>))
            {
                <b>return</b> <b>new</b> <span class="i">UInt16Converter</span>();
            }
            <b>else</b> <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<span class="i">UInt32</span>))
            {
                <b>return</b> <b>new</b> <span class="i">UInt32Converter</span>();
            }
            <b>else</b> <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<span class="i">UInt64</span>))
            {
                <b>return</b> <b>new</b> <span class="i">UInt64Converter</span>();
            }
            <b>else</b> <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<b>byte</b>))
            {
                <b>return</b> <b>new</b> <span class="i">ByteConverter</span>();
            }
            <b>else</b> <b>if</b> (<span class="r192 r">type</span> == <b>typeof</b>(<b>sbyte</b>))
            {
                <b>return</b> <b>new</b> <span class="i">SByteConverter</span>();
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> backupTypeTable:</span>
        <span class="c">///</span><span class="c"> Used by Remoting Rehydration Logic. While Deserializing a remote object,</span>
        <span class="c">///</span><span class="c"> LocalPipeline.ExecutionContextFromTLS() might return null..In which case this</span>
        <span class="c">///</span><span class="c"> TypeTable will be used to do the conversion.</span>
        <b>internal static object</b> <a id="9bcb01c5d7ce5d91" href="../R/9bcb01c5d7ce5d91.html" target="n" data-glyph="74,1" class="i method">GetConverter</a>(<span class="i">Type</span> <span id="r193 rd" class="r193 r">type</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r194 rd" class="r194 r">backupTypeTable</span>)
        {
            <b>object</b> <span id="r195 rd" class="r195 r">typesXmlConverter</span> = <b>null</b>;
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r196 rd" class="r196 r">ecFromTLS</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>if</b> (<span class="r196 r">ecFromTLS</span> != <b>null</b>)
            {
                <a href="#54018625801279e1" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;ecFromTLS != null&quot;</span>);
                <span class="r195 r">typesXmlConverter</span> = <span class="r196 r">ecFromTLS</span>.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>.<span class="i">GetTypeConverter</span>(<span class="r193 r">type</span>.<span class="i">FullName</span>);
            }
 
            <b>if</b> ((<span class="r195 r">typesXmlConverter</span> == <b>null</b>) &amp;&amp; (<span class="r194 r">backupTypeTable</span> != <b>null</b>))
            {
                <a href="#54018625801279e1" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Using provided TypeTable to get the type converter&quot;</span>);
                <span class="r195 r">typesXmlConverter</span> = <span class="r194 r">backupTypeTable</span>.<span class="i">GetTypeConverter</span>(<span class="r193 r">type</span>.<span class="i">FullName</span>);
            }
 
            <b>if</b> (<span class="r195 r">typesXmlConverter</span> != <b>null</b>)
            {
                <a href="#54018625801279e1" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;typesXmlConverter != null&quot;</span>);
                <b>return</b> <span class="r195 r">typesXmlConverter</span>;
            }
 
            <b>var</b> <span id="r197 rd" class="r197 r">typeConverters</span> = <span class="r193 r">type</span>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<span class="i">TypeConverterAttribute</span>), <b>false</b>);
            <b>foreach</b> (<b>var</b> <span id="r198 rd" class="r198 r">typeConverter</span> <b>in</b> <span class="r197 r">typeConverters</span>)
            {
                <b>var</b> <span id="r199 rd" class="r199 r">attr</span> = (<span class="i">TypeConverterAttribute</span>)<span class="r198 r">typeConverter</span>;
                <b>string</b> <span id="r200 rd" class="r200 r">assemblyQualifiedtypeName</span> = <span class="r199 r">attr</span>.<span class="i">ConverterTypeName</span>;
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;{0}&#39;s TypeConverterAttribute points to {1}.&quot;</span>, <span class="r193 r">type</span>, <span class="r200 r">assemblyQualifiedtypeName</span>);
 
                <span class="c">// The return statement makes sure we only process the first TypeConverterAttribute</span>
                <b>return</b> <a href="#8370bdd754d5da90" class="i method">NewConverterInstance</a>(<span class="r200 r">assemblyQualifiedtypeName</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static object</b> <a id="8370bdd754d5da90" href="../R/8370bdd754d5da90.html" target="n" data-glyph="76,1" class="i method">NewConverterInstance</a>(<b>string</b> <span id="r201 rd" class="r201 r">assemblyQualifiedTypeName</span>)
        {
            <b>if</b> (!<span class="r201 r">assemblyQualifiedTypeName</span>.<span class="i">Contains</span>(<span class="s">&#39;,&#39;</span>))
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Type name \&quot;{0}\&quot; should be assembly qualified.&quot;</span>, <span class="r201 r">assemblyQualifiedTypeName</span>);
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">Type</span> <span id="r202 rd" class="r202 r">converterType</span>;
            <b>try</b>
            {
                <span class="c">// Type.GetType() can load an assembly.</span>
                <span class="c">// PowerShell is allowed to load only TPA.</span>
                <span class="c">// Since a type is already loaded we trust to an attribute assigned to the type</span>
                <span class="c">// and can use Type.GetType() without additional checks.</span>
                <span class="r202 r">converterType</span> = <span class="i">Type</span>.<span class="i">GetType</span>(<span class="r201 r">assemblyQualifiedTypeName</span>, <span class="i">throwOnError</span>: <b>true</b>, <span class="i">ignoreCase</span>: <b>false</b>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r203 rd" class="r203 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Threw an exception when retrieving the type \&quot;{1}\&quot;: \&quot;{2}\&quot;.&quot;</span>, <span class="r201 r">assemblyQualifiedTypeName</span>, <span class="r203 r">e</span>.<span class="i">Message</span>);
                <b>return</b> <b>null</b>;
            }
 
            <b>try</b>
            {
                <b>return</b> <span class="i">Activator</span>.<span class="i">CreateInstance</span>(<span class="r202 r">converterType</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r204 rd" class="r204 r">e</span>)
            {
                <span class="i">TargetInvocationException</span> <span id="r205 rd" class="r205 r">inner</span> = <span class="r204 r">e</span> <b>as</b> <span class="i">TargetInvocationException</span>;
                <b>string</b> <span id="r206 rd" class="r206 r">message</span> = (<span class="r205 r">inner</span> == <b>null</b>) || (<span class="r205 r">inner</span>.<span class="i">InnerException</span> == <b>null</b>) ? <span class="r204 r">e</span>.<span class="i">Message</span> : <span class="r205 r">inner</span>.<span class="i">InnerException</span>.<span class="i">Message</span>;
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(<span class="s">&quot;Creating an instance of type \&quot;{0}\&quot; caused an exception to be thrown: \&quot;{1}\&quot;&quot;</span>, <span class="r201 r">assemblyQualifiedTypeName</span>, <span class="r206 r">message</span>);
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BUGBUG - brucepay Mar. 2013 - I don&#39;t think this is general enough for dynamic keywords to support arbitrary target</span>
        <span class="c">///</span><span class="c"> languages with arbitrary type representations so we may need an extension point here...</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Maps a .NET or CIM type name string (e.g. SInt32) to the form expected by PowerShell users, namely &quot;[typename]&quot;</span>
        <span class="c">///</span><span class="c"> If there is no mapping, then it returns null.</span>
        <span class="c">///</span><span class="c"> If the string to convert is null or empty then the function returns &quot;[object]&quot; as the default typeless type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">typeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The typename string to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The equivalent PowerShell representation of that type.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="ec9a4e138461cd43" href="../R/ec9a4e138461cd43.html" target="n" data-glyph="72,1" class="i method">ConvertTypeNameToPSTypeName</a>(<b>string</b> <span id="r207 rd" class="r207 r">typeName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r207 r">typeName</span>))
            {
                <b>return</b> <span class="s">&quot;[object]&quot;</span>;
            }
 
            <b>string</b> <span id="r208 rd" class="r208 r">mappedType</span>;
            <b>if</b> (<a href="#93bb2cece8fa53fe" class="i field">s_nameMap</a>.<span class="i">TryGetValue</span>(<span class="r207 r">typeName</span>, <b>out</b> <span class="r208 r">mappedType</span>))
            {
                <b>return</b> (<span class="s">&#39;[&#39;</span> + <span class="r208 r">mappedType</span> + <span class="s">&#39;]&#39;</span>);
            }
 
            <span class="c">// Then check dot net types</span>
            <span class="i">Type</span> <span id="r209 rd" class="r209 r">dotNetType</span>;
            <b>if</b> (<a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#3fb063578567b37c" class="i method">TryResolveType</a>(<span class="r207 r">typeName</span>, <b>out</b> <span class="r209 r">dotNetType</span>))
            {
                <span class="c">// Pass through the canonicalize type name we get back from the type converter...</span>
                <b>return</b> <span class="s">&#39;[&#39;</span> + <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<b>string</b>&gt;(<span class="r209 r">dotNetType</span>) + <span class="s">&#39;]&#39;</span>;
            }
 
            <span class="c">// No mapping is found, return null</span>
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">//</span>
        <span class="c">// CIM name string to .NET namestring mapping table</span>
        <span class="c">// (Considered using the MI routines but they didn&#39;t do quite the right thing.</span>
        <span class="c">//</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="93bb2cece8fa53fe" href="../R/93bb2cece8fa53fe.html" target="n" data-glyph="46,1" class="i field">s_nameMap</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) {
            { <span class="s">&quot;SInt8&quot;</span>,          <span class="s">&quot;SByte&quot;</span> },
            { <span class="s">&quot;UInt8&quot;</span>,          <span class="s">&quot;Byte&quot;</span> },
            { <span class="s">&quot;SInt16&quot;</span>,         <span class="s">&quot;Int16&quot;</span> },
            { <span class="s">&quot;UInt16&quot;</span>,         <span class="s">&quot;UInt16&quot;</span> },
            { <span class="s">&quot;SInt32&quot;</span>,         <span class="s">&quot;Int32&quot;</span> },
            { <span class="s">&quot;UInt32&quot;</span>,         <span class="s">&quot;UInt32&quot;</span> },
            { <span class="s">&quot;SInt64&quot;</span>,         <span class="s">&quot;Int64&quot;</span> },
            { <span class="s">&quot;UInt64&quot;</span>,         <span class="s">&quot;UInt64&quot;</span> },
            { <span class="s">&quot;Real32&quot;</span>,         <span class="s">&quot;Single&quot;</span> },
            { <span class="s">&quot;Real64&quot;</span>,         <span class="s">&quot;double&quot;</span> },
            { <span class="s">&quot;Boolean&quot;</span>,        <span class="s">&quot;bool&quot;</span> },
            { <span class="s">&quot;String&quot;</span>,         <span class="s">&quot;string&quot;</span> },
            { <span class="s">&quot;DateTime&quot;</span>,       <span class="s">&quot;DateTime&quot;</span> },
            { <span class="s">&quot;Reference&quot;</span>,      <span class="s">&quot;CimInstance&quot;</span> },
            { <span class="s">&quot;Char16&quot;</span>,         <span class="s">&quot;char&quot;</span> },
            { <span class="s">&quot;Instance&quot;</span>,       <span class="s">&quot;CimInstance&quot;</span> },
            { <span class="s">&quot;BooleanArray&quot;</span>,   <span class="s">&quot;bool[]&quot;</span> },
            { <span class="s">&quot;UInt8Array&quot;</span>,     <span class="s">&quot;byte[]&quot;</span> },
            { <span class="s">&quot;SInt8Array&quot;</span>,     <span class="s">&quot;Sbyte[]&quot;</span> },
            { <span class="s">&quot;UInt16Array&quot;</span>,    <span class="s">&quot;UInt16[]&quot;</span> },
            { <span class="s">&quot;SInt16Array&quot;</span>,    <span class="s">&quot;Int16[]&quot;</span> },
            { <span class="s">&quot;UInt32Array&quot;</span>,    <span class="s">&quot;UInt32[]&quot;</span> },
            { <span class="s">&quot;SInt32Array&quot;</span>,    <span class="s">&quot;Int32[]&quot;</span> },
            { <span class="s">&quot;UInt64Array&quot;</span>,    <span class="s">&quot;UInt64[]&quot;</span> },
            { <span class="s">&quot;SInt64Array&quot;</span>,    <span class="s">&quot;Int64[]&quot;</span> },
            { <span class="s">&quot;Real32Array&quot;</span>,    <span class="s">&quot;Single[]&quot;</span> },
            { <span class="s">&quot;Real64Array&quot;</span>,    <span class="s">&quot;double[]&quot;</span> },
            { <span class="s">&quot;Char16Array&quot;</span>,    <span class="s">&quot;char[]&quot;</span> },
            { <span class="s">&quot;DateTimeArray&quot;</span>,  <span class="s">&quot;DateTime[]&quot;</span> },
            { <span class="s">&quot;StringArray&quot;</span>,    <span class="s">&quot;string[]&quot;</span> },
            { <span class="s">&quot;ReferenceArray&quot;</span>, <span class="s">&quot;CimInstance[]&quot;</span> },
            { <span class="s">&quot;InstanceArray&quot;</span>,  <span class="s">&quot;CimInstance[]&quot;</span> },
            { <span class="s">&quot;Unknown&quot;</span>,        <span class="s">&quot;UnknownType&quot;</span> },
        };
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public type conversion
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts valueToConvert to resultType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A null valueToConvert can be converted to :</span>
        <span class="c">///</span><span class="c">     string          -   returns &quot;&quot;</span>
        <span class="c">///</span><span class="c">     char            -   returns &#39;\0&#39;</span>
        <span class="c">///</span><span class="c">     numeric types   -   returns 0 converted to the appropriate type</span>
        <span class="c">///</span><span class="c">     boolean         -   returns LanguagePrimitives.IsTrue(null)</span>
        <span class="c">///</span><span class="c">     PSObject       -   returns new PSObject())</span>
        <span class="c">///</span><span class="c">     array           -   returns an array with null in array[0]</span>
        <span class="c">///</span><span class="c">     non value types -   returns null</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The following conversions are considered language standard and cannot be customized:</span>
        <span class="c">///</span><span class="c">     - from derived to base class            -   returns valueToConvert intact</span>
        <span class="c">///</span><span class="c">     - to PSObject                          -   returns PSObject.AsPSObject(valueToConvert)</span>
        <span class="c">///</span><span class="c">     - to void                               -   returns AutomationNull.Value</span>
        <span class="c">///</span><span class="c">     - from array/IEnumerable to array       -   tries to convert array/IEnumerable elements</span>
        <span class="c">///</span><span class="c">     - from object of type X to array of X   -   returns an array with object as its only element</span>
        <span class="c">///</span><span class="c">     - to bool                               -   returns LanguagePrimitives.IsTrue(valueToConvert)</span>
        <span class="c">///</span><span class="c">     - to string                             -   returns a string representation of the object.</span>
        <span class="c">///</span><span class="c">                                                 In the particular case of a number to string,</span>
        <span class="c">///</span><span class="c">                                                 the conversion is culture invariant.</span>
        <span class="c">///</span><span class="c">     - from IDictionary to Hashtable         -   uses the Hashtable constructor</span>
        <span class="c">///</span><span class="c">     - to XmlDocument                        -   creates a new XmlDocument with the</span>
        <span class="c">///</span><span class="c">                                                 string representation of valueToConvert</span>
        <span class="c">///</span><span class="c">     - from string to char[]                 -   returns ((string)valueToConvert).ToCharArray()</span>
        <span class="c">///</span><span class="c">     - from string to RegEx                  -   creates a new RegEx with the string</span>
        <span class="c">///</span><span class="c">     - from string to Type                   -   looks up the type in the minishell&#39;s assemblies</span>
        <span class="c">///</span><span class="c">     - from empty string to numeric          -   returns 0 converted to the appropriate type</span>
        <span class="c">///</span><span class="c">     - from string to numeric                -   returns a culture invariant conversion</span>
        <span class="c">///</span><span class="c">     - from ScriptBlock to Delegate          -   returns a delegate wrapping that scriptblock.</span>
        <span class="c">///</span><span class="c">     - from Integer to Enumeration           -   Uses Enum.ToObject</span>
        <span class="c">///</span><span class="c">     - to WMI                                -   Instantiate a WMI instance using</span>
        <span class="c">///</span><span class="c">                                                 System.Management.ManagementObject</span>
        <span class="c">///</span><span class="c">     - to WMISearcher                        -   returns objects from running WQL query with the</span>
        <span class="c">///</span><span class="c">                                                 string representation of valueToConvert. The</span>
        <span class="c">///</span><span class="c">                                                 query is run using ManagementObjectSearcher Class.</span>
        <span class="c">///</span><span class="c">     - to WMIClass                           -   returns ManagementClass represented by the</span>
        <span class="c">///</span><span class="c">                                                 string representation of valueToConvert.</span>
        <span class="c">///</span><span class="c">     - to ADSI                               -   returns DirectoryEntry represented by the</span>
        <span class="c">///</span><span class="c">                                                 string representation of valueToConvert.</span>
        <span class="c">///</span><span class="c">     - to ADSISearcher                       -   return DirectorySearcher represented by the</span>
        <span class="c">///</span><span class="c">                                                 string representation of valueToConvert.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If none of the cases above is true, the following is considered in order:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">    1) TypeConverter and PSTypeConverter</span>
        <span class="c">///</span><span class="c">    2) the Parse methods if the valueToConvert is a string</span>
        <span class="c">///</span><span class="c">    3) Constructors in resultType that take one parameter with type valueToConvert.GetType()</span>
        <span class="c">///</span><span class="c">    4) Implicit and explicit cast operators</span>
        <span class="c">///</span><span class="c">    5) IConvertible</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">  If any operation above throws an exception, this exception will be wrapped into a</span>
        <span class="c">///</span><span class="c">  PSInvalidCastException and thrown resulting in no further conversion attempt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r210 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to be converted and returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r211 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert valueToConvert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Converted value.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If resultType is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the conversion failed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static object</b> <a id="b143f4bf9fd6e220" href="../R/b143f4bf9fd6e220.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>(<b>object</b> <span id="r210 rd" class="r210 r">valueToConvert</span>, <span class="i">Type</span> <span id="r211 rd" class="r211 r">resultType</span>)
        {
            <b>return</b> <span class="i">ConvertTo</span>(<span class="r210 r">valueToConvert</span>, <span class="r211 r">resultType</span>, <b>true</b>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts valueToConvert to resultType possibly considering formatProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A null valueToConvert can be converted to :</span>
        <span class="c">///</span><span class="c">     string          -   returns &quot;&quot;</span>
        <span class="c">///</span><span class="c">     char            -   returns &#39;\0&#39;</span>
        <span class="c">///</span><span class="c">     numeric types   -   returns 0 converted to the appropriate type</span>
        <span class="c">///</span><span class="c">     boolean         -   returns LanguagePrimitives.IsTrue(null)</span>
        <span class="c">///</span><span class="c">     PSObject       -   returns new PSObject())</span>
        <span class="c">///</span><span class="c">     array           -   returns an array with null in array[0]</span>
        <span class="c">///</span><span class="c">     non value types -   returns null</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The following conversions are considered language standard and cannot be customized:</span>
        <span class="c">///</span><span class="c">     - from derived to base class            -   returns valueToConvert intact</span>
        <span class="c">///</span><span class="c">     - to PSObject                          -   returns PSObject.AsPSObject(valueToConvert)</span>
        <span class="c">///</span><span class="c">     - to void                               -   returns AutomationNull.Value</span>
        <span class="c">///</span><span class="c">     - from array/IEnumerable to array       -   tries to convert array/IEnumerable elements</span>
        <span class="c">///</span><span class="c">     - from object of type X to array of X   -   returns an array with object as its only element</span>
        <span class="c">///</span><span class="c">     - to bool                               -   returns LanguagePrimitives.IsTrue(valueToConvert)</span>
        <span class="c">///</span><span class="c">     - to string                             -   returns a string representation of the object.</span>
        <span class="c">///</span><span class="c">                                                 In the particular case of a number to string,</span>
        <span class="c">///</span><span class="c">                                                 the conversion is culture invariant.</span>
        <span class="c">///</span><span class="c">     - from IDictionary to Hashtable         -   uses the Hashtable constructor</span>
        <span class="c">///</span><span class="c">     - to XmlDocument                        -   creates a new XmlDocument with the</span>
        <span class="c">///</span><span class="c">                                                 string representation of valueToConvert</span>
        <span class="c">///</span><span class="c">     - from string to char[]                 -   returns ((string)valueToConvert).ToCharArray()</span>
        <span class="c">///</span><span class="c">     - from string to RegEx                  -   creates a new RegEx with the string</span>
        <span class="c">///</span><span class="c">     - from string to Type                   -   looks up the type in the minishell&#39;s assemblies</span>
        <span class="c">///</span><span class="c">     - from empty string to numeric          -   returns 0 converted to the appropriate type</span>
        <span class="c">///</span><span class="c">     - from string to numeric                -   returns a culture invariant conversion</span>
        <span class="c">///</span><span class="c">     - from ScriptBlock to Delegate          -   returns a delegate wrapping that scriptblock.</span>
        <span class="c">///</span><span class="c">     - from Integer to Enumeration           -   Uses Enum.ToObject</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If none of the cases above is true, the following is considered in order:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">    1) TypeConverter and PSTypeConverter</span>
        <span class="c">///</span><span class="c">    2) the Parse methods if the valueToConvert is a string</span>
        <span class="c">///</span><span class="c">    3) Constructors in resultType that take one parameter with type valueToConvert.GetType()</span>
        <span class="c">///</span><span class="c">    4) Implicit and explicit cast operators</span>
        <span class="c">///</span><span class="c">    5) IConvertible</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">  If any operation above throws an exception, this exception will be wrapped into a</span>
        <span class="c">///</span><span class="c">  PSInvalidCastException and thrown resulting in no further conversion attempt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to be converted and returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r213 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert valueToConvert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r214 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">To be used in custom type conversions, to call parse and to call Convert.ChangeType.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Converted value.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If resultType is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the conversion failed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static object</b> <a id="0c97df7b75910bea" href="../R/0c97df7b75910bea.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>(<b>object</b> <span id="r212 rd" class="r212 r">valueToConvert</span>, <span class="i">Type</span> <span id="r213 rd" class="r213 r">resultType</span>, <span class="i">IFormatProvider</span> <span id="r214 rd" class="r214 r">formatProvider</span>)
        {
            <b>return</b> <a href="#01ef0df31c173865" class="i method">ConvertTo</a>(<span class="r212 r">valueToConvert</span>, <span class="r213 r">resultType</span>, <b>true</b>, <span class="r214 r">formatProvider</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts PSObject to resultType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r215 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to be converted and returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r216 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert psobject.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">recursion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates if inner properties have to be recursively converted.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r218 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">To be used in custom type conversions, to call parse and to call Convert.ChangeType.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r219 r">ignoreUnknownMembers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates if Unknown members in the psobject have to be ignored if the corresponding members in resultType do not exist.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Converted value.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static object</b> <a id="031b850807a55641" href="../R/031b850807a55641.html" target="n" data-glyph="72,1" class="i method">ConvertPSObjectToType</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r215 rd" class="r215 r">valueToConvert</span>, <span class="i">Type</span> <span id="r216 rd" class="r216 r">resultType</span>, <b>bool</b> <span id="r217 rd" class="r217 r">recursion</span>, <span class="i">IFormatProvider</span> <span id="r218 rd" class="r218 r">formatProvider</span>, <b>bool</b> <span id="r219 rd" class="r219 r">ignoreUnknownMembers</span>)
        {
            <b>if</b> (<span class="r215 r">valueToConvert</span> != <b>null</b>)
            {
                <span class="i">ConstructorInfo</span> <span id="r220 rd" class="r220 r">toConstructor</span> = <span class="r216 r">resultType</span>.<span class="i">GetConstructor</span>(<span class="i">Type</span>.<span class="i">EmptyTypes</span>);
                <a href="#550d2db25b155194" class="t t">ConvertViaNoArgumentConstructor</a> <span id="r221 rd" class="r221 r">noArgumentConstructorConverter</span> = <b>new</b> <a href="#2c6108280cdb13af" class="t constructor">ConvertViaNoArgumentConstructor</a>(<span class="r220 r">toConstructor</span>, <span class="r216 r">resultType</span>);
                <b>return</b> <span class="r221 r">noArgumentConstructorConverter</span>.<a href="#41e27f8d00ea4eea" class="i method">Convert</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r215 r">valueToConvert</span>), <span class="r216 r">resultType</span>, <span class="r217 r">recursion</span>, (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r215 r">valueToConvert</span>, <span class="r218 r">formatProvider</span>, <b>null</b>, <span class="r219 r">ignoreUnknownMembers</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generic convertto that simplifies working with workflow.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r222 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of object to return</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r223 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="r222 r t">T</span> <a id="8b9327b10b12742d" href="../R/8b9327b10b12742d.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>&lt;<span id="r222 rd t" class="r222 r t">T</span>&gt;(<b>object</b> <span id="r223 rd" class="r223 r">valueToConvert</span>)
        {
            <b>if</b> (<span class="r223 r">valueToConvert</span> <b>is</b> <span class="r222 r t">T</span> <span id="r224 rd" class="r224 r">value</span>)
            {
                <b>return</b> <span class="r224 r">value</span>;
            }
 
            <b>return</b> (<span class="r222 r t">T</span>)<span class="i">ConvertTo</span>(<span class="r223 r">valueToConvert</span>, <b>typeof</b>(<span class="r222 r t">T</span>), <b>true</b>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets result to valueToConvert converted to resultType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is a variant of ConvertTo that does not throw exceptions if the conversion fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r225 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to be converted and returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Result of the conversion. This is valid only if the return is true.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">False for conversion failure, true for success.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="0ba3f8cd03b35aee" href="../R/0ba3f8cd03b35aee.html" target="n" data-glyph="72,1" class="i method">TryConvertTo</a>&lt;<span id="r227 rd t" class="r227 r t">T</span>&gt;(<b>object</b> <span id="r225 rd" class="r225 r">valueToConvert</span>, <b>out</b> <span class="r227 r t">T</span> <span id="r226 rd" class="r226 r">result</span>)
        {
            <b>if</b> (<span class="r225 r">valueToConvert</span> <b>is</b> <span class="r227 r t">T</span> <span id="r228 rd" class="r228 r">value</span>)
            {
                <span class="r226 r">result</span> = <span class="r228 r">value</span>;
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <span class="i">TryConvertTo</span>(<span class="r225 r">valueToConvert</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>out</b> <span class="r226 r">result</span>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets result to valueToConvert converted to resultType considering formatProvider</span>
        <span class="c">///</span><span class="c"> for custom conversions, calling the Parse method and calling Convert.ChangeType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is a variant of ConvertTo that does not throw exceptions if the conversion fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to be converted and returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r230 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Governing conversion of types.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r231 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Result of the conversion. This is valid only if the return is true.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">False for conversion failure, true for success.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="d0c1c0d8285bfebe" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TryConvertTo</a>&lt;<span id="r232 rd t" class="r232 r t">T</span>&gt;(<b>object</b> <span id="r229 rd" class="r229 r">valueToConvert</span>, <span class="i">IFormatProvider</span> <span id="r230 rd" class="r230 r">formatProvider</span>, <b>out</b> <span class="r232 r t">T</span> <span id="r231 rd" class="r231 r">result</span>)
        {
            <span class="r231 r">result</span> = <b>default</b>(<span class="r232 r t">T</span>);
 
            <b>if</b> (<span class="i">TryConvertTo</span>(<span class="r229 r">valueToConvert</span>, <b>typeof</b>(<span class="r232 r t">T</span>), <span class="r230 r">formatProvider</span>, <b>out object</b> <span id="r233 rd" class="r233 r">res</span>))
            {
                <span class="r231 r">result</span> = (<span class="r232 r t">T</span>)<span class="r233 r">res</span>;
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets result to valueToConvert converted to resultType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is a variant of ConvertTo that does not throw exceptions if the conversion fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r234 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to be converted and returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r235 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert valueToConvert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r236 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Result of the conversion. This is valid only if the return is true.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">False for conversion failure, true for success.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="12cdec88face783f" href="../R/12cdec88face783f.html" target="n" data-glyph="72,1" class="i method">TryConvertTo</a>(<b>object</b> <span id="r234 rd" class="r234 r">valueToConvert</span>, <span class="i">Type</span> <span id="r235 rd" class="r235 r">resultType</span>, <b>out object</b> <span id="r236 rd" class="r236 r">result</span>)
        {
            <b>return</b> <span class="i">TryConvertTo</span>(<span class="r234 r">valueToConvert</span>, <span class="r235 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>out</b> <span class="r236 r">result</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets result to valueToConvert converted to resultType considering formatProvider</span>
        <span class="c">///</span><span class="c"> for custom conversions, calling the Parse method and calling Convert.ChangeType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is a variant of ConvertTo that does not throw exceptions if the conversion fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r237 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to be converted and returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r238 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type to convert valueToConvert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r239 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Governing conversion of types.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r240 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Result of the conversion. This is valid only if the return is true.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">False for conversion failure, true for success.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="55c389faea5ed00f" href="../R/55c389faea5ed00f.html" target="n" data-glyph="72,1" class="i method">TryConvertTo</a>(<b>object</b> <span id="r237 rd" class="r237 r">valueToConvert</span>, <span class="i">Type</span> <span id="r238 rd" class="r238 r">resultType</span>, <span class="i">IFormatProvider</span> <span id="r239 rd" class="r239 r">formatProvider</span>, <b>out object</b> <span id="r240 rd" class="r240 r">result</span>)
        {
            <span class="r240 r">result</span> = <b>null</b>;
            <b>try</b>
            {
                <b>using</b> (<a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">TraceScope</span>(<span class="s">&quot;Converting \&quot;{0}\&quot; to \&quot;{1}\&quot;.&quot;</span>, <span class="r237 r">valueToConvert</span>, <span class="r238 r">resultType</span>))
                {
                    <b>if</b> (<span class="r238 r">resultType</span> == <b>null</b>)
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <a href="#4cbbe0ec8ab6946f" class="k">var</a> <span id="r241 rd" class="r241 r">conversion</span> = <a href="#2b600779afb85e55" class="i method">FigureConversion</a>(<span class="r237 r">valueToConvert</span>, <span class="r238 r">resultType</span>, <b>out bool</b> <span id="r242 rd" class="r242 r">debase</span>);
                    <b>if</b> (<span class="r241 r">conversion</span>.<a href="#fcaf7d7aa628a092" class="i property">Rank</a> == <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>)
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <span class="r240 r">result</span> = <span class="r241 r">conversion</span>.<span class="i">Invoke</span>(
                        <span class="r242 r">debase</span> ? <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r237 r">valueToConvert</span>) : <span class="r237 r">valueToConvert</span>,
                        <span class="r238 r">resultType</span>,
                        <span class="i">recurse</span>: <b>true</b>,
                        <span class="r242 r">debase</span> ? (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r237 r">valueToConvert</span> : <b>null</b>,
                        <span class="r239 r">formatProvider</span>,
                        <span class="i">backupTable</span>: <b>null</b>);
 
                    <b>return</b> <b>true</b>;
                }
            }
            <b>catch</b> (<span class="i">InvalidCastException</span>)
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public type conversion
 
        <b>internal class</b> <a id="76f5a4a98338ce6f" href="../R/76f5a4a98338ce6f.html" target="n" data-glyph="2,1" class="t t"><span id="66f837c5e04c1231">EnumMultipleTypeConverter</span></a> : <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>
        {
            <b>public override object</b> <a id="6e66d050101bda53" href="../R/6e66d050101bda53.html" target="n" data-glyph="72,2" class="i method">ConvertFrom</a>(<b>object</b> <span id="r243 rd" class="r243 r">sourceValue</span>, <span class="i">Type</span> <span id="r244 rd" class="r244 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r245 rd" class="r245 r">formatProvider</span>, <b>bool</b> <span id="r246 rd" class="r246 r">ignoreCase</span>)
            {
                <b>return</b> <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#cb624f011c81b919" class="i method">BaseConvertFrom</a>(<span class="r243 r">sourceValue</span>, <span class="r244 r">destinationType</span>, <span class="r245 r">formatProvider</span>, <span class="r246 r">ignoreCase</span>, <b>true</b>);
            }
        }
 
        <b>internal class</b> <a id="ca4f496a5bed30f5" href="../R/ca4f496a5bed30f5.html" target="n" data-glyph="2,1" class="t t"><span id="8d7d6e3565aed28e">EnumSingleTypeConverter</span></a> : <a href="#89a33fbb336451a1" class="t t">PSTypeConverter</a>
        {
            <b>private sealed class</b> <a id="280d4f9440eb9c5c" href="../R/280d4f9440eb9c5c.html" target="n" data-glyph="4,2" class="t t">EnumHashEntry</a>
            {
                <b>internal</b> <a id="dbee2fcf52b6f60c" href="../R/../../0000000000.html" target="n" data-glyph="74,3" class="t constructor">EnumHashEntry</a>(<b>string</b>[] <span id="r247 rd" class="r247 r">names</span>, <span class="i">Array</span> <span id="r248 rd" class="r248 r">values</span>, <span class="i">UInt64</span> <span id="r249 rd" class="r249 r">allValues</span>, <b>bool</b> <span id="r250 rd" class="r250 r">hasNegativeValue</span>, <b>bool</b> <span id="r251 rd" class="r251 r">hasFlagsAttribute</span>)
                {
                    <a href="#280d4f9440eb9c5c" class="k">this</a>.<a href="#0f87f88b9efd37d1" class="i field">names</a> = <span class="r247 r">names</span>;
                    <a href="#280d4f9440eb9c5c" class="k">this</a>.<a href="#5364d07db16572a8" class="i field">values</a> = <span class="r248 r">values</span>;
                    <a href="#280d4f9440eb9c5c" class="k">this</a>.<a href="#4ba094cccd06406d" class="i field">allValues</a> = <span class="r249 r">allValues</span>;
                    <a href="#280d4f9440eb9c5c" class="k">this</a>.<a href="#741b81507bc14f6d" class="i field">hasNegativeValue</a> = <span class="r250 r">hasNegativeValue</span>;
                    <a href="#280d4f9440eb9c5c" class="k">this</a>.<a href="#20c1de3d1c95df1c" class="i field">hasFlagsAttribute</a> = <span class="r251 r">hasFlagsAttribute</span>;
                }
 
                <b>internal string</b>[] <a id="0f87f88b9efd37d1" href="../R/0f87f88b9efd37d1.html" target="n" data-glyph="44,3" class="i field">names</a>;
                <b>internal</b> <span class="i">Array</span> <a id="5364d07db16572a8" href="../R/5364d07db16572a8.html" target="n" data-glyph="44,3" class="i field">values</a>;
                <b>internal</b> <span class="i">UInt64</span> <a id="4ba094cccd06406d" href="../R/4ba094cccd06406d.html" target="n" data-glyph="44,3" class="i field">allValues</a>;
                <b>internal bool</b> <a id="741b81507bc14f6d" href="../R/741b81507bc14f6d.html" target="n" data-glyph="44,3" class="i field">hasNegativeValue</a>;
                <b>internal bool</b> <a id="20c1de3d1c95df1c" href="../R/20c1de3d1c95df1c.html" target="n" data-glyph="44,3" class="i field">hasFlagsAttribute</a>;
            }
 
            <span class="c">// This static is thread safe based on the lock in GetEnumHashEntry</span>
            <span class="c">// It can be shared by Runspaces in different MiniShells</span>
            <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#280d4f9440eb9c5c" class="t t">EnumHashEntry</a>&gt; <a id="db0df2e688fc5fd7" href="../R/db0df2e688fc5fd7.html" target="n" data-glyph="46,2" class="i field">s_enumTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <a href="#280d4f9440eb9c5c" class="t t">EnumHashEntry</a>&gt;();
 
            <b>private const int</b> <a id="addb14861eccad3f" href="../R/addb14861eccad3f.html" target="n" data-glyph="10,2" class="i field">maxEnumTableSize</a> = 100;
 
            <b>private static</b> <a href="#280d4f9440eb9c5c" class="t t">EnumHashEntry</a> <a id="7d36d0af8107ef6a" href="../R/7d36d0af8107ef6a.html" target="n" data-glyph="76,2" class="i method">GetEnumHashEntry</a>(<span class="i">Type</span> <span id="r252 rd" class="r252 r">enumType</span>)
            {
                <b>lock</b> (<a href="#db0df2e688fc5fd7" class="i field">s_enumTable</a>)
                {
                    <a href="#280d4f9440eb9c5c" class="t t">EnumHashEntry</a> <span id="r253 rd" class="r253 r">returnValue</span>;
                    <b>if</b> (<a href="#db0df2e688fc5fd7" class="i field">s_enumTable</a>.<span class="i">TryGetValue</span>(<span class="r252 r">enumType</span>, <b>out</b> <span class="r253 r">returnValue</span>))
                    {
                        <b>return</b> <span class="r253 r">returnValue</span>;
                    }
 
                    <b>if</b> (<a href="#db0df2e688fc5fd7" class="i field">s_enumTable</a>.<span class="i">Count</span> == <a href="#addb14861eccad3f" class="i field">maxEnumTableSize</a>)
                    {
                        <a href="#db0df2e688fc5fd7" class="i field">s_enumTable</a>.<span class="i">Clear</span>();
                    }
 
                    <span class="i">UInt64</span> <span id="r254 rd" class="r254 r">allValues</span> = 0;
                    <b>bool</b> <span id="r255 rd" class="r255 r">hasNegativeValue</span> = <b>false</b>;
                    <span class="i">Array</span> <span id="r256 rd" class="r256 r">values</span> = <span class="i">Enum</span>.<span class="i">GetValues</span>(<span class="r252 r">enumType</span>);
 
                    <span class="c">// Type.GetTypeCode will return the integer type code for enumType</span>
                    <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#aabe01c3319c6528" class="i method">IsSignedInteger</a>(<span class="r252 r">enumType</span>.<a href="../utils/ExtensionMethods.cs.html#6941492779b390f9" class="i method">GetTypeCode</a>()))
                    {
                        <b>foreach</b> (<b>object</b> <span id="r257 rd" class="r257 r">value</span> <b>in</b> <span class="r256 r">values</span>)
                        {
                            <span class="i">Int64</span> <span id="r258 rd" class="r258 r">valueInt64</span> = <span class="i">Convert</span>.<span class="i">ToInt64</span>(<span class="r257 r">value</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>);
                            <span class="c">// A negative value cannot be flag</span>
                            <b>if</b> (<span class="r258 r">valueInt64</span> &lt; 0)
                            {
                                <span class="r255 r">hasNegativeValue</span> = <b>true</b>;
                                <b>break</b>;
                            }
 
                            <span class="c">// we know the value is not negative, so this conversion</span>
                            <span class="c">// always succeed</span>
                            <span class="r254 r">allValues</span> |= <span class="i">Convert</span>.<span class="i">ToUInt64</span>(<span class="r257 r">value</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>);
                        }
                    }
                    <b>else</b>
                    {
                        <b>foreach</b> (<b>object</b> <span id="r259 rd" class="r259 r">value</span> <b>in</b> <span class="r256 r">values</span>)
                        {
                            <span class="r254 r">allValues</span> |= <span class="i">Convert</span>.<span class="i">ToUInt64</span>(<span class="r259 r">value</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>);
                        }
                    }
 
                    <span class="c">// See if the [Flag] attribute is set on this type...</span>
                    <span class="c">// MemberInfo.GetCustomAttributes returns IEnumerable&lt;Attribute&gt; in CoreCLR.</span>
                    <b>bool</b> <span id="r260 rd" class="r260 r">hasFlagsAttribute</span> = <span class="r252 r">enumType</span>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<span class="i">FlagsAttribute</span>), <b>false</b>).<span class="i">Length</span> &gt; 0;
 
                    <span class="r253 r">returnValue</span> = <b>new</b> <span class="t">EnumHashEntry</span>(<span class="i">Enum</span>.<span class="i">GetNames</span>(<span class="r252 r">enumType</span>), <span class="r256 r">values</span>, <span class="r254 r">allValues</span>, <span class="r255 r">hasNegativeValue</span>, <span class="r260 r">hasFlagsAttribute</span>);
                    <a href="#db0df2e688fc5fd7" class="i field">s_enumTable</a>.<span class="i">Add</span>(<span class="r252 r">enumType</span>, <span class="r253 r">returnValue</span>);
                    <b>return</b> <span class="r253 r">returnValue</span>;
                }
            }
 
            <b>public override bool</b> <a id="414d6f20b7adb184" href="../R/414d6f20b7adb184.html" target="n" data-glyph="72,2" class="i method">CanConvertFrom</a>(<b>object</b> <span id="r261 rd" class="r261 r">sourceValue</span>, <span class="i">Type</span> <span id="r262 rd" class="r262 r">destinationType</span>)
            {
                <b>return</b> <span class="r261 r">sourceValue</span> <b>is string</b> &amp;&amp; <span class="r262 r">destinationType</span>.<span class="i">IsEnum</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Checks if the enumValue is defined or not in enumType.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r263 r">enumType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Some enumeration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r264 r">enumValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Supposed to be an integer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>private static bool</b> <a id="c8aad83162917f4e" href="../R/c8aad83162917f4e.html" target="n" data-glyph="76,2" class="i method">IsDefinedEnum</a>(<b>object</b> <span id="r264 rd" class="r264 r">enumValue</span>, <span class="i">Type</span> <span id="r263 rd" class="r263 r">enumType</span>)
            {
                <b>bool</b> <span id="r265 rd" class="r265 r">isDefined</span>;
                <b>do</b>
                {
                    <b>if</b> (<span class="r264 r">enumValue</span> == <b>null</b>)
                    {
                        <span class="r265 r">isDefined</span> = <b>false</b>;
                        <b>break</b>;
                    }
 
                    <a href="#280d4f9440eb9c5c" class="t t">EnumHashEntry</a> <span id="r266 rd" class="r266 r">enumHashEntry</span> = <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#7d36d0af8107ef6a" class="i method">GetEnumHashEntry</a>(<span class="r263 r">enumType</span>);
 
                    <span class="c">// An enumeration with a negative value should not be treated as flags</span>
                    <span class="c">// so IsValueFlagDefined cannot determine the result, and as far as it knows,</span>
                    <span class="c">// it is defined.</span>
                    <b>if</b> (<span class="r266 r">enumHashEntry</span>.<a href="#741b81507bc14f6d" class="i field">hasNegativeValue</a>)
                    {
                        <span class="r265 r">isDefined</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <span class="c">// Type.GetTypeCode will return the integer type code for enumValue.GetType()</span>
                    <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#aabe01c3319c6528" class="i method">IsSignedInteger</a>(<span class="r264 r">enumValue</span>.<span class="i">GetType</span>().<span class="i">GetTypeCode</span>()))
                    {
                        <span class="i">Int64</span> <span id="r267 rd" class="r267 r">enumValueInt64</span> = <span class="i">Convert</span>.<span class="i">ToInt64</span>(<span class="r264 r">enumValue</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>);
 
                        <span class="c">// A negative value cannot be flag, so we return false</span>
                        <b>if</b> (<span class="r267 r">enumValueInt64</span> &lt; 0)
                        {
                            <span class="r265 r">isDefined</span> = <b>false</b>;
                            <b>break</b>;
                        }
                    }
 
                    <span class="c">// the if above, guarantees that even if it is an Int64 it is &gt; 0</span>
                    <span class="c">// so the conversion should always work.</span>
                    <span class="i">UInt64</span> <span id="r268 rd" class="r268 r">enumValueUInt64</span> = <span class="i">Convert</span>.<span class="i">ToUInt64</span>(<span class="r264 r">enumValue</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>);
 
                    <b>if</b> (<span class="r266 r">enumHashEntry</span>.<a href="#20c1de3d1c95df1c" class="i field">hasFlagsAttribute</a>)
                    {
                        <span class="c">// This expression will result in a &quot;1 bit&quot; for bits that are</span>
                        <span class="c">// set in enumValueInt64 but not set in enumHashEntry.allValues,</span>
                        <span class="c">// and a &quot;0 bit&quot; otherwise. Any &quot;bit 1&quot; in the result, indicates this is not defined.</span>
                        <span class="r265 r">isDefined</span> = ((<span class="r268 r">enumValueUInt64</span> | <span class="r266 r">enumHashEntry</span>.<a href="#4ba094cccd06406d" class="i field">allValues</a>) ^ <span class="r266 r">enumHashEntry</span>.<a href="#4ba094cccd06406d" class="i field">allValues</a>) == 0;
                    }
                    <b>else</b>
                    {
                        <span class="c">// If flags is not set, then see if this value is in the list</span>
                        <span class="c">// of valid values.</span>
                        <b>if</b> (<span class="i">Array</span>.<span class="i">IndexOf</span>(<span class="r266 r">enumHashEntry</span>.<a href="#5364d07db16572a8" class="i field">values</a>, <span class="r264 r">enumValue</span>) &gt;= 0)
                            <span class="r265 r">isDefined</span> = <b>true</b>;
                        <b>else</b>
                            <span class="r265 r">isDefined</span> = <b>false</b>;
                    }
                } <b>while</b> (<b>false</b>);
 
                <b>return</b> <span class="r265 r">isDefined</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Throws if the enumType enumeration has no negative values, but the enumValue is not</span>
            <span class="c">///</span><span class="c"> defined in enumType.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r269 r">enumType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Some enumeration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r270 r">enumValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Supposed to be an integer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r271 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error id to be used when throwing an exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal static void</b> <a id="ca84e339407258de" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="i method">ThrowForUndefinedEnum</a>(<b>string</b> <span id="r271 rd" class="r271 r">errorId</span>, <b>object</b> <span id="r270 rd" class="r270 r">enumValue</span>, <span class="i">Type</span> <span id="r269 rd" class="r269 r">enumType</span>)
            {
                <a href="#e14dda662bd93ed6" class="i method">ThrowForUndefinedEnum</a>(<span class="r271 r">errorId</span>, <span class="r270 r">enumValue</span>, <span class="r270 r">enumValue</span>, <span class="r269 r">enumType</span>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Throws if the enumType enumeration has no negative values, but the enumValue is not</span>
            <span class="c">///</span><span class="c"> defined in enumType.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r272 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error id to be used when throwing an exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r273 r">enumValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to validate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r274 r">valueToUseToThrow</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to use while throwing an exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r275 r">enumType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The enum type to validate the enumValue with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r274 r">valueToUseToThrow</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is used by those callers who want the exception</span>
            <span class="c">///</span><span class="c"> to contain a different value than the one that is validated.</span>
            <span class="c">///</span><span class="c"> This will enable callers to take different forms of input -&gt; convert to enum using</span>
            <span class="c">///</span><span class="c"> Enum.Object -&gt; then validate using this method.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <b>internal static void</b> <a id="e14dda662bd93ed6" href="../R/e14dda662bd93ed6.html" target="n" data-glyph="74,2" class="i method">ThrowForUndefinedEnum</a>(<b>string</b> <span id="r272 rd" class="r272 r">errorId</span>, <b>object</b> <span id="r273 rd" class="r273 r">enumValue</span>, <b>object</b> <span id="r274 rd" class="r274 r">valueToUseToThrow</span>, <span class="i">Type</span> <span id="r275 rd" class="r275 r">enumType</span>)
            {
                <b>if</b> (!<a href="#c8aad83162917f4e" class="i method">IsDefinedEnum</a>(<span class="r273 r">enumValue</span>, <span class="r275 r">enumType</span>))
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Value {0} is not defined in the Enum {1}.&quot;</span>, <span class="r274 r">valueToUseToThrow</span>, <span class="r275 r">enumType</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="r272 r">errorId</span>, <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionEnumerationNoValue</span>,
                        <span class="r274 r">valueToUseToThrow</span>, <span class="r275 r">enumType</span>, <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#7e68d3d58478ec8d" class="i method">EnumValues</a>(<span class="r275 r">enumType</span>));
                }
            }
 
            <b>internal static string</b> <a id="7e68d3d58478ec8d" href="../R/7e68d3d58478ec8d.html" target="n" data-glyph="74,2" class="i method">EnumValues</a>(<span class="i">Type</span> <span id="r276 rd" class="r276 r">enumType</span>)
            {
                <a href="#280d4f9440eb9c5c" class="t t">EnumHashEntry</a> <span id="r277 rd" class="r277 r">enumHashEntry</span> = <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#7d36d0af8107ef6a" class="i method">GetEnumHashEntry</a>(<span class="r276 r">enumType</span>);
                <b>return</b> <b>string</b>.<span class="i">Join</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>.<span class="i">TextInfo</span>.<span class="i">ListSeparator</span>, <span class="r277 r">enumHashEntry</span>.<a href="#0f87f88b9efd37d1" class="i field">names</a>);
            }
 
            <b>public override object</b> <a id="deb20af2b91393ca" href="../R/deb20af2b91393ca.html" target="n" data-glyph="72,2" class="i method">ConvertFrom</a>(<b>object</b> <span id="r278 rd" class="r278 r">sourceValue</span>, <span class="i">Type</span> <span id="r279 rd" class="r279 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r280 rd" class="r280 r">formatProvider</span>, <b>bool</b> <span id="r281 rd" class="r281 r">ignoreCase</span>)
            {
                <b>return</b> <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#cb624f011c81b919" class="i method">BaseConvertFrom</a>(<span class="r278 r">sourceValue</span>, <span class="r279 r">destinationType</span>, <span class="r280 r">formatProvider</span>, <span class="r281 r">ignoreCase</span>, <b>false</b>);
            }
 
            <b>protected static object</b> <a id="cb624f011c81b919" href="../R/cb624f011c81b919.html" target="n" data-glyph="75,2" class="i method">BaseConvertFrom</a>(<b>object</b> <span id="r282 rd" class="r282 r">sourceValue</span>, <span class="i">Type</span> <span id="r283 rd" class="r283 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r284 rd" class="r284 r">formatProvider</span>, <b>bool</b> <span id="r285 rd" class="r285 r">ignoreCase</span>, <b>bool</b> <span id="r286 rd" class="r286 r">multipleValues</span>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r282 r">sourceValue</span> != <b>null</b>, <span class="s">&quot;the type converter has a special case for null source values&quot;</span>);
                <b>if</b> (!(<span class="r282 r">sourceValue</span> <b>is string</b> <span id="r287 rd" class="r287 r">sourceValueString</span>))
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastEnumFromTypeNotAString&quot;</span>, <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>,
                        <span class="r282 r">sourceValue</span>, <a href="#bab300d080805cd3" class="i method">ObjectToTypeNameString</a>(<span class="r282 r">sourceValue</span>), <span class="r283 r">destinationType</span>);
                }
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r283 r">destinationType</span>.<span class="i">IsEnum</span>, <span class="s">&quot;EnumSingleTypeConverter is only applied to enumerations&quot;</span>);
                <b>if</b> (<span class="r287 r">sourceValueString</span>.<span class="i">Length</span> == 0)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastEnumFromEmptyString&quot;</span>, <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>,
                        <span class="r282 r">sourceValue</span>, <a href="#bab300d080805cd3" class="i method">ObjectToTypeNameString</a>(<span class="r282 r">sourceValue</span>), <span class="r283 r">destinationType</span>);
                }
 
                <span class="r287 r">sourceValueString</span> = <span class="r287 r">sourceValueString</span>.<span class="i">Trim</span>();
                <b>if</b> (<span class="r287 r">sourceValueString</span>.<span class="i">Length</span> == 0)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidEnumCastFromEmptyStringAfterTrim&quot;</span>, <b>null</b>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>,
                        <span class="r282 r">sourceValue</span>, <a href="#bab300d080805cd3" class="i method">ObjectToTypeNameString</a>(<span class="r282 r">sourceValue</span>), <span class="r283 r">destinationType</span>);
                }
 
                <b>if</b> (<b>char</b>.<span class="i">IsDigit</span>(<span class="r287 r">sourceValueString</span>[0]) || <span class="r287 r">sourceValueString</span>[0] == <span class="s">&#39;+&#39;</span> || <span class="r287 r">sourceValueString</span>[0] == <span class="s">&#39;-&#39;</span>)
                {
                    <span class="i">Type</span> <span id="r288 rd" class="r288 r">underlyingType</span> = <span class="i">Enum</span>.<span class="i">GetUnderlyingType</span>(<span class="r283 r">destinationType</span>);
                    <b>try</b>
                    {
                        <b>object</b> <span id="r289 rd" class="r289 r">result</span> = <span class="i">Enum</span>.<span class="i">ToObject</span>(<span class="r283 r">destinationType</span>, <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r287 r">sourceValueString</span>, <span class="r288 r">underlyingType</span>, <span class="r284 r">formatProvider</span>));
                        <a href="#e14dda662bd93ed6" class="i method">ThrowForUndefinedEnum</a>(<span class="s">&quot;UndefinedInEnumSingleTypeConverter&quot;</span>, <span class="r289 r">result</span>, <span class="r287 r">sourceValueString</span>, <span class="r283 r">destinationType</span>);
                        <b>return</b> <span class="r289 r">result</span>;
                    }
                    <b>catch</b> (<span class="i">Exception</span>) <span class="c">// Enum.ToObject and Convert.ChangeType might throw unadvertised exceptions</span>
                    {
                        <span class="c">// we still want to try non numeric match</span>
                    }
                }
 
                <b>string</b>[] <span id="r290 rd" class="r290 r">sourceValueEntries</span>;
                <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>[] <span id="r291 rd" class="r291 r">fromValuePatterns</span>;
                <b>if</b> (!<span class="r286 r">multipleValues</span>)
                {
                    <b>if</b> (<span class="r287 r">sourceValueString</span>.<span class="i">Contains</span>(<span class="s">&#39;,&#39;</span>))
                    {
                        <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastEnumCommaAndNoFlags&quot;</span>, <b>null</b>,
                            <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionEnumerationNoFlagAndComma</span>,
                            <span class="r282 r">sourceValue</span>, <span class="r283 r">destinationType</span>);
                    }
 
                    <span class="r290 r">sourceValueEntries</span> = <b>new</b> <b>string</b>[] { <span class="r287 r">sourceValueString</span> };
                    <span class="r291 r">fromValuePatterns</span> = <b>new</b> <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>[1];
                    <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r287 r">sourceValueString</span>))
                    {
                        <span class="r291 r">fromValuePatterns</span>[0] = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r287 r">sourceValueString</span>, <span class="r285 r">ignoreCase</span> ? <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a> : <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#b202e40981b139f5" class="i field">None</a>);
                    }
                    <b>else</b>
                    {
                        <span class="r291 r">fromValuePatterns</span>[0] = <b>null</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="r290 r">sourceValueEntries</span> = <span class="r287 r">sourceValueString</span>.<span class="i">Split</span>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="Utils.cs.html#dd38bba5cad3f99e" class="i field">Comma</a>);
                    <span class="r291 r">fromValuePatterns</span> = <b>new</b> <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>[<span class="r290 r">sourceValueEntries</span>.<span class="i">Length</span>];
                    <b>for</b> (<b>int</b> <span id="r292 rd" class="r292 r">i</span> = 0; <span class="r292 r">i</span> &lt; <span class="r290 r">sourceValueEntries</span>.<span class="i">Length</span>; <span class="r292 r">i</span>++)
                    {
                        <b>string</b> <span id="r293 rd" class="r293 r">sourceValueEntry</span> = <span class="r290 r">sourceValueEntries</span>[<span class="r292 r">i</span>];
                        <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r293 r">sourceValueEntry</span>))
                        {
                            <span class="r291 r">fromValuePatterns</span>[<span class="r292 r">i</span>] = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r293 r">sourceValueEntry</span>,
                                <span class="r285 r">ignoreCase</span> ? <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a> : <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#b202e40981b139f5" class="i field">None</a>);
                        }
                        <b>else</b>
                        {
                            <span class="r291 r">fromValuePatterns</span>[<span class="r292 r">i</span>] = <b>null</b>;
                        }
                    }
                }
 
                <a href="#280d4f9440eb9c5c" class="t t">EnumHashEntry</a> <span id="r294 rd" class="r294 r">enumHashEntry</span> = <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#7d36d0af8107ef6a" class="i method">GetEnumHashEntry</a>(<span class="r283 r">destinationType</span>);
                <b>string</b>[] <span id="r295 rd" class="r295 r">names</span> = <span class="r294 r">enumHashEntry</span>.<a href="#0f87f88b9efd37d1" class="i field">names</a>;
                <span class="i">Array</span> <span id="r296 rd" class="r296 r">values</span> = <span class="r294 r">enumHashEntry</span>.<a href="#5364d07db16572a8" class="i field">values</a>;
                <span class="i">UInt64</span> <span id="r297 rd" class="r297 r">returnUInt64</span> = 0;
                <span class="i">StringComparison</span> <span id="r298 rd" class="r298 r">ignoreCaseOpt</span>;
 
                <b>if</b> (<span class="r285 r">ignoreCase</span>)
                    <span class="r298 r">ignoreCaseOpt</span> = <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>;
                <b>else</b>
                    <span class="r298 r">ignoreCaseOpt</span> = <span class="i">StringComparison</span>.<span class="i">Ordinal</span>;
 
                <b>for</b> (<b>int</b> <span id="r299 rd" class="r299 r">i</span> = 0; <span class="r299 r">i</span> &lt; <span class="r290 r">sourceValueEntries</span>.<span class="i">Length</span>; <span class="r299 r">i</span>++)
                {
                    <b>string</b> <span id="r300 rd" class="r300 r">sourceValueEntry</span> = <span class="r290 r">sourceValueEntries</span>[<span class="r299 r">i</span>];
                    <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r301 rd" class="r301 r">fromValuePattern</span> = <span class="r291 r">fromValuePatterns</span>[<span class="r299 r">i</span>];
 
                    <b>bool</b> <span id="r302 rd" class="r302 r">foundOne</span> = <b>false</b>;
                    <b>for</b> (<b>int</b> <span id="r303 rd" class="r303 r">j</span> = 0; <span class="r303 r">j</span> &lt; <span class="r295 r">names</span>.<span class="i">Length</span>; <span class="r303 r">j</span>++)
                    {
                        <b>string</b> <span id="r304 rd" class="r304 r">name</span> = <span class="r295 r">names</span>[<span class="r303 r">j</span>];
 
                        <b>if</b> (<span class="r301 r">fromValuePattern</span> != <b>null</b>)
                        {
                            <b>if</b> (!<span class="r301 r">fromValuePattern</span>.<a href="regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r304 r">name</span>))
                                <b>continue</b>;
                        }
                        <b>else</b>
                        {
                            <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r300 r">sourceValueEntry</span>, <span class="r304 r">name</span>, <span class="r298 r">ignoreCaseOpt</span>))
                                <b>continue</b>;
                        }
 
                        <b>if</b> (!<span class="r286 r">multipleValues</span> &amp;&amp; <span class="r302 r">foundOne</span>)
                        {
                            <b>object</b> <span id="r305 rd" class="r305 r">firstValue</span> = <span class="i">Enum</span>.<span class="i">ToObject</span>(<span class="r283 r">destinationType</span>, <span class="r297 r">returnUInt64</span>);
                            <b>object</b> <span id="r306 rd" class="r306 r">secondValue</span> = <span class="i">Enum</span>.<span class="i">ToObject</span>(<span class="r283 r">destinationType</span>, <span class="i">Convert</span>.<span class="i">ToUInt64</span>(<span class="r296 r">values</span>.<span class="i">GetValue</span>(<span class="r299 r">i</span>), <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>));
                            <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastEnumTwoStringsFoundAndNoFlags&quot;</span>, <b>null</b>,
                                <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionEnumerationMoreThanOneValue</span>,
                                <span class="r282 r">sourceValue</span>, <span class="r283 r">destinationType</span>, <span class="r305 r">firstValue</span>, <span class="r306 r">secondValue</span>);
                        }
 
                        <span class="r302 r">foundOne</span> = <b>true</b>;
                        <span class="r297 r">returnUInt64</span> |= <span class="i">Convert</span>.<span class="i">ToUInt64</span>(<span class="r296 r">values</span>.<span class="i">GetValue</span>(<span class="r303 r">j</span>), <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>);
                    }
 
                    <b>if</b> (!<span class="r302 r">foundOne</span>)
                    {
                        <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastEnumStringNotFound&quot;</span>, <b>null</b>,
                            <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionEnumerationNoValue</span>,
                            <span class="r300 r">sourceValueEntry</span>, <span class="r283 r">destinationType</span>, <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#7e68d3d58478ec8d" class="i method">EnumValues</a>(<span class="r283 r">destinationType</span>));
                    }
                }
 
                <b>return</b> <span class="i">Enum</span>.<span class="i">ToObject</span>(<span class="r283 r">destinationType</span>, <span class="r297 r">returnUInt64</span>);
            }
 
            <b>public override bool</b> <a id="b37cfb02163697d9" href="../R/b37cfb02163697d9.html" target="n" data-glyph="72,2" class="i method">CanConvertTo</a>(<b>object</b> <span id="r307 rd" class="r307 r">sourceValue</span>, <span class="i">Type</span> <span id="r308 rd" class="r308 r">destinationType</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>public override object</b> <a id="c56a87635f54114a" href="../R/c56a87635f54114a.html" target="n" data-glyph="72,2" class="i method">ConvertTo</a>(<b>object</b> <span id="r309 rd" class="r309 r">sourceValue</span>, <span class="i">Type</span> <span id="r310 rd" class="r310 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r311 rd" class="r311 r">formatProvider</span>, <b>bool</b> <span id="r312 rd" class="r312 r">ignoreCase</span>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> There might be many cast operators in a Type A that take Type A. Each operator will have a</span>
        <span class="c">///</span><span class="c"> different return type. Because of that we cannot call GetMethod since it would cause a</span>
        <span class="c">///</span><span class="c"> AmbiguousMatchException. This auxiliary method calls GetMember to find the right method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r313 r">methodName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Either op_Explicit or op_Implicit, at the moment.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r314 r">targetType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type to look for an operator.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r315 r">originalType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of the only parameter the operator method should have.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r316 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Return type of the operator method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A cast operator method, or null if not found.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">MethodInfo</span> <a id="a4492631127e7293" href="../R/a4492631127e7293.html" target="n" data-glyph="76,1" class="i method">FindCastOperator</a>(<b>string</b> <span id="r313 rd" class="r313 r">methodName</span>, <span class="i">Type</span> <span id="r314 rd" class="r314 r">targetType</span>, <span class="i">Type</span> <span id="r315 rd" class="r315 r">originalType</span>, <span class="i">Type</span> <span id="r316 rd" class="r316 r">resultType</span>)
        {
            <b>using</b> (<a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(<span class="s">&quot;Looking for \&quot;{0}\&quot; cast operator.&quot;</span>, <span class="r313 r">methodName</span>))
            {
                <span class="c">// Get multiple matched Public &amp; Static methods</span>
                <b>const</b> <span class="i">BindingFlags</span> <span id="r317 rd" class="r317 r">flagsToUse</span> = <span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">InvokeMethod</span>;
                <b>var</b> <span id="r318 rd" class="r318 r">methods</span> = <span class="r314 r">targetType</span>.<span class="i">GetMember</span>(<span class="r313 r">methodName</span>, <span class="r317 r">flagsToUse</span>);
                <b>foreach</b> (<span class="i">MethodInfo</span> <span id="r319 rd" class="r319 r">method</span> <b>in</b> <span class="r318 r">methods</span>)
                {
                    <b>if</b> (!<span class="r316 r">resultType</span>.<span class="i">IsAssignableFrom</span>(<span class="r319 r">method</span>.<span class="i">ReturnType</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <span class="i n">System</span>.<span class="i">Reflection</span>.<span class="i">ParameterInfo</span>[] <span id="r320 rd" class="r320 r">parameters</span> = <span class="r319 r">method</span>.<span class="i">GetParameters</span>();
                    <b>if</b> (<span class="r320 r">parameters</span>.<span class="i">Length</span> != 1 || !<span class="r320 r">parameters</span>[0].<span class="i">ParameterType</span>.<span class="i">IsAssignableFrom</span>(<span class="r315 r">originalType</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Found \&quot;{0}\&quot; cast operator in type {1}.&quot;</span>, <span class="r313 r">methodName</span>, <span class="r314 r">targetType</span>.<span class="i">FullName</span>);
                    <b>return</b> <span class="r319 r">method</span>;
                }
 
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(<span class="s">&quot;Cast operator for \&quot;{0}\&quot; not found.&quot;</span>, <span class="r313 r">methodName</span>);
                <b>return</b> <b>null</b>;
            }
        }
 
        <b>private static object</b> <a id="d294f2eab38961dc" href="../R/d294f2eab38961dc.html" target="n" data-glyph="76,1" class="i method">ConvertNumericThroughDouble</a>(<b>object</b> <span id="r321 rd" class="r321 r">valueToConvert</span>, <span class="i">Type</span> <span id="r322 rd" class="r322 r">resultType</span>)
        {
            <b>using</b> (<a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(<span class="s">&quot;Numeric Conversion through System.Double.&quot;</span>))
            {
                <span class="c">// Eventual exceptions here are caught by the caller</span>
                <b>object</b> <span id="r323 rd" class="r323 r">intermediate</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r321 r">valueToConvert</span>, <b>typeof</b>(<b>double</b>),
                                                      <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">NumberFormat</span>);
                <b>return</b> <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r323 r">intermediate</span>, <span class="r322 r">resultType</span>,
                                                      <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">NumberFormat</span>);
            }
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
        <b>private static</b> <span class="i">ManagementObject</span> <a id="9111654acaea5955" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertToWMI</a>(<b>object</b> <span id="r324 rd" class="r324 r">valueToConvert</span>,
                                                     <span class="i">Type</span> <span id="r325 rd" class="r325 r">resultType</span>,
                                                     <b>bool</b> <span id="r326 rd" class="r326 r">recursion</span>,
                                                     <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r327 rd" class="r327 r">originalValueToConvert</span>,
                                                     <span class="i">IFormatProvider</span> <span id="r328 rd" class="r328 r">formatProvider</span>,
                                                     <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r329 rd" class="r329 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Standard type conversion to a ManagementObject.&quot;</span>);
 
            <b>string</b> <span id="r330 rd" class="r330 r">valueToConvertString</span>;
            <b>try</b>
            {
                <span class="r330 r">valueToConvertString</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e7ab15d0863aa3d6" class="i method">ToString</a>(<b>null</b>, <span class="r324 r">valueToConvert</span>, <span class="s">&quot;\n&quot;</span>, <b>null</b>, <b>null</b>, <b>true</b>, <b>true</b>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r331 rd" class="r331 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting value to string: {0}&quot;</span>, <span class="r331 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastGetStringToWMI&quot;</span>, <span class="r331 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionNoStringForConversion</span>,
                    <span class="r325 r">resultType</span>.<span class="i">ToString</span>(), <span class="r331 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>try</b>
            {
                <span class="i">ManagementObject</span> <span id="r332 rd" class="r332 r">wmiObject</span> = <b>new</b> <span class="i">ManagementObject</span>(<span class="r330 r">valueToConvertString</span>);
 
                <span class="c">// ManagementObject will not throw if path does not contain valid key</span>
                <b>if</b> (<span class="r332 r">wmiObject</span>.<span class="i">SystemProperties</span>[<span class="s">&quot;__CLASS&quot;</span>] == <b>null</b>)
                {
                    <b>string</b> <span id="r333 rd" class="r333 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidWMIPath</span>, <span class="r330 r">valueToConvertString</span>);
                    <b>throw</b> <b>new</b> <a href="ExtendedTypeSystemException.cs.html#c70223ba14d52141" class="t constructor">PSInvalidCastException</a>(<span class="r333 r">message</span>);
                }
 
                <b>return</b> <span class="r332 r">wmiObject</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r334 rd" class="r334 r">wmiObjectException</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception creating WMI object: \&quot;{0}\&quot;.&quot;</span>, <span class="r334 r">wmiObjectException</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastToWMI&quot;</span>, <span class="r334 r">wmiObjectException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r324 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r325 r">resultType</span>.<span class="i">ToString</span>(), <span class="r334 r">wmiObjectException</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <span class="i">ManagementObjectSearcher</span> <a id="1e91f1c49e960c45" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertToWMISearcher</a>(<b>object</b> <span id="r335 rd" class="r335 r">valueToConvert</span>,
                                                                     <span class="i">Type</span> <span id="r336 rd" class="r336 r">resultType</span>,
                                                                     <b>bool</b> <span id="r337 rd" class="r337 r">recursion</span>,
                                                                     <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r338 rd" class="r338 r">originalValueToConvert</span>,
                                                                     <span class="i">IFormatProvider</span> <span id="r339 rd" class="r339 r">formatProvider</span>,
                                                                     <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r340 rd" class="r340 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Standard type conversion to a collection of ManagementObjects.&quot;</span>);
            <b>string</b> <span id="r341 rd" class="r341 r">valueToConvertString</span>;
            <b>try</b>
            {
                <span class="r341 r">valueToConvertString</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e7ab15d0863aa3d6" class="i method">ToString</a>(<b>null</b>, <span class="r335 r">valueToConvert</span>, <span class="s">&quot;\n&quot;</span>, <b>null</b>, <b>null</b>, <b>true</b>, <b>true</b>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r342 rd" class="r342 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting value to string: {0}&quot;</span>, <span class="r342 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastGetStringToWMISearcher&quot;</span>, <span class="r342 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionNoStringForConversion</span>,
                    <span class="r336 r">resultType</span>.<span class="i">ToString</span>(), <span class="r342 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>try</b>
            {
                <span class="i">ManagementObjectSearcher</span> <span id="r343 rd" class="r343 r">objectSearcher</span> = <b>new</b> <span class="i">ManagementObjectSearcher</span>(<span class="r341 r">valueToConvertString</span>);
                <b>return</b> <span class="r343 r">objectSearcher</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r344 rd" class="r344 r">objectSearcherException</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception running WMI object query: \&quot;{0}\&quot;.&quot;</span>, <span class="r344 r">objectSearcherException</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastToWMISearcher&quot;</span>, <span class="r344 r">objectSearcherException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r335 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r336 r">resultType</span>.<span class="i">ToString</span>(), <span class="r344 r">objectSearcherException</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <span class="i">ManagementClass</span> <a id="ebd3005e34f71e61" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertToWMIClass</a>(<b>object</b> <span id="r345 rd" class="r345 r">valueToConvert</span>,
                                                         <span class="i">Type</span> <span id="r346 rd" class="r346 r">resultType</span>,
                                                         <b>bool</b> <span id="r347 rd" class="r347 r">recursion</span>,
                                                         <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r348 rd" class="r348 r">originalValueToConvert</span>,
                                                         <span class="i">IFormatProvider</span> <span id="r349 rd" class="r349 r">formatProvider</span>,
                                                         <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r350 rd" class="r350 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Standard type conversion to a ManagementClass.&quot;</span>);
 
            <b>string</b> <span id="r351 rd" class="r351 r">valueToConvertString</span>;
            <b>try</b>
            {
                <span class="r351 r">valueToConvertString</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e7ab15d0863aa3d6" class="i method">ToString</a>(<b>null</b>, <span class="r345 r">valueToConvert</span>, <span class="s">&quot;\n&quot;</span>, <b>null</b>, <b>null</b>, <b>true</b>, <b>true</b>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r352 rd" class="r352 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting value to string: {0}&quot;</span>, <span class="r352 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastGetStringToWMIClass&quot;</span>, <span class="r352 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionNoStringForConversion</span>,
                    <span class="r346 r">resultType</span>.<span class="i">ToString</span>(), <span class="r352 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>try</b>
            {
                <span class="i">ManagementClass</span> <span id="r353 rd" class="r353 r">wmiClass</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i">ManagementClass</span>(<span class="r351 r">valueToConvertString</span>);
 
                <span class="c">// ManagementClass will not throw if the path specified is not</span>
                <span class="c">// a valid class.</span>
                <b>if</b> (<span class="r353 r">wmiClass</span>.<span class="i">SystemProperties</span>[<span class="s">&quot;__CLASS&quot;</span>] == <b>null</b>)
                {
                    <b>string</b> <span id="r354 rd" class="r354 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidWMIClassPath</span>, <span class="r351 r">valueToConvertString</span>);
                    <b>throw</b> <b>new</b> <a href="ExtendedTypeSystemException.cs.html#c70223ba14d52141" class="t constructor">PSInvalidCastException</a>(<span class="r354 r">message</span>);
                }
 
                <b>return</b> <span class="r353 r">wmiClass</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r355 rd" class="r355 r">wmiClassException</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception creating WMI class: \&quot;{0}\&quot;.&quot;</span>, <span class="r355 r">wmiClassException</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastToWMIClass&quot;</span>, <span class="r355 r">wmiClassException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r345 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r346 r">resultType</span>.<span class="i">ToString</span>(), <span class="r355 r">wmiClassException</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <span class="i">DirectoryEntry</span> <a id="101c88584c7a281d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertToADSI</a>(<b>object</b> <span id="r356 rd" class="r356 r">valueToConvert</span>,
                                                    <span class="i">Type</span> <span id="r357 rd" class="r357 r">resultType</span>,
                                                    <b>bool</b> <span id="r358 rd" class="r358 r">recursion</span>,
                                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r359 rd" class="r359 r">originalValueToConvert</span>,
                                                    <span class="i">IFormatProvider</span> <span id="r360 rd" class="r360 r">formatProvider</span>,
                                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r361 rd" class="r361 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Standard type conversion to DirectoryEntry.&quot;</span>);
 
            <b>string</b> <span id="r362 rd" class="r362 r">valueToConvertString</span>;
            <b>try</b>
            {
                <span class="r362 r">valueToConvertString</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e7ab15d0863aa3d6" class="i method">ToString</a>(<b>null</b>, <span class="r356 r">valueToConvert</span>, <span class="s">&quot;\n&quot;</span>, <b>null</b>, <b>null</b>, <b>true</b>, <b>true</b>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r363 rd" class="r363 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting value to string: {0}&quot;</span>, <span class="r363 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastGetStringToADSIClass&quot;</span>, <span class="r363 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionNoStringForConversion</span>,
                    <span class="r357 r">resultType</span>.<span class="i">ToString</span>(), <span class="r363 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>try</b>
            {
                <span class="i">DirectoryEntry</span> <span id="r364 rd" class="r364 r">entry</span> = <b>new</b> <span class="i">DirectoryEntry</span>(<span class="r362 r">valueToConvertString</span>);
                <b>return</b> <span class="r364 r">entry</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r365 rd" class="r365 r">adsiClassException</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception creating ADSI class: \&quot;{0}\&quot;.&quot;</span>, <span class="r365 r">adsiClassException</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastToADSIClass&quot;</span>, <span class="r365 r">adsiClassException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r356 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r357 r">resultType</span>.<span class="i">ToString</span>(), <span class="r365 r">adsiClassException</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <span class="i">DirectorySearcher</span> <a id="f151d180c455176a" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertToADSISearcher</a>(<b>object</b> <span id="r366 rd" class="r366 r">valueToConvert</span>,
                                                               <span class="i">Type</span> <span id="r367 rd" class="r367 r">resultType</span>,
                                                               <b>bool</b> <span id="r368 rd" class="r368 r">recursion</span>,
                                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r369 rd" class="r369 r">originalValueToConvert</span>,
                                                               <span class="i">IFormatProvider</span> <span id="r370 rd" class="r370 r">formatProvider</span>,
                                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r371 rd" class="r371 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Standard type conversion to ADSISearcher&quot;</span>);
 
            <b>try</b>
            {
                <b>return</b> <b>new</b> <span class="i">DirectorySearcher</span>((<b>string</b>)<span class="r366 r">valueToConvert</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r372 rd" class="r372 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception creating ADSI searcher: \&quot;{0}\&quot;.&quot;</span>, <span class="r372 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastToADSISearcher&quot;</span>, <span class="r372 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r366 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r367 r">resultType</span>.<span class="i">ToString</span>(), <span class="r372 r">e</span>.<span class="i">Message</span>);
            }
        }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <b>private static</b> <span class="i">StringCollection</span> <a id="bb275b74bcf61b52" href="../R/bb275b74bcf61b52.html" target="n" data-glyph="76,1" class="i method">ConvertToStringCollection</a>(<b>object</b> <span id="r373 rd" class="r373 r">valueToConvert</span>,
                                                                  <span class="i">Type</span> <span id="r374 rd" class="r374 r">resultType</span>,
                                                                  <b>bool</b> <span id="r375 rd" class="r375 r">recursion</span>,
                                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r376 rd" class="r376 r">originalValueToConvert</span>,
                                                                  <span class="i">IFormatProvider</span> <span id="r377 rd" class="r377 r">formatProvider</span>,
                                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r378 rd" class="r378 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Standard type conversion to a StringCollection.&quot;</span>);
            <b>var</b> <span id="r379 rd" class="r379 r">stringCollection</span> = <b>new</b> <span class="i">StringCollection</span>();
            <a href="#6dfbe22ad00f9030" class="i method">AddItemsToCollection</a>(<span class="r373 r">valueToConvert</span>, <span class="r374 r">resultType</span>, <span class="r377 r">formatProvider</span>, <span class="r378 r">backupTable</span>, <span class="r379 r">stringCollection</span>);
            <b>return</b> <span class="r379 r">stringCollection</span>;
        }
 
        <b>private static void</b> <a id="6dfbe22ad00f9030" href="../R/6dfbe22ad00f9030.html" target="n" data-glyph="76,1" class="i method">AddItemsToCollection</a>(<b>object</b> <span id="r380 rd" class="r380 r">valueToConvert</span>, <span class="i">Type</span> <span id="r381 rd" class="r381 r">resultType</span>, <span class="i">IFormatProvider</span> <span id="r382 rd" class="r382 r">formatProvider</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r383 rd" class="r383 r">backupTable</span>, <span class="i">StringCollection</span> <span id="r384 rd" class="r384 r">stringCollection</span>)
        {
            <b>try</b>
            {
                <b>var</b> <span id="r385 rd" class="r385 r">stringArrayValue</span> = (<b>string</b>[])<span class="i">ConvertTo</span>(<span class="r380 r">valueToConvert</span>, <b>typeof</b>(<b>string</b>[]), <b>false</b>, <span class="r382 r">formatProvider</span>, <span class="r383 r">backupTable</span>);
                <span class="r384 r">stringCollection</span>.<span class="i">AddRange</span>(<span class="r385 r">stringArrayValue</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;valueToConvert contains non-string type values&quot;</span>);
                <b>var</b> <span id="r386 rd" class="r386 r">argEx</span> = <b>new</b> <span class="i">ArgumentException</span>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">CannotConvertValueToStringArray</span>, <span class="r380 r">valueToConvert</span>.<span class="i">ToString</span>()));
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="s">&quot;InvalidCastTo{0}Class&quot;</span>, <span class="r381 r">resultType</span>.<span class="i">Name</span>), <span class="r386 r">argEx</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>, <span class="r380 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r381 r">resultType</span>.<span class="i">ToString</span>(), <span class="r386 r">argEx</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r387 rd" class="r387 r">ex</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception creating StringCollection class: \&quot;{0}\&quot;.&quot;</span>, <span class="r387 r">ex</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="s">&quot;InvalidCastTo{0}Class&quot;</span>, <span class="r381 r">resultType</span>.<span class="i">Name</span>), <span class="r387 r">ex</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>, <span class="r380 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r381 r">resultType</span>.<span class="i">ToString</span>(), <span class="r387 r">ex</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <span class="i">XmlDocument</span> <a id="cf9e5a828cca063f" href="../R/cf9e5a828cca063f.html" target="n" data-glyph="76,1" class="i method">ConvertToXml</a>(<b>object</b> <span id="r388 rd" class="r388 r">valueToConvert</span>,
                                                <span class="i">Type</span> <span id="r389 rd" class="r389 r">resultType</span>,
                                                <b>bool</b> <span id="r390 rd" class="r390 r">recursion</span>,
                                                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r391 rd" class="r391 r">originalValueToConvert</span>,
                                                <span class="i">IFormatProvider</span> <span id="r392 rd" class="r392 r">formatProvider</span>,
                                                <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r393 rd" class="r393 r">backupTable</span>)
        {
            <b>using</b> (<a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(<span class="s">&quot;Standard type conversion to XmlDocument.&quot;</span>))
            {
                <b>string</b> <span id="r394 rd" class="r394 r">valueToConvertString</span>;
                <b>try</b>
                {
                    <span class="r394 r">valueToConvertString</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e7ab15d0863aa3d6" class="i method">ToString</a>(<b>null</b>, <span class="r388 r">valueToConvert</span>, <span class="s">&quot;\n&quot;</span>, <b>null</b>, <b>null</b>, <b>true</b>, <b>true</b>);
                }
                <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r395 rd" class="r395 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting value to string: {0}&quot;</span>, <span class="r395 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastGetStringToXmlDocument&quot;</span>, <span class="r395 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionNoStringForConversion</span>,
                        <span class="r389 r">resultType</span>.<span class="i">ToString</span>(), <span class="r395 r">e</span>.<span class="i">Message</span>);
                }
 
                <b>try</b>
                {
                    <b>using</b> (<span class="i">TextReader</span> <span id="r396 rd" class="r396 r">textReader</span> = <b>new</b> <span class="i">StringReader</span>(<span class="r394 r">valueToConvertString</span>))
                    {
                        <span class="c">// Win8: 481571 Enforcing &quot;PreserveWhitespace&quot; breaks XML pretty printing</span>
                        <span class="i">XmlReaderSettings</span> <span id="r397 rd" class="r397 r">settings</span> = <a href="serialization.cs.html#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="serialization.cs.html#b7ced31d9e3d32cb" class="i property">XmlReaderSettingsForUntrustedXmlDocument</a>.<span class="i">Clone</span>();
                        <span class="r397 r">settings</span>.<span class="i">IgnoreWhitespace</span> = <b>true</b>;
                        <span class="r397 r">settings</span>.<span class="i">IgnoreProcessingInstructions</span> = <b>false</b>;
                        <span class="r397 r">settings</span>.<span class="i">IgnoreComments</span> = <b>false</b>;
 
                        <span class="i">XmlReader</span> <span id="r398 rd" class="r398 r">xmlReader</span> = <span class="i">XmlReader</span>.<span class="i">Create</span>(<span class="r396 r">textReader</span>, <span class="r397 r">settings</span>);
                        <span class="i">XmlDocument</span> <span id="r399 rd" class="r399 r">xmlDocument</span> = <b>new</b> <span class="i">XmlDocument</span>();
                        <span class="r399 r">xmlDocument</span>.<span class="i">PreserveWhitespace</span> = <b>false</b>;
                        <span class="r399 r">xmlDocument</span>.<span class="i">Load</span>(<span class="r398 r">xmlReader</span>);
                        <b>return</b> <span class="r399 r">xmlDocument</span>;
                    }
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r400 rd" class="r400 r">loadXmlException</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception loading XML: \&quot;{0}\&quot;.&quot;</span>, <span class="r400 r">loadXmlException</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastToXmlDocument&quot;</span>, <span class="r400 r">loadXmlException</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r388 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r389 r">resultType</span>.<span class="i">ToString</span>(), <span class="r400 r">loadXmlException</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <b>private static</b> <span class="i">CultureInfo</span> <a id="bc7b5b2df700c4fc" href="../R/bc7b5b2df700c4fc.html" target="n" data-glyph="76,1" class="i method">GetCultureFromFormatProvider</a>(<span class="i">IFormatProvider</span> <span id="r401 rd" class="r401 r">formatProvider</span>)
        {
            <span class="i">CultureInfo</span> <span id="r402 rd" class="r402 r">returnValue</span> = <span class="r401 r">formatProvider</span> <b>as</b> <span class="i">CultureInfo</span> ?? <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>;
            <b>return</b> <span class="r402 r">returnValue</span>;
        }
 
        <span class="c">///</span><span class="c"> backupTypeTable:</span>
        <span class="c">///</span><span class="c"> Used by Remoting Rehydration Logic. While Deserializing a remote object,</span>
        <span class="c">///</span><span class="c"> LocalPipeline.ExecutionContextFromTLS() might return null..In which case this</span>
        <span class="c">///</span><span class="c"> TypeTable will be used to do the conversion.</span>
        <b>private static bool</b> <a id="90f39fc635ad451c" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsCustomTypeConversion</a>(<b>object</b> <span id="r403 rd" class="r403 r">valueToConvert</span>,
                                                   <span class="i">Type</span> <span id="r404 rd" class="r404 r">resultType</span>,
                                                   <span class="i">IFormatProvider</span> <span id="r405 rd" class="r405 r">formatProvider</span>,
                                                   <b>out object</b> <span id="r406 rd" class="r406 r">result</span>,
                                                   <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r407 rd" class="r407 r">backupTypeTable</span>)
        {
            <b>using</b> (<a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(<span class="s">&quot;Custom type conversion.&quot;</span>))
            {
                <b>object</b> <span id="r408 rd" class="r408 r">baseValueToConvert</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r403 r">valueToConvert</span>);
                <span class="i">Type</span> <span id="r409 rd" class="r409 r">originalType</span> = <span class="r408 r">baseValueToConvert</span>.<span class="i">GetType</span>();
 
                <span class="c">// first using ConvertTo for the original type</span>
                <b>object</b> <span id="r410 rd" class="r410 r">valueConverter</span> = <a href="#9bcb01c5d7ce5d91" class="i method">GetConverter</a>(<span class="r409 r">originalType</span>, <span class="r407 r">backupTypeTable</span>);
 
                <b>if</b> ((<span class="r410 r">valueConverter</span> != <b>null</b>))
                {
                    <span class="i">TypeConverter</span> <span id="r411 rd" class="r411 r">valueTypeConverter</span> = <span class="r410 r">valueConverter</span> <b>as</b> <span class="i">TypeConverter</span>;
                    <b>if</b> (<span class="r411 r">valueTypeConverter</span> != <b>null</b>)
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Original type&#39;s converter is TypeConverter.&quot;</span>);
                        <b>if</b> (<span class="r411 r">valueTypeConverter</span>.<span class="i">CanConvertTo</span>(<span class="r404 r">resultType</span>))
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;TypeConverter can convert to resultType.&quot;</span>);
                            <b>try</b>
                            {
                                <span class="r406 r">result</span> = <span class="r411 r">valueTypeConverter</span>.<span class="i">ConvertTo</span>(<b>null</b>, <a href="#bc7b5b2df700c4fc" class="i method">GetCultureFromFormatProvider</a>(<span class="r405 r">formatProvider</span>), <span class="r408 r">baseValueToConvert</span>, <span class="r404 r">resultType</span>);
                                <b>return</b> <b>true</b>;
                            }
                            <b>catch</b> (<span class="i">Exception</span> <span id="r412 rd" class="r412 r">e</span>)
                            {
                                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting with Original type&#39;s TypeConverter: \&quot;{0}\&quot;.&quot;</span>, <span class="r412 r">e</span>.<span class="i">Message</span>);
                                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastTypeConvertersConvertTo&quot;</span>, <span class="r412 r">e</span>,
                                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                                    <span class="r403 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r404 r">resultType</span>.<span class="i">ToString</span>(), <span class="r412 r">e</span>.<span class="i">Message</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;TypeConverter cannot convert to resultType.&quot;</span>);
                        }
                    }
 
                    <a href="#89a33fbb336451a1" class="t t">PSTypeConverter</a> <span id="r413 rd" class="r413 r">valuePSTypeConverter</span> = <span class="r410 r">valueConverter</span> <b>as</b> <a href="#89a33fbb336451a1" class="t t">PSTypeConverter</a>;
                    <b>if</b> (<span class="r413 r">valuePSTypeConverter</span> != <b>null</b>)
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Original type&#39;s converter is PSTypeConverter.&quot;</span>);
                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r414 rd" class="r414 r">psValueToConvert</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r403 r">valueToConvert</span>);
                        <b>if</b> (<span class="r413 r">valuePSTypeConverter</span>.<a href="#880f220ee931f65c" class="i method">CanConvertTo</a>(<span class="r414 r">psValueToConvert</span>, <span class="r404 r">resultType</span>))
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Original type&#39;s PSTypeConverter can convert to resultType.&quot;</span>);
                            <b>try</b>
                            {
                                <span class="r406 r">result</span> = <span class="r413 r">valuePSTypeConverter</span>.<a href="#a9b4de3a335d5247" class="i method">ConvertTo</a>(<span class="r414 r">psValueToConvert</span>, <span class="r404 r">resultType</span>, <span class="r405 r">formatProvider</span>, <b>true</b>);
                                <b>return</b> <b>true</b>;
                            }
                            <b>catch</b> (<span class="i">Exception</span> <span id="r415 rd" class="r415 r">e</span>)
                            {
                                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting with Original type&#39;s PSTypeConverter: \&quot;{0}\&quot;.&quot;</span>, <span class="r415 r">e</span>.<span class="i">Message</span>);
                                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastPSTypeConvertersConvertTo&quot;</span>, <span class="r415 r">e</span>,
                                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                                    <span class="r403 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r404 r">resultType</span>.<span class="i">ToString</span>(), <span class="r415 r">e</span>.<span class="i">Message</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Original type&#39;s PSTypeConverter cannot convert to resultType.&quot;</span>);
                        }
                    }
                }
 
                <a href="#54018625801279e1" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;No converter found in original type.&quot;</span>);
 
                <span class="c">// now ConvertFrom for the destination type</span>
                <span class="r410 r">valueConverter</span> = <a href="#9bcb01c5d7ce5d91" class="i method">GetConverter</a>(<span class="r404 r">resultType</span>, <span class="r407 r">backupTypeTable</span>);
                <b>if</b> (<span class="r410 r">valueConverter</span> != <b>null</b>)
                {
                    <span class="i">TypeConverter</span> <span id="r416 rd" class="r416 r">valueTypeConverter</span> = <span class="r410 r">valueConverter</span> <b>as</b> <span class="i">TypeConverter</span>;
                    <b>if</b> (<span class="r416 r">valueTypeConverter</span> != <b>null</b>)
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Destination type&#39;s converter is TypeConverter that can convert from originalType.&quot;</span>);
                        <b>if</b> (<span class="r416 r">valueTypeConverter</span>.<span class="i">CanConvertFrom</span>(<span class="r409 r">originalType</span>))
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Destination type&#39;s converter can convert from originalType.&quot;</span>);
                            <b>try</b>
                            {
                                <span class="r406 r">result</span> = <span class="r416 r">valueTypeConverter</span>.<span class="i">ConvertFrom</span>(<b>null</b>, <a href="#bc7b5b2df700c4fc" class="i method">GetCultureFromFormatProvider</a>(<span class="r405 r">formatProvider</span>), <span class="r408 r">baseValueToConvert</span>);
                                <b>return</b> <b>true</b>;
                            }
                            <b>catch</b> (<span class="i">Exception</span> <span id="r417 rd" class="r417 r">e</span>)
                            {
                                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting with Destination type&#39;s TypeConverter: \&quot;{0}\&quot;.&quot;</span>, <span class="r417 r">e</span>.<span class="i">Message</span>);
                                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastTypeConvertersConvertFrom&quot;</span>, <span class="r417 r">e</span>,
                                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                                    <span class="r403 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r404 r">resultType</span>.<span class="i">ToString</span>(), <span class="r417 r">e</span>.<span class="i">Message</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Destination type&#39;s converter cannot convert from originalType.&quot;</span>);
                        }
                    }
 
                    <a href="#89a33fbb336451a1" class="t t">PSTypeConverter</a> <span id="r418 rd" class="r418 r">valuePSTypeConverter</span> = <span class="r410 r">valueConverter</span> <b>as</b> <a href="#89a33fbb336451a1" class="t t">PSTypeConverter</a>;
                    <b>if</b> (<span class="r418 r">valuePSTypeConverter</span> != <b>null</b>)
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Destination type&#39;s converter is PSTypeConverter.&quot;</span>);
                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r419 rd" class="r419 r">psValueToConvert</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r403 r">valueToConvert</span>);
                        <b>if</b> (<span class="r418 r">valuePSTypeConverter</span>.<a href="#e539122ff45a9efc" class="i method">CanConvertFrom</a>(<span class="r419 r">psValueToConvert</span>, <span class="r404 r">resultType</span>))
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Destination type&#39;s converter can convert from originalType.&quot;</span>);
                            <b>try</b>
                            {
                                <span class="r406 r">result</span> = <span class="r418 r">valuePSTypeConverter</span>.<a href="#08cee750f37adb9f" class="i method">ConvertFrom</a>(<span class="r419 r">psValueToConvert</span>, <span class="r404 r">resultType</span>, <span class="r405 r">formatProvider</span>, <b>true</b>);
                                <b>return</b> <b>true</b>;
                            }
                            <b>catch</b> (<span class="i">Exception</span> <span id="r420 rd" class="r420 r">e</span>)
                            {
                                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting with Destination type&#39;s PSTypeConverter: \&quot;{0}\&quot;.&quot;</span>, <span class="r420 r">e</span>.<span class="i">Message</span>);
                                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastPSTypeConvertersConvertFrom&quot;</span>, <span class="r420 r">e</span>,
                                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                                    <span class="r403 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r404 r">resultType</span>.<span class="i">ToString</span>(), <span class="r420 r">e</span>.<span class="i">Message</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Destination type&#39;s converter cannot convert from originalType.&quot;</span>);
                        }
                    }
                }
 
                <span class="r406 r">result</span> = <b>null</b>;
                <b>return</b> <b>false</b>;
            }
        }
 
        <b>private static object</b> <a id="2b0af5f49363b2ae" href="../R/2b0af5f49363b2ae.html" target="n" data-glyph="76,1" class="i method">ConvertNumericChar</a>(<b>object</b> <span id="r421 rd" class="r421 r">valueToConvert</span>,
                                                 <span class="i">Type</span> <span id="r422 rd" class="r422 r">resultType</span>,
                                                 <b>bool</b> <span id="r423 rd" class="r423 r">recursion</span>,
                                                 <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r424 rd" class="r424 r">originalValueToConvert</span>,
                                                 <span class="i">IFormatProvider</span> <span id="r425 rd" class="r425 r">formatProvider</span>,
                                                 <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r426 rd" class="r426 r">backupTable</span>)
        {
            <b>try</b>
            {
                <span class="c">// Convert char through int to float/double.</span>
                <b>object</b> <span id="r427 rd" class="r427 r">result</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(
                    <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r421 r">valueToConvert</span>, <b>typeof</b>(<b>int</b>), <span class="r425 r">formatProvider</span>), <span class="r422 r">resultType</span>, <span class="r425 r">formatProvider</span>);
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Numeric conversion succeeded.&quot;</span>);
                <b>return</b> <span class="r427 r">result</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r428 rd" class="r428 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting with IConvertible: \&quot;{0}\&quot;.&quot;</span>, <span class="r428 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastIConvertible&quot;</span>, <span class="r428 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r421 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r422 r">resultType</span>.<span class="i">ToString</span>(), <span class="r428 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static object</b> <a id="4ef47841da578cef" href="../R/4ef47841da578cef.html" target="n" data-glyph="76,1" class="i method">ConvertNumeric</a>(<b>object</b> <span id="r429 rd" class="r429 r">valueToConvert</span>,
                                             <span class="i">Type</span> <span id="r430 rd" class="r430 r">resultType</span>,
                                             <b>bool</b> <span id="r431 rd" class="r431 r">recursion</span>,
                                             <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r432 rd" class="r432 r">originalValueToConvert</span>,
                                             <span class="i">IFormatProvider</span> <span id="r433 rd" class="r433 r">formatProvider</span>,
                                             <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r434 rd" class="r434 r">backupTable</span>)
        {
            <b>try</b>
            {
                <b>object</b> <span id="r435 rd" class="r435 r">result</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r429 r">valueToConvert</span>, <span class="r430 r">resultType</span>, <span class="r433 r">formatProvider</span>);
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Numeric conversion succeeded.&quot;</span>);
                <b>return</b> <span class="r435 r">result</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r436 rd" class="r436 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting with IConvertible: \&quot;{0}\&quot;.&quot;</span>, <span class="r436 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastIConvertible&quot;</span>, <span class="r436 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r429 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r430 r">resultType</span>.<span class="i">ToString</span>(), <span class="r436 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static char</b>[] <a id="b7369dcec26a1393" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertStringToCharArray</a>(<b>object</b> <span id="r437 rd" class="r437 r">valueToConvert</span>,
                                                       <span class="i">Type</span> <span id="r438 rd" class="r438 r">resultType</span>,
                                                       <b>bool</b> <span id="r439 rd" class="r439 r">recursion</span>,
                                                       <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r440 rd" class="r440 r">originalValueToConvert</span>,
                                                       <span class="i">IFormatProvider</span> <span id="r441 rd" class="r441 r">formatProvider</span>,
                                                       <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r442 rd" class="r442 r">backupTable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r437 r">valueToConvert</span> <b>is string</b>, <span class="s">&quot;Value to convert must be string&quot;</span>);
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Returning value to convert&#39;s ToCharArray().&quot;</span>);
            <span class="c">// This conversion is not wrapped in a try/catch because it can&#39;t raise an exception</span>
            <span class="c">// unless the string object has been corrupted.</span>
            <b>return</b> ((<b>string</b>)<span class="r437 r">valueToConvert</span>).<span class="i">ToCharArray</span>();
        }
 
        <b>private static</b> <span class="i">Regex</span> <a id="a7881706930c57b4" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertStringToRegex</a>(<b>object</b> <span id="r443 rd" class="r443 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r444 rd" class="r444 r">resultType</span>,
                                                  <b>bool</b> <span id="r445 rd" class="r445 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r446 rd" class="r446 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r447 rd" class="r447 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r448 rd" class="r448 r">backupTable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r443 r">valueToConvert</span> <b>is string</b>, <span class="s">&quot;Value to convert must be string&quot;</span>);
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Returning new RegEx(value to convert).&quot;</span>);
            <b>try</b>
            {
                <b>return</b> <b>new</b> <span class="i">Regex</span>((<b>string</b>)<span class="r443 r">valueToConvert</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r449 rd" class="r449 r">regexException</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception in RegEx constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r449 r">regexException</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromStringToRegex&quot;</span>, <span class="r449 r">regexException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r443 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r444 r">resultType</span>.<span class="i">ToString</span>(), <span class="r449 r">regexException</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimSession</span> <a id="ae1d833d9a1034dc" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertStringToCimSession</a>(<b>object</b> <span id="r450 rd" class="r450 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r451 rd" class="r451 r">resultType</span>,
                                                  <b>bool</b> <span id="r452 rd" class="r452 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r453 rd" class="r453 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r454 rd" class="r454 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r455 rd" class="r455 r">backupTable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r450 r">valueToConvert</span> <b>is string</b>, <span class="s">&quot;Value to convert must be string&quot;</span>);
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Returning CimSession.Create(value to convert).&quot;</span>);
            <b>try</b>
            {
                <b>return</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimSession</span>.<span class="i">Create</span>((<b>string</b>)<span class="r450 r">valueToConvert</span>);
            }
            <b>catch</b> (<span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimException</span> <span id="r456 rd" class="r456 r">cimException</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception in CimSession.Create: \&quot;{0}\&quot;.&quot;</span>, <span class="r456 r">cimException</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromStringToCimSession&quot;</span>, <span class="r456 r">cimException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r450 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r451 r">resultType</span>.<span class="i">ToString</span>(), <span class="r456 r">cimException</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static</b> <span class="i">Type</span> <a id="73d7b935e06700d2" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertStringToType</a>(<b>object</b> <span id="r457 rd" class="r457 r">valueToConvert</span>,
                                                <span class="i">Type</span> <span id="r458 rd" class="r458 r">resultType</span>,
                                                <b>bool</b> <span id="r459 rd" class="r459 r">recursion</span>,
                                                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r460 rd" class="r460 r">originalValueToConvert</span>,
                                                <span class="i">IFormatProvider</span> <span id="r461 rd" class="r461 r">formatProvider</span>,
                                                <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r462 rd" class="r462 r">backupTable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r457 r">valueToConvert</span> <b>is string</b>, <span class="s">&quot;Value to convert must be a string&quot;</span>);
            <span class="i">Exception</span> <span id="r463 rd" class="r463 r">exception</span>;
            <span class="i">Type</span> <span id="r464 rd" class="r464 r">namedType</span> = <a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#22e33db4a9b99496" class="i method">ResolveType</a>((<b>string</b>)<span class="r457 r">valueToConvert</span>, <b>out</b> <span class="r463 r">exception</span>);
            <b>if</b> (<span class="r464 r">namedType</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r463 r">exception</span> <b>is</b> <a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a>)
                {
                    <b>throw</b> <span class="r463 r">exception</span>;
                }
 
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromStringToType&quot;</span>, <span class="r463 r">exception</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>,
                    <span class="r457 r">valueToConvert</span>.<span class="i">ToString</span>(), <a href="#bab300d080805cd3" class="i method">ObjectToTypeNameString</a>(<span class="r457 r">valueToConvert</span>), <span class="r458 r">resultType</span>.<span class="i">ToString</span>());
            }
 
            <b>return</b> <span class="r464 r">namedType</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> We need to add this built-in converter because in FullCLR, System.Uri has a TypeConverter attribute</span>
        <span class="c">///</span><span class="c"> declared: [TypeConverter(typeof(UriTypeConverter))], so the conversion from &#39;string&#39; to &#39;Uri&#39; is</span>
        <span class="c">///</span><span class="c"> actually taken care of by &#39;UriTypeConverter&#39;. However, the type &#39;UriTypeConverter&#39; is not available</span>
        <span class="c">///</span><span class="c"> in CoreCLR, and thus the conversion from &#39;string&#39; to &#39;Uri&#39; would show a different behavior.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Therefore, we just add this built-in string-to-uri converter using the same logic &#39;UriTypeConverter&#39;</span>
        <span class="c">///</span><span class="c"> is using in FullCLR, so the conversion behavior will be the same on desktop powershell and powershell core.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Uri</span> <a id="5084aa4e3a1ab0a1" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertStringToUri</a>(<b>object</b> <span id="r465 rd" class="r465 r">valueToConvert</span>,
                                              <span class="i">Type</span> <span id="r466 rd" class="r466 r">resultType</span>,
                                              <b>bool</b> <span id="r467 rd" class="r467 r">recursion</span>,
                                              <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r468 rd" class="r468 r">originalValueToConvert</span>,
                                              <span class="i">IFormatProvider</span> <span id="r469 rd" class="r469 r">formatProvider</span>,
                                              <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r470 rd" class="r470 r">backupTable</span>)
        {
            <b>try</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r465 r">valueToConvert</span> <b>is string</b>, <span class="s">&quot;Value to convert must be a string&quot;</span>);
                <b>return</b> <b>new</b> <span class="i">Uri</span>((<b>string</b>)<span class="r465 r">valueToConvert</span>, <span class="i">UriKind</span>.<span class="i">RelativeOrAbsolute</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r471 rd" class="r471 r">uriException</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception in Uri constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r471 r">uriException</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromStringToUri&quot;</span>, <span class="r471 r">uriException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r465 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r466 r">resultType</span>.<span class="i">ToString</span>(), <span class="r471 r">uriException</span>.<span class="i">Message</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attempts to use Parser.ScanNumber to get the value of a numeric string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r472 r">strToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The string to convert to a number.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r473 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The resulting value type to convert to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r474 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The resulting numeric value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the parse succeeds, false if a parse exception arises.</span>
        <span class="c">///</span><span class="c"> In all other cases, an exception will be thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="86836c10b8eaa583" href="../R/86836c10b8eaa583.html" target="n" data-glyph="76,1" class="i method">TryScanNumber</a>(<b>string</b> <span id="r472 rd" class="r472 r">strToConvert</span>, <span class="i">Type</span> <span id="r473 rd" class="r473 r">resultType</span>, <b>out object</b> <span id="r474 rd" class="r474 r">result</span>)
        {
            <b>try</b>
            {
                <b>var</b> <span id="r475 rd" class="r475 r">parsedNumber</span> = <a href="parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="parser/Parser.cs.html#9153eaabe13401f3" class="i method">ScanNumber</a>(<span class="r472 r">strToConvert</span>, <span class="r473 r">resultType</span>, <span class="r476 r">shouldTryCoercion</span>: <b>false</b>);
                <b>if</b> (<span class="r473 r">resultType</span> == <b>typeof</b>(<span class="i">BigInteger</span>) || <span class="r475 r">parsedNumber</span> <b>is</b> <span class="i">BigInteger</span>)
                {
                    <span class="c">// Convert.ChangeType() cannot be used here as BigInteger is not IConvertible.</span>
                    <span class="r474 r">result</span> = <a href="#b143f4bf9fd6e220" class="i method">ConvertTo</a>(<span class="r475 r">parsedNumber</span>, <span class="r473 r">resultType</span>);
                    <b>return</b> <b>true</b>;
                }
 
                <span class="r474 r">result</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(
                    <span class="r475 r">parsedNumber</span>,
                    <span class="r473 r">resultType</span>,
                    <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">NumberFormat</span>);
                <b>return</b> <b>true</b>;
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// Parse or convert failed</span>
                <span class="r474 r">result</span> = <b>null</b>;
                <b>return</b> <b>false</b>;
            }
        }
 
        <b>private static object</b> <a id="82e8835ccfc75587" href="../R/82e8835ccfc75587.html" target="n" data-glyph="76,1" class="i method">ConvertStringToInteger</a>(
            <b>object</b> <span id="r477 rd" class="r477 r">valueToConvert</span>,
            <span class="i">Type</span> <span id="r478 rd" class="r478 r">resultType</span>,
            <b>bool</b> <span id="r479 rd" class="r479 r">recursion</span>,
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r480 rd" class="r480 r">originalValueToConvert</span>,
            <span class="i">IFormatProvider</span> <span id="r481 rd" class="r481 r">formatProvider</span>,
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r482 rd" class="r482 r">backupTable</span>)
        {
            <b>var</b> <span id="r483 rd" class="r483 r">strToConvert</span> = <span class="r477 r">valueToConvert</span> <b>as string</b>;
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r483 r">strToConvert</span> != <b>null</b>, <span class="s">&quot;Value to convert must be a string&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <a href="#e25b1c6d235a82c5" class="i method">IsNumeric</a>(<a href="#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r478 r">resultType</span>)) || <span class="r478 r">resultType</span> == <b>typeof</b>(<span class="i">BigInteger</span>),
                <span class="s">&quot;Result type must be numeric&quot;</span>);
 
            <b>if</b> (<span class="r483 r">strToConvert</span>.<span class="i">Length</span> == 0)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Returning numeric zero.&quot;</span>);
 
                <span class="c">// BigInteger is not IConvertible and will throw from ChangeType; we know the value we&#39;re after is zero.</span>
                <b>if</b> (<span class="r478 r">resultType</span> == <b>typeof</b>(<span class="i">BigInteger</span>))
                {
                    <b>return</b> <span class="i">BigInteger</span>.<span class="i">Zero</span>;
                }
 
                <span class="c">// This is not wrapped in a try/catch because it can&#39;t fail.</span>
                <b>return</b> <span class="i n">System</span>.<span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="i">value</span>: 0, <span class="r478 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting to integer.&quot;</span>);
 
            <b>try</b>
            {
                <b>if</b> (<a href="#86836c10b8eaa583" class="i method">TryScanNumber</a>(<span class="r483 r">strToConvert</span>, <span class="r478 r">resultType</span>, <b>out object</b> <span id="r484 rd" class="r484 r">result</span>))
                {
                    <b>return</b> <span class="r484 r">result</span>;
                }
 
                <b>if</b> (<span class="r478 r">resultType</span> == <b>typeof</b>(<span class="i">BigInteger</span>))
                {
                    <span class="c">// Fallback for BigInteger: manual parsing using any common format.</span>
                    <span class="i">NumberStyles</span> <span id="r485 rd" class="r485 r">style</span> = <span class="i">NumberStyles</span>.<span class="i">AllowLeadingSign</span>
                        | <span class="i">NumberStyles</span>.<span class="i">AllowDecimalPoint</span>
                        | <span class="i">NumberStyles</span>.<span class="i">AllowExponent</span>
                        | <span class="i">NumberStyles</span>.<span class="i">AllowHexSpecifier</span>;
 
                    <b>return</b> <span class="i">BigInteger</span>.<span class="i">Parse</span>(<span class="r483 r">strToConvert</span>, <span class="r485 r">style</span>, <span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>);
                }
 
                <span class="c">// Fallback conversion for regular numeric types.</span>
                <b>return</b> <a href="#82b3fc38df9ae7be" class="i method">GetIntegerSystemConverter</a>(<span class="r478 r">resultType</span>).<span class="i">ConvertFrom</span>(<span class="r483 r">strToConvert</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r486 rd" class="r486 r">e</span>)
            {
                <span class="c">// This catch has one extra reason to be generic (Exception e).</span>
                <span class="c">// TypeConverter.ConvertFrom wraps its exceptions in a System.Exception.</span>
                <b>if</b> (<span class="r486 r">e</span>.<span class="i">InnerException</span> != <b>null</b>)
                {
                    <span class="r486 r">e</span> = <span class="r486 r">e</span>.<span class="i">InnerException</span>;
                }
 
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting to integer: \&quot;{0}\&quot;.&quot;</span>, <span class="r486 r">e</span>.<span class="i">Message</span>);
                <b>if</b> (<span class="r486 r">e</span> <b>is</b> <span class="i">FormatException</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting to integer passing through double.&quot;</span>);
                    <b>try</b>
                    {
                        <b>return</b> <a href="#d294f2eab38961dc" class="i method">ConvertNumericThroughDouble</a>(<span class="r483 r">strToConvert</span>, <span class="r478 r">resultType</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r487 rd" class="r487 r">ex</span>) <span class="c">// swallow non-severe exceptions</span>
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting to integer through double: \&quot;{0}\&quot;.&quot;</span>, <span class="r487 r">ex</span>.<span class="i">Message</span>);
                    }
                }
 
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromStringToInteger&quot;</span>, <span class="r486 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r483 r">strToConvert</span>, <span class="r478 r">resultType</span>.<span class="i">ToString</span>(), <span class="r486 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static object</b> <a id="afd67b7626eb1faa" href="../R/afd67b7626eb1faa.html" target="n" data-glyph="76,1" class="i method">ConvertStringToDecimal</a>(<b>object</b> <span id="r488 rd" class="r488 r">valueToConvert</span>,
                                                     <span class="i">Type</span> <span id="r489 rd" class="r489 r">resultType</span>,
                                                     <b>bool</b> <span id="r490 rd" class="r490 r">recursion</span>,
                                                     <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r491 rd" class="r491 r">originalValueToConvert</span>,
                                                     <span class="i">IFormatProvider</span> <span id="r492 rd" class="r492 r">formatProvider</span>,
                                                     <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r493 rd" class="r493 r">backupTable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r488 r">valueToConvert</span> <b>is string</b>, <span class="s">&quot;Value to convert must be a string&quot;</span>);
            <b>var</b> <span id="r494 rd" class="r494 r">strToConvert</span> = <span class="r488 r">valueToConvert</span> <b>as string</b>;
 
            <b>if</b> (<span class="r494 r">strToConvert</span>.<span class="i">Length</span> == 0)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Returning numeric zero.&quot;</span>);
                <span class="c">// This is not wrapped in a try/catch because it can&#39;t fail.</span>
                <b>return</b> <span class="i n">System</span>.<span class="i">Convert</span>.<span class="i">ChangeType</span>(0, <span class="r489 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting to decimal.&quot;</span>);
            <b>try</b>
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Parsing string value to account for multipliers and type suffixes&quot;</span>);
                <b>if</b> (<a href="#86836c10b8eaa583" class="i method">TryScanNumber</a>(<span class="r494 r">strToConvert</span>, <span class="r489 r">resultType</span>, <b>out object</b> <span id="r495 rd" class="r495 r">result</span>))
                {
                    <b>return</b> <span class="r495 r">result</span>;
                }
                <b>else</b>
                {
                    <b>return</b> <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r494 r">strToConvert</span>, <span class="r489 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">NumberFormat</span>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r496 rd" class="r496 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting to decimal: \&quot;{0}\&quot;. Converting to decimal passing through double.&quot;</span>, <span class="r496 r">e</span>.<span class="i">Message</span>);
                <b>if</b> (<span class="r496 r">e</span> <b>is</b> <span class="i">FormatException</span>)
                {
                    <b>try</b>
                    {
                        <b>return</b> <a href="#d294f2eab38961dc" class="i method">ConvertNumericThroughDouble</a>(<span class="r494 r">strToConvert</span>, <span class="r489 r">resultType</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r497 rd" class="r497 r">ex</span>)
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting to integer through double: \&quot;{0}\&quot;.&quot;</span>, <span class="r497 r">ex</span>.<span class="i">Message</span>);
                    }
                }
 
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromStringToDecimal&quot;</span>, <span class="r496 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r494 r">strToConvert</span>, <span class="r489 r">resultType</span>.<span class="i">ToString</span>(), <span class="r496 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static object</b> <a id="147308c0929755b8" href="../R/147308c0929755b8.html" target="n" data-glyph="76,1" class="i method">ConvertStringToReal</a>(<b>object</b> <span id="r498 rd" class="r498 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r499 rd" class="r499 r">resultType</span>,
                                                  <b>bool</b> <span id="r500 rd" class="r500 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r501 rd" class="r501 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r502 rd" class="r502 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r503 rd" class="r503 r">backupTable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r498 r">valueToConvert</span> <b>is string</b>, <span class="s">&quot;Value to convert must be a string&quot;</span>);
            <b>var</b> <span id="r504 rd" class="r504 r">strToConvert</span> = <span class="r498 r">valueToConvert</span> <b>as string</b>;
 
            <b>if</b> (<span class="r504 r">strToConvert</span>.<span class="i">Length</span> == 0)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Returning numeric zero.&quot;</span>);
                <span class="c">// This is not wrapped in a try/catch because it can&#39;t fail.</span>
                <b>return</b> <span class="i n">System</span>.<span class="i">Convert</span>.<span class="i">ChangeType</span>(0, <span class="r499 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting to double or single.&quot;</span>);
            <b>try</b>
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Parsing string value to account for multipliers and type suffixes&quot;</span>);
 
                <b>if</b> (<a href="#86836c10b8eaa583" class="i method">TryScanNumber</a>(<span class="r504 r">strToConvert</span>, <span class="r499 r">resultType</span>, <b>out object</b> <span id="r505 rd" class="r505 r">result</span>))
                {
                    <b>return</b> <span class="r505 r">result</span>;
                }
                <b>else</b>
                {
                    <b>return</b> <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r504 r">strToConvert</span>, <span class="r499 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">NumberFormat</span>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r506 rd" class="r506 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting to double or single: \&quot;{0}\&quot;.&quot;</span>, <span class="r506 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromStringToDoubleOrSingle&quot;</span>, <span class="r506 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r504 r">strToConvert</span>, <span class="r499 r">resultType</span>.<span class="i">ToString</span>(), <span class="r506 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static object</b> <a id="d99994607ce557b4" href="../R/d99994607ce557b4.html" target="n" data-glyph="76,1" class="i method">ConvertAssignableFrom</a>(<b>object</b> <span id="r507 rd" class="r507 r">valueToConvert</span>,
                                                    <span class="i">Type</span> <span id="r508 rd" class="r508 r">resultType</span>,
                                                    <b>bool</b> <span id="r509 rd" class="r509 r">recursion</span>,
                                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r510 rd" class="r510 r">originalValueToConvert</span>,
                                                    <span class="i">IFormatProvider</span> <span id="r511 rd" class="r511 r">formatProvider</span>,
                                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r512 rd" class="r512 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Result type is assignable from value to convert&#39;s type&quot;</span>);
            <b>return</b> <span class="r507 r">valueToConvert</span>;
        }
 
        <b>private static</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="837d20d70c553c12" href="../R/837d20d70c553c12.html" target="n" data-glyph="76,1" class="i method">ConvertToPSObject</a>(<b>object</b> <span id="r513 rd" class="r513 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r514 rd" class="r514 r">resultType</span>,
                                                  <b>bool</b> <span id="r515 rd" class="r515 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r516 rd" class="r516 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r517 rd" class="r517 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r518 rd" class="r518 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Returning PSObject.AsPSObject(valueToConvert).&quot;</span>);
            <b>return</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r513 r">valueToConvert</span>);
        }
 
        <b>private static object</b> <a id="b7e9d139e1a57fbc" href="../R/b7e9d139e1a57fbc.html" target="n" data-glyph="76,1" class="i method">ConvertToVoid</a>(<b>object</b> <span id="r519 rd" class="r519 r">valueToConvert</span>,
                                            <span class="i">Type</span> <span id="r520 rd" class="r520 r">resultType</span>,
                                            <b>bool</b> <span id="r521 rd" class="r521 r">recursion</span>,
                                            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r522 rd" class="r522 r">originalValueToConvert</span>,
                                            <span class="i">IFormatProvider</span> <span id="r523 rd" class="r523 r">formatProvider</span>,
                                            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r524 rd" class="r524 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;returning AutomationNull.Value.&quot;</span>);
            <b>return</b> <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
        }
 
        <b>private static bool</b> <a id="e13fea21b483093a" href="../R/e13fea21b483093a.html" target="n" data-glyph="76,1" class="i method">ConvertClassToBool</a>(<b>object</b> <span id="r525 rd" class="r525 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r526 rd" class="r526 r">resultType</span>,
                                               <b>bool</b> <span id="r527 rd" class="r527 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r528 rd" class="r528 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r529 rd" class="r529 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r530 rd" class="r530 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting ref to boolean.&quot;</span>);
            <b>return</b> <span class="r525 r">valueToConvert</span> != <b>null</b>;
        }
 
        <b>private static bool</b> <a id="42a14eeffba941ff" href="../R/42a14eeffba941ff.html" target="n" data-glyph="76,1" class="i method">ConvertValueToBool</a>(<b>object</b> <span id="r531 rd" class="r531 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r532 rd" class="r532 r">resultType</span>,
                                               <b>bool</b> <span id="r533 rd" class="r533 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r534 rd" class="r534 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r535 rd" class="r535 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r536 rd" class="r536 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting value to boolean.&quot;</span>);
            <b>return</b> <b>true</b>;
        }
 
        <b>private static bool</b> <a id="189c84c3efe24445" href="../R/189c84c3efe24445.html" target="n" data-glyph="76,1" class="i method">ConvertStringToBool</a>(<b>object</b> <span id="r537 rd" class="r537 r">valueToConvert</span>,
                                                <span class="i">Type</span> <span id="r538 rd" class="r538 r">resultType</span>,
                                                <b>bool</b> <span id="r539 rd" class="r539 r">recursion</span>,
                                                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r540 rd" class="r540 r">originalValueToConvert</span>,
                                                <span class="i">IFormatProvider</span> <span id="r541 rd" class="r541 r">formatProvider</span>,
                                                <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r542 rd" class="r542 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting string to boolean.&quot;</span>);
            <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#0d034360442f5a24" class="i method">IsTrue</a>((<b>string</b>)<span class="r537 r">valueToConvert</span>);
        }
 
        <b>private static bool</b> <a id="7dc698a8d1688656" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertInt16ToBool</a>(<b>object</b> <span id="r543 rd" class="r543 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r544 rd" class="r544 r">resultType</span>,
                                               <b>bool</b> <span id="r545 rd" class="r545 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r546 rd" class="r546 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r547 rd" class="r547 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r548 rd" class="r548 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">Int16</span>)<span class="r543 r">valueToConvert</span>) != <b>default</b>(<span class="i">Int16</span>);
        }
 
        <b>private static bool</b> <a id="6a12a45d2c904751" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertInt32ToBool</a>(<b>object</b> <span id="r549 rd" class="r549 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r550 rd" class="r550 r">resultType</span>,
                                               <b>bool</b> <span id="r551 rd" class="r551 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r552 rd" class="r552 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r553 rd" class="r553 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r554 rd" class="r554 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">Int32</span>)<span class="r549 r">valueToConvert</span>) != <b>default</b>(<span class="i">Int32</span>);
        }
 
        <b>private static bool</b> <a id="8333737f0d7e0f3c" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertInt64ToBool</a>(<b>object</b> <span id="r555 rd" class="r555 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r556 rd" class="r556 r">resultType</span>,
                                               <b>bool</b> <span id="r557 rd" class="r557 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r558 rd" class="r558 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r559 rd" class="r559 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r560 rd" class="r560 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">Int64</span>)<span class="r555 r">valueToConvert</span>) != <b>default</b>(<span class="i">Int64</span>);
        }
 
        <b>private static bool</b> <a id="1d1fa23b9327d7b5" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertUInt16ToBool</a>(<b>object</b> <span id="r561 rd" class="r561 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r562 rd" class="r562 r">resultType</span>,
                                               <b>bool</b> <span id="r563 rd" class="r563 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r564 rd" class="r564 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r565 rd" class="r565 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r566 rd" class="r566 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">UInt16</span>)<span class="r561 r">valueToConvert</span>) != <b>default</b>(<span class="i">UInt16</span>);
        }
 
        <b>private static bool</b> <a id="69bd2fec838bd0da" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertUInt32ToBool</a>(<b>object</b> <span id="r567 rd" class="r567 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r568 rd" class="r568 r">resultType</span>,
                                               <b>bool</b> <span id="r569 rd" class="r569 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r570 rd" class="r570 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r571 rd" class="r571 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r572 rd" class="r572 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">UInt32</span>)<span class="r567 r">valueToConvert</span>) != <b>default</b>(<span class="i">UInt32</span>);
        }
 
        <b>private static bool</b> <a id="13939271d4b8156e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertUInt64ToBool</a>(<b>object</b> <span id="r573 rd" class="r573 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r574 rd" class="r574 r">resultType</span>,
                                               <b>bool</b> <span id="r575 rd" class="r575 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r576 rd" class="r576 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r577 rd" class="r577 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r578 rd" class="r578 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">UInt64</span>)<span class="r573 r">valueToConvert</span>) != <b>default</b>(<span class="i">UInt64</span>);
        }
 
        <b>private static bool</b> <a id="0fdb814e449bc45f" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertSByteToBool</a>(<b>object</b> <span id="r579 rd" class="r579 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r580 rd" class="r580 r">resultType</span>,
                                               <b>bool</b> <span id="r581 rd" class="r581 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r582 rd" class="r582 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r583 rd" class="r583 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r584 rd" class="r584 r">backupTable</span>)
        {
            <b>return</b> ((<b>sbyte</b>)<span class="r579 r">valueToConvert</span>) != <b>default</b>(<b>sbyte</b>);
        }
 
        <b>private static bool</b> <a id="436a6c23098876f9" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertByteToBool</a>(<b>object</b> <span id="r585 rd" class="r585 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r586 rd" class="r586 r">resultType</span>,
                                               <b>bool</b> <span id="r587 rd" class="r587 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r588 rd" class="r588 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r589 rd" class="r589 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r590 rd" class="r590 r">backupTable</span>)
        {
            <b>return</b> ((<b>byte</b>)<span class="r585 r">valueToConvert</span>) != <b>default</b>(<b>byte</b>);
        }
 
        <b>private static bool</b> <a id="4d54dea3d85bac46" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertSingleToBool</a>(<b>object</b> <span id="r591 rd" class="r591 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r592 rd" class="r592 r">resultType</span>,
                                               <b>bool</b> <span id="r593 rd" class="r593 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r594 rd" class="r594 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r595 rd" class="r595 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r596 rd" class="r596 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">Single</span>)<span class="r591 r">valueToConvert</span>) != <b>default</b>(<span class="i">Single</span>);
        }
 
        <b>private static bool</b> <a id="2e80ea2f2110f8e3" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertDoubleToBool</a>(<b>object</b> <span id="r597 rd" class="r597 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r598 rd" class="r598 r">resultType</span>,
                                               <b>bool</b> <span id="r599 rd" class="r599 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r600 rd" class="r600 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r601 rd" class="r601 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r602 rd" class="r602 r">backupTable</span>)
        {
            <b>return</b> ((<b>double</b>)<span class="r597 r">valueToConvert</span>) != <b>default</b>(<b>double</b>);
        }
 
        <b>private static bool</b> <a id="48f89b0725d6b71f" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertDecimalToBool</a>(<b>object</b> <span id="r603 rd" class="r603 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r604 rd" class="r604 r">resultType</span>,
                                               <b>bool</b> <span id="r605 rd" class="r605 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r606 rd" class="r606 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r607 rd" class="r607 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r608 rd" class="r608 r">backupTable</span>)
        {
            <b>return</b> ((<span class="i">Decimal</span>)<span class="r603 r">valueToConvert</span>) != <b>default</b>(<span class="i">Decimal</span>);
        }
 
        <b>private static bool</b> <a id="132ae66588460d46" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertBigIntegerToBool</a>(
            <b>object</b> <span id="r609 rd" class="r609 r">valueToConvert</span>,
            <span class="i">Type</span> <span id="r610 rd" class="r610 r">resultType</span>,
            <b>bool</b> <span id="r611 rd" class="r611 r">recursion</span>,
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r612 rd" class="r612 r">originalValueToConvert</span>,
            <span class="i">IFormatProvider</span> <span id="r613 rd" class="r613 r">formatProvider</span>,
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r614 rd" class="r614 r">backupTable</span>)
                =&gt; ((<span class="i">BigInteger</span>)<span class="r609 r">valueToConvert</span>) != <span class="i">BigInteger</span>.<span class="i">Zero</span>;
 
        <b>private static object</b> <a id="256cc163af7e45f4" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertBoolToBigInteger</a>(
            <b>object</b> <span id="r615 rd" class="r615 r">valueToConvert</span>,
            <span class="i">Type</span> <span id="r616 rd" class="r616 r">resultType</span>,
            <b>bool</b> <span id="r617 rd" class="r617 r">recursion</span>,
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r618 rd" class="r618 r">originalValueToConvert</span>,
            <span class="i">IFormatProvider</span> <span id="r619 rd" class="r619 r">formatProvider</span>,
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r620 rd" class="r620 r">backupTable</span>)
                =&gt; (<b>bool</b>)<span class="r615 r">valueToConvert</span> ? <span class="i">BigInteger</span>.<span class="i">One</span> : <span class="i">BigInteger</span>.<span class="i">Zero</span>;
 
        <b>private static</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>bool</b>&gt; <a id="e3b6ef6a498ee446" href="../R/e3b6ef6a498ee446.html" target="n" data-glyph="76,1" class="i method">CreateNumericToBoolConverter</a>(<span class="i">Type</span> <span id="r621 rd" class="r621 r">fromType</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#e25b1c6d235a82c5" class="i method">IsNumeric</a>(<span class="r621 r">fromType</span>.<a href="../utils/ExtensionMethods.cs.html#6941492779b390f9" class="i method">GetTypeCode</a>()), <span class="s">&quot;Can only convert numeric types&quot;</span>);
 
            <b>var</b> <span id="r622 rd" class="r622 r">valueToConvert</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<b>object</b>));
            <b>var</b> <span id="r623 rd" class="r623 r">parameters</span> = <b>new</b> <span class="i">ParameterExpression</span>[]
            {
                <span class="r622 r">valueToConvert</span>,
                <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<span class="i">Type</span>)),
                <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<b>bool</b>)),
                <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)),
                <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<span class="i">IFormatProvider</span>)),
                <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>))
            };
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>bool</b>&gt;&gt;(
                <span class="i">Expression</span>.<span class="i">NotEqual</span>(<span class="i">Expression</span>.<span class="i">Default</span>(<span class="r621 r">fromType</span>), <span class="r622 r">valueToConvert</span>.<span class="i">Cast</span>(<span class="r621 r">fromType</span>)),
                <span class="r623 r">parameters</span>).<span class="i">Compile</span>();
        }
 
        <b>private static bool</b> <a id="23436eb08f3434ca" href="../R/23436eb08f3434ca.html" target="n" data-glyph="76,1" class="i method">ConvertCharToBool</a>(<b>object</b> <span id="r624 rd" class="r624 r">valueToConvert</span>,
                                              <span class="i">Type</span> <span id="r625 rd" class="r625 r">resultType</span>,
                                              <b>bool</b> <span id="r626 rd" class="r626 r">recursion</span>,
                                              <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r627 rd" class="r627 r">originalValueToConvert</span>,
                                              <span class="i">IFormatProvider</span> <span id="r628 rd" class="r628 r">formatProvider</span>,
                                              <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r629 rd" class="r629 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting char to boolean.&quot;</span>);
            <b>char</b> <span id="r630 rd" class="r630 r">c</span> = (<b>char</b>)<span class="r624 r">valueToConvert</span>;
            <b>return</b> <span class="r630 r">c</span> != <span class="s">&#39;\0&#39;</span>;
        }
 
        <b>private static bool</b> <a id="7a154bdc62b5f59d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertSwitchParameterToBool</a>(<b>object</b> <span id="r631 rd" class="r631 r">valueToConvert</span>,
                                                         <span class="i">Type</span> <span id="r632 rd" class="r632 r">resultType</span>,
                                                         <b>bool</b> <span id="r633 rd" class="r633 r">recursion</span>,
                                                         <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r634 rd" class="r634 r">originalValueToConvert</span>,
                                                         <span class="i">IFormatProvider</span> <span id="r635 rd" class="r635 r">formatProvider</span>,
                                                         <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r636 rd" class="r636 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting SwitchParameter to boolean.&quot;</span>);
            <b>return</b> ((<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>)<span class="r631 r">valueToConvert</span>).<a href="MshCmdlet.cs.html#1292a5d1a1a3e8e8" class="i method">ToBool</a>();
        }
 
        <b>private static bool</b> <a id="e120fc89bba684eb" href="../R/e120fc89bba684eb.html" target="n" data-glyph="76,1" class="i method">ConvertIListToBool</a>(<b>object</b> <span id="r637 rd" class="r637 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r638 rd" class="r638 r">resultType</span>,
                                               <b>bool</b> <span id="r639 rd" class="r639 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r640 rd" class="r640 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r641 rd" class="r641 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r642 rd" class="r642 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting IList to boolean.&quot;</span>);
            <b>return</b> <a href="#43c054e323f3ca74" class="i method">IsTrue</a>((<span class="i">IList</span>)<span class="r637 r">valueToConvert</span>);
        }
 
        <b>private static string</b> <a id="db06ae62b63dd650" href="../R/db06ae62b63dd650.html" target="n" data-glyph="76,1" class="i method">ConvertNumericToString</a>(<b>object</b> <span id="r643 rd" class="r643 r">valueToConvert</span>,
                                                     <span class="i">Type</span> <span id="r644 rd" class="r644 r">resultType</span>,
                                                     <b>bool</b> <span id="r645 rd" class="r645 r">recursion</span>,
                                                     <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r646 rd" class="r646 r">originalValueToConvert</span>,
                                                     <span class="i">IFormatProvider</span> <span id="r647 rd" class="r647 r">formatProvider</span>,
                                                     <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r648 rd" class="r648 r">backupTable</span>)
        {
            <b>if</b> (<span class="r646 r">originalValueToConvert</span> != <b>null</b> &amp;&amp; <span class="r646 r">originalValueToConvert</span>.<a href="MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a> != <b>null</b>)
            {
                <b>return</b> <span class="r646 r">originalValueToConvert</span>.<a href="MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a>;
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting numeric to string.&quot;</span>);
            <b>try</b>
            {
                <span class="c">// Ignore formatProvider here, the conversion should be culture invariant.</span>
                <b>var</b> <span id="r649 rd" class="r649 r">numberFormat</span> = <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">NumberFormat</span>;
                <b>if</b> (<span class="r643 r">valueToConvert</span> <b>is double</b> <span id="r650 rd" class="r650 r">dbl</span>)
                {
                    <b>return</b> <span class="r650 r">dbl</span>.<span class="i">ToString</span>(<a href="#e55dc96379386f6c" class="i field">DoublePrecision</a>, <span class="r649 r">numberFormat</span>);
                }
 
                <b>if</b> (<span class="r643 r">valueToConvert</span> <b>is float</b> <span id="r651 rd" class="r651 r">sgl</span>)
                {
                    <b>return</b> <span class="r651 r">sgl</span>.<span class="i">ToString</span>(<a href="#69af0728ca460fee" class="i field">SinglePrecision</a>, <span class="r649 r">numberFormat</span>);
                }
 
                <b>if</b> (<span class="r643 r">valueToConvert</span> <b>is</b> <span class="i">BigInteger</span> <span id="r652 rd" class="r652 r">b</span>)
                {
                    <b>return</b> <span class="r652 r">b</span>.<span class="i">ToString</span>(<span class="r649 r">numberFormat</span>);
                }
 
                <b>return</b> (<b>string</b>)<span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r643 r">valueToConvert</span>, <span class="r644 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">NumberFormat</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r653 rd" class="r653 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Converting numeric to string Exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r653 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromNumericToString&quot;</span>, <span class="r653 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r643 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r644 r">resultType</span>.<span class="i">ToString</span>(), <span class="r653 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static string</b> <a id="72b1263d17b54580" href="../R/72b1263d17b54580.html" target="n" data-glyph="76,1" class="i method">ConvertNonNumericToString</a>(<b>object</b> <span id="r654 rd" class="r654 r">valueToConvert</span>,
                                                        <span class="i">Type</span> <span id="r655 rd" class="r655 r">resultType</span>,
                                                        <b>bool</b> <span id="r656 rd" class="r656 r">recursion</span>,
                                                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r657 rd" class="r657 r">originalValueToConvert</span>,
                                                        <span class="i">IFormatProvider</span> <span id="r658 rd" class="r658 r">formatProvider</span>,
                                                        <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r659 rd" class="r659 r">backupTable</span>)
        {
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r660 rd" class="r660 r">ecFromTLS</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>try</b>
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting object to string.&quot;</span>);
                <b>return</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#1e8671244c1a552e" class="i method">ToStringParser</a>(<span class="r660 r">ecFromTLS</span>, <span class="r654 r">valueToConvert</span>, <span class="r658 r">formatProvider</span>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r661 rd" class="r661 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Converting object to string Exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r661 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromAnyTypeToString&quot;</span>, <span class="r661 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastCannotRetrieveString</span>);
            }
        }
 
        <b>private static</b> <span class="i">Hashtable</span> <a id="c53e7521e0a96223" href="../R/c53e7521e0a96223.html" target="n" data-glyph="76,1" class="i method">ConvertIDictionaryToHashtable</a>(<b>object</b> <span id="r662 rd" class="r662 r">valueToConvert</span>,
                                                               <span class="i">Type</span> <span id="r663 rd" class="r663 r">resultType</span>,
                                                               <b>bool</b> <span id="r664 rd" class="r664 r">recursion</span>,
                                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r665 rd" class="r665 r">originalValueToConvert</span>,
                                                               <span class="i">IFormatProvider</span> <span id="r666 rd" class="r666 r">formatProvider</span>,
                                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r667 rd" class="r667 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting to Hashtable.&quot;</span>);
            <b>return</b> <b>new</b> <span class="i">Hashtable</span>(<span class="r662 r">valueToConvert</span> <b>as</b> <span class="i">IDictionary</span>);
        }
 
        <b>private static</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a> <a id="a811bb7d04dfffcc" href="../R/a811bb7d04dfffcc.html" target="n" data-glyph="76,1" class="i method">ConvertToPSReference</a>(<b>object</b> <span id="r668 rd" class="r668 r">valueToConvert</span>,
                                                        <span class="i">Type</span> <span id="r669 rd" class="r669 r">resultType</span>,
                                                        <b>bool</b> <span id="r670 rd" class="r670 r">recursion</span>,
                                                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r671 rd" class="r671 r">originalValueToConvert</span>,
                                                        <span class="i">IFormatProvider</span> <span id="r672 rd" class="r672 r">formatProvider</span>,
                                                        <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r673 rd" class="r673 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting to PSReference.&quot;</span>);
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r668 r">valueToConvert</span> != <b>null</b>, <span class="s">&quot;[ref]$null cast should be handler earlier with a separate ConvertNullToPSReference method&quot;</span>);
 
            <b>return</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>.<span class="i">CreateInstance</span>(<span class="r668 r">valueToConvert</span>, <span class="r668 r">valueToConvert</span>.<span class="i">GetType</span>());
        }
 
        <b>private static</b> <span class="i">Delegate</span> <a id="5bec5e219b39d0b2" href="../R/5bec5e219b39d0b2.html" target="n" data-glyph="76,1" class="i method">ConvertScriptBlockToDelegate</a>(<b>object</b> <span id="r674 rd" class="r674 r">valueToConvert</span>,
                                                             <span class="i">Type</span> <span id="r675 rd" class="r675 r">resultType</span>,
                                                             <b>bool</b> <span id="r676 rd" class="r676 r">recursion</span>,
                                                             <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r677 rd" class="r677 r">originalValueToConvert</span>,
                                                             <span class="i">IFormatProvider</span> <span id="r678 rd" class="r678 r">formatProvider</span>,
                                                             <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r679 rd" class="r679 r">backupTable</span>)
        {
            <span class="i">Exception</span> <span id="r680 rd" class="r680 r">exception</span> = <b>null</b>;
 
            <b>try</b>
            {
                <b>return</b> ((<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)<span class="r674 r">valueToConvert</span>).<a href="lang/scriptblock.cs.html#b1d16389810bed80" class="i method">GetDelegate</a>(<span class="r675 r">resultType</span>);
            }
            <b>catch</b> (<span class="i">ArgumentNullException</span> <span id="r681 rd" class="r681 r">e</span>)
            {
                <span class="r680 r">exception</span> = <span class="r681 r">e</span>;
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r682 rd" class="r682 r">e</span>)
            {
                <span class="r680 r">exception</span> = <span class="r682 r">e</span>;
            }
            <b>catch</b> (<span class="i">MissingMethodException</span> <span id="r683 rd" class="r683 r">e</span>)
            {
                <span class="r680 r">exception</span> = <span class="r683 r">e</span>;
            }
            <b>catch</b> (<span class="i">MemberAccessException</span> <span id="r684 rd" class="r684 r">e</span>)
            {
                <span class="r680 r">exception</span> = <span class="r684 r">e</span>;
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Converting script block to delegate Exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r680 r">exception</span>.<span class="i">Message</span>);
 
            <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromScriptBlockToDelegate&quot;</span>, <span class="r680 r">exception</span>,
                <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                <span class="r674 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r675 r">resultType</span>.<span class="i">ToString</span>(), <span class="r680 r">exception</span>.<span class="i">Message</span>);
        }
 
        <b>private static object</b> <a id="939aafbdc9fc40e7" href="../R/939aafbdc9fc40e7.html" target="n" data-glyph="76,1" class="i method">ConvertToNullable</a>(<b>object</b> <span id="r685 rd" class="r685 r">valueToConvert</span>,
                                                <span class="i">Type</span> <span id="r686 rd" class="r686 r">resultType</span>,
                                                <b>bool</b> <span id="r687 rd" class="r687 r">recursion</span>,
                                                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r688 rd" class="r688 r">originalValueToConvert</span>,
                                                <span class="i">IFormatProvider</span> <span id="r689 rd" class="r689 r">formatProvider</span>,
                                                <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r690 rd" class="r690 r">backupTable</span>)
        {
            <span class="c">// The CLR doesn&#39;t support boxed Nullable&lt;T&gt;.  Instead, languages convert to T and box.</span>
            <b>return</b> <span class="i">ConvertTo</span>(<span class="r685 r">valueToConvert</span>, <span class="i">Nullable</span>.<span class="i">GetUnderlyingType</span>(<span class="r686 r">resultType</span>), <span class="r687 r">recursion</span>, <span class="r689 r">formatProvider</span>, <span class="r690 r">backupTable</span>);
        }
 
        <b>private static object</b> <a id="5e483c1fff52ec02" href="../R/5e483c1fff52ec02.html" target="n" data-glyph="76,1" class="i method">ConvertRelatedArrays</a>(<b>object</b> <span id="r691 rd" class="r691 r">valueToConvert</span>,
                                                   <span class="i">Type</span> <span id="r692 rd" class="r692 r">resultType</span>,
                                                   <b>bool</b> <span id="r693 rd" class="r693 r">recursion</span>,
                                                   <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r694 rd" class="r694 r">originalValueToConvert</span>,
                                                   <span class="i">IFormatProvider</span> <span id="r695 rd" class="r695 r">formatProvider</span>,
                                                   <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r696 rd" class="r696 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;The element type of result is assignable from the element type of the value to convert&quot;</span>);
            <b>var</b> <span id="r697 rd" class="r697 r">originalAsArray</span> = (<span class="i">Array</span>)<span class="r691 r">valueToConvert</span>;
            <b>var</b> <span id="r698 rd" class="r698 r">newValue</span> = <span class="i">Array</span>.<span class="i">CreateInstance</span>(<span class="r692 r">resultType</span>.<span class="i">GetElementType</span>(), <span class="r697 r">originalAsArray</span>.<span class="i">Length</span>);
            <span class="r697 r">originalAsArray</span>.<span class="i">CopyTo</span>(<span class="r698 r">newValue</span>, 0);
            <b>return</b> <span class="r698 r">newValue</span>;
        }
 
        <b>private static object</b> <a id="45c70f2fb4280af8" href="../R/45c70f2fb4280af8.html" target="n" data-glyph="76,1" class="i method">ConvertUnrelatedArrays</a>(<b>object</b> <span id="r699 rd" class="r699 r">valueToConvert</span>,
                                                     <span class="i">Type</span> <span id="r700 rd" class="r700 r">resultType</span>,
                                                     <b>bool</b> <span id="r701 rd" class="r701 r">recursion</span>,
                                                     <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r702 rd" class="r702 r">originalValueToConvert</span>,
                                                     <span class="i">IFormatProvider</span> <span id="r703 rd" class="r703 r">formatProvider</span>,
                                                     <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r704 rd" class="r704 r">backupTable</span>)
        {
            <span class="i">Array</span> <span id="r705 rd" class="r705 r">valueAsArray</span> = <span class="r699 r">valueToConvert</span> <b>as</b> <span class="i">Array</span>;
            <span class="i">Type</span> <span id="r706 rd" class="r706 r">resultElementType</span> = <span class="r700 r">resultType</span>.<span class="i">GetElementType</span>();
            <span class="i">Array</span> <span id="r707 rd" class="r707 r">resultArray</span> = <span class="i">Array</span>.<span class="i">CreateInstance</span>(<span class="r706 r">resultElementType</span>, <span class="r705 r">valueAsArray</span>.<span class="i">Length</span>);
 
            <b>for</b> (<b>int</b> <span id="r708 rd" class="r708 r">i</span> = 0; <span class="r708 r">i</span> &lt; <span class="r705 r">valueAsArray</span>.<span class="i">Length</span>; <span class="r708 r">i</span>++)
            {
                <b>object</b> <span id="r709 rd" class="r709 r">resultElement</span> = <span class="i">ConvertTo</span>(<span class="r705 r">valueAsArray</span>.<span class="i">GetValue</span>(<span class="r708 r">i</span>), <span class="r706 r">resultElementType</span>, <b>false</b>, <span class="r703 r">formatProvider</span>, <span class="r704 r">backupTable</span>);
                <span class="r707 r">resultArray</span>.<span class="i">SetValue</span>(<span class="r709 r">resultElement</span>, <span class="r708 r">i</span>);
            }
 
            <b>return</b> <span class="r707 r">resultArray</span>;
        }
 
        <b>private static object</b> <a id="a6b6f9bfc8a9b423" href="../R/a6b6f9bfc8a9b423.html" target="n" data-glyph="76,1" class="i method">ConvertEnumerableToArray</a>(<b>object</b> <span id="r710 rd" class="r710 r">valueToConvert</span>,
                                                       <span class="i">Type</span> <span id="r711 rd" class="r711 r">resultType</span>,
                                                       <b>bool</b> <span id="r712 rd" class="r712 r">recursion</span>,
                                                       <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r713 rd" class="r713 r">originalValueToConvert</span>,
                                                       <span class="i">IFormatProvider</span> <span id="r714 rd" class="r714 r">formatProvider</span>,
                                                       <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r715 rd" class="r715 r">backupTable</span>)
        {
            <b>try</b>
            {
                <span class="i">ArrayList</span> <span id="r716 rd" class="r716 r">result</span> = <b>new</b> <span class="i">ArrayList</span>();
                <span class="i">Type</span> <span id="r717 rd" class="r717 r">resultElementType</span> = <span class="r711 r">resultType</span> == <b>typeof</b>(<span class="i">Array</span>) ? <b>typeof</b>(<b>object</b>) : <span class="r711 r">resultType</span>.<span class="i">GetElementType</span>();
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting elements in the value to convert to the result&#39;s element type.&quot;</span>);
                <b>foreach</b> (<b>object</b> <span id="r718 rd" class="r718 r">obj</span> <b>in</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r710 r">valueToConvert</span>))
                {
                    <span class="c">// false means no further recursions and therefore no cycles</span>
                    <span class="r716 r">result</span>.<span class="i">Add</span>(<a href="#01ef0df31c173865" class="i method">ConvertTo</a>(<span class="r718 r">obj</span>, <span class="r717 r">resultElementType</span>, <b>false</b>, <span class="r714 r">formatProvider</span>, <span class="r715 r">backupTable</span>));
                }
 
                <b>return</b> <span class="r716 r">result</span>.<span class="i">ToArray</span>(<span class="r717 r">resultElementType</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r719 rd" class="r719 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Element conversion exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r719 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastExceptionEnumerableToArray&quot;</span>, <span class="r719 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r710 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r711 r">resultType</span>.<span class="i">ToString</span>(), <span class="r719 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static object</b> <a id="3b658406a202c83a" href="../R/3b658406a202c83a.html" target="n" data-glyph="76,1" class="i method">ConvertScalarToArray</a>(<b>object</b> <span id="r720 rd" class="r720 r">valueToConvert</span>,
                                                   <span class="i">Type</span> <span id="r721 rd" class="r721 r">resultType</span>,
                                                   <b>bool</b> <span id="r722 rd" class="r722 r">recursion</span>,
                                                   <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r723 rd" class="r723 r">originalValueToConvert</span>,
                                                   <span class="i">IFormatProvider</span> <span id="r724 rd" class="r724 r">formatProvider</span>,
                                                   <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r725 rd" class="r725 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Value to convert is scalar.&quot;</span>);
 
            <b>if</b> (<span class="r723 r">originalValueToConvert</span> != <b>null</b> &amp;&amp; <span class="r723 r">originalValueToConvert</span>.<a href="MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a> != <b>null</b>)
            {
                <span class="r720 r">valueToConvert</span> = <span class="r723 r">originalValueToConvert</span>;
            }
 
            <b>try</b>
            {
                <span class="i">Type</span> <span id="r726 rd" class="r726 r">resultElementType</span> = <span class="r721 r">resultType</span> == <b>typeof</b>(<span class="i">Array</span>) ? <b>typeof</b>(<b>object</b>) : <span class="r721 r">resultType</span>.<span class="i">GetElementType</span>();
                <span class="i">ArrayList</span> <span id="r727 rd" class="r727 r">result</span> = <b>new</b> <span class="i">ArrayList</span>();
                <span class="c">// false means no further recursions and therefore no cycles</span>
                <span class="r727 r">result</span>.<span class="i">Add</span>(<a href="#01ef0df31c173865" class="i method">ConvertTo</a>(<span class="r720 r">valueToConvert</span>, <span class="r726 r">resultElementType</span>, <b>false</b>, <span class="r724 r">formatProvider</span>, <span class="r725 r">backupTable</span>));
                <b>return</b> <span class="r727 r">result</span>.<span class="i">ToArray</span>(<span class="r726 r">resultElementType</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r728 rd" class="r728 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Element conversion exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r728 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastExceptionScalarToArray&quot;</span>, <span class="r728 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r720 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r721 r">resultType</span>.<span class="i">ToString</span>(), <span class="r728 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static object</b> <a id="69bde1c38c0c34ba" href="../R/69bde1c38c0c34ba.html" target="n" data-glyph="76,1" class="i method">ConvertIntegerToEnum</a>(<b>object</b> <span id="r729 rd" class="r729 r">valueToConvert</span>,
                                                   <span class="i">Type</span> <span id="r730 rd" class="r730 r">resultType</span>,
                                                   <b>bool</b> <span id="r731 rd" class="r731 r">recursion</span>,
                                                   <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r732 rd" class="r732 r">originalValueToConvert</span>,
                                                   <span class="i">IFormatProvider</span> <span id="r733 rd" class="r733 r">formatProvider</span>,
                                                   <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r734 rd" class="r734 r">backupTable</span>)
        {
            <b>object</b> <span id="r735 rd" class="r735 r">result</span>;
 
            <b>try</b>
            {
                <span class="r735 r">result</span> = <span class="i n">System</span>.<span class="i">Enum</span>.<span class="i">ToObject</span>(<span class="r730 r">resultType</span>, <span class="r729 r">valueToConvert</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r736 rd" class="r736 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Integer to System.Enum exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r736 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastExceptionIntegerToEnum&quot;</span>, <span class="r736 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r729 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r730 r">resultType</span>.<span class="i">ToString</span>(), <span class="r736 r">e</span>.<span class="i">Message</span>);
            }
 
            <span class="c">// Check if the result is a defined enum..otherwise throw an error</span>
            <span class="c">// valueToConvert is the user supplied value. Use that in the error message.</span>
            <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#e14dda662bd93ed6" class="i method">ThrowForUndefinedEnum</a>(<span class="s">&quot;UndefinedIntegerToEnum&quot;</span>, <span class="r735 r">result</span>, <span class="r729 r">valueToConvert</span>, <span class="r730 r">resultType</span>);
 
            <b>return</b> <span class="r735 r">result</span>;
        }
 
        <b>private static object</b> <a id="cac764c8e22e5b3e" href="../R/cac764c8e22e5b3e.html" target="n" data-glyph="76,1" class="i method">ConvertStringToEnum</a>(<b>object</b> <span id="r737 rd" class="r737 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r738 rd" class="r738 r">resultType</span>,
                                                  <b>bool</b> <span id="r739 rd" class="r739 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r740 rd" class="r740 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r741 rd" class="r741 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r742 rd" class="r742 r">backupTable</span>)
        {
            <b>string</b> <span id="r743 rd" class="r743 r">valueAsString</span> = <span class="r737 r">valueToConvert</span> <b>as string</b>;
            <b>object</b> <span id="r744 rd" class="r744 r">result</span> = <b>null</b>;
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Calling case sensitive Enum.Parse&quot;</span>);
            <b>try</b>
            {
                <span class="r744 r">result</span> = <span class="i">Enum</span>.<span class="i">Parse</span>(<span class="r738 r">resultType</span>, <span class="r743 r">valueAsString</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r745 rd" class="r745 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Enum.Parse Exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r745 r">e</span>.<span class="i">Message</span>);
                <span class="c">// Enum.Parse will always throw this kind of exception.</span>
                <span class="c">// Even when no map exists. We want to try without case sensitivity</span>
                <span class="c">// If it works, we will return it, otherwise a new exception will</span>
                <span class="c">// be thrown and we will use it to set exceptionToWrap</span>
                <b>try</b>
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Calling case insensitive Enum.Parse&quot;</span>);
                    <span class="r744 r">result</span> = <span class="i">Enum</span>.<span class="i">Parse</span>(<span class="r738 r">resultType</span>, <span class="r743 r">valueAsString</span>, <b>true</b>);
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r746 rd" class="r746 r">inner</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Enum.Parse Exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r746 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r747 rd" class="r747 r">ex</span>) <span class="c">// Enum.Parse might throw unadvertised exceptions</span>
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Case insensitive Enum.Parse threw an exception.&quot;</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;CaseInsensitiveEnumParseThrewAnException&quot;</span>, <span class="r747 r">ex</span>,
                            <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                            <span class="r737 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r738 r">resultType</span>.<span class="i">ToString</span>(), <span class="r747 r">ex</span>.<span class="i">Message</span>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r748 rd" class="r748 r">e</span>) <span class="c">// Enum.Parse might throw unadvertised exceptions</span>
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Case Sensitive Enum.Parse threw an exception.&quot;</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;CaseSensitiveEnumParseThrewAnException&quot;</span>, <span class="r748 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r737 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r738 r">resultType</span>.<span class="i">ToString</span>(), <span class="r748 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>if</b> (<span class="r744 r">result</span> == <b>null</b>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Calling substring disambiguation.&quot;</span>);
                <b>try</b>
                {
                    <b>string</b> <span id="r749 rd" class="r749 r">enumValue</span> = <a href="EnumMinimumDisambiguation.cs.html#7095a29d70fec885" class="t t">EnumMinimumDisambiguation</a>.<a href="EnumMinimumDisambiguation.cs.html#107bbc6ec432271c" class="i method">EnumDisambiguate</a>(<span class="r743 r">valueAsString</span>, <span class="r738 r">resultType</span>);
                    <span class="r744 r">result</span> = <span class="i">Enum</span>.<span class="i">Parse</span>(<span class="r738 r">resultType</span>, <span class="r749 r">enumValue</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r750 rd" class="r750 r">e</span>) <span class="c">// Wrap exceptions in type conversion exceptions</span>
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Substring disambiguation threw an exception.&quot;</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;SubstringDisambiguationEnumParseThrewAnException&quot;</span>, <span class="r750 r">e</span>,
                            <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                            <span class="r737 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r738 r">resultType</span>.<span class="i">ToString</span>(), <span class="r750 r">e</span>.<span class="i">Message</span>);
                }
            }
 
            <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#e14dda662bd93ed6" class="i method">ThrowForUndefinedEnum</a>(<span class="s">&quot;EnumParseUndefined&quot;</span>, <span class="r744 r">result</span>, <span class="r737 r">valueToConvert</span>, <span class="r738 r">resultType</span>);
            <a href="#54018625801279e1" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;returning \&quot;{0}\&quot; from conversion to Enum.&quot;</span>, <span class="r744 r">result</span>);
            <b>return</b> <span class="r744 r">result</span>;
        }
 
        <b>private static object</b> <a id="dc3b4eaca6b42bd1" href="../R/dc3b4eaca6b42bd1.html" target="n" data-glyph="76,1" class="i method">ConvertEnumerableToEnum</a>(<b>object</b> <span id="r751 rd" class="r751 r">valueToConvert</span>,
                                                      <span class="i">Type</span> <span id="r752 rd" class="r752 r">resultType</span>,
                                                      <b>bool</b> <span id="r753 rd" class="r753 r">recursion</span>,
                                                      <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r754 rd" class="r754 r">originalValueToConvert</span>,
                                                      <span class="i">IFormatProvider</span> <span id="r755 rd" class="r755 r">formatProvider</span>,
                                                      <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r756 rd" class="r756 r">backupTable</span>)
        {
            <span class="i">IEnumerator</span> <span id="r757 rd" class="r757 r">e</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r751 r">valueToConvert</span>);
            <span class="i">StringBuilder</span> <span id="r758 rd" class="r758 r">sbResult</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>bool</b> <span id="r759 rd" class="r759 r">notFirst</span> = <b>false</b>;
            <b>while</b> (<a href="lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="lang/parserutils.cs.html#5cba6b6355dba7e3" class="i method">MoveNext</a>(<b>null</b>, <b>null</b>, <span class="r757 r">e</span>))
            {
                <b>if</b> (<span class="r759 r">notFirst</span>)
                    <span class="r758 r">sbResult</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                <b>else</b>
                    <span class="r759 r">notFirst</span> = <b>true</b>;
                <b>string</b> <span id="r760 rd" class="r760 r">current</span> = <span class="r757 r">e</span>.<span class="i">Current</span> <b>as string</b>;
                <b>if</b> (<span class="r760 r">current</span> == <b>null</b>)
                {
                    <span class="c">// If the object wasn&#39;t a string, then we&#39;ll try and convert it into an enum value,</span>
                    <span class="c">// then convert the enum back to a string and finally append it to the string builder to</span>
                    <span class="c">// preserve consistent semantics between quoted and unquoted lists...</span>
                    <b>object</b> <span id="r761 rd" class="r761 r">tempResult</span> = <span class="i">ConvertTo</span>(<span class="r757 r">e</span>.<span class="i">Current</span>, <span class="r752 r">resultType</span>, <span class="r753 r">recursion</span>, <span class="r755 r">formatProvider</span>, <span class="r756 r">backupTable</span>);
                    <b>if</b> (<span class="r761 r">tempResult</span> != <b>null</b>)
                    {
                        <span class="r758 r">sbResult</span>.<span class="i">Append</span>(<span class="r761 r">tempResult</span>.<span class="i">ToString</span>());
                    }
                    <b>else</b>
                    {
                        <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastEnumStringNotFound&quot;</span>, <b>null</b>,
                          <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionEnumerationNoValue</span>,
                            <span class="r757 r">e</span>.<span class="i">Current</span>, <span class="r752 r">resultType</span>, <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#7e68d3d58478ec8d" class="i method">EnumValues</a>(<span class="r752 r">resultType</span>));
                    }
                }
 
                <span class="r758 r">sbResult</span>.<span class="i">Append</span>(<span class="r760 r">current</span>);
            }
 
            <b>return</b> <span class="i">ConvertStringToEnum</span>(<span class="r758 r">sbResult</span>.<span class="i">ToString</span>(), <span class="r752 r">resultType</span>, <span class="r753 r">recursion</span>, <span class="r754 r">originalValueToConvert</span>, <span class="r755 r">formatProvider</span>, <span class="r756 r">backupTable</span>);
        }
 
        <b>private sealed class</b> <a id="33a4b7adacd47510" href="../R/33a4b7adacd47510.html" target="n" data-glyph="4,1" class="t t">PSMethodToDelegateConverter</a>
        {
            <span class="c">// Index of the matching overload method.</span>
            <b>private readonly int</b> <a id="8f48d95a67606f2c" href="../R/8f48d95a67606f2c.html" target="n" data-glyph="46,2" class="i field">_matchIndex</a>;
            <span class="c">// Size of the cache. It&#39;s rare to have more than 10 overloads for a method.</span>
            <b>private const int</b> <a id="abecb2c11bd8cb43" href="../R/abecb2c11bd8cb43.html" target="n" data-glyph="10,2" class="i field">CacheSize</a> = 10;
 
            <b>private static readonly</b> <a href="#33a4b7adacd47510" class="t t">PSMethodToDelegateConverter</a>[] <a id="c6d69e1a5cc0c9d4" href="../R/c6d69e1a5cc0c9d4.html" target="n" data-glyph="46,2" class="i field">s_converterCache</a> = <b>new</b> <a href="#33a4b7adacd47510" class="t t">PSMethodToDelegateConverter</a>[<a href="#abecb2c11bd8cb43" class="i field">CacheSize</a>];
 
            <b>private</b> <a id="04239733b18b8dd5" href="../R/04239733b18b8dd5.html" target="n" data-glyph="76,2" class="t constructor">PSMethodToDelegateConverter</a>(<b>int</b> <span id="r762 rd" class="r762 r">matchIndex</span>)
            {
                <a href="#8f48d95a67606f2c" class="i field">_matchIndex</a> = <span class="r762 r">matchIndex</span>;
            }
 
            <b>internal static</b> <a href="#33a4b7adacd47510" class="t t">PSMethodToDelegateConverter</a> <a id="ba952aded00c0cdb" href="../R/ba952aded00c0cdb.html" target="n" data-glyph="74,2" class="i method">GetConverter</a>(<b>int</b> <span id="r763 rd" class="r763 r">matchIndex</span>)
            {
                <b>if</b> (<span class="r763 r">matchIndex</span> &gt;= <a href="#abecb2c11bd8cb43" class="i field">CacheSize</a>) { <b>return</b> <b>new</b> <a href="#04239733b18b8dd5" class="t constructor">PSMethodToDelegateConverter</a>(<span class="r763 r">matchIndex</span>); }
 
                <a href="#33a4b7adacd47510" class="k">var</a> <span id="r764 rd" class="r764 r">result</span> = <a href="#c6d69e1a5cc0c9d4" class="i field">s_converterCache</a>[<span class="r763 r">matchIndex</span>];
                <b>if</b> (<span class="r764 r">result</span> == <b>null</b>)
                {
                    <span class="c">// If the cache entry is null, generate a new instance for the cache slot.</span>
                    <a href="#33a4b7adacd47510" class="k">var</a> <span id="r765 rd" class="r765 r">converter</span> = <b>new</b> <a href="#04239733b18b8dd5" class="t constructor">PSMethodToDelegateConverter</a>(<span class="r763 r">matchIndex</span>);
                    <span class="i">Threading</span>.<span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#c6d69e1a5cc0c9d4" class="i field">s_converterCache</a>[<span class="r763 r">matchIndex</span>], <span class="r765 r">converter</span>, <b>null</b>);
                    <span class="r764 r">result</span> = <a href="#c6d69e1a5cc0c9d4" class="i field">s_converterCache</a>[<span class="r763 r">matchIndex</span>];
                }
 
                <b>return</b> <span class="r764 r">result</span>;
            }
 
            <b>internal</b> <span class="i">Delegate</span> <a id="1bd7318376208e6a" href="../R/1bd7318376208e6a.html" target="n" data-glyph="74,2" class="i method">Convert</a>(<b>object</b> <span id="r766 rd" class="r766 r">valueToConvert</span>,
                                      <span class="i">Type</span> <span id="r767 rd" class="r767 r">resultType</span>,
                                      <b>bool</b> <span id="r768 rd" class="r768 r">recursion</span>,
                                      <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r769 rd" class="r769 r">originalValueToConvert</span>,
                                      <span class="i">IFormatProvider</span> <span id="r770 rd" class="r770 r">formatProvider</span>,
                                      <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r771 rd" class="r771 r">backupTable</span>)
            {
                <span class="c">// We can only possibly convert PSMethod instance of the type PSMethod&lt;T&gt;.</span>
                <span class="c">// Such a PSMethod essentially represents a set of .NET method overloads.</span>
                <a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="k">var</a> <span id="r772 rd" class="r772 r">psMethod</span> = (<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>)<span class="r766 r">valueToConvert</span>;
 
                <b>try</b>
                {
                    <a href="CoreAdapter.cs.html#6dfefa2e34e759ac" class="k">var</a> <span id="r773 rd" class="r773 r">methods</span> = (<a href="CoreAdapter.cs.html#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>)<span class="r772 r">psMethod</span>.<a href="MshMemberInfo.cs.html#90d6e570e2f5700c" class="i field">adapterData</a>;
                    <b>var</b> <span id="r774 rd" class="r774 r">isStatic</span> = <span class="r772 r">psMethod</span>.<a href="MshMemberInfo.cs.html#014ea40b35222be9" class="i field">instance</a> <b>is</b> <span class="i">Type</span>;
 
                    <b>var</b> <span id="r775 rd" class="r775 r">candidate</span> = (<span class="i">MethodInfo</span>)<span class="r773 r">methods</span>.<a href="CoreAdapter.cs.html#faf234dfe054f8ec" class="i field">methodInformationStructures</a>[<a href="#8f48d95a67606f2c" class="i field">_matchIndex</a>].<a href="CoreAdapter.cs.html#3a0e575988f5a5de" class="i field">method</a>;
                    <b>return</b> <span class="r774 r">isStatic</span> ? <span class="r775 r">candidate</span>.<span class="i">CreateDelegate</span>(<span class="r767 r">resultType</span>)
                                    : <span class="r775 r">candidate</span>.<span class="i">CreateDelegate</span>(<span class="r767 r">resultType</span>, <span class="r772 r">psMethod</span>.<a href="MshMemberInfo.cs.html#014ea40b35222be9" class="i field">instance</a>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r776 rd" class="r776 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;PSMethod to Delegate exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r776 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastExceptionPSMethodToDelegate&quot;</span>, <span class="r776 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r766 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r767 r">resultType</span>.<span class="i">ToString</span>(), <span class="r776 r">e</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <b>private sealed class</b> <a id="b7f557047c829345" href="../R/b7f557047c829345.html" target="n" data-glyph="4,1" class="t t"><span id="7e0f776343f40e09">ConvertViaParseMethod</span></a>
        {
            <span class="c">// TODO - use an ETS wrapper that generates a dynamic method</span>
            <b>internal</b> <span class="i">MethodInfo</span> <a id="33afb746f0264712" href="../R/33afb746f0264712.html" target="n" data-glyph="44,2" class="i field">parse</a>;
 
            <b>internal object</b> <a id="713add7d41e075b1" href="../R/713add7d41e075b1.html" target="n" data-glyph="74,2" class="i method">ConvertWithCulture</a>(<b>object</b> <span id="r777 rd" class="r777 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r778 rd" class="r778 r">resultType</span>,
                                               <b>bool</b> <span id="r779 rd" class="r779 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r780 rd" class="r780 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r781 rd" class="r781 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r782 rd" class="r782 r">backupTable</span>)
            {
                <b>try</b>
                {
                    <b>object</b> <span id="r783 rd" class="r783 r">result</span> = <a href="#33afb746f0264712" class="i field">parse</a>.<span class="i">Invoke</span>(<b>null</b>, <b>new</b> <b>object</b>[2] { <span class="r777 r">valueToConvert</span>, <span class="r781 r">formatProvider</span> });
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Parse result: {0}&quot;</span>, <span class="r783 r">result</span>);
                    <b>return</b> <span class="r783 r">result</span>;
                }
                <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r784 rd" class="r784 r">ex</span>)
                {
                    <span class="i">Exception</span> <span id="r785 rd" class="r785 r">inner</span> = <span class="r784 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r784 r">ex</span>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception calling Parse method with CultureInfo: \&quot;{0}\&quot;.&quot;</span>, <span class="r785 r">inner</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastParseTargetInvocationWithFormatProvider&quot;</span>, <span class="r785 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r777 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r778 r">resultType</span>.<span class="i">ToString</span>(), <span class="r785 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r786 rd" class="r786 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception calling Parse method with CultureInfo: \&quot;{0}\&quot;.&quot;</span>, <span class="r786 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastParseExceptionWithFormatProvider&quot;</span>, <span class="r786 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r777 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r778 r">resultType</span>.<span class="i">ToString</span>(), <span class="r786 r">e</span>.<span class="i">Message</span>);
                }
            }
 
            <b>internal object</b> <a id="c4cc3e634ac4b69d" href="../R/c4cc3e634ac4b69d.html" target="n" data-glyph="74,2" class="i method">ConvertWithoutCulture</a>(<b>object</b> <span id="r787 rd" class="r787 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r788 rd" class="r788 r">resultType</span>,
                                                  <b>bool</b> <span id="r789 rd" class="r789 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r790 rd" class="r790 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r791 rd" class="r791 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r792 rd" class="r792 r">backupTable</span>)
            {
                <b>try</b>
                {
                    <b>object</b> <span id="r793 rd" class="r793 r">result</span> = <a href="#33afb746f0264712" class="i field">parse</a>.<span class="i">Invoke</span>(<b>null</b>, <b>new</b> <b>object</b>[1] { <span class="r787 r">valueToConvert</span> });
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Parse result: \&quot;{0}\&quot;.&quot;</span>, <span class="r793 r">result</span>);
                    <b>return</b> <span class="r793 r">result</span>;
                }
                <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r794 rd" class="r794 r">ex</span>)
                {
                    <span class="i">Exception</span> <span id="r795 rd" class="r795 r">inner</span> = <span class="r794 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r794 r">ex</span>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception calling Parse method: \&quot;{0}\&quot;.&quot;</span>, <span class="r795 r">inner</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastParseTargetInvocation&quot;</span>, <span class="r795 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r787 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r788 r">resultType</span>.<span class="i">ToString</span>(), <span class="r795 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r796 rd" class="r796 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception calling Parse method: \&quot;{0}\&quot;.&quot;</span>, <span class="r796 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastParseException&quot;</span>, <span class="r796 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r787 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r788 r">resultType</span>.<span class="i">ToString</span>(), <span class="r796 r">e</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <b>private sealed class</b> <a id="6c5b009c71b774cc" href="../R/6c5b009c71b774cc.html" target="n" data-glyph="4,1" class="t t"><span id="2ecd5987a7880c99">ConvertViaConstructor</span></a>
        {
            <b>internal</b> <span class="i">Func</span>&lt;<b>object</b>, <b>object</b>&gt; <a id="fd140f0c98b466f7" href="../R/fd140f0c98b466f7.html" target="n" data-glyph="44,2" class="i field">TargetCtorLambda</a>;
 
            <b>internal object</b> <a id="2b5b7493fc189405" href="../R/2b5b7493fc189405.html" target="n" data-glyph="74,2" class="i method">Convert</a>(<b>object</b> <span id="r797 rd" class="r797 r">valueToConvert</span>,
                                    <span class="i">Type</span> <span id="r798 rd" class="r798 r">resultType</span>,
                                    <b>bool</b> <span id="r799 rd" class="r799 r">recursion</span>,
                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r800 rd" class="r800 r">originalValueToConvert</span>,
                                    <span class="i">IFormatProvider</span> <span id="r801 rd" class="r801 r">formatProvider</span>,
                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r802 rd" class="r802 r">backupTable</span>)
            {
                <b>try</b>
                {
                    <b>object</b> <span id="r803 rd" class="r803 r">result</span> = <span class="i">TargetCtorLambda</span>(<span class="r797 r">valueToConvert</span>);
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Constructor result: \&quot;{0}\&quot;.&quot;</span>, <span class="r803 r">result</span>);
                    <b>return</b> <span class="r803 r">result</span>;
                }
                <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r804 rd" class="r804 r">ex</span>)
                {
                    <span class="i">Exception</span> <span id="r805 rd" class="r805 r">inner</span> = <span class="r804 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r804 r">ex</span>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception invoking Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r805 r">inner</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastConstructorTargetInvocationException&quot;</span>, <span class="r805 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r797 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r798 r">resultType</span>.<span class="i">ToString</span>(), <span class="r805 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r806 rd" class="r806 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception invoking Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r806 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastConstructorException&quot;</span>, <span class="r806 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r797 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r798 r">resultType</span>.<span class="i">ToString</span>(), <span class="r806 r">e</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a IList to hold all elements, and use the IList to create the object of the resultType.</span>
        <span class="c">///</span><span class="c"> The reason for using IList is that it can work on constructors that takes IEnumerable[T], ICollection[T] or IList[T].</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remark</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When get to this method, we know the fromType and the toType meet the following two conditions:</span>
        <span class="c">///</span><span class="c"> 1. toType is a closed generic type and it has a constructor that takes IEnumerable[T], ICollection[T] or IList[T]</span>
        <span class="c">///</span><span class="c"> 2. fromType is System.Array, System.Object[] or it&#39;s the same as the element type of toType</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remark</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="594d5424ccb583fb" href="../R/594d5424ccb583fb.html" target="n" data-glyph="4,1" class="t t"><span id="3fee5a30e4d1ed5f">ConvertViaIEnumerableConstructor</span></a>
        {
            <b>internal</b> <span class="i">Func</span>&lt;<b>int</b>, <span class="i">IList</span>&gt; <a id="f72673d7ed960b25" href="../R/f72673d7ed960b25.html" target="n" data-glyph="44,2" class="i field">ListCtorLambda</a>;
            <b>internal</b> <span class="i">Func</span>&lt;<span class="i">IList</span>, <b>object</b>&gt; <a id="463e5eee99b0f64b" href="../R/463e5eee99b0f64b.html" target="n" data-glyph="44,2" class="i field">TargetCtorLambda</a>;
 
            <b>internal</b> <span class="i">Type</span> <a id="954d2e8d4ffca4c8" href="../R/954d2e8d4ffca4c8.html" target="n" data-glyph="44,2" class="i field">ElementType</a>;
            <b>internal bool</b> <a id="55a0ce2b67204070" href="../R/55a0ce2b67204070.html" target="n" data-glyph="44,2" class="i field">IsScalar</a>;
 
            <b>internal object</b> <a id="e7bd5beb945b2ce5" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="i method">Convert</a>(<b>object</b> <span id="r807 rd" class="r807 r">valueToConvert</span>,
                                    <span class="i">Type</span> <span id="r808 rd" class="r808 r">resultType</span>,
                                    <b>bool</b> <span id="r809 rd" class="r809 r">recursion</span>,
                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r810 rd" class="r810 r">originalValueToConvert</span>,
                                    <span class="i">IFormatProvider</span> <span id="r811 rd" class="r811 r">formatProvider</span>,
                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r812 rd" class="r812 r">backupTable</span>)
            {
                <span class="i">IList</span> <span id="r813 rd" class="r813 r">resultAsList</span> = <b>null</b>;
                <span class="i">Array</span> <span id="r814 rd" class="r814 r">array</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <b>int</b> <span id="r815 rd" class="r815 r">listSize</span> = 0;
                    <b>if</b> (<a href="#55a0ce2b67204070" class="i field">IsScalar</a>)
                    {
                        <span class="r815 r">listSize</span> = 1;
                    }
                    <b>else</b>
                    {
                        <span class="c">// typeof(Array).IsAssignableFrom(typeof(object[])) == true</span>
                        <span class="r814 r">array</span> = <span class="r807 r">valueToConvert</span> <b>as</b> <span class="i">Array</span>;
                        <span class="r815 r">listSize</span> = <span class="r814 r">array</span> != <b>null</b> ? <span class="r814 r">array</span>.<span class="i">Length</span> : 1;
                    }
 
                    <span class="r813 r">resultAsList</span> = <span class="i">ListCtorLambda</span>(<span class="r815 r">listSize</span>);
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                    <a href="#c311d543b7a566e8" class="i method">ThrowInvalidCastException</a>(<span class="r807 r">valueToConvert</span>, <span class="r808 r">resultType</span>);
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;ThrowInvalidCastException always throws&quot;</span>);
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<a href="#55a0ce2b67204070" class="i field">IsScalar</a>)
                {
                    <span class="r813 r">resultAsList</span>.<span class="i">Add</span>(<span class="r807 r">valueToConvert</span>);
                }
                <b>else</b> <b>if</b> (<span class="r814 r">array</span> == <b>null</b>)
                {
                    <b>object</b> <span id="r816 rd" class="r816 r">convertedValue</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#0c97df7b75910bea" class="i method">ConvertTo</a>(<span class="r807 r">valueToConvert</span>, <a href="#954d2e8d4ffca4c8" class="i field">ElementType</a>, <span class="r811 r">formatProvider</span>);
                    <span class="r813 r">resultAsList</span>.<span class="i">Add</span>(<span class="r816 r">convertedValue</span>);
                }
                <b>else</b>
                {
                    <b>foreach</b> (<b>object</b> <span id="r817 rd" class="r817 r">item</span> <b>in</b> <span class="r814 r">array</span>)
                    {
                        <b>object</b> <span id="r818 rd" class="r818 r">baseObj</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r817 r">item</span>);
                        <b>object</b> <span id="r819 rd" class="r819 r">convertedValue</span>;
                        <b>if</b> (!<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#55c389faea5ed00f" class="i method">TryConvertTo</a>(<span class="r818 r">baseObj</span>, <a href="#954d2e8d4ffca4c8" class="i field">ElementType</a>, <span class="r811 r">formatProvider</span>, <b>out</b> <span class="r819 r">convertedValue</span>))
                        {
                            <a href="#c311d543b7a566e8" class="i method">ThrowInvalidCastException</a>(<span class="r807 r">valueToConvert</span>, <span class="r808 r">resultType</span>);
                            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;ThrowInvalidCastException always throws&quot;</span>);
                            <b>return</b> <b>null</b>;
                        }
                        <b>else</b>
                        {
                            <span class="r813 r">resultAsList</span>.<span class="i">Add</span>(<span class="r819 r">convertedValue</span>);
                        }
                    }
                }
 
                <b>try</b>
                {
                    <b>object</b> <span id="r820 rd" class="r820 r">result</span> = <span class="i">TargetCtorLambda</span>(<span class="r813 r">resultAsList</span>);
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;IEnumerable Constructor result: \&quot;{0}\&quot;.&quot;</span>, <span class="r820 r">result</span>);
                    <b>return</b> <span class="r820 r">result</span>;
                }
                <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r821 rd" class="r821 r">ex</span>)
                {
                    <span class="i">Exception</span> <span id="r822 rd" class="r822 r">inner</span> = <span class="r821 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r821 r">ex</span>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception invoking IEnumerable Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r822 r">inner</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastConstructorTargetInvocationException&quot;</span>, <span class="r822 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r807 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r808 r">resultType</span>.<span class="i">ToString</span>(), <span class="r822 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r823 rd" class="r823 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception invoking IEnumerable Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r823 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastConstructorException&quot;</span>, <span class="r823 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r807 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r808 r">resultType</span>.<span class="i">ToString</span>(), <span class="r823 r">e</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <b>private sealed class</b> <a id="550d2db25b155194" href="../R/550d2db25b155194.html" target="n" data-glyph="4,1" class="t t">ConvertViaNoArgumentConstructor</a>
        {
            <b>private readonly</b> <span class="i">Func</span>&lt;<b>object</b>&gt; <a id="d13739084d4b962a" href="../R/d13739084d4b962a.html" target="n" data-glyph="46,2" class="i field">_constructor</a>;
 
            <b>internal</b> <a id="2c6108280cdb13af" href="../R/2c6108280cdb13af.html" target="n" data-glyph="74,2" class="t constructor">ConvertViaNoArgumentConstructor</a>(<span class="i">ConstructorInfo</span> <span id="r824 rd" class="r824 r">constructor</span>, <span class="i">Type</span> <span id="r825 rd" class="r825 r">type</span>)
            {
                <b>var</b> <span id="r826 rd" class="r826 r">newExpr</span> = (<span class="r824 r">constructor</span> != <b>null</b>) ? <span class="i">Expression</span>.<span class="i">New</span>(<span class="r824 r">constructor</span>) : <span class="i">Expression</span>.<span class="i">New</span>(<span class="r825 r">type</span>);
                <a href="#d13739084d4b962a" class="i field">_constructor</a> = <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<span class="i">Func</span>&lt;<b>object</b>&gt;&gt;(<span class="r826 r">newExpr</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>))).<span class="i">Compile</span>();
            }
 
            <b>internal object</b> <a id="0e2a73daee8e219c" href="../R/0e2a73daee8e219c.html" target="n" data-glyph="74,2" class="i method">Convert</a>(<b>object</b> <span id="r827 rd" class="r827 r">valueToConvert</span>,
                                    <span class="i">Type</span> <span id="r828 rd" class="r828 r">resultType</span>,
                                    <b>bool</b> <span id="r829 rd" class="r829 r">recursion</span>,
                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r830 rd" class="r830 r">originalValueToConvert</span>,
                                    <span class="i">IFormatProvider</span> <span id="r831 rd" class="r831 r">formatProvider</span>,
                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r832 rd" class="r832 r">backupTable</span>)
            {
                <b>return</b> <a href="#41e27f8d00ea4eea" class="i method">Convert</a>(<span class="r827 r">valueToConvert</span>, <span class="r828 r">resultType</span>, <span class="r829 r">recursion</span>, <span class="r830 r">originalValueToConvert</span>, <span class="r831 r">formatProvider</span>, <span class="r832 r">backupTable</span>, <b>false</b>);
            }
 
            <b>internal object</b> <a id="41e27f8d00ea4eea" href="../R/41e27f8d00ea4eea.html" target="n" data-glyph="74,2" class="i method">Convert</a>(<b>object</b> <span id="r833 rd" class="r833 r">valueToConvert</span>,
                        <span class="i">Type</span> <span id="r834 rd" class="r834 r">resultType</span>,
                        <b>bool</b> <span id="r835 rd" class="r835 r">recursion</span>,
                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r836 rd" class="r836 r">originalValueToConvert</span>,
                        <span class="i">IFormatProvider</span> <span id="r837 rd" class="r837 r">formatProvider</span>,
                        <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r838 rd" class="r838 r">backupTable</span>, <b>bool</b> <span id="r839 rd" class="r839 r">ignoreUnknownMembers</span>)
            {
                <b>try</b>
                {
                    <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r840 rd" class="r840 r">ecFromTLS</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
                    <b>object</b> <span id="r841 rd" class="r841 r">result</span> = <b>null</b>;
 
                    <span class="c">// Setting arbitrary properties is dangerous, so we allow this only if</span>
                    <span class="c">//  - It&#39;s running on a thread without Runspace; Or</span>
                    <span class="c">//  - It&#39;s in FullLanguage but not because it&#39;s part of a parameter binding that is transitioning from ConstrainedLanguage to FullLanguage</span>
                    <span class="c">// When this is invoked from a parameter binding in transition from ConstrainedLanguage environment to FullLanguage command, we disallow</span>
                    <span class="c">// the property conversion because it&#39;s dangerous.</span>
                    <b>if</b> (<span class="r840 r">ecFromTLS</span> == <b>null</b> || (<span class="r840 r">ecFromTLS</span>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a> &amp;&amp; !<span class="r840 r">ecFromTLS</span>.<a href="ExecutionContext.cs.html#800d673aaa498da6" class="i property">LanguageModeTransitionInParameterBinding</a>))
                    {
                        <span class="r841 r">result</span> = <span class="i">_constructor</span>();
                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="k">var</a> <span id="r842 rd" class="r842 r">psobject</span> = <span class="r833 r">valueToConvert</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
                        <b>if</b> (<span class="r842 r">psobject</span> != <b>null</b>)
                        {
                            <span class="c">// Use PSObject properties to perform conversion.</span>
                            <a href="#c00deccb79db403f" class="i method">SetObjectProperties</a>(<span class="r841 r">result</span>, <span class="r842 r">psobject</span>, <span class="r834 r">resultType</span>, <a href="#de88274d889b52c9" class="i method">CreateMemberNotFoundError</a>, <a href="#a55e2124628e33f1" class="i method">CreateMemberSetValueError</a>, <span class="r837 r">formatProvider</span>, <span class="r835 r">recursion</span>, <span class="r839 r">ignoreUnknownMembers</span>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// Use provided property dictionary to perform conversion.</span>
                            <span class="c">// The method invocation is disabled for &quot;Hashtable to Object conversion&quot; (Win8:649519), but we need to keep it enabled for New-Object for compatibility to PSv2</span>
                            <span class="i">IDictionary</span> <span id="r843 rd" class="r843 r">properties</span> = <span class="r833 r">valueToConvert</span> <b>as</b> <span class="i">IDictionary</span>;
                            <a href="#29c875194761ece6" class="i method">SetObjectProperties</a>(<span class="r841 r">result</span>, <span class="r843 r">properties</span>, <span class="r834 r">resultType</span>, <a href="#de88274d889b52c9" class="i method">CreateMemberNotFoundError</a>, <a href="#a55e2124628e33f1" class="i method">CreateMemberSetValueError</a>, <span class="r844 r">enableMethodCall</span>: <b>false</b>);
                        }
 
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Constructor result: \&quot;{0}\&quot;.&quot;</span>, <span class="r841 r">result</span>);
                    }
                    <b>else</b>
                    {
                        <a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r845 rd" class="r845 r">rte</span> = <a href="lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<span class="r833 r">valueToConvert</span>, <b>typeof</b>(<a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <b>null</b>,
                            <span class="s">&quot;HashtableToObjectConversionNotSupportedInDataSection&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">HashtableToObjectConversionNotSupportedInDataSection</span>, <span class="r834 r">resultType</span>.<span class="i">ToString</span>());
                        <b>throw</b> <span class="r845 r">rte</span>;
                    }
 
                    <b>return</b> <span class="r841 r">result</span>;
                }
                <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r846 rd" class="r846 r">ex</span>)
                {
                    <span class="i">Exception</span> <span id="r847 rd" class="r847 r">inner</span> = <span class="r846 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r846 r">ex</span>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception invoking Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r847 r">inner</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastConstructorTargetInvocationException&quot;</span>, <span class="r847 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r833 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r834 r">resultType</span>.<span class="i">ToString</span>(), <span class="r847 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r848 rd" class="r848 r">e</span>)
                {
                    <span class="i">Exception</span> <span id="r849 rd" class="r849 r">inner</span> = <span class="r848 r">e</span>.<span class="i">InnerException</span> ?? <span class="r848 r">e</span>;
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;ObjectCreationError&quot;</span>, <span class="r848 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">ObjectCreationError</span>, <span class="r834 r">resultType</span>.<span class="i">ToString</span>(), <span class="r849 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a> <span id="r850 rd" class="r850 r">e</span>)
                {
                    <span class="i">Exception</span> <span id="r851 rd" class="r851 r">inner</span> = <span class="r850 r">e</span>.<span class="i">InnerException</span> ?? <span class="r850 r">e</span>;
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;ObjectCreationError&quot;</span>, <span class="r851 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">ObjectCreationError</span>, <span class="r834 r">resultType</span>.<span class="i">ToString</span>(), <span class="r851 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r852 rd" class="r852 r">ex</span>)
                {
                    <span class="i">Exception</span> <span id="r853 rd" class="r853 r">inner</span> = <span class="r852 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r852 r">ex</span>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception invoking Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r853 r">inner</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastConstructorException&quot;</span>, <span class="r853 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r833 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r834 r">resultType</span>.<span class="i">ToString</span>(), <span class="r853 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r854 rd" class="r854 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception invoking Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r854 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastConstructorException&quot;</span>, <span class="r854 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r833 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r834 r">resultType</span>.<span class="i">ToString</span>(), <span class="r854 r">e</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <b>private sealed class</b> <a id="e8276adf241f51b0" href="../R/e8276adf241f51b0.html" target="n" data-glyph="4,1" class="t t"><span id="cbee663f8f24c239">ConvertViaCast</span></a>
        {
            <b>internal</b> <span class="i">MethodInfo</span> <a id="db2a239f4aa1282b" href="../R/db2a239f4aa1282b.html" target="n" data-glyph="44,2" class="i field">cast</a>;
 
            <b>internal object</b> <a id="98c754e7235c5630" href="../R/98c754e7235c5630.html" target="n" data-glyph="74,2" class="i method">Convert</a>(<b>object</b> <span id="r855 rd" class="r855 r">valueToConvert</span>,
                                    <span class="i">Type</span> <span id="r856 rd" class="r856 r">resultType</span>,
                                    <b>bool</b> <span id="r857 rd" class="r857 r">recursion</span>,
                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r858 rd" class="r858 r">originalValueToConvert</span>,
                                    <span class="i">IFormatProvider</span> <span id="r859 rd" class="r859 r">formatProvider</span>,
                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r860 rd" class="r860 r">backupTable</span>)
            {
                <b>try</b>
                {
                    <b>return</b> <a href="#db2a239f4aa1282b" class="i field">cast</a>.<span class="i">Invoke</span>(<b>null</b>, <b>new</b> <b>object</b>[1] { <span class="r855 r">valueToConvert</span> });
                }
                <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r861 rd" class="r861 r">ex</span>)
                {
                    <span class="i">Exception</span> <span id="r862 rd" class="r862 r">inner</span> = <span class="r861 r">ex</span>.<span class="i">InnerException</span> ?? <span class="r861 r">ex</span>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Cast operator exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r862 r">inner</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastTargetInvocationException&quot;</span> + <a href="#db2a239f4aa1282b" class="i field">cast</a>.<span class="i">Name</span>, <span class="r862 r">inner</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r855 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r856 r">resultType</span>.<span class="i">ToString</span>(), <span class="r862 r">inner</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r863 rd" class="r863 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Cast operator exception: \&quot;{0}\&quot;.&quot;</span>, <span class="r863 r">e</span>.<span class="i">Message</span>);
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastException&quot;</span> + <a href="#db2a239f4aa1282b" class="i field">cast</a>.<span class="i">Name</span>, <span class="r863 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                        <span class="r855 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r856 r">resultType</span>.<span class="i">ToString</span>(), <span class="r863 r">e</span>.<span class="i">Message</span>);
                }
            }
        }
 
        <b>private static object</b> <a id="6770dc1cd67c15d7" href="../R/6770dc1cd67c15d7.html" target="n" data-glyph="76,1" class="i method">ConvertIConvertible</a>(<b>object</b> <span id="r864 rd" class="r864 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r865 rd" class="r865 r">resultType</span>,
                                                  <b>bool</b> <span id="r866 rd" class="r866 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r867 rd" class="r867 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r868 rd" class="r868 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r869 rd" class="r869 r">backupTable</span>)
        {
            <b>try</b>
            {
                <b>object</b> <span id="r870 rd" class="r870 r">result</span> = <span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r864 r">valueToConvert</span>, <span class="r865 r">resultType</span>, <span class="r868 r">formatProvider</span>);
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Conversion using IConvertible succeeded.&quot;</span>);
                <b>return</b> <span class="r870 r">result</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r871 rd" class="r871 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting with IConvertible: \&quot;{0}\&quot;.&quot;</span>, <span class="r871 r">e</span>.<span class="i">Message</span>);
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastIConvertible&quot;</span>, <span class="r871 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionWithInnerException</span>,
                    <span class="r864 r">valueToConvert</span>.<span class="i">ToString</span>(), <span class="r865 r">resultType</span>.<span class="i">ToString</span>(), <span class="r871 r">e</span>.<span class="i">Message</span>);
            }
        }
 
        <b>private static object</b> <a id="aaad1d54fa733681" href="../R/aaad1d54fa733681.html" target="n" data-glyph="76,1" class="i method">ConvertNumericIConvertible</a>(<b>object</b> <span id="r872 rd" class="r872 r">valueToConvert</span>,
                                                         <span class="i">Type</span> <span id="r873 rd" class="r873 r">resultType</span>,
                                                         <b>bool</b> <span id="r874 rd" class="r874 r">recursion</span>,
                                                         <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r875 rd" class="r875 r">originalValueToConvert</span>,
                                                         <span class="i">IFormatProvider</span> <span id="r876 rd" class="r876 r">formatProvider</span>,
                                                         <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r877 rd" class="r877 r">backupTable</span>)
        {
            <span class="c">// If the original object was a number, then try and do a conversion on the string</span>
            <span class="c">// equivalent of that number...</span>
            <b>if</b> (<span class="r875 r">originalValueToConvert</span> != <b>null</b> &amp;&amp; <span class="r875 r">originalValueToConvert</span>.<a href="MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a> != <b>null</b>)
            {
                <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#01ef0df31c173865" class="i method">ConvertTo</a>(<span class="r875 r">originalValueToConvert</span>.<a href="MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a>,
                    <span class="r873 r">resultType</span>, <span class="r874 r">recursion</span>, <span class="r876 r">formatProvider</span>, <span class="r877 r">backupTable</span>);
            }
            <b>else</b>
            {
                <span class="c">// Convert the source object to a string...</span>
                <b>string</b> <span id="r878 rd" class="r878 r">s</span> = (<b>string</b>)<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r872 r">valueToConvert</span>,
                    <b>typeof</b>(<b>string</b>), <span class="r874 r">recursion</span>, <span class="r876 r">formatProvider</span>, <span class="r877 r">backupTable</span>);
                <span class="c">// And try and convert that string to the target type...</span>
                <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#01ef0df31c173865" class="i method">ConvertTo</a>(<span class="r878 r">s</span>,
                    <span class="r873 r">resultType</span>, <span class="r874 r">recursion</span>, <span class="r876 r">formatProvider</span>, <span class="r877 r">backupTable</span>);
            }
        }
 
        <b>private sealed class</b> <a id="7dbd5fbce26e06cb" href="../R/7dbd5fbce26e06cb.html" target="n" data-glyph="4,1" class="t t"><span id="582f3ef29a4a31c9">ConvertCheckingForCustomConverter</span></a>
        {
            <b>internal</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <a id="5e0afd0f992118ed" href="../R/5e0afd0f992118ed.html" target="n" data-glyph="44,2" class="i field">tryfirstConverter</a>;
            <b>internal</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <a id="b29857abae703ca6" href="../R/b29857abae703ca6.html" target="n" data-glyph="44,2" class="i field">fallbackConverter</a>;
 
            <b>internal object</b> <a id="ce58e40bf9264a51" href="../R/ce58e40bf9264a51.html" target="n" data-glyph="74,2" class="i method">Convert</a>(<b>object</b> <span id="r879 rd" class="r879 r">valueToConvert</span>,
                                    <span class="i">Type</span> <span id="r880 rd" class="r880 r">resultType</span>,
                                    <b>bool</b> <span id="r881 rd" class="r881 r">recursion</span>,
                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r882 rd" class="r882 r">originalValueToConvert</span>,
                                    <span class="i">IFormatProvider</span> <span id="r883 rd" class="r883 r">formatProvider</span>,
                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r884 rd" class="r884 r">backupTable</span>)
            {
                <b>object</b> <span id="r885 rd" class="r885 r">result</span> = <b>null</b>;
 
                <b>if</b> (<a href="#5e0afd0f992118ed" class="i field">tryfirstConverter</a> != <b>null</b>)
                {
                    <b>try</b>
                    {
                        <b>return</b> <a href="#5e0afd0f992118ed" class="i field">tryfirstConverter</a>(<span class="r879 r">valueToConvert</span>, <span class="r880 r">resultType</span>, <span class="r881 r">recursion</span>, <span class="r882 r">originalValueToConvert</span>, <span class="r883 r">formatProvider</span>, <span class="r884 r">backupTable</span>);
                    }
                    <b>catch</b> (<span class="i">InvalidCastException</span>)
                    {
                    }
                }
 
                <b>if</b> (<span class="i">IsCustomTypeConversion</span>(<span class="r882 r">originalValueToConvert</span> ?? <span class="r879 r">valueToConvert</span>, <span class="r880 r">resultType</span>, <span class="r883 r">formatProvider</span>, <b>out</b> <span class="r885 r">result</span>, <span class="r884 r">backupTable</span>))
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Custom Type Conversion succeeded.&quot;</span>);
                    <b>return</b> <span class="r885 r">result</span>;
                }
 
                <b>if</b> (<a href="#b29857abae703ca6" class="i field">fallbackConverter</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#b29857abae703ca6" class="i field">fallbackConverter</a>(<span class="r879 r">valueToConvert</span>, <span class="r880 r">resultType</span>, <span class="r881 r">recursion</span>, <span class="r882 r">originalValueToConvert</span>, <span class="r883 r">formatProvider</span>, <span class="r884 r">backupTable</span>);
                }
 
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;ConvertToFinalInvalidCastException&quot;</span>, <b>null</b>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>,
                    <span class="r879 r">valueToConvert</span>.<span class="i">ToString</span>(), <a href="#bab300d080805cd3" class="i method">ObjectToTypeNameString</a>(<span class="r879 r">valueToConvert</span>), <span class="r880 r">resultType</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Delegates converting null
        <b>private static object</b> <a id="5e0e7e1331e76553" href="../R/5e0e7e1331e76553.html" target="n" data-glyph="76,1" class="i method">ConvertNullToNumeric</a>(
            <b>object</b> <span id="r886 rd" class="r886 r">valueToConvert</span>,
            <span class="i">Type</span> <span id="r887 rd" class="r887 r">resultType</span>,
            <b>bool</b> <span id="r888 rd" class="r888 r">recursion</span>,
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r889 rd" class="r889 r">originalValueToConvert</span>,
            <span class="i">IFormatProvider</span> <span id="r890 rd" class="r890 r">formatProvider</span>,
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r891 rd" class="r891 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting null to zero.&quot;</span>);
 
            <span class="c">// Handle BigInteger first, as it is not IConvertible</span>
            <b>if</b> (<span class="r887 r">resultType</span> == <b>typeof</b>(<span class="i">BigInteger</span>))
            {
                <b>return</b> <span class="i">BigInteger</span>.<span class="i">Zero</span>;
            }
 
            <span class="c">// If the destination type is numeric, convert 0 to resultType</span>
            <b>return</b> <span class="i n">System</span>.<span class="i">Convert</span>.<span class="i">ChangeType</span>(0, <span class="r887 r">resultType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <b>private static char</b> <a id="fb92488fae11cd7b" href="../R/fb92488fae11cd7b.html" target="n" data-glyph="76,1" class="i method">ConvertNullToChar</a>(<b>object</b> <span id="r892 rd" class="r892 r">valueToConvert</span>,
                                              <span class="i">Type</span> <span id="r893 rd" class="r893 r">resultType</span>,
                                              <b>bool</b> <span id="r894 rd" class="r894 r">recursion</span>,
                                              <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r895 rd" class="r895 r">originalValueToConvert</span>,
                                              <span class="i">IFormatProvider</span> <span id="r896 rd" class="r896 r">formatProvider</span>,
                                              <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r897 rd" class="r897 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting null to &#39;0&#39;.&quot;</span>);
            <b>return</b> <span class="s">&#39;\0&#39;</span>;
        }
 
        <b>private static string</b> <a id="915ab7cea095cbf1" href="../R/915ab7cea095cbf1.html" target="n" data-glyph="76,1" class="i method">ConvertNullToString</a>(<b>object</b> <span id="r898 rd" class="r898 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r899 rd" class="r899 r">resultType</span>,
                                                  <b>bool</b> <span id="r900 rd" class="r900 r">recursion</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r901 rd" class="r901 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r902 rd" class="r902 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r903 rd" class="r903 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting null to \&quot;\&quot;.&quot;</span>);
            <span class="c">// if the destination type is string, return an empty string...</span>
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
 
        <b>private static</b> <a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a> <a id="c4356bcb3709594b" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertNullToPSReference</a>(<b>object</b> <span id="r904 rd" class="r904 r">valueToConvert</span>,
                                                            <span class="i">Type</span> <span id="r905 rd" class="r905 r">resultType</span>,
                                                            <b>bool</b> <span id="r906 rd" class="r906 r">recursion</span>,
                                                            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r907 rd" class="r907 r">originalValueToConvert</span>,
                                                            <span class="i">IFormatProvider</span> <span id="r908 rd" class="r908 r">formatProvider</span>,
                                                            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r909 rd" class="r909 r">backupTable</span>)
        {
            <b>return</b> <b>new</b> <a href="MshReference.cs.html#f17a7cdc03ebed3f" class="t constructor">PSReference</a>&lt;<a href="#83ae667ba929e92f" class="t t">Null</a>&gt;(<b>null</b>);
        }
 
        <b>private static object</b> <a id="6d956b6365fc7577" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertNullToRef</a>(<b>object</b> <span id="r910 rd" class="r910 r">valueToConvert</span>,
                                               <span class="i">Type</span> <span id="r911 rd" class="r911 r">resultType</span>,
                                               <b>bool</b> <span id="r912 rd" class="r912 r">recursion</span>,
                                               <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r913 rd" class="r913 r">originalValueToConvert</span>,
                                               <span class="i">IFormatProvider</span> <span id="r914 rd" class="r914 r">formatProvider</span>,
                                               <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r915 rd" class="r915 r">backupTable</span>)
        {
            <span class="c">// if the target type is not a value type, return the original</span>
            <span class="c">// &quot;null&quot; object. Don&#39;t just return null because we want to preserve</span>
            <span class="c">// an msh object if possible.</span>
            <b>return</b> <span class="r910 r">valueToConvert</span>;
        }
 
        <b>private static bool</b> <a id="75ca83ee6632433a" href="../R/75ca83ee6632433a.html" target="n" data-glyph="76,1" class="i method">ConvertNullToBool</a>(<b>object</b> <span id="r916 rd" class="r916 r">valueToConvert</span>,
                                              <span class="i">Type</span> <span id="r917 rd" class="r917 r">resultType</span>,
                                              <b>bool</b> <span id="r918 rd" class="r918 r">recursion</span>,
                                              <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r919 rd" class="r919 r">originalValueToConvert</span>,
                                              <span class="i">IFormatProvider</span> <span id="r920 rd" class="r920 r">formatProvider</span>,
                                              <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r921 rd" class="r921 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting null to boolean.&quot;</span>);
            <b>return</b> <b>false</b>;
        }
 
        <b>private static object</b> <a id="decc4b002a22534e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertNullToNullable</a>(<b>object</b> <span id="r922 rd" class="r922 r">valueToConvert</span>,
                                                    <span class="i">Type</span> <span id="r923 rd" class="r923 r">resultType</span>,
                                                    <b>bool</b> <span id="r924 rd" class="r924 r">recursion</span>,
                                                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r925 rd" class="r925 r">originalValueToConvert</span>,
                                                    <span class="i">IFormatProvider</span> <span id="r926 rd" class="r926 r">formatProvider</span>,
                                                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r927 rd" class="r927 r">backupTable</span>)
        {
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="b758c55a0bc6b735" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertNullToSwitch</a>(<b>object</b> <span id="r928 rd" class="r928 r">valueToConvert</span>,
                                                           <span class="i">Type</span> <span id="r929 rd" class="r929 r">resultType</span>,
                                                           <b>bool</b> <span id="r930 rd" class="r930 r">recursion</span>,
                                                           <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r931 rd" class="r931 r">originalValueToConvert</span>,
                                                           <span class="i">IFormatProvider</span> <span id="r932 rd" class="r932 r">formatProvider</span>,
                                                           <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r933 rd" class="r933 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting null to SwitchParameter(false).&quot;</span>);
            <b>return</b> <b>new</b> <a href="MshCmdlet.cs.html#bc9e109b8e1a51f1" class="t constructor">SwitchParameter</a>(<b>false</b>);
        }
 
        <b>private static object</b> <a id="b28f085db8e8444c" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConvertNullToVoid</a>(<b>object</b> <span id="r934 rd" class="r934 r">valueToConvert</span>,
                                                <span class="i">Type</span> <span id="r935 rd" class="r935 r">resultType</span>,
                                                <b>bool</b> <span id="r936 rd" class="r936 r">recursion</span>,
                                                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r937 rd" class="r937 r">originalValueToConvert</span>,
                                                <span class="i">IFormatProvider</span> <span id="r938 rd" class="r938 r">formatProvider</span>,
                                                <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r939 rd" class="r939 r">backupTable</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Converting null to AutomationNull.Value.&quot;</span>);
            <b>return</b> <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Delegates converting null
 
        <b>private static object</b> <a id="e305b87a9a31c9e7" href="../R/e305b87a9a31c9e7.html" target="n" data-glyph="76,1" class="i method">ConvertNoConversion</a>(<b>object</b> <span id="r940 rd" class="r940 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r941 rd" class="r941 r">resultType</span>,
                                                  <b>bool</b> <span id="r942 rd" class="r942 r">recurse</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r943 rd" class="r943 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r944 rd" class="r944 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r945 rd" class="r945 r">backupTable</span>)
        {
            <a href="#c311d543b7a566e8" class="i method">ThrowInvalidCastException</a>(<span class="r940 r">valueToConvert</span>, <span class="r941 r">resultType</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;ThrowInvalidCastException always throws&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>private static object</b> <a id="be111174c897918e" href="../R/be111174c897918e.html" target="n" data-glyph="76,1" class="i method">ConvertNotSupportedConversion</a>(<b>object</b> <span id="r946 rd" class="r946 r">valueToConvert</span>,
                                                  <span class="i">Type</span> <span id="r947 rd" class="r947 r">resultType</span>,
                                                  <b>bool</b> <span id="r948 rd" class="r948 r">recurse</span>,
                                                  <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r949 rd" class="r949 r">originalValueToConvert</span>,
                                                  <span class="i">IFormatProvider</span> <span id="r950 rd" class="r950 r">formatProvider</span>,
                                                  <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r951 rd" class="r951 r">backupTable</span>)
        {
            <a href="#b7c0fbfa4a69c84b" class="i method">ThrowInvalidConversionException</a>(<span class="r946 r">valueToConvert</span>, <span class="r947 r">resultType</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;ThrowInvalidCastException always throws&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">DebuggerDisplay</span>(<span class="s">&quot;{from.Name}-&gt;{to.Name}&quot;</span>)]
        <b>private struct</b> <a id="b8125258350d7139" href="../R/b8125258350d7139.html" target="n" data-glyph="112,1" class="t t"><span id="19c68cc42b7b5833">ConversionTypePair</span></a>
        {
            <b>internal</b> <span class="i">Type</span> <a id="9b28d4a60f80d46d" href="../R/9b28d4a60f80d46d.html" target="n" data-glyph="44,2" class="i field">from</a>;
            <b>internal</b> <span class="i">Type</span> <a id="c12d6c52af88cbb2" href="../R/c12d6c52af88cbb2.html" target="n" data-glyph="44,2" class="i field">to</a>;
 
            <b>internal</b> <a id="26e22fbb3f2136a1" href="../R/26e22fbb3f2136a1.html" target="n" data-glyph="74,2" class="t constructor">ConversionTypePair</a>(<span class="i">Type</span> <span id="r952 rd" class="r952 r">fromType</span>, <span class="i">Type</span> <span id="r953 rd" class="r953 r">toType</span>)
            {
                <a href="#9b28d4a60f80d46d" class="i field">from</a> = <span class="r952 r">fromType</span>;
                <a href="#c12d6c52af88cbb2" class="i field">to</a> = <span class="r953 r">toType</span>;
            }
 
            <b>public override int</b> <a id="c1a3f7f77ad65de4" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">GetHashCode</a>()
            {
                <b>unchecked</b>
                {
                    <span class="c">// To prevent to/from == from/to, multiply and add rather than use</span>
                    <span class="c">// an operation that won&#39;t overflow, like bitwise xor.</span>
                    <b>return</b> <a href="#9b28d4a60f80d46d" class="i field">from</a>.<span class="i">GetHashCode</span>() + 37 * <a href="#c12d6c52af88cbb2" class="i field">to</a>.<span class="i">GetHashCode</span>();
                }
            }
 
            <b>public override bool</b> <a id="e7811bb6d011d954" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Equals</a>(<b>object</b> <span id="r954 rd" class="r954 r">other</span>)
            {
                <b>if</b> (<span class="r954 r">other</span> <b>is not</b> <a href="#b8125258350d7139" class="t t">ConversionTypePair</a>)
                    <b>return</b> <b>false</b>;
 
                <a href="#b8125258350d7139" class="k">var</a> <span id="r955 rd" class="r955 r">ctp</span> = (<a href="#b8125258350d7139" class="t t">ConversionTypePair</a>)<span class="r954 r">other</span>;
                <b>return</b> <a href="#b8125258350d7139" class="k">this</a>.<a href="#9b28d4a60f80d46d" class="i field">from</a> == <span class="r955 r">ctp</span>.<a href="#9b28d4a60f80d46d" class="i field">from</a> &amp;&amp; <a href="#b8125258350d7139" class="k">this</a>.<a href="#c12d6c52af88cbb2" class="i field">to</a> == <span class="r955 r">ctp</span>.<a href="#c12d6c52af88cbb2" class="i field">to</a>;
            }
        }
 
        <b>internal delegate</b> <span class="r956 r t">T</span> <a id="73844e56b52453f7" href="../R/73844e56b52453f7.html" target="n" data-glyph="14,1" class="t t"><span id="c2dbbfc29ae1679c">PSConverter</span></a>&lt;<span id="r956 rd t" class="r956 r t">T</span>&gt;(<b>object</b> <span id="r957 rd" class="r957 r">valueToConvert</span>,
                                           <span class="i">Type</span> <span id="r958 rd" class="r958 r">resultType</span>,
                                           <b>bool</b> <span id="r959 rd" class="r959 r">recurse</span>,
                                           <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r960 rd" class="r960 r">originalValueToConvert</span>,
                                           <span class="i">IFormatProvider</span> <span id="r961 rd" class="r961 r">formatProvider</span>,
                                           <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r962 rd" class="r962 r">backupTable</span>);
 
        <b>internal delegate object</b> <a id="e24149370007deb7" href="../R/../../0000000000.html" target="n" data-glyph="14,1" class="t t"><span id="3c2998fdaaa2734c">PSNullConverter</span></a>(<b>object</b> <span id="r963 rd" class="r963 r">nullOrAutomationNull</span>);
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
        <b>internal interface</b> <a id="4cbbe0ec8ab6946f" href="../R/4cbbe0ec8ab6946f.html" target="n" data-glyph="50,1" class="t t">IConversionData</a>
        {
            <b>object</b> <a id="8b52e90c75297a45" href="../R/8b52e90c75297a45.html" target="n" data-glyph="102,2" class="i property">Converter</a> { <b>get</b>; }
 
            <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <a id="fcaf7d7aa628a092" href="../R/fcaf7d7aa628a092.html" target="n" data-glyph="102,2" class="i property">Rank</a> { <b>get</b>; }
 
            <b>object</b>? <a id="fa3abde27e849363" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Invoke</a>(<b>object</b>? <span id="r964 rd" class="r964 r">valueToConvert</span>,
                          <span class="i">Type</span> <span id="r965 rd" class="r965 r">resultType</span>,
                          <b>bool</b> <span id="r966 rd" class="r966 r">recurse</span>,
                          <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>? <span id="r967 rd" class="r967 r">originalValueToConvert</span>,
                          <span class="i">IFormatProvider</span>? <span id="r968 rd" class="r968 r">formatProvider</span>,
                          <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>? <span id="r969 rd" class="r969 r">backupTable</span>);
        }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">DebuggerDisplay</span>(<span class="s">&quot;{_converter.Method.Name}&quot;</span>)]
        <b>internal class</b> <a id="ce2e37c22cd659bb" href="../R/ce2e37c22cd659bb.html" target="n" data-glyph="2,1" class="t t">ConversionData</a>&lt;<span id="r970 rd t" class="r970 r t">T</span>&gt; : <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a>
        {
            <b>private readonly</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<span class="r970 r t">T</span>&gt; <a id="de14c6368257c07f" href="../R/de14c6368257c07f.html" target="n" data-glyph="46,2" class="i field">_converter</a>;
 
            <b>public</b> <a id="12b2b1e2fcd7a4bf" href="../R/12b2b1e2fcd7a4bf.html" target="n" data-glyph="72,2" class="t constructor">ConversionData</a>(<a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<span class="r970 r t">T</span>&gt; <span id="r971 rd" class="r971 r">converter</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r972 rd" class="r972 r">rank</span>)
            {
                <a href="#de14c6368257c07f" class="i field">_converter</a> = <span class="r971 r">converter</span>;
                <a href="#a3e8639c1605fcc7" class="i property">Rank</a> = <span class="r972 r">rank</span>;
            }
 
            <b>public object</b> <a id="43590480672cecd8" href="../R/43590480672cecd8.html" target="n" data-glyph="102,2" class="i property">Converter</a>
            {
                <b>get</b> { <b>return</b> <a href="#de14c6368257c07f" class="i field">_converter</a>; }
            }
 
            <b>public</b> <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <a id="a3e8639c1605fcc7" href="../R/a3e8639c1605fcc7.html" target="n" data-glyph="102,2" class="i property">Rank</a> { <b>get</b>; }
 
            <b>public object</b> <a id="36bb9503ed7bac71" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Invoke</a>(<b>object</b> <span id="r973 rd" class="r973 r">valueToConvert</span>, <span class="i">Type</span> <span id="r974 rd" class="r974 r">resultType</span>, <b>bool</b> <span id="r975 rd" class="r975 r">recurse</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r976 rd" class="r976 r">originalValueToConvert</span>, <span class="i">IFormatProvider</span> <span id="r977 rd" class="r977 r">formatProvider</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r978 rd" class="r978 r">backupTable</span>)
            {
                <b>return</b> <a href="#de14c6368257c07f" class="i field">_converter</a>.<a href="#f8cc456fcceb3ab1" class="i method">Invoke</a>(<span class="r973 r">valueToConvert</span>, <span class="r974 r">resultType</span>, <span class="r975 r">recurse</span>, <span class="r976 r">originalValueToConvert</span>, <span class="r977 r">formatProvider</span>, <span class="r978 r">backupTable</span>);
            }
        }
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<a href="#b8125258350d7139" class="t t">ConversionTypePair</a>, <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a>&gt; <a id="6f6f3ba9b6d4a00c" href="../R/6f6f3ba9b6d4a00c.html" target="n" data-glyph="46,1" class="i field">s_converterCache</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="#b8125258350d7139" class="t t">ConversionTypePair</a>, <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a>&gt;(256);
 
        <b>private static</b> <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <a id="b2b73461cc3ff1d7" href="../R/b2b73461cc3ff1d7.html" target="n" data-glyph="76,1" class="i method">CacheConversion</a>&lt;<span id="r979 rd t" class="r979 r t">T</span>&gt;(<span class="i">Type</span> <span id="r980 rd" class="r980 r">fromType</span>, <span class="i">Type</span> <span id="r981 rd" class="r981 r">toType</span>, <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<span class="r979 r t">T</span>&gt; <span id="r982 rd" class="r982 r">converter</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r983 rd" class="r983 r">rank</span>)
        {
            <a href="#b8125258350d7139" class="t t">ConversionTypePair</a> <span id="r984 rd" class="r984 r">pair</span> = <b>new</b> <a href="#26e22fbb3f2136a1" class="t constructor">ConversionTypePair</a>(<span class="r980 r">fromType</span>, <span class="r981 r">toType</span>);
            <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r985 rd" class="r985 r">data</span> = <b>null</b>;
            <b>lock</b> (<a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>)
            {
                <b>if</b> (!<a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>.<span class="i">TryGetValue</span>(<span class="r984 r">pair</span>, <b>out</b> <span class="r985 r">data</span>))
                {
                    <span class="r985 r">data</span> = <b>new</b> <a href="#12b2b1e2fcd7a4bf" class="t constructor">ConversionData</a>&lt;<span class="r979 r t">T</span>&gt;(<span class="r982 r">converter</span>, <span class="r983 r">rank</span>);
                    <a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>.<span class="i">Add</span>(<span class="r984 r">pair</span>, <span class="r985 r">data</span>);
                }
                <b>else</b>
                {
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(((<span class="i">Delegate</span>)(<span class="r985 r">data</span>.<a href="#8b52e90c75297a45" class="i property">Converter</a>)).<span class="i">GetMethodInfo</span>().<span class="i">Equals</span>(<span class="r982 r">converter</span>.<span class="i">GetMethodInfo</span>()),
                        <span class="s">&quot;Existing conversion isn&#39;t the same as new conversion&quot;</span>);
                }
            }
 
            <b>return</b> <span class="r985 r">data</span>;
        }
 
        <b>private static</b> <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <a id="3561be37d82691c4" href="../R/3561be37d82691c4.html" target="n" data-glyph="76,1" class="i method">GetConversionData</a>(<span class="i">Type</span> <span id="r986 rd" class="r986 r">fromType</span>, <span class="i">Type</span> <span id="r987 rd" class="r987 r">toType</span>)
        {
            <b>lock</b> (<a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>)
            {
                <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r988 rd" class="r988 r">result</span> = <b>null</b>;
                <a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>.<span class="i">TryGetValue</span>(<b>new</b> <a href="#26e22fbb3f2136a1" class="t constructor">ConversionTypePair</a>(<span class="r986 r">fromType</span>, <span class="r987 r">toType</span>), <b>out</b> <span class="r988 r">result</span>);
                <b>return</b> <span class="r988 r">result</span>;
            }
        }
 
        <b>internal static</b> <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <a id="33facd506a7034a5" href="../R/33facd506a7034a5.html" target="n" data-glyph="74,1" class="i method">GetConversionRank</a>(<span class="i">Type</span> <span id="r989 rd" class="r989 r">fromType</span>, <span class="i">Type</span> <span id="r990 rd" class="r990 r">toType</span>)
        {
            <b>return</b> <a href="#7b24dbc305e38140" class="i method">FigureConversion</a>(<span class="r989 r">fromType</span>, <span class="r990 r">toType</span>).<a href="#fcaf7d7aa628a092" class="i property">Rank</a>;
        }
 
        <b>private static readonly</b> <span class="i">Type</span>[] <a id="c309327afc07323b" href="../R/c309327afc07323b.html" target="n" data-glyph="46,1" class="i field">s_numericTypes</a> = <b>new</b> <span class="i">Type</span>[] {
            <b>typeof</b>(<span class="i">Int16</span>), <b>typeof</b>(<span class="i">Int32</span>), <b>typeof</b>(<span class="i">Int64</span>),
            <b>typeof</b>(<span class="i">UInt16</span>), <b>typeof</b>(<span class="i">UInt32</span>), <b>typeof</b>(<span class="i">UInt64</span>),
            <b>typeof</b>(<b>sbyte</b>), <b>typeof</b>(<b>byte</b>),
            <b>typeof</b>(<span class="i">Single</span>), <b>typeof</b>(<b>double</b>), <b>typeof</b>(<b>decimal</b>),
            <b>typeof</b>(<span class="i">BigInteger</span>)
        };
 
        <b>private static readonly</b> <span class="i">Type</span>[] <a id="a8903067b2516be4" href="../R/a8903067b2516be4.html" target="n" data-glyph="46,1" class="i field">s_integerTypes</a> = <b>new</b> <span class="i">Type</span>[] {
            <b>typeof</b>(<span class="i">Int16</span>), <b>typeof</b>(<span class="i">Int32</span>), <b>typeof</b>(<span class="i">Int64</span>),
            <b>typeof</b>(<span class="i">UInt16</span>), <b>typeof</b>(<span class="i">UInt32</span>), <b>typeof</b>(<span class="i">UInt64</span>),
            <b>typeof</b>(<b>sbyte</b>), <b>typeof</b>(<b>byte</b>)
        };
 
        <span class="c">// Do not reorder the elements of these arrays, we depend on them being ordered by increasing size.</span>
        <b>private static readonly</b> <span class="i">Type</span>[] <a id="42a506d16f34f500" href="../R/42a506d16f34f500.html" target="n" data-glyph="46,1" class="i field">s_signedIntegerTypes</a> = <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>sbyte</b>), <b>typeof</b>(<span class="i">Int16</span>), <b>typeof</b>(<span class="i">Int32</span>), <b>typeof</b>(<span class="i">Int64</span>) };
        <b>private static readonly</b> <span class="i">Type</span>[] <a id="bf8da9dd18b8325f" href="../R/bf8da9dd18b8325f.html" target="n" data-glyph="46,1" class="i field">s_unsignedIntegerTypes</a> = <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>byte</b>), <b>typeof</b>(<span class="i">UInt16</span>), <b>typeof</b>(<span class="i">UInt32</span>), <b>typeof</b>(<span class="i">UInt64</span>) };
 
        <b>private static readonly</b> <span class="i">Type</span>[] <a id="4f5e9e2deb85a4e0" href="../R/4f5e9e2deb85a4e0.html" target="n" data-glyph="46,1" class="i field">s_realTypes</a> = <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i">Single</span>), <b>typeof</b>(<b>double</b>), <b>typeof</b>(<b>decimal</b>) };
 
        <b>internal static void</b> <a id="1992af74786afb21" href="../R/1992af74786afb21.html" target="n" data-glyph="74,1" class="i method">RebuildConversionCache</a>()
        {
            <b>lock</b> (<a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>)
            {
                <a href="#6f6f3ba9b6d4a00c" class="i field">s_converterCache</a>.<span class="i">Clear</span>();
 
                <span class="i">Type</span> <span id="r991 rd" class="r991 r">typeofString</span> = <b>typeof</b>(<b>string</b>);
                <span class="i">Type</span> <span id="r992 rd" class="r992 r">typeofNull</span> = <b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>);
                <span class="i">Type</span> <span id="r993 rd" class="r993 r">typeofFloat</span> = <b>typeof</b>(<b>float</b>);
                <span class="i">Type</span> <span id="r994 rd" class="r994 r">typeofDouble</span> = <b>typeof</b>(<b>double</b>);
                <span class="i">Type</span> <span id="r995 rd" class="r995 r">typeofDecimal</span> = <b>typeof</b>(<b>decimal</b>);
                <span class="i">Type</span> <span id="r996 rd" class="r996 r">typeofBool</span> = <b>typeof</b>(<b>bool</b>);
                <span class="i">Type</span> <span id="r997 rd" class="r997 r">typeofChar</span> = <b>typeof</b>(<b>char</b>);
                <b>foreach</b> (<span class="i">Type</span> <span id="r998 rd" class="r998 r">type</span> <b>in</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#c309327afc07323b" class="i field">s_numericTypes</a>)
                {
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>string</b>&gt;(<span class="r998 r">type</span>, <span class="r991 r">typeofString</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#db06ae62b63dd650" class="i method">ConvertNumericToString</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#bcc2ea1096285fba" class="i field">NumericString</a>);
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r998 r">type</span>, <span class="r997 r">typeofChar</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#6770dc1cd67c15d7" class="i method">ConvertIConvertible</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#bcc2ea1096285fba" class="i field">NumericString</a>);
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r992 r">typeofNull</span>, <span class="r998 r">type</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#5e0e7e1331e76553" class="i method">ConvertNullToNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#ec18e6e3fbcda029" class="i field">NullToValue</a>);
                }
 
                <span class="i">CacheConversion</span>&lt;<b>object</b>&gt;(<span class="r996 r">typeofBool</span>, <b>typeof</b>(<span class="i">BigInteger</span>), <span class="i">ConvertBoolToBigInteger</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
 
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">Int16</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertInt16ToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">Int32</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertInt32ToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">Int64</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertInt64ToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">UInt16</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertUInt16ToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">UInt32</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertUInt32ToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">UInt64</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertUInt64ToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<b>sbyte</b>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertSByteToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<b>byte</b>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertByteToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">Single</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertSingleToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<b>double</b>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertDoubleToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<b>decimal</b>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertDecimalToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<span class="i">BigInteger</span>), <span class="r996 r">typeofBool</span>, <span class="i">ConvertBigIntegerToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
 
                <b>for</b> (<b>int</b> <span id="r999 rd" class="r999 r">i</span> = 0; <span class="r999 r">i</span> &lt; <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>.<span class="i">Length</span>; <span class="r999 r">i</span>++)
                {
                    <span class="c">// Identical types are an identity conversion.</span>
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>],
                                            <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#d99994607ce557b4" class="i method">ConvertAssignableFrom</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#0c841bf014a77138" class="i field">Identity</a>);
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>],
                                            <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#d99994607ce557b4" class="i method">ConvertAssignableFrom</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#0c841bf014a77138" class="i field">Identity</a>);
 
                    <span class="c">// Unsigned to signed same size is explicit</span>
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>],
                                            <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                    <span class="c">// Signed to unsigned same size is explicit, but better than the reverse (because it is &quot;more specific&quot;)</span>
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>],
                                            <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6c6ff0ec53840343" class="i field">NumericExplicit1</a>);
 
                    <b>for</b> (<b>int</b> <span id="r1000 rd" class="r1000 r">j</span> = <span class="r999 r">i</span> + 1; <span class="r1000 r">j</span> &lt; <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>.<span class="i">Length</span>; <span class="r1000 r">j</span>++)
                    {
                        <span class="c">// Conversions where the sign doesn&#39;t change, but the size is bigger, is implicit</span>
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r1000 r">j</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#2c07b8fc3068341e" class="i field">NumericImplicit</a>);
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r1000 r">j</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#2c07b8fc3068341e" class="i field">NumericImplicit</a>);
 
                        <span class="c">// Conversion from smaller unsigned to bigger signed is implicit</span>
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r1000 r">j</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#2c07b8fc3068341e" class="i field">NumericImplicit</a>);
                        <span class="c">// Conversion from smaller signed to bigger unsigned is the &quot;better&quot; explicit conversion</span>
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>], <a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r1000 r">j</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6c6ff0ec53840343" class="i field">NumericExplicit1</a>);
 
                        <span class="c">// Conversion to a smaller type is explicit</span>
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r1000 r">j</span>], <a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r1000 r">j</span>], <a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r1000 r">j</span>], <a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r999 r">i</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<a href="#42a506d16f34f500" class="i field">s_signedIntegerTypes</a>[<span class="r1000 r">j</span>], <a href="#bf8da9dd18b8325f" class="i field">s_unsignedIntegerTypes</a>[<span class="r999 r">i</span>],
                                                <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                    }
                }
 
                <b>foreach</b> (<span class="i">Type</span> <span id="r1001 rd" class="r1001 r">integerType</span> <b>in</b> <a href="#a8903067b2516be4" class="i field">s_integerTypes</a>)
                {
                    <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r991 r">typeofString</span>, <span class="r1001 r">integerType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#82e8835ccfc75587" class="i method">ConvertStringToInteger</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#bcc2ea1096285fba" class="i field">NumericString</a>);
 
                    <b>foreach</b> (<span class="i">Type</span> <span id="r1002 rd" class="r1002 r">realType</span> <b>in</b> <a href="#4f5e9e2deb85a4e0" class="i field">s_realTypes</a>)
                    {
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1001 r">integerType</span>, <span class="r1002 r">realType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#2c07b8fc3068341e" class="i field">NumericImplicit</a>);
                        <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1002 r">realType</span>, <span class="r1001 r">integerType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                    }
                }
 
                <span class="i">CacheConversion</span>&lt;<b>object</b>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">BigInteger</span>), <span class="i">ConvertStringToInteger</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#bcc2ea1096285fba" class="i field">NumericString</a>);
 
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r993 r">typeofFloat</span>, <span class="r994 r">typeofDouble</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#2c07b8fc3068341e" class="i field">NumericImplicit</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r994 r">typeofDouble</span>, <span class="r993 r">typeofFloat</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r993 r">typeofFloat</span>, <span class="r995 r">typeofDecimal</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r994 r">typeofDouble</span>, <span class="r995 r">typeofDecimal</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7beaf716047c64c8" class="i field">NumericExplicit</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r995 r">typeofDecimal</span>, <span class="r993 r">typeofFloat</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6c6ff0ec53840343" class="i field">NumericExplicit1</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r995 r">typeofDecimal</span>, <span class="r994 r">typeofDouble</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#4ef47841da578cef" class="i method">ConvertNumeric</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6c6ff0ec53840343" class="i field">NumericExplicit1</a>);
 
                <span class="i">CacheConversion</span>&lt;<span class="i">Regex</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">Regex</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertStringToRegex</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>char</b>[]&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<b>char</b>[]), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertStringToCharArray</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#51b3b36a7d4ddc29" class="i field">StringToCharArray</a>);
                <span class="i">CacheConversion</span>&lt;<span class="i">Type</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">Type</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertStringToType</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<span class="i">Uri</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">Uri</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertStringToUri</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r991 r">typeofString</span>, <span class="r995 r">typeofDecimal</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#afd67b7626eb1faa" class="i method">ConvertStringToDecimal</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#bcc2ea1096285fba" class="i field">NumericString</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r991 r">typeofString</span>, <span class="r993 r">typeofFloat</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#147308c0929755b8" class="i method">ConvertStringToReal</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#bcc2ea1096285fba" class="i field">NumericString</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r991 r">typeofString</span>, <span class="r994 r">typeofDouble</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#147308c0929755b8" class="i method">ConvertStringToReal</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#bcc2ea1096285fba" class="i field">NumericString</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r997 r">typeofChar</span>, <span class="r993 r">typeofFloat</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#2b0af5f49363b2ae" class="i method">ConvertNumericChar</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r997 r">typeofChar</span>, <span class="r994 r">typeofDouble</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#2b0af5f49363b2ae" class="i method">ConvertNumericChar</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>bool</b>&gt;(<span class="r997 r">typeofChar</span>, <span class="r996 r">typeofBool</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#23436eb08f3434ca" class="i method">ConvertCharToBool</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
 
                <span class="c">// Conversions from null</span>
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>char</b>&gt;(<span class="r992 r">typeofNull</span>, <span class="r997 r">typeofChar</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#fb92488fae11cd7b" class="i method">ConvertNullToChar</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#ec18e6e3fbcda029" class="i field">NullToValue</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>string</b>&gt;(<span class="r992 r">typeofNull</span>, <span class="r991 r">typeofString</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#915ab7cea095cbf1" class="i method">ConvertNullToString</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#2533e8d6de5d8a90" class="i field">ToString</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>bool</b>&gt;(<span class="r992 r">typeofNull</span>, <span class="r996 r">typeofBool</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#75ca83ee6632433a" class="i method">ConvertNullToBool</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#ec18e6e3fbcda029" class="i field">NullToValue</a>);
                <span class="i">CacheConversion</span>&lt;<a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>&gt;(<span class="r992 r">typeofNull</span>, <b>typeof</b>(<a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertNullToPSReference</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#92e8b910569c4813" class="i field">NullToRef</a>);
                <span class="i">CacheConversion</span>&lt;<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>&gt;(<span class="r992 r">typeofNull</span>, <b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertNullToSwitch</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#ec18e6e3fbcda029" class="i field">NullToValue</a>);
                <span class="i">CacheConversion</span>&lt;<b>object</b>&gt;(<span class="r992 r">typeofNull</span>, <b>typeof</b>(<b>void</b>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertNullToVoid</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#ec18e6e3fbcda029" class="i field">NullToValue</a>);
 
                <span class="c">// Conversions to bool</span>
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r996 r">typeofBool</span>, <span class="r996 r">typeofBool</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#d99994607ce557b4" class="i method">ConvertAssignableFrom</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#0c841bf014a77138" class="i field">Identity</a>);
                <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>bool</b>&gt;(<span class="r991 r">typeofString</span>, <span class="r996 r">typeofBool</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#189c84c3efe24445" class="i method">ConvertStringToBool</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<b>bool</b>&gt;(<b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>), <span class="r996 r">typeofBool</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertSwitchParameterToBool</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                <span class="c">// Conversions to WMI and ADSI</span>
                <span class="i">CacheConversion</span>&lt;<span class="i">ManagementObjectSearcher</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">ManagementObjectSearcher</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertToWMISearcher</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<span class="i">ManagementClass</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">ManagementClass</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertToWMIClass</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<span class="i">ManagementObject</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">ManagementObject</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertToWMI</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<span class="i">DirectoryEntry</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">DirectoryEntry</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertToADSI</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                <span class="i">CacheConversion</span>&lt;<span class="i">DirectorySearcher</span>&gt;(<span class="r991 r">typeofString</span>, <b>typeof</b>(<span class="i">DirectorySearcher</span>), <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertToADSISearcher</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
        }
 
        <b>internal static</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="c00deccb79db403f" href="../R/c00deccb79db403f.html" target="n" data-glyph="74,1" class="i method">SetObjectProperties</a>(<b>object</b> <span id="r1003 rd" class="r1003 r">o</span>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1004 rd" class="r1004 r">psObject</span>, <span class="i">Type</span> <span id="r1005 rd" class="r1005 r">resultType</span>, <a href="#21598b5c2e54fc8d" class="t t">MemberNotFoundError</a> <span id="r1006 rd" class="r1006 r">memberNotFoundErrorAction</span>, <a href="#7c91f72dbdf7ca36" class="t t">MemberSetValueError</a> <span id="r1007 rd" class="r1007 r">memberSetValueErrorAction</span>, <span class="i">IFormatProvider</span> <span id="r1008 rd" class="r1008 r">formatProvider</span>, <b>bool</b> <span id="r1009 rd" class="r1009 r">recursion</span> = <b>false</b>, <b>bool</b> <span id="r1010 rd" class="r1010 r">ignoreUnknownMembers</span> = <b>false</b>)
        {
            <span class="c">// Type conversion from object properties only supported for deserialized types.</span>
            <b>if</b> (<a href="serialization.cs.html#27835b221aec7524" class="t t">Deserializer</a>.<a href="serialization.cs.html#bedc3ec1f782a8e0" class="i method">IsDeserializedInstanceOfType</a>(<span class="r1004 r">psObject</span>, <span class="r1005 r">resultType</span>))
            {
                <b>try</b>
                {
                    <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r1011 rd" class="r1011 r">properties</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;();
                    <b>foreach</b> (<b>var</b> <span id="r1012 rd" class="r1012 r">item</span> <b>in</b> <span class="r1004 r">psObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                    {
                        <b>if</b> (<span class="r1012 r">item</span> <b>is</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>)
                        {
                            <span class="r1011 r">properties</span>.<span class="i">Add</span>(<span class="r1012 r">item</span>.<span class="i">Name</span>, <span class="r1012 r">item</span>.<span class="i">Value</span>);
                        }
                    }
 
                    <span class="c">// Win8:649519</span>
                    <b>return</b> <span class="i">SetObjectProperties</span>(<span class="r1003 r">o</span>, <span class="r1011 r">properties</span>, <span class="r1005 r">resultType</span>, <span class="r1006 r">memberNotFoundErrorAction</span>, <span class="r1007 r">memberSetValueErrorAction</span>, <span class="i">enableMethodCall</span>: <b>false</b>);
                }
                <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a>)
                { }
                <b>catch</b> (<span class="i">InvalidOperationException</span>)
                { }
            }
            <b>else</b>
            {
                <b>object</b> <span id="r1013 rd" class="r1013 r">baseObj</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1004 r">psObject</span>);
                <b>var</b> <span id="r1014 rd" class="r1014 r">dictionary</span> = <span class="r1013 r">baseObj</span> <b>as</b> <span class="i">IDictionary</span>;
                <b>if</b> (<span class="r1014 r">dictionary</span> != <b>null</b>)
                {
                    <span class="c">// Win8:649519</span>
                    <b>return</b> <a href="#29c875194761ece6" class="i method">SetObjectProperties</a>(<span class="r1003 r">o</span>, <span class="r1014 r">dictionary</span>, <span class="r1005 r">resultType</span>, <span class="r1006 r">memberNotFoundErrorAction</span>, <span class="r1007 r">memberSetValueErrorAction</span>, <span class="r844 r">enableMethodCall</span>: <b>false</b>);
                }
                <b>else</b>
                {
                    <span class="c">// Support PSObject to Strong type conversion.</span>
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1015 rd" class="r1015 r">psBaseObject</span> = <span class="r1013 r">baseObj</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
                    <b>if</b> (<span class="r1015 r">psBaseObject</span> != <b>null</b>)
                    {
                        <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r1016 rd" class="r1016 r">properties</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;();
                        <b>foreach</b> (<b>var</b> <span id="r1017 rd" class="r1017 r">item</span> <b>in</b> <span class="r1015 r">psBaseObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                        {
                            <span class="r1016 r">properties</span>.<span class="i">Add</span>(<span class="r1017 r">item</span>.<span class="i">Name</span>, <span class="r1017 r">item</span>.<span class="i">Value</span>);
                        }
 
                        <b>try</b>
                        {
                            <b>return</b> <span class="i">SetObjectProperties</span>(<span class="r1003 r">o</span>, <span class="r1016 r">properties</span>, <span class="r1005 r">resultType</span>, <span class="r1006 r">memberNotFoundErrorAction</span>, <span class="r1007 r">memberSetValueErrorAction</span>, <b>false</b>, <span class="r1008 r">formatProvider</span>, <span class="r1009 r">recursion</span>, <span class="r1010 r">ignoreUnknownMembers</span>);
                        }
                        <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r1018 rd" class="r1018 r">exception</span>)
                        {
                            <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;ConvertToFinalInvalidCastException&quot;</span>, <span class="r1018 r">exception</span>,
                                 <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>,
                                 <span class="r1004 r">psObject</span>.<a href="MshObject.cs.html#298666357e641f03" class="i method">ToString</a>(), <a href="#bab300d080805cd3" class="i method">ObjectToTypeNameString</a>(<span class="r1004 r">psObject</span>),
                                 <span class="r1005 r">resultType</span>.<span class="i">ToString</span>());
                        }
                    }
                }
            }
 
            <a href="#c311d543b7a566e8" class="i method">ThrowInvalidCastException</a>(<span class="r1004 r">psObject</span>, <span class="r1005 r">resultType</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="29c875194761ece6" href="../R/29c875194761ece6.html" target="n" data-glyph="74,1" class="i method">SetObjectProperties</a>(<b>object</b> <span id="r1019 rd" class="r1019 r">o</span>, <span class="i">IDictionary</span> <span id="r1020 rd" class="r1020 r">properties</span>, <span class="i">Type</span> <span id="r1021 rd" class="r1021 r">resultType</span>, <a href="#21598b5c2e54fc8d" class="t t">MemberNotFoundError</a> <span id="r1022 rd" class="r1022 r">memberNotFoundErrorAction</span>, <a href="#7c91f72dbdf7ca36" class="t t">MemberSetValueError</a> <span id="r1023 rd" class="r1023 r">memberSetValueErrorAction</span>, <b>bool</b> <span id="r844 rd" class="r844 r">enableMethodCall</span>)
        {
            <b>return</b> <span class="i">SetObjectProperties</span>(<span class="r1019 r">o</span>, <span class="r1020 r">properties</span>, <span class="r1021 r">resultType</span>, <span class="r1022 r">memberNotFoundErrorAction</span>, <span class="r1023 r">memberSetValueErrorAction</span>, <span class="r844 r">enableMethodCall</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>false</b>, <b>false</b>);
        }
 
        <b>internal static</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="1ea94435d98119c9" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetObjectProperties</a>(<b>object</b> <span id="r1024 rd" class="r1024 r">o</span>, <span class="i">IDictionary</span> <span id="r1025 rd" class="r1025 r">properties</span>, <span class="i">Type</span> <span id="r1026 rd" class="r1026 r">resultType</span>, <a href="#21598b5c2e54fc8d" class="t t">MemberNotFoundError</a> <span id="r1027 rd" class="r1027 r">memberNotFoundErrorAction</span>, <a href="#7c91f72dbdf7ca36" class="t t">MemberSetValueError</a> <span id="r1028 rd" class="r1028 r">memberSetValueErrorAction</span>, <b>bool</b> <span id="r1029 rd" class="r1029 r">enableMethodCall</span>, <span class="i">IFormatProvider</span> <span id="r1030 rd" class="r1030 r">formatProvider</span>, <b>bool</b> <span id="r1031 rd" class="r1031 r">recursion</span> = <b>false</b>, <b>bool</b> <span id="r1032 rd" class="r1032 r">ignoreUnknownMembers</span> = <b>false</b>)
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1033 rd" class="r1033 r">pso</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r1024 r">o</span>);
            <b>if</b> (<span class="r1025 r">properties</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r1034 rd" class="r1034 r">prop</span> <b>in</b> <span class="r1025 r">properties</span>)
                {
                    <a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a> <span id="r1035 rd" class="r1035 r">method</span> = <span class="r1029 r">enableMethodCall</span> ? <span class="r1033 r">pso</span>.<a href="MshObject.cs.html#6cb42c4e7cce30cd" class="i property">Methods</a>[<span class="r1034 r">prop</span>.<span class="i">Key</span>.<span class="i">ToString</span>()] : <b>null</b>;
                    <b>try</b>
                    {
                        <b>if</b> (<span class="r1035 r">method</span> != <b>null</b>)
                        {
                            <span class="r1035 r">method</span>.<a href="MshMemberInfo.cs.html#f4f9695891d65945" class="i method">Invoke</a>(<b>new</b> <b>object</b>[] { <span class="r1034 r">prop</span>.<span class="i">Value</span> });
                        }
                        <b>else</b>
                        {
                            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r1036 rd" class="r1036 r">property</span> = <span class="r1033 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r1034 r">prop</span>.<span class="i">Key</span>.<span class="i">ToString</span>()];
                            <b>if</b> (<span class="r1036 r">property</span> != <b>null</b>)
                            {
                                <b>object</b> <span id="r1037 rd" class="r1037 r">propValue</span> = <span class="r1034 r">prop</span>.<span class="i">Value</span>;
                                <b>if</b> (<span class="r1031 r">recursion</span> &amp;&amp; <span class="r1034 r">prop</span>.<span class="i">Value</span> != <b>null</b>)
                                {
                                    <span class="i">Type</span> <span id="r1038 rd" class="r1038 r">propType</span>;
                                    <b>if</b> (<a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#3fb063578567b37c" class="i method">TryResolveType</a>(<span class="r1036 r">property</span>.<a href="MshMemberInfo.cs.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, <b>out</b> <span class="r1038 r">propType</span>))
                                    {
                                        <b>if</b> (<span class="r1030 r">formatProvider</span> == <b>null</b>) { <span class="r1030 r">formatProvider</span> = <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>; }
 
                                        <b>try</b>
                                        {
                                            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1039 rd" class="r1039 r">propertyValue</span> = <span class="r1034 r">prop</span>.<span class="i">Value</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
                                            <b>if</b> (<span class="r1039 r">propertyValue</span> != <b>null</b>)
                                            {
                                                <span class="r1037 r">propValue</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#031b850807a55641" class="i method">ConvertPSObjectToType</a>(<span class="r1039 r">propertyValue</span>, <span class="r1038 r">propType</span>, <span class="r1031 r">recursion</span>, <span class="r1030 r">formatProvider</span>, <span class="r1032 r">ignoreUnknownMembers</span>);
                                            }
                                            <b>else</b> <b>if</b> (<span class="r1034 r">prop</span>.<span class="i">Value</span> <b>is</b> <a href="MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>)
                                            {
                                                <span class="r1037 r">propValue</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#031b850807a55641" class="i method">ConvertPSObjectToType</a>(<b>new</b> <span class="t">PSObject</span>(<span class="r1034 r">prop</span>.<span class="i">Value</span>), <span class="r1038 r">propType</span>, <span class="r1031 r">recursion</span>, <span class="r1030 r">formatProvider</span>, <span class="r1032 r">ignoreUnknownMembers</span>);
                                            }
                                            <b>else</b>
                                            {
                                                <span class="r1037 r">propValue</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r1034 r">prop</span>.<span class="i">Value</span>, <span class="r1038 r">propType</span>, <span class="r1031 r">recursion</span>, <span class="r1030 r">formatProvider</span>, <b>null</b>);
                                            }
                                        }
                                        <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a>)
                                        {
                                            <span class="c">// We don&#39;t care. We will assign the value as is.</span>
                                        }
                                    }
                                }
 
                                <span class="r1036 r">property</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> = <span class="r1037 r">propValue</span>;
                            }
                            <b>else</b>
                            {
                                <b>if</b> (<span class="r1033 r">pso</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>)
                                {
                                    <b>var</b> <span id="r1040 rd" class="r1040 r">key</span> = <span class="r1034 r">prop</span>.<span class="i">Key</span> <b>as string</b>;
                                    <b>var</b> <span id="r1041 rd" class="r1041 r">value</span> = <span class="r1034 r">prop</span>.<span class="i">Value</span> <b>as string</b>;
                                    <b>if</b> (<span class="r1040 r">key</span> != <b>null</b> &amp;&amp; <span class="r1041 r">value</span> != <b>null</b> &amp;&amp; <span class="r1040 r">key</span>.<span class="i">Equals</span>(<span class="s">&quot;PSTypeName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <span class="r1033 r">pso</span>.<a href="MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Insert</span>(0, <span class="r1041 r">value</span>);
                                    }
                                    <b>else</b>
                                    {
                                        <span class="r1033 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r1034 r">prop</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <span class="r1034 r">prop</span>.<span class="i">Value</span>));
                                    }
                                }
                                <b>else</b>
                                {
                                    <b>if</b> (!<span class="r1032 r">ignoreUnknownMembers</span>)
                                    {
                                        <span class="r1027 r">memberNotFoundErrorAction</span>(<span class="r1033 r">pso</span>, <span class="r1034 r">prop</span>, <span class="r1026 r">resultType</span>);
                                    }
                                }
                            }
                        }
                    }
                    <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a> <span id="r1042 rd" class="r1042 r">e</span>)
                    {
                        <span class="r1028 r">memberSetValueErrorAction</span>(<span class="r1042 r">e</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r1033 r">pso</span>;
        }
 
        <b>private static string</b> <a id="ddf4994d76f0a81e" href="../R/ddf4994d76f0a81e.html" target="n" data-glyph="76,1" class="i method">GetAvailableProperties</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1043 rd" class="r1043 r">pso</span>)
        {
            <span class="i">StringBuilder</span> <span id="r1044 rd" class="r1044 r">availableProperties</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>bool</b> <span id="r1045 rd" class="r1045 r">first</span> = <b>true</b>;
 
            <b>if</b> (<span class="r1043 r">pso</span> != <b>null</b> &amp;&amp; <span class="r1043 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r1046 rd" class="r1046 r">p</span> <b>in</b> <span class="r1043 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                {
                    <b>if</b> (!<span class="r1045 r">first</span>)
                    {
                        <span class="r1044 r">availableProperties</span>.<span class="i">Append</span>(<span class="s">&quot; , &quot;</span>);
                    }
 
                    <span class="r1044 r">availableProperties</span>.<span class="i">Append</span>(<span class="s">&quot;[&quot;</span> + <span class="r1046 r">p</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a> + <span class="s">&quot; &lt;&quot;</span> + <span class="r1046 r">p</span>.<a href="MshMemberInfo.cs.html#af662506826a4d3d" class="i property">TypeNameOfValue</a> + <span class="s">&quot;&gt;]&quot;</span>);
                    <b>if</b> (<span class="r1045 r">first</span>)
                    {
                        <span class="r1045 r">first</span> = <b>false</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r1044 r">availableProperties</span>.<span class="i">ToString</span>();
        }
 
        <b>internal static</b> <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <a id="2b600779afb85e55" href="../R/2b600779afb85e55.html" target="n" data-glyph="74,1" class="i method">FigureConversion</a>(<b>object</b> <span id="r1047 rd" class="r1047 r">valueToConvert</span>, <span class="i">Type</span> <span id="r1048 rd" class="r1048 r">resultType</span>, <b>out bool</b> <span id="r1049 rd" class="r1049 r">debase</span>)
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1050 rd" class="r1050 r">valueAsPsObj</span>;
            <span class="i">Type</span> <span id="r1051 rd" class="r1051 r">originalType</span>;
            <b>if</b> (<span class="r1047 r">valueToConvert</span> == <b>null</b> || <span class="r1047 r">valueToConvert</span> == <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
            {
                <span class="r1050 r">valueAsPsObj</span> = <b>null</b>;
                <span class="r1051 r">originalType</span> = <b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>);
            }
            <b>else</b>
            {
                <span class="r1050 r">valueAsPsObj</span> = <span class="r1047 r">valueToConvert</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
                <span class="r1051 r">originalType</span> = <span class="r1047 r">valueToConvert</span>.<span class="i">GetType</span>();
            }
 
            <span class="r1049 r">debase</span> = <b>false</b>;
 
            <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r1052 rd" class="r1052 r">data</span> = <a href="#7b24dbc305e38140" class="i method">FigureConversion</a>(<span class="r1051 r">originalType</span>, <span class="r1048 r">resultType</span>);
            <b>if</b> (<span class="r1052 r">data</span>.<a href="#fcaf7d7aa628a092" class="i property">Rank</a> != <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>)
            {
                <b>return</b> <span class="r1052 r">data</span>;
            }
 
            <b>if</b> (<span class="r1050 r">valueAsPsObj</span> != <b>null</b>)
            {
                <span class="r1049 r">debase</span> = <b>true</b>;
 
                <span class="c">// Now try converting PSObject.Base instead.</span>
                <span class="r1047 r">valueToConvert</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1047 r">valueToConvert</span>);
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r1047 r">valueToConvert</span> != <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>, <span class="s">&quot;PSObject.Base converts AutomationNull.Value to null&quot;</span>);
 
                <b>if</b> (<span class="r1047 r">valueToConvert</span> == <b>null</b>)
                {
                    <span class="r1051 r">originalType</span> = <b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>);
                }
                <b>else</b>
                {
                    <span class="c">// If the original value was a property bag (empty PSObject), we won&#39;t find a conversion because</span>
                    <span class="c">// all PSObject conversions have already been checked.</span>
                    <span class="c">//</span>
                    <span class="c">// Still, there are many valid conversions to allow, such as PSObject to bool, void, or</span>
                    <span class="c">// a custom type converter.  To find those, we consider InternalPSObject=&gt;resultType instead.</span>
                    <span class="c">//</span>
                    <span class="c">// We use a different type because we can&#39;t keep PSObject as the from type in the cache.</span>
                    <span class="r1051 r">originalType</span> = (<span class="r1047 r">valueToConvert</span> <b>is</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>) ? <b>typeof</b>(<a href="#5f55a01138afb49d" class="t t">InternalPSObject</a>) : <span class="r1047 r">valueToConvert</span>.<span class="i">GetType</span>();
                }
 
                <span class="r1052 r">data</span> = <a href="#7b24dbc305e38140" class="i method">FigureConversion</a>(<span class="r1051 r">originalType</span>, <span class="r1048 r">resultType</span>);
            }
 
            <b>return</b> <span class="r1052 r">data</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1053 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The same as in the public version.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1054 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The same as in the public version.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1055 r">recursion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if we should perform any recursive calls to ConvertTo.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1056 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Governing conversion of types.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1057 r">backupTypeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Remoting Rehydration Logic. While Deserializing a remote object,</span>
        <span class="c">///</span><span class="c"> LocalPipeline.ExecutionContextFromTLS() might return null..In which case this</span>
        <span class="c">///</span><span class="c"> TypeTable will be used to do the conversion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value converted.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If resultType is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If the conversion failed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="01ef0df31c173865" href="../R/01ef0df31c173865.html" target="n" data-glyph="74,1" class="i method">ConvertTo</a>(<b>object</b> <span id="r1053 rd" class="r1053 r">valueToConvert</span>,
                                         <span class="i">Type</span> <span id="r1054 rd" class="r1054 r">resultType</span>,
                                         <b>bool</b> <span id="r1055 rd" class="r1055 r">recursion</span>,
                                         <span class="i">IFormatProvider</span> <span id="r1056 rd" class="r1056 r">formatProvider</span>,
                                         <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r1057 rd" class="r1057 r">backupTypeTable</span>)
        {
            <b>using</b> (<a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">TraceScope</span>(<span class="s">&quot;Converting \&quot;{0}\&quot; to \&quot;{1}\&quot;.&quot;</span>, <span class="r1053 r">valueToConvert</span>, <span class="r1054 r">resultType</span>))
            {
                <b>if</b> (<span class="r1054 r">resultType</span> == <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1054 r">resultType</span>));
                }
 
                <b>bool</b> <span id="r1058 rd" class="r1058 r">debase</span>;
                <a href="#4cbbe0ec8ab6946f" class="k">var</a> <span id="r1059 rd" class="r1059 r">conversion</span> = <a href="#2b600779afb85e55" class="i method">FigureConversion</a>(<span class="r1053 r">valueToConvert</span>, <span class="r1054 r">resultType</span>, <b>out</b> <span class="r1058 r">debase</span>);
 
                <b>return</b> <span class="r1059 r">conversion</span>.<span class="i">Invoke</span>(
                    <span class="r1058 r">debase</span> ? <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1053 r">valueToConvert</span>) : <span class="r1053 r">valueToConvert</span>,
                    <span class="r1054 r">resultType</span>,
                    <span class="r1055 r">recursion</span>,
                    <span class="r1058 r">debase</span> ? (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r1053 r">valueToConvert</span> : <b>null</b>,
                    <span class="r1056 r">formatProvider</span>,
                    <span class="r1057 r">backupTypeTable</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the errorId and errorMessage for an InvalidCastException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1060 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1061 r">resultType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A two-element tuple indicating [errorId, errorMsg]</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="dd6b89a235fa47d9" href="../R/dd6b89a235fa47d9.html" target="n" data-glyph="74,1" class="i method">GetInvalidCastMessages</a>(<b>object</b> <span id="r1060 rd" class="r1060 r">valueToConvert</span>, <span class="i">Type</span> <span id="r1061 rd" class="r1061 r">resultType</span>)
        {
            <b>string</b> <span id="r1062 rd" class="r1062 r">errorId</span>, <span id="r1063 rd" class="r1063 r">errorMsg</span>;
            <b>if</b> (<span class="r1061 r">resultType</span>.<span class="i">IsByRefLike</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Cannot convert to ByRef-Like types as they should be used on stack only.&quot;</span>);
                <span class="r1062 r">errorId</span> = <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastToByRefLikeType</span>);
                <span class="r1063 r">errorMsg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastToByRefLikeType</span>, <span class="r1061 r">resultType</span>);
                <b>return</b> <span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r1062 r">errorId</span>, <span class="r1063 r">errorMsg</span>);
            }
 
            <b>if</b> (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1060 r">valueToConvert</span>) == <b>null</b>)
            {
                <b>if</b> (<span class="r1061 r">resultType</span>.<span class="i">IsEnum</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Issuing an error message about not being able to convert null to an Enum type.&quot;</span>);
                    <span class="c">// a nice error message specifically for null being converted to enum</span>
                    <span class="r1062 r">errorId</span> = <span class="s">&quot;nullToEnumInvalidCast&quot;</span>;
                    <span class="r1063 r">errorMsg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionEnumerationNull</span>, <span class="r1061 r">resultType</span>,
                                                 <a href="#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="#7e68d3d58478ec8d" class="i method">EnumValues</a>(<span class="r1061 r">resultType</span>));
                    <b>return</b> <span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r1062 r">errorId</span>, <span class="r1063 r">errorMsg</span>);
                }
 
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Cannot convert null.&quot;</span>);
                <span class="c">// finally throw of all other value types...</span>
                <span class="r1062 r">errorId</span> = <span class="s">&quot;nullToObjectInvalidCast&quot;</span>;
                <span class="r1063 r">errorMsg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastFromNull</span>, <span class="r1061 r">resultType</span>.<span class="i">ToString</span>());
                <b>return</b> <span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r1062 r">errorId</span>, <span class="r1063 r">errorMsg</span>);
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Type Conversion failed.&quot;</span>);
            <span class="r1062 r">errorId</span> = <span class="s">&quot;ConvertToFinalInvalidCastException&quot;</span>;
            <span class="r1063 r">errorMsg</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>, <span class="r1060 r">valueToConvert</span>.<span class="i">ToString</span>(),
                                         <a href="#bab300d080805cd3" class="i method">ObjectToTypeNameString</a>(<span class="r1060 r">valueToConvert</span>), <span class="r1061 r">resultType</span>.<span class="i">ToString</span>());
            <b>return</b> <span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r1062 r">errorId</span>, <span class="r1063 r">errorMsg</span>);
        }
 
        <span class="c">// Even though this never returns, expression trees expect non-void values in places, and so it&#39;s easier</span>
        <span class="c">// to claim it returns object than to add extra expressions to keep the trees type safe.</span>
        <b>internal static object</b> <a id="c311d543b7a566e8" href="../R/c311d543b7a566e8.html" target="n" data-glyph="74,1" class="i method">ThrowInvalidCastException</a>(<b>object</b> <span id="r1064 rd" class="r1064 r">valueToConvert</span>, <span class="i">Type</span> <span id="r1065 rd" class="r1065 r">resultType</span>)
        {
            <span class="c">// Get exception messages (in order): errorId, errorMsg</span>
            <b>var</b> <span id="r1066 rd" class="r1066 r">errorMsgTuple</span> = <a href="#dd6b89a235fa47d9" class="i method">GetInvalidCastMessages</a>(<span class="r1064 r">valueToConvert</span>, <span class="r1065 r">resultType</span>);
            <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="r1066 r">errorMsgTuple</span>.<span class="i">Item1</span>, <span class="r1066 r">errorMsgTuple</span>.<span class="i">Item2</span>, <span class="i">innerException</span>: <b>null</b>);
        }
 
        <span class="c">// Even though this never returns, expression trees expect non-void values in places, and so it&#39;s easier</span>
        <span class="c">// to claim it returns object than to add extra expressions to keep the trees type safe.</span>
        <b>internal static object</b> <a id="b7c0fbfa4a69c84b" href="../R/b7c0fbfa4a69c84b.html" target="n" data-glyph="74,1" class="i method">ThrowInvalidConversionException</a>(<b>object</b> <span id="r1067 rd" class="r1067 r">valueToConvert</span>, <span class="i">Type</span> <span id="r1068 rd" class="r1068 r">resultType</span>)
        {
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Issuing an error message about not being able to convert to non-core type.&quot;</span>);
            <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;ConversionSupportedOnlyToCoreTypes&quot;</span>, <b>null</b>, <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastExceptionNonCoreType</span>, <span class="r1068 r">resultType</span>.<span class="i">ToString</span>());
        }
 
        <b>private static</b> <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <a id="c6f75c7ef0c5a1a8" href="../R/c6f75c7ef0c5a1a8.html" target="n" data-glyph="76,1" class="i method">FigureLanguageConversion</a>(<span class="i">Type</span> <span id="r1069 rd" class="r1069 r">fromType</span>, <span class="i">Type</span> <span id="r1070 rd" class="r1070 r">toType</span>,
                                                               <b>out</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <span id="r1071 rd" class="r1071 r">valueDependentConversion</span>,
                                                               <b>out</b> <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r1072 rd" class="r1072 r">valueDependentRank</span>)
        {
            <span class="r1071 r">valueDependentConversion</span> = <b>null</b>;
            <span class="r1072 r">valueDependentRank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>;
 
            <span class="i">Type</span> <span id="r1073 rd" class="r1073 r">underlyingType</span> = <span class="i">Nullable</span>.<span class="i">GetUnderlyingType</span>(<span class="r1070 r">toType</span>);
            <b>if</b> (<span class="r1073 r">underlyingType</span> != <b>null</b>)
            {
                <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r1074 rd" class="r1074 r">nullableConversion</span> = <a href="#7b24dbc305e38140" class="i method">FigureConversion</a>(<span class="r1069 r">fromType</span>, <span class="r1073 r">underlyingType</span>);
                <b>if</b> (<span class="r1074 r">nullableConversion</span>.<a href="#fcaf7d7aa628a092" class="i property">Rank</a> != <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>)
                {
                    <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#939aafbdc9fc40e7" class="i method">ConvertToNullable</a>, <span class="r1074 r">nullableConversion</span>.<a href="#fcaf7d7aa628a092" class="i property">Rank</a>);
                }
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<b>void</b>))
            {
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#b7e9d139e1a57fbc" class="i method">ConvertToVoid</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<b>bool</b>))
            {
                <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>bool</b>&gt; <span id="r1075 rd" class="r1075 r">converter</span>;
                <b>if</b> (<b>typeof</b>(<span class="i">IList</span>).<span class="i">IsAssignableFrom</span>(<span class="r1069 r">fromType</span>))
                {
                    <span class="r1075 r">converter</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#e120fc89bba684eb" class="i method">ConvertIListToBool</a>;
                }
                <b>else</b> <b>if</b> (<span class="r1069 r">fromType</span>.<span class="i">IsEnum</span>)
                {
                    <span class="r1075 r">converter</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#e3b6ef6a498ee446" class="i method">CreateNumericToBoolConverter</a>(<span class="r1069 r">fromType</span>);
                }
                <b>else</b> <b>if</b> (<span class="r1069 r">fromType</span>.<span class="i">IsValueType</span>)
                {
                    <span class="r1075 r">converter</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#42a14eeffba941ff" class="i method">ConvertValueToBool</a>;
                }
                <b>else</b>
                {
                    <span class="r1075 r">converter</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#e13fea21b483093a" class="i method">ConvertClassToBool</a>;
                }
 
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>bool</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <span class="r1075 r">converter</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<b>string</b>))
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#e25b1c6d235a82c5" class="i method">IsNumeric</a>(<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r1069 r">fromType</span>)) || <span class="r1069 r">fromType</span>.<span class="i">IsEnum</span>,
                    <span class="s">&quot;Number to string should be cached on initialization of cache table&quot;</span>);
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>string</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#72b1263d17b54580" class="i method">ConvertNonNumericToString</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#2533e8d6de5d8a90" class="i field">ToString</a>);
            }
 
            <b>if</b> (<span class="r1070 r">toType</span>.<span class="i">IsArray</span>)
            {
                <span class="i">Type</span> <span id="r1076 rd" class="r1076 r">toElementType</span> = <span class="r1070 r">toType</span>.<span class="i">GetElementType</span>();
 
                <b>if</b> (<span class="r1069 r">fromType</span>.<span class="i">IsArray</span>)
                {
                    <b>if</b> (<span class="r1076 r">toElementType</span>.<span class="i">IsAssignableFrom</span>(<span class="r1069 r">fromType</span>.<span class="i">GetElementType</span>()))
                    {
                        <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#5e483c1fff52ec02" class="i method">ConvertRelatedArrays</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                    }
 
                    <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#45c70f2fb4280af8" class="i method">ConvertUnrelatedArrays</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#9ae727afff1169c0" class="i field">UnrelatedArrays</a>);
                }
 
                <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#db0cc286e8430367" class="i method">IsTypeEnumerable</a>(<span class="r1069 r">fromType</span>))
                {
                    <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#a6b6f9bfc8a9b423" class="i method">ConvertEnumerableToArray</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                }
 
                <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r1077 rd" class="r1077 r">data</span> = <a href="#7b24dbc305e38140" class="i method">FigureConversion</a>(<span class="r1069 r">fromType</span>, <span class="r1076 r">toElementType</span>);
                <b>if</b> (<span class="r1077 r">data</span>.<a href="#fcaf7d7aa628a092" class="i property">Rank</a> != <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>)
                {
                    <span class="r1072 r">valueDependentRank</span> = <span class="r1077 r">data</span>.<a href="#fcaf7d7aa628a092" class="i property">Rank</a> &amp; <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#1a3507a3a3df9a9d" class="i field">ValueDependent</a>;
                    <span class="r1071 r">valueDependentConversion</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#3b658406a202c83a" class="i method">ConvertScalarToArray</a>;
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<span class="i">Array</span>))
            {
                <b>if</b> (<span class="r1069 r">fromType</span>.<span class="i">IsArray</span> || <span class="r1069 r">fromType</span> == <b>typeof</b>(<span class="i">Array</span>))
                {
                    <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#d99994607ce557b4" class="i method">ConvertAssignableFrom</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6a83ff53b2a840f5" class="i field">Assignable</a>);
                }
 
                <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#db0cc286e8430367" class="i method">IsTypeEnumerable</a>(<span class="r1069 r">fromType</span>))
                {
                    <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#a6b6f9bfc8a9b423" class="i method">ConvertEnumerableToArray</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                }
 
                <span class="r1072 r">valueDependentRank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6a83ff53b2a840f5" class="i field">Assignable</a> &amp; <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#1a3507a3a3df9a9d" class="i field">ValueDependent</a>;
                <span class="r1071 r">valueDependentConversion</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#3b658406a202c83a" class="i method">ConvertScalarToArray</a>;
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<span class="i">Hashtable</span>))
            {
                <b>if</b> (<b>typeof</b>(<span class="i">IDictionary</span>).<span class="i">IsAssignableFrom</span>(<span class="r1069 r">fromType</span>))
                {
                    <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<span class="i">Hashtable</span>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#c53e7521e0a96223" class="i method">ConvertIDictionaryToHashtable</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                }
                <b>else</b>
                {
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>))
            {
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<a href="MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#a811bb7d04dfffcc" class="i method">ConvertToPSReference</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<span class="i">XmlDocument</span>))
            {
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<span class="i">XmlDocument</span>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#cf9e5a828cca063f" class="i method">ConvertToXml</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<span class="i">StringCollection</span>))
            {
                <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r1078 rd" class="r1078 r">rank</span> = (<span class="r1069 r">fromType</span>.<span class="i">IsArray</span> || <a href="#db0cc286e8430367" class="i method">IsTypeEnumerable</a>(<span class="r1069 r">fromType</span>)) ? <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a> : <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#8e6dae1ab4c485fe" class="i field">LanguageS2A</a>;
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<span class="i">StringCollection</span>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#bb275b74bcf61b52" class="i method">ConvertToStringCollection</a>, <span class="r1078 r">rank</span>);
            }
 
            <b>if</b> (<span class="r1070 r">toType</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Delegate</span>))
                &amp;&amp; (<span class="r1069 r">fromType</span> == <b>typeof</b>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>) || <span class="r1069 r">fromType</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>))))
            {
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<span class="i">Delegate</span>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#5bec5e219b39d0b2" class="i method">ConvertScriptBlockToDelegate</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
            }
 
            <b>if</b> (<span class="r1070 r">toType</span> == <b>typeof</b>(<a href="#f499f4c6b4eece87" class="t t">InternalPSCustomObject</a>))
            {
                <span class="i">Type</span> <span id="r1079 rd" class="r1079 r">actualResultType</span> = <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>);
 
                <span class="i">ConstructorInfo</span> <span id="r1080 rd" class="r1080 r">resultConstructor</span> = <span class="r1079 r">actualResultType</span>.<span class="i">GetConstructor</span>(<span class="i">Type</span>.<span class="i">EmptyTypes</span>);
 
                <a href="#550d2db25b155194" class="k">var</a> <span id="r1081 rd" class="r1081 r">converterObj</span> = <b>new</b> <a href="#2c6108280cdb13af" class="t constructor">ConvertViaNoArgumentConstructor</a>(<span class="r1080 r">resultConstructor</span>, <span class="r1079 r">actualResultType</span>);
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <span class="r1081 r">converterObj</span>.<a href="#0e2a73daee8e219c" class="i method">Convert</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
            }
 
            <span class="i">TypeCode</span> <span id="r1082 rd" class="r1082 r">fromTypeCode</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r1069 r">fromType</span>);
            <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#76ac66e2c6f26c02" class="i method">IsInteger</a>(<span class="r1082 r">fromTypeCode</span>) &amp;&amp; <span class="r1070 r">toType</span>.<span class="i">IsEnum</span>)
            {
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#69bde1c38c0c34ba" class="i method">ConvertIntegerToEnum</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
            }
 
            <b>if</b> (<span class="r1069 r">fromType</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>)) &amp;&amp; <span class="r1070 r">toType</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<span class="i">Delegate</span>)) &amp;&amp; !<span class="r1070 r">toType</span>.<span class="i">IsAbstract</span>)
            {
                <b>var</b> <span id="r1083 rd" class="r1083 r">targetMethod</span> = <span class="r1070 r">toType</span>.<span class="i">GetMethod</span>(<span class="s">&quot;Invoke&quot;</span>);
                <a href="#d9b26a5e1c00121f" class="k">var</a> <span id="r1084 rd" class="r1084 r">comparator</span> = <b>new</b> <span class="t">SignatureComparator</span>(<span class="r1083 r">targetMethod</span>);
                <a href="MshMemberInfo.cs.html#1ae3fd1cd6f93f03" class="k">var</a> <span id="r1085 rd" class="r1085 r">signatureEnumerator</span> = <b>new</b> <a href="MshMemberInfo.cs.html#b57796ad5d3a7b2d" class="t constructor">PSMethodSignatureEnumerator</a>(<span class="r1069 r">fromType</span>);
                <b>int</b> <span id="r1086 rd" class="r1086 r">index</span> = -1, <span id="r1087 rd" class="r1087 r">matchedIndex</span> = -1;
 
                <b>while</b> (<span class="r1085 r">signatureEnumerator</span>.<a href="MshMemberInfo.cs.html#ffeb5c024c66b663" class="i method">MoveNext</a>())
                {
                    <span class="r1086 r">index</span>++;
                    <b>var</b> <span id="r1088 rd" class="r1088 r">signatureType</span> = <span class="r1085 r">signatureEnumerator</span>.<a href="MshMemberInfo.cs.html#ce43de22482cdb19" class="i property">Current</a>;
                    <span class="c">// Skip the non-bindable signatures</span>
                    <b>if</b> (<span class="r1088 r">signatureType</span> == <b>typeof</b>(<span class="i">Func</span>&lt;<a href="MshMemberInfo.cs.html#3a9198e2f91acfb9" class="t t">PSNonBindableType</a>&gt;)) { <b>continue</b>; }
 
                    <span class="i">Type</span>[] <span id="r1089 rd" class="r1089 r">argumentTypes</span> = <span class="r1088 r">signatureType</span>.<span class="i">GenericTypeArguments</span>;
                    <b>if</b> (<span class="r1084 r">comparator</span>.<a href="#d2b8f7a4557c8aa4" class="i method">ProjectedSignatureMatchesTarget</a>(<span class="r1089 r">argumentTypes</span>, <b>out bool</b> <span id="r1090 rd" class="r1090 r">signaturesMatchExactly</span>))
                    {
                        <b>if</b> (<span class="r1090 r">signaturesMatchExactly</span>)
                        {
                            <span class="c">// We prefer the signature that exactly matches the target delegate.</span>
                            <span class="r1087 r">matchedIndex</span> = <span class="r1086 r">index</span>;
                            <b>break</b>;
                        }
 
                        <span class="c">// If there is no exact match, then we use the first compatible signature we found.</span>
                        <b>if</b> (<span class="r1087 r">matchedIndex</span> == -1) { <span class="r1087 r">matchedIndex</span> = <span class="r1086 r">index</span>; }
                    }
                }
 
                <b>if</b> (<span class="r1087 r">matchedIndex</span> &gt; -1)
                {
                    <span class="c">// We got the index of the matching method signature based on the PSMethod&lt;..&gt; type.</span>
                    <span class="c">// Signatures in PSMethod&lt;..&gt; type were constructed based on the array of method overloads,</span>
                    <span class="c">// in the exact order. So we can use this index directly to locate the matching overload in</span>
                    <span class="c">// the converter, without having to compare the signature again.</span>
                    <a href="#33a4b7adacd47510" class="k">var</a> <span id="r1091 rd" class="r1091 r">converter</span> = <a href="#33a4b7adacd47510" class="t t">PSMethodToDelegateConverter</a>.<a href="#ba952aded00c0cdb" class="i method">GetConverter</a>(<span class="r1087 r">matchedIndex</span>);
                    <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<span class="i">Delegate</span>&gt;(<span class="r1069 r">fromType</span>, <span class="r1070 r">toType</span>, <span class="r1091 r">converter</span>.<a href="#1bd7318376208e6a" class="i method">Convert</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a>);
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private readonly struct</b> <a id="d9b26a5e1c00121f" href="../R/d9b26a5e1c00121f.html" target="n" data-glyph="112,1" class="t t"><span id="4b1b61ddbc03523e">SignatureComparator</span></a>
        {
            <b>private enum</b> <a id="27bdb47d77edc5c0" href="../R/27bdb47d77edc5c0.html" target="n" data-glyph="22,2" class="t t"><span id="c7b4cf2584fb4efa">TypeMatchingContext</span></a>
            {
                <a id="ce44cee215979e9a" href="../R/ce44cee215979e9a.html" target="n" data-glyph="24,3" class="i field">ReturnType</a>,
                <a id="8572130fd58af98e" href="../R/8572130fd58af98e.html" target="n" data-glyph="24,3" class="i field">ParameterType</a>,
                <a id="e46aedbe36918dff" href="../R/e46aedbe36918dff.html" target="n" data-glyph="24,3" class="i field">OutParameterType</a>
            }
 
            <b>private readonly</b> <span class="i">ParameterInfo</span>[] <a id="eb318a4f6175d579" href="../R/eb318a4f6175d579.html" target="n" data-glyph="46,2" class="i field">targetParameters</a>;
            <b>private readonly</b> <span class="i">Type</span> <a id="e4b470ea2cdd404d" href="../R/e4b470ea2cdd404d.html" target="n" data-glyph="46,2" class="i field">targetReturnType</a>;
 
            <b>internal</b> <a id="2f26fda7481a23ab" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">SignatureComparator</a>(<span class="i">MethodInfo</span> <span id="r1092 rd" class="r1092 r">targetMethodInfo</span>)
            {
                <a href="#e4b470ea2cdd404d" class="i field">targetReturnType</a> = <span class="r1092 r">targetMethodInfo</span>.<span class="i">ReturnType</span>;
                <a href="#eb318a4f6175d579" class="i field">targetParameters</a> = <span class="r1092 r">targetMethodInfo</span>.<span class="i">GetParameters</span>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Check if a projected signature matches the target method.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1093 r">argumentTypes</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The type arguments from the metadata type &#39;Func[..]&#39; that represents the projected signature.</span>
            <span class="c">///</span><span class="c"> It contains the return type as the last item in the array.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1094 r">signaturesMatchExactly</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Set by this method to indicate if it&#39;s an exact match.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal bool</b> <a id="d2b8f7a4557c8aa4" href="../R/d2b8f7a4557c8aa4.html" target="n" data-glyph="74,2" class="i method">ProjectedSignatureMatchesTarget</a>(<span class="i">Type</span>[] <span id="r1093 rd" class="r1093 r">argumentTypes</span>, <b>out bool</b> <span id="r1094 rd" class="r1094 r">signaturesMatchExactly</span>)
            {
                <span class="r1094 r">signaturesMatchExactly</span> = <b>false</b>;
                <b>int</b> <span id="r1095 rd" class="r1095 r">length</span> = <span class="r1093 r">argumentTypes</span>.<span class="i">Length</span>;
                <b>if</b> (<span class="r1095 r">length</span> != <a href="#eb318a4f6175d579" class="i field">targetParameters</a>.<span class="i">Length</span> + 1) { <b>return</b> <b>false</b>; }
 
                <b>bool</b> <span id="r1096 rd" class="r1096 r">typesMatchExactly</span>, <span id="r1097 rd" class="r1097 r">allTypesMatchExactly</span>;
                <span class="i">Type</span> <span id="r1098 rd" class="r1098 r">sourceReturnType</span> = <span class="r1093 r">argumentTypes</span>[<span class="r1095 r">length</span> - 1];
 
                <b>if</b> (<a href="#ff0766fc57637123" class="i method">ProjectedTypeMatchesTargetType</a>(<span class="r1098 r">sourceReturnType</span>, <a href="#e4b470ea2cdd404d" class="i field">targetReturnType</a>, <a href="#27bdb47d77edc5c0" class="t t">TypeMatchingContext</a>.<a href="#ce44cee215979e9a" class="i field">ReturnType</a>, <b>out</b> <span class="r1096 r">typesMatchExactly</span>))
                {
                    <span class="r1097 r">allTypesMatchExactly</span> = <span class="r1096 r">typesMatchExactly</span>;
                    <b>for</b> (<b>int</b> <span id="r1099 rd" class="r1099 r">i</span> = 0; <span class="r1099 r">i</span> &lt; <a href="#eb318a4f6175d579" class="i field">targetParameters</a>.<span class="i">Length</span>; <span class="r1099 r">i</span>++)
                    {
                        <b>var</b> <span id="r1100 rd" class="r1100 r">targetParam</span> = <a href="#eb318a4f6175d579" class="i field">targetParameters</a>[<span class="r1099 r">i</span>];
                        <b>var</b> <span id="r1101 rd" class="r1101 r">sourceType</span> = <span class="r1093 r">argumentTypes</span>[<span class="r1099 r">i</span>];
                        <a href="#27bdb47d77edc5c0" class="k">var</a> <span id="r1102 rd" class="r1102 r">matchContext</span> = <span class="r1100 r">targetParam</span>.<span class="i">IsOut</span> ? <a href="#27bdb47d77edc5c0" class="t t">TypeMatchingContext</a>.<a href="#e46aedbe36918dff" class="i field">OutParameterType</a> : <a href="#27bdb47d77edc5c0" class="t t">TypeMatchingContext</a>.<a href="#8572130fd58af98e" class="i field">ParameterType</a>;
 
                        <b>if</b> (!<span class="i">ProjectedTypeMatchesTargetType</span>(<span class="r1101 r">sourceType</span>, <span class="r1100 r">targetParam</span>.<span class="i">ParameterType</span>, <span class="r1102 r">matchContext</span>, <b>out</b> <span class="r1096 r">typesMatchExactly</span>))
                        {
                            <b>return</b> <b>false</b>;
                        }
 
                        <span class="r1097 r">allTypesMatchExactly</span> &amp;= <span class="r1096 r">typesMatchExactly</span>;
                    }
 
                    <span class="r1094 r">signaturesMatchExactly</span> = <span class="r1097 r">allTypesMatchExactly</span>;
                    <b>return</b> <b>true</b>;
                }
 
                <b>return</b> <b>false</b>;
            }
 
            <b>private static bool</b> <a id="ff0766fc57637123" href="../R/ff0766fc57637123.html" target="n" data-glyph="76,2" class="i method">ProjectedTypeMatchesTargetType</a>(<span class="i">Type</span> <span id="r1103 rd" class="r1103 r">sourceType</span>, <span class="i">Type</span> <span id="r1104 rd" class="r1104 r">targetType</span>, <a href="#27bdb47d77edc5c0" class="t t">TypeMatchingContext</a> <span id="r1105 rd" class="r1105 r">matchContext</span>, <b>out bool</b> <span id="r1106 rd" class="r1106 r">matchExactly</span>)
            {
                <span class="r1106 r">matchExactly</span> = <b>false</b>;
                <b>if</b> (<span class="r1104 r">targetType</span>.<span class="i">IsByRef</span> || <span class="r1104 r">targetType</span>.<span class="i">IsPointer</span>)
                {
                    <b>if</b> (!<span class="r1103 r">sourceType</span>.<span class="i">IsGenericType</span>) { <b>return</b> <b>false</b>; }
 
                    <b>var</b> <span id="r1107 rd" class="r1107 r">sourceTypeDef</span> = <span class="r1103 r">sourceType</span>.<span class="i">GetGenericTypeDefinition</span>();
                    <b>bool</b> <span id="r1108 rd" class="r1108 r">isOutParameter</span> = <span class="r1105 r">matchContext</span> == <a href="#27bdb47d77edc5c0" class="t t">TypeMatchingContext</a>.<a href="#e46aedbe36918dff" class="i field">OutParameterType</a>;
 
                    <b>if</b> (<span class="r1104 r">targetType</span>.<span class="i">IsByRef</span> &amp;&amp; <span class="r1107 r">sourceTypeDef</span> == (<span class="r1108 r">isOutParameter</span> ? <b>typeof</b>(<a href="MshMemberInfo.cs.html#1bd0ba2ee6f34966" class="t t">PSOutParameter</a>&lt;&gt;) : <b>typeof</b>(<a href="MshReference.cs.html#4533b98946fe4766" class="t t">PSReference</a>&lt;&gt;)) ||
                        <span class="r1104 r">targetType</span>.<span class="i">IsPointer</span> &amp;&amp; <span class="r1107 r">sourceTypeDef</span> == <b>typeof</b>(<a href="MshMemberInfo.cs.html#7af441a991fe050b" class="t t">PSPointer</a>&lt;&gt;))
                    {
                        <span class="c">// For ref/out parameter types and pointer types, the element types need to match exactly.</span>
                        <b>if</b> (<span class="r1104 r">targetType</span>.<span class="i">GetElementType</span>() == <span class="r1103 r">sourceType</span>.<span class="i">GenericTypeArguments</span>[0])
                        {
                            <span class="r1106 r">matchExactly</span> = <b>true</b>;
                            <b>return</b> <b>true</b>;
                        }
                    }
 
                    <b>return</b> <b>false</b>;
                }
 
                <b>if</b> (<span class="r1104 r">targetType</span> == <span class="r1103 r">sourceType</span> ||
                    <span class="r1104 r">targetType</span> == <b>typeof</b>(<b>void</b>) &amp;&amp; <span class="r1103 r">sourceType</span> == <b>typeof</b>(<a href="MshMemberInfo.cs.html#bf55161366fa08f3" class="t t">VOID</a>) ||
                    <span class="r1104 r">targetType</span> == <b>typeof</b>(<span class="i">TypedReference</span>) &amp;&amp; <span class="r1103 r">sourceType</span> == <b>typeof</b>(<a href="MshMemberInfo.cs.html#cbc313044852666c" class="t t">PSTypedReference</a>))
                {
                    <span class="r1106 r">matchExactly</span> = <b>true</b>;
                    <b>return</b> <b>true</b>;
                }
 
                <b>if</b> (<span class="r1104 r">targetType</span> == <b>typeof</b>(<b>void</b>) || <span class="r1104 r">targetType</span> == <b>typeof</b>(<span class="i">TypedReference</span>))
                {
                    <b>return</b> <b>false</b>;
                }
 
                <b>return</b> <span class="r1105 r">matchContext</span> == <a href="#27bdb47d77edc5c0" class="t t">TypeMatchingContext</a>.<a href="#ce44cee215979e9a" class="i field">ReturnType</a>
                    ? <span class="r1104 r">targetType</span>.<span class="i">IsAssignableFrom</span>(<span class="r1103 r">sourceType</span>)
                    : <span class="r1103 r">sourceType</span>.<span class="i">IsAssignableFrom</span>(<span class="r1104 r">targetType</span>);
            }
        }
 
        <b>private static</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <a id="b5cf68dcc442c6e4" href="../R/b5cf68dcc442c6e4.html" target="n" data-glyph="76,1" class="i method">FigureStaticCreateMethodConversion</a>(<span class="i">Type</span> <span id="r1109 rd" class="r1109 r">fromType</span>, <span class="i">Type</span> <span id="r1110 rd" class="r1110 r">toType</span>)
        {
            <span class="c">// after discussing this with Jason, we decided that for now we only want to support string-&gt;CimSession conversion</span>
            <span class="c">// and we don&#39;t want to add a Parse-like conversion based on a static Create method</span>
 
            <b>if</b> (<span class="r1109 r">fromType</span> == <b>typeof</b>(<b>string</b>) &amp;&amp; <span class="r1110 r">toType</span> == <b>typeof</b>(<span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimSession</span>))
            {
                <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertStringToCimSession</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <a id="a92ae21e445d14ed" href="../R/a92ae21e445d14ed.html" target="n" data-glyph="76,1" class="i method">FigureParseConversion</a>(<span class="i">Type</span> <span id="r1111 rd" class="r1111 r">fromType</span>, <span class="i">Type</span> <span id="r1112 rd" class="r1112 r">toType</span>)
        {
            <b>if</b> (<span class="r1112 r">toType</span>.<span class="i">IsEnum</span>)
            {
                <b>if</b> (<span class="r1111 r">fromType</span> == <b>typeof</b>(<b>string</b>))
                {
                    <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#cac764c8e22e5b3e" class="i method">ConvertStringToEnum</a>;
                }
 
                <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#db0cc286e8430367" class="i method">IsTypeEnumerable</a>(<span class="r1111 r">fromType</span>))
                {
                    <b>return</b> <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#dc3b4eaca6b42bd1" class="i method">ConvertEnumerableToEnum</a>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r1111 r">fromType</span> == <b>typeof</b>(<b>string</b>))
            {
                <b>const</b> <span class="i">BindingFlags</span> <span id="r1113 rd" class="r1113 r">parseFlags</span> = <span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span>;
                <span class="c">// GetMethod could throw for more than one match, for instance</span>
                <span class="i">MethodInfo</span> <span id="r1114 rd" class="r1114 r">parse</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="r1114 r">parse</span> = <span class="r1112 r">toType</span>.<span class="i">GetMethod</span>(<span class="s">&quot;Parse&quot;</span>, <span class="r1113 r">parseFlags</span>, <b>null</b>, <b>new</b> <span class="i">Type</span>[2] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<span class="i">IFormatProvider</span>) }, <b>null</b>);
                }
                <b>catch</b> (<span class="i">AmbiguousMatchException</span> <span id="r1115 rd" class="r1115 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Parse method with CultureInfo: \&quot;{0}\&quot;.&quot;</span>, <span class="r1115 r">e</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r1116 rd" class="r1116 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Parse method with CultureInfo: \&quot;{0}\&quot;.&quot;</span>, <span class="r1116 r">e</span>.<span class="i">Message</span>);
                }
 
                <b>if</b> (<span class="r1114 r">parse</span> != <b>null</b>)
                {
                    <a href="#b7f557047c829345" class="t t">ConvertViaParseMethod</a> <span id="r1117 rd" class="r1117 r">converter</span> = <b>new</b> <span class="t">ConvertViaParseMethod</span>();
                    <span class="r1117 r">converter</span>.<a href="#33afb746f0264712" class="i field">parse</a> = <span class="r1114 r">parse</span>;
                    <b>return</b> <span class="r1117 r">converter</span>.<a href="#713add7d41e075b1" class="i method">ConvertWithCulture</a>;
                }
 
                <b>try</b>
                {
                    <span class="r1114 r">parse</span> = <span class="r1112 r">toType</span>.<span class="i">GetMethod</span>(<span class="s">&quot;Parse&quot;</span>, <span class="r1113 r">parseFlags</span>, <b>null</b>, <b>new</b> <span class="i">Type</span>[1] { <b>typeof</b>(<b>string</b>) }, <b>null</b>);
                }
                <b>catch</b> (<span class="i">AmbiguousMatchException</span> <span id="r1118 rd" class="r1118 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Parse method: \&quot;{0}\&quot;.&quot;</span>, <span class="r1118 r">e</span>.<span class="i">Message</span>);
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r1119 rd" class="r1119 r">e</span>)
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Parse method: \&quot;{0}\&quot;.&quot;</span>, <span class="r1119 r">e</span>.<span class="i">Message</span>);
                }
 
                <b>if</b> (<span class="r1114 r">parse</span> != <b>null</b>)
                {
                    <a href="#b7f557047c829345" class="t t">ConvertViaParseMethod</a> <span id="r1120 rd" class="r1120 r">converter</span> = <b>new</b> <span class="t">ConvertViaParseMethod</span>();
                    <span class="r1120 r">converter</span>.<a href="#33afb746f0264712" class="i field">parse</a> = <span class="r1114 r">parse</span>;
                    <b>return</b> <span class="r1120 r">converter</span>.<a href="#c4cc3e634ac4b69d" class="i method">ConvertWithoutCulture</a>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Figure conversion when following conditions are satisfied:</span>
        <span class="c">///</span><span class="c"> 1. toType is a closed generic type and it has a constructor that takes IEnumerable[T], ICollection[T] or IList[T]</span>
        <span class="c">///</span><span class="c"> 2. fromType is System.Array, System.Object[] or it&#39;s the same as the element type of toType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1121 r">fromType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1122 r">toType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Tuple</span>&lt;<a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt;, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>&gt; <a id="a303110a0e50a014" href="../R/a303110a0e50a014.html" target="n" data-glyph="74,1" class="i method">FigureIEnumerableConstructorConversion</a>(<span class="i">Type</span> <span id="r1121 rd" class="r1121 r">fromType</span>, <span class="i">Type</span> <span id="r1122 rd" class="r1122 r">toType</span>)
        {
            <span class="c">// Win8: 653180. If toType is an Abstract type then we cannot construct it anyway. So, bailing out fast.</span>
            <b>if</b> (<span class="r1122 r">toType</span>.<span class="i">IsAbstract</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>try</b>
            {
                <b>bool</b> <span id="r1123 rd" class="r1123 r">result</span> = <b>false</b>;
                <b>bool</b> <span id="r1124 rd" class="r1124 r">isScalar</span> = <b>false</b>;
                <span class="i">Type</span> <span id="r1125 rd" class="r1125 r">elementType</span> = <b>null</b>;
                <span class="i">ConstructorInfo</span> <span id="r1126 rd" class="r1126 r">resultConstructor</span> = <b>null</b>;
 
                <b>if</b> (<span class="r1122 r">toType</span>.<span class="i">IsGenericType</span> &amp;&amp; !<span class="r1122 r">toType</span>.<span class="i">ContainsGenericParameters</span> &amp;&amp;
                    (<b>typeof</b>(<span class="i">IList</span>).<span class="i">IsAssignableFrom</span>(<span class="r1122 r">toType</span>) ||
                     <b>typeof</b>(<span class="i">ICollection</span>).<span class="i">IsAssignableFrom</span>(<span class="r1122 r">toType</span>) ||
                     <b>typeof</b>(<span class="i">IEnumerable</span>).<span class="i">IsAssignableFrom</span>(<span class="r1122 r">toType</span>)))
                {
                    <span class="i">Type</span>[] <span id="r1127 rd" class="r1127 r">argTypes</span> = <span class="r1122 r">toType</span>.<span class="i">GetGenericArguments</span>();
                    <b>if</b> (<span class="r1127 r">argTypes</span>.<span class="i">Length</span> != 1)
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>
                            .<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(
                                <span class="s">&quot;toType has more than one generic arguments. Here we only care about the toType which contains only one generic argument and whose constructor takes IEnumerable&lt;T&gt;, ICollection&lt;T&gt; or IList&lt;T&gt;.&quot;</span>);
                        <b>return</b> <b>null</b>;
                    }
 
                    <span class="r1125 r">elementType</span> = <span class="r1127 r">argTypes</span>[0];
 
                    <b>if</b> (<b>typeof</b>(<span class="i">Array</span>) == <span class="r1121 r">fromType</span> || <b>typeof</b>(<b>object</b>[]) == <span class="r1121 r">fromType</span> ||
                        <span class="r1125 r">elementType</span>.<span class="i">IsAssignableFrom</span>(<span class="r1121 r">fromType</span>) ||
                        <span class="c">// WinBlue: 423899 : To support scenario like [list[int]]&quot;4&quot;</span>
                        (<a href="#7b24dbc305e38140" class="i method">FigureConversion</a>(<span class="r1121 r">fromType</span>, <span class="r1125 r">elementType</span>) != <b>null</b>))
                    {
                        <span class="r1124 r">isScalar</span> = <span class="r1125 r">elementType</span>.<span class="i">IsAssignableFrom</span>(<span class="r1121 r">fromType</span>);
                        <span class="i">ConstructorInfo</span>[] <span id="r1128 rd" class="r1128 r">ctors</span> = <span class="r1122 r">toType</span>.<span class="i">GetConstructors</span>();
                        <span class="i">Type</span> <span id="r1129 rd" class="r1129 r">iEnumerableClosedType</span> = <b>typeof</b>(<span class="i">IEnumerable</span>&lt;&gt;).<span class="i">MakeGenericType</span>(<span class="r1125 r">elementType</span>);
                        <span class="i">Type</span> <span id="r1130 rd" class="r1130 r">iCollectionClosedType</span> = <b>typeof</b>(<span class="i">ICollection</span>&lt;&gt;).<span class="i">MakeGenericType</span>(<span class="r1125 r">elementType</span>);
                        <span class="i">Type</span> <span id="r1131 rd" class="r1131 r">iListClosedType</span> = <b>typeof</b>(<span class="i">IList</span>&lt;&gt;).<span class="i">MakeGenericType</span>(<span class="r1125 r">elementType</span>);
 
                        <b>foreach</b> (<b>var</b> <span id="r1132 rd" class="r1132 r">ctor</span> <b>in</b> <span class="r1128 r">ctors</span>)
                        {
                            <span class="i">ParameterInfo</span>[] <span id="r1133 rd" class="r1133 r">param</span> = <span class="r1132 r">ctor</span>.<span class="i">GetParameters</span>();
                            <b>if</b> (<span class="r1133 r">param</span>.<span class="i">Length</span> != 1)
                                <b>continue</b>;
 
                            <span class="i">Type</span> <span id="r1134 rd" class="r1134 r">paramType</span> = <span class="r1133 r">param</span>[0].<span class="i">ParameterType</span>;
                            <b>if</b> (<span class="r1129 r">iEnumerableClosedType</span> == <span class="r1134 r">paramType</span> ||
                                <span class="r1130 r">iCollectionClosedType</span> == <span class="r1134 r">paramType</span> ||
                                <span class="r1131 r">iListClosedType</span> == <span class="r1134 r">paramType</span>)
                            {
                                <span class="r1126 r">resultConstructor</span> = <span class="r1132 r">ctor</span>;
                                <span class="r1123 r">result</span> = <b>true</b>;
                                <b>break</b>;
                            }
                        }
                    }
                }
 
                <b>if</b> (<span class="r1123 r">result</span>)
                {
                    <a href="#594d5424ccb583fb" class="k">var</a> <span id="r1135 rd" class="r1135 r">converter</span> = <b>new</b> <span class="t">ConvertViaIEnumerableConstructor</span>();
 
                    <b>try</b>
                    {
                        <span class="i">Type</span> <span id="r1136 rd" class="r1136 r">listClosedType</span> = <b>typeof</b>(<span class="i">List</span>&lt;&gt;).<span class="i">MakeGenericType</span>(<span class="r1125 r">elementType</span>);
                        <span class="i">ConstructorInfo</span> <span id="r1137 rd" class="r1137 r">listCtor</span> = <span class="r1136 r">listClosedType</span>.<span class="i">GetConstructor</span>(<b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>int</b>) });
                        <span class="r1135 r">converter</span>.<a href="#f72673d7ed960b25" class="i field">ListCtorLambda</a> = <span class="i">CreateCtorLambdaClosure</span>&lt;<b>int</b>, <span class="i">IList</span>&gt;(<span class="r1137 r">listCtor</span>, <b>typeof</b>(<b>int</b>), <b>false</b>);
 
                        <span class="i">ParameterInfo</span>[] <span id="r1138 rd" class="r1138 r">targetParams</span> = <span class="r1126 r">resultConstructor</span>.<span class="i">GetParameters</span>();
                        <span class="i">Type</span> <span id="r1139 rd" class="r1139 r">targetParamType</span> = <span class="r1138 r">targetParams</span>[0].<span class="i">ParameterType</span>;
                        <span class="r1135 r">converter</span>.<a href="#463e5eee99b0f64b" class="i field">TargetCtorLambda</a> = <a href="#017417f5dba0c871" class="i method">CreateCtorLambdaClosure</a>&lt;<span class="i">IList</span>, <b>object</b>&gt;(<span class="r1126 r">resultConstructor</span>,
                                                                                            <span class="r1139 r">targetParamType</span>, <b>false</b>);
 
                        <span class="r1135 r">converter</span>.<a href="#954d2e8d4ffca4c8" class="i field">ElementType</a> = <span class="r1125 r">elementType</span>;
                        <span class="r1135 r">converter</span>.<a href="#55a0ce2b67204070" class="i field">IsScalar</a> = <span class="r1124 r">isScalar</span>;
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r1140 rd" class="r1140 r">e</span>)
                    {
                        <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception building constructor lambda: \&quot;{0}\&quot;&quot;</span>, <span class="r1140 r">e</span>.<span class="i">Message</span>);
                        <b>return</b> <b>null</b>;
                    }
 
                    <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r1141 rd" class="r1141 r">rank</span> = <span class="r1124 r">isScalar</span> ? <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#3eed585cbbcd6ac5" class="i field">ConstructorS2A</a> : <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#f884ff66af1f97c4" class="i field">Constructor</a>;
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Conversion is figured out. Conversion rank: \&quot;{0}\&quot;&quot;</span>, <span class="r1141 r">rank</span>);
                    <b>return</b> <b>new</b> <span class="i">Tuple</span>&lt;<a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt;, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>&gt;(<span class="r1135 r">converter</span>.<span class="i">Convert</span>, <span class="r1141 r">rank</span>);
                }
                <b>else</b>
                {
                    <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Fail to figure out the conversion from \&quot;{0}\&quot; to \&quot;{1}\&quot;&quot;</span>,
                                             <span class="r1121 r">fromType</span>.<span class="i">FullName</span>, <span class="r1122 r">toType</span>.<span class="i">FullName</span>);
                    <b>return</b> <b>null</b>;
                }
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r1142 rd" class="r1142 r">ae</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding IEnumerable conversion: \&quot;{0}\&quot;.&quot;</span>, <span class="r1142 r">ae</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r1143 rd" class="r1143 r">ie</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding IEnumerable conversion: \&quot;{0}\&quot;.&quot;</span>, <span class="r1143 r">ie</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">NotSupportedException</span> <span id="r1144 rd" class="r1144 r">ne</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding IEnumerable conversion: \&quot;{0}\&quot;.&quot;</span>, <span class="r1144 r">ne</span>.<span class="i">Message</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <span class="i">Func</span>&lt;<span class="r1145 r t">T1</span>, <span class="r1146 r t">T2</span>&gt; <a id="017417f5dba0c871" href="../R/017417f5dba0c871.html" target="n" data-glyph="76,1" class="i method">CreateCtorLambdaClosure</a>&lt;<span id="r1145 rd t" class="r1145 r t">T1</span>, <span id="r1146 rd t" class="r1146 r t">T2</span>&gt;(<span class="i">ConstructorInfo</span> <span id="r1147 rd" class="r1147 r">ctor</span>, <span class="i">Type</span> <span id="r1148 rd" class="r1148 r">realParamType</span>, <b>bool</b> <span id="r1149 rd" class="r1149 r">useExplicitConversion</span>)
        {
            <span class="i">ParameterExpression</span> <span id="r1150 rd" class="r1150 r">paramExpr</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<span class="r1145 r t">T1</span>), <span class="s">&quot;args&quot;</span>);
            <span class="i">Expression</span> <span id="r1151 rd" class="r1151 r">castParamExpr</span> = <span class="r1149 r">useExplicitConversion</span>
                ? (<span class="i">Expression</span>)<span class="i">Expression</span>.<span class="i">Call</span>(<a href="parser/Compiler.cs.html#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="parser/Compiler.cs.html#484b94d4bdfa9e07" class="i field">Convert_ChangeType</a>, <span class="r1150 r">paramExpr</span>, <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r1148 r">realParamType</span>, <b>typeof</b>(<span class="i">Type</span>)))
                : <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="r1150 r">paramExpr</span>, <span class="r1148 r">realParamType</span>);
            <span class="i">NewExpression</span> <span id="r1152 rd" class="r1152 r">ctorExpr</span> = <span class="i">Expression</span>.<span class="i">New</span>(<span class="r1147 r">ctor</span>, <span class="r1151 r">castParamExpr</span>.<a href="parser/Compiler.cs.html#664379b8310751e4" class="i method">Cast</a>(<span class="r1148 r">realParamType</span>));
            <b>return</b> <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<span class="i">Func</span>&lt;<span class="r1145 r t">T1</span>, <span class="r1146 r t">T2</span>&gt;&gt;(<span class="r1152 r">ctorExpr</span>.<span class="i">Cast</span>(<b>typeof</b>(<span class="r1146 r t">T2</span>)), <span class="r1150 r">paramExpr</span>).<span class="i">Compile</span>();
        }
 
        <b>internal static</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <a id="3e2328cf7b0840d3" href="../R/3e2328cf7b0840d3.html" target="n" data-glyph="74,1" class="i method">FigureConstructorConversion</a>(<span class="i">Type</span> <span id="r1153 rd" class="r1153 r">fromType</span>, <span class="i">Type</span> <span id="r1154 rd" class="r1154 r">toType</span>)
        {
            <b>if</b> (<a href="#06815b65842b7dab" class="i method">IsIntegralType</a>(<span class="r1153 r">fromType</span>) &amp;&amp;
                (<b>typeof</b>(<span class="i">IList</span>).<span class="i">IsAssignableFrom</span>(<span class="r1154 r">toType</span>) || <b>typeof</b>(<span class="i">ICollection</span>).<span class="i">IsAssignableFrom</span>(<span class="r1154 r">toType</span>)))
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Ignoring the collection constructor that takes an integer, since this is not semantically a conversion.&quot;</span>);
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">ConstructorInfo</span> <span id="r1155 rd" class="r1155 r">resultConstructor</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r1155 r">resultConstructor</span> = <span class="r1154 r">toType</span>.<span class="i">GetConstructor</span>(<b>new</b> <span class="i">Type</span>[] { <span class="r1153 r">fromType</span> });
            }
            <b>catch</b> (<span class="i">AmbiguousMatchException</span> <span id="r1156 rd" class="r1156 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r1156 r">e</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r1157 rd" class="r1157 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r1157 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>if</b> (<span class="r1155 r">resultConstructor</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Found Constructor.&quot;</span>);
            <a href="#6c5b009c71b774cc" class="k">var</a> <span id="r1158 rd" class="r1158 r">converter</span> = <b>new</b> <span class="t">ConvertViaConstructor</span>();
 
            <b>try</b>
            {
                <span class="i">ParameterInfo</span>[] <span id="r1159 rd" class="r1159 r">targetParams</span> = <span class="r1155 r">resultConstructor</span>.<span class="i">GetParameters</span>();
                <span class="i">Type</span> <span id="r1160 rd" class="r1160 r">targetParamType</span> = <span class="r1159 r">targetParams</span>[0].<span class="i">ParameterType</span>;
                <b>bool</b> <span id="r1161 rd" class="r1161 r">useExplicitConversion</span> = <span class="r1160 r">targetParamType</span>.<span class="i">IsValueType</span> &amp;&amp; <span class="r1153 r">fromType</span> != <span class="r1160 r">targetParamType</span> &amp;&amp; <span class="i">Nullable</span>.<span class="i">GetUnderlyingType</span>(<span class="r1160 r">targetParamType</span>) == <b>null</b>;
                <span class="r1158 r">converter</span>.<a href="#fd140f0c98b466f7" class="i field">TargetCtorLambda</a> = <a href="#017417f5dba0c871" class="i method">CreateCtorLambdaClosure</a>&lt;<b>object</b>, <b>object</b>&gt;(<span class="r1155 r">resultConstructor</span>, <span class="r1160 r">targetParamType</span>, <span class="r1161 r">useExplicitConversion</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r1162 rd" class="r1162 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception building constructor lambda: \&quot;{0}\&quot;&quot;</span>, <span class="r1162 r">e</span>.<span class="i">Message</span>);
                <b>return</b> <b>null</b>;
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Conversion is figured out.&quot;</span>);
            <b>return</b> <span class="r1158 r">converter</span>.<a href="#2b5b7493fc189405" class="i method">Convert</a>;
        }
 
        <b>private static bool</b> <a id="06815b65842b7dab" href="../R/06815b65842b7dab.html" target="n" data-glyph="76,1" class="i method">IsIntegralType</a>(<span class="i">Type</span> <span id="r1163 rd" class="r1163 r">type</span>)
        {
            <b>return</b>
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>sbyte</b>) ||
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>byte</b>) ||
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>short</b>) ||
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>ushort</b>) ||
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>int</b>) ||
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>uint</b>) ||
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>long</b>) ||
                <span class="r1163 r">type</span> == <b>typeof</b>(<b>ulong</b>);
        }
 
        <b>internal static</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <a id="4454b892705bf8c3" href="../R/4454b892705bf8c3.html" target="n" data-glyph="74,1" class="i method">FigurePropertyConversion</a>(<span class="i">Type</span> <span id="r1164 rd" class="r1164 r">fromType</span>, <span class="i">Type</span> <span id="r1165 rd" class="r1165 r">toType</span>, <b>ref</b> <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r1166 rd" class="r1166 r">rank</span>)
        {
            <b>if</b> ((!<b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">IsAssignableFrom</span>(<span class="r1164 r">fromType</span>)) || (<span class="r1165 r">toType</span>.<span class="i">IsAbstract</span>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">ConstructorInfo</span> <span id="r1167 rd" class="r1167 r">toConstructor</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r1167 r">toConstructor</span> = <span class="r1165 r">toType</span>.<span class="i">GetConstructor</span>(<span class="i">Type</span>.<span class="i">EmptyTypes</span>);
            }
            <b>catch</b> (<span class="i">AmbiguousMatchException</span> <span id="r1168 rd" class="r1168 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r1168 r">e</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r1169 rd" class="r1169 r">e</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception finding Constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r1169 r">e</span>.<span class="i">Message</span>);
            }
 
            <b>if</b> (<span class="r1167 r">toConstructor</span> == <b>null</b> &amp;&amp; !<span class="r1165 r">toType</span>.<span class="i">IsValueType</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r1165 r">toType</span>.<span class="i">GetProperties</span>(<span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>).<span class="i">Length</span> == 0 &amp;&amp;
                <span class="r1165 r">toType</span>.<span class="i">GetFields</span>(<span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span>).<span class="i">Length</span> == 0)
            {
                <span class="c">// fromType is PSObject, toType has no properties/fields to set, so conversion should fail.</span>
                <b>return</b> <b>null</b>;
            }
 
            <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Found Constructor.&quot;</span>);
 
            <b>try</b>
            {
                <a href="#550d2db25b155194" class="t t">ConvertViaNoArgumentConstructor</a> <span id="r1170 rd" class="r1170 r">noArgumentConstructorConverter</span> =
                    <b>new</b> <a href="#2c6108280cdb13af" class="t constructor">ConvertViaNoArgumentConstructor</a>(<span class="r1167 r">toConstructor</span>, <span class="r1165 r">toType</span>);
                <span class="r1166 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#f884ff66af1f97c4" class="i field">Constructor</a>;
                <b>return</b> <span class="r1170 r">noArgumentConstructorConverter</span>.<a href="#0e2a73daee8e219c" class="i method">Convert</a>;
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r1171 rd" class="r1171 r">ae</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting via no argument constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r1171 r">ae</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r1172 rd" class="r1172 r">ie</span>)
            {
                <a href="#5ccf00d099bd97dd" class="i field">typeConversion</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Exception converting via no argument constructor: \&quot;{0}\&quot;.&quot;</span>, <span class="r1172 r">ie</span>.<span class="i">Message</span>);
            }
 
            <span class="r1166 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>;
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static</b> <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <a id="09a5a9e9100e4d75" href="../R/09a5a9e9100e4d75.html" target="n" data-glyph="74,1" class="i method">FigureCastConversion</a>(<span class="i">Type</span> <span id="r1173 rd" class="r1173 r">fromType</span>, <span class="i">Type</span> <span id="r1174 rd" class="r1174 r">toType</span>, <b>ref</b> <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r1175 rd" class="r1175 r">rank</span>)
        {
            <span class="i">MethodInfo</span> <span id="r1176 rd" class="r1176 r">castOperator</span> = <a href="#a4492631127e7293" class="i method">FindCastOperator</a>(<span class="s">&quot;op_Implicit&quot;</span>, <span class="r1174 r">toType</span>, <span class="r1173 r">fromType</span>, <span class="r1174 r">toType</span>);
            <b>if</b> (<span class="r1176 r">castOperator</span> == <b>null</b>)
            {
                <span class="r1176 r">castOperator</span> = <a href="#a4492631127e7293" class="i method">FindCastOperator</a>(<span class="s">&quot;op_Explicit&quot;</span>, <span class="r1174 r">toType</span>, <span class="r1173 r">fromType</span>, <span class="r1174 r">toType</span>);
                <b>if</b> (<span class="r1176 r">castOperator</span> == <b>null</b>)
                {
                    <span class="r1176 r">castOperator</span> = <a href="#a4492631127e7293" class="i method">FindCastOperator</a>(<span class="s">&quot;op_Implicit&quot;</span>, <span class="r1173 r">fromType</span>, <span class="r1173 r">fromType</span>, <span class="r1174 r">toType</span>) ??
                                   <a href="#a4492631127e7293" class="i method">FindCastOperator</a>(<span class="s">&quot;op_Explicit&quot;</span>, <span class="r1173 r">fromType</span>, <span class="r1173 r">fromType</span>, <span class="r1174 r">toType</span>);
                }
            }
 
            <b>if</b> (<span class="r1176 r">castOperator</span> != <b>null</b>)
            {
                <span class="r1175 r">rank</span> = <span class="r1176 r">castOperator</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;op_Implicit&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                    ? <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#16af78347d5ada13" class="i field">ImplicitCast</a> : <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#1ec464ef054dabee" class="i field">ExplicitCast</a>;
                <a href="#e8276adf241f51b0" class="t t">ConvertViaCast</a> <span id="r1177 rd" class="r1177 r">converter</span> = <b>new</b> <span class="t">ConvertViaCast</span>();
                <span class="r1177 r">converter</span>.<a href="#db2a239f4aa1282b" class="i field">cast</a> = <span class="r1176 r">castOperator</span>;
                <b>return</b> <span class="r1177 r">converter</span>.<a href="#98c754e7235c5630" class="i method">Convert</a>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static bool</b> <a id="6b68e62a30ab3ce9" href="../R/6b68e62a30ab3ce9.html" target="n" data-glyph="76,1" class="i method">TypeConverterPossiblyExists</a>(<span class="i">Type</span> <span id="r1178 rd" class="r1178 r">type</span>)
        {
            <b>lock</b> (<a href="#5149b15c031a9605" class="i field">s_possibleTypeConverter</a>)
            {
                <b>if</b> (<a href="#5149b15c031a9605" class="i field">s_possibleTypeConverter</a>.<span class="i">ContainsKey</span>(<span class="r1178 r">type</span>.<span class="i">FullName</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <span class="c">// GetCustomAttributes returns IEnumerable&lt;Attribute&gt; in CoreCLR</span>
            <b>var</b> <span id="r1179 rd" class="r1179 r">typeConverters</span> = <span class="r1178 r">type</span>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<span class="i">TypeConverterAttribute</span>), <b>false</b>);
            <b>if</b> (<span class="r1179 r">typeConverters</span>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>bool</b>&gt; <a id="5149b15c031a9605" href="../R/5149b15c031a9605.html" target="n" data-glyph="46,1" class="i field">s_possibleTypeConverter</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>bool</b>&gt;(16);
 
        <span class="c">// This is the internal dummy type used when an IDictionary is converted to a pscustomobject</span>
        <span class="c">// PS C:\&gt; $ps = [pscustomobject]@{a=10;b=5}</span>
        <span class="c">// PS C:\&gt; $ps = [pscustomobject][ordered]@{a=10;b=5}</span>
        <span class="c">// Whenever we see a conversion to PSCustomObject, we represent it as a conversion to InternalPSCustomObject</span>
        <span class="c">// This is introduced to avoid breaking PSObject behavior.</span>
        <span class="c">// (Because PSCustomObject is a typeaccelerator for PSObject, we needed a separate type to represent type conversions to PSCustomObject)</span>
        <b>internal class</b> <a id="f499f4c6b4eece87" href="../R/f499f4c6b4eece87.html" target="n" data-glyph="2,1" class="t t"><span id="efc755539690bd7e">InternalPSCustomObject</span></a>
        {
        }
 
        <b>internal class</b> <a id="5f55a01138afb49d" href="../R/5f55a01138afb49d.html" target="n" data-glyph="2,1" class="t t"><span id="df579bfd29e1b515">InternalPSObject</span></a> : <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> { }
 
        <b>internal static</b> <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <a id="7b24dbc305e38140" href="../R/7b24dbc305e38140.html" target="n" data-glyph="74,1" class="i method">FigureConversion</a>(<span class="i">Type</span> <span id="r1180 rd" class="r1180 r">fromType</span>, <span class="i">Type</span> <span id="r1181 rd" class="r1181 r">toType</span>)
        {
            <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r1182 rd" class="r1182 r">data</span> = <a href="#3561be37d82691c4" class="i method">GetConversionData</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>);
            <b>if</b> (<span class="r1182 r">data</span> != <b>null</b>)
            {
                <b>return</b> <span class="r1182 r">data</span>;
            }
 
            <b>if</b> (<span class="r1180 r">fromType</span> == <b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>))
            {
                <b>return</b> <a href="#1905a85f2b56d64c" class="i method">FigureConversionFromNull</a>(<span class="r1181 r">toType</span>);
            }
 
            <b>if</b> (<span class="r1181 r">toType</span>.<span class="i">IsAssignableFrom</span>(<span class="r1180 r">fromType</span>))
            {
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<b>object</b>&gt;(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#d99994607ce557b4" class="i method">ConvertAssignableFrom</a>,
                                               <span class="r1181 r">toType</span> == <span class="r1180 r">fromType</span> ? <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#0c841bf014a77138" class="i field">Identity</a> : <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6a83ff53b2a840f5" class="i field">Assignable</a>);
            }
 
            <b>if</b> (<span class="r1180 r">fromType</span>.<span class="i">IsByRefLike</span> || <span class="r1181 r">toType</span>.<span class="i">IsByRefLike</span>)
            {
                <span class="c">// ByRef-like types are not boxable and should be used on stack only.</span>
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <a href="#e305b87a9a31c9e7" class="i method">ConvertNoConversion</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>);
            }
 
            <b>if</b> (<b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">IsAssignableFrom</span>(<span class="r1180 r">fromType</span>) &amp;&amp; <b>typeof</b>(<a href="#5f55a01138afb49d" class="t t">InternalPSObject</a>) != <span class="r1180 r">fromType</span>)
            {
                <span class="c">// We don&#39;t attempt converting PSObject (or derived) to anything else,</span>
                <span class="c">// instead we go straight to PSObject.Base (which is only a PSObject</span>
                <span class="c">// when no object is wrapped, in which case we try conversions from object)</span>
                <span class="c">// and convert that instead.</span>
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <a href="#e305b87a9a31c9e7" class="i method">ConvertNoConversion</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>);
            }
 
            <b>if</b> (<span class="r1181 r">toType</span> == <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>))
            {
                <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#837d20d70c553c12" class="i method">ConvertToPSObject</a>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#7ce8a95e771d54af" class="i field">PSObject</a>);
            }
 
            <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <span id="r1183 rd" class="r1183 r">converter</span> = <b>null</b>;
            <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r1184 rd" class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>;
 
            <span class="c">// If we&#39;ve ever used ConstrainedLanguage, check if the target type is allowed</span>
            <b>if</b> (<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="ExecutionContext.cs.html#f3a9373a4fcbee98" class="i property">HasEverUsedConstrainedLanguage</a>)
            {
                <a href="ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r1185 rd" class="r1185 r">context</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
 
                <b>if</b> ((<span class="r1185 r">context</span> != <b>null</b>) &amp;&amp; (<span class="r1185 r">context</span>.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>))
                {
                    <b>if</b> ((<span class="r1181 r">toType</span> != <b>typeof</b>(<b>object</b>)) &amp;&amp;
                        (<span class="r1181 r">toType</span> != <b>typeof</b>(<b>object</b>[])) &amp;&amp;
                        (!<a href="parser/TypeResolver.cs.html#5741cea1a14d9f96" class="t t">CoreTypes</a>.<a href="parser/TypeResolver.cs.html#d10504c799ad8de9" class="i method">Contains</a>(<span class="r1181 r">toType</span>)))
                    {
                        <span class="r1183 r">converter</span> = <a href="#be111174c897918e" class="i method">ConvertNotSupportedConversion</a>;
                        <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>;
                        <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <span class="r1183 r">converter</span>, <span class="r1184 r">rank</span>);
                    }
                }
            }
 
            <a href="#73844e56b52453f7" class="t t">PSConverter</a>&lt;<b>object</b>&gt; <span id="r1186 rd" class="r1186 r">valueDependentConversion</span> = <b>null</b>;
            <a href="#7366d8a93041350f" class="t t">ConversionRank</a> <span id="r1187 rd" class="r1187 r">valueDependentRank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>;
            <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r1188 rd" class="r1188 r">conversionData</span> = <a href="#c6f75c7ef0c5a1a8" class="i method">FigureLanguageConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <b>out</b> <span class="r1186 r">valueDependentConversion</span>, <b>out</b> <span class="r1187 r">valueDependentRank</span>);
            <b>if</b> (<span class="r1188 r">conversionData</span> != <b>null</b>)
            {
                <b>return</b> <span class="r1188 r">conversionData</span>;
            }
 
            <span class="r1184 r">rank</span> = <span class="r1186 r">valueDependentConversion</span> != <b>null</b> ? <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c4444dad1388a497" class="i field">Language</a> : <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>;
            <span class="r1183 r">converter</span> = <a href="#a92ae21e445d14ed" class="i method">FigureParseConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>);
            <b>if</b> (<span class="r1183 r">converter</span> == <b>null</b>)
            {
                <span class="r1183 r">converter</span> = <a href="#b5cf68dcc442c6e4" class="i method">FigureStaticCreateMethodConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>);
                <b>if</b> (<span class="r1183 r">converter</span> == <b>null</b>)
                {
                    <span class="r1183 r">converter</span> = <a href="#3e2328cf7b0840d3" class="i method">FigureConstructorConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>);
                    <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#f884ff66af1f97c4" class="i field">Constructor</a>;
                    <b>if</b> (<span class="r1183 r">converter</span> == <b>null</b>)
                    {
                        <span class="r1183 r">converter</span> = <a href="#09a5a9e9100e4d75" class="i method">FigureCastConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <b>ref</b> <span class="r1184 r">rank</span>);
                        <b>if</b> (<span class="r1183 r">converter</span> == <b>null</b>)
                        {
                            <b>if</b> (<b>typeof</b>(<span class="i">IConvertible</span>).<span class="i">IsAssignableFrom</span>(<span class="r1180 r">fromType</span>))
                            {
                                <b>if</b> (<a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#e25b1c6d235a82c5" class="i method">IsNumeric</a>(<a href="#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r1180 r">fromType</span>)) &amp;&amp; !<span class="r1180 r">fromType</span>.<span class="i">IsEnum</span>)
                                {
                                    <b>if</b> (!<span class="r1181 r">toType</span>.<span class="i">IsArray</span>)
                                    {
                                        <b>if</b> (<span class="i">GetConversionRank</span>(<b>typeof</b>(<b>string</b>), <span class="r1181 r">toType</span>) != <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>)
                                        {
                                            <span class="r1183 r">converter</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#aaad1d54fa733681" class="i method">ConvertNumericIConvertible</a>;
                                            <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6806c359ea616c35" class="i field">IConvertible</a>;
                                        }
                                    }
                                }
                                <b>else</b> <b>if</b> (<span class="r1180 r">fromType</span> != <b>typeof</b>(<b>string</b>))
                                {
                                    <span class="r1183 r">converter</span> = <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="#6770dc1cd67c15d7" class="i method">ConvertIConvertible</a>;
                                    <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#6806c359ea616c35" class="i field">IConvertible</a>;
                                }
                            }
                            <b>else</b> <b>if</b> (<b>typeof</b>(<span class="i">IDictionary</span>).<span class="i">IsAssignableFrom</span>(<span class="r1180 r">fromType</span>))
                            {
                                <span class="c">// We need to call the null argument constructor only if the following 2 conditions satisfy</span>
                                <span class="c">//  1) if the fromType is either a hashtable or OrderedDictionary</span>
                                <span class="c">//  2) if the ToType does not already have a constructor that takes a hashtable or OrderedDictionary. (This is to avoid breaking existing apps.)</span>
                                <span class="c">// If the ToType has a constructor that takes a hashtable or OrderedDictionary,</span>
                                <span class="c">// then it would have been returned as the constructor during FigureConstructorConversion</span>
                                <span class="c">// So, we need to check only for the first condition</span>
                                <span class="i">ConstructorInfo</span> <span id="r1189 rd" class="r1189 r">resultConstructor</span> = <span class="r1181 r">toType</span>.<span class="i">GetConstructor</span>(<span class="i">Type</span>.<span class="i">EmptyTypes</span>);
 
                                <b>if</b> (<span class="r1189 r">resultConstructor</span> != <b>null</b> || (<span class="r1181 r">toType</span>.<span class="i">IsValueType</span> &amp;&amp; !<span class="r1181 r">toType</span>.<span class="i">IsPrimitive</span>))
                                {
                                    <a href="#550d2db25b155194" class="t t">ConvertViaNoArgumentConstructor</a> <span id="r1190 rd" class="r1190 r">noArgumentConstructorConverter</span> = <b>new</b> <a href="#2c6108280cdb13af" class="t constructor">ConvertViaNoArgumentConstructor</a>(<span class="r1189 r">resultConstructor</span>, <span class="r1181 r">toType</span>);
                                    <span class="r1183 r">converter</span> = <span class="r1190 r">noArgumentConstructorConverter</span>.<a href="#0e2a73daee8e219c" class="i method">Convert</a>;
                                    <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#f884ff66af1f97c4" class="i field">Constructor</a>;
                                }
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#f884ff66af1f97c4" class="i field">Constructor</a>;
                    }
                }
                <b>else</b>
                {
                    <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#fcd45ccb39fa69c1" class="i field">Create</a>;
                }
            }
            <b>else</b>
            {
                <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#872a928258f53dc3" class="i field">Parse</a>;
            }
 
            <b>if</b> (<span class="r1183 r">converter</span> == <b>null</b>)
            {
                <b>var</b> <span id="r1191 rd" class="r1191 r">tuple</span> = <a href="#a303110a0e50a014" class="i method">FigureIEnumerableConstructorConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>);
                <b>if</b> (<span class="r1191 r">tuple</span> != <b>null</b>)
                {
                    <span class="r1183 r">converter</span> = <span class="r1191 r">tuple</span>.<span class="i">Item1</span>;
                    <span class="r1184 r">rank</span> = <span class="r1191 r">tuple</span>.<span class="i">Item2</span>;
                }
            }
 
            <b>if</b> (<span class="r1183 r">converter</span> == <b>null</b>)
            {
                <span class="r1183 r">converter</span> = <a href="#4454b892705bf8c3" class="i method">FigurePropertyConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <b>ref</b> <span class="r1184 r">rank</span>);
            }
 
            <b>if</b> (<a href="#6b68e62a30ab3ce9" class="i method">TypeConverterPossiblyExists</a>(<span class="r1180 r">fromType</span>) || <a href="#6b68e62a30ab3ce9" class="i method">TypeConverterPossiblyExists</a>(<span class="r1181 r">toType</span>)
                || (<span class="r1183 r">converter</span> != <b>null</b> &amp;&amp; <span class="r1186 r">valueDependentConversion</span> != <b>null</b>))
            {
                <a href="#7dbd5fbce26e06cb" class="t t">ConvertCheckingForCustomConverter</a> <span id="r1192 rd" class="r1192 r">customConverter</span> = <b>new</b> <span class="t">ConvertCheckingForCustomConverter</span>();
                <span class="r1192 r">customConverter</span>.<a href="#5e0afd0f992118ed" class="i field">tryfirstConverter</a> = <span class="r1186 r">valueDependentConversion</span>;
                <span class="r1192 r">customConverter</span>.<a href="#b29857abae703ca6" class="i field">fallbackConverter</a> = <span class="r1183 r">converter</span>;
                <span class="r1183 r">converter</span> = <span class="r1192 r">customConverter</span>.<a href="#ce58e40bf9264a51" class="i method">Convert</a>;
                <b>if</b> (<span class="r1187 r">valueDependentRank</span> &gt; <span class="r1184 r">rank</span>)
                {
                    <span class="r1184 r">rank</span> = <span class="r1187 r">valueDependentRank</span>;
                }
                <b>else</b> <b>if</b> (<span class="r1184 r">rank</span> == <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>)
                {
                    <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#74c3beb153ee9616" class="i field">Custom</a>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r1186 r">valueDependentConversion</span> != <b>null</b>)
            {
                <span class="r1183 r">converter</span> = <span class="r1186 r">valueDependentConversion</span>;
                <span class="r1184 r">rank</span> = <span class="r1187 r">valueDependentRank</span>;
            }
 
            <b>if</b> (<span class="r1183 r">converter</span> == <b>null</b>)
            {
                <span class="r1183 r">converter</span> = <a href="#e305b87a9a31c9e7" class="i method">ConvertNoConversion</a>;
                <span class="r1184 r">rank</span> = <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>;
            }
 
            <b>return</b> <a href="#b2b73461cc3ff1d7" class="i method">CacheConversion</a>(<span class="r1180 r">fromType</span>, <span class="r1181 r">toType</span>, <span class="r1183 r">converter</span>, <span class="r1184 r">rank</span>);
        }
 
        <b>internal class</b> <a id="83ae667ba929e92f" href="../R/83ae667ba929e92f.html" target="n" data-glyph="2,1" class="t t"><span id="fe5481141fea2e92">Null</span></a> { }
 
        <b>private static</b> <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <a id="1905a85f2b56d64c" href="../R/1905a85f2b56d64c.html" target="n" data-glyph="76,1" class="i method">FigureConversionFromNull</a>(<span class="i">Type</span> <span id="r1193 rd" class="r1193 r">toType</span>)
        {
            <a href="#4cbbe0ec8ab6946f" class="t t">IConversionData</a> <span id="r1194 rd" class="r1194 r">data</span> = <span class="i">GetConversionData</span>(<b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>), <span class="r1193 r">toType</span>);
            <b>if</b> (<span class="r1194 r">data</span> != <b>null</b>)
            {
                <b>return</b> <span class="r1194 r">data</span>;
            }
 
            <b>if</b> (<span class="i">Nullable</span>.<span class="i">GetUnderlyingType</span>(<span class="r1193 r">toType</span>) != <b>null</b>)
            {
                <b>return</b> <span class="i">CacheConversion</span>&lt;<b>object</b>&gt;(<b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>), <span class="r1193 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertNullToNullable</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#ec18e6e3fbcda029" class="i field">NullToValue</a>);
            }
            <b>else</b> <b>if</b> (!<span class="r1193 r">toType</span>.<span class="i">IsValueType</span>)
            {
                <b>return</b> <span class="i">CacheConversion</span>&lt;<b>object</b>&gt;(<b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>), <span class="r1193 r">toType</span>, <a href="#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertNullToRef</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#92e8b910569c4813" class="i field">NullToRef</a>);
            }
 
            <b>return</b> <span class="i">CacheConversion</span>(<b>typeof</b>(<a href="#83ae667ba929e92f" class="t t">Null</a>), <span class="r1193 r">toType</span>, <span class="i">ConvertNoConversion</span>, <a href="#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="#c8e6b7371e1dec03" class="i field">None</a>);
        }
 
        <b>internal static string</b> <a id="bab300d080805cd3" href="../R/bab300d080805cd3.html" target="n" data-glyph="74,1" class="i method">ObjectToTypeNameString</a>(<b>object</b> <span id="r1195 rd" class="r1195 r">o</span>)
        {
            <b>if</b> (<span class="r1195 r">o</span> == <b>null</b>)
            {
                <b>return</b> <span class="s">&quot;null&quot;</span>;
            }
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1196 rd" class="r1196 r">pso</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r1195 r">o</span>);
            <a href="TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r1197 rd" class="r1197 r">typeNames</span> = <span class="r1196 r">pso</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <b>if</b> ((<span class="r1197 r">typeNames</span> != <b>null</b>) &amp;&amp; (<span class="r1197 r">typeNames</span>.<span class="i">Count</span> &gt; 0))
            {
                <b>return</b> <span class="r1197 r">typeNames</span>[0];
            }
 
            <b>return</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r1195 r">o</span>.<span class="i">GetType</span>());
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span> <span class="c">// AppDomain Not In CoreCLR</span>
<span class="e">        private static Assembly AssemblyResolveHelper(object sender, ResolveEventArgs args)
        {
            // Dynamic assemblies don&#39;t get resolved properly by the CLR, so we
            // resolve them ourselves by looking through the loaded assemblies.
            foreach (Assembly assem in ClrFacade.GetAssemblies())
            {
                if (assem.FullName == args.Name)
                {
                    return assem;
                }
            }
 
            return null;
        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> type converter
    }
}
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
</pre></td></tr></table></div></body></html>
