<!DOCTYPE html>
<html><head><title>ScriptAnalysis.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(582);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/Modules/ScriptAnalysis.cs" target="_top">engine\Modules\ScriptAnalysis.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class describing a PowerShell module...</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>internal class</b> <a id="2e6e7c9b1f1971eb" href="../../R/2e6e7c9b1f1971eb.html" target="n" data-glyph="2,0" class="t t"><span id="fb5e1272b98c9fb2">ScriptAnalysis</span></a>
    {
        <b>internal static</b> <a href="#2e6e7c9b1f1971eb" class="t t">ScriptAnalysis</a> <a id="9ff5957af5fe6571" href="../../R/9ff5957af5fe6571.html" target="n" data-glyph="74,1" class="i method">Analyze</a>(<b>string</b> <span id="r0 rd" class="r0 r">path</span>, <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r1 rd" class="r1 r">context</span>)
        {
            <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Analyzing path: {0}&quot;</span>, <span class="r0 r">path</span>);
 
            <b>try</b>
            {
                <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#035be1ae91f35c16" class="i method">PathIsUnc</a>(<span class="r0 r">path</span>) &amp;&amp; (<span class="r1 r">context</span>.<a href="../ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>.<a href="../CommandProcessorBase.cs.html#d539d84981be114a" class="i property">CommandRuntime</a> != <b>null</b>))
                {
                    <a href="../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r2 rd" class="r2 r">analysisProgress</span> = <b>new</b> <span class="t">ProgressRecord</span>(0,
                        <span class="i">Modules</span>.<span class="i">ScriptAnalysisPreparing</span>,
                        <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">Modules</span>.<span class="i">ScriptAnalysisModule</span>, <span class="r0 r">path</span>));
                    <span class="r2 r">analysisProgress</span>.<a href="../ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a> = <a href="../ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="../ProgressRecord.cs.html#b02a1a2b864a452c" class="i field">Processing</a>;
 
                    <span class="c">// Write the progress using a static source ID so that all</span>
                    <span class="c">// analysis messages get single-threaded in the progress pane (rather than nesting).</span>
                    <span class="r1 r">context</span>.<a href="../ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>.<a href="../CommandProcessorBase.cs.html#d539d84981be114a" class="i property">CommandRuntime</a>.<span class="i">WriteProgress</span>(<b>typeof</b>(<a href="#2e6e7c9b1f1971eb" class="t t">ScriptAnalysis</a>).<span class="i">FullName</span>.<span class="i">GetHashCode</span>(), <span class="r2 r">analysisProgress</span>);
                }
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span>)
            {
                <span class="c">// This may be called when we are not allowed to write progress,</span>
                <span class="c">// So eat the invalid operation</span>
            }
 
            <b>string</b> <span id="r3 rd" class="r3 r">scriptContent</span> = <a href="#484860e19aa74776" class="i method">ReadScript</a>(<span class="r0 r">path</span>);
 
            <a href="../parser/Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r4 rd" class="r4 r">errors</span>;
            <a href="../parser/ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r5 rd" class="r5 r">moduleAst</span> = (<b>new</b> <a href="../parser/Parser.cs.html#aee2c3138d83ea53" class="t constructor">Parser</a>()).<a href="../parser/Parser.cs.html#3b3edfaa9020f895" class="i method">Parse</a>(<span class="r0 r">path</span>, <span class="r3 r">scriptContent</span>, <b>null</b>, <b>out</b> <span class="r4 r">errors</span>, <a href="../parser/Parser.cs.html#5c0497999a31aece" class="t t">ParseMode</a>.<a href="../parser/Parser.cs.html#8b44977978de7d50" class="i field">ModuleAnalysis</a>);
 
            <span class="c">// Don&#39;t bother analyzing if there are syntax errors (we don&#39;t do semantic analysis which would</span>
            <span class="c">// detect other errors that we also might choose to ignore, but it&#39;s slower.)</span>
            <b>if</b> (<span class="r4 r">errors</span>.<span class="i">Length</span> &gt; 0)
                <b>return</b> <b>null</b>;
 
            <a href="#8fd7ce88c282d95d" class="t t">ExportVisitor</a> <span id="r6 rd" class="r6 r">exportVisitor</span> = <b>new</b> <a href="#8827a1bdef5ff66f" class="t constructor">ExportVisitor</a>(<span class="r7 r">forCompletion</span>: <b>false</b>);
            <span class="r5 r">moduleAst</span>.<a href="../parser/ast.cs.html#b97830265ba444e4" class="i method">Visit</a>(<span class="r6 r">exportVisitor</span>);
 
            <a href="#2e6e7c9b1f1971eb" class="k">var</a> <span id="r8 rd" class="r8 r">result</span> = <b>new</b> <span class="t">ScriptAnalysis</span>
            {
                <a href="#bfad1077264d648a" class="i property">DiscoveredClasses</a> = <span class="r6 r">exportVisitor</span>.<a href="#1b1abbe688c88d6e" class="i property">DiscoveredClasses</a>,
                <a href="#c38afc1469e4e905" class="i property">DiscoveredExports</a> = <span class="r6 r">exportVisitor</span>.<a href="#f94efb3ed6565f36" class="i property">DiscoveredExports</a>,
                <a href="#555e98f38c0bdb15" class="i property">DiscoveredAliases</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(),
                <a href="#5fcd03a802c8c8fd" class="i property">DiscoveredModules</a> = <span class="r6 r">exportVisitor</span>.<a href="#c2cddc93584e4e81" class="i property">DiscoveredModules</a>,
                <a href="#e87b5924da0eaa94" class="i property">DiscoveredCommandFilters</a> = <span class="r6 r">exportVisitor</span>.<a href="#5349d05a24002a5b" class="i property">DiscoveredCommandFilters</a>,
                <a href="#8628e703aa25ac68" class="i property">AddsSelfToPath</a> = <span class="r6 r">exportVisitor</span>.<a href="#cef929b1a1c51f5d" class="i property">AddsSelfToPath</a>
            };
 
            <b>if</b> (<span class="r8 r">result</span>.<a href="#e87b5924da0eaa94" class="i property">DiscoveredCommandFilters</a>.<span class="i">Count</span> == 0)
            {
                <span class="r8 r">result</span>.<a href="#e87b5924da0eaa94" class="i property">DiscoveredCommandFilters</a>.<span class="i">Add</span>(<span class="s">&quot;*&quot;</span>);
            }
            <b>else</b>
            {
                <span class="c">// Post-process aliases, as they are not exported by default</span>
                <span class="i">List</span>&lt;<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>&gt; <span id="r9 rd" class="r9 r">patterns</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>&gt;();
                <b>foreach</b> (<b>string</b> <span id="r10 rd" class="r10 r">discoveredCommandFilter</span> <b>in</b> <span class="r8 r">result</span>.<a href="#e87b5924da0eaa94" class="i property">DiscoveredCommandFilters</a>)
                {
                    <span class="r9 r">patterns</span>.<span class="i">Add</span>(<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r10 r">discoveredCommandFilter</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>));
                }
 
                <b>foreach</b> (<b>var</b> <span id="r11 rd" class="r11 r">pair</span> <b>in</b> <span class="r6 r">exportVisitor</span>.<a href="#5233ff15337c6dc2" class="i property">DiscoveredAliases</a>)
                {
                    <b>string</b> <span id="r12 rd" class="r12 r">discoveredAlias</span> = <span class="r11 r">pair</span>.<span class="i">Key</span>;
                    <b>if</b> (<a href="../SessionStateUtils.cs.html#a64f812795996898" class="t t">SessionStateUtilities</a>.<span class="i">MatchesAnyWildcardPattern</span>(<span class="r12 r">discoveredAlias</span>, <span class="r9 r">patterns</span>, <span class="i">defaultValue</span>: <b>false</b>))
                    {
                        <span class="r8 r">result</span>.<a href="#555e98f38c0bdb15" class="i property">DiscoveredAliases</a>[<span class="r12 r">discoveredAlias</span>] = <span class="r11 r">pair</span>.<span class="i">Value</span>;
                    }
                }
            }
 
            <b>return</b> <span class="r8 r">result</span>;
        }
 
        <b>internal static string</b> <a id="484860e19aa74776" href="../../R/484860e19aa74776.html" target="n" data-glyph="74,1" class="i method">ReadScript</a>(<b>string</b> <span id="r13 rd" class="r13 r">path</span>)
        {
            <b>using</b> (<span class="i">FileStream</span> <span id="r14 rd" class="r14 r">readerStream</span> = <b>new</b> <span class="i">FileStream</span>(<span class="r13 r">path</span>, <span class="i">FileMode</span>.<span class="i">Open</span>, <span class="i">FileAccess</span>.<span class="i">Read</span>))
            {
                <span class="i">Encoding</span> <span id="r15 rd" class="r15 r">defaultEncoding</span> = <a href="../../utils/ClrFacade.cs.html#a9a016478ec73a42" class="t t">ClrFacade</a>.<a href="../../utils/ClrFacade.cs.html#0c8a7fc2b80117dd" class="i method">GetDefaultEncoding</a>();
                <span class="i n">Microsoft</span>.<span class="i">Win32</span>.<span class="i">SafeHandles</span>.<span class="i">SafeFileHandle</span> <span id="r16 rd" class="r16 r">safeFileHandle</span> = <span class="r14 r">readerStream</span>.<span class="i">SafeFileHandle</span>;
 
                <b>using</b> (<span class="i">StreamReader</span> <span id="r17 rd" class="r17 r">scriptReader</span> = <b>new</b> <span class="i">StreamReader</span>(<span class="r14 r">readerStream</span>, <span class="r15 r">defaultEncoding</span>))
                {
                    <b>return</b> <span class="r17 r">scriptReader</span>.<span class="i">ReadToEnd</span>();
                }
            }
        }
 
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="c38afc1469e4e905" href="../../R/c38afc1469e4e905.html" target="n" data-glyph="104,1" class="i property">DiscoveredExports</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="555e98f38c0bdb15" href="../../R/555e98f38c0bdb15.html" target="n" data-glyph="104,1" class="i property">DiscoveredAliases</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="#4338f9d8512eeb59" class="t t">RequiredModuleInfo</a>&gt; <a id="5fcd03a802c8c8fd" href="../../R/5fcd03a802c8c8fd.html" target="n" data-glyph="104,1" class="i property">DiscoveredModules</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="e87b5924da0eaa94" href="../../R/e87b5924da0eaa94.html" target="n" data-glyph="104,1" class="i property">DiscoveredCommandFilters</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="8628e703aa25ac68" href="../../R/8628e703aa25ac68.html" target="n" data-glyph="104,1" class="i property">AddsSelfToPath</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="../parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <a id="bfad1077264d648a" href="../../R/bfad1077264d648a.html" target="n" data-glyph="104,1" class="i property">DiscoveredClasses</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">// Defines the visitor that analyzes a script to determine its exports</span>
    <span class="c">// and dependencies.</span>
    <b>internal class</b> <a id="8fd7ce88c282d95d" href="../../R/8fd7ce88c282d95d.html" target="n" data-glyph="2,0" class="t t">ExportVisitor</a> : <a href="../parser/PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>
    {
        <b>internal</b> <a id="8827a1bdef5ff66f" href="../../R/8827a1bdef5ff66f.html" target="n" data-glyph="74,1" class="t constructor">ExportVisitor</a>(<b>bool</b> <span id="r7 rd" class="r7 r">forCompletion</span>)
        {
            <a href="#6206f252898e59c0" class="i field">_forCompletion</a> = <span class="r7 r">forCompletion</span>;
            <a href="#f94efb3ed6565f36" class="i property">DiscoveredExports</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <a href="#686b588b5e83aa47" class="i property">DiscoveredFunctions</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#5233ff15337c6dc2" class="i property">DiscoveredAliases</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#c2cddc93584e4e81" class="i property">DiscoveredModules</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#4338f9d8512eeb59" class="t t">RequiredModuleInfo</a>&gt;();
            <a href="#5349d05a24002a5b" class="i property">DiscoveredCommandFilters</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <a href="#1b1abbe688c88d6e" class="i property">DiscoveredClasses</a> = <b>new</b> <span class="i">List</span>&lt;<a href="../parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt;();
        }
 
        <b>static</b> <a id="1de87fc0993ddc54" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">ExportVisitor</a>()
        {
            <a href="#d626561952ca31b4" class="k">var</a> <span id="r18 rd" class="r18 r">nameParam</span> = <b>new</b> <span class="t">ParameterInfo</span> { <a href="#3da7aa856ab0d0b6" class="i field">name</a> = <span class="s">&quot;Name&quot;</span>, <a href="#2e467d6eef66dc52" class="i field">position</a> = 0 };
            <a href="#d626561952ca31b4" class="k">var</a> <span id="r19 rd" class="r19 r">valueParam</span> = <b>new</b> <span class="t">ParameterInfo</span> { <a href="#3da7aa856ab0d0b6" class="i field">name</a> = <span class="s">&quot;Value&quot;</span>, <a href="#2e467d6eef66dc52" class="i field">position</a> = 1 };
            <a href="#a86ab61ed3ab47bb" class="k">var</a> <span id="r20 rd" class="r20 r">aliasParameterInfo</span> = <b>new</b> <span class="t">ParameterBindingInfo</span> { <a href="#197f09669c8bd3c5" class="i field">parameterInfo</a> = <b>new</b>[] { <span class="r18 r">nameParam</span>, <span class="r19 r">valueParam</span> } };
 
            <a href="#d626561952ca31b4" class="k">var</a> <span id="r21 rd" class="r21 r">functionParam</span> = <b>new</b> <span class="t">ParameterInfo</span> { <a href="#3da7aa856ab0d0b6" class="i field">name</a> = <span class="s">&quot;Function&quot;</span>, <a href="#2e467d6eef66dc52" class="i field">position</a> = -1 };
            <a href="#d626561952ca31b4" class="k">var</a> <span id="r22 rd" class="r22 r">cmdletParam</span> = <b>new</b> <span class="t">ParameterInfo</span> { <a href="#3da7aa856ab0d0b6" class="i field">name</a> = <span class="s">&quot;Cmdlet&quot;</span>, <a href="#2e467d6eef66dc52" class="i field">position</a> = -1 };
            <a href="#d626561952ca31b4" class="k">var</a> <span id="r23 rd" class="r23 r">aliasParam</span> = <b>new</b> <span class="t">ParameterInfo</span> { <a href="#3da7aa856ab0d0b6" class="i field">name</a> = <span class="s">&quot;Alias&quot;</span>, <a href="#2e467d6eef66dc52" class="i field">position</a> = -1 };
            <a href="#a86ab61ed3ab47bb" class="k">var</a> <span id="r24 rd" class="r24 r">ipmoParameterInfo</span> = <b>new</b> <span class="t">ParameterBindingInfo</span> { <a href="#197f09669c8bd3c5" class="i field">parameterInfo</a> = <b>new</b>[] { <span class="r18 r">nameParam</span>, <span class="r21 r">functionParam</span>, <span class="r22 r">cmdletParam</span>, <span class="r23 r">aliasParam</span> } };
 
            <span class="r21 r">functionParam</span> = <b>new</b> <span class="t">ParameterInfo</span> { <a href="#3da7aa856ab0d0b6" class="i field">name</a> = <span class="s">&quot;Function&quot;</span>, <a href="#2e467d6eef66dc52" class="i field">position</a> = 0 };
            <a href="#a86ab61ed3ab47bb" class="k">var</a> <span id="r25 rd" class="r25 r">exportModuleMemberInfo</span> = <b>new</b> <span class="t">ParameterBindingInfo</span> { <a href="#197f09669c8bd3c5" class="i field">parameterInfo</a> = <b>new</b>[] { <span class="r21 r">functionParam</span>, <span class="r22 r">cmdletParam</span>, <span class="r23 r">aliasParam</span> } };
 
            <a href="#c66c6e021cf16169" class="i field">s_parameterBindingInfoTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#a86ab61ed3ab47bb" class="t t">ParameterBindingInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
            {
                {<span class="s">&quot;New-Alias&quot;</span>,                                      <span class="r20 r">aliasParameterInfo</span>},
                {<span class="s">@&quot;Microsoft.PowerShell.Utility\New-Alias&quot;</span>,        <span class="r20 r">aliasParameterInfo</span>},
                {<span class="s">&quot;Set-Alias&quot;</span>,                                      <span class="r20 r">aliasParameterInfo</span>},
                {<span class="s">@&quot;Microsoft.PowerShell.Utility\Set-Alias&quot;</span>,        <span class="r20 r">aliasParameterInfo</span>},
                {<span class="s">&quot;nal&quot;</span>,                                            <span class="r20 r">aliasParameterInfo</span>},
                {<span class="s">&quot;sal&quot;</span>,                                            <span class="r20 r">aliasParameterInfo</span>},
                {<span class="s">&quot;Import-Module&quot;</span>,                                  <span class="r24 r">ipmoParameterInfo</span>},
                {<span class="s">@&quot;Microsoft.PowerShell.Core\Import-Module&quot;</span>,       <span class="r24 r">ipmoParameterInfo</span>},
                {<span class="s">&quot;ipmo&quot;</span>,                                           <span class="r24 r">ipmoParameterInfo</span>},
                {<span class="s">&quot;Export-ModuleMember&quot;</span>,                            <span class="r25 r">exportModuleMemberInfo</span>},
                {<span class="s">@&quot;Microsoft.PowerShell.Core\Export-ModuleMember&quot;</span>, <span class="r25 r">exportModuleMemberInfo</span>}
            };
        }
 
        <b>private readonly bool</b> <a id="6206f252898e59c0" href="../../R/6206f252898e59c0.html" target="n" data-glyph="46,1" class="i field">_forCompletion</a>;
 
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="f94efb3ed6565f36" href="../../R/f94efb3ed6565f36.html" target="n" data-glyph="104,1" class="i property">DiscoveredExports</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="#4338f9d8512eeb59" class="t t">RequiredModuleInfo</a>&gt; <a id="c2cddc93584e4e81" href="../../R/c2cddc93584e4e81.html" target="n" data-glyph="104,1" class="i property">DiscoveredModules</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>&gt; <a id="686b588b5e83aa47" href="../../R/686b588b5e83aa47.html" target="n" data-glyph="104,1" class="i property">DiscoveredFunctions</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="5233ff15337c6dc2" href="../../R/5233ff15337c6dc2.html" target="n" data-glyph="104,1" class="i property">DiscoveredAliases</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="5349d05a24002a5b" href="../../R/5349d05a24002a5b.html" target="n" data-glyph="104,1" class="i property">DiscoveredCommandFilters</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="cef929b1a1c51f5d" href="../../R/cef929b1a1c51f5d.html" target="n" data-glyph="104,1" class="i property">AddsSelfToPath</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="../parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <a id="1b1abbe688c88d6e" href="../../R/1b1abbe688c88d6e.html" target="n" data-glyph="104,1" class="i property">DiscoveredClasses</a> { <b>get</b>; <b>set</b>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="b4a48b059938ddd5" href="../../R/b4a48b059938ddd5.html" target="n" data-glyph="72,1" class="i method">VisitTypeDefinition</a>(<a href="../parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r26 rd" class="r26 r">typeDefinitionAst</span>)
        {
            <a href="#1b1abbe688c88d6e" class="i property">DiscoveredClasses</a>.<span class="i">Add</span>(<span class="r26 r">typeDefinitionAst</span>);
            <b>return</b> <a href="#6206f252898e59c0" class="i field">_forCompletion</a> ? <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a> : <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
        }
 
        <span class="c">// Capture simple function definitions</span>
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e60fae1f1ed0995a" href="../../R/e60fae1f1ed0995a.html" target="n" data-glyph="72,1" class="i method">VisitFunctionDefinition</a>(<a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r27 rd" class="r27 r">functionDefinitionAst</span>)
        {
            <span class="c">// Nested functions are ignored for the purposes of exports, but are still</span>
            <span class="c">// recorded for command/parameter completion.</span>
 
            <span class="c">// function Foo-Bar { ... }</span>
 
            <b>var</b> <span id="r28 rd" class="r28 r">functionName</span> = <span class="r27 r">functionDefinitionAst</span>.<a href="../parser/ast.cs.html#951cc91108156df0" class="i property">Name</a>;
            <a href="#686b588b5e83aa47" class="i property">DiscoveredFunctions</a>[<span class="r28 r">functionName</span>] = <span class="r27 r">functionDefinitionAst</span>;
            <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Discovered function definition: {0}&quot;</span>, <span class="r28 r">functionName</span>);
 
            <span class="c">// Check if they&#39;ve defined any aliases</span>
            <span class="c">// function Foo-Bar { [Alias(&quot;Alias1&quot;, &quot;...&quot;)] param() ... }</span>
 
            <a href="../parser/ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r29 rd" class="r29 r">functionBody</span> = <span class="r27 r">functionDefinitionAst</span>.<a href="../parser/ast.cs.html#201bce3cfc040274" class="i property">Body</a>;
            <b>if</b> ((<span class="r29 r">functionBody</span>.<a href="../parser/ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>) &amp;&amp; (<span class="r29 r">functionBody</span>.<a href="../parser/ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="../parser/ast.cs.html#2f9e902bfe8c2c10" class="i property">Attributes</a> != <b>null</b>))
            {
                <b>foreach</b> (<a href="../parser/ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r30 rd" class="r30 r">attribute</span> <b>in</b> <span class="r29 r">functionBody</span>.<a href="../parser/ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="../parser/ast.cs.html#2f9e902bfe8c2c10" class="i property">Attributes</a>)
                {
                    <b>if</b> (<span class="r30 r">attribute</span>.<a href="../parser/ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="../parser/ast.cs.html#32e4c2eb2fe24684" class="i method">GetReflectionAttributeType</a>() == <b>typeof</b>(<a href="../Attributes.cs.html#0fd790dcae0b5382" class="t t">AliasAttribute</a>))
                    {
                        <b>foreach</b> (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r31 rd" class="r31 r">aliasAst</span> <b>in</b> <span class="r30 r">attribute</span>.<a href="../parser/ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>)
                        {
                            <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r32 rd" class="r32 r">aliasExpression</span> = <span class="r31 r">aliasAst</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                            <b>if</b> (<span class="r32 r">aliasExpression</span> != <b>null</b>)
                            {
                                <b>string</b> <span id="r33 rd" class="r33 r">alias</span> = <span class="r32 r">aliasExpression</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
 
                                <a href="#5233ff15337c6dc2" class="i property">DiscoveredAliases</a>[<span class="r33 r">alias</span>] = <span class="r28 r">functionName</span>;
                                <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(<span class="s">&quot;Function defines alias: {0} = {1}&quot;</span>, <span class="r33 r">alias</span>, <span class="r28 r">functionName</span>);
                            }
                        }
                    }
                }
            }
 
            <b>if</b> (<a href="#6206f252898e59c0" class="i field">_forCompletion</a>)
            {
                <b>if</b> (<a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>.<a href="../parser/ast.cs.html#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>&gt;(<span class="r27 r">functionDefinitionAst</span>).<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> == <b>null</b>)
                {
                    <a href="#f94efb3ed6565f36" class="i property">DiscoveredExports</a>.<span class="i">Add</span>(<span class="r28 r">functionName</span>);
                }
 
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <a href="#f94efb3ed6565f36" class="i property">DiscoveredExports</a>.<span class="i">Add</span>(<span class="r28 r">functionName</span>);
            <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
        }
 
        <span class="c">// Capture modules that add themselves to the path (so they generally package their functionality</span>
        <span class="c">// as loose PS1 files)</span>
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="889d4255ba85f374" href="../../R/889d4255ba85f374.html" target="n" data-glyph="72,1" class="i method">VisitAssignmentStatement</a>(<a href="../parser/ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r34 rd" class="r34 r">assignmentStatementAst</span>)
        {
            <span class="c">// $env:PATH += &quot;&quot;;$psScriptRoot&quot;&quot;</span>
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;$env:PATH&quot;</span>, <span class="r34 r">assignmentStatementAst</span>.<a href="../parser/ast.cs.html#737e87d58bda06dc" class="i property">Left</a>.<a href="../parser/ast.cs.html#e8e96a43a76cce85" class="i method">ToString</a>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                <span class="i">Regex</span>.<span class="i">IsMatch</span>(<span class="r34 r">assignmentStatementAst</span>.<a href="../parser/ast.cs.html#ca8f4cbe093f3036" class="i property">Right</a>.<a href="../parser/ast.cs.html#e8e96a43a76cce85" class="i method">ToString</a>(), <span class="s">&quot;\\$psScriptRoot&quot;</span>, <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span>))
            {
                <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Module adds itself to the path.&quot;</span>);
                <a href="#cef929b1a1c51f5d" class="i property">AddsSelfToPath</a> = <b>true</b>;
            }
 
            <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
        }
 
        <span class="c">// We skip a bunch of random statements because we can&#39;t really be accurate detecting functions/classes etc. that</span>
        <span class="c">// are conditionally defined.</span>
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="5ab1113cae0b9bae" href="../../R/5ab1113cae0b9bae.html" target="n" data-glyph="72,1" class="i method">VisitIfStatement</a>(<a href="../parser/ast.cs.html#5371982d66a6137d" class="t t">IfStatementAst</a> <span id="r35 rd" class="r35 r">ifStmtAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="4474af58dbf2ca7c" href="../../R/4474af58dbf2ca7c.html" target="n" data-glyph="72,1" class="i method">VisitDataStatement</a>(<a href="../parser/ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r36 rd" class="r36 r">dataStatementAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="37bfda5fcb1b331f" href="../../R/37bfda5fcb1b331f.html" target="n" data-glyph="72,1" class="i method">VisitForEachStatement</a>(<a href="../parser/ast.cs.html#9ae6aa2909fef7b0" class="t t">ForEachStatementAst</a> <span id="r37 rd" class="r37 r">forEachStatementAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="49144c1b240e1eba" href="../../R/49144c1b240e1eba.html" target="n" data-glyph="72,1" class="i method">VisitForStatement</a>(<a href="../parser/ast.cs.html#4ca51f16f7c100d4" class="t t">ForStatementAst</a> <span id="r38 rd" class="r38 r">forStatementAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f1492e72fe8a2f8e" href="../../R/f1492e72fe8a2f8e.html" target="n" data-glyph="72,1" class="i method">VisitDoUntilStatement</a>(<a href="../parser/ast.cs.html#d641b5faf306abeb" class="t t">DoUntilStatementAst</a> <span id="r39 rd" class="r39 r">doUntilStatementAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="a43b0a1ca1e521af" href="../../R/a43b0a1ca1e521af.html" target="n" data-glyph="72,1" class="i method">VisitDoWhileStatement</a>(<a href="../parser/ast.cs.html#b2d1fe560ff56deb" class="t t">DoWhileStatementAst</a> <span id="r40 rd" class="r40 r">doWhileStatementAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="5f61ea1483bd0ac0" href="../../R/5f61ea1483bd0ac0.html" target="n" data-glyph="72,1" class="i method">VisitWhileStatement</a>(<a href="../parser/ast.cs.html#4e9a52b62ed8b2b1" class="t t">WhileStatementAst</a> <span id="r41 rd" class="r41 r">whileStatementAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="59fdc00eb9550e44" href="../../R/59fdc00eb9550e44.html" target="n" data-glyph="72,1" class="i method">VisitInvokeMemberExpression</a>(<a href="../parser/ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <span id="r42 rd" class="r42 r">methodCallAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d70790b183c0c613" href="../../R/d70790b183c0c613.html" target="n" data-glyph="72,1" class="i method">VisitSwitchStatement</a>(<a href="../parser/ast.cs.html#4d96f6c979a5266e" class="t t">SwitchStatementAst</a> <span id="r43 rd" class="r43 r">switchStatementAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1777445054ed5c5c" href="../../R/1777445054ed5c5c.html" target="n" data-glyph="72,1" class="i method">VisitTernaryExpression</a>(<a href="../parser/ast.cs.html#75320d2e9ca587ab" class="t t">TernaryExpressionAst</a> <span id="r44 rd" class="r44 r">ternaryExpressionAst</span>) { <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>; }
 
        <span class="c">// Visit one the other variations:</span>
        <span class="c">//  - Dotting scripts</span>
        <span class="c">//  - Setting aliases</span>
        <span class="c">//  - Importing modules</span>
        <span class="c">//  - Exporting module members</span>
        <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="9cb2674c34a234ac" href="../../R/9cb2674c34a234ac.html" target="n" data-glyph="72,1" class="i method">VisitCommand</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r45 rd" class="r45 r">commandAst</span>)
        {
            <b>string</b> <span id="r46 rd" class="r46 r">commandName</span> =
                <span class="r45 r">commandAst</span>.<a href="../parser/ast.cs.html#14cec84b5558d5c6" class="i method">GetCommandName</a>() ??
                <a href="../parser/SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<span class="i">GetSafeValue</span>(<span class="r45 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0], <b>null</b>, <a href="../parser/SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<a href="../parser/SafeValues.cs.html#525ae8157bd81dda" class="t t">SafeValueContext</a>.<a href="../parser/SafeValues.cs.html#d14a32df3b92df13" class="i field">ModuleAnalysis</a>) <b>as string</b>;
 
            <b>if</b> (<span class="r46 r">commandName</span> == <b>null</b>)
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
 
            <span class="c">// They are trying to dot a script</span>
            <b>if</b> (<span class="r45 r">commandAst</span>.<a href="../parser/ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> == <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#a9023444a1ee3a84" class="i field">Dot</a>)
            {
                <span class="c">// . Foo-Bar4.ps1</span>
                <span class="c">// . $psScriptRoot\Foo-Bar.ps1 -Bing Baz</span>
                <span class="c">// . &quot;&quot;$psScriptRoot\Support Files\Foo-Bar2.ps1&quot;&quot; -Bing Baz</span>
                <span class="c">// . &#39;$psScriptRoot\Support Files\Foo-Bar3.ps1&#39; -Bing Baz</span>
 
                <a href="#c2cddc93584e4e81" class="i property">DiscoveredModules</a>.<span class="i">Add</span>(
                    <b>new</b> <span class="t">RequiredModuleInfo</span> { <a href="#eccd719226aaf6a1" class="i property">Name</a> = <span class="r46 r">commandName</span>, <a href="#379dff66ea3e53aa" class="i property">CommandsToPostFilter</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;() });
                <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Module dots {0}&quot;</span>, <span class="r46 r">commandName</span>);
            }
 
            <span class="c">// They are setting an alias.</span>
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;New-Alias&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;Microsoft.PowerShell.Utility\\New-Alias&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;Set-Alias&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;Microsoft.PowerShell.Utility\\Set-Alias&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;nal&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;sal&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// Set-Alias Foo-Bar5 Foo-Bar</span>
                <span class="c">// Set-Alias -Name Foo-Bar6 -Value Foo-Bar</span>
                <span class="c">// sal Foo-Bar7 Foo-Bar</span>
                <span class="c">// sal -Value Foo-Bar -Name Foo-Bar8</span>
 
                <b>var</b> <span id="r47 rd" class="r47 r">boundParameters</span> = <a href="#3ebf423b656ce6a4" class="i method">DoPsuedoParameterBinding</a>(<span class="r45 r">commandAst</span>, <span class="r46 r">commandName</span>);
 
                <b>var</b> <span id="r48 rd" class="r48 r">name</span> = <span class="r47 r">boundParameters</span>[<span class="s">&quot;Name&quot;</span>] <b>as string</b>;
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r48 r">name</span>))
                {
                    <b>var</b> <span id="r49 rd" class="r49 r">value</span> = <span class="r47 r">boundParameters</span>[<span class="s">&quot;Value&quot;</span>] <b>as string</b>;
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r49 r">value</span>))
                    {
                        <span class="c">// These aren&#39;t stored in DiscoveredExports, as they are only</span>
                        <span class="c">// exported after the user calls Export-ModuleMember.</span>
                        <a href="#5233ff15337c6dc2" class="i property">DiscoveredAliases</a>[<span class="r48 r">name</span>] = <span class="r49 r">value</span>;
                        <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(<span class="s">&quot;Module defines alias: {0} = {1}&quot;</span>, <span class="r48 r">name</span>, <span class="r49 r">value</span>);
                    }
                }
 
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
            }
 
            <span class="c">// They are importing a module</span>
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;Import-Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;ipmo&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// Import-Module Module1</span>
                <span class="c">// Import-Module Module2 -Function Foo-Module2*, Foo-Module2Second* -Cmdlet Foo-Module2Cmdlet,Foo-Module2Cmdlet*</span>
                <span class="c">// Import-Module Module3 -Function Foo-Module3Command1, Foo-Module3Command2</span>
                <span class="c">// Import-Module Module4,</span>
                <span class="c">//    Module5</span>
                <span class="c">// Import-Module -Name Module6,</span>
                <span class="c">//    Module7 -Global</span>
 
                <b>var</b> <span id="r50 rd" class="r50 r">boundParameters</span> = <a href="#3ebf423b656ce6a4" class="i method">DoPsuedoParameterBinding</a>(<span class="r45 r">commandAst</span>, <span class="r46 r">commandName</span>);
 
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r51 rd" class="r51 r">commandsToPostFilter</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <span class="i">Action</span>&lt;<b>string</b>&gt; <span id="r52 rd" class="r52 r">onEachCommand</span> = <span id="r53 rd" class="r53 r">importedCommandName</span> =&gt; <span class="r51 r">commandsToPostFilter</span>.<span class="i">Add</span>(<span class="r53 r">importedCommandName</span>);
 
                <span class="c">// Process any exports from the module that we determine from</span>
                <span class="c">// the -Function, -Cmdlet, or -Alias parameters</span>
                <span class="i">ProcessCmdletArguments</span>(<span class="r50 r">boundParameters</span>[<span class="s">&quot;Function&quot;</span>], <span class="r52 r">onEachCommand</span>);
                <span class="i">ProcessCmdletArguments</span>(<span class="r50 r">boundParameters</span>[<span class="s">&quot;Cmdlet&quot;</span>], <span class="r52 r">onEachCommand</span>);
                <span class="i">ProcessCmdletArguments</span>(<span class="r50 r">boundParameters</span>[<span class="s">&quot;Alias&quot;</span>], <span class="r52 r">onEachCommand</span>);
 
                <span class="c">// Now, go through all of the discovered modules on Import-Module</span>
                <span class="c">// and register them for deeper investigation.</span>
                <span class="i">Action</span>&lt;<b>string</b>&gt; <span id="r54 rd" class="r54 r">onEachModule</span> = <span id="r55 rd" class="r55 r">moduleName</span> =&gt;
                {
                    <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Discovered module import: {0}&quot;</span>, <span class="r55 r">moduleName</span>);
                    <a href="#c2cddc93584e4e81" class="i property">DiscoveredModules</a>.<span class="i">Add</span>(
                        <b>new</b> <span class="t">RequiredModuleInfo</span>
                        {
                            <a href="#eccd719226aaf6a1" class="i property">Name</a> = <span class="r55 r">moduleName</span>,
                            <a href="#379dff66ea3e53aa" class="i property">CommandsToPostFilter</a> = <span class="r51 r">commandsToPostFilter</span>
                        });
                };
                <span class="i">ProcessCmdletArguments</span>(<span class="r50 r">boundParameters</span>[<span class="s">&quot;Name&quot;</span>], <span class="r54 r">onEachModule</span>);
 
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
            }
 
            <span class="c">// They are exporting a module member</span>
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;Export-ModuleMember&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;Microsoft.PowerShell.Core\\Export-ModuleMember&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;$script:ExportModuleMember&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// Export-ModuleMember *</span>
                <span class="c">// Export-ModuleMember Exported-UnNamedModuleMember</span>
                <span class="c">// Export-ModuleMember -Function Exported-FunctionModuleMember1, Exported-FunctionModuleMember2 -Cmdlet Exported-CmdletModuleMember `</span>
                <span class="c">//    -Alias Exported-AliasModuleMember</span>
                <span class="c">// &amp; $script:ExportModuleMember -Function (...)</span>
 
                <b>var</b> <span id="r56 rd" class="r56 r">boundParameters</span> = <a href="#3ebf423b656ce6a4" class="i method">DoPsuedoParameterBinding</a>(<span class="r45 r">commandAst</span>, <span class="r46 r">commandName</span>);
 
                <span class="i">Action</span>&lt;<b>string</b>&gt; <span id="r57 rd" class="r57 r">onEachFunction</span> = <span id="r58 rd" class="r58 r">exportedCommandName</span> =&gt;
                {
                    <a href="#5349d05a24002a5b" class="i property">DiscoveredCommandFilters</a>.<span class="i">Add</span>(<span class="r58 r">exportedCommandName</span>);
                    <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#3b5fe290216e5c03" class="i field">Tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Discovered explicit export: {0}&quot;</span>, <span class="r58 r">exportedCommandName</span>);
 
                    <span class="c">// If the export doesn&#39;t contain wildcards, then add it to the</span>
                    <span class="c">// discovered commands as well. It is likely that they created</span>
                    <span class="c">// the command dynamically</span>
                    <b>if</b> ((!<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">ContainsWildcardCharacters</span>(<span class="r58 r">exportedCommandName</span>)) &amp;&amp;
                        (!<a href="#f94efb3ed6565f36" class="i property">DiscoveredExports</a>.<span class="i">Contains</span>(<span class="r58 r">exportedCommandName</span>)))
                    {
                        <a href="#f94efb3ed6565f36" class="i property">DiscoveredExports</a>.<span class="i">Add</span>(<span class="r58 r">exportedCommandName</span>);
                    }
                };
                <span class="i">ProcessCmdletArguments</span>(<span class="r56 r">boundParameters</span>[<span class="s">&quot;Function&quot;</span>], <span class="r57 r">onEachFunction</span>);
                <span class="i">ProcessCmdletArguments</span>(<span class="r56 r">boundParameters</span>[<span class="s">&quot;Cmdlet&quot;</span>], <span class="r57 r">onEachFunction</span>);
 
                <span class="i">Action</span>&lt;<b>string</b>&gt; <span id="r59 rd" class="r59 r">onEachAlias</span> = <span id="r60 rd" class="r60 r">exportedAlias</span> =&gt;
                {
                    <a href="#5349d05a24002a5b" class="i property">DiscoveredCommandFilters</a>.<span class="i">Add</span>(<span class="r60 r">exportedAlias</span>);
 
                    <span class="c">// If the export doesn&#39;t contain wildcards, then add it to the</span>
                    <span class="c">// discovered commands as well. It is likely that they created</span>
                    <span class="c">// the command dynamically</span>
                    <b>if</b> (!<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">ContainsWildcardCharacters</span>(<span class="r60 r">exportedAlias</span>))
                    {
                        <a href="#5233ff15337c6dc2" class="i property">DiscoveredAliases</a>[<span class="r60 r">exportedAlias</span>] = <b>null</b>;
                    }
                };
                <span class="i">ProcessCmdletArguments</span>(<span class="r56 r">boundParameters</span>[<span class="s">&quot;Alias&quot;</span>], <span class="r59 r">onEachAlias</span>);
 
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
            }
 
            <span class="c">// They are exporting a module member using our advanced &#39;public&#39; function</span>
            <span class="c">// that we&#39;ve presented in many demos</span>
            <b>if</b> ((<b>string</b>.<span class="i">Equals</span>(<span class="r46 r">commandName</span>, <span class="s">&quot;public&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) &amp;&amp;
                (<span class="r45 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> &gt; 2))
            {
                <span class="c">// public function Publicly-ExportedFunction</span>
                <span class="c">// public alias Publicly-ExportedAlias</span>
                <b>string</b> <span id="r61 rd" class="r61 r">publicCommandName</span> = <span class="r45 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[2].<span class="i">ToString</span>().<span class="i">Trim</span>();
                <a href="#f94efb3ed6565f36" class="i property">DiscoveredExports</a>.<span class="i">Add</span>(<span class="r61 r">publicCommandName</span>);
                <a href="#5349d05a24002a5b" class="i property">DiscoveredCommandFilters</a>.<span class="i">Add</span>(<span class="r61 r">publicCommandName</span>);
            }
 
            <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a>;
        }
 
        <b>private void</b> <a id="64e5af697ade7f59" href="../../R/64e5af697ade7f59.html" target="n" data-glyph="76,1" class="i method">ProcessCmdletArguments</a>(<b>object</b> <span id="r62 rd" class="r62 r">value</span>, <span class="i">Action</span>&lt;<b>string</b>&gt; <span id="r63 rd" class="r63 r">onEachArgument</span>)
        {
            <b>if</b> (<span class="r62 r">value</span> == <b>null</b>) <b>return</b>;
 
            <b>var</b> <span id="r64 rd" class="r64 r">commandName</span> = <span class="r62 r">value</span> <b>as string</b>;
            <b>if</b> (<span class="r64 r">commandName</span> != <b>null</b>)
            {
                <span class="r63 r">onEachArgument</span>(<span class="r64 r">commandName</span>);
                <b>return</b>;
            }
 
            <b>var</b> <span id="r65 rd" class="r65 r">names</span> = <span class="r62 r">value</span> <b>as object</b>[];
            <b>if</b> (<span class="r65 r">names</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r66 rd" class="r66 r">n</span> <b>in</b> <span class="r65 r">names</span>)
                {
                    <span class="c">// This is slightly more permissive than what would really happen with parameter binding</span>
                    <span class="c">// in that it would allow arrays of arrays in ways that don&#39;t actually work</span>
                    <a href="#64e5af697ade7f59" class="i method">ProcessCmdletArguments</a>(<span class="r66 r">n</span>, <span class="r63 r">onEachArgument</span>);
                }
            }
        }
 
        <span class="c">// This method does parameter binding for a very limited set of scenarios, specifically</span>
        <span class="c">// for New-Alias, Set-Alias, Import-Module, and Export-ModuleMember.  It might not even</span>
        <span class="c">// correctly handle these cmdlets if new parameters are added.</span>
        <span class="c">//</span>
        <span class="c">// It also only populates the bound parameters for a limited set of parameters needed</span>
        <span class="c">// for module analysis.</span>
        <b>private static</b> <span class="i">Hashtable</span> <a id="3ebf423b656ce6a4" href="../../R/3ebf423b656ce6a4.html" target="n" data-glyph="76,1" class="i method">DoPsuedoParameterBinding</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r67 rd" class="r67 r">commandAst</span>, <b>string</b> <span id="r68 rd" class="r68 r">commandName</span>)
        {
            <b>var</b> <span id="r69 rd" class="r69 r">result</span> = <b>new</b> <span class="i">Hashtable</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>var</b> <span id="r70 rd" class="r70 r">parameterBindingInfo</span> = <a href="#c66c6e021cf16169" class="i field">s_parameterBindingInfoTable</a>[<span class="r68 r">commandName</span>].<span class="i">parameterInfo</span>;
 
            <b>int</b> <span id="r71 rd" class="r71 r">positionsBound</span> = 0;
 
            <b>for</b> (<b>int</b> <span id="r72 rd" class="r72 r">i</span> = 1; <span class="r72 r">i</span> &lt; <span class="r67 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span>; <span class="r72 r">i</span>++)
            {
                <b>var</b> <span id="r73 rd" class="r73 r">element</span> = <span class="r67 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r72 r">i</span>];
                <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r74 rd" class="r74 r">specifiedParameter</span> = <span class="r73 r">element</span> <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
                <b>if</b> (<span class="r74 r">specifiedParameter</span> != <b>null</b>)
                {
                    <b>bool</b> <span id="r75 rd" class="r75 r">boundParameter</span> = <b>false</b>;
                    <b>var</b> <span id="r76 rd" class="r76 r">specifiedParamName</span> = <span class="r74 r">specifiedParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
                    <b>foreach</b> (<b>var</b> <span id="r77 rd" class="r77 r">parameterInfo</span> <b>in</b> <span class="r70 r">parameterBindingInfo</span>)
                    {
                        <b>if</b> (<span class="r77 r">parameterInfo</span>.<span class="i">name</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>if</b> (<span class="r77 r">parameterInfo</span>.<span class="i">position</span> != -1)
                            {
                                <span class="r71 r">positionsBound</span> |= 1 &lt;&lt; <span class="r77 r">parameterInfo</span>.<span class="i">position</span>;
                            }
 
                            <a href="../parser/ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r78 rd" class="r78 r">argumentAst</span> = <span class="r74 r">specifiedParameter</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>;
                            <b>if</b> (<span class="r78 r">argumentAst</span> == <b>null</b>)
                            {
                                <span class="r78 r">argumentAst</span> = <span class="r67 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r72 r">i</span>] <b>as</b> <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>;
                                <b>if</b> (<span class="r78 r">argumentAst</span> != <b>null</b>)
                                {
                                    <span class="r72 r">i</span> += 1;
                                }
                            }
 
                            <b>if</b> (<span class="r78 r">argumentAst</span> != <b>null</b>)
                            {
                                <span class="r75 r">boundParameter</span> = <b>true</b>;
                                <span class="r69 r">result</span>[<span class="r77 r">parameterInfo</span>.<span class="i">name</span>] =
                                    <a href="../parser/SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<a href="../parser/SafeValues.cs.html#1a637852005dfb2f" class="i method">GetSafeValue</a>(<span class="r78 r">argumentAst</span>, <b>null</b>, <a href="../parser/SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<a href="../parser/SafeValues.cs.html#525ae8157bd81dda" class="t t">SafeValueContext</a>.<a href="../parser/SafeValues.cs.html#d14a32df3b92df13" class="i field">ModuleAnalysis</a>);
                            }
 
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r75 r">boundParameter</span> || <span class="r74 r">specifiedParameter</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> != <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>if</b> (!<span class="s">&quot;PassThru&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;Force&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;Confirm&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;Global&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;AsCustomObject&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;Verbose&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;Debug&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;DisableNameChecking&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        !<span class="s">&quot;NoClobber&quot;</span>.<span class="i">StartsWith</span>(<span class="r76 r">specifiedParamName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="c">// Named parameter, skip the argument (except for specific switch parameters</span>
                        <span class="r72 r">i</span> += 1;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// Positional argument, find which position we want to bind</span>
                    <b>int</b> <span id="r79 rd" class="r79 r">pos</span> = 0;
                    <b>for</b> (; <span class="r79 r">pos</span> &lt; 10; <span class="r79 r">pos</span>++)
                    {
                        <b>if</b> ((<span class="r71 r">positionsBound</span> &amp; (1 &lt;&lt; <span class="r79 r">pos</span>)) == 0)
                            <b>break</b>;
                    }
 
                    <span class="r71 r">positionsBound</span> |= 1 &lt;&lt; <span class="r79 r">pos</span>;
 
                    <span class="c">// Now see if we care (we probably do, but if the user did something odd, like specify too many, then we don&#39;t really)</span>
                    <b>foreach</b> (<b>var</b> <span id="r80 rd" class="r80 r">parameterInfo</span> <b>in</b> <span class="r70 r">parameterBindingInfo</span>)
                    {
                        <b>if</b> (<span class="r80 r">parameterInfo</span>.<span class="i">position</span> == <span class="r79 r">pos</span>)
                        {
                            <span class="r69 r">result</span>[<span class="r80 r">parameterInfo</span>.<span class="i">name</span>] = <a href="../parser/SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<span class="i">GetSafeValue</span>(
                                <span class="r67 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r72 r">i</span>], <b>null</b>,
                                <a href="../parser/SafeValues.cs.html#802786d75c891d39" class="t t">GetSafeValueVisitor</a>.<a href="../parser/SafeValues.cs.html#525ae8157bd81dda" class="t t">SafeValueContext</a>.<a href="../parser/SafeValues.cs.html#d14a32df3b92df13" class="i field">ModuleAnalysis</a>);
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r69 r">result</span>;
        }
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#a86ab61ed3ab47bb" class="t t">ParameterBindingInfo</a>&gt; <a id="c66c6e021cf16169" href="../../R/c66c6e021cf16169.html" target="n" data-glyph="46,1" class="i field">s_parameterBindingInfoTable</a>;
 
        <b>private sealed class</b> <a id="a86ab61ed3ab47bb" href="../../R/a86ab61ed3ab47bb.html" target="n" data-glyph="4,1" class="t t"><span id="59ee27e1906a0159">ParameterBindingInfo</span></a>
        {
            <b>internal</b> <a href="#d626561952ca31b4" class="t t">ParameterInfo</a>[] <a id="197f09669c8bd3c5" href="../../R/197f09669c8bd3c5.html" target="n" data-glyph="44,2" class="i field">parameterInfo</a>;
        }
 
        <b>private struct</b> <a id="d626561952ca31b4" href="../../R/d626561952ca31b4.html" target="n" data-glyph="112,1" class="t t"><span id="e6c71a389dc5f94e">ParameterInfo</span></a>
        {
            <b>internal string</b> <a id="3da7aa856ab0d0b6" href="../../R/3da7aa856ab0d0b6.html" target="n" data-glyph="44,2" class="i field">name</a>;
            <b>internal int</b> <a id="2e467d6eef66dc52" href="../../R/2e467d6eef66dc52.html" target="n" data-glyph="44,2" class="i field">position</a>;
        }
    }
 
    <span class="c">// Class to keep track of modules we need to import, and commands that should</span>
    <span class="c">// be filtered out of them.</span>
    [<span class="i">Serializable</span>]
    <b>internal class</b> <a id="4338f9d8512eeb59" href="../../R/4338f9d8512eeb59.html" target="n" data-glyph="2,0" class="t t"><span id="e6696d3c017d6111">RequiredModuleInfo</span></a>
    {
        <b>internal string</b> <a id="eccd719226aaf6a1" href="../../R/eccd719226aaf6a1.html" target="n" data-glyph="104,1" class="i property">Name</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="379dff66ea3e53aa" href="../../R/379dff66ea3e53aa.html" target="n" data-glyph="104,1" class="i property">CommandsToPostFilter</a> { <b>get</b>; <b>set</b>; }
    }
}
</pre></td></tr></table></div></body></html>
