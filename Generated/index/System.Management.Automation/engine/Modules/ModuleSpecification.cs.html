<!DOCTYPE html>
<html><head><title>ModuleSpecification.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(350);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/Modules/ModuleSpecification.cs" target="_top">engine\Modules\ModuleSpecification.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<span class="c">//</span>
<span class="c">// Now define the set of commands for manipulating modules.</span>
<span class="c">//</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Module Specification class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents module specification written in a module manifest (i.e. in RequiredModules member/field).</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Module manifest allows 2 forms of module specification:</span>
    <span class="c">///</span><span class="c"> 1. string - module name</span>
    <span class="c">///</span><span class="c"> 2. hashtable - [string]ModuleName (required) + [Version]ModuleVersion/RequiredVersion (required) + [Guid]GUID (optional)</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> so we have a constructor that takes a string and a constructor that takes a hashtable</span>
    <span class="c">///</span><span class="c"> (so that LanguagePrimitives.ConvertTo can cast a string or a hashtable to this type)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="1fd961b021940b6a" href="../../R/1fd961b021940b6a.html" target="n" data-glyph="0,0" class="t t">ModuleSpecification</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="a06529b49cc6cb36" href="../../R/a06529b49cc6cb36.html" target="n" data-glyph="72,1" class="t constructor">ModuleSpecification</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a module specification from the module name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">moduleName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The module name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8bf2c91f2abc8759" href="../../R/8bf2c91f2abc8759.html" target="n" data-glyph="72,1" class="t constructor">ModuleSpecification</a>(<b>string</b> <span id="r0 rd" class="r0 r">moduleName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r0 r">moduleName</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r0 r">moduleName</span>));
            }
 
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#148bbf163788664b" class="i property">Name</a> = <span class="r0 r">moduleName</span>;
            <span class="c">// Alias name of miniumVersion</span>
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a> = <b>null</b>;
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a> = <b>null</b>;
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a> = <b>null</b>;
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#062a45e81a3542d6" class="i property">Guid</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a module specification from a hashtable.</span>
        <span class="c">///</span><span class="c"> Keys can be ModuleName, ModuleVersion, and Guid.</span>
        <span class="c">///</span><span class="c"> ModuleName must be convertible to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><b>string</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> ModuleVersion must be convertible to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b7b161dc81e4fbe9" class="i property">Version</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> Guid must be convertible to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#062a45e81a3542d6" class="i property">Guid</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">moduleSpecification</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The module specification as a hashtable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="e40ff4979fd4b540" href="../../R/e40ff4979fd4b540.html" target="n" data-glyph="72,1" class="t constructor">ModuleSpecification</a>(<span class="i">Hashtable</span> <span id="r1 rd" class="r1 r">moduleSpecification</span>)
        {
            <b>if</b> (<span class="r1 r">moduleSpecification</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r1 r">moduleSpecification</span>));
            }
 
            <b>var</b> <span id="r2 rd" class="r2 r">exception</span> = <a href="#560d6667aec2aa4b" class="i method">ModuleSpecificationInitHelper</a>(<a href="#1fd961b021940b6a" class="k">this</a>, <span class="r1 r">moduleSpecification</span>);
            <b>if</b> (<span class="r2 r">exception</span> != <b>null</b>)
            {
                <b>throw</b> <span class="r2 r">exception</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize moduleSpecification from hashtable. Return exception object, if hashtable cannot be converted.</span>
        <span class="c">///</span><span class="c"> Return null, in the success case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">moduleSpecification</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to initialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">hashtable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Contains info about object to initialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Exception</span> <a id="560d6667aec2aa4b" href="../../R/560d6667aec2aa4b.html" target="n" data-glyph="74,1" class="i method">ModuleSpecificationInitHelper</a>(<a href="#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r3 rd" class="r3 r">moduleSpecification</span>, <span class="i">Hashtable</span> <span id="r4 rd" class="r4 r">hashtable</span>)
        {
            <span class="i">StringBuilder</span> <span id="r5 rd" class="r5 r">badKeys</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>try</b>
            {
                <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r6 rd" class="r6 r">entry</span> <b>in</b> <span class="r4 r">hashtable</span>)
                {
                    <b>string</b> <span id="r7 rd" class="r7 r">field</span> = <span class="r6 r">entry</span>.<span class="i">Key</span>.<span class="i">ToString</span>();
 
                    <b>if</b> (<span class="r7 r">field</span>.<span class="i">Equals</span>(<span class="s">&quot;ModuleName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r3 r">moduleSpecification</span>.<a href="#148bbf163788664b" class="i property">Name</a> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<b>string</b>&gt;(<span class="r6 r">entry</span>.<span class="i">Value</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r7 r">field</span>.<span class="i">Equals</span>(<span class="s">&quot;ModuleVersion&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r3 r">moduleSpecification</span>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<span class="i">Version</span>&gt;(<span class="r6 r">entry</span>.<span class="i">Value</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r7 r">field</span>.<span class="i">Equals</span>(<span class="s">&quot;RequiredVersion&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r3 r">moduleSpecification</span>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<span class="i">Version</span>&gt;(<span class="r6 r">entry</span>.<span class="i">Value</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r7 r">field</span>.<span class="i">Equals</span>(<span class="s">&quot;MaximumVersion&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r3 r">moduleSpecification</span>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<b>string</b>&gt;(<span class="r6 r">entry</span>.<span class="i">Value</span>);
                        <a href="ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="ModuleCmdletBase.cs.html#8d9eea57094a20b4" class="i method">GetMaximumVersion</a>(<span class="r3 r">moduleSpecification</span>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a>);
                    }
                    <b>else</b> <b>if</b> (<span class="r7 r">field</span>.<span class="i">Equals</span>(<span class="s">&quot;GUID&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r3 r">moduleSpecification</span>.<a href="#062a45e81a3542d6" class="i property">Guid</a> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<span class="i">Guid</span>?&gt;(<span class="r6 r">entry</span>.<span class="i">Value</span>);
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<span class="r5 r">badKeys</span>.<span class="i">Length</span> &gt; 0)
                        {
                            <span class="r5 r">badKeys</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                        }
 
                        <span class="r5 r">badKeys</span>.<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                        <span class="r5 r">badKeys</span>.<span class="i">Append</span>(<span class="r6 r">entry</span>.<span class="i">Key</span>.<span class="i">ToString</span>());
                        <span class="r5 r">badKeys</span>.<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                    }
                }
            }
            <span class="c">// catch all exceptions here, we are going to report them via return value.</span>
            <span class="c">// Example of catched exception: one of conversions to Version failed.</span>
            <b>catch</b> (<span class="i">Exception</span> <span id="r8 rd" class="r8 r">e</span>)
            {
                <b>return</b> <span class="r8 r">e</span>;
            }
 
            <b>string</b> <span id="r9 rd" class="r9 r">message</span>;
            <b>if</b> (<span class="r5 r">badKeys</span>.<span class="i">Length</span> != 0)
            {
                <span class="r9 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">InvalidModuleSpecificationMember</span>, <span class="s">&quot;ModuleName, ModuleVersion, RequiredVersion, GUID&quot;</span>, <span class="r5 r">badKeys</span>);
                <b>return</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r9 r">message</span>);
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r3 r">moduleSpecification</span>.<a href="#148bbf163788664b" class="i property">Name</a>))
            {
                <span class="r9 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">RequiredModuleMissingModuleName</span>);
                <b>return</b> <b>new</b> <span class="i">MissingMemberException</span>(<span class="r9 r">message</span>);
            }
 
            <b>if</b> (<span class="r3 r">moduleSpecification</span>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a> == <b>null</b> &amp;&amp; <span class="r3 r">moduleSpecification</span>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a> == <b>null</b> &amp;&amp; <span class="r3 r">moduleSpecification</span>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a> == <b>null</b>)
            {
                <span class="r9 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">RequiredModuleMissingModuleVersion</span>);
                <b>return</b> <b>new</b> <span class="i">MissingMemberException</span>(<span class="r9 r">message</span>);
            }
 
            <b>if</b> (<span class="r3 r">moduleSpecification</span>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a> != <b>null</b> &amp;&amp; <span class="r3 r">moduleSpecification</span>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a> != <b>null</b>)
            {
                <span class="r9 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">SessionStateStrings</span>.<span class="i">GetContent_TailAndHeadCannotCoexist</span>, <span class="s">&quot;ModuleVersion&quot;</span>, <span class="s">&quot;RequiredVersion&quot;</span>);
                <b>return</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r9 r">message</span>);
            }
 
            <b>if</b> (<span class="r3 r">moduleSpecification</span>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a> != <b>null</b> &amp;&amp; <span class="r3 r">moduleSpecification</span>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a> != <b>null</b>)
            {
                <span class="r9 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">SessionStateStrings</span>.<span class="i">GetContent_TailAndHeadCannotCoexist</span>, <span class="s">&quot;MaximumVersion&quot;</span>, <span class="s">&quot;RequiredVersion&quot;</span>);
                <b>return</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r9 r">message</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal</b> <a id="1c04fd1431e4a831" href="../../R/1c04fd1431e4a831.html" target="n" data-glyph="74,1" class="t constructor">ModuleSpecification</a>(<a href="PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r10 rd" class="r10 r">moduleInfo</span>)
        {
            <b>if</b> (<span class="r10 r">moduleInfo</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r10 r">moduleInfo</span>));
            }
 
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#148bbf163788664b" class="i property">Name</a> = <span class="r10 r">moduleInfo</span>.<a href="PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>;
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a> = <span class="r10 r">moduleInfo</span>.<a href="PSModuleInfo.cs.html#bb592ab5243224bb" class="i property">Version</a>;
            <a href="#1fd961b021940b6a" class="k">this</a>.<a href="#062a45e81a3542d6" class="i property">Guid</a> = <span class="r10 r">moduleInfo</span>.<a href="PSModuleInfo.cs.html#474060a313707f03" class="i property">Guid</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements ToString() for a module specification. If the specification</span>
        <span class="c">///</span><span class="c"> just contains a Name, then that is returned as is. Otherwise, the object is</span>
        <span class="c">///</span><span class="c"> formatted as a PowerSHell hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="58661ffe9a4655b1" href="../../R/58661ffe9a4655b1.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>if</b> (<a href="#062a45e81a3542d6" class="i property">Guid</a> == <b>null</b> &amp;&amp; <a href="#b7b161dc81e4fbe9" class="i property">Version</a> == <b>null</b> &amp;&amp; <a href="#ad460cb887264b84" class="i property">RequiredVersion</a> == <b>null</b> &amp;&amp; <a href="#7d051126154e5fa1" class="i property">MaximumVersion</a> == <b>null</b>)
            {
                <b>return</b> <a href="#148bbf163788664b" class="i property">Name</a>;
            }
 
            <b>var</b> <span id="r11 rd" class="r11 r">moduleSpecBuilder</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <span class="r11 r">moduleSpecBuilder</span>.<span class="i">Append</span>(<span class="s">&quot;@{ ModuleName = &#39;&quot;</span>).<span class="i">Append</span>(<a href="#148bbf163788664b" class="i property">Name</a>).<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
 
            <b>if</b> (<a href="#062a45e81a3542d6" class="i property">Guid</a> != <b>null</b>)
            {
                <span class="r11 r">moduleSpecBuilder</span>.<span class="i">Append</span>(<span class="s">&quot;; Guid = &#39;{&quot;</span>).<span class="i">Append</span>(<a href="#062a45e81a3542d6" class="i property">Guid</a>).<span class="i">Append</span>(<span class="s">&quot;}&#39; &quot;</span>);
            }
 
            <b>if</b> (<a href="#ad460cb887264b84" class="i property">RequiredVersion</a> != <b>null</b>)
            {
                <span class="r11 r">moduleSpecBuilder</span>.<span class="i">Append</span>(<span class="s">&quot;; RequiredVersion = &#39;&quot;</span>).<span class="i">Append</span>(<a href="#ad460cb887264b84" class="i property">RequiredVersion</a>).<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
            }
            <b>else</b>
            {
                <b>if</b> (<a href="#b7b161dc81e4fbe9" class="i property">Version</a> != <b>null</b>)
                {
                    <span class="r11 r">moduleSpecBuilder</span>.<span class="i">Append</span>(<span class="s">&quot;; ModuleVersion = &#39;&quot;</span>).<span class="i">Append</span>(<a href="#b7b161dc81e4fbe9" class="i property">Version</a>).<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                }
 
                <b>if</b> (<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a> != <b>null</b>)
                {
                    <span class="r11 r">moduleSpecBuilder</span>.<span class="i">Append</span>(<span class="s">&quot;; MaximumVersion = &#39;&quot;</span>).<span class="i">Append</span>(<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a>).<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                }
            }
 
            <span class="r11 r">moduleSpecBuilder</span>.<span class="i">Append</span>(<span class="s">&quot; }&quot;</span>);
 
            <b>return</b> <span class="r11 r">moduleSpecBuilder</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse the specified string into a ModuleSpecification object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The module specification string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ModuleSpecification object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="c2ee80128d6a2384" href="../../R/c2ee80128d6a2384.html" target="n" data-glyph="72,1" class="i method">TryParse</a>(<b>string</b> <span id="r12 rd" class="r12 r">input</span>, <b>out</b> <a href="#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r13 rd" class="r13 r">result</span>)
        {
            <span class="r13 r">result</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="i">Hashtable</span> <span id="r14 rd" class="r14 r">hashtable</span>;
                <b>if</b> (<a href="../parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="../parser/Parser.cs.html#fff91726305cc0a4" class="i method">TryParseAsConstantHashtable</a>(<span class="r12 r">input</span>, <b>out</b> <span class="r14 r">hashtable</span>))
                {
                    <span class="r13 r">result</span> = <b>new</b> <a href="#e40ff4979fd4b540" class="t constructor">ModuleSpecification</a>(<span class="r14 r">hashtable</span>);
                    <b>return</b> <b>true</b>;
                }
            }
            <b>catch</b>
            {
                <span class="c">// Ignoring the exceptions to return false</span>
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the module specification while normalizing the name</span>
        <span class="c">///</span><span class="c"> so that paths become absolute and use the right directory separators.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current execution context. Used for path normalization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">basePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The base path where a relative path should be interpreted with respect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A fresh module specification object with the name normalized for use internally.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#1fd961b021940b6a" class="t t">ModuleSpecification</a> <a id="d6b1ec71af1547a9" href="../../R/d6b1ec71af1547a9.html" target="n" data-glyph="74,1" class="i method">WithNormalizedName</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r15 rd" class="r15 r">context</span>, <b>string</b> <span id="r16 rd" class="r16 r">basePath</span>)
        {
            <span class="c">// Save allocating a new module spec if we don&#39;t need to change anything</span>
            <b>if</b> (!<a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#b8546e22fc601f09" class="i method">IsModuleNamePath</a>(<a href="#148bbf163788664b" class="i property">Name</a>))
            {
                <b>return</b> <a href="#1fd961b021940b6a" class="k">this</a>;
            }
 
            <b>return</b> <b>new</b> <a href="#a06529b49cc6cb36" class="t constructor">ModuleSpecification</a>()
            {
                <a href="#062a45e81a3542d6" class="i property">Guid</a> = <a href="#062a45e81a3542d6" class="i property">Guid</a>,
                <a href="#7d051126154e5fa1" class="i property">MaximumVersion</a> = <a href="#7d051126154e5fa1" class="i property">MaximumVersion</a>,
                <a href="#b7b161dc81e4fbe9" class="i property">Version</a> = <a href="#b7b161dc81e4fbe9" class="i property">Version</a>,
                <a href="#ad460cb887264b84" class="i property">RequiredVersion</a> = <a href="#ad460cb887264b84" class="i property">RequiredVersion</a>,
                <a href="#148bbf163788664b" class="i property">Name</a> = <a href="ModuleIntrinsics.cs.html#1693bdfaeab6548d" class="t t">ModuleIntrinsics</a>.<a href="ModuleIntrinsics.cs.html#0845d92b463a8787" class="i method">NormalizeModuleName</a>(<a href="#148bbf163788664b" class="i property">Name</a>, <span class="r16 r">basePath</span>, <span class="r15 r">context</span>)
            };
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="148bbf163788664b" href="../../R/148bbf163788664b.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module GUID, if specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span>? <a id="062a45e81a3542d6" href="../../R/062a45e81a3542d6.html" target="n" data-glyph="102,1" class="i property">Guid</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module version number if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Version</span> <a id="b7b161dc81e4fbe9" href="../../R/b7b161dc81e4fbe9.html" target="n" data-glyph="102,1" class="i property">Version</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The module maxVersion number if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="7d051126154e5fa1" href="../../R/7d051126154e5fa1.html" target="n" data-glyph="102,1" class="i property">MaximumVersion</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exact version of the module if specified, otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Version</span> <a id="ad460cb887264b84" href="../../R/ad460cb887264b84.html" target="n" data-glyph="102,1" class="i property">RequiredVersion</a> { <b>get</b>; <b>internal set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Compares two ModuleSpecification objects for equality.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="a1724a5a88622f38" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="576ec7b6ba5d926c">ModuleSpecificationComparer</span></a> : <span class="i">IEqualityComparer</span>&lt;<a href="#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if two module specifications are property-wise equal.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">x</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">y</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the specifications are equal, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="7dd3eda7f5e9a650" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<a href="#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r17 rd" class="r17 r">x</span>, <a href="#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r18 rd" class="r18 r">y</span>)
        {
            <b>if</b> (<span class="r17 r">x</span> == <span class="r18 r">y</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <span class="r17 r">x</span> != <b>null</b> &amp;&amp; <span class="r18 r">y</span> != <b>null</b>
                &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r17 r">x</span>.<a href="#148bbf163788664b" class="i property">Name</a>, <span class="r18 r">y</span>.<a href="#148bbf163788664b" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                &amp;&amp; <span class="i">Guid</span>.<span class="i">Equals</span>(<span class="r17 r">x</span>.<a href="#062a45e81a3542d6" class="i property">Guid</a>, <span class="r18 r">y</span>.<a href="#062a45e81a3542d6" class="i property">Guid</a>)
                &amp;&amp; <span class="i">Version</span>.<span class="i">Equals</span>(<span class="r17 r">x</span>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a>, <span class="r18 r">y</span>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a>)
                &amp;&amp; <span class="i">Version</span>.<span class="i">Equals</span>(<span class="r17 r">x</span>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a>, <span class="r18 r">y</span>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a>)
                &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r17 r">x</span>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a>, <span class="r18 r">y</span>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a property-based hashcode for a ModuleSpecification object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The module specification for the object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A hashcode that is always the same for any module specification with the same properties.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public int</b> <a id="68bb502d06b66174" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>(<a href="#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r19 rd" class="r19 r">obj</span>)
        {
            <b>if</b> (<span class="r19 r">obj</span> == <b>null</b>)
            {
                <b>return</b> 0;
            }
 
            <b>return</b> <span class="i">HashCode</span>.<span class="i">Combine</span>(<span class="r19 r">obj</span>.<a href="#148bbf163788664b" class="i property">Name</a>, <span class="r19 r">obj</span>.<a href="#062a45e81a3542d6" class="i property">Guid</a>, <span class="r19 r">obj</span>.<a href="#ad460cb887264b84" class="i property">RequiredVersion</a>, <span class="r19 r">obj</span>.<a href="#b7b161dc81e4fbe9" class="i property">Version</a>, <span class="r19 r">obj</span>.<a href="#7d051126154e5fa1" class="i property">MaximumVersion</a>);
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
