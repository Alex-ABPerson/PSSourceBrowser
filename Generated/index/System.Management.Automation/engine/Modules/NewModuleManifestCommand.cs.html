<!DOCTYPE html>
<html><head><title>NewModuleManifestCommand.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1234);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/Modules/NewModuleManifestCommand.cs" target="_top">engine\Modules\NewModuleManifestCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<span class="c">//</span>
<span class="c">// Now define the set of commands for manipulating modules.</span>
<span class="c">//</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> New-ModuleManifest
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Cmdlet to create a new module manifest file.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../utils/Verbs.cs.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="../../utils/Verbs.cs.html#275f319554270c33" class="i field">New</a>, <span class="s">&quot;ModuleManifest&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">ConfirmImpact</span> = <a href="../CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="../CommandBase.cs.html#9bb946a0731a8a9e" class="i field">Low</a>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096487&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<b>string</b>))]
    <b>public sealed class</b> <a id="22af511d9f5fc801" href="../../R/22af511d9f5fc801.html" target="n" data-glyph="0,0" class="t t"><span id="a96f4c85db8bd69b">NewModuleManifestCommand</span></a> : <a href="../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the output path for the generated file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        <b>public string</b> <a id="6d875a7abc518745" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> { <b>return</b> <a href="#398a58fbe617aeba" class="i field">_path</a>; }
 
            <b>set</b> { <a href="#398a58fbe617aeba" class="i field">_path</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="398a58fbe617aeba" href="../../R/398a58fbe617aeba.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the list of files to load by default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public object</b>[] <a id="c721d4619aa9df5e" href="../../R/c721d4619aa9df5e.html" target="n" data-glyph="102,1" class="i property">NestedModules</a>
        {
            <b>get</b> { <b>return</b> <a href="#3d4ecc597ad6ff86" class="i field">_nestedModules</a>; }
 
            <b>set</b> { <a href="#3d4ecc597ad6ff86" class="i field">_nestedModules</a> = <b>value</b>; }
        }
 
        <b>private object</b>[] <a id="3d4ecc597ad6ff86" href="../../R/3d4ecc597ad6ff86.html" target="n" data-glyph="46,1" class="i field">_nestedModules</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the GUID in the manifest file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">Guid</span> <a id="75f478a8d296c9b8" href="../../R/75f478a8d296c9b8.html" target="n" data-glyph="102,1" class="i property">Guid</a>
        {
            <b>get</b> { <b>return</b> <a href="#256fad01e291ff58" class="i field">_guid</a>; }
 
            <b>set</b> { <a href="#256fad01e291ff58" class="i field">_guid</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Guid</span> <a id="256fad01e291ff58" href="../../R/256fad01e291ff58.html" target="n" data-glyph="46,1" class="i field">_guid</a> = <a href="#75f478a8d296c9b8" class="i property">Guid</a>.<span class="i">NewGuid</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the author string in the manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyString</span>]
        <b>public string</b> <a id="bed498c157552dea" href="../../R/bed498c157552dea.html" target="n" data-glyph="102,1" class="i property">Author</a>
        {
            <b>get</b> { <b>return</b> <a href="#6eede1c391c48700" class="i field">_author</a>; }
 
            <b>set</b> { <a href="#6eede1c391c48700" class="i field">_author</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="6eede1c391c48700" href="../../R/6eede1c391c48700.html" target="n" data-glyph="46,1" class="i field">_author</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the company name in the manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyString</span>]
        <b>public string</b> <a id="eda182e742612f4c" href="../../R/eda182e742612f4c.html" target="n" data-glyph="102,1" class="i property">CompanyName</a>
        {
            <b>get</b> { <b>return</b> <a href="#3a7027aac8979d58" class="i field">_companyName</a>; }
 
            <b>set</b> { <a href="#3a7027aac8979d58" class="i field">_companyName</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="3a7027aac8979d58" href="../../R/3a7027aac8979d58.html" target="n" data-glyph="46,1" class="i field">_companyName</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the copyright string in the module manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyString</span>]
        <b>public string</b> <a id="32451bbee197b0d1" href="../../R/32451bbee197b0d1.html" target="n" data-glyph="102,1" class="i property">Copyright</a>
        {
            <b>get</b> { <b>return</b> <a href="#0349bb20b9d7394b" class="i field">_copyright</a>; }
 
            <b>set</b> { <a href="#0349bb20b9d7394b" class="i field">_copyright</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="0349bb20b9d7394b" href="../../R/0349bb20b9d7394b.html" target="n" data-glyph="46,1" class="i field">_copyright</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the root module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyString</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;ModuleToProcess&quot;</span>)]
        <b>public string</b> <a id="f5a26a1b5f19ca65" href="../../R/f5a26a1b5f19ca65.html" target="n" data-glyph="102,1" class="i property">RootModule</a>
        {
            <b>get</b> { <b>return</b> <a href="#dd0ceadd5016dfa1" class="i field">_rootModule</a>; }
 
            <b>set</b> { <a href="#dd0ceadd5016dfa1" class="i field">_rootModule</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="dd0ceadd5016dfa1" href="../../R/dd0ceadd5016dfa1.html" target="n" data-glyph="46,1" class="i field">_rootModule</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the module version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNull</span>]
        <b>public</b> <span class="i">Version</span> <a id="a28f3406333e3e39" href="../../R/a28f3406333e3e39.html" target="n" data-glyph="102,1" class="i property">ModuleVersion</a>
        {
            <b>get</b> { <b>return</b> <a href="#deb5e133d2d49e64" class="i field">_moduleVersion</a>; }
 
            <b>set</b> { <a href="#deb5e133d2d49e64" class="i field">_moduleVersion</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="deb5e133d2d49e64" href="../../R/deb5e133d2d49e64.html" target="n" data-glyph="46,1" class="i field">_moduleVersion</a> = <b>new</b> <span class="i">Version</span>(0, 0, 1);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the module description.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyString</span>]
        <b>public string</b> <a id="515397dabb4960e7" href="../../R/515397dabb4960e7.html" target="n" data-glyph="102,1" class="i property">Description</a>
        {
            <b>get</b> { <b>return</b> <a href="#90733687dc6e7213" class="i field">_description</a>; }
 
            <b>set</b> { <a href="#90733687dc6e7213" class="i field">_description</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="90733687dc6e7213" href="../../R/90733687dc6e7213.html" target="n" data-glyph="46,1" class="i field">_description</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the ProcessorArchitecture required by this module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">ProcessorArchitecture</span> <a id="96d38a3d903775a1" href="../../R/96d38a3d903775a1.html" target="n" data-glyph="102,1" class="i property">ProcessorArchitecture</a>
        {
            <b>get</b> { <b>return</b> <a href="#1f14a4a212940642" class="i field">_processorArchitecture</a> ?? <a href="#96d38a3d903775a1" class="i property">ProcessorArchitecture</a>.<span class="i">None</span>; }
 
            <b>set</b> { <a href="#1f14a4a212940642" class="i field">_processorArchitecture</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">ProcessorArchitecture</span>? <a id="1f14a4a212940642" href="../../R/1f14a4a212940642.html" target="n" data-glyph="46,1" class="i field">_processorArchitecture</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the PowerShell version required by this module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">Version</span> <a id="91c0bd68c17c3a95" href="../../R/91c0bd68c17c3a95.html" target="n" data-glyph="102,1" class="i property">PowerShellVersion</a>
        {
            <b>get</b> { <b>return</b> <a href="#11c2a3a0da366508" class="i field">_powerShellVersion</a>; }
 
            <b>set</b> { <a href="#11c2a3a0da366508" class="i field">_powerShellVersion</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="11c2a3a0da366508" href="../../R/11c2a3a0da366508.html" target="n" data-glyph="46,1" class="i field">_powerShellVersion</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the CLR version required by the module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">Version</span> <a id="ead8353bcfba541a" href="../../R/ead8353bcfba541a.html" target="n" data-glyph="102,1" class="i property">ClrVersion</a>
        {
            <b>get</b> { <b>return</b> <a href="#af8f7967d220622a" class="i field">_ClrVersion</a>; }
 
            <b>set</b> { <a href="#af8f7967d220622a" class="i field">_ClrVersion</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="af8f7967d220622a" href="../../R/af8f7967d220622a.html" target="n" data-glyph="46,1" class="i field">_ClrVersion</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the version of .NET Framework required by the module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">Version</span> <a id="20709adc6ea16d10" href="../../R/20709adc6ea16d10.html" target="n" data-glyph="102,1" class="i property">DotNetFrameworkVersion</a>
        {
            <b>get</b> { <b>return</b> <a href="#3b08a735ae54747e" class="i field">_DotNetFrameworkVersion</a>; }
 
            <b>set</b> { <a href="#3b08a735ae54747e" class="i field">_DotNetFrameworkVersion</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="3b08a735ae54747e" href="../../R/3b08a735ae54747e.html" target="n" data-glyph="46,1" class="i field">_DotNetFrameworkVersion</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the name of PowerShell host required by the module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public string</b> <a id="f9a3b281567ae395" href="../../R/f9a3b281567ae395.html" target="n" data-glyph="102,1" class="i property">PowerShellHostName</a>
        {
            <b>get</b> { <b>return</b> <a href="#50364096eaa64de6" class="i field">_PowerShellHostName</a>; }
 
            <b>set</b> { <a href="#50364096eaa64de6" class="i field">_PowerShellHostName</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="50364096eaa64de6" href="../../R/50364096eaa64de6.html" target="n" data-glyph="46,1" class="i field">_PowerShellHostName</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the version of PowerShell host required by the module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">Version</span> <a id="e7b8c02a325c3c5a" href="../../R/e7b8c02a325c3c5a.html" target="n" data-glyph="102,1" class="i property">PowerShellHostVersion</a>
        {
            <b>get</b> { <b>return</b> <a href="#1cee091bce726562" class="i field">_PowerShellHostVersion</a>; }
 
            <b>set</b> { <a href="#1cee091bce726562" class="i field">_PowerShellHostVersion</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="1cee091bce726562" href="../../R/1cee091bce726562.html" target="n" data-glyph="46,1" class="i field">_PowerShellHostVersion</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the list of Dependencies for the module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ArgumentTypeConverter</span>(<b>typeof</b>(<a href="ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[]))]
        <b>public object</b>[] <a id="fb1ca2cec1096d10" href="../../R/fb1ca2cec1096d10.html" target="n" data-glyph="102,1" class="i property">RequiredModules</a>
        {
            <b>get</b> { <b>return</b> <a href="#de541e8ed948cd71" class="i field">_requiredModules</a>; }
 
            <b>set</b> { <a href="#de541e8ed948cd71" class="i field">_requiredModules</a> = <b>value</b>; }
        }
 
        <b>private object</b>[] <a id="de541e8ed948cd71" href="../../R/de541e8ed948cd71.html" target="n" data-glyph="46,1" class="i field">_requiredModules</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the list of types files for the module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="a08812f6d8296974" href="../../R/a08812f6d8296974.html" target="n" data-glyph="102,1" class="i property">TypesToProcess</a>
        {
            <b>get</b> { <b>return</b> <a href="#998e98bdaa6b1be2" class="i field">_types</a>; }
 
            <b>set</b> { <a href="#998e98bdaa6b1be2" class="i field">_types</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="998e98bdaa6b1be2" href="../../R/998e98bdaa6b1be2.html" target="n" data-glyph="46,1" class="i field">_types</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the list of formats files for the module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="3aceae85c4ea7bc0" href="../../R/3aceae85c4ea7bc0.html" target="n" data-glyph="102,1" class="i property">FormatsToProcess</a>
        {
            <b>get</b> { <b>return</b> <a href="#3d4dea88ea275149" class="i field">_formats</a>; }
 
            <b>set</b> { <a href="#3d4dea88ea275149" class="i field">_formats</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="3d4dea88ea275149" href="../../R/3d4dea88ea275149.html" target="n" data-glyph="46,1" class="i field">_formats</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the list of ps1 scripts to run in the session state of the import-module invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="3b2fb305ac3e0836" href="../../R/3b2fb305ac3e0836.html" target="n" data-glyph="102,1" class="i property">ScriptsToProcess</a>
        {
            <b>get</b> { <b>return</b> <a href="#9f21acacbaf4bbb6" class="i field">_scripts</a>; }
 
            <b>set</b> { <a href="#9f21acacbaf4bbb6" class="i field">_scripts</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="9f21acacbaf4bbb6" href="../../R/9f21acacbaf4bbb6.html" target="n" data-glyph="46,1" class="i field">_scripts</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the list of assemblies to load for this module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="c517e24974cac5a0" href="../../R/c517e24974cac5a0.html" target="n" data-glyph="102,1" class="i property">RequiredAssemblies</a>
        {
            <b>get</b> { <b>return</b> <a href="#af726ae921dc44e2" class="i field">_requiredAssemblies</a>; }
 
            <b>set</b> { <a href="#af726ae921dc44e2" class="i field">_requiredAssemblies</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="af726ae921dc44e2" href="../../R/af726ae921dc44e2.html" target="n" data-glyph="46,1" class="i field">_requiredAssemblies</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the additional files used by this module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="9b12a61509420ef6" href="../../R/9b12a61509420ef6.html" target="n" data-glyph="102,1" class="i property">FileList</a>
        {
            <b>get</b> { <b>return</b> <a href="#cab8ceddba35ba11" class="i field">_miscFiles</a>; }
 
            <b>set</b> { <a href="#cab8ceddba35ba11" class="i field">_miscFiles</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="cab8ceddba35ba11" href="../../R/cab8ceddba35ba11.html" target="n" data-glyph="46,1" class="i field">_miscFiles</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the list of other modules included with this module.</span>
        <span class="c">///</span><span class="c"> Like the RequiredModules key, this list can be a simple list of module names or a complex list of module hashtables.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        [<span class="i">ArgumentTypeConverter</span>(<b>typeof</b>(<a href="ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[]))]
        <b>public object</b>[] <a id="f24decd67bf062c4" href="../../R/f24decd67bf062c4.html" target="n" data-glyph="102,1" class="i property">ModuleList</a>
        {
            <b>get</b> { <b>return</b> <a href="#d3f7e648dae45348" class="i field">_moduleList</a>; }
 
            <b>set</b> { <a href="#d3f7e648dae45348" class="i field">_moduleList</a> = <b>value</b>; }
        }
 
        <b>private object</b>[] <a id="d3f7e648dae45348" href="../../R/d3f7e648dae45348.html" target="n" data-glyph="46,1" class="i field">_moduleList</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the functions to export from this manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="9d322e66c51fde8f" href="../../R/9d322e66c51fde8f.html" target="n" data-glyph="102,1" class="i property">FunctionsToExport</a>
        {
            <b>get</b> { <b>return</b> <a href="#789bd563e69e3933" class="i field">_exportedFunctions</a>; }
 
            <b>set</b> { <a href="#789bd563e69e3933" class="i field">_exportedFunctions</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="789bd563e69e3933" href="../../R/789bd563e69e3933.html" target="n" data-glyph="46,1" class="i field">_exportedFunctions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the aliases to export from this manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="abda2e5951e75527" href="../../R/abda2e5951e75527.html" target="n" data-glyph="102,1" class="i property">AliasesToExport</a>
        {
            <b>get</b> { <b>return</b> <a href="#795eaf1ece8e05b2" class="i field">_exportedAliases</a>; }
 
            <b>set</b> { <a href="#795eaf1ece8e05b2" class="i field">_exportedAliases</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="795eaf1ece8e05b2" href="../../R/795eaf1ece8e05b2.html" target="n" data-glyph="46,1" class="i field">_exportedAliases</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the variables to export from this manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="163e6168c7d3cb2d" href="../../R/163e6168c7d3cb2d.html" target="n" data-glyph="102,1" class="i property">VariablesToExport</a>
        {
            <b>get</b> { <b>return</b> <a href="#9a88b996abbccc2c" class="i field">_exportedVariables</a>; }
 
            <b>set</b> { <a href="#9a88b996abbccc2c" class="i field">_exportedVariables</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="9a88b996abbccc2c" href="../../R/9a88b996abbccc2c.html" target="n" data-glyph="46,1" class="i field">_exportedVariables</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the cmdlets to export from this manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="e898366be559921f" href="../../R/e898366be559921f.html" target="n" data-glyph="102,1" class="i property">CmdletsToExport</a>
        {
            <b>get</b> { <b>return</b> <a href="#331c9afcb5bbf63c" class="i field">_exportedCmdlets</a>; }
 
            <b>set</b> { <a href="#331c9afcb5bbf63c" class="i field">_exportedCmdlets</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="331c9afcb5bbf63c" href="../../R/331c9afcb5bbf63c.html" target="n" data-glyph="46,1" class="i field">_exportedCmdlets</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the dsc resources to export from this manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="b154b466b9f3f231" href="../../R/b154b466b9f3f231.html" target="n" data-glyph="102,1" class="i property">DscResourcesToExport</a>
        {
            <b>get</b> { <b>return</b> <a href="#186cea6883b37d62" class="i field">_dscResourcesToExport</a>; }
 
            <b>set</b> { <a href="#186cea6883b37d62" class="i field">_dscResourcesToExport</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="186cea6883b37d62" href="../../R/186cea6883b37d62.html" target="n" data-glyph="46,1" class="i field">_dscResourcesToExport</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the compatible PSEditions of this module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowEmptyCollection</span>]
        [<span class="i">ValidateSet</span>(<span class="s">&quot;Desktop&quot;</span>, <span class="s">&quot;Core&quot;</span>)]
        <b>public string</b>[] <a id="118a8260e51530f3" href="../../R/118a8260e51530f3.html" target="n" data-glyph="102,1" class="i property">CompatiblePSEditions</a>
        {
            <b>get</b> { <b>return</b> <a href="#a8f39a9a3c5a9659" class="i field">_compatiblePSEditions</a>; }
 
            <b>set</b> { <a href="#a8f39a9a3c5a9659" class="i field">_compatiblePSEditions</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="a8f39a9a3c5a9659" href="../../R/a8f39a9a3c5a9659.html" target="n" data-glyph="46,1" class="i field">_compatiblePSEditions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the module-specific private data here.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">AllowNull</span>]
        <b>public object</b> <a id="114069de80f8b6c0" href="../../R/114069de80f8b6c0.html" target="n" data-glyph="102,1" class="i property">PrivateData</a>
        {
            <b>get</b> { <b>return</b> <a href="#6cdac8c74aa6365f" class="i field">_privateData</a>; }
 
            <b>set</b> { <a href="#6cdac8c74aa6365f" class="i field">_privateData</a> = <b>value</b>; }
        }
 
        <b>private object</b> <a id="6cdac8c74aa6365f" href="../../R/6cdac8c74aa6365f.html" target="n" data-glyph="46,1" class="i field">_privateData</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Tags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="89d68dd520dffb5b" href="../../R/89d68dd520dffb5b.html" target="n" data-glyph="102,1" class="i property">Tags</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the ProjectUri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="09a967bc01f3ae3b" href="../../R/09a967bc01f3ae3b.html" target="n" data-glyph="102,1" class="i property">ProjectUri</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the LicenseUri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="eec7a4f66b882382" href="../../R/eec7a4f66b882382.html" target="n" data-glyph="102,1" class="i property">LicenseUri</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the IconUri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="7a9e39d1bc5b6d6d" href="../../R/7a9e39d1bc5b6d6d.html" target="n" data-glyph="102,1" class="i property">IconUri</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the ReleaseNotes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="62b864d8641518aa" href="../../R/62b864d8641518aa.html" target="n" data-glyph="102,1" class="i property">ReleaseNotes</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether or not the module is a prerelease.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="5494ccfd44a3cc11" href="../../R/5494ccfd44a3cc11.html" target="n" data-glyph="102,1" class="i property">Prerelease</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether or not the module requires explicit user acceptance for install/update/save.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="a31eda63a0012b69" href="../../R/a31eda63a0012b69.html" target="n" data-glyph="102,1" class="i property">RequireLicenseAcceptance</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the external module dependencies.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="aa829a0b6e4a29dd" href="../../R/aa829a0b6e4a29dd.html" target="n" data-glyph="102,1" class="i property">ExternalModuleDependencies</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the HelpInfo URI.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowNull</span>]
        <b>public string</b> <a id="5db28d32cdf5a7a3" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">HelpInfoUri</a>
        {
            <b>get</b> { <b>return</b> <a href="#eadc3614048ea6a1" class="i field">_helpInfoUri</a>; }
 
            <b>set</b> { <a href="#eadc3614048ea6a1" class="i field">_helpInfoUri</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="eadc3614048ea6a1" href="../../R/eadc3614048ea6a1.html" target="n" data-glyph="46,1" class="i field">_helpInfoUri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether the module manifest string should go to the output stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="5845f12f4f8288fe" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> { <b>return</b> (<a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>)<a href="#1ba635793d3f32a9" class="i field">_passThru</a>; }
 
            <b>set</b> { <a href="#1ba635793d3f32a9" class="i field">_passThru</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="1ba635793d3f32a9" href="../../R/1ba635793d3f32a9.html" target="n" data-glyph="46,1" class="i field">_passThru</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Default Command Prefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">AllowNull</span>]
        <b>public string</b> <a id="1bc1d915fb109a16" href="../../R/1bc1d915fb109a16.html" target="n" data-glyph="102,1" class="i property">DefaultCommandPrefix</a>
        {
            <b>get</b> { <b>return</b> <a href="#7c70da0f59daf16e" class="i field">_defaultCommandPrefix</a>; }
 
            <b>set</b> { <a href="#7c70da0f59daf16e" class="i field">_defaultCommandPrefix</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="7c70da0f59daf16e" href="../../R/7c70da0f59daf16e.html" target="n" data-glyph="46,1" class="i field">_defaultCommandPrefix</a>;
 
        <b>private string</b> <a id="71ce0f0296e3f595" href="../../R/71ce0f0296e3f595.html" target="n" data-glyph="46,1" class="i field">_indent</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a single-quoted string. Any embedded single quotes will be doubled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The string to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The quoted string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="f84bf0ca06b70820" href="../../R/f84bf0ca06b70820.html" target="n" data-glyph="76,1" class="i method">QuoteName</a>(<b>string</b> <span id="r0 rd" class="r0 r">name</span>)
        {
            <b>if</b> (<span class="r0 r">name</span> == <b>null</b>)
                <b>return</b> <span class="s">&quot;&#39;&#39;&quot;</span>;
            <b>return</b> (<span class="s">&quot;&#39;&quot;</span> + <span class="r0 r">name</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>) + <span class="s">&quot;&#39;&quot;</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a single-quoted string using the AbsoluteUri member to ensure it is escaped correctly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Uri to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The quoted AbsoluteUri.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="d764e948c32359a1" href="../../R/d764e948c32359a1.html" target="n" data-glyph="76,1" class="i method">QuoteName</a>(<span class="i">Uri</span> <span id="r1 rd" class="r1 r">name</span>)
        {
            <b>if</b> (<span class="r1 r">name</span> == <b>null</b>)
                <b>return</b> <span class="s">&quot;&#39;&#39;&quot;</span>;
            <b>return</b> <span class="i">QuoteName</span>(<span class="r1 r">name</span>.<span class="i">AbsoluteUri</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a single-quoted string from a Version object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Version object to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The quoted Version string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="4bcb123577686ecc" href="../../R/4bcb123577686ecc.html" target="n" data-glyph="76,1" class="i method">QuoteName</a>(<span class="i">Version</span> <span id="r2 rd" class="r2 r">name</span>)
        {
            <b>if</b> (<span class="r2 r">name</span> == <b>null</b>)
                <b>return</b> <span class="s">&quot;&#39;&#39;&quot;</span>;
            <b>return</b> <span class="i">QuoteName</span>(<span class="r2 r">name</span>.<span class="i">ToString</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Takes a collection of strings and returns the collection</span>
        <span class="c">///</span><span class="c"> quoted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">names</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">streamWriter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streamwriter to get end of line character from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The quoted list.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="0b7c7169421f05db" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">QuoteNames</a>(<span class="i">IEnumerable</span> <span id="r3 rd" class="r3 r">names</span>, <span class="i">StreamWriter</span> <span id="r4 rd" class="r4 r">streamWriter</span>)
        {
            <b>if</b> (<span class="r3 r">names</span> == <b>null</b>)
                <b>return</b> <span class="s">&quot;@()&quot;</span>;
 
            <span class="i">StringBuilder</span> <span id="r5 rd" class="r5 r">result</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>int</b> <span id="r6 rd" class="r6 r">offset</span> = 15;
            <b>bool</b> <span id="r7 rd" class="r7 r">first</span> = <b>true</b>;
            <b>foreach</b> (<b>string</b> <span id="r8 rd" class="r8 r">name</span> <b>in</b> <span class="r3 r">names</span>)
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r8 r">name</span>))
                {
                    <b>if</b> (<span class="r7 r">first</span>)
                    {
                        <span class="r7 r">first</span> = <b>false</b>;
                    }
                    <b>else</b>
                    {
                        <span class="r5 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                    }
 
                    <b>string</b> <span id="r9 rd" class="r9 r">quotedString</span> = <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<span class="r8 r">name</span>);
                    <span class="r6 r">offset</span> += <span class="r9 r">quotedString</span>.<span class="i">Length</span>;
                    <b>if</b> (<span class="r6 r">offset</span> &gt; 80)
                    {
                        <span class="r5 r">result</span>.<span class="i">Append</span>(<span class="r4 r">streamWriter</span>.<span class="i">NewLine</span>);
                        <span class="r5 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;               &quot;</span>);
                        <span class="r6 r">offset</span> = 15 + <span class="r9 r">quotedString</span>.<span class="i">Length</span>;
                    }
 
                    <span class="r5 r">result</span>.<span class="i">Append</span>(<span class="r9 r">quotedString</span>);
                }
            }
 
            <b>if</b> (<span class="r5 r">result</span>.<span class="i">Length</span> == 0)
                <b>return</b> <span class="s">&quot;@()&quot;</span>;
 
            <b>return</b> <span class="r5 r">result</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This function is created to PreProcess -NestedModules in Win8.</span>
        <span class="c">///</span><span class="c"> In Win7, -NestedModules is of type string[]. In Win8, we changed</span>
        <span class="c">///</span><span class="c"> this to object[] to support module specification using hashtable.</span>
        <span class="c">///</span><span class="c"> To be backward compatible, this function calls ToString() on any</span>
        <span class="c">///</span><span class="c"> object that is not of type hashtable or string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">moduleSpecs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">IEnumerable</span> <a id="895f6335781ec08e" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">PreProcessModuleSpec</a>(<span class="i">IEnumerable</span> <span id="r10 rd" class="r10 r">moduleSpecs</span>)
        {
            <b>if</b> (<span class="r10 r">moduleSpecs</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>object</b> <span id="r11 rd" class="r11 r">spec</span> <b>in</b> <span class="r10 r">moduleSpecs</span>)
                {
                    <b>if</b> (<span class="r11 r">spec</span> <b>is not</b> <span class="i">Hashtable</span>)
                    {
                        <b>yield</b> <b>return</b> <span class="r11 r">spec</span>.<span class="i">ToString</span>();
                    }
                    <b>else</b>
                    {
                        <b>yield</b> <b>return</b> <span class="r11 r">spec</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Takes a collection of &quot;module specifications&quot; (string or hashtable)</span>
        <span class="c">///</span><span class="c"> and returns the collection as a string that can be inserted into a module manifest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">moduleSpecs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">streamWriter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streamwriter to get end of line character from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The quoted list.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="c5a2344f37801517" href="../../R/c5a2344f37801517.html" target="n" data-glyph="76,1" class="i method">QuoteModules</a>(<span class="i">IEnumerable</span> <span id="r12 rd" class="r12 r">moduleSpecs</span>, <span class="i">StreamWriter</span> <span id="r13 rd" class="r13 r">streamWriter</span>)
        {
            <span class="i">StringBuilder</span> <span id="r14 rd" class="r14 r">result</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;@(&quot;</span>);
 
            <b>if</b> (<span class="r12 r">moduleSpecs</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r15 rd" class="r15 r">firstModule</span> = <b>true</b>;
                <b>foreach</b> (<b>object</b> <span id="r16 rd" class="r16 r">spec</span> <b>in</b> <span class="r12 r">moduleSpecs</span>)
                {
                    <b>if</b> (<span class="r16 r">spec</span> == <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <a href="ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r17 rd" class="r17 r">moduleSpecification</span> = (<a href="ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>)<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(
                            <span class="r16 r">spec</span>,
                            <b>typeof</b>(<a href="ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>),
                            <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
 
                    <b>if</b> (!<span class="r15 r">firstModule</span>)
                    {
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="r13 r">streamWriter</span>.<span class="i">NewLine</span>);
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;               &quot;</span>);
                    }
 
                    <span class="r15 r">firstModule</span> = <b>false</b>;
 
                    <b>if</b> ((<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#062a45e81a3542d6" class="i property">Guid</a> == <b>null</b>) &amp;&amp; (<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#b7b161dc81e4fbe9" class="i property">Version</a> == <b>null</b>) &amp;&amp; (<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a> == <b>null</b>) &amp;&amp; (<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#ad460cb887264b84" class="i property">RequiredVersion</a> == <b>null</b>))
                    {
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>));
                    }
                    <b>else</b>
                    {
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;@{&quot;</span>);
 
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;ModuleName = &quot;</span>);
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>));
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;; &quot;</span>);
 
                        <b>if</b> (<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#062a45e81a3542d6" class="i property">Guid</a> != <b>null</b>)
                        {
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;GUID = &quot;</span>);
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="i">QuoteName</span>(<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#062a45e81a3542d6" class="i property">Guid</a>.<span class="i">ToString</span>()));
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;; &quot;</span>);
                        }
 
                        <b>if</b> (<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#b7b161dc81e4fbe9" class="i property">Version</a> != <b>null</b>)
                        {
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;ModuleVersion = &quot;</span>);
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="i">QuoteName</span>(<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#b7b161dc81e4fbe9" class="i property">Version</a>.<span class="i">ToString</span>()));
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;; &quot;</span>);
                        }
 
                        <b>if</b> (<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a> != <b>null</b>)
                        {
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;MaximumVersion = &quot;</span>);
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a>));
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;; &quot;</span>);
                        }
 
                        <b>if</b> (<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#ad460cb887264b84" class="i property">RequiredVersion</a> != <b>null</b>)
                        {
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;RequiredVersion = &quot;</span>);
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="i">QuoteName</span>(<span class="r17 r">moduleSpecification</span>.<a href="ModuleSpecification.cs.html#ad460cb887264b84" class="i property">RequiredVersion</a>.<span class="i">ToString</span>()));
                            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;; &quot;</span>);
                        }
 
                        <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
                    }
                }
            }
 
            <span class="r14 r">result</span>.<span class="i">Append</span>(<span class="s">&#39;)&#39;</span>);
            <b>return</b> <span class="r14 r">result</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Takes a collection of file names and returns the collection</span>
        <span class="c">///</span><span class="c"> quoted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">names</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">streamWriter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streamwriter to get end of line character from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The quoted list.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="5cb22f1a90b0c75a" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">QuoteFiles</a>(<span class="i">IEnumerable</span> <span id="r18 rd" class="r18 r">names</span>, <span class="i">StreamWriter</span> <span id="r19 rd" class="r19 r">streamWriter</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r20 rd" class="r20 r">resolvedPaths</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <b>if</b> (<span class="r18 r">names</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r21 rd" class="r21 r">name</span> <b>in</b> <span class="r18 r">names</span>)
                {
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r21 r">name</span>))
                    {
                        <b>foreach</b> (<b>string</b> <span id="r22 rd" class="r22 r">path</span> <b>in</b> <a href="#53a785bfb4c8a488" class="i method">TryResolveFilePath</a>(<span class="r21 r">name</span>))
                        {
                            <span class="r20 r">resolvedPaths</span>.<span class="i">Add</span>(<span class="r22 r">path</span>);
                        }
                    }
                }
            }
 
            <b>return</b> <span class="i">QuoteNames</span>(<span class="r20 r">resolvedPaths</span>, <span class="r19 r">streamWriter</span>);
        }
 
        <span class="c">///// &lt;summary&gt;</span>
        <span class="c">///// Takes a collection of file names and returns the collection</span>
        <span class="c">///// quoted.  It does not expand wildcard to actual files (as QuoteFiles does).</span>
        <span class="c">///// It throws an error when the entered filename is different than the allowedExtension.</span>
        <span class="c">///// If any file name falls outside the directory tree basPath a warning is issued.</span>
        <span class="c">///// &lt;/summary&gt;</span>
        <span class="c">///// &lt;param name=&quot;basePath&quot;&gt;This is the path which will be used to determine whether a warning is to be displayed.&lt;/param&gt;</span>
        <span class="c">///// &lt;param name=&quot;names&quot;&gt;The list to quote&lt;/param&gt;</span>
        <span class="c">///// &lt;param name=&quot;allowedExtension&quot;&gt;This is the allowed file extension, any other extension will give an error.&lt;/param&gt;</span>
        <span class="c">///// &lt;param name=&quot;streamWriter&quot;&gt;Streamwriter to get end of line character from&lt;/param&gt;</span>
        <span class="c">///// &lt;param name=&quot;item&quot;&gt;The item of the manifest file for which names are being resolved.&lt;/param&gt;</span>
        <span class="c">///// &lt;returns&gt;The quoted list.&lt;/returns&gt;</span>
        <span class="c">// private string QuoteFilesWithWildcard(string basePath, IEnumerable names, string allowedExtension, StreamWriter streamWriter, string item)</span>
        <span class="c">// {</span>
        <span class="c">//    if (names != null)</span>
        <span class="c">//    {</span>
        <span class="c">//        foreach (string name in names)</span>
        <span class="c">//        {</span>
        <span class="c">//            if (string.IsNullOrEmpty(name))</span>
        <span class="c">//                continue;</span>
 
        <span class="c">//            string fileName = name;</span>
 
        <span class="c">//            string extension = System.IO.Path.GetExtension(fileName);</span>
        <span class="c">//            if (string.Equals(extension, allowedExtension, StringComparison.OrdinalIgnoreCase))</span>
        <span class="c">//            {</span>
        <span class="c">//                string drive = string.Empty;</span>
        <span class="c">//                if (!SessionState.Path.IsPSAbsolute(fileName, out drive) &amp;&amp; !System.IO.Path.IsPathRooted(fileName))</span>
        <span class="c">//                {</span>
        <span class="c">//                    fileName = SessionState.Path.Combine(SessionState.Path.CurrentLocation.ProviderPath, fileName);</span>
        <span class="c">//                }</span>
 
        <span class="c">//                string basePathDir = System.IO.Path.GetDirectoryName(SessionState.Path.GetUnresolvedProviderPathFromPSPath(basePath));</span>
        <span class="c">//                if (basePathDir[basePathDir.Length - 1] != StringLiterals.DefaultPathSeparator)</span>
        <span class="c">//                {</span>
        <span class="c">//                    basePathDir += StringLiterals.DefaultPathSeparator;</span>
        <span class="c">//                }</span>
        <span class="c">//                string fileDir = null;</span>
 
        <span class="c">//                // Call to SessionState.Path.GetUnresolvedProviderPathFromPSPath throws an exception</span>
        <span class="c">//                // when the drive in the path does not exist.</span>
        <span class="c">//                // Based on the exception it is obvious that the path is outside the basePath, because</span>
        <span class="c">//                // basePath must always exist.</span>
        <span class="c">//                try</span>
        <span class="c">//                {</span>
        <span class="c">//                    fileDir = System.IO.Path.GetDirectoryName(SessionState.Path.GetUnresolvedProviderPathFromPSPath(fileName));</span>
        <span class="c">//                    if (fileDir[fileDir.Length - 1] != StringLiterals.DefaultPathSeparator)</span>
        <span class="c">//                    {</span>
        <span class="c">//                        fileDir += StringLiterals.DefaultPathSeparator;</span>
        <span class="c">//                    }</span>
        <span class="c">//                }</span>
        <span class="c">//                catch</span>
        <span class="c">//                {</span>
        <span class="c">//                }</span>
 
        <span class="c">//                if (fileDir == null</span>
        <span class="c">//                    || !fileDir.StartsWith(basePathDir, StringComparison.OrdinalIgnoreCase))</span>
        <span class="c">//                {</span>
        <span class="c">//                    WriteWarning(StringUtil.Format(Modules.IncludedItemPathFallsOutsideSaveTree, name,</span>
        <span class="c">//                        fileDir ?? name, item));</span>
        <span class="c">//                }</span>
        <span class="c">//            }</span>
        <span class="c">//            else</span>
        <span class="c">//            {</span>
        <span class="c">//                string message = StringUtil.Format(Modules.InvalidWorkflowExtension);</span>
        <span class="c">//                InvalidOperationException invalidOp = new InvalidOperationException(message);</span>
        <span class="c">//                ErrorRecord er = new ErrorRecord(invalidOp, &quot;Modules_InvalidWorkflowExtension&quot;,</span>
        <span class="c">//                    ErrorCategory.InvalidOperation, null);</span>
        <span class="c">//                ThrowTerminatingError(er);</span>
        <span class="c">//            }</span>
        <span class="c">//        }</span>
        <span class="c">//    }</span>
 
        <span class="c">//    return QuoteNames(names, streamWriter);</span>
        <span class="c">// }</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Glob a set of files then resolve them to relative paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">filePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="53a785bfb4c8a488" href="../../R/53a785bfb4c8a488.html" target="n" data-glyph="76,1" class="i method">TryResolveFilePath</a>(<b>string</b> <span id="r23 rd" class="r23 r">filePath</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r24 rd" class="r24 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <a href="../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r25 rd" class="r25 r">provider</span> = <b>null</b>;
            <a href="../SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a> <span id="r26 rd" class="r26 r">sessionState</span> = <a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>;
            <b>try</b>
            {
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r27 rd" class="r27 r">filePaths</span> =
                    <span class="r26 r">sessionState</span>.<a href="../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../PathInterfaces.cs.html#4931b2e78f6aaef1" class="i method">GetResolvedProviderPathFromPSPath</a>(<span class="r23 r">filePath</span>, <b>out</b> <span class="r25 r">provider</span>);
 
                <span class="c">// If the name doesn&#39;t resolve to something we can use, just return the unresolved name...</span>
                <b>if</b> (!<span class="r25 r">provider</span>.<a href="../DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<a href="#22af511d9f5fc801" class="k">this</a>.<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="../ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>) || <span class="r27 r">filePaths</span> == <b>null</b> || <span class="r27 r">filePaths</span>.<span class="i">Count</span> &lt; 1)
                {
                    <span class="r24 r">result</span>.<span class="i">Add</span>(<span class="r23 r">filePath</span>);
                    <b>return</b> <span class="r24 r">result</span>;
                }
 
                <span class="c">// Otherwise get the relative resolved path and trim the .\ or ./ because</span>
                <span class="c">// modules are always loaded relative to the manifest base directory.</span>
                <b>foreach</b> (<b>string</b> <span id="r28 rd" class="r28 r">path</span> <b>in</b> <span class="r27 r">filePaths</span>)
                {
                    <b>string</b> <span id="r29 rd" class="r29 r">adjustedPath</span> = <a href="../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../PathInterfaces.cs.html#0cbc3939c023b24e" class="i method">NormalizeRelativePath</a>(<span class="r28 r">path</span>,
                        <a href="../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../PathInterfaces.cs.html#91ffa5f8fc6b1308" class="i property">CurrentLocation</a>.<a href="../../namespaces/PathInfo.cs.html#16e3fcd7f95c1bfc" class="i property">ProviderPath</a>);
                    <b>if</b> (<span class="r29 r">adjustedPath</span>.<span class="i">StartsWith</span>(<span class="s">&quot;.\\&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                        <span class="r29 r">adjustedPath</span>.<span class="i">StartsWith</span>(<span class="s">&quot;./&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r29 r">adjustedPath</span> = <span class="r29 r">adjustedPath</span>.<span class="i">Substring</span>(2);
                    }
 
                    <span class="r24 r">result</span>.<span class="i">Add</span>(<span class="r29 r">adjustedPath</span>);
                }
            }
            <b>catch</b> (<a href="../../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a>)
            {
                <span class="r24 r">result</span>.<span class="i">Add</span>(<span class="r23 r">filePath</span>);
            }
 
            <b>return</b> <span class="r24 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This routine builds a fragment of the module manifest file</span>
        <span class="c">///</span><span class="c"> for a particular key. It returns a formatted string that includes</span>
        <span class="c">///</span><span class="c"> a comment describing the key as well as the key and its value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The manifest key to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ResourceString that holds the message.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The formatted manifest fragment.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">streamWriter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streamwriter to get end of line character from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="33a642c11fc55902" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ManifestFragment</a>(<b>string</b> <span id="r30 rd" class="r30 r">key</span>, <b>string</b> <span id="r31 rd" class="r31 r">resourceString</span>, <b>string</b> <span id="r32 rd" class="r32 r">value</span>, <span class="i">StreamWriter</span> <span id="r33 rd" class="r33 r">streamWriter</span>)
        {
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}# {1}{2}{0}{3:19} = {4}{2}{2}&quot;</span>,
                <a href="#71ce0f0296e3f595" class="i field">_indent</a>, <span class="r31 r">resourceString</span>, <span class="r33 r">streamWriter</span>.<span class="i">NewLine</span>, <span class="r30 r">key</span>, <span class="r32 r">value</span>);
        }
 
        <b>private string</b> <a id="50f8e76cafd019ad" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ManifestFragmentForNonSpecifiedManifestMember</a>(<b>string</b> <span id="r34 rd" class="r34 r">key</span>, <b>string</b> <span id="r35 rd" class="r35 r">resourceString</span>, <b>string</b> <span id="r36 rd" class="r36 r">value</span>, <span class="i">StreamWriter</span> <span id="r37 rd" class="r37 r">streamWriter</span>)
        {
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}# {1}{2}{0}# {3:19} = {4}{2}{2}&quot;</span>,
                <a href="#71ce0f0296e3f595" class="i field">_indent</a>, <span class="r35 r">resourceString</span>, <span class="r37 r">streamWriter</span>.<span class="i">NewLine</span>, <span class="r34 r">key</span>, <span class="r36 r">value</span>);
        }
 
        <b>private static string</b> <a id="105704695cd41bfe" href="../../R/105704695cd41bfe.html" target="n" data-glyph="76,1" class="i method">ManifestComment</a>(<b>string</b> <span id="r38 rd" class="r38 r">insert</span>, <span class="i">StreamWriter</span> <span id="r39 rd" class="r39 r">streamWriter</span>)
        {
            <span class="c">// Prefix a non-empty string with a space for formatting reasons...</span>
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r38 r">insert</span>))
            {
                <span class="r38 r">insert</span> = <span class="s">&quot; &quot;</span> + <span class="r38 r">insert</span>;
            }
 
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;#{0}{1}&quot;</span>, <span class="r38 r">insert</span>, <span class="r39 r">streamWriter</span>.<span class="i">NewLine</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generate the module manifest...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="5576ce53874b260b" href="../../R/5576ce53874b260b.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <span class="c">// Win8: 264471 - Error message for New-ModuleManifest -ProcessorArchitecture is obsolete.</span>
            <span class="c">// If an undefined value is passed for the ProcessorArchitecture parameter, the error message from parameter binder includes all the values from the enum.</span>
            <span class="c">// The value &#39;IA64&#39; for ProcessorArchitecture is not supported. But since we do not own the enum System.Reflection.ProcessorArchitecture, we cannot control the values in it.</span>
            <span class="c">// So, we add a separate check in our code to give an error if user specifies IA64</span>
            <b>if</b> (<a href="#96d38a3d903775a1" class="i property">ProcessorArchitecture</a> == <a href="#96d38a3d903775a1" class="i property">ProcessorArchitecture</a>.<span class="i">IA64</span>)
            {
                <b>string</b> <span id="r40 rd" class="r40 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">InvalidProcessorArchitectureInManifest</span>, <a href="#96d38a3d903775a1" class="i property">ProcessorArchitecture</a>);
                <span class="i">InvalidOperationException</span> <span id="r41 rd" class="r41 r">ioe</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r40 r">message</span>);
                <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r42 rd" class="r42 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r41 r">ioe</span>, <span class="s">&quot;Modules_InvalidProcessorArchitectureInManifest&quot;</span>,
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#96d38a3d903775a1" class="i property">ProcessorArchitecture</a>);
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r42 r">er</span>);
            }
 
            <a href="../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r43 rd" class="r43 r">provider</span> = <b>null</b>;
            <a href="../DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r44 rd" class="r44 r">drive</span>;
            <b>string</b> <span id="r45 rd" class="r45 r">filePath</span> = <a href="../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../PathInterfaces.cs.html#89444ef2b32a4408" class="i method">GetUnresolvedProviderPathFromPSPath</a>(<a href="#398a58fbe617aeba" class="i field">_path</a>, <b>out</b> <span class="r43 r">provider</span>, <b>out</b> <span class="r44 r">drive</span>);
 
            <b>if</b> (!<span class="r43 r">provider</span>.<a href="../DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<a href="../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="../ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>) || !<span class="r45 r">filePath</span>.<span class="i">EndsWith</span>(<a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#35afed2e7cb8ba9d" class="i field">PowerShellDataFileExtension</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>string</b> <span id="r46 rd" class="r46 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">InvalidModuleManifestPath</span>, <a href="#398a58fbe617aeba" class="i field">_path</a>);
                <span class="i">InvalidOperationException</span> <span id="r47 rd" class="r47 r">ioe</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r46 r">message</span>);
                <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r48 rd" class="r48 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r47 r">ioe</span>, <span class="s">&quot;Modules_InvalidModuleManifestPath&quot;</span>,
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#398a58fbe617aeba" class="i field">_path</a>);
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r48 r">er</span>);
            }
 
            <span class="c">// By default, we want to generate a module manifest the encourages the best practice of explicitly specifying</span>
            <span class="c">// the commands exported (even if it&#39;s an empty array.) Unfortunately, changing the default breaks automation</span>
            <span class="c">// (however unlikely, this cmdlet isn&#39;t really meant for automation). Instead of trying to detect interactive</span>
            <span class="c">// use (which is quite hard), we infer interactive use if none of RootModule/NestedModules/RequiredModules is</span>
            <span class="c">// specified - because the manifest needs to be edited to actually be of use in those cases.</span>
            <span class="c">//</span>
            <span class="c">// If one of these parameters has been specified, default back to the old behavior by specifying</span>
            <span class="c">// wildcards for exported commands that weren&#39;t specified on the command line.</span>
            <b>if</b> (<a href="#dd0ceadd5016dfa1" class="i field">_rootModule</a> != <b>null</b> || <a href="#3d4ecc597ad6ff86" class="i field">_nestedModules</a> != <b>null</b> || <a href="#de541e8ed948cd71" class="i field">_requiredModules</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#789bd563e69e3933" class="i field">_exportedFunctions</a> == <b>null</b>)
                    <a href="#789bd563e69e3933" class="i field">_exportedFunctions</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
                <b>if</b> (<a href="#795eaf1ece8e05b2" class="i field">_exportedAliases</a> == <b>null</b>)
                    <a href="#795eaf1ece8e05b2" class="i field">_exportedAliases</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
                <b>if</b> (<a href="#331c9afcb5bbf63c" class="i field">_exportedCmdlets</a> == <b>null</b>)
                    <a href="#331c9afcb5bbf63c" class="i field">_exportedCmdlets</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
            }
 
            <a href="#60dc31f988c4d0d1" class="i method">ValidateUriParameterValue</a>(<a href="#09a967bc01f3ae3b" class="i property">ProjectUri</a>, <span class="s">&quot;ProjectUri&quot;</span>);
            <a href="#60dc31f988c4d0d1" class="i method">ValidateUriParameterValue</a>(<a href="#eec7a4f66b882382" class="i property">LicenseUri</a>, <span class="s">&quot;LicenseUri&quot;</span>);
            <a href="#60dc31f988c4d0d1" class="i method">ValidateUriParameterValue</a>(<a href="#7a9e39d1bc5b6d6d" class="i property">IconUri</a>, <span class="s">&quot;IconUri&quot;</span>);
            <b>if</b> (<a href="#eadc3614048ea6a1" class="i field">_helpInfoUri</a> != <b>null</b>)
            {
                <a href="#60dc31f988c4d0d1" class="i method">ValidateUriParameterValue</a>(<b>new</b> <span class="i">Uri</span>(<a href="#eadc3614048ea6a1" class="i field">_helpInfoUri</a>), <span class="s">&quot;HelpInfoUri&quot;</span>);
            }
 
            <b>if</b> (<a href="#118a8260e51530f3" class="i property">CompatiblePSEditions</a> != <b>null</b> &amp;&amp; (<a href="#118a8260e51530f3" class="i property">CompatiblePSEditions</a>.<span class="i">Distinct</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>).<span class="i">Count</span>() != <a href="#118a8260e51530f3" class="i property">CompatiblePSEditions</a>.<span class="i">Length</span>))
            {
                <b>string</b> <span id="r49 rd" class="r49 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">DuplicateEntriesInCompatiblePSEditions</span>, <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;,&quot;</span>, <a href="#118a8260e51530f3" class="i property">CompatiblePSEditions</a>));
                <b>var</b> <span id="r50 rd" class="r50 r">ioe</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r49 r">message</span>);
                <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="k">var</a> <span id="r51 rd" class="r51 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r50 r">ioe</span>, <span class="s">&quot;Modules_DuplicateEntriesInCompatiblePSEditions&quot;</span>, <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#118a8260e51530f3" class="i property">CompatiblePSEditions</a>);
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r51 r">er</span>);
            }
 
            <b>string</b> <span id="r52 rd" class="r52 r">action</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">CreatingModuleManifestFile</span>, <span class="r45 r">filePath</span>);
 
            <b>if</b> (<a href="../cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<span class="r45 r">filePath</span>, <span class="r52 r">action</span>))
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#6eede1c391c48700" class="i field">_author</a>))
                {
                    <a href="#6eede1c391c48700" class="i field">_author</a> = <span class="i">Environment</span>.<span class="i">UserName</span>;
                }
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#3a7027aac8979d58" class="i field">_companyName</a>))
                {
                    <a href="#3a7027aac8979d58" class="i field">_companyName</a> = <span class="i">Modules</span>.<span class="i">DefaultCompanyName</span>;
                }
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#0349bb20b9d7394b" class="i field">_copyright</a>))
                {
                    <a href="#0349bb20b9d7394b" class="i field">_copyright</a> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">DefaultCopyrightMessage</span>, <a href="#6eede1c391c48700" class="i field">_author</a>);
                }
 
                <span class="i">FileStream</span> <span id="r53 rd" class="r53 r">fileStream</span>;
                <span class="i">StreamWriter</span> <span id="r54 rd" class="r54 r">streamWriter</span>;
                <span class="i">FileInfo</span> <span id="r55 rd" class="r55 r">readOnlyFileInfo</span>;
 
                <span class="c">// Now open the output file...</span>
                <a href="../../utils/PathUtils.cs.html#fdaf75f786a21eb9" class="t t">PathUtils</a>.<span class="i">MasterStreamOpen</span>(
                    <span class="i">cmdlet</span>: <a href="#22af511d9f5fc801" class="k">this</a>,
                    <span class="i">filePath</span>: <span class="r45 r">filePath</span>,
                    <span class="i">resolvedEncoding</span>: <b>new</b> <span class="i">UTF8Encoding</span>(<span class="i">encoderShouldEmitUTF8Identifier</span>: <b>false</b>),
                    <span class="i">defaultEncoding</span>: <b>false</b>,
                    <span class="i">Append</span>: <b>false</b>,
                    <span class="i">Force</span>: <b>false</b>,
                    <span class="i">NoClobber</span>: <b>false</b>,
                    <span class="i">fileStream</span>: <b>out</b> <span class="r53 r">fileStream</span>,
                    <span class="i">streamWriter</span>: <b>out</b> <span class="r54 r">streamWriter</span>,
                    <span class="i">readOnlyFileInfo</span>: <b>out</b> <span class="r55 r">readOnlyFileInfo</span>,
                    <span class="i">isLiteralPath</span>: <b>false</b>
                );
 
                <b>try</b>
                {
                    <span class="i">StringBuilder</span> <span id="r56 rd" class="r56 r">result</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
                    <span class="c">// Insert the formatted manifest header...</span>
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestComment</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r54 r">streamWriter</span>));
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<a href="#105704695cd41bfe" class="i method">ManifestComment</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">ManifestHeaderLine1</span>, <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="r45 r">filePath</span>)),
                            <span class="r54 r">streamWriter</span>));
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestComment</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r54 r">streamWriter</span>));
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<a href="#105704695cd41bfe" class="i method">ManifestComment</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">ManifestHeaderLine2</span>, <a href="#6eede1c391c48700" class="i field">_author</a>),
                            <span class="r54 r">streamWriter</span>));
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestComment</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r54 r">streamWriter</span>));
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<a href="#105704695cd41bfe" class="i method">ManifestComment</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">ManifestHeaderLine3</span>, <span class="i">DateTime</span>.<span class="i">Now</span>.<span class="i">ToString</span>(<span class="s">&quot;d&quot;</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>)),
                            <span class="r54 r">streamWriter</span>));
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestComment</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r54 r">streamWriter</span>));
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="r54 r">streamWriter</span>.<span class="i">NewLine</span>);
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;@{&quot;</span>);
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="r54 r">streamWriter</span>.<span class="i">NewLine</span>);
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="r54 r">streamWriter</span>.<span class="i">NewLine</span>);
 
                    <b>if</b> (<a href="#dd0ceadd5016dfa1" class="i field">_rootModule</a> == <b>null</b>)
                        <a href="#dd0ceadd5016dfa1" class="i field">_rootModule</a> = <b>string</b>.<span class="i">Empty</span>;
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#f5a26a1b5f19ca65" class="i property">RootModule</a>), <span class="i">Modules</span>.<span class="i">RootModule</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#dd0ceadd5016dfa1" class="i field">_rootModule</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#dd0ceadd5016dfa1" class="i field">_rootModule</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#a28f3406333e3e39" class="i property">ModuleVersion</a>), <span class="i">Modules</span>.<span class="i">ModuleVersion</span>, <a href="#deb5e133d2d49e64" class="i field">_moduleVersion</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#deb5e133d2d49e64" class="i field">_moduleVersion</a>.<span class="i">ToString</span>()), () =&gt; <a href="#4bcb123577686ecc" class="i method">QuoteName</a>(<a href="#deb5e133d2d49e64" class="i field">_moduleVersion</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#118a8260e51530f3" class="i property">CompatiblePSEditions</a>), <span class="i">Modules</span>.<span class="i">CompatiblePSEditions</span>, <a href="#a8f39a9a3c5a9659" class="i field">_compatiblePSEditions</a> != <b>null</b> &amp;&amp; <a href="#a8f39a9a3c5a9659" class="i field">_compatiblePSEditions</a>.<span class="i">Length</span> &gt; 0, () =&gt; <span class="i">QuoteNames</span>(<a href="#a8f39a9a3c5a9659" class="i field">_compatiblePSEditions</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<span class="i">Modules</span>.<span class="i">GUID</span>), <span class="i">Modules</span>.<span class="i">GUID</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#256fad01e291ff58" class="i field">_guid</a>.<span class="i">ToString</span>()), () =&gt; <span class="i">QuoteName</span>(<a href="#256fad01e291ff58" class="i field">_guid</a>.<span class="i">ToString</span>()), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#bed498c157552dea" class="i property">Author</a>), <span class="i">Modules</span>.<span class="i">Author</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#6eede1c391c48700" class="i field">_author</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#bed498c157552dea" class="i property">Author</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#eda182e742612f4c" class="i property">CompanyName</a>), <span class="i">Modules</span>.<span class="i">CompanyName</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#3a7027aac8979d58" class="i field">_companyName</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#3a7027aac8979d58" class="i field">_companyName</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#32451bbee197b0d1" class="i property">Copyright</a>), <span class="i">Modules</span>.<span class="i">Copyright</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#0349bb20b9d7394b" class="i field">_copyright</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#0349bb20b9d7394b" class="i field">_copyright</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#515397dabb4960e7" class="i property">Description</a>), <span class="i">Modules</span>.<span class="i">Description</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#90733687dc6e7213" class="i field">_description</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#90733687dc6e7213" class="i field">_description</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#91c0bd68c17c3a95" class="i property">PowerShellVersion</a>), <span class="i">Modules</span>.<span class="i">PowerShellVersion</span>, <a href="#11c2a3a0da366508" class="i field">_powerShellVersion</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#11c2a3a0da366508" class="i field">_powerShellVersion</a>.<span class="i">ToString</span>()), () =&gt; <a href="#4bcb123577686ecc" class="i method">QuoteName</a>(<a href="#11c2a3a0da366508" class="i field">_powerShellVersion</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#f9a3b281567ae395" class="i property">PowerShellHostName</a>), <span class="i">Modules</span>.<span class="i">PowerShellHostName</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#50364096eaa64de6" class="i field">_PowerShellHostName</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#50364096eaa64de6" class="i field">_PowerShellHostName</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#e7b8c02a325c3c5a" class="i property">PowerShellHostVersion</a>), <span class="i">Modules</span>.<span class="i">PowerShellHostVersion</span>, <a href="#1cee091bce726562" class="i field">_PowerShellHostVersion</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#1cee091bce726562" class="i field">_PowerShellHostVersion</a>.<span class="i">ToString</span>()), () =&gt; <a href="#4bcb123577686ecc" class="i method">QuoteName</a>(<a href="#1cee091bce726562" class="i field">_PowerShellHostVersion</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#20709adc6ea16d10" class="i property">DotNetFrameworkVersion</a>), <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">DotNetFrameworkVersion</span>, <span class="i">Modules</span>.<span class="i">PrerequisiteForDesktopEditionOnly</span>), <a href="#3b08a735ae54747e" class="i field">_DotNetFrameworkVersion</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#3b08a735ae54747e" class="i field">_DotNetFrameworkVersion</a>.<span class="i">ToString</span>()), () =&gt; <a href="#4bcb123577686ecc" class="i method">QuoteName</a>(<a href="#3b08a735ae54747e" class="i field">_DotNetFrameworkVersion</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#ead8353bcfba541a" class="i property">ClrVersion</a>), <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">CLRVersion</span>, <span class="i">Modules</span>.<span class="i">PrerequisiteForDesktopEditionOnly</span>), <a href="#af8f7967d220622a" class="i field">_ClrVersion</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#af8f7967d220622a" class="i field">_ClrVersion</a>.<span class="i">ToString</span>()), () =&gt; <a href="#4bcb123577686ecc" class="i method">QuoteName</a>(<a href="#af8f7967d220622a" class="i field">_ClrVersion</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#96d38a3d903775a1" class="i property">ProcessorArchitecture</a>), <span class="i">Modules</span>.<span class="i">ProcessorArchitecture</span>, <a href="#1f14a4a212940642" class="i field">_processorArchitecture</a>.<span class="i">HasValue</span>, () =&gt; <span class="i">QuoteName</span>(<a href="#1f14a4a212940642" class="i field">_processorArchitecture</a>.<span class="i">ToString</span>()), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#fb1ca2cec1096d10" class="i property">RequiredModules</a>), <span class="i">Modules</span>.<span class="i">RequiredModules</span>, <a href="#de541e8ed948cd71" class="i field">_requiredModules</a> != <b>null</b> &amp;&amp; <a href="#de541e8ed948cd71" class="i field">_requiredModules</a>.<span class="i">Length</span> &gt; 0, () =&gt; <span class="i">QuoteModules</span>(<a href="#de541e8ed948cd71" class="i field">_requiredModules</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#c517e24974cac5a0" class="i property">RequiredAssemblies</a>), <span class="i">Modules</span>.<span class="i">RequiredAssemblies</span>, <a href="#af726ae921dc44e2" class="i field">_requiredAssemblies</a> != <b>null</b>, () =&gt; <span class="i">QuoteFiles</span>(<a href="#af726ae921dc44e2" class="i field">_requiredAssemblies</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#3b2fb305ac3e0836" class="i property">ScriptsToProcess</a>), <span class="i">Modules</span>.<span class="i">ScriptsToProcess</span>, <a href="#9f21acacbaf4bbb6" class="i field">_scripts</a> != <b>null</b>, () =&gt; <span class="i">QuoteFiles</span>(<a href="#9f21acacbaf4bbb6" class="i field">_scripts</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#a08812f6d8296974" class="i property">TypesToProcess</a>), <span class="i">Modules</span>.<span class="i">TypesToProcess</span>, <a href="#998e98bdaa6b1be2" class="i field">_types</a> != <b>null</b>, () =&gt; <span class="i">QuoteFiles</span>(<a href="#998e98bdaa6b1be2" class="i field">_types</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#3aceae85c4ea7bc0" class="i property">FormatsToProcess</a>), <span class="i">Modules</span>.<span class="i">FormatsToProcess</span>, <a href="#3d4dea88ea275149" class="i field">_formats</a> != <b>null</b>, () =&gt; <span class="i">QuoteFiles</span>(<a href="#3d4dea88ea275149" class="i field">_formats</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#c721d4619aa9df5e" class="i property">NestedModules</a>), <span class="i">Modules</span>.<span class="i">NestedModules</span>, <a href="#3d4ecc597ad6ff86" class="i field">_nestedModules</a> != <b>null</b>, () =&gt; <a href="#c5a2344f37801517" class="i method">QuoteModules</a>(<span class="i">PreProcessModuleSpec</span>(<a href="#3d4ecc597ad6ff86" class="i field">_nestedModules</a>), <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#9d322e66c51fde8f" class="i property">FunctionsToExport</a>), <span class="i">Modules</span>.<span class="i">FunctionsToExport</span>, <b>true</b>, () =&gt; <span class="i">QuoteNames</span>(<a href="#789bd563e69e3933" class="i field">_exportedFunctions</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#e898366be559921f" class="i property">CmdletsToExport</a>), <span class="i">Modules</span>.<span class="i">CmdletsToExport</span>, <b>true</b>, () =&gt; <span class="i">QuoteNames</span>(<a href="#331c9afcb5bbf63c" class="i field">_exportedCmdlets</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#163e6168c7d3cb2d" class="i property">VariablesToExport</a>), <span class="i">Modules</span>.<span class="i">VariablesToExport</span>, <a href="#9a88b996abbccc2c" class="i field">_exportedVariables</a> != <b>null</b> &amp;&amp; <a href="#9a88b996abbccc2c" class="i field">_exportedVariables</a>.<span class="i">Length</span> &gt; 0, () =&gt; <span class="i">QuoteNames</span>(<a href="#9a88b996abbccc2c" class="i field">_exportedVariables</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#abda2e5951e75527" class="i property">AliasesToExport</a>), <span class="i">Modules</span>.<span class="i">AliasesToExport</span>, <b>true</b>, () =&gt; <span class="i">QuoteNames</span>(<a href="#795eaf1ece8e05b2" class="i field">_exportedAliases</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#b154b466b9f3f231" class="i property">DscResourcesToExport</a>), <span class="i">Modules</span>.<span class="i">DscResourcesToExport</span>, <a href="#186cea6883b37d62" class="i field">_dscResourcesToExport</a> != <b>null</b> &amp;&amp; <a href="#186cea6883b37d62" class="i field">_dscResourcesToExport</a>.<span class="i">Length</span> &gt; 0, () =&gt; <span class="i">QuoteNames</span>(<a href="#186cea6883b37d62" class="i field">_dscResourcesToExport</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#f24decd67bf062c4" class="i property">ModuleList</a>), <span class="i">Modules</span>.<span class="i">ModuleList</span>, <a href="#d3f7e648dae45348" class="i field">_moduleList</a> != <b>null</b>, () =&gt; <span class="i">QuoteModules</span>(<a href="#d3f7e648dae45348" class="i field">_moduleList</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#9b12a61509420ef6" class="i property">FileList</a>), <span class="i">Modules</span>.<span class="i">FileList</span>, <a href="#cab8ceddba35ba11" class="i field">_miscFiles</a> != <b>null</b>, () =&gt; <span class="i">QuoteFiles</span>(<a href="#cab8ceddba35ba11" class="i field">_miscFiles</a>, <span class="r54 r">streamWriter</span>), <span class="r54 r">streamWriter</span>);
 
                    <a href="#3658ed35bbeb34e6" class="i method">BuildPrivateDataInModuleManifest</a>(<span class="r56 r">result</span>, <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<span class="i">Modules</span>.<span class="i">HelpInfoURI</span>), <span class="i">Modules</span>.<span class="i">HelpInfoURI</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#eadc3614048ea6a1" class="i field">_helpInfoUri</a>), () =&gt; <a href="#d764e948c32359a1" class="i method">QuoteName</a>((<a href="#eadc3614048ea6a1" class="i field">_helpInfoUri</a> != <b>null</b>) ? <b>new</b> <span class="i">Uri</span>(<a href="#eadc3614048ea6a1" class="i field">_helpInfoUri</a>) : <b>null</b>), <span class="r54 r">streamWriter</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r56 r">result</span>, <b>nameof</b>(<a href="#1bc1d915fb109a16" class="i property">DefaultCommandPrefix</a>), <span class="i">Modules</span>.<span class="i">DefaultCommandPrefix</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#7c70da0f59daf16e" class="i field">_defaultCommandPrefix</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#7c70da0f59daf16e" class="i field">_defaultCommandPrefix</a>), <span class="r54 r">streamWriter</span>);
 
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="r54 r">streamWriter</span>.<span class="i">NewLine</span>);
                    <span class="r56 r">result</span>.<span class="i">Append</span>(<span class="r54 r">streamWriter</span>.<span class="i">NewLine</span>);
                    <b>string</b> <span id="r57 rd" class="r57 r">strResult</span> = <span class="r56 r">result</span>.<span class="i">ToString</span>();
 
                    <b>if</b> (<a href="#1ba635793d3f32a9" class="i field">_passThru</a>)
                    {
                        <a href="../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r57 r">strResult</span>);
                    }
 
                    <span class="r54 r">streamWriter</span>.<span class="i">Write</span>(<span class="r57 r">strResult</span>);
                }
                <b>finally</b>
                {
                    <span class="r54 r">streamWriter</span>.<span class="i">Dispose</span>();
                }
            }
        }
 
        <b>private void</b> <a id="409561876807386c" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">BuildModuleManifest</a>(<span class="i">StringBuilder</span> <span id="r58 rd" class="r58 r">result</span>, <b>string</b> <span id="r59 rd" class="r59 r">key</span>, <b>string</b> <span id="r60 rd" class="r60 r">keyDescription</span>, <b>bool</b> <span id="r61 rd" class="r61 r">hasValue</span>, <span class="i">Func</span>&lt;<b>string</b>&gt; <span id="r62 rd" class="r62 r">action</span>, <span class="i">StreamWriter</span> <span id="r63 rd" class="r63 r">streamWriter</span>)
        {
            <b>if</b> (<span class="r61 r">hasValue</span>)
            {
                <span class="r58 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestFragment</span>(<span class="r59 r">key</span>, <span class="r60 r">keyDescription</span>, <span class="r62 r">action</span>(), <span class="r63 r">streamWriter</span>));
            }
            <b>else</b>
            {
                <span class="r58 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestFragmentForNonSpecifiedManifestMember</span>(<span class="r59 r">key</span>, <span class="r60 r">keyDescription</span>, <span class="r62 r">action</span>(), <span class="r63 r">streamWriter</span>));
            }
        }
 
        <span class="c">// PrivateData format in manifest file when PrivateData value is a HashTable or not specified.</span>
        <span class="c">// &lt;#</span>
        <span class="c">// # Private data to pass to the module specified in RootModule/ModuleToProcess</span>
        <span class="c">// PrivateData = @{</span>
        <span class="c">//</span>
        <span class="c">// PSData = @{</span>
        <span class="c">// # Tags of this module</span>
        <span class="c">// Tags = @()</span>
        <span class="c">// # LicenseUri of this module</span>
        <span class="c">// LicenseUri = &#39;&#39;</span>
        <span class="c">// # ProjectUri of this module</span>
        <span class="c">// ProjectUri = &#39;&#39;</span>
        <span class="c">// # IconUri of this module</span>
        <span class="c">// IconUri = &#39;&#39;</span>
        <span class="c">// # ReleaseNotes of this module</span>
        <span class="c">// ReleaseNotes = &#39;&#39;</span>
        <span class="c">// }# end of PSData hashtable</span>
        <span class="c">//</span>
        <span class="c">// # User&#39;s private data keys</span>
        <span class="c">//</span>
        <span class="c">// }# end of PrivateData hashtable</span>
        <span class="c">// #&gt;</span>
        <b>private void</b> <a id="3658ed35bbeb34e6" href="../../R/3658ed35bbeb34e6.html" target="n" data-glyph="76,1" class="i method">BuildPrivateDataInModuleManifest</a>(<span class="i">StringBuilder</span> <span id="r64 rd" class="r64 r">result</span>, <span class="i">StreamWriter</span> <span id="r65 rd" class="r65 r">streamWriter</span>)
        {
            <b>var</b> <span id="r66 rd" class="r66 r">privateDataHashTable</span> = <a href="#114069de80f8b6c0" class="i property">PrivateData</a> <b>as</b> <span class="i">Hashtable</span>;
            <b>bool</b> <span id="r67 rd" class="r67 r">specifiedPSDataProperties</span> = !(<a href="#89d68dd520dffb5b" class="i property">Tags</a> == <b>null</b> &amp;&amp; <a href="#62b864d8641518aa" class="i property">ReleaseNotes</a> == <b>null</b> &amp;&amp; <a href="#09a967bc01f3ae3b" class="i property">ProjectUri</a> == <b>null</b> &amp;&amp; <a href="#7a9e39d1bc5b6d6d" class="i property">IconUri</a> == <b>null</b> &amp;&amp; <a href="#eec7a4f66b882382" class="i property">LicenseUri</a> == <b>null</b>);
 
            <b>if</b> (<a href="#6cdac8c74aa6365f" class="i field">_privateData</a> != <b>null</b> &amp;&amp; <span class="r66 r">privateDataHashTable</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r67 r">specifiedPSDataProperties</span>)
                {
                    <b>var</b> <span id="r68 rd" class="r68 r">ioe</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">Modules</span>.<span class="i">PrivateDataValueTypeShouldBeHashTableError</span>);
                    <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="k">var</a> <span id="r69 rd" class="r69 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r68 r">ioe</span>, <span class="s">&quot;PrivateDataValueTypeShouldBeHashTable&quot;</span>, <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#6cdac8c74aa6365f" class="i field">_privateData</a>);
                    <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r69 r">er</span>);
                }
                <b>else</b>
                {
                    <span class="i">WriteWarning</span>(<span class="i">Modules</span>.<span class="i">PrivateDataValueTypeShouldBeHashTableWarning</span>);
 
                    <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#114069de80f8b6c0" class="i property">PrivateData</a>), <span class="i">Modules</span>.<span class="i">PrivateData</span>, <a href="#6cdac8c74aa6365f" class="i field">_privateData</a> != <b>null</b>,
                        () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>((<b>string</b>)<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<a href="#6cdac8c74aa6365f" class="i field">_privateData</a>, <b>typeof</b>(<b>string</b>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>)),
                        <span class="r65 r">streamWriter</span>);
                }
            }
            <b>else</b>
            {
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestComment</span>(<span class="i">Modules</span>.<span class="i">PrivateData</span>, <span class="r65 r">streamWriter</span>));
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;PrivateData = @{&quot;</span>);
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>);
 
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>);
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;    PSData = @{&quot;</span>);
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>);
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>);
 
                <a href="#71ce0f0296e3f595" class="i field">_indent</a> = <span class="s">&quot;        &quot;</span>;
 
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#89d68dd520dffb5b" class="i property">Tags</a>), <span class="i">Modules</span>.<span class="i">Tags</span>, <a href="#89d68dd520dffb5b" class="i property">Tags</a> != <b>null</b> &amp;&amp; <a href="#89d68dd520dffb5b" class="i property">Tags</a>.<span class="i">Length</span> &gt; 0, () =&gt; <span class="i">QuoteNames</span>(<a href="#89d68dd520dffb5b" class="i property">Tags</a>, <span class="r65 r">streamWriter</span>), <span class="r65 r">streamWriter</span>);
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#eec7a4f66b882382" class="i property">LicenseUri</a>), <span class="i">Modules</span>.<span class="i">LicenseUri</span>, <a href="#eec7a4f66b882382" class="i property">LicenseUri</a> != <b>null</b>, () =&gt; <a href="#d764e948c32359a1" class="i method">QuoteName</a>(<a href="#eec7a4f66b882382" class="i property">LicenseUri</a>), <span class="r65 r">streamWriter</span>);
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#09a967bc01f3ae3b" class="i property">ProjectUri</a>), <span class="i">Modules</span>.<span class="i">ProjectUri</span>, <a href="#09a967bc01f3ae3b" class="i property">ProjectUri</a> != <b>null</b>, () =&gt; <a href="#d764e948c32359a1" class="i method">QuoteName</a>(<a href="#09a967bc01f3ae3b" class="i property">ProjectUri</a>), <span class="r65 r">streamWriter</span>);
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#7a9e39d1bc5b6d6d" class="i property">IconUri</a>), <span class="i">Modules</span>.<span class="i">IconUri</span>, <a href="#7a9e39d1bc5b6d6d" class="i property">IconUri</a> != <b>null</b>, () =&gt; <a href="#d764e948c32359a1" class="i method">QuoteName</a>(<a href="#7a9e39d1bc5b6d6d" class="i property">IconUri</a>), <span class="r65 r">streamWriter</span>);
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#62b864d8641518aa" class="i property">ReleaseNotes</a>), <span class="i">Modules</span>.<span class="i">ReleaseNotes</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#62b864d8641518aa" class="i property">ReleaseNotes</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#62b864d8641518aa" class="i property">ReleaseNotes</a>), <span class="r65 r">streamWriter</span>);
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#5494ccfd44a3cc11" class="i property">Prerelease</a>), <span class="i">Modules</span>.<span class="i">Prerelease</span>, !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#5494ccfd44a3cc11" class="i property">Prerelease</a>), () =&gt; <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>(<a href="#5494ccfd44a3cc11" class="i property">Prerelease</a>), <span class="r65 r">streamWriter</span>);
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#a31eda63a0012b69" class="i property">RequireLicenseAcceptance</a>), <span class="i">Modules</span>.<span class="i">RequireLicenseAcceptance</span>, <a href="#a31eda63a0012b69" class="i property">RequireLicenseAcceptance</a>.<a href="../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a>, () =&gt; <a href="#a31eda63a0012b69" class="i property">RequireLicenseAcceptance</a>.<a href="../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a> ? <span class="s">&quot;$true&quot;</span> : <span class="s">&quot;$false&quot;</span>, <span class="r65 r">streamWriter</span>);
                <span class="i">BuildModuleManifest</span>(<span class="r64 r">result</span>, <b>nameof</b>(<a href="#aa829a0b6e4a29dd" class="i property">ExternalModuleDependencies</a>), <span class="i">Modules</span>.<span class="i">ExternalModuleDependencies</span>, <a href="#aa829a0b6e4a29dd" class="i property">ExternalModuleDependencies</a> != <b>null</b> &amp;&amp; <a href="#aa829a0b6e4a29dd" class="i property">ExternalModuleDependencies</a>.<span class="i">Length</span> &gt; 0, () =&gt; <span class="i">QuoteNames</span>(<a href="#aa829a0b6e4a29dd" class="i property">ExternalModuleDependencies</a>, <span class="r65 r">streamWriter</span>), <span class="r65 r">streamWriter</span>);
 
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;    } &quot;</span>);
                <span class="r64 r">result</span>.<span class="i">Append</span>(<a href="#105704695cd41bfe" class="i method">ManifestComment</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">EndOfManifestHashTable</span>, <span class="s">&quot;PSData&quot;</span>), <span class="r65 r">streamWriter</span>));
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>);
 
                <a href="#71ce0f0296e3f595" class="i field">_indent</a> = <span class="s">&quot;    &quot;</span>;
                <b>if</b> (<span class="r66 r">privateDataHashTable</span> != <b>null</b>)
                {
                    <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>);
 
                    <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r70 rd" class="r70 r">entry</span> <b>in</b> <span class="r66 r">privateDataHashTable</span>)
                    {
                        <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="i">ManifestFragment</span>(<span class="r70 r">entry</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <span class="r70 r">entry</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <a href="#f84bf0ca06b70820" class="i method">QuoteName</a>((<b>string</b>)<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r70 r">entry</span>.<span class="i">Value</span>, <b>typeof</b>(<b>string</b>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>)), <span class="r65 r">streamWriter</span>));
                    }
                }
 
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;} &quot;</span>);
                <span class="r64 r">result</span>.<span class="i">Append</span>(<a href="#105704695cd41bfe" class="i method">ManifestComment</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">EndOfManifestHashTable</span>, <span class="s">&quot;PrivateData&quot;</span>), <span class="r65 r">streamWriter</span>));
 
                <a href="#71ce0f0296e3f595" class="i field">_indent</a> = <b>string</b>.<span class="i">Empty</span>;
 
                <span class="r64 r">result</span>.<span class="i">Append</span>(<span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>);
            }
        }
 
        <b>private void</b> <a id="60dc31f988c4d0d1" href="../../R/60dc31f988c4d0d1.html" target="n" data-glyph="76,1" class="i method">ValidateUriParameterValue</a>(<span class="i">Uri</span> <span id="r71 rd" class="r71 r">uri</span>, <b>string</b> <span id="r72 rd" class="r72 r">parameterName</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r72 r">parameterName</span>), <span class="s">&quot;parameterName should not be null or whitespace&quot;</span>);
 
            <b>if</b> (<span class="r71 r">uri</span> != <b>null</b> &amp;&amp; !<span class="i">Uri</span>.<span class="i">IsWellFormedUriString</span>(<span class="r71 r">uri</span>.<span class="i">AbsoluteUri</span>, <span class="i">UriKind</span>.<span class="i">Absolute</span>))
            {
                <b>var</b> <span id="r73 rd" class="r73 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">InvalidParameterValue</span>, <span class="r71 r">uri</span>);
                <b>var</b> <span id="r74 rd" class="r74 r">ioe</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r73 r">message</span>);
                <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="k">var</a> <span id="r75 rd" class="r75 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r74 r">ioe</span>, <span class="s">&quot;Modules_InvalidUri&quot;</span>,
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="r72 r">parameterName</span>);
                <a href="../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r75 r">er</span>);
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
