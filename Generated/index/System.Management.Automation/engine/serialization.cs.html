<!DOCTYPE html>
<html><head><title>serialization.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(7607);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/serialization.cs" target="_top">engine\serialization.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Tracing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">Mail</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    [<span class="i">Flags</span>]
    <b>internal enum</b> <a id="5b149bd0ceeb6fb3" href="../R/5b149bd0ceeb6fb3.html" target="n" data-glyph="20,0" class="t t"><span id="72599a07bc236340">SerializationOptions</span></a>
    {
        <a id="4aa3f8708c851987" href="../R/4aa3f8708c851987.html" target="n" data-glyph="24,1" class="i field">None</a> = 0,
        <a id="b1bbe4a98fcbc7bf" href="../R/b1bbe4a98fcbc7bf.html" target="n" data-glyph="24,1" class="i field">UseDepthFromTypes</a> = 1,
        <a id="16119eba913e0adf" href="../R/16119eba913e0adf.html" target="n" data-glyph="24,1" class="i field">NoRootElement</a> = 2,
        <a id="e3057cca11315410" href="../R/e3057cca11315410.html" target="n" data-glyph="24,1" class="i field">NoNamespace</a> = 4,
        <a id="acad964848d612fc" href="../R/acad964848d612fc.html" target="n" data-glyph="24,1" class="i field">NoObjectRefIds</a> = 8,
        <a id="edf7522768bc0938" href="../R/edf7522768bc0938.html" target="n" data-glyph="24,1" class="i field">PreserveSerializationSettingOfOriginal</a> = 16,
 
        <a id="3c76428c57bf784c" href="../R/3c76428c57bf784c.html" target="n" data-glyph="24,1" class="i field">RemotingOptions</a> = <a href="#b1bbe4a98fcbc7bf" class="i field">UseDepthFromTypes</a> | <a href="#16119eba913e0adf" class="i field">NoRootElement</a> | <a href="#e3057cca11315410" class="i field">NoNamespace</a> | <a href="#edf7522768bc0938" class="i field">PreserveSerializationSettingOfOriginal</a>,
    }
 
    <b>internal class</b> <a id="79c883e3ce596f80" href="../R/79c883e3ce596f80.html" target="n" data-glyph="2,0" class="t t">SerializationContext</a>
    {
        <b>private const int</b> <a id="a4c228665df9bf3f" href="../R/a4c228665df9bf3f.html" target="n" data-glyph="10,1" class="i field">DefaultSerializationDepth</a> = 2;
 
        <b>internal</b> <a id="df66d7e7cbe0762e" href="../R/df66d7e7cbe0762e.html" target="n" data-glyph="74,1" class="t constructor">SerializationContext</a>()
            : <a href="#3ea77a9b3b14b98a" class="k">this</a>(<a href="#a4c228665df9bf3f" class="i field">DefaultSerializationDepth</a>, <b>true</b>)
        {
        }
 
        <b>internal</b> <a id="3ea77a9b3b14b98a" href="../R/3ea77a9b3b14b98a.html" target="n" data-glyph="74,1" class="t constructor">SerializationContext</a>(<b>int</b> <span id="r0 rd" class="r0 r">depth</span>, <b>bool</b> <span id="r1 rd" class="r1 r">useDepthFromTypes</span>)
            : <b>this</b>(
                    <span class="r0 r">depth</span>,
                    (<span class="r1 r">useDepthFromTypes</span> ? <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#b1bbe4a98fcbc7bf" class="i field">UseDepthFromTypes</a> : <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#4aa3f8708c851987" class="i field">None</a>) |
                       <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#edf7522768bc0938" class="i field">PreserveSerializationSettingOfOriginal</a>,
                    <b>null</b>)
        {
        }
 
        <b>internal</b> <a id="3f60ac24e99dea52" href="../R/3f60ac24e99dea52.html" target="n" data-glyph="74,1" class="t constructor">SerializationContext</a>(<b>int</b> <span id="r2 rd" class="r2 r">depth</span>, <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a> <span id="r3 rd" class="r3 r">options</span>, <a href="../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r4 rd" class="r4 r">cryptoHelper</span>)
        {
            <b>if</b> (<span class="r2 r">depth</span> &lt; 1)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;writer&quot;</span>, <span class="i">Serialization</span>.<span class="i">DepthOfOneRequired</span>);
            }
 
            <a href="#79c883e3ce596f80" class="k">this</a>.<a href="#c1c4fb8b0dbf05f1" class="i field">depth</a> = <span class="r2 r">depth</span>;
            <a href="#79c883e3ce596f80" class="k">this</a>.<a href="#0b378b732b3e7999" class="i field">options</a> = <span class="r3 r">options</span>;
            <a href="#79c883e3ce596f80" class="k">this</a>.<a href="#c21b92cb57f02d95" class="i field">cryptoHelper</a> = <span class="r4 r">cryptoHelper</span>;
        }
 
        <b>internal readonly int</b> <a id="c1c4fb8b0dbf05f1" href="../R/c1c4fb8b0dbf05f1.html" target="n" data-glyph="44,1" class="i field">depth</a>;
        <b>internal readonly</b> <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a> <a id="0b378b732b3e7999" href="../R/0b378b732b3e7999.html" target="n" data-glyph="44,1" class="i field">options</a>;
        <b>internal readonly</b> <a href="../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <a id="c21b92cb57f02d95" href="../R/c21b92cb57f02d95.html" target="n" data-glyph="44,1" class="i field">cryptoHelper</a>;
 
        <b>internal readonly</b> <a href="#d9ec555b6b4102e1" class="t t">CimClassSerializationCache</a>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>&gt; <a id="77bf2d2571a5b997" href="../R/77bf2d2571a5b997.html" target="n" data-glyph="44,1" class="i field">cimClassSerializationIdCache</a> = <b>new</b> <span class="t">CimClassSerializationCache</span>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>&gt;();
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class provides public functionality for serializing a PSObject.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="9342c13ff4bbe3fb" href="../R/9342c13ff4bbe3fb.html" target="n" data-glyph="0,0" class="t t">PSSerializer</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes an object into PowerShell CliXml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The input object to serialize. Serializes to a default depth of 1.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The serialized object, as CliXml.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="a542e9acc69529dc" href="../R/a542e9acc69529dc.html" target="n" data-glyph="72,1" class="i method">Serialize</a>(<b>object</b> <span id="r5 rd" class="r5 r">source</span>)
        {
            <b>return</b> <a href="#d731b8ad94cf083a" class="i method">Serialize</a>(<span class="r5 r">source</span>, <a href="#84db711ec131e1b0" class="i field">s_mshDefaultSerializationDepth</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes an object into PowerShell CliXml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The input object to serialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The depth of the members to serialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The serialized object, as CliXml.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="d731b8ad94cf083a" href="../R/d731b8ad94cf083a.html" target="n" data-glyph="72,1" class="i method">Serialize</a>(<b>object</b> <span id="r6 rd" class="r6 r">source</span>, <b>int</b> <span id="r7 rd" class="r7 r">depth</span>)
        {
            <span class="c">// Create an xml writer</span>
            <span class="i">StringBuilder</span> <span id="r8 rd" class="r8 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="i">XmlWriterSettings</span> <span id="r9 rd" class="r9 r">xmlSettings</span> = <b>new</b> <span class="i">XmlWriterSettings</span>();
            <span class="r9 r">xmlSettings</span>.<span class="i">CloseOutput</span> = <b>true</b>;
            <span class="r9 r">xmlSettings</span>.<span class="i">Encoding</span> = <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">Encoding</span>.<span class="i">Unicode</span>;
            <span class="r9 r">xmlSettings</span>.<span class="i">Indent</span> = <b>true</b>;
            <span class="r9 r">xmlSettings</span>.<span class="i">OmitXmlDeclaration</span> = <b>true</b>;
            <span class="i">XmlWriter</span> <span id="r10 rd" class="r10 r">xw</span> = <span class="i">XmlWriter</span>.<span class="i">Create</span>(<span class="r8 r">sb</span>, <span class="r9 r">xmlSettings</span>);
 
            <span class="c">// Serialize the objects</span>
            <a href="#13699f4bba06caeb" class="t t">Serializer</a> <span id="r11 rd" class="r11 r">serializer</span> = <b>new</b> <a href="#b297dcffcd4a5426" class="t constructor">Serializer</a>(<span class="r10 r">xw</span>, <span class="r7 r">depth</span>, <b>true</b>);
            <span class="r11 r">serializer</span>.<a href="#cc6dbb8452db3a50" class="i method">Serialize</a>(<span class="r6 r">source</span>);
            <span class="r11 r">serializer</span>.<a href="#bba68ce5b6414f8d" class="i method">Done</a>();
            <span class="r11 r">serializer</span> = <b>null</b>;
 
            <span class="c">// Return the output</span>
            <b>return</b> <span class="r8 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserializes PowerShell CliXml into an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The CliXml the represents the object to deserialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An object that represents the serialized content.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static object</b> <a id="d9210d35690d435f" href="../R/d9210d35690d435f.html" target="n" data-glyph="72,1" class="i method">Deserialize</a>(<b>string</b> <span id="r12 rd" class="r12 r">source</span>)
        {
            <b>object</b>[] <span id="r13 rd" class="r13 r">results</span> = <a href="#2a50b32f3c1fc21d" class="i method">DeserializeAsList</a>(<span class="r12 r">source</span>);
 
            <span class="c">// Return the results</span>
            <b>if</b> (<span class="r13 r">results</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
            <b>else</b> <b>if</b> (<span class="r13 r">results</span>.<span class="i">Length</span> == 1)
            {
                <b>return</b> <span class="r13 r">results</span>[0];
            }
            <b>else</b>
            {
                <b>return</b> <span class="r13 r">results</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserializes PowerShell CliXml into a list of objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The CliXml the represents the object to deserialize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An object array represents the serialized content.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static object</b>[] <a id="2a50b32f3c1fc21d" href="../R/2a50b32f3c1fc21d.html" target="n" data-glyph="72,1" class="i method">DeserializeAsList</a>(<b>string</b> <span id="r14 rd" class="r14 r">source</span>)
        {
            <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r15 rd" class="r15 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <span class="c">// Create the text reader to hold the content</span>
            <span class="i">TextReader</span> <span id="r16 rd" class="r16 r">textReader</span> = <b>new</b> <span class="i">StringReader</span>(<span class="r14 r">source</span>);
            <span class="i">XmlReader</span> <span id="r17 rd" class="r17 r">xmlReader</span> = <span class="i">XmlReader</span>.<span class="i">Create</span>(<span class="r16 r">textReader</span>, <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#68d86b2b9f57584d" class="i property">XmlReaderSettingsForCliXml</a>);
 
            <span class="c">// Deserialize the content</span>
            <a href="#27835b221aec7524" class="t t">Deserializer</a> <span id="r18 rd" class="r18 r">deserializer</span> = <b>new</b> <a href="#37284915ff9862dc" class="t constructor">Deserializer</a>(<span class="r17 r">xmlReader</span>);
            <b>while</b> (!<span class="r18 r">deserializer</span>.<a href="#6c4195591a1a2219" class="i method">Done</a>())
            {
                <b>object</b> <span id="r19 rd" class="r19 r">result</span> = <span class="r18 r">deserializer</span>.<a href="#9c920943c97004d6" class="i method">Deserialize</a>();
                <span class="r15 r">results</span>.<span class="i">Add</span>(<span class="r19 r">result</span>);
            }
 
            <b>return</b> <span class="r15 r">results</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default depth of serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly int</b> <a id="84db711ec131e1b0" href="../R/84db711ec131e1b0.html" target="n" data-glyph="46,1" class="i field">s_mshDefaultSerializationDepth</a> = 1;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class provides functionality for serializing a PSObject.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="13699f4bba06caeb" href="../R/13699f4bba06caeb.html" target="n" data-glyph="2,0" class="t t">Serializer</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <b>private readonly</b> <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <a id="c567a31c70b2f5d7" href="../R/c567a31c70b2f5d7.html" target="n" data-glyph="46,1" class="i field">_serializer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a Serializer using default serialization context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">writer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Writer to be used for serialization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="22140f8580b3e7d0" href="../R/22140f8580b3e7d0.html" target="n" data-glyph="74,1" class="t constructor">Serializer</a>(<span class="i">XmlWriter</span> <span id="r20 rd" class="r20 r">writer</span>)
            : <a href="#376bd173af9e5a9e" class="k">this</a>(<span class="r20 r">writer</span>, <b>new</b> <a href="#df66d7e7cbe0762e" class="t constructor">SerializationContext</a>())
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a Serializer using specified serialization context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">writer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Writer to be used for serialization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Depth of serialization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">useDepthFromTypes</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> then types.ps1xml can override depth</span>
        <span class="c">///</span><span class="c"> for a particular types (using SerializationDepth property)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="b297dcffcd4a5426" href="../R/b297dcffcd4a5426.html" target="n" data-glyph="74,1" class="t constructor">Serializer</a>(<span class="i">XmlWriter</span> <span id="r21 rd" class="r21 r">writer</span>, <b>int</b> <span id="r22 rd" class="r22 r">depth</span>, <b>bool</b> <span id="r23 rd" class="r23 r">useDepthFromTypes</span>)
            : <a href="#376bd173af9e5a9e" class="k">this</a>(<span class="r21 r">writer</span>, <b>new</b> <a href="#3ea77a9b3b14b98a" class="t constructor">SerializationContext</a>(<span class="r22 r">depth</span>, <span class="r23 r">useDepthFromTypes</span>))
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a Serializer using specified serialization context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">writer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Writer to be used for serialization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="376bd173af9e5a9e" href="../R/376bd173af9e5a9e.html" target="n" data-glyph="74,1" class="t constructor">Serializer</a>(<span class="i">XmlWriter</span> <span id="r24 rd" class="r24 r">writer</span>, <a href="#79c883e3ce596f80" class="t t">SerializationContext</a> <span id="r25 rd" class="r25 r">context</span>)
        {
            <b>if</b> (<span class="r24 r">writer</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r24 r">writer</span>));
            }
 
            <b>if</b> (<span class="r25 r">context</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r25 r">context</span>));
            }
 
            <a href="#c567a31c70b2f5d7" class="i field">_serializer</a> = <b>new</b> <a href="#7913854327b55d00" class="t constructor">InternalSerializer</a>(<span class="r24 r">writer</span>, <span class="r25 r">context</span>);
            <a href="#c567a31c70b2f5d7" class="i field">_serializer</a>.<a href="#12685c8e0ed4b53c" class="i method">Start</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public methods / properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Remoting infrastructure. This TypeTable instance</span>
        <span class="c">///</span><span class="c"> will be used by Serializer if ExecutionContext is not</span>
        <span class="c">///</span><span class="c"> available (to get the ExecutionContext&#39;s TypeTable)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="0473f77f694bec48" href="../R/0473f77f694bec48.html" target="n" data-glyph="104,1" class="i property">TypeTable</a>
        {
            <b>get</b> { <b>return</b> <a href="#c567a31c70b2f5d7" class="i field">_serializer</a>.<a href="#2e47e80e3c94a49d" class="i property">TypeTable</a>; }
 
            <b>set</b> { <a href="#c567a31c70b2f5d7" class="i field">_serializer</a>.<a href="#2e47e80e3c94a49d" class="i property">TypeTable</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to be serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Please note that this method shouldn&#39;t throw any exceptions.</span>
        <span class="c">///</span><span class="c"> If it throws - please open a bug.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="cc6dbb8452db3a50" href="../R/cc6dbb8452db3a50.html" target="n" data-glyph="74,1" class="i method">Serialize</a>(<b>object</b> <span id="r26 rd" class="r26 r">source</span>)
        {
            <a href="#6c84aa2973001274" class="i method">Serialize</a>(<span class="r26 r">source</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes passed in object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> object to be serialized</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stream to which this object belong. Ex: Output, Error etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Please note that this method shouldn&#39;t throw any exceptions.</span>
        <span class="c">///</span><span class="c"> If it throws - please open a bug.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="6c84aa2973001274" href="../R/6c84aa2973001274.html" target="n" data-glyph="74,1" class="i method">Serialize</a>(<b>object</b> <span id="r27 rd" class="r27 r">source</span>, <b>string</b> <span id="r28 rd" class="r28 r">streamName</span>)
        {
            <a href="#c567a31c70b2f5d7" class="i field">_serializer</a>.<a href="#ef372778f5b989d3" class="i method">WriteOneTopLevelObject</a>(<span class="r27 r">source</span>, <span class="r28 r">streamName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write the end of root element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="bba68ce5b6414f8d" href="../R/bba68ce5b6414f8d.html" target="n" data-glyph="74,1" class="i method">Done</a>()
        {
            <a href="#c567a31c70b2f5d7" class="i field">_serializer</a>.<a href="#14e68b4df282baff" class="i method">End</a>();
        }
 
        <b>internal void</b> <a id="edc109da98265455" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Stop</a>()
        {
            <a href="#c567a31c70b2f5d7" class="i field">_serializer</a>.<a href="#1a7ff90318da3d16" class="i method">Stop</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    [<span class="i">Flags</span>]
    <b>internal enum</b> <a id="86f09565e15eea0d" href="../R/86f09565e15eea0d.html" target="n" data-glyph="20,0" class="t t"><span id="97f0b237388a9a51">DeserializationOptions</span></a>
    {
        <a id="61919102105ea120" href="../R/61919102105ea120.html" target="n" data-glyph="24,1" class="i field">None</a> = 0,
        <a id="aad250faa6301c20" href="../R/aad250faa6301c20.html" target="n" data-glyph="24,1" class="i field">NoRootElement</a> = 256,            <span class="c">// I start at 256 to try not to overlap</span>
        <a id="aad1d17c95369a50" href="../R/aad1d17c95369a50.html" target="n" data-glyph="24,1" class="i field">NoNamespace</a> = 512,              <span class="c">// with SerializationOptions and to catch bugs early</span>
        <a id="5d8ca67651daec75" href="../R/5d8ca67651daec75.html" target="n" data-glyph="24,1" class="i field">DeserializeScriptBlocks</a> = 1024,
 
        <a id="a1ad9dfbc869055b" href="../R/a1ad9dfbc869055b.html" target="n" data-glyph="24,1" class="i field">RemotingOptions</a> = <a href="#aad250faa6301c20" class="i field">NoRootElement</a> | <a href="#aad1d17c95369a50" class="i field">NoNamespace</a>,
    }
 
    <b>internal class</b> <a id="37cfb1b61ebb243c" href="../R/37cfb1b61ebb243c.html" target="n" data-glyph="2,0" class="t t">DeserializationContext</a>
    {
        <b>internal</b> <a id="3fce2cd28a249202" href="../R/3fce2cd28a249202.html" target="n" data-glyph="74,1" class="t constructor">DeserializationContext</a>()
            : <a href="#46080f485c381413" class="k">this</a>(<a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#61919102105ea120" class="i field">None</a>, <b>null</b>)
        {
        }
 
        <b>internal</b> <a id="46080f485c381413" href="../R/46080f485c381413.html" target="n" data-glyph="74,1" class="t constructor">DeserializationContext</a>(<a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a> <span id="r29 rd" class="r29 r">options</span>, <a href="../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r30 rd" class="r30 r">cryptoHelper</span>)
        {
            <a href="#37cfb1b61ebb243c" class="k">this</a>.<a href="#e467cab010ecbea0" class="i field">options</a> = <span class="r29 r">options</span>;
            <a href="#37cfb1b61ebb243c" class="k">this</a>.<a href="#2b047c538ceb6fdb" class="i field">cryptoHelper</a> = <span class="r30 r">cryptoHelper</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Limits the total data processed by the deserialization context. Deserialization context</span>
        <span class="c">///</span><span class="c"> is used by PriorityReceivedDataCollection (remoting) to process incoming data from the</span>
        <span class="c">///</span><span class="c"> remote end. A value of Null means that the max memory is unlimited.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b>? <a id="7f867777951adff9" href="../R/7f867777951adff9.html" target="n" data-glyph="104,1" class="i property">MaximumAllowedMemory</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Logs that memory used by deserialized objects is not related to the size of input xml.</span>
        <span class="c">///</span><span class="c"> Used mainly to account for memory usage of cloned TypeNames when calculating memory quota usage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">amountOfExtraMemory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="6dc6155a687f39b4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LogExtraMemoryUsage</a>(<b>int</b> <span id="r31 rd" class="r31 r">amountOfExtraMemory</span>)
        {
            <b>if</b> (<span class="r31 r">amountOfExtraMemory</span> &lt; 0)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#7f867777951adff9" class="i property">MaximumAllowedMemory</a>.<span class="i">HasValue</span>)
            {
                <b>if</b> (<span class="r31 r">amountOfExtraMemory</span> &gt; (<a href="#7f867777951adff9" class="i property">MaximumAllowedMemory</a>.<span class="i">Value</span> - <a href="#c62c3b9e17056f05" class="i field">_totalDataProcessedSoFar</a>))
                {
                    <b>string</b> <span id="r32 rd" class="r32 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Serialization</span>.<span class="i">DeserializationMemoryQuota</span>, ((<b>double</b>)<a href="#7f867777951adff9" class="i property">MaximumAllowedMemory</a>.<span class="i">Value</span>) / (1 &lt;&lt; 20),
                                                       <a href="remoting/fanin/InitialSessionStateProvider.cs.html#88c11924f622f7f5" class="t t">ConfigurationDataFromXML</a>.<a href="remoting/fanin/InitialSessionStateProvider.cs.html#c178a6c8ed3a39ae" class="i field">MAXRCVDOBJSIZETOKEN_CamelCase</a>,
                                                       <a href="remoting/fanin/InitialSessionStateProvider.cs.html#88c11924f622f7f5" class="t t">ConfigurationDataFromXML</a>.<a href="remoting/fanin/InitialSessionStateProvider.cs.html#032fee811b4f0028" class="i field">MAXRCVDCMDSIZETOKEN_CamelCase</a>);
                    <b>throw</b> <b>new</b> <span class="i">XmlException</span>(<span class="r32 r">message</span>);
                }
 
                <a href="#c62c3b9e17056f05" class="i field">_totalDataProcessedSoFar</a> += <span class="r31 r">amountOfExtraMemory</span>;
            }
        }
 
        <b>private int</b> <a id="c62c3b9e17056f05" href="../R/c62c3b9e17056f05.html" target="n" data-glyph="46,1" class="i field">_totalDataProcessedSoFar</a>;
 
        <b>internal readonly</b> <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a> <a id="e467cab010ecbea0" href="../R/e467cab010ecbea0.html" target="n" data-glyph="44,1" class="i field">options</a>;
        <b>internal readonly</b> <a href="../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <a id="2b047c538ceb6fdb" href="../R/2b047c538ceb6fdb.html" target="n" data-glyph="44,1" class="i field">cryptoHelper</a>;
 
        <b>internal static readonly int</b> <a id="fe478ce7efd1281b" href="../R/fe478ce7efd1281b.html" target="n" data-glyph="44,1" class="i field">MaxItemsInCimClassCache</a> = 100;
        <b>internal readonly</b> <a href="#bccf4a9cc4d7e0ec" class="t t">CimClassDeserializationCache</a>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>&gt; <a id="dfc5e9b73463bf4d" href="../R/dfc5e9b73463bf4d.html" target="n" data-glyph="44,1" class="i field">cimClassSerializationIdCache</a> = <b>new</b> <span class="t">CimClassDeserializationCache</span>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>&gt;();
    }
 
    <b>internal class</b> <a id="bccf4a9cc4d7e0ec" href="../R/bccf4a9cc4d7e0ec.html" target="n" data-glyph="2,0" class="t t"><span id="bbf6c9ab16f412ae">CimClassDeserializationCache</span></a>&lt;<span id="r33 rd t" class="r33 r t">TKey</span>&gt;
    {
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<span class="r33 r t">TKey</span>, <span class="i">CimClass</span>&gt; <a id="f1186bc4399f3fd5" href="../R/f1186bc4399f3fd5.html" target="n" data-glyph="46,1" class="i field">_cimClassIdToClass</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="r33 r t">TKey</span>, <span class="i">CimClass</span>&gt;();
 
        <b>internal void</b> <a id="b42f8c180e8e7337" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddCimClassToCache</a>(<span class="r33 r t">TKey</span> <span id="r34 rd" class="r34 r">key</span>, <span class="i">CimClass</span> <span id="r35 rd" class="r35 r">cimClass</span>)
        {
            <b>if</b> (<a href="#f1186bc4399f3fd5" class="i field">_cimClassIdToClass</a>.<span class="i">Count</span> &gt;= <a href="#37cfb1b61ebb243c" class="t t">DeserializationContext</a>.<a href="#fe478ce7efd1281b" class="i field">MaxItemsInCimClassCache</a>)
            {
                <a href="#f1186bc4399f3fd5" class="i field">_cimClassIdToClass</a>.<span class="i">Clear</span>();
            }
 
            <a href="#f1186bc4399f3fd5" class="i field">_cimClassIdToClass</a>.<span class="i">Add</span>(<span class="r34 r">key</span>, <span class="r35 r">cimClass</span>);
 
            <span class="c">/* PRINTF DEBUG
            Console.WriteLine(&quot;Contents of deserialization cache (after a call to AddCimClassToCache ({0})):&quot;, key);
            Console.WriteLine(&quot;  Count = {0}&quot;, this._cimClassIdToClass.Count);
            foreach (var t in this._cimClassIdToClass.Keys)
            {
                Console.WriteLine(&quot;  {0}&quot;, t);
            }
             */</span>
        }
 
        <b>internal</b> <span class="i">CimClass</span> <a id="e081cd1ae8339d4c" href="../R/e081cd1ae8339d4c.html" target="n" data-glyph="74,1" class="i method">GetCimClassFromCache</a>(<span class="r33 r t">TKey</span> <span id="r36 rd" class="r36 r">key</span>)
        {
            <span class="i">CimClass</span> <span id="r37 rd" class="r37 r">cimClass</span>;
            <b>if</b> (<a href="#f1186bc4399f3fd5" class="i field">_cimClassIdToClass</a>.<span class="i">TryGetValue</span>(<span class="r36 r">key</span>, <b>out</b> <span class="r37 r">cimClass</span>))
            {
                <span class="c">/* PRINTF DEBUG
                Console.WriteLine(&quot;GetCimClassFromCache - class found: {0}&quot;, key);
                 */</span>
 
                <b>return</b> <span class="r37 r">cimClass</span>;
            }
 
            <span class="c">/* PRINTF DEBUG
            Console.WriteLine(&quot;GetCimClassFromCache - class NOT found: {0}&quot;, key);
             */</span>
 
            <b>return</b> <b>null</b>;
        }
    }
 
    <b>internal class</b> <a id="d9ec555b6b4102e1" href="../R/d9ec555b6b4102e1.html" target="n" data-glyph="2,0" class="t t"><span id="7fa8225f4179437a">CimClassSerializationCache</span></a>&lt;<span id="r38 rd t" class="r38 r t">TKey</span>&gt;
    {
        <b>private readonly</b> <span class="i">HashSet</span>&lt;<span class="r38 r t">TKey</span>&gt; <a id="63346cbf83c0a847" href="../R/63346cbf83c0a847.html" target="n" data-glyph="46,1" class="i field">_cimClassesHeldByDeserializer</a> = <b>new</b> <span class="i">HashSet</span>&lt;<span class="r38 r t">TKey</span>&gt;(<span class="i">EqualityComparer</span>&lt;<span class="r38 r t">TKey</span>&gt;.<span class="i">Default</span>);
 
        <b>internal bool</b> <a id="dfefd2d6e0c96df4" href="../R/dfefd2d6e0c96df4.html" target="n" data-glyph="74,1" class="i method">DoesDeserializerAlreadyHaveCimClass</a>(<span class="r38 r t">TKey</span> <span id="r39 rd" class="r39 r">key</span>)
        {
            <b>return</b> <a href="#63346cbf83c0a847" class="i field">_cimClassesHeldByDeserializer</a>.<span class="i">Contains</span>(<span class="r39 r">key</span>);
        }
 
        <b>internal void</b> <a id="fa080504f32d01e3" href="../R/fa080504f32d01e3.html" target="n" data-glyph="74,1" class="i method">AddClassToCache</a>(<span class="r38 r t">TKey</span> <span id="r40 rd" class="r40 r">key</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<a href="#63346cbf83c0a847" class="i field">_cimClassesHeldByDeserializer</a>.<span class="i">Contains</span>(<span class="r40 r">key</span>), <span class="s">&quot;This method should not be called for classes already in the cache&quot;</span>);
 
            <b>if</b> (<a href="#63346cbf83c0a847" class="i field">_cimClassesHeldByDeserializer</a>.<span class="i">Count</span> &gt;= <a href="#37cfb1b61ebb243c" class="t t">DeserializationContext</a>.<a href="#fe478ce7efd1281b" class="i field">MaxItemsInCimClassCache</a>)
            {
                <a href="#63346cbf83c0a847" class="i field">_cimClassesHeldByDeserializer</a>.<span class="i">Clear</span>();
            }
 
            <a href="#63346cbf83c0a847" class="i field">_cimClassesHeldByDeserializer</a>.<span class="i">Add</span>(<span class="r40 r">key</span>);
 
            <span class="c">/* PRINTF DEBUG
            Console.WriteLine(&quot;Contents of serialization cache (after adding {0}):&quot;, key);
            Console.WriteLine(&quot;  Count = {0}&quot;, this._cimClassesHeldByDeserializer.Count);
            foreach (var t in _cimClassesHeldByDeserializer)
            {
                Console.WriteLine(&quot;  {0}&quot;, t);
            }
             */</span>
        }
    }
 
    <b>internal class</b> <a id="7bb70d53703a06b9" href="../R/7bb70d53703a06b9.html" target="n" data-glyph="2,0" class="t t">CimClassSerializationId</a> : <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>, <b>string</b>, <b>int</b>&gt;
    {
        <b>public</b> <a id="8e6c8590112b2f4a" href="../R/8e6c8590112b2f4a.html" target="n" data-glyph="72,1" class="t constructor">CimClassSerializationId</a>(<b>string</b> <span id="r41 rd" class="r41 r">className</span>, <b>string</b> <span id="r42 rd" class="r42 r">namespaceName</span>, <b>string</b> <span id="r43 rd" class="r43 r">computerName</span>, <b>int</b> <span id="r44 rd" class="r44 r">hashCode</span>)
            : <b>base</b>(<span class="r41 r">className</span>, <span class="r42 r">namespaceName</span>, <span class="r43 r">computerName</span>, <span class="r44 r">hashCode</span>)
        {
        }
 
        <b>public string</b> <a id="f447b3c8293864f8" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ClassName</a> { <b>get</b> { <b>return</b> <a href="#7bb70d53703a06b9" class="k">this</a>.<span class="i">Item1</span>; } }
 
        <b>public string</b> <a id="f759dfd225b62f45" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NamespaceName</a> { <b>get</b> { <b>return</b> <a href="#7bb70d53703a06b9" class="k">this</a>.<span class="i">Item2</span>; } }
 
        <b>public string</b> <a id="5e3002267f87891c" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ComputerName</a> { <b>get</b> { <b>return</b> <a href="#7bb70d53703a06b9" class="k">this</a>.<span class="i">Item3</span>; } }
 
        <b>public int</b> <a id="8317a042347d6e9b" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ClassHashCode</a> { <b>get</b> { <b>return</b> <a href="#7bb70d53703a06b9" class="k">this</a>.<span class="i">Item4</span>; } }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class provides functionality for deserializing a PSObject.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="27835b221aec7524" href="../R/27835b221aec7524.html" target="n" data-glyph="2,0" class="t t">Deserializer</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <b>private readonly</b> <span class="i">XmlReader</span> <a id="942f8605b2df5c2d" href="../R/942f8605b2df5c2d.html" target="n" data-glyph="46,1" class="i field">_reader</a>;
        <b>private readonly</b> <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <a id="bc11e827e22ab6e0" href="../R/bc11e827e22ab6e0.html" target="n" data-glyph="46,1" class="i field">_deserializer</a>;
        <b>private readonly</b> <a href="#37cfb1b61ebb243c" class="t t">DeserializationContext</a> <a id="4f76bfb91ca54545" href="../R/4f76bfb91ca54545.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a Deserializer using default deserialization context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">reader</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reader to be used for deserialization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when the xml is in an incorrect format</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="37284915ff9862dc" href="../R/37284915ff9862dc.html" target="n" data-glyph="74,1" class="t constructor">Deserializer</a>(<span class="i">XmlReader</span> <span id="r45 rd" class="r45 r">reader</span>)
            : <a href="#5e9778c61a3e1718" class="k">this</a>(<span class="r45 r">reader</span>, <b>new</b> <a href="#3fce2cd28a249202" class="t constructor">DeserializationContext</a>())
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a Deserializer using specified serialization context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">reader</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reader to be used for deserialization.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when the xml is in an incorrect format</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="5e9778c61a3e1718" href="../R/5e9778c61a3e1718.html" target="n" data-glyph="74,1" class="t constructor">Deserializer</a>(<span class="i">XmlReader</span> <span id="r46 rd" class="r46 r">reader</span>, <a href="#37cfb1b61ebb243c" class="t t">DeserializationContext</a> <span id="r47 rd" class="r47 r">context</span>)
        {
            <b>if</b> (<span class="r46 r">reader</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r46 r">reader</span>));
            }
 
            <a href="#942f8605b2df5c2d" class="i field">_reader</a> = <span class="r46 r">reader</span>;
            <a href="#4f76bfb91ca54545" class="i field">_context</a> = <span class="r47 r">context</span>;
            <a href="#bc11e827e22ab6e0" class="i field">_deserializer</a> = <b>new</b> <a href="#2f9f6b8275a60b00" class="t constructor">InternalDeserializer</a>(<a href="#942f8605b2df5c2d" class="i field">_reader</a>, <a href="#4f76bfb91ca54545" class="i field">_context</a>);
 
            <b>try</b>
            {
                <a href="#6bf920fc919306de" class="i method">Start</a>();
            }
            <b>catch</b> (<span class="i">XmlException</span> <span id="r48 rd" class="r48 r">exception</span>)
            {
                <a href="#d7fc92376467bbf4" class="i method">ReportExceptionForETW</a>(<span class="r48 r">exception</span>);
                <b>throw</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public method / properties
 
        <b>private static void</b> <a id="d7fc92376467bbf4" href="../R/d7fc92376467bbf4.html" target="n" data-glyph="76,1" class="i method">ReportExceptionForETW</a>(<span class="i">XmlException</span> <span id="r49 rd" class="r49 r">exception</span>)
        {
            <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticError</span>(
                <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#ce6f8066f343e9c8" class="i field">Serializer_XmlExceptionWhenDeserializing</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                <span class="r49 r">exception</span>.<span class="i">LineNumber</span>, <span class="r49 r">exception</span>.<span class="i">LinePosition</span>, <span class="r49 r">exception</span>.<span class="i">ToString</span>());
        }
 
        <b>private bool</b> <a id="c99c7fdb61f0d898" href="../R/c99c7fdb61f0d898.html" target="n" data-glyph="46,1" class="i field">_done</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Remoting infrastructure. This TypeTable instance</span>
        <span class="c">///</span><span class="c"> will be used by Deserializer if ExecutionContext is not</span>
        <span class="c">///</span><span class="c"> available (to get the ExecutionContext&#39;s TypeTable)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="abf98a1b60c17b76" href="../R/abf98a1b60c17b76.html" target="n" data-glyph="104,1" class="i property">TypeTable</a>
        {
            <b>get</b> { <b>return</b> <a href="#bc11e827e22ab6e0" class="i field">_deserializer</a>.<a href="#1d13bccdd5eddd80" class="i property">TypeTable</a>; }
 
            <b>set</b> { <a href="#bc11e827e22ab6e0" class="i field">_deserializer</a>.<a href="#1d13bccdd5eddd80" class="i property">TypeTable</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read the root element tag and set the cursor to start tag of</span>
        <span class="c">///</span><span class="c"> first object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="6bf920fc919306de" href="../R/6bf920fc919306de.html" target="n" data-glyph="76,1" class="i method">Start</a>()
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">ReadState</span> == <span class="i">ReadState</span>.<span class="i">Initial</span>, <span class="s">&quot;When deserialization starts we should have XmlReader.ReadState == Initial&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">None</span>, <span class="s">&quot;When deserialization starts we should have XmlReader.NodeType == None&quot;</span>);
            <a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">Read</span>();
 
            <span class="c">// If version is not provided, we assume it is the default</span>
            <b>string</b> <span id="r50 rd" class="r50 r">version</span> = <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<a href="#f5e0019810010474" class="i field">DefaultVersion</a>;
            <b>if</b> ((<a href="#4f76bfb91ca54545" class="i field">_context</a>.<a href="#e467cab010ecbea0" class="i field">options</a> &amp; <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad250faa6301c20" class="i field">NoRootElement</a>) == <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad250faa6301c20" class="i field">NoRootElement</a>)
            {
                <a href="#c99c7fdb61f0d898" class="i field">_done</a> = <a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">EOF</span>;
            }
            <b>else</b>
            {
                <span class="c">// Make sure the reader is positioned on the root ( &lt;Objs&gt; ) element (not on XmlDeclaration for example)</span>
                <a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">MoveToContent</span>();
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">EOF</span> || (<a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>), <span class="s">&quot;When deserialization starts reading we should have XmlReader.NodeType == Element&quot;</span>);
 
                <span class="c">// Read version attribute and validate it.</span>
                <b>string</b> <span id="r51 rd" class="r51 r">versionAttribute</span> = <a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">GetAttribute</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#0c0f9a5653031b06" class="i field">VersionAttribute</a>);
                <b>if</b> (<span class="r51 r">versionAttribute</span> != <b>null</b>)
                {
                    <span class="r50 r">version</span> = <span class="r51 r">versionAttribute</span>;
                }
 
                <span class="c">// If the root element tag is empty, there are no objects to read.</span>
                <b>if</b> (!<a href="#bc11e827e22ab6e0" class="i field">_deserializer</a>.<a href="#c80a7e45efc82f44" class="i method">ReadStartElementAndHandleEmpty</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fd92e664835c5f57" class="i field">RootElementTag</a>))
                {
                    <a href="#c99c7fdb61f0d898" class="i field">_done</a> = <b>true</b>;
                }
            }
 
            <a href="#bc11e827e22ab6e0" class="i field">_deserializer</a>.<a href="#f6871f054a285115" class="i method">ValidateVersion</a>(<span class="r50 r">version</span>);
        }
 
        <b>internal bool</b> <a id="6c4195591a1a2219" href="../R/6c4195591a1a2219.html" target="n" data-glyph="74,1" class="i method">Done</a>()
        {
            <b>if</b> (!<a href="#c99c7fdb61f0d898" class="i field">_done</a>)
            {
                <b>if</b> ((<a href="#4f76bfb91ca54545" class="i field">_context</a>.<a href="#e467cab010ecbea0" class="i field">options</a> &amp; <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad250faa6301c20" class="i field">NoRootElement</a>) == <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad250faa6301c20" class="i field">NoRootElement</a>)
                {
                    <a href="#c99c7fdb61f0d898" class="i field">_done</a> = <a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">EOF</span>;
                }
                <b>else</b>
                {
                    <b>if</b> (<a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">EndElement</span>)
                    {
                        <b>try</b>
                        {
                            <a href="#942f8605b2df5c2d" class="i field">_reader</a>.<span class="i">ReadEndElement</span>();
                        }
                        <b>catch</b> (<span class="i">XmlException</span> <span id="r52 rd" class="r52 r">exception</span>)
                        {
                            <a href="#d7fc92376467bbf4" class="i method">ReportExceptionForETW</a>(<span class="r52 r">exception</span>);
                            <b>throw</b>;
                        }
 
                        <a href="#c99c7fdb61f0d898" class="i field">_done</a> = <b>true</b>;
                    }
                }
            }
 
            <b>return</b> <a href="#c99c7fdb61f0d898" class="i field">_done</a>;
        }
 
        <b>internal void</b> <a id="13f76f0f5390c22b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Stop</a>()
        {
            <a href="#bc11e827e22ab6e0" class="i field">_deserializer</a>.<a href="#5ec5b317d34534df" class="i method">Stop</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserializes next object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when the xml is in an incorrect format</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="9c920943c97004d6" href="../R/9c920943c97004d6.html" target="n" data-glyph="74,1" class="i method">Deserialize</a>()
        {
            <b>string</b> <span id="r53 rd" class="r53 r">ignore</span>;
            <b>return</b> <a href="#dc4acd0343de04bd" class="i method">Deserialize</a>(<b>out</b> <span class="r53 r">ignore</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserializes next object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Stream the object belongs to (i.e. &quot;Error&quot;, &quot;Output&quot;, etc.).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when the xml is in an incorrect format</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="dc4acd0343de04bd" href="../R/dc4acd0343de04bd.html" target="n" data-glyph="74,1" class="i method">Deserialize</a>(<b>out string</b> <span id="r54 rd" class="r54 r">streamName</span>)
        {
            <b>if</b> (<a href="#6c4195591a1a2219" class="i method">Done</a>())
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">Serialization</span>.<span class="i">ReadCalledAfterDone</span>);
            }
 
            <b>try</b>
            {
                <b>return</b> <a href="#bc11e827e22ab6e0" class="i field">_deserializer</a>.<a href="#137459e4dd08e6e3" class="i method">ReadOneObject</a>(<b>out</b> <span class="r54 r">streamName</span>);
            }
            <b>catch</b> (<span class="i">XmlException</span> <span id="r55 rd" class="r55 r">exception</span>)
            {
                <a href="#d7fc92376467bbf4" class="i method">ReportExceptionForETW</a>(<span class="r55 r">exception</span>);
                <b>throw</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helper methods for dealing with &quot;Deserialized.&quot; prefix
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds &quot;Deserialized.&quot; prefix to passed in argument if not already present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="db7dc44760507147" href="../R/db7dc44760507147.html" target="n" data-glyph="74,1" class="i method">AddDeserializationPrefix</a>(<b>ref string</b> <span id="r56 rd" class="r56 r">type</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r56 r">type</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <b>if</b> (!<span class="r56 r">type</span>.<span class="i">StartsWith</span>(<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r56 r">type</span> = <span class="r56 r">type</span>.<span class="i">Insert</span>(0, <a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if an object </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">o</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is either a live or deserialized instance of class </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or one of its subclasses.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">o</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">o</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is either a live or deserialized instance of class </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or one of its subclasses;  </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">false</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="7bec95e359ff0b0e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsInstanceOfType</a>(<b>object</b> <span id="r57 rd" class="r57 r">o</span>, <span class="i">Type</span> <span id="r58 rd" class="r58 r">type</span>)
        {
            <b>if</b> (<span class="r58 r">type</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r58 r">type</span>));
            }
 
            <b>if</b> (<span class="r57 r">o</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <span class="r58 r">type</span>.<span class="i">IsInstanceOfType</span>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r57 r">o</span>)) || <a href="#bedc3ec1f782a8e0" class="i method">IsDeserializedInstanceOfType</a>(<span class="r57 r">o</span>, <span class="r58 r">type</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if an object </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">o</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is a deserialized instance of class </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or one of its subclasses.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">o</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">o</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is a deserialized instance of class </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or one of its subclasses;  </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">false</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="bedc3ec1f782a8e0" href="../R/bedc3ec1f782a8e0.html" target="n" data-glyph="74,1" class="i method">IsDeserializedInstanceOfType</a>(<b>object</b> <span id="r59 rd" class="r59 r">o</span>, <span class="i">Type</span> <span id="r60 rd" class="r60 r">type</span>)
        {
            <b>if</b> (<span class="r60 r">type</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r60 r">type</span>));
            }
 
            <b>if</b> (<span class="r59 r">o</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r61 rd" class="r61 r">pso</span> = <span class="r59 r">o</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <b>if</b> (<span class="r61 r">pso</span> != <b>null</b>)
            {
                <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r62 rd" class="r62 r">typeNames</span> = <span class="r61 r">pso</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
                <b>if</b> (<span class="r62 r">typeNames</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>string</b> <span id="r63 rd" class="r63 r">typeName</span> <b>in</b> <span class="r62 r">typeNames</span>)
                    {
                        <b>if</b> (<span class="r63 r">typeName</span>.<span class="i">Length</span> == <a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>.<span class="i">Length</span> + <span class="r60 r">type</span>.<span class="i">FullName</span>.<span class="i">Length</span> &amp;&amp;
                            <span class="r63 r">typeName</span>.<span class="i">StartsWith</span>(<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                            <span class="r63 r">typeName</span>.<span class="i">EndsWith</span>(<span class="r60 r">type</span>.<span class="i">FullName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>return</b> <b>true</b>;
                        }
                    }
                }
            }
 
            <span class="c">// not the right type</span>
            <b>return</b> <b>false</b>;
        }
 
        <b>internal static string</b> <a id="d085fa30e43177dc" href="../R/d085fa30e43177dc.html" target="n" data-glyph="74,1" class="i method">MaskDeserializationPrefix</a>(<b>string</b> <span id="r64 rd" class="r64 r">typeName</span>)
        {
            <b>if</b> (<span class="r64 r">typeName</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r64 r">typeName</span>.<span class="i">StartsWith</span>(<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r64 r">typeName</span> = <span class="r64 r">typeName</span>.<span class="i">Substring</span>(<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>.<span class="i">Length</span>);
            }
 
            <b>return</b> <span class="r64 r">typeName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a new collection of typenames without &quot;Deserialization.&quot; prefix</span>
        <span class="c">///</span><span class="c"> in the typename. This will allow to map type info/format info of the orignal type</span>
        <span class="c">///</span><span class="c"> for deserialized objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">typeNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Null if no type with &quot;Deserialized.&quot; prefix is found.</span>
        <span class="c">///</span><span class="c"> Otherwise </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">typeNames</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> with the prefix removed if any.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="45bdab4e36ddc906" href="../R/45bdab4e36ddc906.html" target="n" data-glyph="74,1" class="i method">MaskDeserializationPrefix</a>(<span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r65 rd" class="r65 r">typeNames</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r65 r">typeNames</span> != <b>null</b>, <span class="s">&quot;typeNames cannot be null&quot;</span>);
 
            <b>bool</b> <span id="r66 rd" class="r66 r">atleastOneDeserializedTypeFound</span> = <b>false</b>;
 
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r67 rd" class="r67 r">typesWithoutPrefix</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<b>string</b> <span id="r68 rd" class="r68 r">type</span> <b>in</b> <span class="r65 r">typeNames</span>)
            {
                <b>if</b> (<span class="r68 r">type</span>.<span class="i">StartsWith</span>(<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>,
                    <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r66 r">atleastOneDeserializedTypeFound</span> = <b>true</b>;
                    <span class="c">// remove *only* the prefix</span>
                    <span class="r67 r">typesWithoutPrefix</span>.<span class="i">Add</span>(<span class="r68 r">type</span>.<span class="i">Substring</span>(<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#d84dce3ed20e2ef7" class="i field">DeserializationTypeNamePrefix</a>.<span class="i">Length</span>));
                }
                <b>else</b>
                {
                    <span class="r67 r">typesWithoutPrefix</span>.<span class="i">Add</span>(<span class="r68 r">type</span>);
                }
            }
 
            <b>if</b> (<span class="r66 r">atleastOneDeserializedTypeFound</span>)
            {
                <b>return</b> <span class="r67 r">typesWithoutPrefix</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to prefix a typename for deserialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="d84dce3ed20e2ef7" href="../R/d84dce3ed20e2ef7.html" target="n" data-glyph="10,1" class="i field">DeserializationTypeNamePrefix</a> = <span class="s">&quot;Deserialized.&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Types of known type container supported by monad.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="987ec5fe7ca4f1a1" href="../R/987ec5fe7ca4f1a1.html" target="n" data-glyph="20,0" class="t t"><span id="de837451ff986e68">ContainerType</span></a>
    {
        <a id="a994255a39d73423" href="../R/a994255a39d73423.html" target="n" data-glyph="24,1" class="i field">Dictionary</a>,
        <a id="43a90845e1f3d405" href="../R/43a90845e1f3d405.html" target="n" data-glyph="24,1" class="i field">Queue</a>,
        <a id="7d548ce8f85a24e5" href="../R/7d548ce8f85a24e5.html" target="n" data-glyph="24,1" class="i field">Stack</a>,
        <a id="8976c008611097e9" href="../R/8976c008611097e9.html" target="n" data-glyph="24,1" class="i field">List</a>,
        <a id="4b85ec47c1309261" href="../R/4b85ec47c1309261.html" target="n" data-glyph="24,1" class="i field">Enumerable</a>,
        <a id="a3b1554a3f5207aa" href="../R/a3b1554a3f5207aa.html" target="n" data-glyph="24,1" class="i field">None</a>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This internal helper class provides methods for serializing mshObject.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="fafbc094ffa8966a" href="../R/fafbc094ffa8966a.html" target="n" data-glyph="2,0" class="t t">InternalSerializer</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <b>internal const string</b> <a id="f5e0019810010474" href="../R/f5e0019810010474.html" target="n" data-glyph="8,1" class="i field">DefaultVersion</a> = <span class="s">&quot;1.1.0.1&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Xml writer to be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">XmlWriter</span> <a id="844267b0ca189929" href="../R/844267b0ca189929.html" target="n" data-glyph="46,1" class="i field">_writer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serialization context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="#79c883e3ce596f80" class="t t">SerializationContext</a> <a id="a7a60e35cfcccbfc" href="../R/a7a60e35cfcccbfc.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="c">///</span><span class="c"> Used by Remoting infrastructure. This TypeTable instance</span>
        <span class="c">///</span><span class="c"> will be used by Serializer if ExecutionContext is not</span>
        <span class="c">///</span><span class="c"> available (to get the ExecutionContext&#39;s TypeTable)</span>
        <b>private</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="8739a56287fa3e83" href="../R/8739a56287fa3e83.html" target="n" data-glyph="46,1" class="i field">_typeTable</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Depth below top level - used to prevent infinitely deep serialization</span>
        <span class="c">///</span><span class="c"> (without this protection it would be possible i.e. with SerializationDepth and recursion)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="b4859674c7281ecc" href="../R/b4859674c7281ecc.html" target="n" data-glyph="46,1" class="i field">_depthBelowTopLevel</a>;
 
        <b>private const int</b> <a id="fa6c8d6a392d1055" href="../R/fa6c8d6a392d1055.html" target="n" data-glyph="10,1" class="i field">MaxDepthBelowTopLevel</a> = 50;
 
        <b>private readonly</b> <a href="#054fa5b4bfe00fdc" class="t t">ReferenceIdHandlerForSerializer</a>&lt;<b>object</b>&gt; <a id="59f6b47e5da32f9c" href="../R/59f6b47e5da32f9c.html" target="n" data-glyph="46,1" class="i field">_objectRefIdHandler</a>;
        <b>private readonly</b> <a href="#054fa5b4bfe00fdc" class="t t">ReferenceIdHandlerForSerializer</a>&lt;<a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt; <a id="ef2cf95cfc736bfb" href="../R/ef2cf95cfc736bfb.html" target="n" data-glyph="46,1" class="i field">_typeRefIdHandler</a>;
 
        <b>internal</b> <a id="7913854327b55d00" href="../R/7913854327b55d00.html" target="n" data-glyph="74,1" class="t constructor">InternalSerializer</a>(<span class="i">XmlWriter</span> <span id="r69 rd" class="r69 r">writer</span>, <a href="#79c883e3ce596f80" class="t t">SerializationContext</a> <span id="r70 rd" class="r70 r">context</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r69 r">writer</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r70 r">context</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="#844267b0ca189929" class="i field">_writer</a> = <span class="r69 r">writer</span>;
            <a href="#a7a60e35cfcccbfc" class="i field">_context</a> = <span class="r70 r">context</span>;
 
            <span class="i">IDictionary</span>&lt;<b>object</b>, <b>ulong</b>&gt; <span id="r71 rd" class="r71 r">objectRefIdDictionary</span> = <b>null</b>;
            <b>if</b> ((<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#0b378b732b3e7999" class="i field">options</a> &amp; <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#acad964848d612fc" class="i field">NoObjectRefIds</a>) == 0)
            {
                <span class="r71 r">objectRefIdDictionary</span> = <b>new</b> <a href="#ad722cda08fbd4db" class="t constructor">WeakReferenceDictionary</a>&lt;<span class="i">UInt64</span>&gt;();
            }
 
            <a href="#59f6b47e5da32f9c" class="i field">_objectRefIdHandler</a> = <b>new</b> <span class="t">ReferenceIdHandlerForSerializer</span>&lt;<b>object</b>&gt;(<span class="r71 r">objectRefIdDictionary</span>);
 
            <a href="#ef2cf95cfc736bfb" class="i field">_typeRefIdHandler</a> = <b>new</b> <span class="t">ReferenceIdHandlerForSerializer</span>&lt;<a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt;(
                <b>new</b> <span class="i">Dictionary</span>&lt;<a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>, <span class="i">UInt64</span>&gt;(<a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>.<a href="TypeTable.cs.html#bb8c01ae2a43a6ac" class="i field">EqualityComparer</a>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Remoting infrastructure. This TypeTable instance</span>
        <span class="c">///</span><span class="c"> will be used by Serializer if ExecutionContext is not</span>
        <span class="c">///</span><span class="c"> available (to get the ExecutionContext&#39;s TypeTable)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="2e47e80e3c94a49d" href="../R/2e47e80e3c94a49d.html" target="n" data-glyph="104,1" class="i property">TypeTable</a>
        {
            <b>get</b> { <b>return</b> <a href="#8739a56287fa3e83" class="i field">_typeTable</a>; }
 
            <b>set</b> { <a href="#8739a56287fa3e83" class="i field">_typeTable</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the start of root element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="12685c8e0ed4b53c" href="../R/12685c8e0ed4b53c.html" target="n" data-glyph="74,1" class="i method">Start</a>()
        {
            <b>if</b> ((<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#0b378b732b3e7999" class="i field">options</a> &amp; <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#16119eba913e0adf" class="i field">NoRootElement</a>) != <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#16119eba913e0adf" class="i field">NoRootElement</a>)
            {
                <a href="#fafbc094ffa8966a" class="k">this</a>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fd92e664835c5f57" class="i field">RootElementTag</a>);
                <a href="#fafbc094ffa8966a" class="k">this</a>.<a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#0c0f9a5653031b06" class="i field">VersionAttribute</a>, <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<a href="#f5e0019810010474" class="i field">DefaultVersion</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the end of root element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="14e68b4df282baff" href="../R/14e68b4df282baff.html" target="n" data-glyph="74,1" class="i method">End</a>()
        {
            <b>if</b> ((<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#0b378b732b3e7999" class="i field">options</a> &amp; <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#16119eba913e0adf" class="i field">NoRootElement</a>) != <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#16119eba913e0adf" class="i field">NoRootElement</a>)
            {
                <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
            }
 
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">Flush</span>();
        }
 
        <b>private bool</b> <a id="deb7d620c439185a" href="../R/deb7d620c439185a.html" target="n" data-glyph="46,1" class="i field">_isStopping</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from a separate thread will stop the serialization process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="1a7ff90318da3d16" href="../R/1a7ff90318da3d16.html" target="n" data-glyph="74,1" class="i method">Stop</a>()
        {
            <a href="#deb7d620c439185a" class="i field">_isStopping</a> = <b>true</b>;
        }
 
        <b>private void</b> <a id="c9126bc1fd3a6930" href="../R/c9126bc1fd3a6930.html" target="n" data-glyph="76,1" class="i method">CheckIfStopping</a>()
        {
            <b>if</b> (<a href="#deb7d620c439185a" class="i field">_isStopping</a>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">Serialization</span>.<span class="i">Stopping</span>);
            }
        }
 
        <b>internal static bool</b> <a id="5e6876f3d5b727ff" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsPrimitiveKnownType</a>(<span class="i">Type</span> <span id="r72 rd" class="r72 r">input</span>)
        {
            <span class="c">// Check if source is of primitive known type</span>
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r73 rd" class="r73 r">pktInfo</span> = <a href="#295889332d482ff3" class="t t">KnownTypes</a>.<a href="#8e99646679237ea1" class="i method">GetTypeSerializationInfo</a>(<span class="r72 r">input</span>);
            <b>return</b> (<span class="r73 r">pktInfo</span> != <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This writes one object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> source to be serialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stream to which source belongs</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ef372778f5b989d3" href="../R/ef372778f5b989d3.html" target="n" data-glyph="74,1" class="i method">WriteOneTopLevelObject</a>
        (
            <b>object</b> <span id="r74 rd" class="r74 r">source</span>,
            <b>string</b> <span id="r75 rd" class="r75 r">streamName</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a> == 0, <span class="s">&quot;InternalSerializer.depthBelowTopLevel should be 0 at top-level&quot;</span>);
            <a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r74 r">source</span>, <span class="r75 r">streamName</span>, <b>null</b>, <a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#c1c4fb8b0dbf05f1" class="i field">depth</a>);
        }
 
        <b>private void</b> <a id="beb1b050fda95981" href="../R/beb1b050fda95981.html" target="n" data-glyph="76,1" class="i method">WriteOneObject</a>
        (
            <b>object</b> <span id="r76 rd" class="r76 r">source</span>,
            <b>string</b> <span id="r77 rd" class="r77 r">streamName</span>,
            <b>string</b> <span id="r78 rd" class="r78 r">property</span>,
            <b>int</b> <span id="r79 rd" class="r79 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r79 r">depth</span> &gt;= 0, <span class="s">&quot;depth should always be greater or equal to zero&quot;</span>);
            <a href="#fafbc094ffa8966a" class="k">this</a>.<a href="#c9126bc1fd3a6930" class="i method">CheckIfStopping</a>();
 
            <b>if</b> (<span class="r76 r">source</span> == <b>null</b>)
            {
                <a href="#8be95c1707843982" class="i method">WriteNull</a>(<span class="r77 r">streamName</span>, <span class="r78 r">property</span>);
                <b>return</b>;
            }
 
            <b>try</b>
            {
                <a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a>++;
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a> &lt;= <a href="#fa6c8d6a392d1055" class="i field">MaxDepthBelowTopLevel</a>, <span class="s">&quot;depthBelowTopLevel should be &lt;= MaxDepthBelowTopLevel&quot;</span>);
                <b>if</b> (<a href="#df11408308f282fb" class="i method">HandleMaxDepth</a>(<span class="r76 r">source</span>, <span class="r77 r">streamName</span>, <span class="r78 r">property</span>))
                {
                    <b>return</b>;
                }
 
                <span class="r79 r">depth</span> = <a href="#c4b3927bd81a0835" class="i method">GetDepthOfSerialization</a>(<span class="r76 r">source</span>, <span class="r79 r">depth</span>);
 
                <b>if</b> (<a href="#7dc6b1ecacf91c2a" class="i method">HandlePrimitiveKnownTypeByConvertingToPSObject</a>(<span class="r76 r">source</span>, <span class="r77 r">streamName</span>, <span class="r78 r">property</span>, <span class="r79 r">depth</span>))
                {
                    <b>return</b>;
                }
 
                <span class="c">// Object is not of primitive known type. Check if this has</span>
                <span class="c">// already been serialized.</span>
                <b>string</b> <span id="r80 rd" class="r80 r">refId</span> = <a href="#59f6b47e5da32f9c" class="i field">_objectRefIdHandler</a>.<a href="#b4bc07b44a2d34bc" class="i method">GetRefId</a>(<span class="r76 r">source</span>);
                <b>if</b> (<span class="r80 r">refId</span> != <b>null</b>)
                {
                    <a href="#bf94981707751ab4" class="i method">WritePSObjectReference</a>(<span class="r77 r">streamName</span>, <span class="r78 r">property</span>, <span class="r80 r">refId</span>);
                    <b>return</b>;
                }
 
                <b>if</b> (<a href="#ac35887921596375" class="i method">HandlePrimitiveKnownTypePSObject</a>(<span class="r76 r">source</span>, <span class="r77 r">streamName</span>, <span class="r78 r">property</span>, <span class="r79 r">depth</span>))
                {
                    <b>return</b>;
                }
 
                <span class="c">// Note: We do not use containers in depth calculation. i.e even if the</span>
                <span class="c">// current depth is zero, we serialize the container. All contained items will</span>
                <span class="c">// get serialized with depth zero.</span>
                <b>if</b> (<a href="#caf5f1d67026029b" class="i method">HandleKnownContainerTypes</a>(<span class="r76 r">source</span>, <span class="r77 r">streamName</span>, <span class="r78 r">property</span>, <span class="r79 r">depth</span>))
                {
                    <b>return</b>;
                }
 
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r81 rd" class="r81 r">mshSource</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r76 r">source</span>);
                <span class="c">// If depth is zero, complex type should be serialized as string.</span>
                <b>if</b> (<span class="r79 r">depth</span> == 0 || <a href="#5dd77fdfda161e30" class="i method">SerializeAsString</a>(<span class="r81 r">mshSource</span>))
                {
                    <a href="#845008d2a5d7125c" class="i method">HandlePSObjectAsString</a>(<span class="r81 r">mshSource</span>, <span class="r77 r">streamName</span>, <span class="r78 r">property</span>, <span class="r79 r">depth</span>);
                    <b>return</b>;
                }
 
                <a href="#e87064dd42e73265" class="i method">HandleComplexTypePSObject</a>(<span class="r76 r">source</span>, <span class="r77 r">streamName</span>, <span class="r78 r">property</span>, <span class="r79 r">depth</span>);
                <b>return</b>;
            }
            <b>finally</b>
            {
                <a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a>--;
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a> &gt;= 0, <span class="s">&quot;depthBelowTopLevel should be &gt;= 0&quot;</span>);
            }
        }
 
        <b>private bool</b> <a id="df11408308f282fb" href="../R/df11408308f282fb.html" target="n" data-glyph="76,1" class="i method">HandleMaxDepth</a>(<b>object</b> <span id="r82 rd" class="r82 r">source</span>, <b>string</b> <span id="r83 rd" class="r83 r">streamName</span>, <b>string</b> <span id="r84 rd" class="r84 r">property</span>)
        {
            <b>if</b> (<a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a> == <a href="#fa6c8d6a392d1055" class="i field">MaxDepthBelowTopLevel</a>)
            {
                <span class="c">// assert commented out because of clashes with Wei&#39;s tests</span>
                <span class="c">// Dbg.Assert(false, &quot;We should never reach MaxDepthBelowTopLevel with non-malicious input&quot;);</span>
 
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticError</span>(<a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#5b1f4f4dc3165585" class="i field">Serializer_MaxDepthWhenSerializing</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>, <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a>, <span class="r82 r">source</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>, <span class="r84 r">property</span>, <a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a>);
 
                <b>string</b> <span id="r85 rd" class="r85 r">content</span> = <span class="i">Serialization</span>.<span class="i">DeserializationTooDeep</span>;
                <a href="#9f1e466be19e8542" class="i method">HandlePrimitiveKnownType</a>(<span class="r85 r">content</span>, <span class="r83 r">streamName</span>, <span class="r84 r">property</span>);
                <b>return</b> <b>true</b>;
            }
            <b>else</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes Primitive Known Types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if source is handled, else false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="9f1e466be19e8542" href="../R/9f1e466be19e8542.html" target="n" data-glyph="76,1" class="i method">HandlePrimitiveKnownType</a>
        (
            <b>object</b> <span id="r86 rd" class="r86 r">source</span>,
            <b>string</b> <span id="r87 rd" class="r87 r">streamName</span>,
            <b>string</b> <span id="r88 rd" class="r88 r">property</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r86 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="c">// Check if source is of primitive known type</span>
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r89 rd" class="r89 r">pktInfo</span> = <a href="#295889332d482ff3" class="t t">KnownTypes</a>.<span class="i">GetTypeSerializationInfo</span>(<span class="r86 r">source</span>.<span class="i">GetType</span>());
            <b>if</b> (<span class="r89 r">pktInfo</span> != <b>null</b>)
            {
                <a href="#bf318610b4d8dbe0" class="i method">WriteOnePrimitiveKnownType</a>(<a href="#fafbc094ffa8966a" class="k">this</a>, <span class="r87 r">streamName</span>, <span class="r88 r">property</span>, <span class="r86 r">source</span>, <span class="r89 r">pktInfo</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles primitive known type by first converting it to a PSObject.In W8, extended</span>
        <span class="c">///</span><span class="c"> property data is stored external to PSObject. By converting to PSObject, we will</span>
        <span class="c">///</span><span class="c"> be able to retrieve and serialize the extended properties. This is tracked by</span>
        <span class="c">///</span><span class="c"> Win8: 414042.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="7dc6b1ecacf91c2a" href="../R/7dc6b1ecacf91c2a.html" target="n" data-glyph="76,1" class="i method">HandlePrimitiveKnownTypeByConvertingToPSObject</a>(
            <b>object</b> <span id="r90 rd" class="r90 r">source</span>,
            <b>string</b> <span id="r91 rd" class="r91 r">streamName</span>,
            <b>string</b> <span id="r92 rd" class="r92 r">property</span>,
            <b>int</b> <span id="r93 rd" class="r93 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r90 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <span class="c">// Check if source is of primitive known type</span>
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r94 rd" class="r94 r">pktInfo</span> = <a href="#295889332d482ff3" class="t t">KnownTypes</a>.<span class="i">GetTypeSerializationInfo</span>(<span class="r90 r">source</span>.<span class="i">GetType</span>());
            <b>if</b> (<span class="r94 r">pktInfo</span> != <b>null</b>)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r95 rd" class="r95 r">pktInfoPSObject</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r90 r">source</span>);
                <b>return</b> <a href="#ac35887921596375" class="i method">HandlePrimitiveKnownTypePSObject</a>(<span class="r95 r">pktInfoPSObject</span>, <span class="r91 r">streamName</span>, <span class="r92 r">property</span>, <span class="r93 r">depth</span>);
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="5826542431262dff" href="../R/5826542431262dff.html" target="n" data-glyph="76,1" class="i method">HandleSecureString</a>(<b>object</b> <span id="r96 rd" class="r96 r">source</span>, <b>string</b> <span id="r97 rd" class="r97 r">streamName</span>, <b>string</b> <span id="r98 rd" class="r98 r">property</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r96 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="i">SecureString</span> <span id="r99 rd" class="r99 r">secureString</span> = <b>null</b>;
            <span class="r99 r">secureString</span> = <span class="r96 r">source</span> <b>as</b> <span class="i">SecureString</span>;
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r100 rd" class="r100 r">moSource</span>;
 
            <b>if</b> (<span class="r99 r">secureString</span> != <b>null</b>)
            {
                <span class="r100 r">moSource</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r99 r">secureString</span>);
            }
            <b>else</b>
            {
                <span class="r100 r">moSource</span> = <span class="r96 r">source</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            }
 
            <b>if</b> (<span class="r100 r">moSource</span> != <b>null</b> &amp;&amp; !<span class="r100 r">moSource</span>.<a href="MshObject.cs.html#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>)
            {
                <span class="c">// check if source is of type secure string</span>
                <span class="r99 r">secureString</span> = <span class="r100 r">moSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>as</b> <span class="i">SecureString</span>;
                <b>if</b> (<span class="r99 r">secureString</span> != <b>null</b>)
                {
                    <span class="c">// the principle used in serialization is that serialization</span>
                    <span class="c">// never throws, and if something can&#39;t be serialized nothing</span>
                    <span class="c">// is written. So we write the elements only if encryption succeeds.</span>
                    <span class="c">// However, in the case for non-Windows where secure string encryption</span>
                    <span class="c">// is not yet supported, a PSCryptoException will be thrown.</span>
                    <b>string</b> <span id="r101 rd" class="r101 r">encryptedString</span>;
                    <b>if</b> (<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#c21b92cb57f02d95" class="i field">cryptoHelper</a> != <b>null</b>)
                    {
                        <span class="r101 r">encryptedString</span> = <a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#c21b92cb57f02d95" class="i field">cryptoHelper</a>.<a href="../utils/CryptoUtils.cs.html#d523318642e6184f" class="i method">EncryptSecureString</a>(<span class="r99 r">secureString</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r101 r">encryptedString</span> = <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecureStringHelper.cs.html#01b0e2a85ff89895" class="t t">SecureStringHelper</a>.<a href="../security/SecureStringHelper.cs.html#926f2ff116ae9cf8" class="i method">Protect</a>(<span class="r99 r">secureString</span>);
                    }
 
                    <b>if</b> (<span class="r98 r">property</span> != <b>null</b>)
                    {
                        <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#330e84e9101f7552" class="i field">SecureStringTag</a>);
                        <a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r98 r">property</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#330e84e9101f7552" class="i field">SecureStringTag</a>);
                    }
 
                    <b>if</b> (<span class="r97 r">streamName</span> != <b>null</b>)
                    {
                        <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r97 r">streamName</span>);
                    }
 
                    <span class="c">// Note: We do not use WriteRaw for serializing secure string. WriteString</span>
                    <span class="c">// does necessary escaping which may be needed for certain</span>
                    <span class="c">// characters.</span>
                    <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteString</span>(<span class="r101 r">encryptedString</span>);
 
                    <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
 
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes PSObject whose base objects are of primitive known type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if source is handled, else false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="ac35887921596375" href="../R/ac35887921596375.html" target="n" data-glyph="76,1" class="i method">HandlePrimitiveKnownTypePSObject</a>
        (
            <b>object</b> <span id="r102 rd" class="r102 r">source</span>,
            <b>string</b> <span id="r103 rd" class="r103 r">streamName</span>,
            <b>string</b> <span id="r104 rd" class="r104 r">property</span>,
            <b>int</b> <span id="r105 rd" class="r105 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r102 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <b>bool</b> <span id="r106 rd" class="r106 r">sourceHandled</span> = <b>false</b>;
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r107 rd" class="r107 r">moSource</span> = <span class="r102 r">source</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <b>if</b> (<span class="r107 r">moSource</span> != <b>null</b> &amp;&amp; !<span class="r107 r">moSource</span>.<a href="MshObject.cs.html#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>)
            {
                <span class="c">// Check if baseObject is primitive known type</span>
                <b>object</b> <span id="r108 rd" class="r108 r">baseObject</span> = <span class="r107 r">moSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>;
                <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r109 rd" class="r109 r">pktInfo</span> = <a href="#295889332d482ff3" class="t t">KnownTypes</a>.<span class="i">GetTypeSerializationInfo</span>(<span class="r108 r">baseObject</span>.<span class="i">GetType</span>());
                <b>if</b> (<span class="r109 r">pktInfo</span> != <b>null</b>)
                {
                    <a href="#f9a09c4ee3f1cb35" class="i method">WritePrimitiveTypePSObject</a>(<span class="r107 r">moSource</span>, <span class="r108 r">baseObject</span>, <span class="r109 r">pktInfo</span>, <span class="r103 r">streamName</span>, <span class="r104 r">property</span>, <span class="r105 r">depth</span>);
                    <span class="r106 r">sourceHandled</span> = <b>true</b>;
                }
            }
 
            <b>return</b> <span class="r106 r">sourceHandled</span>;
        }
 
        <b>private bool</b> <a id="caf5f1d67026029b" href="../R/caf5f1d67026029b.html" target="n" data-glyph="76,1" class="i method">HandleKnownContainerTypes</a>
        (
            <b>object</b> <span id="r110 rd" class="r110 r">source</span>,
            <b>string</b> <span id="r111 rd" class="r111 r">streamName</span>,
            <b>string</b> <span id="r112 rd" class="r112 r">property</span>,
            <b>int</b> <span id="r113 rd" class="r113 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r110 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a> <span id="r114 rd" class="r114 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>;
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r115 rd" class="r115 r">mshSource</span> = <span class="r110 r">source</span> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <span class="i">IEnumerable</span> <span id="r116 rd" class="r116 r">enumerable</span> = <b>null</b>;
            <span class="i">IDictionary</span> <span id="r117 rd" class="r117 r">dictionary</span> = <b>null</b>;
 
            <span class="c">// If passed in object is PSObject with no baseobject, return false.</span>
            <b>if</b> (<span class="r115 r">mshSource</span> != <b>null</b> &amp;&amp; <span class="r115 r">mshSource</span>.<a href="MshObject.cs.html#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Check if source (or baseobject in mshSource) is known container type</span>
            <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#cbda6536a2fc4953" class="i method">GetKnownContainerTypeInfo</a>(<span class="r115 r">mshSource</span> != <b>null</b> ? <span class="r115 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> : <span class="r110 r">source</span>, <b>out</b> <span class="r114 r">ct</span>,
                                      <b>out</b> <span class="r117 r">dictionary</span>, <b>out</b> <span class="r116 r">enumerable</span>);
 
            <b>if</b> (<span class="r114 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>)
                <b>return</b> <b>false</b>;
 
            <b>string</b> <span id="r118 rd" class="r118 r">refId</span> = <a href="#59f6b47e5da32f9c" class="i field">_objectRefIdHandler</a>.<a href="#db499d5050d69562" class="i method">SetRefId</a>(<span class="r110 r">source</span>);
            <a href="#fa055d884ada73db" class="i method">WriteStartOfPSObject</a>(
                <span class="r115 r">mshSource</span> ?? <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r110 r">source</span>),
                <span class="r111 r">streamName</span>,
                <span class="r112 r">property</span>,
                <span class="r118 r">refId</span>,
                <b>true</b>, <span class="c">// always write TypeNames information for known container types</span>
                <b>null</b>); <span class="c">// never write ToString information for known container types</span>
 
            <b>switch</b> (<span class="r114 r">ct</span>)
            {
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a994255a39d73423" class="i field">Dictionary</a>:
                    <a href="#85d9c3624aec8abe" class="i method">WriteDictionary</a>(<span class="r117 r">dictionary</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#291a813ba557e056" class="i field">DictionaryTag</a>, <span class="r113 r">depth</span>);
                    <b>break</b>;
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#7d548ce8f85a24e5" class="i field">Stack</a>:
                    <a href="#2b5018c1d84aca1b" class="i method">WriteEnumerable</a>(<span class="r116 r">enumerable</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#624a489686d9f226" class="i field">StackTag</a>, <span class="r113 r">depth</span>);
                    <b>break</b>;
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#43a90845e1f3d405" class="i field">Queue</a>:
                    <a href="#2b5018c1d84aca1b" class="i method">WriteEnumerable</a>(<span class="r116 r">enumerable</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d5e72c1588a828b2" class="i field">QueueTag</a>, <span class="r113 r">depth</span>);
                    <b>break</b>;
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#8976c008611097e9" class="i field">List</a>:
                    <a href="#2b5018c1d84aca1b" class="i method">WriteEnumerable</a>(<span class="r116 r">enumerable</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#1a7c55cb3a874e56" class="i field">ListTag</a>, <span class="r113 r">depth</span>);
                    <b>break</b>;
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#4b85ec47c1309261" class="i field">Enumerable</a>:
                    <a href="#2b5018c1d84aca1b" class="i method">WriteEnumerable</a>(<span class="r116 r">enumerable</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#57e1165cb3ca760d" class="i field">CollectionTag</a>, <span class="r113 r">depth</span>);
                    <b>break</b>;
                <b>default</b>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;All containers should be handled in the switch&quot;</span>);
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r113 r">depth</span> != 0)
            {
                <span class="c">// An object which is original enumerable becomes an PSObject with ArrayList on deserialization.</span>
                <span class="c">// So on roundtrip it will show up as List.</span>
                <span class="c">// We serialize properties of enumerable and on deserialization mark the object as Deserialized.</span>
                <span class="c">// So if object is marked deserialized, we should write properties.</span>
                <b>if</b> (<span class="r114 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#4b85ec47c1309261" class="i field">Enumerable</a> || (<span class="r115 r">mshSource</span> != <b>null</b> &amp;&amp; <span class="r115 r">mshSource</span>.<a href="MshObject.cs.html#598b509cd0dd9b32" class="i property">IsDeserialized</a>))
                {
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r119 rd" class="r119 r">sourceAsPSObject</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r110 r">source</span>);
                    <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r120 rd" class="r120 r">specificPropertiesToSerialize</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#441561ef872e6f58" class="i method">GetSpecificPropertiesToSerialize</a>(<span class="r119 r">sourceAsPSObject</span>, <a href="#3cf2230bfd688231" class="i property">AllPropertiesCollection</a>, <a href="#8739a56287fa3e83" class="i field">_typeTable</a>);
                    <span class="i">WritePSObjectProperties</span>(<span class="r119 r">sourceAsPSObject</span>, <span class="r113 r">depth</span>, <span class="r120 r">specificPropertiesToSerialize</span>);
                    <span class="i">SerializeExtendedProperties</span>(<span class="r119 r">sourceAsPSObject</span>, <span class="r113 r">depth</span>, <span class="r120 r">specificPropertiesToSerialize</span>);
                }
                <span class="c">// always serialize instance properties if there are any</span>
                <b>else</b> <b>if</b> (<span class="r115 r">mshSource</span> != <b>null</b>)
                {
                    <a href="#99404c3d36a6131d" class="i method">SerializeInstanceProperties</a>(<span class="r115 r">mshSource</span>, <span class="r113 r">depth</span>);
                }
            }
 
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Write PSObject
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes PSObject Reference Element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="bf94981707751ab4" href="../R/bf94981707751ab4.html" target="n" data-glyph="76,1" class="i method">WritePSObjectReference</a>
        (
            <b>string</b> <span id="r121 rd" class="r121 r">streamName</span>,
            <b>string</b> <span id="r122 rd" class="r122 r">property</span>,
            <b>string</b> <span id="r123 rd" class="r123 r">refId</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r123 r">refId</span>), <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#c1b0f9d99fde72fe" class="i field">ReferenceTag</a>);
            <b>if</b> (<span class="r121 r">streamName</span> != <b>null</b>)
            {
                <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r121 r">streamName</span>);
            }
 
            <b>if</b> (<span class="r122 r">property</span> != <b>null</b>)
            {
                <a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r122 r">property</span>);
            }
 
            <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>, <span class="r123 r">refId</span>);
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <b>private static bool</b> <a id="94b2f25f71daf88a" href="../R/94b2f25f71daf88a.html" target="n" data-glyph="76,1" class="i method">PSObjectHasModifiedTypesCollection</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r124 rd" class="r124 r">pso</span>)
        {
            <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <span id="r125 rd" class="r125 r">currentTypes</span> = <span class="r124 r">pso</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r126 rd" class="r126 r">originalTypes</span> = <span class="r124 r">pso</span>.<a href="MshObject.cs.html#c3997c282bafb530" class="i property">InternalAdapter</a>.<a href="CoreAdapter.cs.html#e70aa32975138432" class="i method">BaseGetTypeNameHierarchy</a>(<span class="r124 r">pso</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>);
 
            <b>if</b> (<span class="r125 r">currentTypes</span>.<span class="i">Count</span> != <span class="r126 r">originalTypes</span>.<span class="i">Count</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="i">IEnumerator</span>&lt;<b>string</b>&gt; <span id="r127 rd" class="r127 r">currentEnumerator</span> = <span class="r125 r">currentTypes</span>.<span class="i">GetEnumerator</span>();
            <span class="i">IEnumerator</span>&lt;<b>string</b>&gt; <span id="r128 rd" class="r128 r">originalEnumerator</span> = <span class="r126 r">originalTypes</span>.<span class="i">GetEnumerator</span>();
            <b>while</b> (<span class="r127 r">currentEnumerator</span>.<span class="i">MoveNext</span>() &amp;&amp; <span class="r128 r">originalEnumerator</span>.<span class="i">MoveNext</span>())
            {
                <b>if</b> (!<span class="r127 r">currentEnumerator</span>.<span class="i">Current</span>.<span class="i">Equals</span>(<span class="r128 r">originalEnumerator</span>.<span class="i">Current</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes an PSObject whose baseobject is of primitive type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> source from which notes are written</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">primitive</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> primitive object which is written as base object. In most cases it</span>
        <span class="c">///</span><span class="c"> is same source.ImmediateBaseObject. When PSObject is serialized as string,</span>
        <span class="c">///</span><span class="c"> it can be different. </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#845008d2a5d7125c" class="i method">HandlePSObjectAsString</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for more info.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">pktInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TypeSerializationInfo for the primitive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r132 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f9a09c4ee3f1cb35" href="../R/f9a09c4ee3f1cb35.html" target="n" data-glyph="76,1" class="i method">WritePrimitiveTypePSObject</a>
        (
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r129 rd" class="r129 r">source</span>,
            <b>object</b> <span id="r130 rd" class="r130 r">primitive</span>,
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r131 rd" class="r131 r">pktInfo</span>,
            <b>string</b> <span id="r132 rd" class="r132 r">streamName</span>,
            <b>string</b> <span id="r133 rd" class="r133 r">property</span>,
            <b>int</b> <span id="r134 rd" class="r134 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r129 r">source</span> != <b>null</b>, <span class="s">&quot;Caller should validate source != null&quot;</span>);
 
            <b>string</b> <span id="r135 rd" class="r135 r">toStringValue</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#e42817d8853c2a00" class="i method">GetToStringForPrimitiveObject</a>(<span class="r129 r">source</span>);
            <b>bool</b> <span id="r136 rd" class="r136 r">hasModifiedTypesCollection</span> = <a href="#94b2f25f71daf88a" class="i method">PSObjectHasModifiedTypesCollection</a>(<span class="r129 r">source</span>);
            <b>bool</b> <span id="r137 rd" class="r137 r">hasNotes</span> = <a href="#f4436c7c1dd3fd7b" class="i method">PSObjectHasNotes</a>(<span class="r129 r">source</span>);
            <b>bool</b> <span id="r138 rd" class="r138 r">hasModifiedToString</span> = (<span class="r135 r">toStringValue</span> != <b>null</b>);
 
            <b>if</b> (<span class="r137 r">hasNotes</span> || <span class="r136 r">hasModifiedTypesCollection</span> || <span class="r138 r">hasModifiedToString</span>)
            {
                <a href="#8a3b7ed32e54721d" class="i method">WritePrimitiveTypePSObjectWithNotes</a>(
                    <span class="r129 r">source</span>,
                    <span class="r130 r">primitive</span>,
                    <span class="r136 r">hasModifiedTypesCollection</span>,
                    <span class="r135 r">toStringValue</span>,
                    <span class="r131 r">pktInfo</span>,
                    <span class="r132 r">streamName</span>,
                    <span class="r133 r">property</span>,
                    <span class="r134 r">depth</span>);
                <b>return</b>;
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r130 r">primitive</span> != <b>null</b>)
                {
                    <a href="#bf318610b4d8dbe0" class="i method">WriteOnePrimitiveKnownType</a>(<a href="#fafbc094ffa8966a" class="k">this</a>, <span class="r132 r">streamName</span>, <span class="r133 r">property</span>, <span class="r130 r">primitive</span>, <span class="r131 r">pktInfo</span>);
                    <b>return</b>;
                }
                <b>else</b>
                {
                    <a href="#8be95c1707843982" class="i method">WriteNull</a>(<span class="r132 r">streamName</span>, <span class="r133 r">property</span>);
                    <b>return</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes an PSObject whose baseobject is of primitive type</span>
        <span class="c">///</span><span class="c"> and which has notes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> source from which notes are written</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">primitive</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> primitive object which is written as base object. In most cases it</span>
        <span class="c">///</span><span class="c"> is same source.ImmediateBaseObject. When PSObject is serialized as string,</span>
        <span class="c">///</span><span class="c"> it can be different. </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#845008d2a5d7125c" class="i method">HandlePSObjectAsString</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for more info.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">hasModifiedTypesCollection</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">toStringValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">pktInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TypeSerializationInfo for the primitive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8a3b7ed32e54721d" href="../R/8a3b7ed32e54721d.html" target="n" data-glyph="76,1" class="i method">WritePrimitiveTypePSObjectWithNotes</a>
        (
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r139 rd" class="r139 r">source</span>,
            <b>object</b> <span id="r140 rd" class="r140 r">primitive</span>,
            <b>bool</b> <span id="r141 rd" class="r141 r">hasModifiedTypesCollection</span>,
            <b>string</b> <span id="r142 rd" class="r142 r">toStringValue</span>,
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r143 rd" class="r143 r">pktInfo</span>,
            <b>string</b> <span id="r144 rd" class="r144 r">streamName</span>,
            <b>string</b> <span id="r145 rd" class="r145 r">property</span>,
            <b>int</b> <span id="r146 rd" class="r146 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r139 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r143 r">pktInfo</span> != <b>null</b>, <span class="s">&quot;Caller should validate pktInfo != null&quot;</span>);
 
            <b>string</b> <span id="r147 rd" class="r147 r">refId</span> = <a href="#59f6b47e5da32f9c" class="i field">_objectRefIdHandler</a>.<a href="#db499d5050d69562" class="i method">SetRefId</a>(<span class="r139 r">source</span>);
            <a href="#fa055d884ada73db" class="i method">WriteStartOfPSObject</a>(
                <span class="r139 r">source</span>,
                <span class="r144 r">streamName</span>,
                <span class="r145 r">property</span>,
                <span class="r147 r">refId</span>,
                <span class="r141 r">hasModifiedTypesCollection</span>, <span class="c">// preserve TypeNames information if different from the primitive type</span>
                <span class="r142 r">toStringValue</span>); <span class="c">// preserve ToString information only if got it from deserialization or overridden by PSObject</span>
                                <span class="c">// (example where preservation of TypeNames and ToString is needed: enums serialized as ints, help string with custom type names (HelpInfoShort))</span>
 
            <b>if</b> (<span class="r143 r">pktInfo</span> != <b>null</b>)
            {
                <a href="#bf318610b4d8dbe0" class="i method">WriteOnePrimitiveKnownType</a>(<a href="#fafbc094ffa8966a" class="k">this</a>, <span class="r144 r">streamName</span>, <b>null</b>, <span class="r140 r">primitive</span>, <span class="r143 r">pktInfo</span>);
            }
 
            <span class="c">// serialize only instance properties - members from type table are</span>
            <span class="c">// always going to be available for known primitive types</span>
            <a href="#99404c3d36a6131d" class="i method">SerializeInstanceProperties</a>(<span class="r139 r">source</span>, <span class="r146 r">depth</span>);
 
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <b>private void</b> <a id="e87064dd42e73265" href="../R/e87064dd42e73265.html" target="n" data-glyph="76,1" class="i method">HandleComplexTypePSObject</a>
        (
            <b>object</b> <span id="r148 rd" class="r148 r">source</span>,
            <b>string</b> <span id="r149 rd" class="r149 r">streamName</span>,
            <b>string</b> <span id="r150 rd" class="r150 r">property</span>,
            <b>int</b> <span id="r151 rd" class="r151 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r148 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r152 rd" class="r152 r">mshSource</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r148 r">source</span>);
 
            <span class="c">// Figure out what kind of object we are dealing with</span>
            <b>bool</b> <span id="r153 rd" class="r153 r">isErrorRecord</span> = <b>false</b>;
            <b>bool</b> <span id="r154 rd" class="r154 r">isInformationalRecord</span> = <b>false</b>;
            <b>bool</b> <span id="r155 rd" class="r155 r">isEnum</span> = <b>false</b>;
            <b>bool</b> <span id="r156 rd" class="r156 r">isPSObject</span> = <b>false</b>;
            <b>bool</b> <span id="r157 rd" class="r157 r">isCimInstance</span> = <b>false</b>;
 
            <b>if</b> (!<span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>)
            {
                <b>do</b> <span class="c">// false loop</span>
                {
                    <span class="i">CimInstance</span> <span id="r158 rd" class="r158 r">cimInstance</span> = <span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>as</b> <span class="i">CimInstance</span>;
                    <b>if</b> (<span class="r158 r">cimInstance</span> != <b>null</b>)
                    {
                        <span class="r157 r">isCimInstance</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r159 rd" class="r159 r">errorRecord</span> = <span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>as</b> <a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>;
                    <b>if</b> (<span class="r159 r">errorRecord</span> != <b>null</b>)
                    {
                        <span class="r159 r">errorRecord</span>.<a href="ErrorPackage.cs.html#d16aa6eb75ff130e" class="i method">ToPSObjectForRemoting</a>(<span class="r152 r">mshSource</span>);
                        <span class="r153 r">isErrorRecord</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <a href="hostifaces/InformationalRecord.cs.html#007313a3e4584d3f" class="t t">InformationalRecord</a> <span id="r160 rd" class="r160 r">informationalRecord</span> = <span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>as</b> <a href="hostifaces/InformationalRecord.cs.html#007313a3e4584d3f" class="t t">InformationalRecord</a>;
                    <b>if</b> (<span class="r160 r">informationalRecord</span> != <b>null</b>)
                    {
                        <span class="r160 r">informationalRecord</span>.<a href="hostifaces/InformationalRecord.cs.html#8885939adf29819d" class="i method">ToPSObjectForRemoting</a>(<span class="r152 r">mshSource</span>);
                        <span class="r154 r">isInformationalRecord</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <span class="r155 r">isEnum</span> = <span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>is</b> <span class="i">Enum</span>;
                    <span class="r156 r">isPSObject</span> = <span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>is</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
                } <b>while</b> (<b>false</b>);
            }
 
            <b>bool</b> <span id="r161 rd" class="r161 r">writeToString</span> = <b>true</b>;
            <b>if</b> (<span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a> == <b>null</b>) <span class="c">// continue to write ToString from deserialized objects, but...</span>
            {
                <b>if</b> (<span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>) <span class="c">// ... don&#39;t write ToString for property bags</span>
                {
                    <span class="r161 r">writeToString</span> = <b>false</b>;
                }
            }
 
            <b>string</b> <span id="r162 rd" class="r162 r">refId</span> = <a href="#59f6b47e5da32f9c" class="i field">_objectRefIdHandler</a>.<a href="#db499d5050d69562" class="i method">SetRefId</a>(<span class="r148 r">source</span>);
            <a href="#fa055d884ada73db" class="i method">WriteStartOfPSObject</a>(
                <span class="r152 r">mshSource</span>,
                <span class="r149 r">streamName</span>,
                <span class="r150 r">property</span>,
                <span class="r162 r">refId</span>,
                <b>true</b>, <span class="c">// always write TypeNames for complex objects</span>
                <span class="r161 r">writeToString</span> ? <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#3ef9cc7701d3419a" class="i method">GetToString</a>(<span class="r152 r">mshSource</span>) : <b>null</b>);
 
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r163 rd" class="r163 r">specificPropertiesToSerialize</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#441561ef872e6f58" class="i method">GetSpecificPropertiesToSerialize</a>(<span class="r152 r">mshSource</span>, <a href="#3cf2230bfd688231" class="i property">AllPropertiesCollection</a>, <a href="#8739a56287fa3e83" class="i field">_typeTable</a>);
 
            <b>if</b> (<span class="r155 r">isEnum</span>)
            {
                <b>object</b> <span id="r164 rd" class="r164 r">baseObject</span> = <span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>;
                <span class="i">WriteOneObject</span>(<span class="i n">System</span>.<span class="i">Convert</span>.<span class="i">ChangeType</span>(<span class="r164 r">baseObject</span>, <span class="i">Enum</span>.<span class="i">GetUnderlyingType</span>(<span class="r164 r">baseObject</span>.<span class="i">GetType</span>()), <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>), <b>null</b>, <b>null</b>, <span class="r151 r">depth</span>);
            }
            <b>else</b> <b>if</b> (<span class="r156 r">isPSObject</span>)
            {
                <a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>, <b>null</b>, <b>null</b>, <span class="r151 r">depth</span>);
            }
            <b>else</b> <b>if</b> (<span class="r153 r">isErrorRecord</span> || <span class="r154 r">isInformationalRecord</span>)
            {
                <span class="c">// nothing to do</span>
            }
            <b>else</b>
            {
                <span class="i">WritePSObjectProperties</span>(<span class="r152 r">mshSource</span>, <span class="r151 r">depth</span>, <span class="r163 r">specificPropertiesToSerialize</span>);
            }
 
            <b>if</b> (<span class="r157 r">isCimInstance</span>)
            {
                <span class="i">CimInstance</span> <span id="r165 rd" class="r165 r">cimInstance</span> = <span class="r152 r">mshSource</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>as</b> <span class="i">CimInstance</span>;
                <a href="#b723b3f0624fec66" class="i method">PrepareCimInstanceForSerialization</a>(<span class="r152 r">mshSource</span>, <span class="r165 r">cimInstance</span>);
            }
 
            <span class="i">SerializeExtendedProperties</span>(<span class="r152 r">mshSource</span>, <span class="r151 r">depth</span>, <span class="r163 r">specificPropertiesToSerialize</span>);
 
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">CimSerializer</span>&gt; <a id="e12149b32611d131" href="../R/e12149b32611d131.html" target="n" data-glyph="46,1" class="i field">s_cimSerializer</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">CimSerializer</span>&gt;(<span class="i">CimSerializer</span>.<span class="i">Create</span>);
 
        <b>private void</b> <a id="b723b3f0624fec66" href="../R/b723b3f0624fec66.html" target="n" data-glyph="76,1" class="i method">PrepareCimInstanceForSerialization</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r166 rd" class="r166 r">psObject</span>, <span class="i">CimInstance</span> <span id="r167 rd" class="r167 r">cimInstance</span>)
        {
            <span class="i">Queue</span>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>&gt; <span id="r168 rd" class="r168 r">serializedClasses</span> = <b>new</b> <span class="i">Queue</span>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>&gt;();
 
            <span class="c">//</span>
            <span class="c">// CREATE SERIALIZED FORM OF THE CLASS METADATA</span>
            <span class="c">//</span>
            <span class="i">ArrayList</span> <span id="r169 rd" class="r169 r">psoClasses</span> = <b>new</b> <span class="i">ArrayList</span>();
            <b>for</b> (<span class="i">CimClass</span> <span id="r170 rd" class="r170 r">cimClass</span> = <span class="r167 r">cimInstance</span>.<span class="i">CimClass</span>; <span class="r170 r">cimClass</span> != <b>null</b>; <span class="r170 r">cimClass</span> = <span class="r170 r">cimClass</span>.<span class="i">CimSuperClass</span>)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r171 rd" class="r171 r">psoClass</span> = <b>new</b> <a href="MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
                <span class="r171 r">psoClass</span>.<a href="MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
                <span class="r169 r">psoClasses</span>.<span class="i">Add</span>(<span class="r171 r">psoClass</span>);
 
                <span class="r171 r">psoClass</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#ba6b3005350b5b74" class="i field">CimClassNameProperty</a>, <span class="r170 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>));
                <span class="r171 r">psoClass</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#b87efba1c0005a54" class="i field">CimNamespaceProperty</a>, <span class="r170 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">Namespace</span>));
                <span class="r171 r">psoClass</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#1e7217d8e0975c2d" class="i field">CimServerNameProperty</a>, <span class="r170 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ServerName</span>));
                <span class="r171 r">psoClass</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#c356753c4c8616c8" class="i field">CimHashCodeProperty</a>, <span class="r170 r">cimClass</span>.<span class="i">GetHashCode</span>()));
 
                <a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a> <span id="r172 rd" class="r172 r">cimClassSerializationId</span> = <b>new</b> <span class="t">CimClassSerializationId</span>(
                    <span class="r170 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>,
                    <span class="r170 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">Namespace</span>,
                    <span class="r170 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ServerName</span>,
                    <span class="r170 r">cimClass</span>.<span class="i">GetHashCode</span>());
                <b>if</b> (<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#77bf2d2571a5b997" class="i field">cimClassSerializationIdCache</a>.<a href="#dfefd2d6e0c96df4" class="i method">DoesDeserializerAlreadyHaveCimClass</a>(<span class="r172 r">cimClassSerializationId</span>))
                {
                    <b>break</b>;
                }
 
                <span class="r168 r">serializedClasses</span>.<span class="i">Enqueue</span>(<span class="r172 r">cimClassSerializationId</span>);
                <b>byte</b>[] <span id="r173 rd" class="r173 r">miXmlBytes</span> = <a href="#e12149b32611d131" class="i field">s_cimSerializer</a>.<span class="i">Value</span>.<span class="i">Serialize</span>(<span class="r170 r">cimClass</span>, <span class="i">ClassSerializationOptions</span>.<span class="i">None</span>);
                <b>string</b> <span id="r174 rd" class="r174 r">miXmlString</span> = <span class="i">Encoding</span>.<span class="i">Unicode</span>.<span class="i">GetString</span>(<span class="r173 r">miXmlBytes</span>, 0, <span class="r173 r">miXmlBytes</span>.<span class="i">Length</span>);
                <span class="r171 r">psoClass</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#798a55af54c453ca" class="i field">CimMiXmlProperty</a>, <span class="r174 r">miXmlString</span>));
            }
 
            <span class="r169 r">psoClasses</span>.<span class="i">Reverse</span>();
 
            <span class="c">//</span>
            <span class="c">// UPDATE CLASSDECL CACHE</span>
            <span class="c">//</span>
            <b>foreach</b> (<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a> <span id="r175 rd" class="r175 r">serializedClassId</span> <b>in</b> <span class="r168 r">serializedClasses</span>)
            {
                <a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#77bf2d2571a5b997" class="i field">cimClassSerializationIdCache</a>.<a href="#fa080504f32d01e3" class="i method">AddClassToCache</a>(<span class="r175 r">serializedClassId</span>);
            }
 
            <span class="c">//</span>
            <span class="c">// ATTACH CLASS METADATA TO THE OBJECT BEING SERIALIZED</span>
            <span class="c">//</span>
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r176 rd" class="r176 r">classMetadataProperty</span> = <span class="r166 r">psObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#b6e2174e3f284810" class="i field">CimClassMetadataProperty</a>];
            <b>if</b> (<span class="r176 r">classMetadataProperty</span> != <b>null</b>)
            {
                <span class="r176 r">classMetadataProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> = <span class="r169 r">psoClasses</span>;
            }
            <b>else</b>
            {
                <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r177 rd" class="r177 r">classMetadataNote</span> = <b>new</b> <span class="t">PSNoteProperty</span>(
                    <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#b6e2174e3f284810" class="i field">CimClassMetadataProperty</a>,
                    <span class="r169 r">psoClasses</span>);
                <span class="r177 r">classMetadataNote</span>.<a href="MshMemberInfo.cs.html#ddc58fcb9ef869dd" class="i property">IsHidden</a> = <b>true</b>;
                <span class="r166 r">psObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r177 r">classMetadataNote</span>);
            }
 
            <span class="c">// ATTACH INSTANCE METADATA TO THE OBJECT BEING SERIALIZED</span>
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r178 rd" class="r178 r">namesOfModifiedProperties</span> = <span class="r167 r">cimInstance</span>
                .<span class="i">CimInstanceProperties</span>
                .<span class="i">Where</span>(<b>static</b> <span id="r179 rd" class="r179 r">p</span> =&gt; <span class="r179 r">p</span>.<span class="i">IsValueModified</span>)
                .<span class="i">Select</span>(<b>static</b> <span id="r180 rd" class="r180 r">p</span> =&gt; <span class="r180 r">p</span>.<span class="i">Name</span>)
                .<span class="i">ToList</span>();
            <b>if</b> (<span class="r178 r">namesOfModifiedProperties</span>.<span class="i">Count</span> != 0)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r181 rd" class="r181 r">instanceMetadata</span> = <b>new</b> <a href="MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
                <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r182 rd" class="r182 r">instanceMetadataProperty</span> = <span class="r166 r">psObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#31f00c9a81dd5b6e" class="i field">CimInstanceMetadataProperty</a>];
                <b>if</b> (<span class="r182 r">instanceMetadataProperty</span> != <b>null</b>)
                {
                    <span class="r182 r">instanceMetadataProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> = <span class="r181 r">instanceMetadata</span>;
                }
                <b>else</b>
                {
                    <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r183 rd" class="r183 r">instanceMetadataNote</span> = <b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#31f00c9a81dd5b6e" class="i field">CimInstanceMetadataProperty</a>, <span class="r181 r">instanceMetadata</span>);
                    <span class="r183 r">instanceMetadataNote</span>.<a href="MshMemberInfo.cs.html#ddc58fcb9ef869dd" class="i property">IsHidden</a> = <b>true</b>;
                    <span class="r166 r">psObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r183 r">instanceMetadataNote</span>);
                }
 
                <span class="r181 r">instanceMetadata</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a> = <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>.<a href="TypeTable.cs.html#a6ad0f52740814ac" class="i field">Empty</a>;
 
                <span class="r181 r">instanceMetadata</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(
                    <b>new</b> <span class="t">PSNoteProperty</span>(
                        <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#cc425014b6f804f7" class="i field">CimModifiedProperties</a>,
                        <b>string</b>.<span class="i">Join</span>(<span class="s">&quot; &quot;</span>, <span class="r178 r">namesOfModifiedProperties</span>)));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes start element, attributes and typeNames for PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r184 r">mshObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r185 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r186 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r187 r">refId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">writeTypeNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true, TypeName information is written, else not.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">toStringValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If not null then ToString information is written.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="fa055d884ada73db" href="../R/fa055d884ada73db.html" target="n" data-glyph="76,1" class="i method">WriteStartOfPSObject</a>
        (
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r184 rd" class="r184 r">mshObject</span>,
            <b>string</b> <span id="r185 rd" class="r185 r">streamName</span>,
            <b>string</b> <span id="r186 rd" class="r186 r">property</span>,
            <b>string</b> <span id="r187 rd" class="r187 r">refId</span>,
            <b>bool</b> <span id="r188 rd" class="r188 r">writeTypeNames</span>,
            <b>string</b> <span id="r189 rd" class="r189 r">toStringValue</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r184 r">mshObject</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="c">// Write PSObject start element.</span>
            <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#55152cd7ae13df89" class="i field">PSObjectTag</a>);
 
            <b>if</b> (<span class="r185 r">streamName</span> != <b>null</b>)
            {
                <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r185 r">streamName</span>);
            }
 
            <b>if</b> (<span class="r186 r">property</span> != <b>null</b>)
            {
                <a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r186 r">property</span>);
            }
 
            <b>if</b> (<span class="r187 r">refId</span> != <b>null</b>)
            {
                <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>, <span class="r187 r">refId</span>);
            }
 
            <b>if</b> (<span class="r188 r">writeTypeNames</span>)
            {
                <span class="c">// Write TypeNames</span>
                <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <span id="r190 rd" class="r190 r">typeNames</span> = <span class="r184 r">mshObject</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>;
                <b>if</b> (<span class="r190 r">typeNames</span>.<span class="i">Count</span> &gt; 0)
                {
                    <b>string</b> <span id="r191 rd" class="r191 r">typeNameHierarchyReferenceId</span> = <a href="#ef2cf95cfc736bfb" class="i field">_typeRefIdHandler</a>.<a href="#b4bc07b44a2d34bc" class="i method">GetRefId</a>(<span class="r190 r">typeNames</span>);
                    <b>if</b> (<span class="r191 r">typeNameHierarchyReferenceId</span> == <b>null</b>)
                    {
                        <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#3556fda8cf74c102" class="i field">TypeNamesTag</a>);
 
                        <span class="c">// Create a new refId and write it as attribute</span>
                        <b>string</b> <span id="r192 rd" class="r192 r">tnRefId</span> = <a href="#ef2cf95cfc736bfb" class="i field">_typeRefIdHandler</a>.<a href="#db499d5050d69562" class="i method">SetRefId</a>(<span class="r190 r">typeNames</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r192 r">tnRefId</span> != <b>null</b>, <span class="s">&quot;SetRefId should always succeed for strings&quot;</span>);
                        <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>, <span class="r192 r">tnRefId</span>);
 
                        <b>foreach</b> (<b>string</b> <span id="r193 rd" class="r193 r">type</span> <b>in</b> <span class="r190 r">typeNames</span>)
                        {
                            <a href="#5a0b104e7a051a09" class="i method">WriteEncodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#476bdd03866c20b1" class="i field">TypeNamesItemTag</a>, <span class="r193 r">type</span>);
                        }
 
                        <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
                    }
                    <b>else</b>
                    {
                        <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#9d4a1e751c04e939" class="i field">TypeNamesReferenceTag</a>);
                        <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>, <span class="r191 r">typeNameHierarchyReferenceId</span>);
                        <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
                    }
                }
            }
 
            <b>if</b> (<span class="r189 r">toStringValue</span> != <b>null</b>)
            {
                <a href="#5a0b104e7a051a09" class="i method">WriteEncodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#c957bfb06f934b47" class="i field">ToStringElementTag</a>, <span class="r189 r">toStringValue</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> membersets
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if PSObject has notes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="f4436c7c1dd3fd7b" href="../R/f4436c7c1dd3fd7b.html" target="n" data-glyph="76,1" class="i method">PSObjectHasNotes</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r194 rd" class="r194 r">source</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r194 r">source</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>if</b> (<span class="r194 r">source</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a> != <b>null</b> &amp;&amp; <span class="r194 r">source</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>.<a href="MshMemberInfo.cs.html#85006968f446d94b" class="i property">Count</a> &gt; 0)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private bool</b>? <a id="5c486a1001f4ee65" href="../R/5c486a1001f4ee65.html" target="n" data-glyph="46,1" class="i field">_canUseDefaultRunspaceInThreadSafeManner</a>;
 
        <b>private bool</b> <a id="8da197fefe4cc241" href="../R/8da197fefe4cc241.html" target="n" data-glyph="106,1" class="i property">CanUseDefaultRunspaceInThreadSafeManner</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<a href="#5c486a1001f4ee65" class="i field">_canUseDefaultRunspaceInThreadSafeManner</a>.<span class="i">HasValue</span>)
                {
                    <a href="#5c486a1001f4ee65" class="i field">_canUseDefaultRunspaceInThreadSafeManner</a> = <a href="hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="hostifaces/Connection.cs.html#1d816371e3cbeae6" class="i property">CanUseDefaultRunspace</a>;
                }
 
                <b>return</b> <a href="#5c486a1001f4ee65" class="i field">_canUseDefaultRunspaceInThreadSafeManner</a>.<span class="i">Value</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serialize member set. This method serializes without writing</span>
        <span class="c">///</span><span class="c"> enclosing tags and attributes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">me</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> enumerable containing members</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r197 r">writeEnclosingMemberSetElementTag</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if this is true, write an enclosing &quot;</span><span class="c">&lt;</span><span class="c">memberset</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">memberset</span><span class="c">&gt;</span><span class="c">&quot; tag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private void</b> <a id="6b4d3cd24aa5e711" href="../R/6b4d3cd24aa5e711.html" target="n" data-glyph="76,1" class="i method">WriteMemberInfoCollection</a>
        (
            <span class="i">IEnumerable</span>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r195 rd" class="r195 r">me</span>,
            <b>int</b> <span id="r196 rd" class="r196 r">depth</span>,
            <b>bool</b> <span id="r197 rd" class="r197 r">writeEnclosingMemberSetElementTag</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r195 r">me</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <b>bool</b> <span id="r198 rd" class="r198 r">enclosingTagWritten</span> = <b>false</b>;
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r199 rd" class="r199 r">info</span> <b>in</b> <span class="r195 r">me</span>)
            {
                <b>if</b> (!<span class="r199 r">info</span>.<a href="MshMemberInfo.cs.html#5eeed8a563ab1dd5" class="i property">ShouldSerialize</a>)
                {
                    <b>continue</b>;
                }
 
                <b>int</b> <span id="r200 rd" class="r200 r">depthOfMember</span> = <span class="r199 r">info</span>.<a href="MshMemberInfo.cs.html#8a7c2cbc9d911d41" class="i property">IsInstance</a> ? <span class="r196 r">depth</span> : <span class="r196 r">depth</span> - 1;
 
                <b>if</b> (<span class="r199 r">info</span>.<a href="MshMemberInfo.cs.html#96599175ac2fa1f6" class="i property">MemberType</a> == (<span class="r199 r">info</span>.<a href="MshMemberInfo.cs.html#96599175ac2fa1f6" class="i property">MemberType</a> &amp; <a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#65fc4239175168bd" class="i field">Properties</a>))
                {
                    <b>bool</b> <span id="r201 rd" class="r201 r">gotValue</span>;
                    <b>object</b> <span id="r202 rd" class="r202 r">value</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#a347fb25facfcfe4" class="i method">GetPropertyValueInThreadSafeManner</a>((<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>)<span class="r199 r">info</span>, <a href="#fafbc094ffa8966a" class="k">this</a>.<a href="#8da197fefe4cc241" class="i property">CanUseDefaultRunspaceInThreadSafeManner</a>, <b>out</b> <span class="r201 r">gotValue</span>);
                    <b>if</b> (<span class="r201 r">gotValue</span>)
                    {
                        <b>if</b> (<span class="r197 r">writeEnclosingMemberSetElementTag</span> &amp;&amp; !<span class="r198 r">enclosingTagWritten</span>)
                        {
                            <span class="r198 r">enclosingTagWritten</span> = <b>true</b>;
                            <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8a520e1fcc48fc22" class="i field">MemberSet</a>);
                        }
 
                        <a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r202 r">value</span>, <b>null</b>, <span class="r199 r">info</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r200 r">depthOfMember</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r199 r">info</span>.<a href="MshMemberInfo.cs.html#96599175ac2fa1f6" class="i property">MemberType</a> == <a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#13dbf4d3444210a7" class="i field">MemberSet</a>)
                {
                    <b>if</b> (<span class="r197 r">writeEnclosingMemberSetElementTag</span> &amp;&amp; !<span class="r198 r">enclosingTagWritten</span>)
                    {
                        <span class="r198 r">enclosingTagWritten</span> = <b>true</b>;
                        <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8a520e1fcc48fc22" class="i field">MemberSet</a>);
                    }
 
                    <a href="#05e8a8ebec571474" class="i method">WriteMemberSet</a>((<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>)<span class="r199 r">info</span>, <span class="r200 r">depthOfMember</span>);
                }
            }
 
            <b>if</b> (<span class="r198 r">enclosingTagWritten</span>)
            {
                <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes MemberSet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="05e8a8ebec571474" href="../R/05e8a8ebec571474.html" target="n" data-glyph="76,1" class="i method">WriteMemberSet</a>
        (
            <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <span id="r203 rd" class="r203 r">set</span>,
            <b>int</b> <span id="r204 rd" class="r204 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r203 r">set</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <b>if</b> (!<span class="r203 r">set</span>.<a href="MshMemberInfo.cs.html#5eeed8a563ab1dd5" class="i property">ShouldSerialize</a>)
            {
                <b>return</b>;
            }
 
            <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8a520e1fcc48fc22" class="i field">MemberSet</a>);
            <a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r203 r">set</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
            <span class="i">WriteMemberInfoCollection</span>(<span class="r203 r">set</span>.<a href="MshMemberInfo.cs.html#23ba75fd4c58af6c" class="i property">Members</a>, <span class="r204 r">depth</span>, <b>false</b>);
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> membersets
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes properties of PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="80a522462bd42b0e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">WritePSObjectProperties</a>
        (
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r205 rd" class="r205 r">source</span>,
            <b>int</b> <span id="r206 rd" class="r206 r">depth</span>,
            <span class="i">IEnumerable</span>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r207 rd" class="r207 r">specificPropertiesToSerialize</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r205 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the information&quot;</span>);
 
            <span class="c">// Depth available for each property is one less</span>
            --<span class="r206 r">depth</span>;
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r206 r">depth</span> &gt;= 0, <span class="s">&quot;depth should be greater or equal to zero&quot;</span>);
 
            <b>if</b> (<span class="r207 r">specificPropertiesToSerialize</span> != <b>null</b>)
            {
                <a href="#69c32b2ae0c77bff" class="i method">SerializeProperties</a>(<span class="r207 r">specificPropertiesToSerialize</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d37b5e9f200f7f6a" class="i field">AdapterProperties</a>, <span class="r206 r">depth</span>);
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r205 r">source</span>.<a href="MshObject.cs.html#32a7100ca0d323b0" class="i method">ShouldSerializeAdapter</a>())
                {
                    <span class="i">IEnumerable</span>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r208 rd" class="r208 r">adapterCollection</span> = <b>null</b>;
                    <span class="r208 r">adapterCollection</span> = <span class="r205 r">source</span>.<a href="MshObject.cs.html#012f97bbf4e8d756" class="i method">GetAdaptedProperties</a>();
                    <b>if</b> (<span class="r208 r">adapterCollection</span> != <b>null</b>)
                    {
                        <a href="#69c32b2ae0c77bff" class="i method">SerializeProperties</a>(<span class="r208 r">adapterCollection</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d37b5e9f200f7f6a" class="i field">AdapterProperties</a>, <span class="r206 r">depth</span>);
                    }
                }
            }
        }
 
        <b>private void</b> <a id="99404c3d36a6131d" href="../R/99404c3d36a6131d.html" target="n" data-glyph="76,1" class="i method">SerializeInstanceProperties</a>
        (
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r209 rd" class="r209 r">source</span>,
            <b>int</b> <span id="r210 rd" class="r210 r">depth</span>
        )
        {
            <span class="c">// Serialize instanceMembers</span>
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r209 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the information&quot;</span>);
            <a href="MshMemberInfo.cs.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r211 rd" class="r211 r">instanceMembers</span> = <span class="r209 r">source</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>;
            <b>if</b> (<span class="r211 r">instanceMembers</span> != <b>null</b>)
            {
                <span class="i">WriteMemberInfoCollection</span>(<span class="r211 r">instanceMembers</span>, <span class="r210 r">depth</span>, <b>true</b>);
            }
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt; <a id="1ee626b30a90d3bd" href="../R/1ee626b30a90d3bd.html" target="n" data-glyph="46,1" class="i field">_extendedMembersCollection</a>;
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt; <a id="a236cb0c2f46edce" href="../R/a236cb0c2f46edce.html" target="n" data-glyph="106,1" class="i property">ExtendedMembersCollection</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#1ee626b30a90d3bd" class="i field">_extendedMembersCollection</a> ??=
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#855191b609bc2b2f" class="i method">GetMemberCollection</a>(<a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#9a5e7eb3c8a4bb72" class="i field">Extended</a>, <a href="#8739a56287fa3e83" class="i field">_typeTable</a>);
            }
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt; <a id="f97118af3ee402ca" href="../R/f97118af3ee402ca.html" target="n" data-glyph="46,1" class="i field">_allPropertiesCollection</a>;
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt; <a id="3cf2230bfd688231" href="../R/3cf2230bfd688231.html" target="n" data-glyph="106,1" class="i property">AllPropertiesCollection</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f97118af3ee402ca" class="i field">_allPropertiesCollection</a> ??= <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#1f16d9e0f8f39912" class="i method">GetPropertyCollection</a>(<a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#525826a417e26897" class="i field">All</a>, <a href="#8739a56287fa3e83" class="i field">_typeTable</a>);
            }
        }
 
        <b>private void</b> <a id="ef200837871aa673" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SerializeExtendedProperties</a>
        (
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r212 rd" class="r212 r">source</span>,
            <b>int</b> <span id="r213 rd" class="r213 r">depth</span>,
            <span class="i">IEnumerable</span>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r214 rd" class="r214 r">specificPropertiesToSerialize</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r212 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the information&quot;</span>);
 
            <span class="i">IEnumerable</span>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r215 rd" class="r215 r">extendedMembersEnumerable</span> = <b>null</b>;
            <b>if</b> (<span class="r214 r">specificPropertiesToSerialize</span> == <b>null</b>)
            {
                <span class="c">// Get only extended members including hidden members from the psobect source.</span>
                <a href="MshMemberInfo.cs.html#520db5b1e8966ea1" class="t t">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r216 rd" class="r216 r">membersToSearch</span> =
                    <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r212 r">source</span>, <a href="#a236cb0c2f46edce" class="i property">ExtendedMembersCollection</a>);
                <span class="r215 r">extendedMembersEnumerable</span> = <span class="r216 r">membersToSearch</span>.<span class="i">Match</span>(
                        <span class="s">&quot;*&quot;</span>,
                        <a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#65fc4239175168bd" class="i field">Properties</a> | <a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#5d1f01e046fd94a7" class="i field">PropertySet</a> | <a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#13dbf4d3444210a7" class="i field">MemberSet</a>,
                        <a href="MshMemberInfo.cs.html#130b69d5bf1c070c" class="t t">MshMemberMatchOptions</a>.<a href="MshMemberInfo.cs.html#62aaa57000246721" class="i field">IncludeHidden</a> | <a href="MshMemberInfo.cs.html#130b69d5bf1c070c" class="t t">MshMemberMatchOptions</a>.<a href="MshMemberInfo.cs.html#7cbb9ec1f3b07c96" class="i field">OnlySerializable</a>);
            }
            <b>else</b>
            {
                <span class="i">List</span>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r217 rd" class="r217 r">extendedMembersList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r212 r">source</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>);
                <span class="r215 r">extendedMembersEnumerable</span> = <span class="r217 r">extendedMembersList</span>;
 
                <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r218 rd" class="r218 r">member</span> <b>in</b> <span class="r214 r">specificPropertiesToSerialize</span>)
                {
                    <b>if</b> (<span class="r218 r">member</span>.<a href="MshMemberInfo.cs.html#8a7c2cbc9d911d41" class="i property">IsInstance</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>if</b> (<span class="r218 r">member</span> <b>is</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="r217 r">extendedMembersList</span>.<span class="i">Add</span>(<span class="r218 r">member</span>);
                }
            }
 
            <b>if</b> (<span class="r215 r">extendedMembersEnumerable</span> != <b>null</b>)
            {
                <a href="#6b4d3cd24aa5e711" class="i method">WriteMemberInfoCollection</a>(<span class="r215 r">extendedMembersEnumerable</span>, <span class="r213 r">depth</span>, <b>true</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes properties from collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r219 r">propertyCollection</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Collection of properties to serialize</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r220 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name for enclosing element tag</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r221 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> depth to which each property should be</span>
        <span class="c">///</span><span class="c"> serialized</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="69c32b2ae0c77bff" href="../R/69c32b2ae0c77bff.html" target="n" data-glyph="76,1" class="i method">SerializeProperties</a>
        (
            <span class="i">IEnumerable</span>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r219 rd" class="r219 r">propertyCollection</span>,
            <b>string</b> <span id="r220 rd" class="r220 r">name</span>,
            <b>int</b> <span id="r221 rd" class="r221 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r219 r">propertyCollection</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <b>bool</b> <span id="r222 rd" class="r222 r">startElementWritten</span> = <b>false</b>;
 
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r223 rd" class="r223 r">info</span> <b>in</b> <span class="r219 r">propertyCollection</span>)
            {
                <b>if</b> (!(<span class="r223 r">info</span> <b>is</b> <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r224 rd" class="r224 r">prop</span>))
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (!<span class="r222 r">startElementWritten</span>)
                {
                    <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r220 r">name</span>);
                    <span class="r222 r">startElementWritten</span> = <b>true</b>;
                }
 
                <b>bool</b> <span id="r225 rd" class="r225 r">success</span>;
                <b>object</b> <span id="r226 rd" class="r226 r">value</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#a347fb25facfcfe4" class="i method">GetPropertyValueInThreadSafeManner</a>(<span class="r224 r">prop</span>, <a href="#fafbc094ffa8966a" class="k">this</a>.<a href="#8da197fefe4cc241" class="i property">CanUseDefaultRunspaceInThreadSafeManner</a>, <b>out</b> <span class="r225 r">success</span>);
                <b>if</b> (<span class="r225 r">success</span>)
                {
                    <a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r226 r">value</span>, <b>null</b>, <span class="r224 r">prop</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r221 r">depth</span>);
                }
            }
 
            <b>if</b> (<span class="r222 r">startElementWritten</span>)
            {
                <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> base properties
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> WritePSObject
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> enumerable and dictionary
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes IEnumerable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">enumerable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> enumerable which is serialized</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">tag</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2b5018c1d84aca1b" href="../R/2b5018c1d84aca1b.html" target="n" data-glyph="76,1" class="i method">WriteEnumerable</a>
        (
            <span class="i">IEnumerable</span> <span id="r227 rd" class="r227 r">enumerable</span>,
            <b>string</b> <span id="r228 rd" class="r228 r">tag</span>,
            <b>int</b> <span id="r229 rd" class="r229 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r227 r">enumerable</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r228 r">tag</span>), <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="c">// Start element</span>
            <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r228 r">tag</span>);
 
            <span class="i">IEnumerator</span> <span id="r230 rd" class="r230 r">enumerator</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r230 r">enumerator</span> = <span class="r227 r">enumerable</span>.<span class="i">GetEnumerator</span>();
                <b>try</b>
                {
                    <span class="r230 r">enumerator</span>.<span class="i">Reset</span>();
                }
                <b>catch</b> (<span class="i n">System</span>.<span class="i">NotSupportedException</span>)
                {
                    <span class="c">// ignore exceptions thrown when the enumerator doesn&#39;t support Reset() method as in win8:948569</span>
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r231 rd" class="r231 r">exception</span>)
            {
                <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#0b79bfbf099710d3" class="i field">Serializer_EnumerationFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r227 r">enumerable</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>,
                    <span class="r231 r">exception</span>.<span class="i">ToString</span>());
 
                <span class="r230 r">enumerator</span> = <b>null</b>;
            }
 
            <span class="c">// AD has incorrect implementation of IEnumerable where they returned null</span>
            <span class="c">// for GetEnumerator instead of empty enumerator</span>
            <b>if</b> (<span class="r230 r">enumerator</span> != <b>null</b>)
            {
                <b>while</b> (<b>true</b>)
                {
                    <b>object</b> <span id="r232 rd" class="r232 r">item</span> = <b>null</b>;
                    <b>try</b>
                    {
                        <b>if</b> (!<span class="r230 r">enumerator</span>.<span class="i">MoveNext</span>())
                        {
                            <b>break</b>;
                        }
                        <b>else</b>
                        {
                            <span class="r232 r">item</span> = <span class="r230 r">enumerator</span>.<span class="i">Current</span>;
                        }
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r233 rd" class="r233 r">exception</span>)
                    {
                        <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                        <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                            <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#0b79bfbf099710d3" class="i field">Serializer_EnumerationFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                            <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                            <span class="r227 r">enumerable</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>,
                            <span class="r233 r">exception</span>.<span class="i">ToString</span>());
 
                        <b>break</b>;
                    }
 
                    <a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r232 r">item</span>, <b>null</b>, <b>null</b>, <span class="r229 r">depth</span>);
                }
            }
            <span class="c">// End element</span>
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializes IDictionary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r234 r">dictionary</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Dictionary which is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r235 r">tag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r236 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="85d9c3624aec8abe" href="../R/85d9c3624aec8abe.html" target="n" data-glyph="76,1" class="i method">WriteDictionary</a>
        (
            <span class="i">IDictionary</span> <span id="r234 rd" class="r234 r">dictionary</span>,
            <b>string</b> <span id="r235 rd" class="r235 r">tag</span>,
            <b>int</b> <span id="r236 rd" class="r236 r">depth</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r234 r">dictionary</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r235 r">tag</span>), <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="c">// Start element</span>
            <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r235 r">tag</span>);
 
            <span class="i">IDictionaryEnumerator</span> <span id="r237 rd" class="r237 r">dictionaryEnum</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r237 r">dictionaryEnum</span> = <span class="r234 r">dictionary</span>.<span class="i">GetEnumerator</span>();
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r238 rd" class="r238 r">exception</span>) <span class="c">// ignore non-severe exceptions</span>
            {
                <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#0b79bfbf099710d3" class="i field">Serializer_EnumerationFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r234 r">dictionary</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>,
                    <span class="r238 r">exception</span>.<span class="i">ToString</span>());
            }
 
            <b>if</b> (<span class="r237 r">dictionaryEnum</span> != <b>null</b>)
            {
                <b>while</b> (<b>true</b>)
                {
                    <b>object</b> <span id="r239 rd" class="r239 r">key</span> = <b>null</b>;
                    <b>object</b> <span id="r240 rd" class="r240 r">value</span> = <b>null</b>;
                    <b>try</b>
                    {
                        <b>if</b> (!<span class="r237 r">dictionaryEnum</span>.<span class="i">MoveNext</span>())
                        {
                            <b>break</b>;
                        }
                        <b>else</b>
                        {
                            <span class="r239 r">key</span> = <span class="r237 r">dictionaryEnum</span>.<span class="i">Key</span>;
                            <span class="r240 r">value</span> = <span class="r237 r">dictionaryEnum</span>.<span class="i">Value</span>;
                        }
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r241 rd" class="r241 r">exception</span>)
                    {
                        <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                        <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                            <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#0b79bfbf099710d3" class="i field">Serializer_EnumerationFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                            <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                            <span class="r234 r">dictionary</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>,
                            <span class="r241 r">exception</span>.<span class="i">ToString</span>());
 
                        <b>break</b>;
                    }
 
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r239 r">key</span> != <b>null</b>, <span class="s">&quot;Dictionary keys should never be null&quot;</span>);
                    <b>if</b> (<span class="r239 r">key</span> == <b>null</b>) <b>break</b>;
 
                    <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#31d86cf81e78e345" class="i field">DictionaryEntryTag</a>);
                    <a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r239 r">key</span>, <b>null</b>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fa73c9a51afaddf8" class="i field">DictionaryKey</a>, <span class="r236 r">depth</span>);
                    <a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r240 r">value</span>, <b>null</b>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#84730c210285badb" class="i field">DictionaryValue</a>, <span class="r236 r">depth</span>);
                    <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
                }
            }
 
            <span class="c">// End element</span>
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> enumerable and dictionary
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> serialize as string
 
        <b>private void</b> <a id="845008d2a5d7125c" href="../R/845008d2a5d7125c.html" target="n" data-glyph="76,1" class="i method">HandlePSObjectAsString</a>(
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r242 rd" class="r242 r">source</span>,
            <b>string</b> <span id="r243 rd" class="r243 r">streamName</span>,
            <b>string</b> <span id="r244 rd" class="r244 r">property</span>,
            <b>int</b> <span id="r245 rd" class="r245 r">depth</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r242 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the information&quot;</span>);
 
            <b>string</b> <span id="r246 rd" class="r246 r">value</span> = <a href="#c5cad9731c6ac8cc" class="i method">GetSerializationString</a>(<span class="r242 r">source</span>);
 
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r247 rd" class="r247 r">pktInfo</span> = <b>null</b>;
            <b>if</b> (<span class="r246 r">value</span> != <b>null</b>)
            {
                <span class="r247 r">pktInfo</span> = <a href="#295889332d482ff3" class="t t">KnownTypes</a>.<span class="i">GetTypeSerializationInfo</span>(<span class="r246 r">value</span>.<span class="i">GetType</span>());
            }
 
            <a href="#f9a09c4ee3f1cb35" class="i method">WritePrimitiveTypePSObject</a>(<span class="r242 r">source</span>, <span class="r246 r">value</span>, <span class="r247 r">pktInfo</span>, <span class="r243 r">streamName</span>, <span class="r244 r">property</span>, <span class="r245 r">depth</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the string from PSObject using the information from</span>
        <span class="c">///</span><span class="c"> types.ps1xml.</span>
        <span class="c">///</span><span class="c"> This string is used for serializing the PSObject at depth 0</span>
        <span class="c">///</span><span class="c"> or when pso.SerializationMethod == SerializationMethod.String.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r248 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSObject to be converted to string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> string value to use for serializing this PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="c5cad9731c6ac8cc" href="../R/c5cad9731c6ac8cc.html" target="n" data-glyph="76,1" class="i method">GetSerializationString</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r248 rd" class="r248 r">source</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r248 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r249 rd" class="r249 r">serializationProperty</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r249 r">serializationProperty</span> = <span class="r248 r">source</span>.<a href="MshObject.cs.html#107cc54a7e00165a" class="i method">GetStringSerializationSource</a>(<a href="#8739a56287fa3e83" class="i field">_typeTable</a>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r250 rd" class="r250 r">e</span>)
            {
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#b2174edc8e63b69c" class="i field">Serializer_ToStringFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r248 r">source</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>,
                    <span class="r250 r">e</span>.<span class="i">InnerException</span> != <b>null</b> ? <span class="r250 r">e</span>.<span class="i">InnerException</span>.<span class="i">ToString</span>() : <span class="r250 r">e</span>.<span class="i">ToString</span>());
            }
 
            <b>string</b> <span id="r251 rd" class="r251 r">result</span> = <b>null</b>;
            <b>if</b> (<span class="r249 r">serializationProperty</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r252 rd" class="r252 r">success</span>;
                <b>object</b> <span id="r253 rd" class="r253 r">val</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#a347fb25facfcfe4" class="i method">GetPropertyValueInThreadSafeManner</a>(<span class="r249 r">serializationProperty</span>, <a href="#fafbc094ffa8966a" class="k">this</a>.<a href="#8da197fefe4cc241" class="i property">CanUseDefaultRunspaceInThreadSafeManner</a>, <b>out</b> <span class="r252 r">success</span>);
                <b>if</b> (<span class="r252 r">success</span> &amp;&amp; (<span class="r253 r">val</span> != <b>null</b>))
                {
                    <span class="r251 r">result</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#3ef9cc7701d3419a" class="i method">GetToString</a>(<span class="r253 r">val</span>);
                }
            }
            <b>else</b>
            {
                <span class="r251 r">result</span> = <a href="#ea376e267181f78f" class="t t">SerializationUtilities</a>.<a href="#3ef9cc7701d3419a" class="i method">GetToString</a>(<span class="r248 r">source</span>);
            }
 
            <b>return</b> <span class="r251 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads the information the PSObject</span>
        <span class="c">///</span><span class="c"> and returns true if this object should be serialized as</span>
        <span class="c">///</span><span class="c"> string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r254 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject to be serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the object needs to be serialized as a string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="5dd77fdfda161e30" href="../R/5dd77fdfda161e30.html" target="n" data-glyph="76,1" class="i method">SerializeAsString</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r254 rd" class="r254 r">source</span>)
        {
            <a href="MshObject.cs.html#9a814b5a84518967" class="t t">SerializationMethod</a> <span id="r255 rd" class="r255 r">method</span> = <span class="r254 r">source</span>.<a href="MshObject.cs.html#08cdba316b979499" class="i method">GetSerializationMethod</a>(<a href="#8739a56287fa3e83" class="i field">_typeTable</a>);
            <b>if</b> (<span class="r255 r">method</span> == <a href="MshObject.cs.html#9a814b5a84518967" class="t t">SerializationMethod</a>.<a href="MshObject.cs.html#39112656c90948bc" class="i field">String</a>)
            {
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticVerbose</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#ed872fb55c3ad2b3" class="i field">Serializer_ModeOverride</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#70f65f055080d924" class="i field">SerializationSettings</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r254 r">source</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>,
                    (<span class="i">UInt32</span>)(<a href="MshObject.cs.html#9a814b5a84518967" class="t t">SerializationMethod</a>.<a href="MshObject.cs.html#39112656c90948bc" class="i field">String</a>));
 
                <b>return</b> <b>true</b>;
            }
            <b>else</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> serialize as string
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compute the serialization depth for an PSObject instance subtree.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r256 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject whose serialization depth has to be computed.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r257 r">depth</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current depth.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private int</b> <a id="c4b3927bd81a0835" href="../R/c4b3927bd81a0835.html" target="n" data-glyph="76,1" class="i method">GetDepthOfSerialization</a>(<b>object</b> <span id="r256 rd" class="r256 r">source</span>, <b>int</b> <span id="r257 rd" class="r257 r">depth</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r256 r">source</span> != <b>null</b>, <span class="s">&quot;Caller should verify source != null&quot;</span>);
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r258 rd" class="r258 r">pso</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r256 r">source</span>);
            <b>if</b> (<span class="r258 r">pso</span> == <b>null</b>)
            {
                <b>return</b> <span class="r257 r">depth</span>;
            }
 
            <b>if</b> (<span class="r258 r">pso</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">CimInstance</span>)
            {
                <b>return</b> 1;
            }
 
            <b>if</b> (<span class="r258 r">pso</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a>)
            {
                <b>return</b> 1;
            }
 
            <b>if</b> (<span class="r258 r">pso</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>)
            {
                <b>return</b> 4;
            }
 
            <b>if</b> (<span class="r258 r">pso</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>)
            {
                <b>return</b> 1;
            }
 
            <b>if</b> ((<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#0b378b732b3e7999" class="i field">options</a> &amp; <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#b1bbe4a98fcbc7bf" class="i field">UseDepthFromTypes</a>) != 0)
            {
                <span class="c">// get the depth from the PSObject</span>
                <span class="c">// NOTE: we assume that the depth out of the PSObject is &gt; 0</span>
                <span class="c">// else we consider it not set in types.ps1xml</span>
                <b>int</b> <span id="r259 rd" class="r259 r">typesPs1xmlDepth</span> = <span class="r258 r">pso</span>.<a href="MshObject.cs.html#59e74d8cba5df10d" class="i method">GetSerializationDepth</a>(<a href="#8739a56287fa3e83" class="i field">_typeTable</a>);
                <b>if</b> (<span class="r259 r">typesPs1xmlDepth</span> &gt; 0)
                {
                    <b>if</b> (<span class="r259 r">typesPs1xmlDepth</span> != <span class="r257 r">depth</span>)
                    {
                        <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<a href="../utils/tracing/PSEtwLog.cs.html#daafe1d1950e6098" class="i method">LogAnalyticVerbose</a>(
                            <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#635bdeef47de9b8d" class="i field">Serializer_DepthOverride</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#70f65f055080d924" class="i field">SerializationSettings</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                            <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                            <span class="r258 r">pso</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>, <span class="r257 r">depth</span>, <span class="r259 r">typesPs1xmlDepth</span>, <a href="#b4859674c7281ecc" class="i field">_depthBelowTopLevel</a>);
 
                        <b>return</b> <span class="r259 r">typesPs1xmlDepth</span>;
                    }
                }
            }
 
            <b>if</b> ((<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#0b378b732b3e7999" class="i field">options</a> &amp; <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#edf7522768bc0938" class="i field">PreserveSerializationSettingOfOriginal</a>) != 0)
            {
                <b>if</b> ((<span class="r258 r">pso</span>.<a href="MshObject.cs.html#598b509cd0dd9b32" class="i property">IsDeserialized</a>) &amp;&amp; (<span class="r257 r">depth</span> &lt;= 0))
                {
                    <b>return</b> 1;
                }
            }
 
            <b>return</b> <span class="r257 r">depth</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r260 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8be95c1707843982" href="../R/8be95c1707843982.html" target="n" data-glyph="76,1" class="i method">WriteNull</a>(<b>string</b> <span id="r260 rd" class="r260 r">streamName</span>, <b>string</b> <span id="r261 rd" class="r261 r">property</span>)
        {
            <a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8ffeca899604fbae" class="i field">NilTag</a>);
 
            <b>if</b> (<span class="r260 r">streamName</span> != <b>null</b>)
            {
                <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r260 r">streamName</span>);
            }
 
            <b>if</b> (<span class="r261 r">property</span> != <b>null</b>)
            {
                <a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r261 r">property</span>);
            }
 
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> known type serialization
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes raw string as item or property in Monad namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r262 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r263 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the stream to write. Do not write if null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r264 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. Pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r265 r">raw</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r266 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="0c079b4ce34a0c01" href="../R/0c079b4ce34a0c01.html" target="n" data-glyph="76,1" class="i method">WriteRawString</a>
        (
            <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r262 rd" class="r262 r">serializer</span>,
            <b>string</b> <span id="r263 rd" class="r263 r">streamName</span>,
            <b>string</b> <span id="r264 rd" class="r264 r">property</span>,
            <b>string</b> <span id="r265 rd" class="r265 r">raw</span>,
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r266 rd" class="r266 r">entry</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r262 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r265 r">raw</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r266 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <b>if</b> (<span class="r264 r">property</span> != <b>null</b>)
            {
                <span class="r262 r">serializer</span>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r266 r">entry</span>.<a href="#6d5d3a3c4e4601a4" class="i property">PropertyTag</a>);
                <span class="r262 r">serializer</span>.<a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r264 r">property</span>);
            }
            <b>else</b>
            {
                <span class="r262 r">serializer</span>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r266 r">entry</span>.<a href="#1c4666f39a3dc592" class="i property">ItemTag</a>);
            }
 
            <b>if</b> (<span class="r263 r">streamName</span> != <b>null</b>)
            {
                <span class="r262 r">serializer</span>.<a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r263 r">streamName</span>);
            }
 
            <span class="r262 r">serializer</span>.<a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteRaw</span>(<span class="r265 r">raw</span>);
            <span class="r262 r">serializer</span>.<a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes an item or property in Monad namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r267 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r268 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r269 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. Pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r270 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to be written.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r271 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="bf318610b4d8dbe0" href="../R/bf318610b4d8dbe0.html" target="n" data-glyph="76,1" class="i method">WriteOnePrimitiveKnownType</a>
        (
            <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r267 rd" class="r267 r">serializer</span>,
            <b>string</b> <span id="r268 rd" class="r268 r">streamName</span>,
            <b>string</b> <span id="r269 rd" class="r269 r">property</span>,
            <b>object</b> <span id="r270 rd" class="r270 r">source</span>,
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r271 rd" class="r271 r">entry</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r267 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r270 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r271 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <b>if</b> (<span class="r271 r">entry</span>.<a href="#676e8034cc70c3c9" class="i property">Serializer</a> == <b>null</b>)
            {
                <span class="c">// we are not using GetToString, because we assume that</span>
                <span class="c">// ToString() for primitive types never throws</span>
                <b>string</b> <span id="r272 rd" class="r272 r">value</span> = <span class="i">Convert</span>.<span class="i">ToString</span>(<span class="r270 r">source</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r272 r">value</span> != <b>null</b>, <span class="s">&quot;ToString shouldn&#39;t return null for primitive types&quot;</span>);
                <a href="#0c079b4ce34a0c01" class="i method">WriteRawString</a>(<span class="r267 r">serializer</span>, <span class="r268 r">streamName</span>, <span class="r269 r">property</span>, <span class="r272 r">value</span>, <span class="r271 r">entry</span>);
            }
            <b>else</b>
            {
                <span class="r271 r">entry</span>.<a href="#676e8034cc70c3c9" class="i property">Serializer</a>(<span class="r267 r">serializer</span>, <span class="r268 r">streamName</span>, <span class="r269 r">property</span>, <span class="r270 r">source</span>, <span class="r271 r">entry</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes DateTime as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r273 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r274 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r275 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r276 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DateTime to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r277 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="4e3881a68a2f303a" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteDateTime</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r273 rd" class="r273 r">serializer</span>, <b>string</b> <span id="r274 rd" class="r274 r">streamName</span>, <b>string</b> <span id="r275 rd" class="r275 r">property</span>, <b>object</b> <span id="r276 rd" class="r276 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r277 rd" class="r277 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r273 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r276 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r277 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteRawString</span>(<span class="r273 r">serializer</span>, <span class="r274 r">streamName</span>, <span class="r275 r">property</span>, <span class="i">XmlConvert</span>.<span class="i">ToString</span>((<span class="i">DateTime</span>)<span class="r276 r">source</span>, <span class="i">XmlDateTimeSerializationMode</span>.<span class="i">RoundtripKind</span>), <span class="r277 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes Version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r278 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r279 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r280 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r281 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Version to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r282 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="948d3559d80a0eec" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteVersion</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r278 rd" class="r278 r">serializer</span>, <b>string</b> <span id="r279 rd" class="r279 r">streamName</span>, <b>string</b> <span id="r280 rd" class="r280 r">property</span>, <b>object</b> <span id="r281 rd" class="r281 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r282 rd" class="r282 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r278 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r281 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r281 r">source</span> <b>is</b> <span class="i">Version</span>, <span class="s">&quot;Caller should verify that typeof(source) is Version&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r282 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteRawString</span>(<span class="r278 r">serializer</span>, <span class="r279 r">streamName</span>, <span class="r280 r">property</span>, <span class="i">Convert</span>.<span class="i">ToString</span>(<span class="r281 r">source</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>), <span class="r282 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes SemanticVersion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r283 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r284 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r285 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r286 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Version to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r287 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="175b1896cbac67a7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteSemanticVersion</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r283 rd" class="r283 r">serializer</span>, <b>string</b> <span id="r284 rd" class="r284 r">streamName</span>, <b>string</b> <span id="r285 rd" class="r285 r">property</span>, <b>object</b> <span id="r286 rd" class="r286 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r287 rd" class="r287 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r283 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r286 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r286 r">source</span> <b>is</b> <a href="PSVersionInfo.cs.html#a57a3e81874a26c3" class="t t">SemanticVersion</a>, <span class="s">&quot;Caller should verify that typeof(source) is Version&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r287 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteRawString</span>(<span class="r283 r">serializer</span>, <span class="r284 r">streamName</span>, <span class="r285 r">property</span>, <span class="i">Convert</span>.<span class="i">ToString</span>(<span class="r286 r">source</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>), <span class="r287 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serialize scriptblock as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r289 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r290 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r291 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Scriptblock to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r292 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="d5d34b4185b7736d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteScriptBlock</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r288 rd" class="r288 r">serializer</span>, <b>string</b> <span id="r289 rd" class="r289 r">streamName</span>, <b>string</b> <span id="r290 rd" class="r290 r">property</span>, <b>object</b> <span id="r291 rd" class="r291 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r292 rd" class="r292 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r288 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r291 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r291 r">source</span> <b>is</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>, <span class="s">&quot;Caller should verify that typeof(source) is ScriptBlock&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r292 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteEncodedString</span>(<span class="r288 r">serializer</span>, <span class="r289 r">streamName</span>, <span class="r290 r">property</span>, <span class="i">Convert</span>.<span class="i">ToString</span>(<span class="r291 r">source</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>), <span class="r292 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serialize URI as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r293 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r294 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r295 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r296 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">URI to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r297 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="f1e6370847de260e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteUri</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r293 rd" class="r293 r">serializer</span>, <b>string</b> <span id="r294 rd" class="r294 r">streamName</span>, <b>string</b> <span id="r295 rd" class="r295 r">property</span>, <b>object</b> <span id="r296 rd" class="r296 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r297 rd" class="r297 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r293 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r296 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r296 r">source</span> <b>is</b> <span class="i">Uri</span>, <span class="s">&quot;Caller should verify that typeof(source) is Uri&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r297 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteEncodedString</span>(<span class="r293 r">serializer</span>, <span class="r294 r">streamName</span>, <span class="r295 r">property</span>, <span class="i">Convert</span>.<span class="i">ToString</span>(<span class="r296 r">source</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>), <span class="r297 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serialize string as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r298 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r299 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r300 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r301 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r302 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="daa4eea504ab19b1" href="../R/daa4eea504ab19b1.html" target="n" data-glyph="74,1" class="i method">WriteEncodedString</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r298 rd" class="r298 r">serializer</span>, <b>string</b> <span id="r299 rd" class="r299 r">streamName</span>, <b>string</b> <span id="r300 rd" class="r300 r">property</span>, <b>object</b> <span id="r301 rd" class="r301 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r302 rd" class="r302 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r298 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r301 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r301 r">source</span> <b>is string</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r302 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <b>if</b> (<span class="r300 r">property</span> != <b>null</b>)
            {
                <span class="r298 r">serializer</span>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r302 r">entry</span>.<a href="#6d5d3a3c4e4601a4" class="i property">PropertyTag</a>);
                <span class="r298 r">serializer</span>.<a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r300 r">property</span>);
            }
            <b>else</b>
            {
                <span class="r298 r">serializer</span>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r302 r">entry</span>.<a href="#1c4666f39a3dc592" class="i property">ItemTag</a>);
            }
 
            <b>if</b> (<span class="r299 r">streamName</span> != <b>null</b>)
            {
                <span class="r298 r">serializer</span>.<a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r299 r">streamName</span>);
            }
 
            <span class="c">// Note: We do not use WriteRaw for serializing string. WriteString</span>
            <span class="c">// does necessary escaping which may be needed for certain</span>
            <span class="c">// characters.</span>
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r301 r">source</span> <b>is string</b>, <span class="s">&quot;Caller should verify that typeof(source) is String&quot;</span>);
            <b>string</b> <span id="r303 rd" class="r303 r">s</span> = (<b>string</b>)<span class="r301 r">source</span>;
            <b>string</b> <span id="r304 rd" class="r304 r">encoded</span> = <a href="#f5570529e128777b" class="i method">EncodeString</a>(<span class="r303 r">s</span>);
            <span class="r298 r">serializer</span>.<a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteString</span>(<span class="r304 r">encoded</span>);
 
            <span class="r298 r">serializer</span>.<a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes Double as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r305 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r306 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r307 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Double to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r309 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="32f375e910f5fe7c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteDouble</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r305 rd" class="r305 r">serializer</span>, <b>string</b> <span id="r306 rd" class="r306 r">streamName</span>, <b>string</b> <span id="r307 rd" class="r307 r">property</span>, <b>object</b> <span id="r308 rd" class="r308 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r309 rd" class="r309 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r305 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r308 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r309 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteRawString</span>(<span class="r305 r">serializer</span>, <span class="r306 r">streamName</span>, <span class="r307 r">property</span>, <span class="i">XmlConvert</span>.<span class="i">ToString</span>((<b>double</b>)<span class="r308 r">source</span>), <span class="r309 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes Char as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r310 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r311 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r312 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r313 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Char to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r314 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="38d47cbb838f1ac4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteChar</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r310 rd" class="r310 r">serializer</span>, <b>string</b> <span id="r311 rd" class="r311 r">streamName</span>, <b>string</b> <span id="r312 rd" class="r312 r">property</span>, <b>object</b> <span id="r313 rd" class="r313 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r314 rd" class="r314 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r310 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r313 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r314 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="c">// Char is defined as unsigned short in schema</span>
            <span class="i">WriteRawString</span>(<span class="r310 r">serializer</span>, <span class="r311 r">streamName</span>, <span class="r312 r">property</span>, <span class="i">XmlConvert</span>.<span class="i">ToString</span>((<span class="i">UInt16</span>)(<b>char</b>)<span class="r313 r">source</span>), <span class="r314 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes Boolean as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r315 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r316 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r317 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r318 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Boolean to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="45b6cef5179f4108" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteBoolean</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r315 rd" class="r315 r">serializer</span>, <b>string</b> <span id="r316 rd" class="r316 r">streamName</span>, <b>string</b> <span id="r317 rd" class="r317 r">property</span>, <b>object</b> <span id="r318 rd" class="r318 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r319 rd" class="r319 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r315 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r318 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r319 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteRawString</span>(<span class="r315 r">serializer</span>, <span class="r316 r">streamName</span>, <span class="r317 r">property</span>, <span class="i">XmlConvert</span>.<span class="i">ToString</span>((<b>bool</b>)<span class="r318 r">source</span>), <span class="r319 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes Single as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r320 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r321 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r322 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r323 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Single to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r324 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="69e733b79698b88f" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteSingle</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r320 rd" class="r320 r">serializer</span>, <b>string</b> <span id="r321 rd" class="r321 r">streamName</span>, <b>string</b> <span id="r322 rd" class="r322 r">property</span>, <b>object</b> <span id="r323 rd" class="r323 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r324 rd" class="r324 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r320 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r323 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r324 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteRawString</span>(<span class="r320 r">serializer</span>, <span class="r321 r">streamName</span>, <span class="r322 r">property</span>, <span class="i">XmlConvert</span>.<span class="i">ToString</span>((<span class="i">Single</span>)<span class="r323 r">source</span>), <span class="r324 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes TimeSpan as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r325 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r326 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r327 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r328 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DateTime to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r329 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="e0ecdd4974143afe" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteTimeSpan</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r325 rd" class="r325 r">serializer</span>, <b>string</b> <span id="r326 rd" class="r326 r">streamName</span>, <b>string</b> <span id="r327 rd" class="r327 r">property</span>, <b>object</b> <span id="r328 rd" class="r328 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r329 rd" class="r329 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r325 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r328 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r329 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="i">WriteRawString</span>(<span class="r325 r">serializer</span>, <span class="r326 r">streamName</span>, <span class="r327 r">property</span>, <span class="i">XmlConvert</span>.<span class="i">ToString</span>((<span class="i">TimeSpan</span>)<span class="r328 r">source</span>), <span class="r329 r">entry</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes Single as item or property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r330 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The serializer to which the object is serialized.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r331 r">streamName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r332 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of property. pass null for item.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r333 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Bytearray to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r334 r">entry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information about source.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="6b49eec210fb79f5" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteByteArray</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r330 rd" class="r330 r">serializer</span>, <b>string</b> <span id="r331 rd" class="r331 r">streamName</span>, <b>string</b> <span id="r332 rd" class="r332 r">property</span>, <b>object</b> <span id="r333 rd" class="r333 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r334 rd" class="r334 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r330 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r333 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r334 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <b>byte</b>[] <span id="r335 rd" class="r335 r">bytes</span> = (<b>byte</b>[])<span class="r333 r">source</span>;
            <b>if</b> (<span class="r332 r">property</span> != <b>null</b>)
            {
                <span class="r330 r">serializer</span>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r334 r">entry</span>.<a href="#6d5d3a3c4e4601a4" class="i property">PropertyTag</a>);
                <span class="r330 r">serializer</span>.<a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r332 r">property</span>);
            }
            <b>else</b>
            {
                <span class="r330 r">serializer</span>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r334 r">entry</span>.<a href="#1c4666f39a3dc592" class="i property">ItemTag</a>);
            }
 
            <b>if</b> (<span class="r331 r">streamName</span> != <b>null</b>)
            {
                <span class="r330 r">serializer</span>.<a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r331 r">streamName</span>);
            }
 
            <span class="r330 r">serializer</span>.<a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteBase64</span>(<span class="r335 r">bytes</span>, 0, <span class="r335 r">bytes</span>.<span class="i">Length</span>);
            <span class="r330 r">serializer</span>.<a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <b>internal static void</b> <a id="107acae4434ffb4e" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteXmlDocument</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r336 rd" class="r336 r">serializer</span>, <b>string</b> <span id="r337 rd" class="r337 r">streamName</span>, <b>string</b> <span id="r338 rd" class="r338 r">property</span>, <b>object</b> <span id="r339 rd" class="r339 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r340 rd" class="r340 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r336 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r339 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r340 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <b>string</b> <span id="r341 rd" class="r341 r">xml</span> = ((<span class="i">XmlDocument</span>)<span class="r339 r">source</span>).<span class="i">OuterXml</span>;
            <a href="#daa4eea504ab19b1" class="i method">WriteEncodedString</a>(<span class="r336 r">serializer</span>, <span class="r337 r">streamName</span>, <span class="r338 r">property</span>, <span class="r341 r">xml</span>, <span class="r340 r">entry</span>);
        }
 
        <b>internal static void</b> <a id="e7ed9a136d77860c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteProgressRecord</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r342 rd" class="r342 r">serializer</span>, <b>string</b> <span id="r343 rd" class="r343 r">streamName</span>, <b>string</b> <span id="r344 rd" class="r344 r">property</span>, <b>object</b> <span id="r345 rd" class="r345 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r346 rd" class="r346 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r342 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r345 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r346 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r347 rd" class="r347 r">rec</span> = (<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="r345 r">source</span>;
            <span class="r342 r">serializer</span>.<a href="#7f871233a7c780c9" class="i method">WriteStartElement</a>(<span class="r346 r">entry</span>.<a href="#6d5d3a3c4e4601a4" class="i property">PropertyTag</a>);
            <b>if</b> (<span class="r344 r">property</span> != <b>null</b>)
            {
                <span class="r342 r">serializer</span>.<a href="#503f8197d0853c50" class="i method">WriteNameAttribute</a>(<span class="r344 r">property</span>);
            }
 
            <b>if</b> (<span class="r343 r">streamName</span> != <b>null</b>)
            {
                <span class="r342 r">serializer</span>.<a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>, <span class="r343 r">streamName</span>);
            }
 
            <span class="r342 r">serializer</span>.<a href="#5a0b104e7a051a09" class="i method">WriteEncodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#ffb423bc21393df1" class="i field">ProgressRecordActivity</a>, <span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#4b85501b44d8e997" class="i property">Activity</a>);
            <span class="r342 r">serializer</span>.<span class="i">WriteEncodedElementString</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#9c3adad8754edaf1" class="i field">ProgressRecordActivityId</a>, <span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#035f9f51bcda9b17" class="i property">ActivityId</a>.<span class="i">ToString</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
            <span class="r342 r">serializer</span>.<a href="#beb1b050fda95981" class="i method">WriteOneObject</a>(<span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#f7d64fec26cd635a" class="i property">CurrentOperation</a>, <b>null</b>, <b>null</b>, 1);
            <span class="r342 r">serializer</span>.<span class="i">WriteEncodedElementString</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#9e055a92bb08092f" class="i field">ProgressRecordParentActivityId</a>, <span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#730521203ee4eba0" class="i property">ParentActivityId</a>.<span class="i">ToString</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
            <span class="r342 r">serializer</span>.<span class="i">WriteEncodedElementString</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#2dcf5aa1236d7763" class="i field">ProgressRecordPercentComplete</a>, <span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#7c559492a0012510" class="i property">PercentComplete</a>.<span class="i">ToString</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
            <span class="r342 r">serializer</span>.<span class="i">WriteEncodedElementString</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fb3f534241115e3a" class="i field">ProgressRecordType</a>, <span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a>.<span class="i">ToString</span>());
            <span class="r342 r">serializer</span>.<span class="i">WriteEncodedElementString</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#ef209eacda0e27c3" class="i field">ProgressRecordSecondsRemaining</a>, <span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#b36a767584bc86ea" class="i property">SecondsRemaining</a>.<span class="i">ToString</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
            <span class="r342 r">serializer</span>.<a href="#5a0b104e7a051a09" class="i method">WriteEncodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#0205408fc06dbd73" class="i field">ProgressRecordStatusDescription</a>, <span class="r347 r">rec</span>.<a href="ProgressRecord.cs.html#7b8dea277788f5cd" class="i property">StatusDescription</a>);
 
            <span class="r342 r">serializer</span>.<a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteEndElement</span>();
        }
 
        <b>internal static void</b> <a id="3d38fc607da2e35c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteSecureString</a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r348 rd" class="r348 r">serializer</span>, <b>string</b> <span id="r349 rd" class="r349 r">streamName</span>, <b>string</b> <span id="r350 rd" class="r350 r">property</span>, <b>object</b> <span id="r351 rd" class="r351 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r352 rd" class="r352 r">entry</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r348 r">serializer</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r351 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r352 r">entry</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="r348 r">serializer</span>.<a href="#5826542431262dff" class="i method">HandleSecureString</a>(<span class="r351 r">source</span>, <span class="r349 r">streamName</span>, <span class="r350 r">property</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> known type serialization
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> misc
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes start element in Monad namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r353 r">elementTag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Tag of element.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="7f871233a7c780c9" href="../R/7f871233a7c780c9.html" target="n" data-glyph="76,1" class="i method">WriteStartElement</a>(<b>string</b> <span id="r353 rd" class="r353 r">elementTag</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r353 r">elementTag</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>if</b> ((<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#0b378b732b3e7999" class="i field">options</a> &amp; <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#e3057cca11315410" class="i field">NoNamespace</a>) == <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#e3057cca11315410" class="i field">NoNamespace</a>)
            {
                <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteStartElement</span>(<span class="r353 r">elementTag</span>);
            }
            <b>else</b>
            {
                <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteStartElement</span>(<span class="r353 r">elementTag</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#4fb0c7f3c8b05c6b" class="i field">MonadNamespace</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes attribute in monad namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r354 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of attribute.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r355 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value of attribute.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="5dcab653fe53010e" href="../R/5dcab653fe53010e.html" target="n" data-glyph="76,1" class="i method">WriteAttribute</a>(<b>string</b> <span id="r354 rd" class="r354 r">name</span>, <b>string</b> <span id="r355 rd" class="r355 r">value</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r354 r">name</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r355 r">value</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteAttributeString</span>(<span class="r354 r">name</span>, <span class="r355 r">value</span>);
        }
 
        <b>private void</b> <a id="503f8197d0853c50" href="../R/503f8197d0853c50.html" target="n" data-glyph="76,1" class="i method">WriteNameAttribute</a>(<b>string</b> <span id="r356 rd" class="r356 r">value</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r356 r">value</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="#5dcab653fe53010e" class="i method">WriteAttribute</a>(
                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#57131290458a16b7" class="i field">NameAttribute</a>,
                <a href="#f5570529e128777b" class="i method">EncodeString</a>(<span class="r356 r">value</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Encodes the string to escape characters which would make XmlWriter.WriteString throw an exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r357 r">s</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String to encode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Encoded string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Output from this method can be reverted using XmlConvert.DecodeName method</span>
        <span class="c">///</span><span class="c"> (or InternalDeserializer.DecodeString).</span>
        <span class="c">///</span><span class="c"> This method has been introduced to produce shorter output than XmlConvert.EncodeName</span>
        <span class="c">///</span><span class="c"> (which escapes everything that can&#39;t be part of an xml name - whitespace, punctuation).</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This method has been split into 2 parts to optimize its performance:</span>
        <span class="c">///</span><span class="c"> 1) part1 (this method) checks if there are any encodable characters and</span>
        <span class="c">///</span><span class="c">    if there aren&#39;t it simply (and efficiently) returns the original string</span>
        <span class="c">///</span><span class="c"> 2) part2 (EncodeString(string, int)) picks up when part1 detects the first encodable</span>
        <span class="c">///</span><span class="c">    character.  It avoids looking at the characters already verified by part1</span>
        <span class="c">///</span><span class="c">    and copies those already verified characters and then starts encoding</span>
        <span class="c">///</span><span class="c">    the rest of the string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="f5570529e128777b" href="../R/f5570529e128777b.html" target="n" data-glyph="74,1" class="i method">EncodeString</a>(<b>string</b> <span id="r357 rd" class="r357 r">s</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r357 r">s</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <b>int</b> <span id="r358 rd" class="r358 r">slen</span> = <span class="r357 r">s</span>.<span class="i">Length</span>;
            <b>for</b> (<b>int</b> <span id="r359 rd" class="r359 r">i</span> = 0; <span class="r359 r">i</span> &lt; <span class="r358 r">slen</span>; ++<span class="r359 r">i</span>)
            {
                <b>char</b> <span id="r360 rd" class="r360 r">c</span> = <span class="r357 r">s</span>[<span class="r359 r">i</span>];
                <span class="c">// A control character is in ranges 0x00-0x1F or 0x7F-0x9F</span>
                <span class="c">// The escape character is 0x5F (&#39;_&#39;) if followed by an &#39;x&#39;</span>
                <span class="c">// A surrogate character is in range 0xD800-0xDFFF</span>
                <b>if</b> (<span class="r360 r">c</span> &lt;= 0x1F
                        || (<span class="r360 r">c</span> &gt;= 0x7F &amp;&amp; <span class="r360 r">c</span> &lt;= 0x9F)
                        || (<span class="r360 r">c</span> &gt;= 0xD800 &amp;&amp; <span class="r360 r">c</span> &lt;= 0xDFFF)
                        || (<span class="r360 r">c</span> == 0x5F &amp;&amp; (<span class="r359 r">i</span> + 1 &lt; <span class="r358 r">slen</span>) &amp;&amp;
                            ((<span class="r357 r">s</span>[<span class="r359 r">i</span> + 1] == <span class="s">&#39;x&#39;</span>) || (<span class="r357 r">s</span>[<span class="r359 r">i</span> + 1] == <span class="s">&#39;X&#39;</span>))
                            ))
                {
                    <b>return</b> <a href="#ac61b26b1eb5b3c1" class="i method">EncodeString</a>(<span class="r357 r">s</span>, <span class="r359 r">i</span>);
                }
            }
            <span class="c">// No encodable characters were found above - simply return the original string</span>
            <b>return</b> <span class="r357 r">s</span>;
        }
 
        <b>private static readonly char</b>[] <a id="b7813d32a7bb8f01" href="../R/b7813d32a7bb8f01.html" target="n" data-glyph="46,1" class="i field">s_hexlookup</a> = { <span class="s">&#39;0&#39;</span>, <span class="s">&#39;1&#39;</span>, <span class="s">&#39;2&#39;</span>, <span class="s">&#39;3&#39;</span>, <span class="s">&#39;4&#39;</span>, <span class="s">&#39;5&#39;</span>, <span class="s">&#39;6&#39;</span>, <span class="s">&#39;7&#39;</span>, <span class="s">&#39;8&#39;</span>, <span class="s">&#39;9&#39;</span>, <span class="s">&#39;A&#39;</span>, <span class="s">&#39;B&#39;</span>, <span class="s">&#39;C&#39;</span>, <span class="s">&#39;D&#39;</span>, <span class="s">&#39;E&#39;</span>, <span class="s">&#39;F&#39;</span> };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the real workhorse that encodes strings.</span>
        <span class="c">///</span><span class="c"> See </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f5570529e128777b" class="i method">EncodeString</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for more information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r361 r">s</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String to encode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r362 r">indexOfFirstEncodableCharacter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">IndexOfFirstEncodableCharacter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Encoded string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="ac61b26b1eb5b3c1" href="../R/ac61b26b1eb5b3c1.html" target="n" data-glyph="76,1" class="i method">EncodeString</a>(<b>string</b> <span id="r361 rd" class="r361 r">s</span>, <b>int</b> <span id="r362 rd" class="r362 r">indexOfFirstEncodableCharacter</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r361 r">s</span> != <b>null</b>, <span class="s">&quot;Caller should validate the &#39;s&#39; parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r362 r">indexOfFirstEncodableCharacter</span> &gt;= 0, <span class="s">&quot;Caller should verify validity of indexOfFirstEncodableCharacter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r362 r">indexOfFirstEncodableCharacter</span> &lt; <span class="r361 r">s</span>.<span class="i">Length</span>, <span class="s">&quot;Caller should verify validity of indexOfFirstEncodableCharacter&quot;</span>);
 
            <b>int</b> <span id="r363 rd" class="r363 r">slen</span> = <span class="r361 r">s</span>.<span class="i">Length</span>;
            <b>char</b>[] <span id="r364 rd" class="r364 r">result</span> = <b>new</b> <b>char</b>[<span class="r362 r">indexOfFirstEncodableCharacter</span> + (<span class="r363 r">slen</span> - <span class="r362 r">indexOfFirstEncodableCharacter</span>) * 7];
 
            <span class="r361 r">s</span>.<span class="i">CopyTo</span>(0, <span class="r364 r">result</span>, 0, <span class="r362 r">indexOfFirstEncodableCharacter</span>);
            <b>int</b> <span id="r365 rd" class="r365 r">rlen</span> = <span class="r362 r">indexOfFirstEncodableCharacter</span>;
 
            <b>for</b> (<b>int</b> <span id="r366 rd" class="r366 r">i</span> = <span class="r362 r">indexOfFirstEncodableCharacter</span>; <span class="r366 r">i</span> &lt; <span class="r363 r">slen</span>; ++<span class="r366 r">i</span>)
            {
                <b>char</b> <span id="r367 rd" class="r367 r">c</span> = <span class="r361 r">s</span>[<span class="r366 r">i</span>];
                <span class="c">// A control character is in ranges 0x00-0x1F or 0x7F-0x9F</span>
                <span class="c">// The escape character is 0x5F (&#39;_&#39;) if followed by an &#39;x&#39;</span>
                <span class="c">// A surrogate character is in range 0xD800-0xDFFF</span>
                <b>if</b> (<span class="r367 r">c</span> &gt; 0x1F
                        &amp;&amp; (<span class="r367 r">c</span> &lt; 0x7F || <span class="r367 r">c</span> &gt; 0x9F)
                        &amp;&amp; (<span class="r367 r">c</span> &lt; 0xD800 || <span class="r367 r">c</span> &gt; 0xDFFF)
                        &amp;&amp; (<span class="r367 r">c</span> != 0x5F || ((<span class="r366 r">i</span> + 1 &gt;= <span class="r363 r">slen</span>) ||
                            ((<span class="r361 r">s</span>[<span class="r366 r">i</span> + 1] != <span class="s">&#39;x&#39;</span>) &amp;&amp; (<span class="r361 r">s</span>[<span class="r366 r">i</span> + 1] != <span class="s">&#39;X&#39;</span>))
                            )))
                {
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span>++] = <span class="r367 r">c</span>;
                }
                <b>else</b> <b>if</b> (<span class="r367 r">c</span> == 0x5F)
                {
                    <span class="c">// Special case the escape character, encode _</span>
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 0] = <span class="s">&#39;_&#39;</span>;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 1] = <span class="s">&#39;x&#39;</span>;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 2] = <span class="s">&#39;0&#39;</span>;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 3] = <span class="s">&#39;0&#39;</span>;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 4] = <span class="s">&#39;5&#39;</span>;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 5] = <span class="s">&#39;F&#39;</span>;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 6] = <span class="s">&#39;_&#39;</span>;
                    <span class="r365 r">rlen</span> += 7;
                }
                <b>else</b>
                {
                    <span class="c">// It is a control character or a unicode surrogate</span>
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 0] = <span class="s">&#39;_&#39;</span>;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 1] = <span class="s">&#39;x&#39;</span>;
 
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 2 + 3] = <a href="#b7813d32a7bb8f01" class="i field">s_hexlookup</a>[<span class="r367 r">c</span> &amp; 0x0F];
                    <span class="r367 r">c</span> &gt;&gt;= 4;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 2 + 2] = <a href="#b7813d32a7bb8f01" class="i field">s_hexlookup</a>[<span class="r367 r">c</span> &amp; 0x0F];
                    <span class="r367 r">c</span> &gt;&gt;= 4;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 2 + 1] = <a href="#b7813d32a7bb8f01" class="i field">s_hexlookup</a>[<span class="r367 r">c</span> &amp; 0x0F];
                    <span class="r367 r">c</span> &gt;&gt;= 4;
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 2 + 0] = <a href="#b7813d32a7bb8f01" class="i field">s_hexlookup</a>[<span class="r367 r">c</span> &amp; 0x0F];
 
                    <span class="r364 r">result</span>[<span class="r365 r">rlen</span> + 6] = <span class="s">&#39;_&#39;</span>;
 
                    <span class="r365 r">rlen</span> += 7;
                }
            }
 
            <b>return</b> <b>new</b> <b>string</b>(<span class="r364 r">result</span>, 0, <span class="r365 r">rlen</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes element string in monad namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r368 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r369 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="5a0b104e7a051a09" href="../R/5a0b104e7a051a09.html" target="n" data-glyph="76,1" class="i method">WriteEncodedElementString</a>(<b>string</b> <span id="r368 rd" class="r368 r">name</span>, <b>string</b> <span id="r369 rd" class="r369 r">value</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r368 r">name</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r369 r">value</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="#fafbc094ffa8966a" class="k">this</a>.<a href="#c9126bc1fd3a6930" class="i method">CheckIfStopping</a>();
 
            <span class="r369 r">value</span> = <a href="#f5570529e128777b" class="i method">EncodeString</a>(<span class="r369 r">value</span>);
 
            <b>if</b> ((<a href="#a7a60e35cfcccbfc" class="i field">_context</a>.<a href="#0b378b732b3e7999" class="i field">options</a> &amp; <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#e3057cca11315410" class="i field">NoNamespace</a>) == <a href="#5b149bd0ceeb6fb3" class="t t">SerializationOptions</a>.<a href="#e3057cca11315410" class="i field">NoNamespace</a>)
            {
                <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteElementString</span>(<span class="r368 r">name</span>, <span class="r369 r">value</span>);
            }
            <b>else</b>
            {
                <a href="#844267b0ca189929" class="i field">_writer</a>.<span class="i">WriteElementString</span>(<span class="r368 r">name</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#4fb0c7f3c8b05c6b" class="i field">MonadNamespace</a>, <span class="r369 r">value</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> misc
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This internal class provides methods for de-serializing mshObject.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="758c46d6a86d6840" href="../R/758c46d6a86d6840.html" target="n" data-glyph="2,0" class="t t">InternalDeserializer</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlReader from which object is deserialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">XmlReader</span> <a id="f36a88e876de0508" href="../R/f36a88e876de0508.html" target="n" data-glyph="46,1" class="i field">_reader</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserialization context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="#37cfb1b61ebb243c" class="t t">DeserializationContext</a> <a id="3afea128f5cba056" href="../R/3afea128f5cba056.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="c">///</span><span class="c"> Used by Remoting infrastructure. This TypeTable instance</span>
        <span class="c">///</span><span class="c"> will be used by Serializer if ExecutionContext is not</span>
        <span class="c">///</span><span class="c"> available (to get the ExecutionContext&#39;s TypeTable)</span>
        <b>private</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="74a9917a515fb7f1" href="../R/74a9917a515fb7f1.html" target="n" data-glyph="46,1" class="i field">_typeTable</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, unknowntags are allowed inside PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="d6596f6da316b6f1" href="../R/d6596f6da316b6f1.html" target="n" data-glyph="106,1" class="i property">UnknownTagsAllowed</a>
        {
            <b>get</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#75e99537e234527a" class="i field">_version</a>.<span class="i">Major</span> &lt;= 1, <span class="s">&quot;Deserializer assumes clixml version is &lt;= 1.1&quot;</span>);
                <span class="c">// If minor version is greater than 1, it means that there can be</span>
                <span class="c">// some unknown tags in xml. Deserialization should ignore such element.</span>
                <b>return</b> (<a href="#75e99537e234527a" class="i field">_version</a>.<span class="i">Minor</span> &gt; 1);
            }
        }
 
        [<span class="i">SuppressMessage</span>(
            <span class="s">&quot;Performance&quot;</span>,
            <span class="s">&quot;CA1822:Mark members as static&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;Accesses instance members in preprocessor branch.&quot;</span>)]
        <b>private bool</b> <a id="05310f62acf2c1d4" href="../R/05310f62acf2c1d4.html" target="n" data-glyph="106,1" class="i property">DuplicateRefIdsAllowed</a>
        {
            <b>get</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#75e99537e234527a" class="i field">_version</a>.<span class="i">Major</span> &lt;= 1, <span class="s">&quot;Deserializer assumes clixml version is &lt;= 1.1&quot;</span>);
                <span class="i">Version</span> <span id="r370 rd" class="r370 r">boundaryVersion</span> = <b>new</b> <span class="i">Version</span>(1, 1, 0, 1);
                <b>return</b> (<a href="#75e99537e234527a" class="i field">_version</a> &lt; <span class="r370 r">boundaryVersion</span>);
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">                return true; // handle v1 stuff gracefully
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Depth below top level - used to prevent stack overflow during deserialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="c941a428848a7fd2" href="../R/c941a428848a7fd2.html" target="n" data-glyph="46,1" class="i field">_depthBelowTopLevel</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Version declared by the clixml being read.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Version</span> <a id="75e99537e234527a" href="../R/75e99537e234527a.html" target="n" data-glyph="46,1" class="i field">_version</a>;
 
        <b>private const int</b> <a id="0ba2f8f70ad8563e" href="../R/0ba2f8f70ad8563e.html" target="n" data-glyph="10,1" class="i field">MaxDepthBelowTopLevel</a> = 50;
 
        <b>private readonly</b> <a href="#cb3f1be484782f5b" class="t t">ReferenceIdHandlerForDeserializer</a>&lt;<b>object</b>&gt; <a id="5ce7dd114c248124" href="../R/5ce7dd114c248124.html" target="n" data-glyph="46,1" class="i field">_objectRefIdHandler</a>;
        <b>private readonly</b> <a href="#cb3f1be484782f5b" class="t t">ReferenceIdHandlerForDeserializer</a>&lt;<a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt; <a id="764321197415c9fd" href="../R/764321197415c9fd.html" target="n" data-glyph="46,1" class="i field">_typeRefIdHandler</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r371 r">reader</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r372 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="2f9f6b8275a60b00" href="../R/2f9f6b8275a60b00.html" target="n" data-glyph="74,1" class="t constructor">InternalDeserializer</a>(<span class="i">XmlReader</span> <span id="r371 rd" class="r371 r">reader</span>, <a href="#37cfb1b61ebb243c" class="t t">DeserializationContext</a> <span id="r372 rd" class="r372 r">context</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r371 r">reader</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <a href="#f36a88e876de0508" class="i field">_reader</a> = <span class="r371 r">reader</span>;
            <a href="#3afea128f5cba056" class="i field">_context</a> = <span class="r372 r">context</span>;
 
            <a href="#5ce7dd114c248124" class="i field">_objectRefIdHandler</a> = <b>new</b> <span class="t">ReferenceIdHandlerForDeserializer</span>&lt;<b>object</b>&gt;();
            <a href="#764321197415c9fd" class="i field">_typeRefIdHandler</a> = <b>new</b> <span class="t">ReferenceIdHandlerForDeserializer</span>&lt;<a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt;();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Known CIMTypes
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt;&gt; <a id="c5c30e2b12ad5e25" href="../R/c5c30e2b12ad5e25.html" target="n" data-glyph="46,1" class="i field">s_knownCimArrayTypes</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt;&gt;(
            () =&gt;
                <b>new</b> <span class="i">HashSet</span>&lt;<span class="i">Type</span>&gt;
                {
                    <b>typeof</b>(<b>bool</b>),
                    <b>typeof</b>(<b>byte</b>),
                    <b>typeof</b>(<b>char</b>),
                    <b>typeof</b>(<span class="i">DateTime</span>),
                    <b>typeof</b>(<b>decimal</b>),
                    <b>typeof</b>(<b>double</b>),
                    <b>typeof</b>(<span class="i">Int16</span>),
                    <b>typeof</b>(<span class="i">Int32</span>),
                    <b>typeof</b>(<span class="i">Int64</span>),
                    <b>typeof</b>(<b>sbyte</b>),
                    <b>typeof</b>(<span class="i">Single</span>),
                    <b>typeof</b>(<b>string</b>),
                    <b>typeof</b>(<span class="i">TimeSpan</span>),
                    <b>typeof</b>(<span class="i">UInt16</span>),
                    <b>typeof</b>(<span class="i">UInt32</span>),
                    <b>typeof</b>(<span class="i">UInt64</span>),
                    <b>typeof</b>(<b>object</b>),
                    <b>typeof</b>(<span class="i">CimInstance</span>)
                }
            );
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> deserialization
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Remoting infrastructure. This TypeTable instance</span>
        <span class="c">///</span><span class="c"> will be used by Deserializer if ExecutionContext is not</span>
        <span class="c">///</span><span class="c"> available (to get the ExecutionContext&#39;s TypeTable)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="1d13bccdd5eddd80" href="../R/1d13bccdd5eddd80.html" target="n" data-glyph="104,1" class="i property">TypeTable</a>
        {
            <b>get</b> { <b>return</b> <a href="#74a9917a515fb7f1" class="i field">_typeTable</a>; }
 
            <b>set</b> { <a href="#74a9917a515fb7f1" class="i field">_typeTable</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validates the version for correctness. Also validates that deserializer</span>
        <span class="c">///</span><span class="c"> can deserialize this version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r373 r">version</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> version in string format</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="f6871f054a285115" href="../R/f6871f054a285115.html" target="n" data-glyph="74,1" class="i method">ValidateVersion</a>(<b>string</b> <span id="r373 rd" class="r373 r">version</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r373 r">version</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <a href="#75e99537e234527a" class="i field">_version</a> = <b>null</b>;
            <span class="i">Exception</span> <span id="r374 rd" class="r374 r">exceptionToRethrow</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="#75e99537e234527a" class="i field">_version</a> = <b>new</b> <span class="i">Version</span>(<span class="r373 r">version</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r375 rd" class="r375 r">e</span>)
            {
                <span class="r374 r">exceptionToRethrow</span> = <span class="r375 r">e</span>;
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r376 rd" class="r376 r">e</span>)
            {
                <span class="r374 r">exceptionToRethrow</span> = <span class="r376 r">e</span>;
            }
 
            <b>if</b> (<span class="r374 r">exceptionToRethrow</span> != <b>null</b>)
            {
                <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidVersion</span>, <span class="r374 r">exceptionToRethrow</span>);
            }
 
            <span class="c">// Versioning Note:Future version of serialization can add new known types.</span>
            <span class="c">// This version will ignore those known types, if they are base object.</span>
            <span class="c">// It is expected that future version will still put information in base</span>
            <span class="c">// and adapter properties which this serializer can read and use.</span>
            <span class="c">// For example, assume the version 2 serialization engine supports a new known</span>
            <span class="c">// type IPAddress. The version 1 deserializer doesn&#39;t know IPAddress as known</span>
            <span class="c">// type and it must retrieve it as an PSObject. The version 2 serializer</span>
            <span class="c">// can serialize this as follows:</span>
            <span class="c">// &lt;PSObject Version=1.2 Was=Deserialized.IPAddress &gt;</span>
            <span class="c">//  &lt;TypeNames&gt;...&lt;/TypeNames&gt;</span>
            <span class="c">//  &lt;BaseObject&gt;</span>
            <span class="c">//      &lt;IPAddress&gt;120.23.35.53&lt;/IPAddress&gt;</span>
            <span class="c">//  &lt;/BaseObject&gt;</span>
            <span class="c">//  &lt;Properties&gt;</span>
            <span class="c">//      &lt;string name=Address&gt;120.23.34.53&lt;/string&gt;</span>
            <span class="c">//      &lt;string name=class&gt;A&lt;/string&gt;</span>
            <span class="c">//  &lt;/Properties&gt;</span>
            <span class="c">// &lt;/PSObject&gt;</span>
            <span class="c">// In above example, V1 serializer will ignore &lt;IPAddress&gt; element and read</span>
            <span class="c">// properties from &lt;Properties&gt;</span>
            <span class="c">// V2 serializer can read &lt;IPAddress&gt; tag and ignore properties.</span>
            <span class="c">// Read serialization note doc for information.</span>
 
            <span class="c">// Now validate the major version number is 1</span>
            <b>if</b> (<a href="#75e99537e234527a" class="i field">_version</a>.<span class="i">Major</span> != 1)
            {
                <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">UnexpectedVersion</span>, <b>null</b>, <a href="#75e99537e234527a" class="i field">_version</a>.<span class="i">Major</span>);
            }
        }
 
        <b>private object</b> <a id="b5dade17e260b1e8" href="../R/b5dade17e260b1e8.html" target="n" data-glyph="76,1" class="i method">ReadOneDeserializedObject</a>(<b>out string</b> <span id="r377 rd" class="r377 r">streamName</span>, <b>out bool</b> <span id="r378 rd" class="r378 r">isKnownPrimitiveType</span>)
        {
            <b>if</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> != <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
            {
                <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidNodeType</span>, <b>null</b>,
                                       <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span>.<span class="i">ToString</span>(), <b>nameof</b>(<span class="i">XmlNodeType</span>.<span class="i">Element</span>));
            }
 
            <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Processing start node {0}&quot;</span>, <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
 
            <span class="r377 r">streamName</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">GetAttribute</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#76c920757645a0bb" class="i field">StreamNameAttribute</a>);
            <span class="r378 r">isKnownPrimitiveType</span> = <b>false</b>;
 
            <span class="c">// handle nil node</span>
            <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8ffeca899604fbae" class="i field">NilTag</a>))
            {
                <a href="#6486c187ad9b2032" class="i method">Skip</a>();
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// Handle reference to previous deserialized object.</span>
            <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#c1b0f9d99fde72fe" class="i field">ReferenceTag</a>))
            {
                <b>string</b> <span id="r379 rd" class="r379 r">refId</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">GetAttribute</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>);
 
                <b>if</b> (<span class="r379 r">refId</span> == <b>null</b>)
                {
                    <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">AttributeExpected</span>, <b>null</b>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>);
                }
 
                <b>object</b> <span id="r380 rd" class="r380 r">duplicate</span> = <a href="#5ce7dd114c248124" class="i field">_objectRefIdHandler</a>.<a href="#64b04165c058afc2" class="i method">GetReferencedObject</a>(<span class="r379 r">refId</span>);
                <b>if</b> (<span class="r380 r">duplicate</span> == <b>null</b>)
                {
                    <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidReferenceId</span>, <b>null</b>, <span class="r379 r">refId</span>);
                }
 
                <a href="#6486c187ad9b2032" class="i method">Skip</a>();
                <b>return</b> <span class="r380 r">duplicate</span>;
            }
 
            <span class="c">// Handle primitive known types</span>
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r381 rd" class="r381 r">pktInfo</span> = <a href="#295889332d482ff3" class="t t">KnownTypes</a>.<span class="i">GetTypeSerializationInfoFromItemTag</span>(<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
            <b>if</b> (<span class="r381 r">pktInfo</span> != <b>null</b>)
            {
                <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Primitive Knowntype Element {0}&quot;</span>, <span class="r381 r">pktInfo</span>.<a href="#1c4666f39a3dc592" class="i property">ItemTag</a>);
                <span class="r378 r">isKnownPrimitiveType</span> = <b>true</b>;
                <b>return</b> <a href="#66f32c4593b8e3cb" class="i method">ReadPrimaryKnownType</a>(<span class="r381 r">pktInfo</span>);
            }
 
            <span class="c">// Handle PSObject</span>
            <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#55152cd7ae13df89" class="i field">PSObjectTag</a>))
            {
                <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;PSObject Element&quot;</span>);
                <b>return</b> <a href="#2624eb78140ffbca" class="i method">ReadPSObject</a>();
            }
 
            <span class="c">// If we are here, we have an unknown node. Unknown nodes may</span>
            <span class="c">// be allowed inside PSObject. We do not allow them at top level.</span>
 
            <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<span class="i">TraceError</span>(<span class="s">&quot;Invalid element {0} tag found&quot;</span>, <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
            <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidElementTag</span>, <b>null</b>, <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
        }
 
        <b>private bool</b> <a id="9814165f6da75ff0" href="../R/9814165f6da75ff0.html" target="n" data-glyph="46,1" class="i field">_isStopping</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from a separate thread will stop the serialization process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5ec5b317d34534df" href="../R/5ec5b317d34534df.html" target="n" data-glyph="74,1" class="i method">Stop</a>()
        {
            <a href="#9814165f6da75ff0" class="i field">_isStopping</a> = <b>true</b>;
        }
 
        <b>private void</b> <a id="5698cda6655845d7" href="../R/5698cda6655845d7.html" target="n" data-glyph="76,1" class="i method">CheckIfStopping</a>()
        {
            <b>if</b> (<a href="#9814165f6da75ff0" class="i field">_isStopping</a>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">Serialization</span>.<span class="i">Stopping</span>);
            }
        }
 
        <b>internal const string</b> <a id="31f00c9a81dd5b6e" href="../R/31f00c9a81dd5b6e.html" target="n" data-glyph="8,1" class="i field">CimInstanceMetadataProperty</a> = <span class="s">&quot;__InstanceMetadata&quot;</span>;
        <b>internal const string</b> <a id="cc425014b6f804f7" href="../R/cc425014b6f804f7.html" target="n" data-glyph="8,1" class="i field">CimModifiedProperties</a> = <span class="s">&quot;Modified&quot;</span>;
        <b>internal const string</b> <a id="b6e2174e3f284810" href="../R/b6e2174e3f284810.html" target="n" data-glyph="8,1" class="i field">CimClassMetadataProperty</a> = <span class="s">&quot;__ClassMetadata&quot;</span>;
        <b>internal const string</b> <a id="ba6b3005350b5b74" href="../R/ba6b3005350b5b74.html" target="n" data-glyph="8,1" class="i field">CimClassNameProperty</a> = <span class="s">&quot;ClassName&quot;</span>;
        <b>internal const string</b> <a id="b87efba1c0005a54" href="../R/b87efba1c0005a54.html" target="n" data-glyph="8,1" class="i field">CimNamespaceProperty</a> = <span class="s">&quot;Namespace&quot;</span>;
        <b>internal const string</b> <a id="1e7217d8e0975c2d" href="../R/1e7217d8e0975c2d.html" target="n" data-glyph="8,1" class="i field">CimServerNameProperty</a> = <span class="s">&quot;ServerName&quot;</span>;
        <b>internal const string</b> <a id="c356753c4c8616c8" href="../R/c356753c4c8616c8.html" target="n" data-glyph="8,1" class="i field">CimHashCodeProperty</a> = <span class="s">&quot;Hash&quot;</span>;
        <b>internal const string</b> <a id="798a55af54c453ca" href="../R/798a55af54c453ca.html" target="n" data-glyph="8,1" class="i field">CimMiXmlProperty</a> = <span class="s">&quot;MiXml&quot;</span>;
 
        <b>private static bool</b> <a id="3200ff954fc78e0f" href="../R/3200ff954fc78e0f.html" target="n" data-glyph="76,1" class="i method">RehydrateCimInstanceProperty</a>(
            <span class="i">CimInstance</span> <span id="r382 rd" class="r382 r">cimInstance</span>,
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r383 rd" class="r383 r">deserializedProperty</span>,
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r384 rd" class="r384 r">namesOfModifiedProperties</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r382 r">cimInstance</span> != <b>null</b>, <span class="s">&quot;Caller should make sure cimInstance != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r383 r">deserializedProperty</span> != <b>null</b>, <span class="s">&quot;Caller should make sure deserializedProperty != null&quot;</span>);
 
            <b>if</b> (<span class="r383 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#b64ee1a165cf4e4d" class="i field">ComputerNameNoteProperty</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>string</b> <span id="r385 rd" class="r385 r">psComputerNameValue</span> = <span class="r383 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> <b>as string</b>;
                <b>if</b> (<span class="r385 r">psComputerNameValue</span> != <b>null</b>)
                {
                    <span class="r382 r">cimInstance</span>.<span class="i">SetCimSessionComputerName</span>(<span class="r385 r">psComputerNameValue</span>);
                }
 
                <b>return</b> <b>true</b>;
            }
 
            <span class="i">CimProperty</span> <span id="r386 rd" class="r386 r">cimProperty</span> = <span class="r382 r">cimInstance</span>.<span class="i">CimInstanceProperties</span>[<span class="r383 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>];
            <b>if</b> (<span class="r386 r">cimProperty</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// TODO/FIXME - think if it is possible to do the array handling in a more efficient way</span>
            <b>object</b> <span id="r387 rd" class="r387 r">propertyValue</span> = <span class="r383 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
            <b>if</b> (<span class="r387 r">propertyValue</span> != <b>null</b>)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r388 rd" class="r388 r">psoPropertyValue</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r387 r">propertyValue</span>);
                <b>if</b> (<span class="r388 r">psoPropertyValue</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">ArrayList</span>)
                {
                    <b>if</b> ((<span class="r388 r">psoPropertyValue</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a> == <b>null</b>) || (<span class="r388 r">psoPropertyValue</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<span class="i">Count</span> == 0))
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>string</b> <span id="r389 rd" class="r389 r">originalArrayTypeName</span> = <a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">MaskDeserializationPrefix</span>(<span class="r388 r">psoPropertyValue</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>[0]);
                    <b>if</b> (<span class="r389 r">originalArrayTypeName</span> == <b>null</b>)
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <span class="i">Type</span> <span id="r390 rd" class="r390 r">originalArrayType</span>;
                    <b>if</b> (!<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>(<span class="r389 r">originalArrayTypeName</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>out</b> <span class="r390 r">originalArrayType</span>))
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>if</b> (!<span class="r390 r">originalArrayType</span>.<span class="i">IsArray</span> || !<a href="#c5c30e2b12ad5e25" class="i field">s_knownCimArrayTypes</a>.<span class="i">Value</span>.<span class="i">Contains</span>(<span class="r390 r">originalArrayType</span>.<span class="i">GetElementType</span>()))
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>object</b> <span id="r391 rd" class="r391 r">newPropertyValue</span>;
                    <b>if</b> (!<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>(<span class="r387 r">propertyValue</span>, <span class="r390 r">originalArrayType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <b>out</b> <span class="r391 r">newPropertyValue</span>))
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <span class="r388 r">psoPropertyValue</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r391 r">newPropertyValue</span>);
                }
 
                <span class="r387 r">propertyValue</span> = <span class="r388 r">psoPropertyValue</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>;
            }
 
            <b>try</b>
            {
                <span class="r386 r">cimProperty</span>.<span class="i">Value</span> = <span class="r387 r">propertyValue</span>;
 
                <b>if</b> (!<span class="r384 r">namesOfModifiedProperties</span>.<span class="i">Contains</span>(<span class="r383 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>))
                {
                    <span class="r386 r">cimProperty</span>.<span class="i">IsValueModified</span> = <b>false</b>;
                }
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <b>else</b>
                {
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r386 r">cimProperty</span>.<span class="i">IsValueModified</span>, <span class="s">&quot;Deserialized CIM properties should by default be marked as &#39;modified&#39; &quot;</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
            <b>catch</b> (<span class="i">FormatException</span>)
            {
                <b>return</b> <b>false</b>;
            }
            <b>catch</b> (<span class="i">InvalidCastException</span>)
            {
                <b>return</b> <b>false</b>;
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <b>return</b> <b>false</b>;
            }
            <b>catch</b> (<span class="i">CimException</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">CimDeserializer</span>&gt; <a id="ec9e9c76ab2f1fde" href="../R/ec9e9c76ab2f1fde.html" target="n" data-glyph="46,1" class="i field">s_cimDeserializer</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">CimDeserializer</span>&gt;(<span class="i">CimDeserializer</span>.<span class="i">Create</span>);
 
        <b>private</b> <span class="i">CimClass</span> <a id="163e925e2c944fff" href="../R/163e925e2c944fff.html" target="n" data-glyph="76,1" class="i method">RehydrateCimClass</a>(<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r392 rd" class="r392 r">classMetadataProperty</span>)
        {
            <b>if</b> ((<span class="r392 r">classMetadataProperty</span> == <b>null</b>) || (<span class="r392 r">classMetadataProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">IEnumerable</span> <span id="r393 rd" class="r393 r">deserializedClasses</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r392 r">classMetadataProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
            <b>if</b> (<span class="r393 r">deserializedClasses</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">Stack</span>&lt;<span class="i">KeyValuePair</span>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>, <span class="i">CimClass</span>&gt;&gt; <span id="r394 rd" class="r394 r">cimClassesToAddToCache</span> = <b>new</b> <span class="i">Stack</span>&lt;<span class="i">KeyValuePair</span>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>, <span class="i">CimClass</span>&gt;&gt;();
 
            <span class="c">//</span>
            <span class="c">// REHYDRATE CLASS METADATA</span>
            <span class="c">//</span>
            <span class="i">CimClass</span> <span id="r395 rd" class="r395 r">parentClass</span> = <b>null</b>;
            <span class="i">CimClass</span> <span id="r396 rd" class="r396 r">currentClass</span> = <b>null</b>;
            <b>foreach</b> (<b>var</b> <span id="r397 rd" class="r397 r">deserializedClass</span> <b>in</b> <span class="r393 r">deserializedClasses</span>)
            {
                <span class="r395 r">parentClass</span> = <span class="r396 r">currentClass</span>;
 
                <b>if</b> (<span class="r397 r">deserializedClass</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r398 rd" class="r398 r">psoDeserializedClass</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r397 r">deserializedClass</span>);
 
                <b>if</b> (!(<span class="r398 r">psoDeserializedClass</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#b87efba1c0005a54" class="i field">CimNamespaceProperty</a>] <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r399 rd" class="r399 r">namespaceProperty</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b> <span id="r400 rd" class="r400 r">cimNamespace</span> = <span class="r399 r">namespaceProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> <b>as string</b>;
 
                <b>if</b> (!(<span class="r398 r">psoDeserializedClass</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#ba6b3005350b5b74" class="i field">CimClassNameProperty</a>] <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r401 rd" class="r401 r">classNameProperty</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b> <span id="r402 rd" class="r402 r">cimClassName</span> = <span class="r401 r">classNameProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> <b>as string</b>;
 
                <b>if</b> (!(<span class="r398 r">psoDeserializedClass</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#1e7217d8e0975c2d" class="i field">CimServerNameProperty</a>] <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r403 rd" class="r403 r">computerNameProperty</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b> <span id="r404 rd" class="r404 r">computerName</span> = <span class="r403 r">computerNameProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> <b>as string</b>;
 
                <b>if</b> (!(<span class="r398 r">psoDeserializedClass</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#c356753c4c8616c8" class="i field">CimHashCodeProperty</a>] <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r405 rd" class="r405 r">hashCodeProperty</span>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>var</b> <span id="r406 rd" class="r406 r">hashCodeObject</span> = <span class="r405 r">hashCodeProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
                <b>if</b> (<span class="r406 r">hashCodeObject</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r406 r">hashCodeObject</span> <b>is</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
                {
                    <span class="r406 r">hashCodeObject</span> = ((<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r406 r">hashCodeObject</span>).<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>;
                }
 
                <b>if</b> (<span class="r406 r">hashCodeObject</span> <b>is not int</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>int</b> <span id="r407 rd" class="r407 r">hashCode</span> = (<b>int</b>)<span class="r406 r">hashCodeObject</span>;
 
                <a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a> <span id="r408 rd" class="r408 r">cimClassSerializationId</span> = <b>new</b> <a href="#8e6c8590112b2f4a" class="t constructor">CimClassSerializationId</a>(<span class="r402 r">cimClassName</span>, <span class="r400 r">cimNamespace</span>, <span class="r404 r">computerName</span>, <span class="r407 r">hashCode</span>);
                <span class="r396 r">currentClass</span> = <a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#dfc5e9b73463bf4d" class="i field">cimClassSerializationIdCache</a>.<a href="#e081cd1ae8339d4c" class="i method">GetCimClassFromCache</a>(<span class="r408 r">cimClassSerializationId</span>);
                <b>if</b> (<span class="r396 r">currentClass</span> != <b>null</b>)
                {
                    <b>continue</b>;
                }
 
                <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r409 rd" class="r409 r">miXmlProperty</span> = <span class="r398 r">psoDeserializedClass</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#798a55af54c453ca" class="i field">CimMiXmlProperty</a>] <b>as</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
                <b>if</b> ((<span class="r409 r">miXmlProperty</span> == <b>null</b>) || (<span class="r409 r">miXmlProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> == <b>null</b>))
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b> <span id="r410 rd" class="r410 r">miXmlString</span> = <span class="r409 r">miXmlProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                <b>byte</b>[] <span id="r411 rd" class="r411 r">miXmlBytes</span> = <span class="i">Encoding</span>.<span class="i">Unicode</span>.<span class="i">GetBytes</span>(<span class="r410 r">miXmlString</span>);
                <b>uint</b> <span id="r412 rd" class="r412 r">offset</span> = 0;
                <b>try</b>
                {
                    <span class="r396 r">currentClass</span> = <a href="#ec9e9c76ab2f1fde" class="i field">s_cimDeserializer</a>.<span class="i">Value</span>.<span class="i">DeserializeClass</span>(
                        <span class="r411 r">miXmlBytes</span>,
                        <b>ref</b> <span class="r412 r">offset</span>,
                        <span class="r395 r">parentClass</span>,
                        <span class="i">computerName</span>: <span class="r404 r">computerName</span>,
                        <span class="i">namespaceName</span>: <span class="r400 r">cimNamespace</span>);
                    <span class="r394 r">cimClassesToAddToCache</span>.<span class="i">Push</span>(<b>new</b> <span class="i">KeyValuePair</span>&lt;<a href="#7bb70d53703a06b9" class="t t">CimClassSerializationId</a>, <span class="i">CimClass</span>&gt;(<span class="r408 r">cimClassSerializationId</span>, <span class="r396 r">currentClass</span>));
                }
                <b>catch</b> (<span class="i">CimException</span>)
                {
                    <b>return</b> <b>null</b>;
                }
            }
 
            <span class="c">//</span>
            <span class="c">// UPDATE CLASSDECL DACHE</span>
            <span class="c">//</span>
            <b>foreach</b> (<b>var</b> <span id="r413 rd" class="r413 r">cacheEntry</span> <b>in</b> <span class="r394 r">cimClassesToAddToCache</span>)
            {
                <a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#dfc5e9b73463bf4d" class="i field">cimClassSerializationIdCache</a>.<span class="i">AddCimClassToCache</span>(<span class="r413 r">cacheEntry</span>.<span class="i">Key</span>, <span class="r413 r">cacheEntry</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <span class="r396 r">currentClass</span>;
        }
 
        <span class="c">// NOTE: Win7 change for refid-s that span multiple xml documents: ADMIN: changelist #226414</span>
 
        <b>private</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="c47cfc3c5b4122c9" href="../R/c47cfc3c5b4122c9.html" target="n" data-glyph="76,1" class="i method">RehydrateCimInstance</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r414 rd" class="r414 r">deserializedObject</span>)
        {
            <b>if</b> (<span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is not</b> <a href="MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>)
            {
                <b>return</b> <span class="r414 r">deserializedObject</span>;
            }
 
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r415 rd" class="r415 r">classMetadataProperty</span> = <span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#b6e2174e3f284810" class="i field">CimClassMetadataProperty</a>] <b>as</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
            <span class="i">CimClass</span> <span id="r416 rd" class="r416 r">cimClass</span> = <a href="#163e925e2c944fff" class="i method">RehydrateCimClass</a>(<span class="r415 r">classMetadataProperty</span>);
            <b>if</b> (<span class="r416 r">cimClass</span> == <b>null</b>)
            {
                <b>return</b> <span class="r414 r">deserializedObject</span>;
            }
 
            <span class="i">CimInstance</span> <span id="r417 rd" class="r417 r">cimInstance</span>;
            <b>try</b>
            {
                <span class="r417 r">cimInstance</span> = <b>new</b> <span class="i">CimInstance</span>(<span class="r416 r">cimClass</span>);
            }
            <b>catch</b> (<span class="i">CimException</span>)
            {
                <b>return</b> <span class="r414 r">deserializedObject</span>;
            }
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r418 rd" class="r418 r">psoCimInstance</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r417 r">cimInstance</span>);
 
            <span class="c">// process __InstanceMetadata</span>
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r419 rd" class="r419 r">namesOfModifiedProperties</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r420 rd" class="r420 r">instanceMetadataProperty</span> = <span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#31f00c9a81dd5b6e" class="i field">CimInstanceMetadataProperty</a>] <b>as</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
            <b>if</b> ((<span class="r420 r">instanceMetadataProperty</span> != <b>null</b>) &amp;&amp; (<span class="r420 r">instanceMetadataProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>))
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r421 rd" class="r421 r">instanceMetadata</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r420 r">instanceMetadataProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
 
                <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r422 rd" class="r422 r">modifiedPropertiesProperty</span> = <span class="r421 r">instanceMetadata</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="#cc425014b6f804f7" class="i field">CimModifiedProperties</a>] <b>as</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
                <b>if</b> ((<span class="r422 r">modifiedPropertiesProperty</span> != <b>null</b>) &amp;&amp; (<span class="r422 r">modifiedPropertiesProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>))
                {
                    <b>string</b> <span id="r423 rd" class="r423 r">modifiedPropertiesString</span> = <span class="r422 r">modifiedPropertiesProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                    <b>foreach</b> (<b>string</b> <span id="r424 rd" class="r424 r">nameOfModifiedProperty</span> <b>in</b> <span class="r423 r">modifiedPropertiesString</span>.<span class="i">Split</span>(<a href="Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="Utils.cs.html#ae9efc7d00636f59" class="i field">Space</a>))
                    {
                        <span class="r419 r">namesOfModifiedProperties</span>.<span class="i">Add</span>(<span class="r424 r">nameOfModifiedProperty</span>);
                    }
                }
            }
 
            <span class="c">// process properties that were originally &quot;adapted&quot; properties</span>
            <b>if</b> (<span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#5c4993d343040815" class="i property">AdaptedMembers</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r425 rd" class="r425 r">deserializedMemberInfo</span> <b>in</b> <span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#5c4993d343040815" class="i property">AdaptedMembers</a>)
                {
                    <b>if</b> (!(<span class="r425 r">deserializedMemberInfo</span> <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r426 rd" class="r426 r">deserializedProperty</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <b>bool</b> <span id="r427 rd" class="r427 r">propertyHandledSuccessfully</span> = <a href="#3200ff954fc78e0f" class="i method">RehydrateCimInstanceProperty</a>(
                        <span class="r417 r">cimInstance</span>,
                        <span class="r426 r">deserializedProperty</span>,
                        <span class="r419 r">namesOfModifiedProperties</span>);
 
                    <b>if</b> (!<span class="r427 r">propertyHandledSuccessfully</span>)
                    {
                        <b>return</b> <span class="r414 r">deserializedObject</span>;
                    }
                }
            }
 
            <span class="c">// process properties that were originally &quot;extended&quot; properties</span>
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r428 rd" class="r428 r">deserializedMemberInfo</span> <b>in</b> <span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>)
            {
                <b>if</b> (!(<span class="r428 r">deserializedMemberInfo</span> <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r429 rd" class="r429 r">deserializedProperty</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="c">// skip adapted properties</span>
                <b>if</b> ((<span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#5c4993d343040815" class="i property">AdaptedMembers</a> != <b>null</b>) &amp;&amp; (<span class="r414 r">deserializedObject</span>.<a href="MshObject.cs.html#5c4993d343040815" class="i property">AdaptedMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><span class="r429 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>] != <b>null</b>))
                {
                    <b>continue</b>;
                }
 
                <span class="c">// skip metadata introduced by CliXml/CimInstance serialization</span>
                <b>if</b> (<span class="r429 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<a href="#b6e2174e3f284810" class="i field">CimClassMetadataProperty</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="c">// skip properties re-added by the client (i.e. through types.ps1xml)</span>
                <b>if</b> (<span class="r418 r">psoCimInstance</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r429 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>] != <b>null</b>)
                {
                    <b>continue</b>;
                }
 
                <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r430 rd" class="r430 r">noteProperty</span> = <b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="r429 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <span class="r429 r">deserializedProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
                <span class="r418 r">psoCimInstance</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r430 r">noteProperty</span>);
            }
 
            <b>return</b> <span class="r418 r">psoCimInstance</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads one object. At this point reader should be positioned</span>
        <span class="c">///</span><span class="c"> at the start tag of object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserialized Object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="137459e4dd08e6e3" href="../R/137459e4dd08e6e3.html" target="n" data-glyph="74,1" class="i method">ReadOneObject</a>(<b>out string</b> <span id="r431 rd" class="r431 r">streamName</span>)
        {
            <a href="#758c46d6a86d6840" class="k">this</a>.<a href="#5698cda6655845d7" class="i method">CheckIfStopping</a>();
 
            <b>try</b>
            {
                <a href="#c941a428848a7fd2" class="i field">_depthBelowTopLevel</a>++;
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#c941a428848a7fd2" class="i field">_depthBelowTopLevel</a> &lt;= <a href="#0ba2f8f70ad8563e" class="i field">MaxDepthBelowTopLevel</a>, <span class="s">&quot;depthBelowTopLevel should be &lt;= MaxDepthBelowTopLevel&quot;</span>);
                <b>if</b> (<a href="#c941a428848a7fd2" class="i field">_depthBelowTopLevel</a> == <a href="#0ba2f8f70ad8563e" class="i field">MaxDepthBelowTopLevel</a>)
                {
                    <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">DeserializationTooDeep</span>, <b>null</b>);
                }
 
                <b>bool</b> <span id="r432 rd" class="r432 r">isKnownPrimitiveType</span>;
                <b>object</b> <span id="r433 rd" class="r433 r">result</span> = <a href="#b5dade17e260b1e8" class="i method">ReadOneDeserializedObject</a>(<b>out</b> <span class="r431 r">streamName</span>, <b>out</b> <span class="r432 r">isKnownPrimitiveType</span>);
                <b>if</b> (<span class="r433 r">result</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (!<span class="r432 r">isKnownPrimitiveType</span>)
                {
                    <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r434 rd" class="r434 r">mshSource</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r433 r">result</span>);
                    <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r434 r">mshSource</span>, <b>typeof</b>(<span class="i">CimInstance</span>)))
                    {
                        <b>return</b> <a href="#c47cfc3c5b4122c9" class="i method">RehydrateCimInstance</a>(<span class="r434 r">mshSource</span>);
                    }
 
                    <span class="c">// Convert deserialized object to a user-defined type (specified in a types.ps1xml file)</span>
                    <span class="i">Type</span> <span id="r435 rd" class="r435 r">targetType</span> = <span class="r434 r">mshSource</span>.<a href="MshObject.cs.html#5c084e24674b7a1b" class="i method">GetTargetTypeForDeserialization</a>(<a href="#74a9917a515fb7f1" class="i field">_typeTable</a>);
                    <b>if</b> (<span class="r435 r">targetType</span> != <b>null</b>)
                    {
                        <span class="i">Exception</span> <span id="r436 rd" class="r436 r">rehydrationException</span> = <b>null</b>;
                        <b>try</b>
                        {
                            <b>object</b> <span id="r437 rd" class="r437 r">rehydratedResult</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(
                                <span class="r433 r">result</span>, <span class="r435 r">targetType</span>, <b>true</b> <span class="c">/* recurse */</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#74a9917a515fb7f1" class="i field">_typeTable</a>);
 
                            <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticVerbose</span>(<a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#8beb3a63471eaf7c" class="i field">Serializer_RehydrationSuccess</a>,
                                                        <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#3fa469c285ad648f" class="i field">Rehydration</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>, <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a>,
                                                        <span class="r434 r">mshSource</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>, <span class="r435 r">targetType</span>.<span class="i">FullName</span>,
                                                        <span class="r437 r">rehydratedResult</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
 
                            <b>return</b> <span class="r437 r">rehydratedResult</span>;
                        }
                        <b>catch</b> (<span class="i">InvalidCastException</span> <span id="r438 rd" class="r438 r">e</span>)
                        {
                            <span class="r436 r">rehydrationException</span> = <span class="r438 r">e</span>;
                        }
                        <b>catch</b> (<span class="i">ArgumentException</span> <span id="r439 rd" class="r439 r">e</span>)
                        {
                            <span class="r436 r">rehydrationException</span> = <span class="r439 r">e</span>;
                        }
 
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r436 r">rehydrationException</span> != <b>null</b>,
                                   <span class="s">&quot;The only way to get here is with rehydrationException != null&quot;</span>);
 
                        <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticError</span>(<a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#ad3da1ef7f4ca0ca" class="i field">Serializer_RehydrationFailure</a>,
                                                  <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#3fa469c285ad648f" class="i field">Rehydration</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>, <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a>,
                                                  <span class="r434 r">mshSource</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>,
                                                  <span class="r435 r">targetType</span>.<span class="i">FullName</span>,
                                                  <span class="r436 r">rehydrationException</span>.<span class="i">ToString</span>(),
                                                  <span class="r436 r">rehydrationException</span>.<span class="i">InnerException</span> == <b>null</b>
                                                      ? <b>string</b>.<span class="i">Empty</span>
                                                      : <span class="r436 r">rehydrationException</span>.<span class="i">InnerException</span>.<span class="i">ToString</span>());
                    }
                }
 
                <b>return</b> <span class="r433 r">result</span>;
            }
            <b>finally</b>
            {
                <a href="#c941a428848a7fd2" class="i field">_depthBelowTopLevel</a>--;
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#c941a428848a7fd2" class="i field">_depthBelowTopLevel</a> &gt;= 0, <span class="s">&quot;depthBelowTopLevel should be &gt;= 0&quot;</span>);
            }
        }
 
        <b>private object</b> <a id="96224a243ecbccc7" href="../R/96224a243ecbccc7.html" target="n" data-glyph="76,1" class="i method">ReadOneObject</a>()
        {
            <b>string</b> <span id="r440 rd" class="r440 r">ignore</span>;
            <b>return</b> <a href="#137459e4dd08e6e3" class="i method">ReadOneObject</a>(<b>out</b> <span class="r440 r">ignore</span>);
        }
 
        <span class="c">// Reads one PSObject</span>
        <b>private</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="2624eb78140ffbca" href="../R/2624eb78140ffbca.html" target="n" data-glyph="76,1" class="i method">ReadPSObject</a>()
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r441 rd" class="r441 r">dso</span> = <a href="#53177a1c0d079c27" class="i method">ReadAttributeAndCreatePSObject</a>();
 
            <span class="c">// Read start element tag</span>
            <b>if</b> (!<a href="#c80a7e45efc82f44" class="i method">ReadStartElementAndHandleEmpty</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#55152cd7ae13df89" class="i field">PSObjectTag</a>))
            {
                <span class="c">// Empty element.</span>
                <b>return</b> <span class="r441 r">dso</span>;
            }
 
            <b>bool</b> <span id="r442 rd" class="r442 r">overrideTypeInfo</span> = <b>true</b>;
            <span class="c">// Process all the child nodes</span>
            <b>while</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
            {
                <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#3556fda8cf74c102" class="i field">TypeNamesTag</a>) ||
                    <a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#9d4a1e751c04e939" class="i field">TypeNamesReferenceTag</a>))
                {
                    <a href="#34d849071d8ca31d" class="i method">ReadTypeNames</a>(<span class="r441 r">dso</span>);
                    <span class="r442 r">overrideTypeInfo</span> = <b>false</b>;
                }
                <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d37b5e9f200f7f6a" class="i field">AdapterProperties</a>))
                {
                    <a href="#b7cb167c6aea53fa" class="i method">ReadProperties</a>(<span class="r441 r">dso</span>);
                }
                <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8a520e1fcc48fc22" class="i field">MemberSet</a>))
                {
                    <a href="#1c103b3ff356bffb" class="i method">ReadMemberSet</a>(<span class="r441 r">dso</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>);
                }
                <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#c957bfb06f934b47" class="i field">ToStringElementTag</a>))
                {
                    <span class="r441 r">dso</span>.<a href="MshObject.cs.html#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a> = <a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#c957bfb06f934b47" class="i field">ToStringElementTag</a>);
                    <span class="r441 r">dso</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>.<a href="CoreAdapter.cs.html#37b1315c558998d3" class="i method">GetDotNetMethod</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r441 r">dso</span>, <span class="s">&quot;ToString&quot;</span>));
                    <a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#bad6a11737238f9f" class="i method">SetHasInstanceMember</a>(<span class="s">&quot;ToString&quot;</span>);
                    <span class="c">// Fix for Win8:75437</span>
                    <span class="c">// The TokenText property is used in type conversion and it is not being populated during deserialization</span>
                    <span class="c">// As a result, parameter binding fails in the following case on a remote session</span>
                    <span class="c">// register-psssessionconfiguration -Name foo -psversion 3.0</span>
                    <span class="c">// The value &quot;3.0&quot; is treated as a double and since the TokenText property holds null, the type converter tries to convert</span>
                    <span class="c">// from System.Double to System.Version using Parse method of System.Version and fails</span>
                    <span class="r441 r">dso</span>.<a href="MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a> = <span class="r441 r">dso</span>.<a href="MshObject.cs.html#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a>;
                }
                <b>else</b>
                {
                    <span class="c">// Handle BaseObject</span>
                    <b>object</b> <span id="r443 rd" class="r443 r">baseObject</span> = <b>null</b>;
                    <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a> <span id="r444 rd" class="r444 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>;
 
                    <span class="c">// Check if tag is PrimaryKnownType.</span>
                    <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r445 rd" class="r445 r">pktInfo</span> = <a href="#295889332d482ff3" class="t t">KnownTypes</a>.<span class="i">GetTypeSerializationInfoFromItemTag</span>(<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
                    <b>if</b> (<span class="r445 r">pktInfo</span> != <b>null</b>)
                    {
                        <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Primitive Knowntype Element {0}&quot;</span>, <span class="r445 r">pktInfo</span>.<a href="#1c4666f39a3dc592" class="i property">ItemTag</a>);
                        <span class="r443 r">baseObject</span> = <a href="#66f32c4593b8e3cb" class="i method">ReadPrimaryKnownType</a>(<span class="r445 r">pktInfo</span>);
                    }
                    <b>else</b> <b>if</b> (<a href="#c4bbe86c9267ad4c" class="i method">IsKnownContainerTag</a>(<b>out</b> <span class="r444 r">ct</span>))
                    {
                        <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Found container node {0}&quot;</span>, <span class="r444 r">ct</span>);
                        <span class="r443 r">baseObject</span> = <a href="#a82c49332f538ee1" class="i method">ReadKnownContainer</a>(<span class="r444 r">ct</span>);
                    }
                    <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#55152cd7ae13df89" class="i field">PSObjectTag</a>))
                    {
                        <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Found PSObject node&quot;</span>);
                        <span class="r443 r">baseObject</span> = <a href="#96224a243ecbccc7" class="i method">ReadOneObject</a>();
                    }
                    <b>else</b>
                    {
                        <span class="c">// We have an unknown tag</span>
                        <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Unknown tag {0} encountered&quot;</span>, <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
                        <b>if</b> (<a href="#d6596f6da316b6f1" class="i property">UnknownTagsAllowed</a>)
                        {
                            <a href="#6486c187ad9b2032" class="i method">Skip</a>();
                        }
                        <b>else</b>
                        {
                            <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidElementTag</span>, <b>null</b>, <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r443 r">baseObject</span> != <b>null</b>)
                    {
                        <span class="r441 r">dso</span>.<a href="MshObject.cs.html#da2fa2de3c634732" class="i method">SetCoreOnDeserialization</a>(<span class="r443 r">baseObject</span>, <span class="r442 r">overrideTypeInfo</span>);
                    }
                }
            }
 
            <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r446 rd" class="r446 r">immediateBasePso</span> = <span class="r441 r">dso</span>.<a href="MshObject.cs.html#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>as</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <b>if</b> (<span class="r446 r">immediateBasePso</span> != <b>null</b>)
            {
                <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#41bdc8470b711aef" class="i method">CopyDeserializerFields</a>(<span class="r447 r">source</span>: <span class="r446 r">immediateBasePso</span>, <span class="r448 r">target</span>: <span class="r441 r">dso</span>);
            }
 
            <b>return</b> <span class="r441 r">dso</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This function reads the refId attribute and creates a</span>
        <span class="c">///</span><span class="c"> mshObject for that attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">MshObject which is created for refId.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="53177a1c0d079c27" href="../R/53177a1c0d079c27.html" target="n" data-glyph="76,1" class="i method">ReadAttributeAndCreatePSObject</a>()
        {
            <b>string</b> <span id="r449 rd" class="r449 r">refId</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">GetAttribute</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>);
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r450 rd" class="r450 r">sh</span> = <b>new</b> <a href="MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
 
            <span class="c">// RefId is not mandatory attribute</span>
            <b>if</b> (<span class="r449 r">refId</span> != <b>null</b>)
            {
                <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Read PSObject with refId: {0}&quot;</span>, <span class="r449 r">refId</span>);
                <a href="#5ce7dd114c248124" class="i field">_objectRefIdHandler</a>.<a href="#deb3becbbebcc32a" class="i method">SetRefId</a>(<span class="r450 r">sh</span>, <span class="r449 r">refId</span>, <a href="#758c46d6a86d6840" class="k">this</a>.<a href="#05310f62acf2c1d4" class="i property">DuplicateRefIdsAllowed</a>);
            }
 
            <b>return</b> <span class="r450 r">sh</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read type names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r451 r">dso</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSObject to which TypeNames are added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="34d849071d8ca31d" href="../R/34d849071d8ca31d.html" target="n" data-glyph="76,1" class="i method">ReadTypeNames</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r451 rd" class="r451 r">dso</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r451 r">dso</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>, <span class="s">&quot;NodeType should be Element&quot;</span>);
 
            <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#3556fda8cf74c102" class="i field">TypeNamesTag</a>))
            {
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r452 rd" class="r452 r">typeNames</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
                <span class="c">// Read refId attribute if available</span>
                <b>string</b> <span id="r453 rd" class="r453 r">refId</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">GetAttribute</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>);
 
                <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Processing TypeNamesTag with refId {0}&quot;</span>, <span class="r453 r">refId</span>);
 
                <b>if</b> (<a href="#c80a7e45efc82f44" class="i method">ReadStartElementAndHandleEmpty</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#3556fda8cf74c102" class="i field">TypeNamesTag</a>))
                {
                    <b>while</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                    {
                        <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#476bdd03866c20b1" class="i field">TypeNamesItemTag</a>))
                        {
                            <b>string</b> <span id="r454 rd" class="r454 r">item</span> = <a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#476bdd03866c20b1" class="i field">TypeNamesItemTag</a>);
                            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r454 r">item</span>))
                            {
                                <a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#db7dc44760507147" class="i method">AddDeserializationPrefix</a>(<b>ref</b> <span class="r454 r">item</span>);
                                <span class="r452 r">typeNames</span>.<span class="i">Add</span>(<span class="r454 r">item</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidElementTag</span>, <b>null</b>, <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>);
                        }
                    }
 
                    <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
                }
 
                <span class="r451 r">dso</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a> = <b>new</b> <span class="t">ConsolidatedString</span>(<span class="r452 r">typeNames</span>);
 
                <b>if</b> (<span class="r453 r">refId</span> != <b>null</b>)
                {
                    <a href="#764321197415c9fd" class="i field">_typeRefIdHandler</a>.<a href="#deb3becbbebcc32a" class="i method">SetRefId</a>(<span class="r451 r">dso</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>, <span class="r453 r">refId</span>, <a href="#758c46d6a86d6840" class="k">this</a>.<a href="#05310f62acf2c1d4" class="i property">DuplicateRefIdsAllowed</a>);
                }
            }
            <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#9d4a1e751c04e939" class="i field">TypeNamesReferenceTag</a>))
            {
                <b>string</b> <span id="r455 rd" class="r455 r">refId</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">GetAttribute</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>);
                <a href="#8a06a1d5cce72a40" class="i field">s_trace</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Processing TypeNamesReferenceTag with refId {0}&quot;</span>, <span class="r455 r">refId</span>);
                <b>if</b> (<span class="r455 r">refId</span> == <b>null</b>)
                {
                    <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">AttributeExpected</span>, <b>null</b>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8421189e6a8f4437" class="i field">ReferenceIdAttribute</a>);
                }
 
                <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <span id="r456 rd" class="r456 r">typeNames</span> = <a href="#764321197415c9fd" class="i field">_typeRefIdHandler</a>.<a href="#64b04165c058afc2" class="i method">GetReferencedObject</a>(<span class="r455 r">refId</span>);
                <b>if</b> (<span class="r456 r">typeNames</span> == <b>null</b>)
                {
                    <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidTypeHierarchyReferenceId</span>, <b>null</b>, <span class="r455 r">refId</span>);
                }
 
                <span class="c">// At this point we know that we will clone the ConsolidatedString object, so we might end up</span>
                <span class="c">// allocating much more memory than the length of the xml string</span>
                <span class="c">// We have to account for that to limit that to remoting quota and protect against OOM.</span>
                <a href="#3afea128f5cba056" class="i field">_context</a>.<span class="i">LogExtraMemoryUsage</span>(
                    <span class="r456 r">typeNames</span>.<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>.<span class="i">Length</span> * <b>sizeof</b>(<b>char</b>) <span class="c">// Key is shared among the cloned and original object</span>
                                                        <span class="c">// but the list of strings isn&#39;t.  The expression to the left</span>
                                                        <span class="c">// is roughly the size of memory the list of strings occupies</span>
                    - 29 <span class="c">// size of &lt;Obj&gt;&lt;TNRef RefId=&quot;0&quot;/&gt;&lt;/Obj&gt; in UTF8 encoding</span>
                    );
                <span class="r451 r">dso</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a> = <b>new</b> <a href="TypeTable.cs.html#17d617d311bac184" class="t constructor">ConsolidatedString</a>(<span class="r456 r">typeNames</span>);
 
                <span class="c">// Skip the node</span>
                <a href="#6486c187ad9b2032" class="i method">Skip</a>();
            }
            <b>else</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;caller should validate that we do no reach here&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b7cb167c6aea53fa" href="../R/b7cb167c6aea53fa.html" target="n" data-glyph="76,1" class="i method">ReadProperties</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r457 rd" class="r457 r">dso</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r457 r">dso</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>, <span class="s">&quot;NodeType should be Element&quot;</span>);
 
            <span class="c">// Since we are adding baseobject properties as propertybag,</span>
            <span class="c">// mark the object as deserialized.</span>
            <span class="r457 r">dso</span>.<a href="MshObject.cs.html#598b509cd0dd9b32" class="i property">IsDeserialized</a> = <b>true</b>;
            <span class="r457 r">dso</span>.<a href="MshObject.cs.html#5c4993d343040815" class="i property">AdaptedMembers</a> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;();
 
            <span class="c">// Add the GetType method to the instance members, so that it works on deserialized psobjects</span>
            <span class="r457 r">dso</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>.<a href="CoreAdapter.cs.html#37b1315c558998d3" class="i method">GetDotNetMethod</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r457 r">dso</span>, <span class="s">&quot;GetType&quot;</span>));
            <a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#bad6a11737238f9f" class="i method">SetHasInstanceMember</a>(<span class="s">&quot;GetType&quot;</span>);
 
            <span class="c">// Set Clr members to a collection which is empty</span>
            <span class="r457 r">dso</span>.<a href="MshObject.cs.html#26fbd5ca52191910" class="i property">ClrMembers</a> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;();
 
            <b>if</b> (<a href="#c80a7e45efc82f44" class="i method">ReadStartElementAndHandleEmpty</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d37b5e9f200f7f6a" class="i field">AdapterProperties</a>))
            {
                <span class="c">// Read one or more property elements</span>
                <b>while</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                {
                    <b>string</b> <span id="r458 rd" class="r458 r">property</span> = <a href="#67f3491c8b0e1f9f" class="i method">ReadNameAttribute</a>();
                    <b>object</b> <span id="r459 rd" class="r459 r">value</span> = <a href="#96224a243ecbccc7" class="i method">ReadOneObject</a>();
                    <a href="MshMemberInfo.cs.html#3632258af753748e" class="t t">PSProperty</a> <span id="r460 rd" class="r460 r">prop</span> = <b>new</b> <a href="MshMemberInfo.cs.html#f4fe5e12cb01d80b" class="t constructor">PSProperty</a>(<span class="r458 r">property</span>, <span class="r459 r">value</span>);
                    <span class="r457 r">dso</span>.<a href="MshObject.cs.html#5c4993d343040815" class="i property">AdaptedMembers</a>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r460 r">prop</span>);
                }
 
                <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> memberset
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read memberset.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r461 r">collection</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> collection to which members are added</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="1c103b3ff356bffb" href="../R/1c103b3ff356bffb.html" target="n" data-glyph="76,1" class="i method">ReadMemberSet</a>(<a href="MshMemberInfo.cs.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r461 rd" class="r461 r">collection</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r461 r">collection</span> != <b>null</b>, <span class="s">&quot;caller should validate the value&quot;</span>);
 
            <b>if</b> (<a href="#c80a7e45efc82f44" class="i method">ReadStartElementAndHandleEmpty</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8a520e1fcc48fc22" class="i field">MemberSet</a>))
            {
                <b>while</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                {
                    <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8a520e1fcc48fc22" class="i field">MemberSet</a>))
                    {
                        <b>string</b> <span id="r462 rd" class="r462 r">name</span> = <a href="#67f3491c8b0e1f9f" class="i method">ReadNameAttribute</a>();
                        <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <span id="r463 rd" class="r463 r">set</span> = <b>new</b> <a href="MshMemberInfo.cs.html#bc1328d600a2cc4d" class="t constructor">PSMemberSet</a>(<span class="r462 r">name</span>);
                        <span class="r461 r">collection</span>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r463 r">set</span>);
                        <a href="#1c103b3ff356bffb" class="i method">ReadMemberSet</a>(<span class="r463 r">set</span>.<a href="MshMemberInfo.cs.html#23ba75fd4c58af6c" class="i property">Members</a>);
 
                        <a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#bad6a11737238f9f" class="i method">SetHasInstanceMember</a>(<span class="r462 r">name</span>);
                    }
                    <b>else</b>
                    {
                        <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r464 rd" class="r464 r">note</span> = <a href="#464196537f293e4a" class="i method">ReadNoteProperty</a>();
                        <span class="r461 r">collection</span>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r464 r">note</span>);
 
                        <a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#bad6a11737238f9f" class="i method">SetHasInstanceMember</a>(<span class="r464 r">note</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
                    }
                }
 
                <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read note.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <a id="464196537f293e4a" href="../R/464196537f293e4a.html" target="n" data-glyph="76,1" class="i method">ReadNoteProperty</a>()
        {
            <b>string</b> <span id="r465 rd" class="r465 r">name</span> = <a href="#67f3491c8b0e1f9f" class="i method">ReadNameAttribute</a>();
            <b>object</b> <span id="r466 rd" class="r466 r">value</span> = <a href="#96224a243ecbccc7" class="i method">ReadOneObject</a>();
            <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r467 rd" class="r467 r">note</span> = <b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="r465 r">name</span>, <span class="r466 r">value</span>);
            <b>return</b> <span class="r467 r">note</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> memberset
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> known container
 
        <b>private bool</b> <a id="c4bbe86c9267ad4c" href="../R/c4bbe86c9267ad4c.html" target="n" data-glyph="76,1" class="i method">IsKnownContainerTag</a>(<b>out</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a> <span id="r468 rd" class="r468 r">ct</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>, <span class="s">&quot;Expected node type is element&quot;</span>);
 
            <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#291a813ba557e056" class="i field">DictionaryTag</a>))
            {
                <span class="r468 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a994255a39d73423" class="i field">Dictionary</a>;
            }
            <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d5e72c1588a828b2" class="i field">QueueTag</a>))
            {
                <span class="r468 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#43a90845e1f3d405" class="i field">Queue</a>;
            }
            <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#624a489686d9f226" class="i field">StackTag</a>))
            {
                <span class="r468 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#7d548ce8f85a24e5" class="i field">Stack</a>;
            }
            <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#1a7c55cb3a874e56" class="i field">ListTag</a>))
            {
                <span class="r468 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#8976c008611097e9" class="i field">List</a>;
            }
            <b>else</b> <b>if</b> (<a href="#a11205c327aab4ed" class="i method">IsNextElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#57e1165cb3ca760d" class="i field">CollectionTag</a>))
            {
                <span class="r468 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#4b85ec47c1309261" class="i field">Enumerable</a>;
            }
            <b>else</b>
            {
                <span class="r468 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>;
            }
 
            <b>return</b> <span class="r468 r">ct</span> != <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>;
        }
 
        <b>private object</b> <a id="a82c49332f538ee1" href="../R/a82c49332f538ee1.html" target="n" data-glyph="76,1" class="i method">ReadKnownContainer</a>(<a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a> <span id="r469 rd" class="r469 r">ct</span>)
        {
            <b>switch</b> (<span class="r469 r">ct</span>)
            {
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a994255a39d73423" class="i field">Dictionary</a>:
                    <b>return</b> <a href="#e1cf4d90e38872c4" class="i method">ReadDictionary</a>(<span class="r469 r">ct</span>);
 
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#4b85ec47c1309261" class="i field">Enumerable</a>:
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#8976c008611097e9" class="i field">List</a>:
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#43a90845e1f3d405" class="i field">Queue</a>:
                <b>case</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#7d548ce8f85a24e5" class="i field">Stack</a>:
                    <b>return</b> <a href="#a633a4dede13f961" class="i method">ReadListContainer</a>(<span class="r469 r">ct</span>);
 
                <b>default</b>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Unrecognized ContainerType enum&quot;</span>);
                    <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read List Containers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private object</b> <a id="a633a4dede13f961" href="../R/a633a4dede13f961.html" target="n" data-glyph="76,1" class="i method">ReadListContainer</a>(<a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a> <span id="r470 rd" class="r470 r">ct</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r470 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#4b85ec47c1309261" class="i field">Enumerable</a> ||
                       <span class="r470 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#8976c008611097e9" class="i field">List</a> ||
                       <span class="r470 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#43a90845e1f3d405" class="i field">Queue</a> ||
                       <span class="r470 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#7d548ce8f85a24e5" class="i field">Stack</a>, <span class="s">&quot;ct should be queue, stack, enumerable or list&quot;</span>);
 
            <span class="i">ArrayList</span> <span id="r471 rd" class="r471 r">list</span> = <b>new</b> <span class="i">ArrayList</span>();
            <b>if</b> (<span class="i">ReadStartElementAndHandleEmpty</span>(<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span>))
            {
                <b>while</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                {
                    <span class="r471 r">list</span>.<span class="i">Add</span>(<a href="#96224a243ecbccc7" class="i method">ReadOneObject</a>());
                }
 
                <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
            }
 
            <b>if</b> (<span class="r470 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#7d548ce8f85a24e5" class="i field">Stack</a>)
            {
                <span class="r471 r">list</span>.<span class="i">Reverse</span>();
                <b>return</b> <b>new</b> <span class="i">Stack</span>(<span class="r471 r">list</span>);
            }
            <b>else</b> <b>if</b> (<span class="r470 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#43a90845e1f3d405" class="i field">Queue</a>)
            {
                <b>return</b> <b>new</b> <span class="i">Queue</span>(<span class="r471 r">list</span>);
            }
 
            <b>return</b> <span class="r471 r">list</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserialize Dictionary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private object</b> <a id="e1cf4d90e38872c4" href="../R/e1cf4d90e38872c4.html" target="n" data-glyph="76,1" class="i method">ReadDictionary</a>(<a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a> <span id="r472 rd" class="r472 r">ct</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r472 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a994255a39d73423" class="i field">Dictionary</a>, <span class="s">&quot;Unrecognized ContainerType enum&quot;</span>);
 
            <span class="c">// We assume the hash table is a PowerShell hash table and hence uses</span>
            <span class="c">// a case insensitive string comparer.  If we discover a key collision,</span>
            <span class="c">// we&#39;ll revert back to the default comparer.</span>
            <span class="i">Hashtable</span> <span id="r473 rd" class="r473 r">table</span> = <b>new</b> <span class="i">Hashtable</span>(<span class="i">StringComparer</span>.<span class="i">CurrentCultureIgnoreCase</span>);
            <b>int</b> <span id="r474 rd" class="r474 r">keyClashFoundIteration</span> = 0;
            <b>if</b> (<a href="#c80a7e45efc82f44" class="i method">ReadStartElementAndHandleEmpty</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#291a813ba557e056" class="i field">DictionaryTag</a>))
            {
                <b>while</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                {
                    <a href="#7082a06da2dc9e29" class="i method">ReadStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#31d86cf81e78e345" class="i field">DictionaryEntryTag</a>);
 
                    <span class="c">// Read Key</span>
                    <b>if</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> != <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                    {
                        <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">DictionaryKeyNotSpecified</span>, <b>null</b>);
                    }
 
                    <b>string</b> <span id="r475 rd" class="r475 r">name</span> = <a href="#67f3491c8b0e1f9f" class="i method">ReadNameAttribute</a>();
                    <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r475 r">name</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fa73c9a51afaddf8" class="i field">DictionaryKey</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidDictionaryKeyName</span>, <b>null</b>);
                    }
 
                    <b>object</b> <span id="r476 rd" class="r476 r">key</span> = <a href="#96224a243ecbccc7" class="i method">ReadOneObject</a>();
 
                    <b>if</b> (<span class="r476 r">key</span> == <b>null</b>)
                    {
                        <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">NullAsDictionaryKey</span>, <b>null</b>);
                    }
                    <span class="c">// Read Value</span>
                    <b>if</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> != <span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                    {
                        <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">DictionaryValueNotSpecified</span>, <b>null</b>);
                    }
 
                    <span class="r475 r">name</span> = <a href="#67f3491c8b0e1f9f" class="i method">ReadNameAttribute</a>();
                    <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r475 r">name</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#84730c210285badb" class="i field">DictionaryValue</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidDictionaryValueName</span>, <b>null</b>);
                    }
 
                    <b>object</b> <span id="r477 rd" class="r477 r">value</span> = <a href="#96224a243ecbccc7" class="i method">ReadOneObject</a>();
 
                    <span class="c">// On the first collision, copy the hash table to one that uses the default comparer.</span>
                    <b>if</b> (<span class="r473 r">table</span>.<span class="i">ContainsKey</span>(<span class="r476 r">key</span>) &amp;&amp; (<span class="r474 r">keyClashFoundIteration</span> == 0))
                    {
                        <span class="r474 r">keyClashFoundIteration</span>++;
                        <span class="i">Hashtable</span> <span id="r478 rd" class="r478 r">newHashTable</span> = <b>new</b> <span class="i">Hashtable</span>();
                        <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r479 rd" class="r479 r">entry</span> <b>in</b> <span class="r473 r">table</span>)
                        {
                            <span class="r478 r">newHashTable</span>.<span class="i">Add</span>(<span class="r479 r">entry</span>.<span class="i">Key</span>, <span class="r479 r">entry</span>.<span class="i">Value</span>);
                        }
 
                        <span class="r473 r">table</span> = <span class="r478 r">newHashTable</span>;
                    }
 
                    <span class="c">// win8: 389060. If there are still collisions even with case-sensitive default comparer,</span>
                    <span class="c">// use an IEqualityComparer that does object ref equality.</span>
                    <b>if</b> (<span class="r473 r">table</span>.<span class="i">ContainsKey</span>(<span class="r476 r">key</span>) &amp;&amp; (<span class="r474 r">keyClashFoundIteration</span> == 1))
                    {
                        <span class="r474 r">keyClashFoundIteration</span>++;
                        <span class="i">IEqualityComparer</span> <span id="r480 rd" class="r480 r">equalityComparer</span> = <b>new</b> <span class="t">ReferenceEqualityComparer</span>();
                        <span class="i">Hashtable</span> <span id="r481 rd" class="r481 r">newHashTable</span> = <b>new</b> <span class="i">Hashtable</span>(<span class="r480 r">equalityComparer</span>);
                        <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r482 rd" class="r482 r">entry</span> <b>in</b> <span class="r473 r">table</span>)
                        {
                            <span class="r481 r">newHashTable</span>.<span class="i">Add</span>(<span class="r482 r">entry</span>.<span class="i">Key</span>, <span class="r482 r">entry</span>.<span class="i">Value</span>);
                        }
 
                        <span class="r473 r">table</span> = <span class="r481 r">newHashTable</span>;
                    }
 
                    <b>try</b>
                    {
                        <span class="c">// Add entry to hashtable</span>
                        <span class="r473 r">table</span>.<span class="i">Add</span>(<span class="r476 r">key</span>, <span class="r477 r">value</span>);
                    }
                    <b>catch</b> (<span class="i">ArgumentException</span> <span id="r483 rd" class="r483 r">e</span>)
                    {
                        <b>throw</b> <a href="#758c46d6a86d6840" class="k">this</a>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r483 r">e</span>, <b>typeof</b>(<span class="i">Hashtable</span>));
                    }
 
                    <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
                }
 
                <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
            }
 
            <b>return</b> <span class="r473 r">table</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> known containers
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> deserialization
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Getting XmlReaderSettings
 
        <b>internal static</b> <span class="i">XmlReaderSettings</span> <a id="68d86b2b9f57584d" href="../R/68d86b2b9f57584d.html" target="n" data-glyph="104,1" class="i property">XmlReaderSettingsForCliXml</a> { <b>get</b>; } = <a href="#b1768faec0704f34" class="i method">GetXmlReaderSettingsForCliXml</a>();
 
        <b>private static</b> <span class="i">XmlReaderSettings</span> <a id="b1768faec0704f34" href="../R/b1768faec0704f34.html" target="n" data-glyph="76,1" class="i method">GetXmlReaderSettingsForCliXml</a>()
        {
            <span class="i">XmlReaderSettings</span> <span id="r484 rd" class="r484 r">xrs</span> = <b>new</b> <span class="i">XmlReaderSettings</span>();
 
            <span class="r484 r">xrs</span>.<span class="i">CheckCharacters</span> = <b>false</b>;
            <span class="r484 r">xrs</span>.<span class="i">CloseInput</span> = <b>false</b>;
 
            <span class="c">// The XML data needs to be in conformance to the rules for a well-formed XML 1.0 document.</span>
            <span class="r484 r">xrs</span>.<span class="i">ConformanceLevel</span> = <span class="i">ConformanceLevel</span>.<span class="i">Document</span>;
            <span class="r484 r">xrs</span>.<span class="i">IgnoreComments</span> = <b>true</b>;
            <span class="r484 r">xrs</span>.<span class="i">IgnoreProcessingInstructions</span> = <b>true</b>;
            <span class="r484 r">xrs</span>.<span class="i">IgnoreWhitespace</span> = <b>false</b>;
            <span class="r484 r">xrs</span>.<span class="i">MaxCharactersFromEntities</span> = 1024;
            <span class="r484 r">xrs</span>.<span class="i">XmlResolver</span> = <b>null</b>;
            <span class="r484 r">xrs</span>.<span class="i">DtdProcessing</span> = <span class="i">DtdProcessing</span>.<span class="i">Prohibit</span>;
            <span class="r484 r">xrs</span>.<span class="i">Schemas</span> = <b>null</b>;
            <span class="r484 r">xrs</span>.<span class="i">ValidationFlags</span> = <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">Schema</span>.<span class="i">XmlSchemaValidationFlags</span>.<span class="i">None</span>;
            <span class="r484 r">xrs</span>.<span class="i">ValidationType</span> = <span class="i">ValidationType</span>.<span class="i">None</span>;
            <b>return</b> <span class="r484 r">xrs</span>;
        }
 
        <b>internal static</b> <span class="i">XmlReaderSettings</span> <a id="b7ced31d9e3d32cb" href="../R/b7ced31d9e3d32cb.html" target="n" data-glyph="104,1" class="i property">XmlReaderSettingsForUntrustedXmlDocument</a> { <b>get</b>; } = <a href="#f51e2af90e315907" class="i method">GetXmlReaderSettingsForUntrustedXmlDocument</a>();
 
        <b>private static</b> <span class="i">XmlReaderSettings</span> <a id="f51e2af90e315907" href="../R/f51e2af90e315907.html" target="n" data-glyph="76,1" class="i method">GetXmlReaderSettingsForUntrustedXmlDocument</a>()
        {
            <span class="i">XmlReaderSettings</span> <span id="r485 rd" class="r485 r">settings</span> = <b>new</b> <span class="i">XmlReaderSettings</span>();
 
            <span class="r485 r">settings</span>.<span class="i">CheckCharacters</span> = <b>false</b>;
            <span class="r485 r">settings</span>.<span class="i">ConformanceLevel</span> = <span class="i">ConformanceLevel</span>.<span class="i">Auto</span>;
            <span class="r485 r">settings</span>.<span class="i">IgnoreComments</span> = <b>true</b>;
            <span class="r485 r">settings</span>.<span class="i">IgnoreProcessingInstructions</span> = <b>true</b>;
            <span class="r485 r">settings</span>.<span class="i">IgnoreWhitespace</span> = <b>true</b>;
            <span class="r485 r">settings</span>.<span class="i">MaxCharactersFromEntities</span> = 1024;
            <span class="r485 r">settings</span>.<span class="i">MaxCharactersInDocument</span> = 512 * 1024 * 1024; <span class="c">// 512M characters = 1GB</span>
            <span class="r485 r">settings</span>.<span class="i">XmlResolver</span> = <b>null</b>;
            <span class="r485 r">settings</span>.<span class="i">DtdProcessing</span> = <span class="i">DtdProcessing</span>.<span class="i">Parse</span>;   <span class="c">// Allowing DTD parsing with limits of MaxCharactersFromEntities/MaxCharactersInDocument</span>
            <span class="r485 r">settings</span>.<span class="i">ValidationFlags</span> = <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">Schema</span>.<span class="i">XmlSchemaValidationFlags</span>.<span class="i">None</span>;
            <span class="r485 r">settings</span>.<span class="i">ValidationType</span> = <span class="i">ValidationType</span>.<span class="i">None</span>;
            <b>return</b> <span class="r485 r">settings</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> known type deserialization
 
        <b>internal static object</b> <a id="46a3f0fb657a6acf" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeBoolean</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r486 rd" class="r486 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r486 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToBoolean</span>(<span class="r486 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r487 rd" class="r487 r">e</span>)
            {
                <b>throw</b> <span class="r486 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r487 r">e</span>, <b>typeof</b>(<b>bool</b>).<span class="i">FullName</span>);
            }
        }
 
        <b>internal static object</b> <a id="fec33f430138196d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeByte</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r488 rd" class="r488 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r488 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r489 rd" class="r489 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToByte</span>(<span class="r488 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r490 rd" class="r490 r">e</span>)
            {
                <span class="r489 r">recognizedException</span> = <span class="r490 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r491 rd" class="r491 r">e</span>)
            {
                <span class="r489 r">recognizedException</span> = <span class="r491 r">e</span>;
            }
 
            <b>throw</b> <span class="r488 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r489 r">recognizedException</span>, <b>typeof</b>(<b>byte</b>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="999f7b9bee4df346" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeChar</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r492 rd" class="r492 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r492 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r493 rd" class="r493 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> (<b>char</b>)<span class="i">XmlConvert</span>.<span class="i">ToUInt16</span>(<span class="r492 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r494 rd" class="r494 r">e</span>)
            {
                <span class="r493 r">recognizedException</span> = <span class="r494 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r495 rd" class="r495 r">e</span>)
            {
                <span class="r493 r">recognizedException</span> = <span class="r495 r">e</span>;
            }
 
            <b>throw</b> <span class="r492 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r493 r">recognizedException</span>, <b>typeof</b>(<b>char</b>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="18c461390b430669" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeDateTime</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r496 rd" class="r496 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r496 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToDateTime</span>(<span class="r496 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>(), <span class="i">XmlDateTimeSerializationMode</span>.<span class="i">RoundtripKind</span>);
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r497 rd" class="r497 r">e</span>)
            {
                <b>throw</b> <span class="r496 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r497 r">e</span>, <b>typeof</b>(<span class="i">DateTime</span>).<span class="i">FullName</span>);
            }
        }
 
        <b>internal static object</b> <a id="7eb812ae8a76a2a4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeDecimal</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r498 rd" class="r498 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r498 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r499 rd" class="r499 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToDecimal</span>(<span class="r498 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r500 rd" class="r500 r">e</span>)
            {
                <span class="r499 r">recognizedException</span> = <span class="r500 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r501 rd" class="r501 r">e</span>)
            {
                <span class="r499 r">recognizedException</span> = <span class="r501 r">e</span>;
            }
 
            <b>throw</b> <span class="r498 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r499 r">recognizedException</span>, <b>typeof</b>(<b>decimal</b>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="f167048c0b6c5292" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeDouble</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r502 rd" class="r502 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r502 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r503 rd" class="r503 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToDouble</span>(<span class="r502 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r504 rd" class="r504 r">e</span>)
            {
                <span class="r503 r">recognizedException</span> = <span class="r504 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r505 rd" class="r505 r">e</span>)
            {
                <span class="r503 r">recognizedException</span> = <span class="r505 r">e</span>;
            }
 
            <b>throw</b> <span class="r502 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r503 r">recognizedException</span>, <b>typeof</b>(<b>double</b>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="f0b910537f5e15c0" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeGuid</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r506 rd" class="r506 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r506 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r507 rd" class="r507 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToGuid</span>(<span class="r506 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <span class="c">// MSDN for XmlConvert.ToGuid doesn&#39;t list any exceptions, but</span>
            <span class="c">// Reflector shows that this just calls to new Guid(string)</span>
            <span class="c">// which MSDN documents can throw Format/OverflowException</span>
            <b>catch</b> (<span class="i">FormatException</span> <span id="r508 rd" class="r508 r">e</span>)
            {
                <span class="r507 r">recognizedException</span> = <span class="r508 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r509 rd" class="r509 r">e</span>)
            {
                <span class="r507 r">recognizedException</span> = <span class="r509 r">e</span>;
            }
 
            <b>throw</b> <span class="r506 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r507 r">recognizedException</span>, <b>typeof</b>(<span class="i">Guid</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="27f1b1f3e602d0e4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeVersion</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r510 rd" class="r510 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r510 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r511 rd" class="r511 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <b>new</b> <span class="i">Version</span>(<span class="r510 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r512 rd" class="r512 r">e</span>)
            {
                <span class="r511 r">recognizedException</span> = <span class="r512 r">e</span>;
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r513 rd" class="r513 r">e</span>)
            {
                <span class="r511 r">recognizedException</span> = <span class="r513 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r514 rd" class="r514 r">e</span>)
            {
                <span class="r511 r">recognizedException</span> = <span class="r514 r">e</span>;
            }
 
            <b>throw</b> <span class="r510 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r511 r">recognizedException</span>, <b>typeof</b>(<span class="i">Version</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="05ca8ec03105713d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeSemanticVersion</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r515 rd" class="r515 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r515 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r516 rd" class="r516 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <b>new</b> <span class="t">SemanticVersion</span>(<span class="r515 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r517 rd" class="r517 r">e</span>)
            {
                <span class="r516 r">recognizedException</span> = <span class="r517 r">e</span>;
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r518 rd" class="r518 r">e</span>)
            {
                <span class="r516 r">recognizedException</span> = <span class="r518 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r519 rd" class="r519 r">e</span>)
            {
                <span class="r516 r">recognizedException</span> = <span class="r519 r">e</span>;
            }
 
            <b>throw</b> <span class="r515 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r516 r">recognizedException</span>, <b>typeof</b>(<span class="i">Version</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="6568a05c81313a1b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeInt16</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r520 rd" class="r520 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r520 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r521 rd" class="r521 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToInt16</span>(<span class="r520 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r522 rd" class="r522 r">e</span>)
            {
                <span class="r521 r">recognizedException</span> = <span class="r522 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r523 rd" class="r523 r">e</span>)
            {
                <span class="r521 r">recognizedException</span> = <span class="r523 r">e</span>;
            }
 
            <b>throw</b> <span class="r520 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r521 r">recognizedException</span>, <b>typeof</b>(<span class="i">Int16</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="866a46d46afbdad2" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeInt32</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r524 rd" class="r524 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r524 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r525 rd" class="r525 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToInt32</span>(<span class="r524 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r526 rd" class="r526 r">e</span>)
            {
                <span class="r525 r">recognizedException</span> = <span class="r526 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r527 rd" class="r527 r">e</span>)
            {
                <span class="r525 r">recognizedException</span> = <span class="r527 r">e</span>;
            }
 
            <b>throw</b> <span class="r524 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r525 r">recognizedException</span>, <b>typeof</b>(<span class="i">Int32</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="319c17d0759bec05" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeInt64</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r528 rd" class="r528 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r528 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r529 rd" class="r529 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToInt64</span>(<span class="r528 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r530 rd" class="r530 r">e</span>)
            {
                <span class="r529 r">recognizedException</span> = <span class="r530 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r531 rd" class="r531 r">e</span>)
            {
                <span class="r529 r">recognizedException</span> = <span class="r531 r">e</span>;
            }
 
            <b>throw</b> <span class="r528 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r529 r">recognizedException</span>, <b>typeof</b>(<span class="i">Int64</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="5a7f2c2798f90efb" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeSByte</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r532 rd" class="r532 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r532 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r533 rd" class="r533 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToSByte</span>(<span class="r532 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r534 rd" class="r534 r">e</span>)
            {
                <span class="r533 r">recognizedException</span> = <span class="r534 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r535 rd" class="r535 r">e</span>)
            {
                <span class="r533 r">recognizedException</span> = <span class="r535 r">e</span>;
            }
 
            <b>throw</b> <span class="r532 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r533 r">recognizedException</span>, <b>typeof</b>(<b>sbyte</b>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="0156141e0667bd15" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeSingle</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r536 rd" class="r536 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r536 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r537 rd" class="r537 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToSingle</span>(<span class="r536 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r538 rd" class="r538 r">e</span>)
            {
                <span class="r537 r">recognizedException</span> = <span class="r538 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r539 rd" class="r539 r">e</span>)
            {
                <span class="r537 r">recognizedException</span> = <span class="r539 r">e</span>;
            }
 
            <b>throw</b> <span class="r536 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r537 r">recognizedException</span>, <b>typeof</b>(<b>float</b>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="52e3c223837e47ac" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeScriptBlock</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r540 rd" class="r540 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r540 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>string</b> <span id="r541 rd" class="r541 r">scriptBlockBody</span> = <span class="r540 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#469f40d4227c1ab0" class="i field">ScriptBlockTag</a>);
            <b>if</b> ((<span class="r540 r">deserializer</span>.<a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#e467cab010ecbea0" class="i field">options</a> &amp; <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#5d8ca67651daec75" class="i field">DeserializeScriptBlocks</a>) == <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#5d8ca67651daec75" class="i field">DeserializeScriptBlocks</a>)
            {
                <b>return</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#adfac0fa7bf5725f" class="i method">Create</a>(<span class="r541 r">scriptBlockBody</span>);
            }
            <b>else</b>
            {
                <span class="c">// Scriptblock is deserialized as string</span>
                <b>return</b> <span class="r541 r">scriptBlockBody</span>;
            }
        }
 
        <b>internal static object</b> <a id="397241d2bc2029dd" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeString</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r542 rd" class="r542 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r542 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>return</b> <span class="r542 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e47a184f9481ee18" class="i field">StringTag</a>);
        }
 
        <b>internal static object</b> <a id="c04ef2e3a73a0f6b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeTimeSpan</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r543 rd" class="r543 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r543 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToTimeSpan</span>(<span class="r543 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r544 rd" class="r544 r">e</span>)
            {
                <b>throw</b> <span class="r543 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r544 r">e</span>, <b>typeof</b>(<span class="i">TimeSpan</span>).<span class="i">FullName</span>);
            }
        }
 
        <b>internal static object</b> <a id="bc93c23052448850" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeUInt16</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r545 rd" class="r545 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r545 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r546 rd" class="r546 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToUInt16</span>(<span class="r545 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r547 rd" class="r547 r">e</span>)
            {
                <span class="r546 r">recognizedException</span> = <span class="r547 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r548 rd" class="r548 r">e</span>)
            {
                <span class="r546 r">recognizedException</span> = <span class="r548 r">e</span>;
            }
 
            <b>throw</b> <span class="r545 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r546 r">recognizedException</span>, <b>typeof</b>(<span class="i">UInt16</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="d23a7a762e70e043" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeUInt32</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r549 rd" class="r549 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r549 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r550 rd" class="r550 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToUInt32</span>(<span class="r549 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r551 rd" class="r551 r">e</span>)
            {
                <span class="r550 r">recognizedException</span> = <span class="r551 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r552 rd" class="r552 r">e</span>)
            {
                <span class="r550 r">recognizedException</span> = <span class="r552 r">e</span>;
            }
 
            <b>throw</b> <span class="r549 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r550 r">recognizedException</span>, <b>typeof</b>(<span class="i">UInt32</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="c0d9940eb9a70144" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeUInt64</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r553 rd" class="r553 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r553 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <span class="i">Exception</span> <span id="r554 rd" class="r554 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <b>return</b> <span class="i">XmlConvert</span>.<span class="i">ToUInt64</span>(<span class="r553 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r555 rd" class="r555 r">e</span>)
            {
                <span class="r554 r">recognizedException</span> = <span class="r555 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r556 rd" class="r556 r">e</span>)
            {
                <span class="r554 r">recognizedException</span> = <span class="r556 r">e</span>;
            }
 
            <b>throw</b> <span class="r553 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r554 r">recognizedException</span>, <b>typeof</b>(<span class="i">UInt64</span>).<span class="i">FullName</span>);
        }
 
        <b>internal static object</b> <a id="456466226fd18368" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeUri</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r557 rd" class="r557 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r557 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>try</b>
            {
                <b>string</b> <span id="r558 rd" class="r558 r">uriString</span> = <span class="r557 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#ea9063e8b96e8aae" class="i field">AnyUriTag</a>);
                <b>return</b> <b>new</b> <span class="i">Uri</span>(<span class="r558 r">uriString</span>, <span class="i">UriKind</span>.<span class="i">RelativeOrAbsolute</span>);
            }
            <b>catch</b> (<span class="i">UriFormatException</span> <span id="r559 rd" class="r559 r">e</span>)
            {
                <b>throw</b> <span class="r557 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r559 r">e</span>, <b>typeof</b>(<span class="i">Uri</span>).<span class="i">FullName</span>);
            }
        }
 
        <b>internal static object</b> <a id="ac09fc6c63c1c608" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeByteArray</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r560 rd" class="r560 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r560 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>try</b>
            {
                <b>return</b> <span class="i">Convert</span>.<span class="i">FromBase64String</span>(<span class="r560 r">deserializer</span>.<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>());
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r561 rd" class="r561 r">e</span>)
            {
                <b>throw</b> <span class="r560 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r561 r">e</span>, <b>typeof</b>(<b>byte</b>[]).<span class="i">FullName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">XmlDocument</span> <a id="ee2ec715b80d2059" href="../R/ee2ec715b80d2059.html" target="n" data-glyph="74,1" class="i method">LoadUnsafeXmlDocument</a>(<span class="i">FileInfo</span> <span id="r562 rd" class="r562 r">xmlPath</span>, <b>bool</b> <span id="r563 rd" class="r563 r">preserveNonElements</span>, <b>int</b>? <span id="r564 rd" class="r564 r">maxCharactersInDocument</span>)
        {
            <span class="i">XmlDocument</span> <span id="r565 rd" class="r565 r">doc</span> = <b>null</b>;
            <span class="c">// same FileStream options as Reflector shows for XmlDocument.Load(path) / XmlDownloadManager.GetStream:</span>
            <b>using</b> (<span class="i">Stream</span> <span id="r566 rd" class="r566 r">stream</span> = <b>new</b> <span class="i">FileStream</span>(<span class="r562 r">xmlPath</span>.<span class="i">FullName</span>, <span class="i">FileMode</span>.<span class="i">Open</span>, <span class="i">FileAccess</span>.<span class="i">Read</span>, <span class="i">FileShare</span>.<span class="i">Read</span>))
            {
                <span class="r565 r">doc</span> = <a href="#cddb40ccf3b18f8b" class="i method">LoadUnsafeXmlDocument</a>(<span class="r566 r">stream</span>, <span class="r563 r">preserveNonElements</span>, <span class="r564 r">maxCharactersInDocument</span>);
            }
 
            <b>return</b> <span class="r565 r">doc</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">XmlDocument</span> <a id="42229722c8bba109" href="../R/42229722c8bba109.html" target="n" data-glyph="74,1" class="i method">LoadUnsafeXmlDocument</a>(<b>string</b> <span id="r567 rd" class="r567 r">xmlContents</span>, <b>bool</b> <span id="r568 rd" class="r568 r">preserveNonElements</span>, <b>int</b>? <span id="r569 rd" class="r569 r">maxCharactersInDocument</span>)
        {
            <b>using</b> (<span class="i">TextReader</span> <span id="r570 rd" class="r570 r">textReader</span> = <b>new</b> <span class="i">StringReader</span>(<span class="r567 r">xmlContents</span>))
            {
                <b>return</b> <a href="#24ed283a3120b525" class="i method">LoadUnsafeXmlDocument</a>(<span class="r570 r">textReader</span>, <span class="r568 r">preserveNonElements</span>, <span class="r569 r">maxCharactersInDocument</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">XmlDocument</span> <a id="cddb40ccf3b18f8b" href="../R/cddb40ccf3b18f8b.html" target="n" data-glyph="74,1" class="i method">LoadUnsafeXmlDocument</a>(<span class="i">Stream</span> <span id="r571 rd" class="r571 r">stream</span>, <b>bool</b> <span id="r572 rd" class="r572 r">preserveNonElements</span>, <b>int</b>? <span id="r573 rd" class="r573 r">maxCharactersInDocument</span>)
        {
            <b>using</b> (<span class="i">TextReader</span> <span id="r574 rd" class="r574 r">textReader</span> = <b>new</b> <span class="i">StreamReader</span>(<span class="r571 r">stream</span>))
            {
                <b>return</b> <a href="#24ed283a3120b525" class="i method">LoadUnsafeXmlDocument</a>(<span class="r574 r">textReader</span>, <span class="r572 r">preserveNonElements</span>, <span class="r573 r">maxCharactersInDocument</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">XmlDocument</span> <a id="24ed283a3120b525" href="../R/24ed283a3120b525.html" target="n" data-glyph="74,1" class="i method">LoadUnsafeXmlDocument</a>(<span class="i">TextReader</span> <span id="r575 rd" class="r575 r">textReader</span>, <b>bool</b> <span id="r576 rd" class="r576 r">preserveNonElements</span>, <b>int</b>? <span id="r577 rd" class="r577 r">maxCharactersInDocument</span>)
        {
            <span class="i">XmlReaderSettings</span> <span id="r578 rd" class="r578 r">settings</span>;
            <b>if</b> (<span class="r577 r">maxCharactersInDocument</span>.<span class="i">HasValue</span> || <span class="r576 r">preserveNonElements</span>)
            {
                <span class="r578 r">settings</span> = <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#b7ced31d9e3d32cb" class="i property">XmlReaderSettingsForUntrustedXmlDocument</a>.<span class="i">Clone</span>();
                <b>if</b> (<span class="r577 r">maxCharactersInDocument</span>.<span class="i">HasValue</span>)
                {
                    <span class="r578 r">settings</span>.<span class="i">MaxCharactersInDocument</span> = <span class="r577 r">maxCharactersInDocument</span>.<span class="i">Value</span>;
                }
 
                <b>if</b> (<span class="r576 r">preserveNonElements</span>)
                {
                    <span class="r578 r">settings</span>.<span class="i">IgnoreWhitespace</span> = <b>false</b>;
                    <span class="r578 r">settings</span>.<span class="i">IgnoreProcessingInstructions</span> = <b>false</b>;
                    <span class="r578 r">settings</span>.<span class="i">IgnoreComments</span> = <b>false</b>;
                }
            }
            <b>else</b>
            {
                <span class="r578 r">settings</span> = <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#b7ced31d9e3d32cb" class="i property">XmlReaderSettingsForUntrustedXmlDocument</a>;
            }
 
            <b>try</b>
            {
                <span class="i">XmlReader</span> <span id="r579 rd" class="r579 r">xmlReader</span> = <span class="i">XmlReader</span>.<span class="i">Create</span>(<span class="r575 r">textReader</span>, <span class="r578 r">settings</span>);
                <span class="i">XmlDocument</span> <span id="r580 rd" class="r580 r">xmlDocument</span> = <b>new</b> <span class="i">XmlDocument</span>();
                <span class="r580 r">xmlDocument</span>.<span class="i">PreserveWhitespace</span> = <span class="r576 r">preserveNonElements</span>;
                <span class="r580 r">xmlDocument</span>.<span class="i">Load</span>(<span class="r579 r">xmlReader</span>);
                <b>return</b> <span class="r580 r">xmlDocument</span>;
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r581 rd" class="r581 r">invalidOperationException</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">XmlException</span>(<span class="r581 r">invalidOperationException</span>.<span class="i">Message</span>, <span class="r581 r">invalidOperationException</span>);
            }
        }
 
        <b>internal static object</b> <a id="bb1df0bb0162db1b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeXmlDocument</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r582 rd" class="r582 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r582 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>string</b> <span id="r583 rd" class="r583 r">docAsString</span> = <span class="r582 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#1309da43deed9dd0" class="i field">XmlDocumentTag</a>);
 
            <b>try</b>
            {
                <b>int</b>? <span id="r584 rd" class="r584 r">maxCharactersInDocument</span> = <b>null</b>;
                <b>if</b> (<span class="r582 r">deserializer</span>.<a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#7f867777951adff9" class="i property">MaximumAllowedMemory</a>.<span class="i">HasValue</span>)
                {
                    <span class="r584 r">maxCharactersInDocument</span> = <span class="r582 r">deserializer</span>.<a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#7f867777951adff9" class="i property">MaximumAllowedMemory</a>.<span class="i">Value</span> / <b>sizeof</b>(<b>char</b>);
                }
 
                <span class="i">XmlDocument</span> <span id="r585 rd" class="r585 r">doc</span> = <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="#42229722c8bba109" class="i method">LoadUnsafeXmlDocument</a>(
                    <span class="r583 r">docAsString</span>,
                    <b>true</b>, <span class="c">/* preserve whitespace, comments, etc. */</span>
                    <span class="r584 r">maxCharactersInDocument</span>);
 
                <span class="r582 r">deserializer</span>.<a href="#3afea128f5cba056" class="i field">_context</a>.<span class="i">LogExtraMemoryUsage</span>((<span class="r583 r">docAsString</span>.<span class="i">Length</span> - <span class="r585 r">doc</span>.<span class="i">OuterXml</span>.<span class="i">Length</span>) * <b>sizeof</b>(<b>char</b>));
 
                <b>return</b> <span class="r585 r">doc</span>;
            }
            <b>catch</b> (<span class="i">XmlException</span> <span id="r586 rd" class="r586 r">e</span>)
            {
                <b>throw</b> <span class="r582 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r586 r">e</span>, <b>typeof</b>(<span class="i">XmlDocument</span>).<span class="i">FullName</span>);
            }
        }
 
        <b>internal static object</b> <a id="d296f19a8c8a2136" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeProgressRecord</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r587 rd" class="r587 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r587 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <span class="c">//</span>
            <span class="c">// read deserialized elements of a progress record</span>
            <span class="c">//</span>
 
            <span class="r587 r">deserializer</span>.<a href="#7082a06da2dc9e29" class="i method">ReadStartElement</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#581f0cd421874e95" class="i field">ProgressRecord</a>);
 
            <b>string</b> <span id="r588 rd" class="r588 r">activity</span> = <b>null</b>, <span id="r589 rd" class="r589 r">currentOperation</span> = <b>null</b>, <span id="r590 rd" class="r590 r">prt</span> = <b>null</b>, <span id="r591 rd" class="r591 r">statusDescription</span> = <b>null</b>;
            <b>int</b> <span id="r592 rd" class="r592 r">activityId</span> = 0, <span id="r593 rd" class="r593 r">parentActivityId</span> = 0, <span id="r594 rd" class="r594 r">percentComplete</span> = 0, <span id="r595 rd" class="r595 r">secondsRemaining</span> = 0;
 
            <span class="i">Exception</span> <span id="r596 rd" class="r596 r">recognizedException</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r588 r">activity</span> = <span class="r587 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#ffb423bc21393df1" class="i field">ProgressRecordActivity</a>);
                <span class="r592 r">activityId</span> = <b>int</b>.<span class="i">Parse</span>(<span class="r587 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#9c3adad8754edaf1" class="i field">ProgressRecordActivityId</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
 
                <b>object</b> <span id="r597 rd" class="r597 r">tmp</span> = <span class="r587 r">deserializer</span>.<a href="#96224a243ecbccc7" class="i method">ReadOneObject</a>();
                <span class="r589 r">currentOperation</span> = <span class="r597 r">tmp</span>?.<span class="i">ToString</span>();
 
                <span class="r593 r">parentActivityId</span> = <b>int</b>.<span class="i">Parse</span>(<span class="r587 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#9e055a92bb08092f" class="i field">ProgressRecordParentActivityId</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                <span class="r594 r">percentComplete</span> = <b>int</b>.<span class="i">Parse</span>(<span class="r587 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#2dcf5aa1236d7763" class="i field">ProgressRecordPercentComplete</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                <span class="r590 r">prt</span> = <span class="r587 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fb3f534241115e3a" class="i field">ProgressRecordType</a>);
                <span class="r595 r">secondsRemaining</span> = <b>int</b>.<span class="i">Parse</span>(<span class="r587 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#ef209eacda0e27c3" class="i field">ProgressRecordSecondsRemaining</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                <span class="r591 r">statusDescription</span> = <span class="r587 r">deserializer</span>.<a href="#e36e59644bf19961" class="i method">ReadDecodedElementString</a>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#0205408fc06dbd73" class="i field">ProgressRecordStatusDescription</a>);
            }
            <b>catch</b> (<span class="i">FormatException</span> <span id="r598 rd" class="r598 r">e</span>)
            {
                <span class="r596 r">recognizedException</span> = <span class="r598 r">e</span>;
            }
            <b>catch</b> (<span class="i">OverflowException</span> <span id="r599 rd" class="r599 r">e</span>)
            {
                <span class="r596 r">recognizedException</span> = <span class="r599 r">e</span>;
            }
 
            <b>if</b> (<span class="r596 r">recognizedException</span> != <b>null</b>)
            {
                <b>throw</b> <span class="r587 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r596 r">recognizedException</span>, <b>typeof</b>(<span class="i">UInt64</span>).<span class="i">FullName</span>);
            }
 
            <span class="r587 r">deserializer</span>.<a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
 
            <span class="c">//</span>
            <span class="c">// Build the progress record</span>
            <span class="c">//</span>
 
            <a href="ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a> <span id="r600 rd" class="r600 r">type</span>;
            <b>try</b>
            {
                <span class="r600 r">type</span> = (<a href="ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>)<span class="i">Enum</span>.<span class="i">Parse</span>(<b>typeof</b>(<a href="ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>), <span class="r590 r">prt</span>, <b>true</b>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r601 rd" class="r601 r">e</span>)
            {
                <b>throw</b> <span class="r587 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r601 r">e</span>, <b>typeof</b>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>).<span class="i">FullName</span>);
            }
 
            <b>try</b>
            {
                <a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r602 rd" class="r602 r">record</span> = <b>new</b> <a href="ProgressRecord.cs.html#fc5a01f49984a3f9" class="t constructor">ProgressRecord</a>(<span class="r592 r">activityId</span>, <span class="r588 r">activity</span>, <span class="r591 r">statusDescription</span>);
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r589 r">currentOperation</span>))
                {
                    <span class="r602 r">record</span>.<a href="ProgressRecord.cs.html#f7d64fec26cd635a" class="i property">CurrentOperation</a> = <span class="r589 r">currentOperation</span>;
                }
 
                <span class="r602 r">record</span>.<a href="ProgressRecord.cs.html#730521203ee4eba0" class="i property">ParentActivityId</a> = <span class="r593 r">parentActivityId</span>;
                <span class="r602 r">record</span>.<a href="ProgressRecord.cs.html#7c559492a0012510" class="i property">PercentComplete</a> = <span class="r594 r">percentComplete</span>;
                <span class="r602 r">record</span>.<a href="ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a> = <span class="r600 r">type</span>;
                <span class="r602 r">record</span>.<a href="ProgressRecord.cs.html#b36a767584bc86ea" class="i property">SecondsRemaining</a> = <span class="r595 r">secondsRemaining</span>;
 
                <b>return</b> <span class="r602 r">record</span>;
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r603 rd" class="r603 r">e</span>)
            {
                <b>throw</b> <span class="r587 r">deserializer</span>.<span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">InvalidPrimitiveType</span>, <span class="r603 r">e</span>, <b>typeof</b>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>).<span class="i">FullName</span>);
            }
        }
 
        <b>internal static object</b> <a id="d69162db2837978a" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">DeserializeSecureString</a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r604 rd" class="r604 r">deserializer</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r604 r">deserializer</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <span class="c">//</span>
            <span class="c">// read deserialized elements of a Secure String</span>
            <span class="c">//</span>
            <b>return</b> <span class="r604 r">deserializer</span>.<a href="#f93e115a35b89d00" class="i method">ReadSecureString</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> known type deserialization
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> misc
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if LocalName of next element is &quot;tag&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r605 r">tag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="a11205c327aab4ed" href="../R/a11205c327aab4ed.html" target="n" data-glyph="76,1" class="i method">IsNextElement</a>(<b>string</b> <span id="r605 rd" class="r605 r">tag</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r605 r">tag</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>return</b> (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">LocalName</span> == <span class="r605 r">tag</span>) &amp;&amp;
                (((<a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#e467cab010ecbea0" class="i field">options</a> &amp; <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad1d17c95369a50" class="i field">NoNamespace</a>) != 0) ||
                 (<a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NamespaceURI</span> == <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#4fb0c7f3c8b05c6b" class="i field">MonadNamespace</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read start element in monad namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r606 r">element</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Element tag to read.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if not an empty element else false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="c80a7e45efc82f44" href="../R/c80a7e45efc82f44.html" target="n" data-glyph="74,1" class="i method">ReadStartElementAndHandleEmpty</a>(<b>string</b> <span id="r606 rd" class="r606 r">element</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r606 r">element</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <span class="c">// IsEmpty is set to true when element is of the form &lt;tag/&gt;</span>
            <b>bool</b> <span id="r607 rd" class="r607 r">isEmpty</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">IsEmptyElement</span>;
 
            <a href="#758c46d6a86d6840" class="k">this</a>.<a href="#7082a06da2dc9e29" class="i method">ReadStartElement</a>(<span class="r606 r">element</span>);
 
            <span class="c">// This takes care of the case: &lt;tag&gt;&lt;/tag&gt; or &lt;tag&gt;  &lt;/tag&gt;. In</span>
            <span class="c">// this case isEmpty is false.</span>
            <b>if</b> (!<span class="r607 r">isEmpty</span> &amp;&amp; <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">NodeType</span> == <span class="i">XmlNodeType</span>.<span class="i">EndElement</span>)
            {
                <a href="#456d33c812cca0c8" class="i method">ReadEndElement</a>();
                <span class="r607 r">isEmpty</span> = <b>true</b>;
            }
 
            <b>return</b> !<span class="r607 r">isEmpty</span>;
        }
 
        <b>private void</b> <a id="7082a06da2dc9e29" href="../R/7082a06da2dc9e29.html" target="n" data-glyph="76,1" class="i method">ReadStartElement</a>(<b>string</b> <span id="r608 rd" class="r608 r">element</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r608 r">element</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <b>if</b> ((<a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#e467cab010ecbea0" class="i field">options</a> &amp; <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad1d17c95369a50" class="i field">NoNamespace</a>) == <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad1d17c95369a50" class="i field">NoNamespace</a>)
            {
                <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadStartElement</span>(<span class="r608 r">element</span>);
            }
            <b>else</b>
            {
                <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadStartElement</span>(<span class="r608 r">element</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#4fb0c7f3c8b05c6b" class="i field">MonadNamespace</a>);
            }
 
            <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">MoveToContent</span>();
        }
 
        <b>private void</b> <a id="456d33c812cca0c8" href="../R/456d33c812cca0c8.html" target="n" data-glyph="76,1" class="i method">ReadEndElement</a>()
        {
            <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadEndElement</span>();
            <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">MoveToContent</span>();
        }
 
        <b>private string</b> <a id="e36e59644bf19961" href="../R/e36e59644bf19961.html" target="n" data-glyph="76,1" class="i method">ReadDecodedElementString</a>(<b>string</b> <span id="r609 rd" class="r609 r">element</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r609 r">element</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="#758c46d6a86d6840" class="k">this</a>.<a href="#5698cda6655845d7" class="i method">CheckIfStopping</a>();
 
            <b>string</b> <span id="r610 rd" class="r610 r">temp</span> = <b>null</b>;
            <b>if</b> ((<a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#e467cab010ecbea0" class="i field">options</a> &amp; <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad1d17c95369a50" class="i field">NoNamespace</a>) == <a href="#86f09565e15eea0d" class="t t">DeserializationOptions</a>.<a href="#aad1d17c95369a50" class="i field">NoNamespace</a>)
            {
                <span class="r610 r">temp</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>(<span class="r609 r">element</span>, <b>string</b>.<span class="i">Empty</span>);
            }
            <b>else</b>
            {
                <span class="r610 r">temp</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>(<span class="r609 r">element</span>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#4fb0c7f3c8b05c6b" class="i field">MonadNamespace</a>);
            }
 
            <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">MoveToContent</span>();
            <span class="r610 r">temp</span> = <a href="#b2b0336c2754d681" class="i method">DecodeString</a>(<span class="r610 r">temp</span>);
            <b>return</b> <span class="r610 r">temp</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Skips an element and all its child elements.</span>
        <span class="c">///</span><span class="c"> Moves cursor to next content Node.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="6486c187ad9b2032" href="../R/6486c187ad9b2032.html" target="n" data-glyph="76,1" class="i method">Skip</a>()
        {
            <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">Skip</span>();
            <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">MoveToContent</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads Primary known type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r611 r">pktInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private object</b> <a id="66f32c4593b8e3cb" href="../R/66f32c4593b8e3cb.html" target="n" data-glyph="76,1" class="i method">ReadPrimaryKnownType</a>(<a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r611 rd" class="r611 r">pktInfo</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r611 r">pktInfo</span> != <b>null</b>, <span class="s">&quot;Deserializer should be available&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r611 r">pktInfo</span>.<a href="#5975aee6a545a224" class="i property">Deserializer</a> != <b>null</b>, <span class="s">&quot;Deserializer should be available&quot;</span>);
            <b>object</b> <span id="r612 rd" class="r612 r">result</span> = <span class="r611 r">pktInfo</span>.<a href="#5975aee6a545a224" class="i property">Deserializer</a>(<a href="#758c46d6a86d6840" class="k">this</a>);
            <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">MoveToContent</span>();
            <b>return</b> <span class="r612 r">result</span>;
        }
 
        <b>private object</b> <a id="f93e115a35b89d00" href="../R/f93e115a35b89d00.html" target="n" data-glyph="76,1" class="i method">ReadSecureString</a>()
        {
            <b>string</b> <span id="r613 rd" class="r613 r">encryptedString</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">ReadElementContentAsString</span>();
 
            <b>try</b>
            {
                <b>object</b> <span id="r614 rd" class="r614 r">result</span>;
                <b>if</b> (<a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#2b047c538ceb6fdb" class="i field">cryptoHelper</a> != <b>null</b>)
                {
                    <span class="r614 r">result</span> = <a href="#3afea128f5cba056" class="i field">_context</a>.<a href="#2b047c538ceb6fdb" class="i field">cryptoHelper</a>.<a href="../utils/CryptoUtils.cs.html#605ed7fabf0891f9" class="i method">DecryptSecureString</a>(<span class="r613 r">encryptedString</span>);
                }
                <b>else</b>
                {
                    <span class="r614 r">result</span> = <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../security/SecureStringHelper.cs.html#01b0e2a85ff89895" class="t t">SecureStringHelper</a>.<a href="../security/SecureStringHelper.cs.html#2c5050277f1991c2" class="i method">Unprotect</a>(<span class="r613 r">encryptedString</span>);
                }
 
                <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">MoveToContent</span>();
                <b>return</b> <span class="r614 r">result</span>;
            }
            <b>catch</b> (<a href="../utils/CryptoUtils.cs.html#8b75afddc65044dd" class="t t">PSCryptoException</a>)
            {
                <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">DeserializeSecureStringFailed</span>, <b>null</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper function for building XmlException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r615 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> resource String</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r616 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r617 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> params for format string obtained from resourceId</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">XmlException</span> <a id="caf06e35674c6eaa" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewXmlException</a>
        (
            <b>string</b> <span id="r615 rd" class="r615 r">resourceString</span>,
            <span class="i">Exception</span> <span id="r616 rd" class="r616 r">innerException</span>,
            <b>params object</b>[] <span id="r617 rd" class="r617 r">args</span>
        )
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r615 r">resourceString</span>), <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <b>string</b> <span id="r618 rd" class="r618 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../utils/StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r615 r">resourceString</span>, <span class="r617 r">args</span>);
 
            <span class="i">XmlException</span> <span id="r619 rd" class="r619 r">ex</span> = <b>null</b>;
            <span class="i">IXmlLineInfo</span> <span id="r620 rd" class="r620 r">xmlLineInfo</span> = <a href="#f36a88e876de0508" class="i field">_reader</a> <b>as</b> <span class="i">IXmlLineInfo</span>;
            <b>if</b> (<span class="r620 r">xmlLineInfo</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r620 r">xmlLineInfo</span>.<span class="i">HasLineInfo</span>())
                {
                    <span class="r619 r">ex</span> = <b>new</b> <span class="i">XmlException</span>
                        (
                            <span class="r618 r">message</span>,
                            <span class="r616 r">innerException</span>,
                            <span class="r620 r">xmlLineInfo</span>.<span class="i">LineNumber</span>,
                            <span class="r620 r">xmlLineInfo</span>.<span class="i">LinePosition</span>
                        );
                }
            }
 
            <b>return</b> <span class="r619 r">ex</span> ?? <b>new</b> <span class="i">XmlException</span>(<span class="r618 r">message</span>, <span class="r616 r">innerException</span>);
        }
 
        <b>private string</b> <a id="67f3491c8b0e1f9f" href="../R/67f3491c8b0e1f9f.html" target="n" data-glyph="76,1" class="i method">ReadNameAttribute</a>()
        {
            <b>string</b> <span id="r621 rd" class="r621 r">encodedName</span> = <a href="#f36a88e876de0508" class="i field">_reader</a>.<span class="i">GetAttribute</span>(<a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#57131290458a16b7" class="i field">NameAttribute</a>);
            <b>if</b> (<span class="r621 r">encodedName</span> == <b>null</b>)
            {
                <b>throw</b> <span class="i">NewXmlException</span>(<span class="i">Serialization</span>.<span class="i">AttributeExpected</span>, <b>null</b>, <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#57131290458a16b7" class="i field">NameAttribute</a>);
            }
 
            <b>return</b> <a href="#b2b0336c2754d681" class="i method">DecodeString</a>(<span class="r621 r">encodedName</span>);
        }
 
        <b>private static string</b> <a id="b2b0336c2754d681" href="../R/b2b0336c2754d681.html" target="n" data-glyph="76,1" class="i method">DecodeString</a>(<b>string</b> <span id="r622 rd" class="r622 r">s</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r622 r">s</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <b>return</b> <span class="i">XmlConvert</span>.<span class="i">DecodeName</span>(<span class="r622 r">s</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> misc
 
        [<span class="i">TraceSourceAttribute</span>(<span class="s">&quot;InternalDeserializer&quot;</span>, <span class="s">&quot;InternalDeserializer class&quot;</span>)]
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="8a06a1d5cce72a40" href="../R/8a06a1d5cce72a40.html" target="n" data-glyph="46,1" class="i field">s_trace</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;InternalDeserializer&quot;</span>, <span class="s">&quot;InternalDeserializer class&quot;</span>);
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class for generating reference id.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="054fa5b4bfe00fdc" href="../R/054fa5b4bfe00fdc.html" target="n" data-glyph="2,0" class="t t">ReferenceIdHandlerForSerializer</a>&lt;<span id="r623 rd t" class="r623 r t">T</span>&gt; <b>where</b> <span class="r623 r t">T</span> : <b>class</b>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get new reference id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">New reference id.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">UInt64</span> <a id="808ea244ac03f5ff" href="../R/808ea244ac03f5ff.html" target="n" data-glyph="76,1" class="i method">GetNewReferenceId</a>()
        {
            <span class="i">UInt64</span> <span id="r624 rd" class="r624 r">refId</span> = <a href="#7696b1347074d527" class="i field">_seed</a>++;
            <b>return</b> <span class="r624 r">refId</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Seed is incremented by one after each reference generation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">UInt64</span> <a id="7696b1347074d527" href="../R/7696b1347074d527.html" target="n" data-glyph="46,1" class="i field">_seed</a>;
 
        <span class="c">// note:</span>
        <span class="c">// any boxed UInt64 takes 16 bytes on the heap</span>
        <span class="c">// one-character string (i.e. &quot;7&quot;) takes 20 bytes on the heap</span>
        <b>private readonly</b> <span class="i">IDictionary</span>&lt;<span class="r623 r t">T</span>, <span class="i">UInt64</span>&gt; <a id="7b90277f75dcdffd" href="../R/7b90277f75dcdffd.html" target="n" data-glyph="46,1" class="i field">_object2refId</a>;
 
        <b>internal</b> <a id="a09641c563b3b250" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ReferenceIdHandlerForSerializer</a>(<span class="i">IDictionary</span>&lt;<span class="r623 r t">T</span>, <span class="i">UInt64</span>&gt; <span id="r625 rd" class="r625 r">dictionary</span>)
        {
            <a href="#7b90277f75dcdffd" class="i field">_object2refId</a> = <span class="r625 r">dictionary</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Assigns a RefId to the given object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r626 r">t</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to assign a RefId to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RefId assigned to the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="db499d5050d69562" href="../R/db499d5050d69562.html" target="n" data-glyph="74,1" class="i method">SetRefId</a>(<span class="r623 r t">T</span> <span id="r626 rd" class="r626 r">t</span>)
        {
            <b>if</b> (<a href="#7b90277f75dcdffd" class="i field">_object2refId</a> != <b>null</b>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<a href="#7b90277f75dcdffd" class="i field">_object2refId</a>.<span class="i">ContainsKey</span>(<span class="r626 r">t</span>), <span class="s">&quot;SetRefId shouldn&#39;t be called when the object is already assigned a ref id&quot;</span>);
                <span class="i">UInt64</span> <span id="r627 rd" class="r627 r">refId</span> = <a href="#808ea244ac03f5ff" class="i method">GetNewReferenceId</a>();
                <a href="#7b90277f75dcdffd" class="i field">_object2refId</a>.<span class="i">Add</span>(<span class="r626 r">t</span>, <span class="r627 r">refId</span>);
                <b>return</b> <span class="r627 r">refId</span>.<span class="i">ToString</span>(<span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>else</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a RefId already assigned for the given object or </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">null</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if there is no associated ref id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r628 r">t</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="b4bc07b44a2d34bc" href="../R/b4bc07b44a2d34bc.html" target="n" data-glyph="74,1" class="i method">GetRefId</a>(<span class="r623 r t">T</span> <span id="r628 rd" class="r628 r">t</span>)
        {
            <span class="i">UInt64</span> <span id="r629 rd" class="r629 r">refId</span>;
            <b>if</b> ((<a href="#7b90277f75dcdffd" class="i field">_object2refId</a> != <b>null</b>) &amp;&amp; (<a href="#7b90277f75dcdffd" class="i field">_object2refId</a>.<span class="i">TryGetValue</span>(<span class="r628 r">t</span>, <b>out</b> <span class="r629 r">refId</span>)))
            {
                <b>return</b> <span class="r629 r">refId</span>.<span class="i">ToString</span>(<span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>else</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
    }
 
    <b>internal class</b> <a id="cb3f1be484782f5b" href="../R/cb3f1be484782f5b.html" target="n" data-glyph="2,0" class="t t"><span id="8fe5f508e1ceb2a6">ReferenceIdHandlerForDeserializer</span></a>&lt;<span id="r630 rd t" class="r630 r t">T</span>&gt; <b>where</b> <span class="r630 r t">T</span> : <b>class</b>
    {
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="r630 r t">T</span>&gt; <a id="4b7e7919fdfe3dfa" href="../R/4b7e7919fdfe3dfa.html" target="n" data-glyph="46,1" class="i field">_refId2object</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="r630 r t">T</span>&gt;();
 
        <b>internal void</b> <a id="deb3becbbebcc32a" href="../R/deb3becbbebcc32a.html" target="n" data-glyph="74,1" class="i method">SetRefId</a>(<span class="r630 r t">T</span> <span id="r631 rd" class="r631 r">o</span>, <b>string</b> <span id="r632 rd" class="r632 r">refId</span>, <b>bool</b> <span id="r633 rd" class="r633 r">duplicateRefIdsAllowed</span>)
        {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
            <b>if</b> (!<span class="r633 r">duplicateRefIdsAllowed</span>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<a href="#4b7e7919fdfe3dfa" class="i field">_refId2object</a>.<span class="i">ContainsKey</span>(<span class="r632 r">refId</span>), <span class="s">&quot;You can&#39;t change refId association&quot;</span>);
            }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            <a href="#4b7e7919fdfe3dfa" class="i field">_refId2object</a>[<span class="r632 r">refId</span>] = <span class="r631 r">o</span>;
        }
 
        <b>internal</b> <span class="r630 r t">T</span> <a id="64b04165c058afc2" href="../R/64b04165c058afc2.html" target="n" data-glyph="74,1" class="i method">GetReferencedObject</a>(<b>string</b> <span id="r634 rd" class="r634 r">refId</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<a href="#4b7e7919fdfe3dfa" class="i field">_refId2object</a>.<span class="i">ContainsKey</span>(<span class="r634 r">refId</span>), <span class="s">&quot;Reference id wasn&#39;t seen earlier&quot;</span>);
            <span class="r630 r t">T</span> <span id="r635 rd" class="r635 r">t</span>;
            <b>if</b> (<a href="#4b7e7919fdfe3dfa" class="i field">_refId2object</a>.<span class="i">TryGetValue</span>(<span class="r634 r">refId</span>, <b>out</b> <span class="r635 r">t</span>))
            {
                <b>return</b> <span class="r635 r">t</span>;
            }
            <b>else</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A delegate for serializing known type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal delegate void</b> <a id="ee659a9004231025" href="../R/ee659a9004231025.html" target="n" data-glyph="14,0" class="t t"><span id="8f69a2414a4ead17">TypeSerializerDelegate</span></a>(<a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a> <span id="r636 rd" class="r636 r">serializer</span>, <b>string</b> <span id="r637 rd" class="r637 r">streamName</span>, <b>string</b> <span id="r638 rd" class="r638 r">property</span>, <b>object</b> <span id="r639 rd" class="r639 r">source</span>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r640 rd" class="r640 r">entry</span>);
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A delegate for deserializing known type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal delegate object</b> <a id="627d4215e41444dd" href="../R/627d4215e41444dd.html" target="n" data-glyph="14,0" class="t t"><span id="19ebc8d26d22bd04">TypeDeserializerDelegate</span></a>(<a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a> <span id="r641 rd" class="r641 r">deserializer</span>);
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class contains serialization information about a type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="8c15ca7ae5349db9" href="../R/8c15ca7ae5349db9.html" target="n" data-glyph="2,0" class="t t">TypeSerializationInfo</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r642 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type for which this entry is created.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r643 r">itemTag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ItemTag for the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r644 r">propertyTag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PropertyTag for the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r645 r">serializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">TypeSerializerDelegate for serializing the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r646 r">deserializer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">TypeDeserializerDelegate for deserializing the type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="fd10744abf2a0e9c" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">TypeSerializationInfo</a>(<span class="i">Type</span> <span id="r642 rd" class="r642 r">type</span>, <b>string</b> <span id="r643 rd" class="r643 r">itemTag</span>, <b>string</b> <span id="r644 rd" class="r644 r">propertyTag</span>, <a href="#ee659a9004231025" class="t t">TypeSerializerDelegate</a> <span id="r645 rd" class="r645 r">serializer</span>, <a href="#627d4215e41444dd" class="t t">TypeDeserializerDelegate</a> <span id="r646 rd" class="r646 r">deserializer</span>)
        {
            <a href="#735ee363a2279b83" class="i property">Type</a> = <span class="r642 r">type</span>;
            <a href="#676e8034cc70c3c9" class="i property">Serializer</a> = <span class="r645 r">serializer</span>;
            <a href="#5975aee6a545a224" class="i property">Deserializer</a> = <span class="r646 r">deserializer</span>;
            <a href="#1c4666f39a3dc592" class="i property">ItemTag</a> = <span class="r643 r">itemTag</span>;
            <a href="#6d5d3a3c4e4601a4" class="i property">PropertyTag</a> = <span class="r644 r">propertyTag</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the type for which this TypeSerializationInfo is created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Type</span> <a id="735ee363a2279b83" href="../R/735ee363a2279b83.html" target="n" data-glyph="104,1" class="i property">Type</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the item tag for this type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="1c4666f39a3dc592" href="../R/1c4666f39a3dc592.html" target="n" data-glyph="104,1" class="i property">ItemTag</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the Property tag for this type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="6d5d3a3c4e4601a4" href="../R/6d5d3a3c4e4601a4.html" target="n" data-glyph="104,1" class="i property">PropertyTag</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the delegate to serialize this type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#ee659a9004231025" class="t t">TypeSerializerDelegate</a> <a id="676e8034cc70c3c9" href="../R/676e8034cc70c3c9.html" target="n" data-glyph="104,1" class="i property">Serializer</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the delegate to deserialize this type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#627d4215e41444dd" class="t t">TypeDeserializerDelegate</a> <a id="5975aee6a545a224" href="../R/5975aee6a545a224.html" target="n" data-glyph="104,1" class="i property">Deserializer</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A class for identifying types which are treated as KnownType by Monad.</span>
    <span class="c">///</span><span class="c"> A KnownType is guranteed to be available on machine on which monad is</span>
    <span class="c">///</span><span class="c"> running.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="295889332d482ff3" href="../R/295889332d482ff3.html" target="n" data-glyph="2,0" class="t t">KnownTypes</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Static constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>static</b> <a id="8eecacef81a19d98" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">KnownTypes</a>()
        {
            <b>for</b> (<b>int</b> <span id="r647 rd" class="r647 r">i</span> = 0; <span class="r647 r">i</span> &lt; <a href="#cfe99ad20e4d60fc" class="i field">s_typeSerializationInfo</a>.<span class="i">Length</span>; <span class="r647 r">i</span>++)
            {
                <a href="#c7c86398cd8a2c4e" class="i field">s_knownTableKeyType</a>.<span class="i">Add</span>(<a href="#cfe99ad20e4d60fc" class="i field">s_typeSerializationInfo</a>[<span class="r647 r">i</span>].<a href="#735ee363a2279b83" class="i property">Type</a>.<span class="i">FullName</span>, <a href="#cfe99ad20e4d60fc" class="i field">s_typeSerializationInfo</a>[<span class="r647 r">i</span>]);
                <a href="#5ac47f7d7f4bdb41" class="i field">s_knownTableKeyItemTag</a>.<span class="i">Add</span>(<a href="#cfe99ad20e4d60fc" class="i field">s_typeSerializationInfo</a>[<span class="r647 r">i</span>].<a href="#1c4666f39a3dc592" class="i property">ItemTag</a>, <a href="#cfe99ad20e4d60fc" class="i field">s_typeSerializationInfo</a>[<span class="r647 r">i</span>]);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type serialization information about a type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r648 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type for which information is retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">TypeSerializationInfo for the type, null if it doesn&#39;t exist.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <a id="8e99646679237ea1" href="../R/8e99646679237ea1.html" target="n" data-glyph="74,1" class="i method">GetTypeSerializationInfo</a>(<span class="i">Type</span> <span id="r648 rd" class="r648 r">type</span>)
        {
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r649 rd" class="r649 r">temp</span>;
            <b>if</b> (!<a href="#c7c86398cd8a2c4e" class="i field">s_knownTableKeyType</a>.<span class="i">TryGetValue</span>(<span class="r648 r">type</span>.<span class="i">FullName</span>, <b>out</b> <span class="r649 r">temp</span>) &amp;&amp; <b>typeof</b>(<span class="i">XmlDocument</span>).<span class="i">IsAssignableFrom</span>(<span class="r648 r">type</span>))
            {
                <span class="r649 r">temp</span> = <a href="#d48200f808f23232" class="i field">s_xdInfo</a>;
            }
 
            <b>return</b> <span class="r649 r">temp</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get TypeSerializationInfo using ItemTag as key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r650 r">itemTag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ItemTag for which TypeSerializationInfo is to be fetched.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">TypeSerializationInfo entry, null if no entry exist for the tag.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <a id="114010b9e0eb29ea" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetTypeSerializationInfoFromItemTag</a>(<b>string</b> <span id="r650 rd" class="r650 r">itemTag</span>)
        {
            <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <span id="r651 rd" class="r651 r">temp</span>;
            <a href="#5ac47f7d7f4bdb41" class="i field">s_knownTableKeyItemTag</a>.<span class="i">TryGetValue</span>(<span class="r650 r">itemTag</span>, <b>out</b> <span class="r651 r">temp</span>);
            <b>return</b> <span class="r651 r">temp</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private_fields
 
        <span class="c">// TypeSerializationInfo for XmlDocument</span>
        <b>private static readonly</b> <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a> <a id="d48200f808f23232" href="../R/d48200f808f23232.html" target="n" data-glyph="46,1" class="i field">s_xdInfo</a> =
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">XmlDocument</span>),
                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#1309da43deed9dd0" class="i field">XmlDocumentTag</a>,
                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#1309da43deed9dd0" class="i field">XmlDocumentTag</a>,
                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteXmlDocument</span>,
                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeXmlDocument</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Array of known types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a>[] <a id="cfe99ad20e4d60fc" href="../R/cfe99ad20e4d60fc.html" target="n" data-glyph="46,1" class="i field">s_typeSerializationInfo</a> = <b>new</b> <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a>[]
        {
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>bool</b>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#18e841ab5a08b08b" class="i field">BooleanTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#18e841ab5a08b08b" class="i field">BooleanTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteBoolean</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeBoolean</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>byte</b>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#f30f8da98f0edee3" class="i field">UnsignedByteTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#f30f8da98f0edee3" class="i field">UnsignedByteTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeByte</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>char</b>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e10f0f8a95e072b6" class="i field">CharTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e10f0f8a95e072b6" class="i field">CharTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteChar</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeChar</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">DateTime</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#5ef87a02f121fd88" class="i field">DateTimeTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#5ef87a02f121fd88" class="i field">DateTimeTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteDateTime</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeDateTime</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>decimal</b>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#833ce2890e4a8fb2" class="i field">DecimalTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#833ce2890e4a8fb2" class="i field">DecimalTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeDecimal</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>double</b>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#2895c71775016788" class="i field">DoubleTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#2895c71775016788" class="i field">DoubleTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteDouble</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeDouble</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">Guid</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#12c17f065e786dd4" class="i field">GuidTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#12c17f065e786dd4" class="i field">GuidTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeGuid</span>),
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">Int16</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#84d52c79f3129789" class="i field">ShortTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#84d52c79f3129789" class="i field">ShortTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeInt16</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">Int32</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d35be4ed9538eb18" class="i field">IntTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#d35be4ed9538eb18" class="i field">IntTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeInt32</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">Int64</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#16433eeaefb69210" class="i field">LongTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#16433eeaefb69210" class="i field">LongTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeInt64</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>sbyte</b>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fc9ebf36e277aae7" class="i field">ByteTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#fc9ebf36e277aae7" class="i field">ByteTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeSByte</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">Single</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#769c90d3b25137f6" class="i field">FloatTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#769c90d3b25137f6" class="i field">FloatTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteSingle</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeSingle</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#469f40d4227c1ab0" class="i field">ScriptBlockTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#469f40d4227c1ab0" class="i field">ScriptBlockTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteScriptBlock</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeScriptBlock</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>string</b>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e47a184f9481ee18" class="i field">StringTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e47a184f9481ee18" class="i field">StringTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteEncodedString</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeString</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">TimeSpan</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#571ac89500dcfd74" class="i field">DurationTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#571ac89500dcfd74" class="i field">DurationTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteTimeSpan</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeTimeSpan</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">UInt16</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e0ced2df75b1c511" class="i field">UnsignedShortTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e0ced2df75b1c511" class="i field">UnsignedShortTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeUInt16</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">UInt32</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8e8d258a8a1e1fe4" class="i field">UnsignedIntTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#8e8d258a8a1e1fe4" class="i field">UnsignedIntTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeUInt32</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">UInt64</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#61f0e0c47fc05d80" class="i field">UnsignedLongTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#61f0e0c47fc05d80" class="i field">UnsignedLongTag</a>,
                                <b>null</b>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeUInt64</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">Uri</span>),
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#ea9063e8b96e8aae" class="i field">AnyUriTag</a>,
                                <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#ea9063e8b96e8aae" class="i field">AnyUriTag</a>,
                                <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteUri</span>,
                                <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeUri</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<b>byte</b>[]),
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#86d39a5608b379af" class="i field">Base64BinaryTag</a>,
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#86d39a5608b379af" class="i field">Base64BinaryTag</a>,
                                      <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteByteArray</span>,
                                      <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeByteArray</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Version</span>),
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e45326a7dba388f1" class="i field">VersionTag</a>,
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#e45326a7dba388f1" class="i field">VersionTag</a>,
                                      <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteVersion</span>,
                                      <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeVersion</span>),
 
            <a href="#d48200f808f23232" class="i field">s_xdInfo</a>,
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>),
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#581f0cd421874e95" class="i field">ProgressRecord</a>,
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#581f0cd421874e95" class="i field">ProgressRecord</a>,
                                      <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteProgressRecord</span>,
                                      <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeProgressRecord</span>),
 
            <b>new</b> <span class="t">TypeSerializationInfo</span>(<b>typeof</b>(<span class="i">SecureString</span>),
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#330e84e9101f7552" class="i field">SecureStringTag</a>,
                                      <a href="SerializationStrings.cs.html#6ba43e4d07841fee" class="t t">SerializationStrings</a>.<a href="SerializationStrings.cs.html#330e84e9101f7552" class="i field">SecureStringTag</a>,
                                      <a href="#fafbc094ffa8966a" class="t t">InternalSerializer</a>.<span class="i">WriteSecureString</span>,
                                      <a href="#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<span class="i">DeserializeSecureString</span>),
        };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable of knowntypes.</span>
        <span class="c">///</span><span class="c"> Key is Type.FullName and value is Type object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a>&gt; <a id="c7c86398cd8a2c4e" href="../R/c7c86398cd8a2c4e.html" target="n" data-glyph="46,1" class="i field">s_knownTableKeyType</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable of knowntypes. Key is ItemTag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a>&gt; <a id="5ac47f7d7f4bdb41" href="../R/5ac47f7d7f4bdb41.html" target="n" data-glyph="46,1" class="i field">s_knownTableKeyItemTag</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8c15ca7ae5349db9" class="t t">TypeSerializationInfo</a>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private_fields
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class contains helper routined for serialization/deserialization.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="ea376e267181f78f" href="../R/ea376e267181f78f.html" target="n" data-glyph="2,0" class="t t">SerializationUtilities</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extracts the value of a note property from a PSObject; returns null if the property does not exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="4f47f654c3fae7b3" href="../R/4f47f654c3fae7b3.html" target="n" data-glyph="74,1" class="i method">GetPropertyValue</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r652 rd" class="r652 r">psObject</span>, <b>string</b> <span id="r653 rd" class="r653 r">propertyName</span>)
        {
            <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r654 rd" class="r654 r">property</span> = (<a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a>)<span class="r652 r">psObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r653 r">propertyName</span>];
 
            <b>if</b> (<span class="r654 r">property</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <span class="r654 r">property</span>.<a href="MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the BaseObject of a note property encoded as a PSObject; returns null if the property does not exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="8e7e8d551c24aa2e" href="../R/8e7e8d551c24aa2e.html" target="n" data-glyph="74,1" class="i method">GetPsObjectPropertyBaseObject</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r655 rd" class="r655 r">psObject</span>, <b>string</b> <span id="r656 rd" class="r656 r">propertyName</span>)
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r657 rd" class="r657 r">propertyPsObject</span> = (<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<a href="#4f47f654c3fae7b3" class="i method">GetPropertyValue</a>(<span class="r655 r">psObject</span>, <span class="r656 r">propertyName</span>);
 
            <b>if</b> (<span class="r657 r">propertyPsObject</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <span class="r657 r">propertyPsObject</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if source is known container type and returns appropriate</span>
        <span class="c">///</span><span class="c"> information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r658 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r659 r">ct</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r660 r">dictionary</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r661 r">enumerable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="cbda6536a2fc4953" href="../R/cbda6536a2fc4953.html" target="n" data-glyph="74,1" class="i method">GetKnownContainerTypeInfo</a>(
            <b>object</b> <span id="r658 rd" class="r658 r">source</span>,
            <b>out</b> <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a> <span id="r659 rd" class="r659 r">ct</span>,
            <b>out</b> <span class="i">IDictionary</span> <span id="r660 rd" class="r660 r">dictionary</span>,
            <b>out</b> <span class="i">IEnumerable</span> <span id="r661 rd" class="r661 r">enumerable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r658 r">source</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>;
            <span class="r660 r">dictionary</span> = <b>null</b>;
            <span class="r661 r">enumerable</span> = <b>null</b>;
 
            <span class="r660 r">dictionary</span> = <span class="r658 r">source</span> <b>as</b> <span class="i">IDictionary</span>;
            <b>if</b> (<span class="r660 r">dictionary</span> != <b>null</b>)
            {
                <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a994255a39d73423" class="i field">Dictionary</a>;
            }
            <b>else</b> <b>if</b> (<span class="r658 r">source</span> <b>is</b> <span class="i">Stack</span>)
            {
                <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#7d548ce8f85a24e5" class="i field">Stack</a>;
                <span class="r661 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r658 r">source</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r661 r">enumerable</span> != <b>null</b>, <span class="s">&quot;Stack is enumerable&quot;</span>);
            }
            <b>else</b> <b>if</b> (<span class="r658 r">source</span> <b>is</b> <span class="i">Queue</span>)
            {
                <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#43a90845e1f3d405" class="i field">Queue</a>;
                <span class="r661 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r658 r">source</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r661 r">enumerable</span> != <b>null</b>, <span class="s">&quot;Queue is enumerable&quot;</span>);
            }
            <b>else</b> <b>if</b> (<span class="r658 r">source</span> <b>is</b> <span class="i">IList</span>)
            {
                <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#8976c008611097e9" class="i field">List</a>;
                <span class="r661 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r658 r">source</span>);
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r661 r">enumerable</span> != <b>null</b>, <span class="s">&quot;IList is enumerable&quot;</span>);
            }
            <b>else</b>
            {
                <span class="i">Type</span> <span id="r662 rd" class="r662 r">gt</span> = <span class="r658 r">source</span>.<span class="i">GetType</span>();
                <b>if</b> (<span class="r662 r">gt</span>.<span class="i">IsGenericType</span>)
                {
                    <b>if</b> (<span class="i">DerivesFromGenericType</span>(<span class="r662 r">gt</span>, <b>typeof</b>(<span class="i">Stack</span>&lt;&gt;)))
                    {
                        <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#7d548ce8f85a24e5" class="i field">Stack</a>;
                        <span class="r661 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r658 r">source</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r661 r">enumerable</span> != <b>null</b>, <span class="s">&quot;Stack is enumerable&quot;</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="i">DerivesFromGenericType</span>(<span class="r662 r">gt</span>, <b>typeof</b>(<span class="i">Queue</span>&lt;&gt;)))
                    {
                        <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#43a90845e1f3d405" class="i field">Queue</a>;
                        <span class="r661 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r658 r">source</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r661 r">enumerable</span> != <b>null</b>, <span class="s">&quot;Queue is enumerable&quot;</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="i">DerivesFromGenericType</span>(<span class="r662 r">gt</span>, <b>typeof</b>(<span class="i">List</span>&lt;&gt;)))
                    {
                        <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#8976c008611097e9" class="i field">List</a>;
                        <span class="r661 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r658 r">source</span>);
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r661 r">enumerable</span> != <b>null</b>, <span class="s">&quot;Queue is enumerable&quot;</span>);
                    }
                }
            }
 
            <span class="c">// Check if LanguagePrimitive.GetEnumerable can do some magic to get IEnumerable instance</span>
            <b>if</b> (<span class="r659 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <span class="r661 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r658 r">source</span>);
                    <b>if</b> (<span class="r661 r">enumerable</span> != <b>null</b>)
                    {
                        <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#4b85ec47c1309261" class="i field">Enumerable</a>;
                    }
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r663 rd" class="r663 r">exception</span>)
                {
                    <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                    <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(<a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#0b79bfbf099710d3" class="i field">Serializer_EnumerationFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>,
                        <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>, <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a>, <span class="r658 r">source</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>,
                        <span class="r663 r">exception</span>.<span class="i">ToString</span>());
                }
            }
 
            <span class="c">// Check if type is IEnumerable</span>
            <span class="c">// (LanguagePrimitives.GetEnumerable above should be enough - the check below is to preserve</span>
            <span class="c">// backcompatibility in some corner-cases (see bugs in Windows7 - #372562 and #372563))</span>
            <b>if</b> (<span class="r659 r">ct</span> == <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#a3b1554a3f5207aa" class="i field">None</a>)
            {
                <span class="r661 r">enumerable</span> = <span class="r658 r">source</span> <b>as</b> <span class="i">IEnumerable</span>;
                <b>if</b> (<span class="r661 r">enumerable</span> != <b>null</b>)
                {
                    <span class="c">// WinBlue: 206515 - There are no elements in the source. The source is of type XmlLinkedNode (which derives from XmlNode which implements IEnumerable).</span>
                    <span class="c">// So, adding an additional check to see if this contains any elements</span>
                    <span class="i">IEnumerator</span> <span id="r664 rd" class="r664 r">enumerator</span> = <span class="r661 r">enumerable</span>.<span class="i">GetEnumerator</span>();
                    <b>if</b> (<span class="r664 r">enumerator</span> != <b>null</b> &amp;&amp; <span class="r664 r">enumerator</span>.<span class="i">MoveNext</span>())
                    {
                        <span class="r659 r">ct</span> = <a href="#987ec5fe7ca4f1a1" class="t t">ContainerType</a>.<a href="#4b85ec47c1309261" class="i field">Enumerable</a>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if derived is of type baseType or a type derived from baseType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r665 r">derived</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r666 r">baseType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="f76ecd15f5475f91" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">DerivesFromGenericType</a>(<span class="i">Type</span> <span id="r665 rd" class="r665 r">derived</span>, <span class="i">Type</span> <span id="r666 rd" class="r666 r">baseType</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r665 r">derived</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r666 r">baseType</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <b>while</b> (<span class="r665 r">derived</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r665 r">derived</span>.<span class="i">IsGenericType</span>)
                    <span class="r665 r">derived</span> = <span class="r665 r">derived</span>.<span class="i">GetGenericTypeDefinition</span>();
 
                <b>if</b> (<span class="r665 r">derived</span> == <span class="r666 r">baseType</span>)
                {
                    <b>return</b> <b>true</b>;
                }
 
                <span class="r665 r">derived</span> = <span class="r665 r">derived</span>.<span class="i">BaseType</span>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the &quot;ToString&quot; from PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r667 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSObject to be converted to string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> &quot;ToString&quot; value</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="3ef9cc7701d3419a" href="../R/3ef9cc7701d3419a.html" target="n" data-glyph="74,1" class="i method">GetToString</a>(<b>object</b> <span id="r667 rd" class="r667 r">source</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r667 r">source</span> != <b>null</b>, <span class="s">&quot;caller should have validated the information&quot;</span>);
 
            <span class="c">// fall back value</span>
            <b>string</b> <span id="r668 rd" class="r668 r">result</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r668 r">result</span> = <span class="i">Convert</span>.<span class="i">ToString</span>(<span class="r667 r">source</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r669 rd" class="r669 r">e</span>)
            {
                <span class="c">// Catch-all OK. This is a third-party call-out.</span>
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#b2174edc8e63b69c" class="i field">Serializer_ToStringFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r667 r">source</span>.<span class="i">GetType</span>().<span class="i">AssemblyQualifiedName</span>,
                    <span class="r669 r">e</span>.<span class="i">ToString</span>());
            }
 
            <b>return</b> <span class="r668 r">result</span>;
        }
 
        <b>internal static string</b> <a id="e42817d8853c2a00" href="../R/e42817d8853c2a00.html" target="n" data-glyph="74,1" class="i method">GetToStringForPrimitiveObject</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r670 rd" class="r670 r">pso</span>)
        {
            <span class="c">// if object is not wrapped in a PSObject, then nothing modifies the ToString value of the primitive object</span>
            <b>if</b> (<span class="r670 r">pso</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// preserve ToString throughout deserialization/*re*serialization</span>
            <b>if</b> (<span class="r670 r">pso</span>.<a href="MshObject.cs.html#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a> != <b>null</b>)
            {
                <b>return</b> <span class="r670 r">pso</span>.<a href="MshObject.cs.html#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a>;
            }
 
            <span class="c">// preserve token text (i.e. double: 0E1517567410;  see Windows 7 bug #694057 for more details)</span>
            <b>string</b> <span id="r671 rd" class="r671 r">token</span> = <span class="r670 r">pso</span>.<a href="MshObject.cs.html#d80386ffa3949a2a" class="i property">TokenText</a>;
            <b>if</b> (<span class="r671 r">token</span> != <b>null</b>)
            {
                <b>string</b> <span id="r672 rd" class="r672 r">originalToString</span> = <a href="#3ef9cc7701d3419a" class="i method">GetToString</a>(<span class="r670 r">pso</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>);
                <b>if</b> (<span class="r672 r">originalToString</span> == <b>null</b> || !<b>string</b>.<span class="i">Equals</span>(<span class="r671 r">token</span>, <span class="r672 r">originalToString</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <b>return</b> <span class="r671 r">token</span>;
                }
            }
 
            <span class="c">// no need to write &lt;ToString&gt; element otherwise - the ToString method of a deserialized, live primitive object will return the right value</span>
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <a id="441561ef872e6f58" href="../R/441561ef872e6f58.html" target="n" data-glyph="74,1" class="i method">GetSpecificPropertiesToSerialize</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r673 rd" class="r673 r">source</span>, <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt; <span id="r674 rd" class="r674 r">allPropertiesCollection</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r675 rd" class="r675 r">typeTable</span>)
        {
            <b>if</b> (<span class="r673 r">source</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r673 r">source</span>.<a href="MshObject.cs.html#08cdba316b979499" class="i method">GetSerializationMethod</a>(<span class="r675 r">typeTable</span>) == <a href="MshObject.cs.html#9a814b5a84518967" class="t t">SerializationMethod</a>.<a href="MshObject.cs.html#2de6f005a393985d" class="i field">SpecificProperties</a>)
            {
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticVerbose</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#ed872fb55c3ad2b3" class="i field">Serializer_ModeOverride</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#70f65f055080d924" class="i field">SerializationSettings</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r673 r">source</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>,
                    (<span class="i">UInt32</span>)(<a href="MshObject.cs.html#9a814b5a84518967" class="t t">SerializationMethod</a>.<a href="MshObject.cs.html#2de6f005a393985d" class="i field">SpecificProperties</a>));
 
                <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r676 rd" class="r676 r">specificProperties</span> =
                    <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;();
                <a href="MshMemberInfo.cs.html#520db5b1e8966ea1" class="t t">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r677 rd" class="r677 r">allProperties</span> =
                    <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(
                        <span class="r673 r">source</span>,
                        <span class="r674 r">allPropertiesCollection</span>);
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r678 rd" class="r678 r">namesOfPropertiesToSerialize</span> = <span class="r673 r">source</span>.<a href="MshObject.cs.html#7d5f4324f4aa4852" class="i method">GetSpecificPropertiesToSerialize</a>(<span class="r675 r">typeTable</span>);
                <b>foreach</b> (<b>string</b> <span id="r679 rd" class="r679 r">propertyName</span> <b>in</b> <span class="r678 r">namesOfPropertiesToSerialize</span>)
                {
                    <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r680 rd" class="r680 r">property</span> = <span class="r677 r">allProperties</span><a href="MshMemberInfo.cs.html#e718c689173675b4">[</a><span class="r679 r">propertyName</span>];
                    <b>if</b> (<span class="r680 r">property</span> == <b>null</b>)
                    {
                        <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<a href="../utils/tracing/PSEtwLog.cs.html#83494a7be33452f5" class="i method">LogAnalyticWarning</a>(
                            <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#251d2c76f5794010" class="i field">Serializer_SpecificPropertyMissing</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                            <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                            <span class="r673 r">source</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>.<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>,
                            <span class="r679 r">propertyName</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r676 r">specificProperties</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r680 r">property</span>);
                    }
                }
 
                <b>return</b> <span class="r676 r">specificProperties</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static object</b> <a id="a347fb25facfcfe4" href="../R/a347fb25facfcfe4.html" target="n" data-glyph="74,1" class="i method">GetPropertyValueInThreadSafeManner</a>(<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r681 rd" class="r681 r">property</span>, <b>bool</b> <span id="r682 rd" class="r682 r">canUseDefaultRunspaceInThreadSafeManner</span>, <b>out bool</b> <span id="r683 rd" class="r683 r">success</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r681 r">property</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <b>if</b> (!<span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#9df67dd88e11e967" class="i property">IsGettable</a>)
            {
                <span class="r683 r">success</span> = <b>false</b>;
                <b>return</b> <b>null</b>;
            }
 
            <a href="MshMemberInfo.cs.html#3a8a82efa05da144" class="t t">PSAliasProperty</a> <span id="r684 rd" class="r684 r">alias</span> = <span class="r681 r">property</span> <b>as</b> <a href="MshMemberInfo.cs.html#3a8a82efa05da144" class="t t">PSAliasProperty</a>;
            <b>if</b> (<span class="r684 r">alias</span> != <b>null</b>)
            {
                <span class="r681 r">property</span> = <span class="r684 r">alias</span>.<a href="MshMemberInfo.cs.html#8e0dab897a0ddea0" class="i property">ReferencedMember</a> <b>as</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
            }
 
            <a href="MshMemberInfo.cs.html#b68884f0eb8d8ebb" class="t t">PSScriptProperty</a> <span id="r685 rd" class="r685 r">script</span> = <span class="r681 r">property</span> <b>as</b> <a href="MshMemberInfo.cs.html#b68884f0eb8d8ebb" class="t t">PSScriptProperty</a>;
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r685 r">script</span> == <b>null</b> || <span class="r685 r">script</span>.<a href="MshMemberInfo.cs.html#23691bb222d3c82a" class="i property">GetterScript</a> != <b>null</b>, <span class="s">&quot;scriptProperty.IsGettable =&gt; (scriptProperty.GetterScript != null)&quot;</span>);
            <b>if</b> ((<span class="r685 r">script</span> != <b>null</b>) &amp;&amp; (!<span class="r682 r">canUseDefaultRunspaceInThreadSafeManner</span>))
            {
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#c8281d412fb109bb" class="i field">Serializer_ScriptPropertyWithoutRunspace</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#014ea40b35222be9" class="i field">instance</a> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#0dfe59c032d463c4" class="i method">GetTypeNames</a>(<span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#014ea40b35222be9" class="i field">instance</a>).<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>,
                    <span class="r685 r">script</span>.<a href="MshMemberInfo.cs.html#23691bb222d3c82a" class="i property">GetterScript</a>.<a href="runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>());
 
                <span class="r683 r">success</span> = <b>false</b>;
                <b>return</b> <b>null</b>;
            }
 
            <b>try</b>
            {
                <b>object</b> <span id="r686 rd" class="r686 r">value</span> = <span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
                <span class="r683 r">success</span> = <b>true</b>;
                <b>return</b> <span class="r686 r">value</span>;
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r687 rd" class="r687 r">e</span>)
            {
                <a href="../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                    <a href="remoting/common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="remoting/common/PSETWTracer.cs.html#798159ef1722cae3" class="i field">Serializer_PropertyGetterFailed</a>, <a href="remoting/common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="remoting/common/PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="remoting/common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="remoting/common/PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="remoting/common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="remoting/common/PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                    <span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#014ea40b35222be9" class="i field">instance</a> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#0dfe59c032d463c4" class="i method">GetTypeNames</a>(<span class="r681 r">property</span>.<a href="MshMemberInfo.cs.html#014ea40b35222be9" class="i field">instance</a>).<a href="TypeTable.cs.html#16f0a7b631e4dbc5" class="i property">Key</a>,
                    <span class="r687 r">e</span>.<span class="i">ToString</span>(),
                    <span class="r687 r">e</span>.<span class="i">InnerException</span> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <span class="r687 r">e</span>.<span class="i">InnerException</span>.<span class="i">ToString</span>());
 
                <span class="r683 r">success</span> = <b>false</b>;
                <b>return</b> <b>null</b>;
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A dictionary from object to T where</span>
    <span class="c">///</span><span class="c"> 1) keys are objects,</span>
    <span class="c">///</span><span class="c"> 2) keys use reference equality,</span>
    <span class="c">///</span><span class="c"> 3) dictionary keeps only weak references to keys.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r688 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">type of dictionary values</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="a61e21d93f9f859e" href="../R/a61e21d93f9f859e.html" target="n" data-glyph="2,0" class="t t">WeakReferenceDictionary</a>&lt;<span id="r688 rd t" class="r688 r t">T</span>&gt; : <span class="i">IDictionary</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;
    {
        <b>private sealed class</b> <a id="b0f36aa41fa495fe" href="../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="c443c5752c94a168">WeakReferenceEqualityComparer</span></a> : <span class="i">IEqualityComparer</span>&lt;<span class="i">WeakReference</span>&gt;
        {
            <b>public bool</b> <a id="c68a4d91aba19aaa" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Equals</a>(<span class="i">WeakReference</span> <span id="r689 rd" class="r689 r">x</span>, <span class="i">WeakReference</span> <span id="r690 rd" class="r690 r">y</span>)
            {
                <b>object</b> <span id="r691 rd" class="r691 r">tx</span> = <span class="r689 r">x</span>.<span class="i">Target</span>;
                <b>if</b> (<span class="r691 r">tx</span> == <b>null</b>)
                {
                    <b>return</b> <b>false</b>; <span class="c">// collected object is not equal to anything (object.ReferenceEquals(null, null) == true)</span>
                }
 
                <b>object</b> <span id="r692 rd" class="r692 r">ty</span> = <span class="r690 r">y</span>.<span class="i">Target</span>;
                <b>if</b> (<span class="r692 r">ty</span> == <b>null</b>)
                {
                    <b>return</b> <b>false</b>; <span class="c">// collected object is not equal to anything (object.ReferenceEquals(null, null) == true)</span>
                }
 
                <b>return</b> <b>object</b>.<span class="i">ReferenceEquals</span>(<span class="r691 r">tx</span>, <span class="r692 r">ty</span>);
            }
 
            <b>public int</b> <a id="ccf13d1227440e25" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">GetHashCode</a>(<span class="i">WeakReference</span> <span id="r693 rd" class="r693 r">obj</span>)
            {
                <b>object</b> <span id="r694 rd" class="r694 r">t</span> = <span class="r693 r">obj</span>.<span class="i">Target</span>;
                <b>if</b> (<span class="r694 r">t</span> == <b>null</b>)
                {
                    <span class="c">// collected object doesn&#39;t have a hash code</span>
                    <span class="c">// return an arbitrary hashcode here and fall back on Equal method for comparison</span>
                    <b>return</b> <span class="i">RuntimeHelpers</span>.<span class="i">GetHashCode</span>(<span class="r693 r">obj</span>); <span class="c">// RuntimeHelpers.GetHashCode(null) returns 0 - this would cause many hashtable collisions for WeakReferences to dead objects</span>
                }
                <b>else</b>
                {
                    <b>return</b> <span class="i">RuntimeHelpers</span>.<span class="i">GetHashCode</span>(<span class="r694 r">t</span>);
                }
            }
        }
 
        <b>private readonly</b> <span class="i">IEqualityComparer</span>&lt;<span class="i">WeakReference</span>&gt; <a id="221c581747aa2ca3" href="../R/221c581747aa2ca3.html" target="n" data-glyph="46,1" class="i field">_weakEqualityComparer</a>;
        <b>private</b> <span class="i">Dictionary</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt; <a id="e06002d9f9be9859" href="../R/e06002d9f9be9859.html" target="n" data-glyph="46,1" class="i field">_dictionary</a>;
 
        <b>public</b> <a id="ad722cda08fbd4db" href="../R/ad722cda08fbd4db.html" target="n" data-glyph="72,1" class="t constructor">WeakReferenceDictionary</a>()
        {
            <a href="#221c581747aa2ca3" class="i field">_weakEqualityComparer</a> = <b>new</b> <span class="t">WeakReferenceEqualityComparer</span>();
            <a href="#e06002d9f9be9859" class="i field">_dictionary</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt;(<a href="#221c581747aa2ca3" class="i field">_weakEqualityComparer</a>);
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
        <b>private const int</b> <a id="248b323e57164b29" href="../R/248b323e57164b29.html" target="n" data-glyph="10,1" class="i field">initialCleanupTriggerSize</a> = 2; <span class="c">// 2 will stress this code more</span>
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">        private const int initialCleanupTriggerSize = 1000;
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        <b>private int</b> <a id="6fc35de97e881922" href="../R/6fc35de97e881922.html" target="n" data-glyph="46,1" class="i field">_cleanupTriggerSize</a> = <a href="#248b323e57164b29" class="i field">initialCleanupTriggerSize</a>;
 
        <b>private void</b> <a id="307c9f3d4e300015" href="../R/307c9f3d4e300015.html" target="n" data-glyph="76,1" class="i method">CleanUp</a>()
        {
            <b>if</b> (<a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#18c814d19c961d50" class="i property">Count</a> &gt; <a href="#6fc35de97e881922" class="i field">_cleanupTriggerSize</a>)
            {
                <span class="i">Dictionary</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt; <span id="r695 rd" class="r695 r">alive</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt;(<a href="#221c581747aa2ca3" class="i field">_weakEqualityComparer</a>);
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt; <span id="r696 rd" class="r696 r">weakKeyValuePair</span> <b>in</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>)
                {
                    <b>object</b> <span id="r697 rd" class="r697 r">key</span> = <span class="r696 r">weakKeyValuePair</span>.<span class="i">Key</span>.<span class="i">Target</span>;
                    <b>if</b> (<span class="r697 r">key</span> != <b>null</b>)
                    {
                        <span class="r695 r">alive</span>.<span class="i">Add</span>(<span class="r696 r">weakKeyValuePair</span>.<span class="i">Key</span>, <span class="r696 r">weakKeyValuePair</span>.<span class="i">Value</span>);
                    }
                }
 
                <a href="#e06002d9f9be9859" class="i field">_dictionary</a> = <span class="r695 r">alive</span>;
                <a href="#6fc35de97e881922" class="i field">_cleanupTriggerSize</a> = <a href="#248b323e57164b29" class="i field">initialCleanupTriggerSize</a> + <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#18c814d19c961d50" class="i property">Count</a> * 2;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDictionary&lt;object,T&gt; Members
 
        <b>public void</b> <a id="0e600b8c5a10893f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>object</b> <span id="r698 rd" class="r698 r">key</span>, <span class="r688 r t">T</span> <span id="r699 rd" class="r699 r">value</span>)
        {
            <a href="#e06002d9f9be9859" class="i field">_dictionary</a>.<span class="i">Add</span>(<b>new</b> <span class="i">WeakReference</span>(<span class="r698 r">key</span>), <span class="r699 r">value</span>);
            <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#307c9f3d4e300015" class="i method">CleanUp</a>();
        }
 
        <b>public bool</b> <a id="8a60f88fedb77980" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ContainsKey</a>(<b>object</b> <span id="r700 rd" class="r700 r">key</span>)
        {
            <b>return</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>.<span class="i">ContainsKey</span>(<b>new</b> <span class="i">WeakReference</span>(<span class="r700 r">key</span>));
        }
 
        <b>public</b> <span class="i">ICollection</span>&lt;<b>object</b>&gt; <a id="48040516dd2d5da0" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Keys</a>
        {
            <b>get</b>
            {
                <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r701 rd" class="r701 r">keys</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;(<a href="#e06002d9f9be9859" class="i field">_dictionary</a>.<span class="i">Keys</span>.<span class="i">Count</span>);
                <b>foreach</b> (<span class="i">WeakReference</span> <span id="r702 rd" class="r702 r">weakKey</span> <b>in</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>.<span class="i">Keys</span>)
                {
                    <b>object</b> <span id="r703 rd" class="r703 r">key</span> = <span class="r702 r">weakKey</span>.<span class="i">Target</span>;
                    <b>if</b> (<span class="r703 r">key</span> != <b>null</b>)
                    {
                        <span class="r701 r">keys</span>.<span class="i">Add</span>(<span class="r703 r">key</span>);
                    }
                }
 
                <b>return</b> <span class="r701 r">keys</span>;
            }
        }
 
        <b>public bool</b> <a id="a0263142cbaac29b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Remove</a>(<b>object</b> <span id="r704 rd" class="r704 r">key</span>)
        {
            <b>return</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>.<span class="i">Remove</span>(<b>new</b> <span class="i">WeakReference</span>(<span class="r704 r">key</span>));
        }
 
        <b>public bool</b> <a id="53b3310ebd829187" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">TryGetValue</a>(<b>object</b> <span id="r705 rd" class="r705 r">key</span>, <b>out</b> <span class="r688 r t">T</span> <span id="r706 rd" class="r706 r">value</span>)
        {
            <span class="i">WeakReference</span> <span id="r707 rd" class="r707 r">weakKey</span> = <b>new</b> <span class="i">WeakReference</span>(<span class="r705 r">key</span>);
            <b>return</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>.<span class="i">TryGetValue</span>(<span class="r707 r">weakKey</span>, <b>out</b> <span class="r706 r">value</span>);
        }
 
        <b>public</b> <span class="i">ICollection</span>&lt;<span class="r688 r t">T</span>&gt; <a id="839c0ac7cef9a50b" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Values</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>.<span class="i">Values</span>;
            }
        }
 
        <b>public</b> <span class="r688 r t">T</span> <a id="5a61bb991d1b32d6" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="k">this</a>[<b>object</b> <span id="r708 rd" class="r708 r">key</span>]
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>[<b>new</b> <span class="i">WeakReference</span>(<span class="r708 r">key</span>)];
            }
 
            <b>set</b>
            {
                <a href="#e06002d9f9be9859" class="i field">_dictionary</a>[<b>new</b> <span class="i">WeakReference</span>(<span class="r708 r">key</span>)] = <b>value</b>;
                <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#307c9f3d4e300015" class="i method">CleanUp</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ICollection&lt;KeyValuePair&lt;object,T&gt;&gt; Members
 
        <b>private</b> <span class="i">ICollection</span>&lt;<span class="i">KeyValuePair</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt;&gt; <a id="af2ccae1bf8272c7" href="../R/af2ccae1bf8272c7.html" target="n" data-glyph="106,1" class="i property">WeakCollection</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e06002d9f9be9859" class="i field">_dictionary</a>;
            }
        }
 
        <b>private static</b> <span class="i">KeyValuePair</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt; <a id="4cccf7b237a22d52" href="../R/4cccf7b237a22d52.html" target="n" data-glyph="76,1" class="i method">WeakKeyValuePair</a>(<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt; <span id="r709 rd" class="r709 r">publicKeyValuePair</span>)
        {
            <b>return</b> <b>new</b> <span class="i">KeyValuePair</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt;(<b>new</b> <span class="i">WeakReference</span>(<span class="r709 r">publicKeyValuePair</span>.<span class="i">Key</span>), <span class="r709 r">publicKeyValuePair</span>.<span class="i">Value</span>);
        }
 
        <b>public void</b> <a id="83dff41a747683f2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt; <span id="r710 rd" class="r710 r">item</span>)
        {
            <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>.<span class="i">Add</span>(<a href="#4cccf7b237a22d52" class="i method">WeakKeyValuePair</a>(<span class="r710 r">item</span>));
            <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#307c9f3d4e300015" class="i method">CleanUp</a>();
        }
 
        <b>public void</b> <a id="df5b2b409add76da" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Clear</a>()
        {
            <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>.<span class="i">Clear</span>();
        }
 
        <b>public bool</b> <a id="2474fea2d676a4a2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Contains</a>(<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt; <span id="r711 rd" class="r711 r">item</span>)
        {
            <b>return</b> <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>.<span class="i">Contains</span>(<a href="#4cccf7b237a22d52" class="i method">WeakKeyValuePair</a>(<span class="r711 r">item</span>));
        }
 
        <b>public void</b> <a id="63de10ee098c6779" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CopyTo</a>(<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;[] <span id="r712 rd" class="r712 r">array</span>, <b>int</b> <span id="r713 rd" class="r713 r">arrayIndex</span>)
        {
            <span class="i">List</span>&lt;<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;&gt; <span id="r714 rd" class="r714 r">rawList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;&gt;(<a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>.<span class="i">Count</span>);
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt; <span id="r715 rd" class="r715 r">keyValuePair</span> <b>in</b> <a href="#a61e21d93f9f859e" class="k">this</a>)
            {
                <span class="r714 r">rawList</span>.<span class="i">Add</span>(<span class="r715 r">keyValuePair</span>);
            }
 
            <span class="r714 r">rawList</span>.<span class="i">CopyTo</span>(<span class="r712 r">array</span>, <span class="r713 r">arrayIndex</span>);
        }
 
        <b>public int</b> <a id="18c814d19c961d50" href="../R/18c814d19c961d50.html" target="n" data-glyph="102,1" class="i property">Count</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>.<span class="i">Count</span>;
            }
        }
 
        <b>public bool</b> <a id="a85211d3ace56fe5" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsReadOnly</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>.<span class="i">IsReadOnly</span>;
            }
        }
 
        <b>public bool</b> <a id="7fcf932cc4cca0c1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Remove</a>(<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt; <span id="r716 rd" class="r716 r">item</span>)
        {
            <b>return</b> <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>.<span class="i">Remove</span>(<a href="#4cccf7b237a22d52" class="i method">WeakKeyValuePair</a>(<span class="r716 r">item</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerable&lt;KeyValuePair&lt;object,T&gt;&gt; Members
 
        <b>public</b> <span class="i">IEnumerator</span>&lt;<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;&gt; <a id="de3793caa7f62dc1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetEnumerator</a>()
        {
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<span class="i">WeakReference</span>, <span class="r688 r t">T</span>&gt; <span id="r717 rd" class="r717 r">weakKeyValuePair</span> <b>in</b> <a href="#a61e21d93f9f859e" class="k">this</a>.<a href="#af2ccae1bf8272c7" class="i property">WeakCollection</a>)
            {
                <b>object</b> <span id="r718 rd" class="r718 r">key</span> = <span class="r717 r">weakKeyValuePair</span>.<span class="i">Key</span>.<span class="i">Target</span>;
                <b>if</b> (<span class="r718 r">key</span> != <b>null</b>)
                {
                    <b>yield</b> <b>return</b> <b>new</b> <span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;(<span class="r718 r">key</span>, <span class="r717 r">weakKeyValuePair</span>.<span class="i">Value</span>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerable Members
 
        <span class="i">IEnumerator</span> <span class="i">IEnumerable</span>.<a id="ecac8d4c01857b0e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <span class="i">IEnumerable</span>&lt;<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;&gt; <span id="r719 rd" class="r719 r">enumerable</span> = <a href="#a61e21d93f9f859e" class="k">this</a>;
            <span class="i">IEnumerator</span>&lt;<span class="i">KeyValuePair</span>&lt;<b>object</b>, <span class="r688 r t">T</span>&gt;&gt; <span id="r720 rd" class="r720 r">enumerator</span> = <span class="r719 r">enumerable</span>.<span class="i">GetEnumerator</span>();
            <b>return</b> <span class="r720 r">enumerator</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Hashtable</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that is limited to</span>
    <span class="c">///</span><span class="c"> 1) case-insensitive strings as keys and</span>
    <span class="c">///</span><span class="c"> 2) values that can be serialized and deserialized during PowerShell remoting handshake</span>
    <span class="c">///</span><span class="c">    (in major-version compatible versions of PowerShell remoting)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public sealed class</b> <a id="04756020c00714fe" href="../R/04756020c00714fe.html" target="n" data-glyph="0,0" class="t t">PSPrimitiveDictionary</a> : <span class="i">Hashtable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new empty instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="8d1ee4ea90ea9904" href="../R/8d1ee4ea90ea9904.html" target="n" data-glyph="72,1" class="t constructor">PSPrimitiveDictionary</a>()
            : <b>base</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class with contents</span>
        <span class="c">///</span><span class="c"> copied from the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r721 r">other</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r721 r">other</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Hashtable to copy into the new instance of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This constructor will throw if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r721 r">other</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> hashtable contains keys that are not a strings</span>
        <span class="c">///</span><span class="c"> or values that are not one of primitive types that will work during PowerShell remoting handshake.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2214:DoNotCallOverridableMethodsInConstructors&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;The class is sealed&quot;</span>)]
        <b>public</b> <a id="728e9bd88978fac9" href="../R/728e9bd88978fac9.html" target="n" data-glyph="72,1" class="t constructor">PSPrimitiveDictionary</a>(<span class="i">Hashtable</span> <span id="r721 rd" class="r721 r">other</span>)
            : <b>base</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            <b>if</b> (<span class="r721 r">other</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r721 r">other</span>));
            }
 
            <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r722 rd" class="r722 r">entry</span> <b>in</b> <span class="r721 r">other</span>)
            {
                <span class="i">Hashtable</span> <span id="r723 rd" class="r723 r">valueAsHashtable</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r722 r">entry</span>.<span class="i">Value</span>) <b>as</b> <span class="i">Hashtable</span>;
                <b>if</b> (<span class="r723 r">valueAsHashtable</span> != <b>null</b>)
                {
                    <a href="#04756020c00714fe" class="k">this</a>.<span class="i">Add</span>(<span class="r722 r">entry</span>.<span class="i">Key</span>, <b>new</b> <a href="#728e9bd88978fac9" class="t constructor">PSPrimitiveDictionary</a>(<span class="r723 r">valueAsHashtable</span>));
                }
                <b>else</b>
                {
                    <a href="#04756020c00714fe" class="k">this</a>.<span class="i">Add</span>(<span class="r722 r">entry</span>.<span class="i">Key</span>, <span class="r722 r">entry</span>.<span class="i">Value</span>);
                }
            }
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span> <span class="c">// No .NET Serialization In CoreCLR</span>
<span class="e">        /// &lt;summary&gt;
        /// Support for .NET serialization.
        /// &lt;/summary&gt;
        private PSPrimitiveDictionary(System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context)
                : base(info, context)
        {
        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Plumbing to make Hashtable reject all non-primitive types
 
        <b>private static string</b> <a id="9af95b7c4d11c65a" href="../R/9af95b7c4d11c65a.html" target="n" data-glyph="76,1" class="i method">VerifyKey</a>(<b>object</b> <span id="r724 rd" class="r724 r">key</span>)
        {
            <span class="r724 r">key</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r724 r">key</span>);
            <b>string</b> <span id="r725 rd" class="r725 r">keyAsString</span> = <span class="r724 r">key</span> <b>as string</b>;
            <b>if</b> (<span class="r725 r">keyAsString</span> == <b>null</b>)
            {
                <b>string</b> <span id="r726 rd" class="r726 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Serialization</span>.<span class="i">PrimitiveHashtableInvalidKey</span>,
                    <span class="r724 r">key</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r726 r">message</span>);
            }
            <b>else</b>
            {
                <b>return</b> <span class="r725 r">keyAsString</span>;
            }
        }
 
        <b>private static readonly</b> <span class="i">Type</span>[] <a id="6692ffc530ad9082" href="../R/6692ffc530ad9082.html" target="n" data-glyph="46,1" class="i field">s_handshakeFriendlyTypes</a> = <b>new</b> <span class="i">Type</span>[] {
                <b>typeof</b>(<b>bool</b>),
                <b>typeof</b>(<b>byte</b>),
                <b>typeof</b>(<b>char</b>),
                <b>typeof</b>(<span class="i">DateTime</span>),
                <b>typeof</b>(<b>decimal</b>),
                <b>typeof</b>(<b>double</b>),
                <b>typeof</b>(<span class="i">Guid</span>),
                <b>typeof</b>(<span class="i">Int32</span>),
                <b>typeof</b>(<span class="i">Int64</span>),
                <b>typeof</b>(<b>sbyte</b>),
                <b>typeof</b>(<span class="i">Single</span>),
                <span class="c">// typeof(ScriptBlock) - don&#39;t want ScriptBlocks, because they are deserialized into strings</span>
                <b>typeof</b>(<b>string</b>),
                <b>typeof</b>(<span class="i">TimeSpan</span>),
                <b>typeof</b>(<span class="i">UInt16</span>),
                <b>typeof</b>(<span class="i">UInt32</span>),
                <b>typeof</b>(<span class="i">UInt64</span>),
                <b>typeof</b>(<span class="i">Uri</span>),
                <b>typeof</b>(<b>byte</b>[]),
                <b>typeof</b>(<span class="i">Version</span>),
                <b>typeof</b>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>),
                <b>typeof</b>(<span class="i">XmlDocument</span>),
 
                <b>typeof</b>(<a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>)
            };
 
        <b>private void</b> <a id="847d0b2b5ab97508" href="../R/847d0b2b5ab97508.html" target="n" data-glyph="76,1" class="i method">VerifyValue</a>(<b>object</b> <span id="r727 rd" class="r727 r">value</span>)
        {
            <span class="c">// null is a primitive type</span>
            <b>if</b> (<span class="r727 r">value</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="r727 r">value</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r727 r">value</span>);
 
            <span class="c">// this list is based on the list inside KnownTypes</span>
            <span class="c">// it is copied here to make sure that a list of &quot;handshake friendly types&quot;</span>
            <span class="c">// won&#39;t change even if we add new primitive types in v.next</span>
 
            <span class="i">Type</span> <span id="r728 rd" class="r728 r">valueType</span> = <span class="r727 r">value</span>.<span class="i">GetType</span>();
 
            <span class="c">// if &quot;value&quot; is a &quot;primitiveType&quot; then we are good</span>
            <b>foreach</b> (<span class="i">Type</span> <span id="r729 rd" class="r729 r">goodType</span> <b>in</b> <a href="#6692ffc530ad9082" class="i field">s_handshakeFriendlyTypes</a>)
            {
                <b>if</b> (<span class="r728 r">valueType</span> == <span class="r729 r">goodType</span>)
                {
                    <b>return</b>;
                }
            }
 
            <span class="c">// if &quot;value&quot; is an array of &quot;primitiveType&quot; items then we are good</span>
            <span class="c">// (note: we could have used IEnumerable&lt;&gt; or ICollection&lt;&gt; (covariance/contravariance concerns),</span>
            <span class="c">//        but it is safer to limit the types to arrays.</span>
            <span class="c">//        (one concern is that in v.next we might allow overriding SerializationMethod for</span>
            <span class="c">//         types [i.e. check SerializationMethod *before* HandleKnownContainerTypes)</span>
            <b>if</b> ((<span class="r728 r">valueType</span>.<span class="i">IsArray</span>) || <span class="r728 r">valueType</span> == <b>typeof</b>(<span class="i">ArrayList</span>))
            {
                <b>foreach</b> (<b>object</b> <span id="r730 rd" class="r730 r">o</span> <b>in</b> (<span class="i">IEnumerable</span>)<span class="r727 r">value</span>)
                {
                    <a href="#847d0b2b5ab97508" class="i method">VerifyValue</a>(<span class="r730 r">o</span>);
                }
 
                <b>return</b>;
            }
 
            <b>string</b> <span id="r731 rd" class="r731 r">message</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Serialization</span>.<span class="i">PrimitiveHashtableInvalidValue</span>,
                <span class="r727 r">value</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r731 r">message</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r732 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r733 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method will throw if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r732 r">key</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not a string and the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r733 r">value</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is not one of primitive types that will work during PowerShell remoting handshake.</span>
        <span class="c">///</span><span class="c"> Use of strongly-typed overloads of this method is suggested if throwing an exception is not acceptable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="6c56b64af5b281e9" href="../R/6c56b64af5b281e9.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>object</b> <span id="r732 rd" class="r732 r">key</span>, <b>object</b> <span id="r733 rd" class="r733 r">value</span>)
        {
            <b>string</b> <span id="r734 rd" class="r734 r">keyAsString</span> = <a href="#9af95b7c4d11c65a" class="i method">VerifyKey</a>(<span class="r732 r">key</span>);
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#847d0b2b5ab97508" class="i method">VerifyValue</a>(<span class="r733 r">value</span>);
            <b>base</b>.<span class="i">Add</span>(<span class="r734 r">keyAsString</span>, <span class="r733 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the value associated with the specified key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r735 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key whose value to get or set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value associated with the specified key.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the specified key is not found, attempting to get it returns </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">null</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> and attempting to set it creates a new element using the specified key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The setter will throw if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r735 r">key</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not a string and the value</span>
        <span class="c">///</span><span class="c"> is not one of primitive types that will work during PowerShell remoting handshake.</span>
        <span class="c">///</span><span class="c"> Use of strongly-typed overloads of Add method is suggested if throwing an exception is not acceptable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="9ac7c700fadaf4e8" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="k">this</a>[<b>object</b> <span id="r735 rd" class="r735 r">key</span>]
        {
            <b>get</b>
            {
                <b>return</b> <b>base</b>[<span class="r735 r">key</span>];
            }
 
            <b>set</b>
            {
                <b>string</b> <span id="r736 rd" class="r736 r">keyAsString</span> = <a href="#9af95b7c4d11c65a" class="i method">VerifyKey</a>(<span class="r735 r">key</span>);
                <a href="#04756020c00714fe" class="k">this</a>.<a href="#847d0b2b5ab97508" class="i method">VerifyValue</a>(<b>value</b>);
                <b>base</b>[<span class="r736 r">keyAsString</span>] = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the value associated with the specified key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r737 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key whose value to get or set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The value associated with the specified key.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the specified key is not found, attempting to get it returns </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">null</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> and attempting to set it creates a new element using the specified key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The setter will throw if the value</span>
        <span class="c">///</span><span class="c"> is not one of primitive types that will work during PowerShell remoting handshake.</span>
        <span class="c">///</span><span class="c"> Use of strongly-typed overloads of Add method is suggested if throwing an exception is not acceptable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public object</b> <a id="ef1aa37a4f65ba77" href="../R/ef1aa37a4f65ba77.html" target="n" data-glyph="102,1" class="k">this</a>[<b>string</b> <span id="r737 rd" class="r737 r">key</span>]
        {
            <b>get</b>
            {
                <b>return</b> <b>base</b>[<span class="r737 r">key</span>];
            }
 
            <b>set</b>
            {
                <a href="#04756020c00714fe" class="k">this</a>.<a href="#847d0b2b5ab97508" class="i method">VerifyValue</a>(<b>value</b>);
                <b>base</b>[<span class="r737 r">key</span>] = <b>value</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helper methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance by doing a shallow copy of the current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="b40d2dd63c0a7315" href="../R/b40d2dd63c0a7315.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <span class="t">PSPrimitiveDictionary</span>(<a href="#04756020c00714fe" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r738 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r739 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ae1dcc27af8941d0" href="../R/ae1dcc27af8941d0.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r738 rd" class="r738 r">key</span>, <b>bool</b> <span id="r739 rd" class="r739 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r738 r">key</span>, (<b>object</b>)<span class="r739 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r740 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r741 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="8d9f3f1b51450a5b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r740 rd" class="r740 r">key</span>, <b>bool</b>[] <span id="r741 rd" class="r741 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r740 r">key</span>, (<b>object</b>)<span class="r741 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r742 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r743 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="e71bd82fe52f94cc" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r742 rd" class="r742 r">key</span>, <b>byte</b> <span id="r743 rd" class="r743 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r742 r">key</span>, (<b>object</b>)<span class="r743 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r744 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r745 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d96196ca09d91db4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r744 rd" class="r744 r">key</span>, <b>byte</b>[] <span id="r745 rd" class="r745 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r744 r">key</span>, (<b>object</b>)<span class="r745 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r746 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r747 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="270a2875dcdf589a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r746 rd" class="r746 r">key</span>, <b>char</b> <span id="r747 rd" class="r747 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r746 r">key</span>, (<b>object</b>)<span class="r747 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r748 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r749 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="b2770bae20c941c7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r748 rd" class="r748 r">key</span>, <b>char</b>[] <span id="r749 rd" class="r749 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r748 r">key</span>, (<b>object</b>)<span class="r749 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r750 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r751 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="414401ab59ddc773" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r750 rd" class="r750 r">key</span>, <span class="i">DateTime</span> <span id="r751 rd" class="r751 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r750 r">key</span>, (<b>object</b>)<span class="r751 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r752 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r753 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="0342712053744d7f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r752 rd" class="r752 r">key</span>, <span class="i">DateTime</span>[] <span id="r753 rd" class="r753 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r752 r">key</span>, (<b>object</b>)<span class="r753 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r754 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r755 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="fe627650c76588fa" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r754 rd" class="r754 r">key</span>, <span class="i">Decimal</span> <span id="r755 rd" class="r755 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r754 r">key</span>, (<b>object</b>)<span class="r755 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r756 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r757 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="bff0dd23ed70ac74" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r756 rd" class="r756 r">key</span>, <span class="i">Decimal</span>[] <span id="r757 rd" class="r757 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r756 r">key</span>, (<b>object</b>)<span class="r757 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r758 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r759 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="8bd61569911c5a84" href="../R/8bd61569911c5a84.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r758 rd" class="r758 r">key</span>, <b>double</b> <span id="r759 rd" class="r759 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r758 r">key</span>, (<b>object</b>)<span class="r759 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r760 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r761 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="8a4dda6cbd87e76a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r760 rd" class="r760 r">key</span>, <b>double</b>[] <span id="r761 rd" class="r761 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r760 r">key</span>, (<b>object</b>)<span class="r761 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r762 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r763 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="77f22926d330adb2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r762 rd" class="r762 r">key</span>, <span class="i">Guid</span> <span id="r763 rd" class="r763 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r762 r">key</span>, (<b>object</b>)<span class="r763 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r764 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r765 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d4fcf4ab01ec7e56" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r764 rd" class="r764 r">key</span>, <span class="i">Guid</span>[] <span id="r765 rd" class="r765 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r764 r">key</span>, (<b>object</b>)<span class="r765 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r766 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r767 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a6868e19b98188a2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r766 rd" class="r766 r">key</span>, <span class="i">Int32</span> <span id="r767 rd" class="r767 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r766 r">key</span>, (<b>object</b>)<span class="r767 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r768 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r769 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a82bf26c25510b86" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r768 rd" class="r768 r">key</span>, <span class="i">Int32</span>[] <span id="r769 rd" class="r769 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r768 r">key</span>, (<b>object</b>)<span class="r769 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r770 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r771 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a4d0208df4c37539" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r770 rd" class="r770 r">key</span>, <span class="i">Int64</span> <span id="r771 rd" class="r771 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r770 r">key</span>, (<b>object</b>)<span class="r771 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r772 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r773 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="8a458592587e75e9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r772 rd" class="r772 r">key</span>, <span class="i">Int64</span>[] <span id="r773 rd" class="r773 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r772 r">key</span>, (<b>object</b>)<span class="r773 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r774 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r775 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="c509ef751d8b1932" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r774 rd" class="r774 r">key</span>, <b>sbyte</b> <span id="r775 rd" class="r775 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r774 r">key</span>, (<b>object</b>)<span class="r775 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r776 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r777 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a9fa6aad80cec198" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r776 rd" class="r776 r">key</span>, <b>sbyte</b>[] <span id="r777 rd" class="r777 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r776 r">key</span>, (<b>object</b>)<span class="r777 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r778 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r779 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="7d6e4fa32f172b9b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r778 rd" class="r778 r">key</span>, <span class="i">Single</span> <span id="r779 rd" class="r779 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r778 r">key</span>, (<b>object</b>)<span class="r779 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r780 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r781 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d5b19695168ba2c7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r780 rd" class="r780 r">key</span>, <span class="i">Single</span>[] <span id="r781 rd" class="r781 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r780 r">key</span>, (<b>object</b>)<span class="r781 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r782 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r783 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="9637c1d6cdd9461b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r782 rd" class="r782 r">key</span>, <b>string</b> <span id="r783 rd" class="r783 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r782 r">key</span>, (<b>object</b>)<span class="r783 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r784 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r785 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3cbb7e928aa167fd" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r784 rd" class="r784 r">key</span>, <b>string</b>[] <span id="r785 rd" class="r785 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r784 r">key</span>, (<b>object</b>)<span class="r785 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r786 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r787 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="498a85a1dcb3e813" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r786 rd" class="r786 r">key</span>, <span class="i">TimeSpan</span> <span id="r787 rd" class="r787 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r786 r">key</span>, (<b>object</b>)<span class="r787 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r788 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r789 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="78e36c79e892775e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r788 rd" class="r788 r">key</span>, <span class="i">TimeSpan</span>[] <span id="r789 rd" class="r789 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r788 r">key</span>, (<b>object</b>)<span class="r789 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r790 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r791 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f91c1bf794dafbba" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r790 rd" class="r790 r">key</span>, <span class="i">UInt16</span> <span id="r791 rd" class="r791 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r790 r">key</span>, (<b>object</b>)<span class="r791 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r792 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r793 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="55410beb76219966" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r792 rd" class="r792 r">key</span>, <span class="i">UInt16</span>[] <span id="r793 rd" class="r793 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r792 r">key</span>, (<b>object</b>)<span class="r793 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r794 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r795 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="08fef61308ea694f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r794 rd" class="r794 r">key</span>, <span class="i">UInt32</span> <span id="r795 rd" class="r795 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r794 r">key</span>, (<b>object</b>)<span class="r795 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r796 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r797 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="432d28babaab18b3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r796 rd" class="r796 r">key</span>, <span class="i">UInt32</span>[] <span id="r797 rd" class="r797 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r796 r">key</span>, (<b>object</b>)<span class="r797 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r798 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r799 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="25c298eb7bdc5ed2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r798 rd" class="r798 r">key</span>, <span class="i">UInt64</span> <span id="r799 rd" class="r799 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r798 r">key</span>, (<b>object</b>)<span class="r799 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r800 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r801 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="97e40ee3eb94b1ce" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r800 rd" class="r800 r">key</span>, <span class="i">UInt64</span>[] <span id="r801 rd" class="r801 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r800 r">key</span>, (<b>object</b>)<span class="r801 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r802 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r803 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="5178e0304f9a9b0d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r802 rd" class="r802 r">key</span>, <span class="i">Uri</span> <span id="r803 rd" class="r803 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r802 r">key</span>, (<b>object</b>)<span class="r803 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r804 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r805 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="5c7598e67caf3a11" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r804 rd" class="r804 r">key</span>, <span class="i">Uri</span>[] <span id="r805 rd" class="r805 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r804 r">key</span>, (<b>object</b>)<span class="r805 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r806 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r807 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="eb88113c2df75863" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r806 rd" class="r806 r">key</span>, <span class="i">Version</span> <span id="r807 rd" class="r807 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r806 r">key</span>, (<b>object</b>)<span class="r807 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r808 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r809 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f510575ca51ea3ce" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r808 rd" class="r808 r">key</span>, <span class="i">Version</span>[] <span id="r809 rd" class="r809 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r808 r">key</span>, (<b>object</b>)<span class="r809 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r810 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r811 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="51d329d827df0c10" href="../R/51d329d827df0c10.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r810 rd" class="r810 r">key</span>, <a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r811 rd" class="r811 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r810 r">key</span>, (<b>object</b>)<span class="r811 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds an element with the specified key and value into the Hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r812 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r813 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value of the element to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="2344b009746c7e90" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>string</b> <span id="r812 rd" class="r812 r">key</span>, <a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>[] <span id="r813 rd" class="r813 r">value</span>)
        {
            <a href="#04756020c00714fe" class="k">this</a>.<a href="#6c56b64af5b281e9" class="i method">Add</a>((<b>object</b>)<span class="r812 r">key</span>, (<b>object</b>)<span class="r813 r">value</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If originalHash contains PSVersionTable, then just returns the Cloned copy of</span>
        <span class="c">///</span><span class="c"> the original hash. Othewise, creates a clone copy and add PSVersionInfo.GetPSVersionTable</span>
        <span class="c">///</span><span class="c"> to the clone and returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r814 r">originalHash</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="e247a6e030dd9d9f" href="../R/e247a6e030dd9d9f.html" target="n" data-glyph="74,1" class="i method">CloneAndAddPSVersionTable</a>(<a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r814 rd" class="r814 r">originalHash</span>)
        {
            <b>if</b> ((<span class="r814 r">originalHash</span> != <b>null</b>) &amp;&amp;
                (<span class="r814 r">originalHash</span>.<span class="i">ContainsKey</span>(<a href="PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="PSVersionInfo.cs.html#6f3eb6d7f2bfc1d8" class="i field">PSVersionTableName</a>)))
            {
                <b>return</b> (<a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>)<span class="r814 r">originalHash</span>.<a href="#b40d2dd63c0a7315" class="i method">Clone</a>();
            }
 
            <a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r815 rd" class="r815 r">result</span> = <span class="r814 r">originalHash</span>;
            <b>if</b> (<span class="r814 r">originalHash</span> != <b>null</b>)
            {
                <span class="r815 r">result</span> = (<a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>)<span class="r814 r">originalHash</span>.<a href="#b40d2dd63c0a7315" class="i method">Clone</a>();
            }
            <b>else</b>
            {
                <span class="r815 r">result</span> = <b>new</b> <a href="#8d1ee4ea90ea9904" class="t constructor">PSPrimitiveDictionary</a>();
            }
 
            <a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r816 rd" class="r816 r">versionTable</span> = <b>new</b> <a href="#728e9bd88978fac9" class="t constructor">PSPrimitiveDictionary</a>(<a href="PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="PSVersionInfo.cs.html#2dc572ec12218b50" class="i method">GetPSVersionTableForDownLevel</a>())
            {
                {<span class="s">&quot;PSSemanticVersion&quot;</span>, <a href="PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="PSVersionInfo.cs.html#ad63365ac7690eeb" class="i property">PSVersion</a>.<span class="i">ToString</span>()}
            };
            <span class="r815 r">result</span>.<a href="#51d329d827df0c10" class="i method">Add</a>(<a href="PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="PSVersionInfo.cs.html#6f3eb6d7f2bfc1d8" class="i field">PSVersionTableName</a>, <span class="r816 r">versionTable</span>);
 
            <b>return</b> <span class="r815 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tries to get a value that might be present in a chain of nested PSPrimitiveDictionaries.</span>
        <span class="c">///</span><span class="c"> For example to get $sessionInfo.ApplicationPrivateData.ImplicitRemoting.Hash you could call</span>
        <span class="c">///</span><span class="c"> TryPathGet</span><span class="c">&amp;lt;</span><span class="c">string</span><span class="c">&amp;gt;</span><span class="c">($sessionInfo.ApplicationPrivateData, out myHash, &quot;ImplicitRemoting&quot;, &quot;Hash&quot;).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r817 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Expected type of the value</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r818 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The root dictionary.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r819 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r820 r">keys</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A chain of keys leading from the root dictionary (</span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r818 r">data</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">) to the value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if the value was found and was of the correct type; </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">false</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="dc33bcdf01531533" href="../R/dc33bcdf01531533.html" target="n" data-glyph="74,1" class="i method">TryPathGet</a>&lt;<span id="r817 rd t" class="r817 r t">T</span>&gt;(<span class="i">IDictionary</span> <span id="r818 rd" class="r818 r">data</span>, <b>out</b> <span class="r817 r t">T</span> <span id="r819 rd" class="r819 r">result</span>, <b>params string</b>[] <span id="r820 rd" class="r820 r">keys</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r820 r">keys</span> != <b>null</b>, <span class="s">&quot;Caller should verify that keys != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r820 r">keys</span>.<span class="i">Length</span> &gt;= 1, <span class="s">&quot;Caller should verify that keys.Length &gt;= 1&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r820 r">keys</span>[0] != <b>null</b>, <span class="s">&quot;Caller should verify that keys[i] != null&quot;</span>);
 
            <b>if</b> (<span class="r818 r">data</span> == <b>null</b> || !<span class="r818 r">data</span>.<span class="i">Contains</span>(<span class="r820 r">keys</span>[0]))
            {
                <span class="r819 r">result</span> = <b>default</b>(<span class="r817 r t">T</span>);
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r820 r">keys</span>.<span class="i">Length</span> == 1)
            {
                <b>return</b> <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<span class="r817 r t">T</span>&gt;(<span class="r818 r">data</span>[<span class="r820 r">keys</span>[0]], <b>out</b> <span class="r819 r">result</span>);
            }
            <b>else</b>
            {
                <span class="i">IDictionary</span> <span id="r821 rd" class="r821 r">subData</span>;
                <b>if</b> (<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<span class="i">IDictionary</span>&gt;(<span class="r818 r">data</span>[<span class="r820 r">keys</span>[0]], <b>out</b> <span class="r821 r">subData</span>)
                    &amp;&amp; <span class="r821 r">subData</span> != <b>null</b>)
                {
                    <b>string</b>[] <span id="r822 rd" class="r822 r">subKeys</span> = <b>new</b> <b>string</b>[<span class="r820 r">keys</span>.<span class="i">Length</span> - 1];
                    <span class="i">Array</span>.<span class="i">Copy</span>(<span class="r820 r">keys</span>, 1, <span class="r822 r">subKeys</span>, 0, <span class="r822 r">subKeys</span>.<span class="i">Length</span>);
                    <b>return</b> <a href="#dc33bcdf01531533" class="i method">TryPathGet</a>&lt;<span class="r817 r t">T</span>&gt;(<span class="r821 r">subData</span>, <b>out</b> <span class="r819 r">result</span>, <span class="r822 r">subKeys</span>);
                }
                <b>else</b>
                {
                    <span class="r819 r">result</span> = <b>default</b>(<span class="r817 r t">T</span>);
                    <b>return</b> <b>false</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>
{
    <b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
    <b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Principal</span>;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Rehydrating type converter used during deserialization.</span>
    <span class="c">///</span><span class="c"> It takes results of serializing some common types</span>
    <span class="c">///</span><span class="c"> and rehydrates them back from property bags into live objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
    <span class="c">///</span><span class="c"> To add a new type for rehydration:</span>
    <span class="c">///</span><span class="c"> - Add a new T RehydrateT(PSObject pso) method below</span>
    <span class="c">///</span><span class="c"> - Add this method to converters dictionary in the static constructor below</span>
    <span class="c">///</span><span class="c"> - If implicit rehydration is required then</span>
    <span class="c">///</span><span class="c">   - Add appropriate types.ps1 xml entries for</span>
    <span class="c">///</span><span class="c">     - SerializationDepth=X</span>
    <span class="c">///</span><span class="c">     - For types depending only on ToString for rehydration set</span>
    <span class="c">///</span><span class="c">       - SerializationMethod=SpecificProperties</span>
    <span class="c">///</span><span class="c">       - PropertySerializationSet=&lt;empty&gt;</span>
    <span class="c">///</span><span class="c">     - TargetTypeForDeserialization=DeserializingTypeConverter</span>
    <span class="c">///</span><span class="c">   - Add a field of that type in unit tests / S.M.A.Test.SerializationTest+RehydratedType</span>
    <span class="c">///</span><span class="c">     (testsrc\admintest\monad\DRT\engine\UnitTests\SerializationTest.cs)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
    <b>public sealed class</b> <a id="ddbcb5ecc947a806" href="../R/ddbcb5ecc947a806.html" target="n" data-glyph="0,0" class="t t"><span id="8769c9182ea01305">DeserializingTypeConverter</span></a> : <a href="LanguagePrimitives.cs.html#89a33fbb336451a1" class="t t">PSTypeConverter</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Infrastructure
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Func</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>, <b>object</b>&gt;&gt; <a id="d5197b5be72c8aab" href="../R/d5197b5be72c8aab.html" target="n" data-glyph="46,1" class="i field">s_converter</a>;
 
        <b>static</b> <a id="d39c05dfca97eff6" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">DeserializingTypeConverter</a>()
        {
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Func</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>, <b>object</b>&gt;&gt;();
 
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>), <span class="i">RehydratePrimitiveHashtable</span>);
 
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>), <span class="i">RehydrateSwitchParameter</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a>), <span class="i">RehydratePSListModifier</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a>), <span class="i">RehydratePSCredential</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>), <span class="i">RehydratePSSenderInfo</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i">CultureInfo</span>), <span class="i">RehydrateCultureInfo</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>), <span class="i">RehydrateParameterSetMetadata</span>);
 
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>.<span class="i">X509Certificate2</span>), <span class="i">RehydrateX509Certificate2</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>.<span class="i">X500DistinguishedName</span>), <span class="i">RehydrateX500DistinguishedName</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Net</span>.<span class="i">IPAddress</span>), <span class="i">RehydrateIPAddress</span>);
 
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i">MailAddress</span>), <span class="i">RehydrateMailAddress</span>);
 
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>.<span class="i">DirectorySecurity</span>), <span class="i">RehydrateObjectSecurity</span>&lt;<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>.<span class="i">DirectorySecurity</span>&gt;);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>.<span class="i">FileSecurity</span>), <span class="i">RehydrateObjectSecurity</span>&lt;<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>.<span class="i">FileSecurity</span>&gt;);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>.<span class="i">RegistrySecurity</span>), <span class="i">RehydrateObjectSecurity</span>&lt;<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>.<span class="i">RegistrySecurity</span>&gt;);
 
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f507ec3cc270989a" class="t t">ExtendedTypeDefinition</a>), <span class="i">RehydrateExtendedTypeDefinition</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f06b7548d648d6d9" class="t t">FormatViewDefinition</a>), <span class="i">RehydrateFormatViewDefinition</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#87760d4efd2e8d05" class="t t">PSControl</a>), <span class="i">RehydratePSControl</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#1876ab43931a64c1" class="t t">PSControlGroupBy</a>), <span class="i">RehydrateGroupBy</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>), <span class="i">RehydrateDisplayEntry</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a>), <span class="i">RehydrateEntrySelectedBy</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#8de7b62acebc6e04" class="t t">TableControlColumnHeader</a>), <span class="i">RehydrateTableControlColumnHeader</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#c9bb940410c81f0f" class="t t">TableControlRow</a>), <span class="i">RehydrateTableControlRow</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#e171f7796c952fb2" class="t t">TableControlColumn</a>), <span class="i">RehydrateTableControlColumn</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#e4f4c1fbd5d6efe8" class="t t">ListControlEntry</a>), <span class="i">RehydrateListControlEntry</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#d0834c53815ad342" class="t t">ListControlEntryItem</a>), <span class="i">RehydrateListControlEntryItem</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#ab1e040d09a19665" class="t t">WideControlEntryItem</a>), <span class="i">RehydrateWideControlEntryItem</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#a7c2e8cb994c8339" class="t t">CustomControlEntry</a>), <span class="i">RehydrateCustomControlEntry</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c0bc0eb3b8fe54ed" class="t t">CustomItemBase</a>), <span class="i">RehydrateCustomItemBase</span>);
 
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="CommandCompletion/CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>), <span class="i">RehydrateCompletionResult</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>), <span class="i">RehydrateModuleSpecification</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="CommandCompletion/CommandCompletion.cs.html#a9d35cade4030f50" class="t t">CommandCompletion</a>), <span class="i">RehydrateCommandCompletion</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="remoting/client/Job.cs.html#8f788812e1264af5" class="t t">JobStateInfo</a>), <span class="i">RehydrateJobStateInfo</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="remoting/client/Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a>), <span class="i">RehydrateJobStateEventArgs</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="remoting/commands/PSRemotingCmdlet.cs.html#8626ee928362b305" class="t t">PSSessionOption</a>), <span class="i">RehydratePSSessionOption</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="debugger/Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>), <span class="i">RehydrateLineBreakpoint</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="debugger/Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a>), <span class="i">RehydrateCommandBreakpoint</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="debugger/Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>), <span class="i">RehydrateVariableBreakpoint</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="debugger/debugger.cs.html#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a>), <span class="i">RehydrateBreakpointUpdatedEventArgs</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="debugger/debugger.cs.html#bcdf979426ef3d7b" class="t t">DebuggerCommand</a>), <span class="i">RehydrateDebuggerCommand</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a>), <span class="i">RehydrateDebuggerCommandResults</span>);
            <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>), <span class="i">RehydrateDebuggerStopEventArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r823 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r824 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r823 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r824 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type to convert to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r823 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r824 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, otherwise false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="dc4b1bfbc9a65005" href="../R/dc4b1bfbc9a65005.html" target="n" data-glyph="72,1" class="i method">CanConvertFrom</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r823 rd" class="r823 r">sourceValue</span>, <span class="i">Type</span> <span id="r824 rd" class="r824 r">destinationType</span>)
        {
            <b>foreach</b> (<span class="i">Type</span> <span id="r825 rd" class="r825 r">type</span> <b>in</b> <a href="#d5197b5be72c8aab" class="i field">s_converter</a>.<span class="i">Keys</span>)
            {
                <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#bedc3ec1f782a8e0" class="i method">IsDeserializedInstanceOfType</a>(<span class="r823 r">sourceValue</span>, <span class="r825 r">type</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r826 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r827 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r826 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r827 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type to convert to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r828 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format provider to use like in IFormattable&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r829 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r826 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r827 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidCastException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no conversion was possible.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="caebbdd5d6e1f9a5" href="../R/caebbdd5d6e1f9a5.html" target="n" data-glyph="72,1" class="i method">ConvertFrom</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r826 rd" class="r826 r">sourceValue</span>, <span class="i">Type</span> <span id="r827 rd" class="r827 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r828 rd" class="r828 r">formatProvider</span>, <b>bool</b> <span id="r829 rd" class="r829 r">ignoreCase</span>)
        {
            <b>if</b> (<span class="r827 r">destinationType</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r827 r">destinationType</span>));
            }
 
            <b>if</b> (<span class="r826 r">sourceValue</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(
                    <span class="s">&quot;InvalidCastWhenRehydratingFromNull&quot;</span>,
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r826 r">sourceValue</span>)),
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastFromNull</span>,
                    <span class="r827 r">destinationType</span>.<span class="i">ToString</span>());
            }
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<span class="i">Type</span>, <span class="i">Func</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>, <b>object</b>&gt;&gt; <span id="r830 rd" class="r830 r">item</span> <b>in</b> <a href="#d5197b5be72c8aab" class="i field">s_converter</a>)
            {
                <span class="i">Type</span> <span id="r831 rd" class="r831 r">type</span> = <span class="r830 r">item</span>.<span class="i">Key</span>;
                <span class="i">Func</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>, <b>object</b>&gt; <span id="r832 rd" class="r832 r">typeConverter</span> = <span class="r830 r">item</span>.<span class="i">Value</span>;
                <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<a href="#bedc3ec1f782a8e0" class="i method">IsDeserializedInstanceOfType</a>(<span class="r826 r">sourceValue</span>, <span class="r831 r">type</span>))
                {
                    <b>return</b> <a href="#8d1f8bc7954c0520" class="i method">ConvertFrom</a>(<span class="r826 r">sourceValue</span>, <span class="r832 r">typeConverter</span>);
                }
            }
 
            <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(
                <span class="s">&quot;InvalidCastEnumFromTypeNotAString&quot;</span>,
                <b>null</b>,
                <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastException</span>,
                <span class="r826 r">sourceValue</span>,
                <b>typeof</b>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>),
                <span class="r827 r">destinationType</span>);
        }
 
        <b>private static object</b> <a id="8d1f8bc7954c0520" href="../R/8d1f8bc7954c0520.html" target="n" data-glyph="76,1" class="i method">ConvertFrom</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r833 rd" class="r833 r">o</span>, <span class="i">Func</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>, <b>object</b>&gt; <span id="r834 rd" class="r834 r">converter</span>)
        {
            <span class="c">// rehydrate</span>
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r835 rd" class="r835 r">dso</span> = <span class="r833 r">o</span>;
            <b>object</b> <span id="r836 rd" class="r836 r">rehydratedObject</span> = <span class="r834 r">converter</span>(<span class="r835 r">dso</span>);
 
            <span class="c">// re-add instance properties</span>
            <span class="c">// (dso.InstanceMembers includes both instance and *type table* properties;</span>
            <span class="c">//  therefore this will also re-add type table properties if they are not present when the deserializer runs;</span>
            <span class="c">//  this is ok)</span>
            <b>bool</b> <span id="r837 rd" class="r837 r">returnPSObject</span> = <b>false</b>;
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r838 rd" class="r838 r">rehydratedPSObject</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r836 r">rehydratedObject</span>);
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r839 rd" class="r839 r">member</span> <b>in</b> <span class="r835 r">dso</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>)
            {
                <b>if</b> (<span class="r839 r">member</span>.<a href="MshMemberInfo.cs.html#96599175ac2fa1f6" class="i property">MemberType</a> == (<span class="r839 r">member</span>.<a href="MshMemberInfo.cs.html#96599175ac2fa1f6" class="i property">MemberType</a> &amp; (<a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#65fc4239175168bd" class="i field">Properties</a> | <a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#13dbf4d3444210a7" class="i field">MemberSet</a> | <a href="MshMemberInfo.cs.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="MshMemberInfo.cs.html#5d1f01e046fd94a7" class="i field">PropertySet</a>)))
                {
                    <b>if</b> (<span class="r838 r">rehydratedPSObject</span>.<a href="MshObject.cs.html#56bc82b240e4291b" class="i property">Members</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r839 r">member</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>] == <b>null</b>)
                    {
                        <span class="r838 r">rehydratedPSObject</span>.<a href="MshObject.cs.html#e518df2aeb312ac9" class="i property">InstanceMembers</a>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r839 r">member</span>);
                        <span class="r837 r">returnPSObject</span> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r837 r">returnPSObject</span>)
            {
                <b>return</b> <span class="r838 r">rehydratedPSObject</span>;
            }
            <b>else</b>
            {
                <b>return</b> <span class="r836 r">rehydratedObject</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r840 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r841 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r840 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r841 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type to convert to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the converter can convert the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r840 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r841 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter, otherwise false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="8e90d0bb6909bbac" href="../R/8e90d0bb6909bbac.html" target="n" data-glyph="72,1" class="i method">CanConvertTo</a>(<b>object</b> <span id="r840 rd" class="r840 r">sourceValue</span>, <span class="i">Type</span> <span id="r841 rd" class="r841 r">destinationType</span>)
        {
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r842 r">sourceValue</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r843 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r842 r">sourceValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The value to convert from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r843 r">destinationType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type to convert to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r844 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format provider to use like in IFormattable&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r845 r">ignoreCase</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if case should be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">SourceValue converted to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r843 r">destinationType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter using formatProvider and ignoreCase.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidCastException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If no conversion was possible.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="319b06be297bcef3" href="../R/319b06be297bcef3.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>(<b>object</b> <span id="r842 rd" class="r842 r">sourceValue</span>, <span class="i">Type</span> <span id="r843 rd" class="r843 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r844 rd" class="r844 r">formatProvider</span>, <b>bool</b> <span id="r845 rd" class="r845 r">ignoreCase</span>)
        {
            <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not implemented - an overload taking a PSObject is implemented instead.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="5604a5092a1b3c25" href="../R/5604a5092a1b3c25.html" target="n" data-glyph="72,1" class="i method">CanConvertFrom</a>(<b>object</b> <span id="r846 rd" class="r846 r">sourceValue</span>, <span class="i">Type</span> <span id="r847 rd" class="r847 r">destinationType</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not implemented - an overload taking a PSObject is implemented instead.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="29d0eb6197971609" href="../R/29d0eb6197971609.html" target="n" data-glyph="72,1" class="i method">CanConvertTo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r848 rd" class="r848 r">sourceValue</span>, <span class="i">Type</span> <span id="r849 rd" class="r849 r">destinationType</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not implemented - an overload taking a PSObject is implemented instead.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="ce4a0ce1e15b59ec" href="../R/ce4a0ce1e15b59ec.html" target="n" data-glyph="72,1" class="i method">ConvertFrom</a>(<b>object</b> <span id="r850 rd" class="r850 r">sourceValue</span>, <span class="i">Type</span> <span id="r851 rd" class="r851 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r852 rd" class="r852 r">formatProvider</span>, <b>bool</b> <span id="r853 rd" class="r853 r">ignoreCase</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is not implemented - an overload taking a PSObject is implemented instead.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="6bb7302cf68696c7" href="../R/6bb7302cf68696c7.html" target="n" data-glyph="72,1" class="i method">ConvertTo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r854 rd" class="r854 r">sourceValue</span>, <span class="i">Type</span> <span id="r855 rd" class="r855 r">destinationType</span>, <span class="i">IFormatProvider</span> <span id="r856 rd" class="r856 r">formatProvider</span>, <b>bool</b> <span id="r857 rd" class="r857 r">ignoreCase</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Rehydration helpers
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="1056e690af85447d" href="../R/1056e690af85447d.html" target="n" data-glyph="20,1" class="t t"><span id="764b0463f43cd903">RehydrationFlags</span></a>
        {
            <a id="1b33ebafc3a3678e" href="../R/1b33ebafc3a3678e.html" target="n" data-glyph="24,2" class="i field">NullValueBad</a> = 0,
            <a id="57368bb545aac544" href="../R/57368bb545aac544.html" target="n" data-glyph="24,2" class="i field">NullValueOk</a> = 0x1,
            <a id="252bcdc8f903cf33" href="../R/252bcdc8f903cf33.html" target="n" data-glyph="24,2" class="i field">NullValueMeansEmptyList</a> = 0x3,
 
            <a id="dbcc1be4601a7e29" href="../R/dbcc1be4601a7e29.html" target="n" data-glyph="24,2" class="i field">MissingPropertyBad</a> = 0,
            <a id="7004b900d60ba66b" href="../R/7004b900d60ba66b.html" target="n" data-glyph="24,2" class="i field">MissingPropertyOk</a> = 0x4,
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets value of a property (has to be present, value has to be non-null).</span>
        <span class="c">///</span><span class="c"> Can throw any exception (which is ok - LanguagePrimitives.ConvertTo will catch that).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r858 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Expected type of the property</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r859 r">pso</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Deserialized object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r860 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="r858 r t">T</span> <a id="5d7913c018439f74" href="../R/5d7913c018439f74.html" target="n" data-glyph="76,1" class="i method">GetPropertyValue</a>&lt;<span id="r858 rd t" class="r858 r t">T</span>&gt;(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r859 rd" class="r859 r">pso</span>, <b>string</b> <span id="r860 rd" class="r860 r">propertyName</span>)
        {
            <b>return</b> <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<span class="r858 r t">T</span>&gt;(<span class="r859 r">pso</span>, <span class="r860 r">propertyName</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a> | <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#dbcc1be4601a7e29" class="i field">MissingPropertyBad</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets value of a property.  Can throw any exception (which is ok - LanguagePrimitives.ConvertTo will catch that).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r861 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Expected type of the property</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r862 r">pso</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Deserialized object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r863 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r864 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="r861 r t">T</span> <a id="4e995a3c8b04ebcc" href="../R/4e995a3c8b04ebcc.html" target="n" data-glyph="74,1" class="i method">GetPropertyValue</a>&lt;<span id="r861 rd t" class="r861 r t">T</span>&gt;(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r862 rd" class="r862 r">pso</span>, <b>string</b> <span id="r863 rd" class="r863 r">propertyName</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a> <span id="r864 rd" class="r864 r">flags</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r862 r">pso</span> != <b>null</b>, <span class="s">&quot;Caller should verify pso != null&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r863 r">propertyName</span>), <span class="s">&quot;Caller should verify propertyName != null&quot;</span>);
 
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r865 rd" class="r865 r">property</span> = <span class="r862 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r863 r">propertyName</span>];
            <b>if</b> ((<span class="r865 r">property</span> == <b>null</b>) &amp;&amp; ((<span class="r864 r">flags</span> &amp; <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>) == <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>))
            {
                <b>return</b> <b>default</b>(<span class="r861 r t">T</span>);
            }
            <b>else</b>
            {
                <b>object</b> <span id="r866 rd" class="r866 r">propertyValue</span> = <span class="r865 r">property</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
                <b>if</b> ((<span class="r866 r">propertyValue</span> == <b>null</b>) &amp;&amp; ((<span class="r864 r">flags</span> &amp; <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>) == <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>))
                {
                    <b>return</b> <b>default</b>(<span class="r861 r t">T</span>);
                }
                <b>else</b>
                {
                    <span class="r861 r t">T</span> <span id="r867 rd" class="r867 r">t</span> = (<span class="r861 r t">T</span>)<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r866 r">propertyValue</span>, <b>typeof</b>(<span class="r861 r t">T</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    <b>return</b> <span class="r867 r">t</span>;
                }
            }
        }
 
        <b>private static</b> <span class="r868 r t">TList</span> <a id="6e6d1f7cd3b91e53" href="../R/6e6d1f7cd3b91e53.html" target="n" data-glyph="76,1" class="i method">RehydrateList</a>&lt;<span id="r868 rd t" class="r868 r t">TList</span>, <span id="r869 rd t" class="r869 r t">TItem</span>&gt;(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r870 rd" class="r870 r">pso</span>, <b>string</b> <span id="r871 rd" class="r871 r">propertyName</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a> <span id="r872 rd" class="r872 r">flags</span>)
            <b>where</b> <span class="r868 r t">TList</span> : <span class="i">IList</span>, <b>new</b>()
        {
            <span class="i">ArrayList</span> <span id="r873 rd" class="r873 r">deserializedList</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<span class="i">ArrayList</span>&gt;(<span class="r870 r">pso</span>, <span class="r871 r">propertyName</span>, <span class="r872 r">flags</span>);
            <b>if</b> (<span class="r873 r">deserializedList</span> == <b>null</b>)
            {
                <b>if</b> ((<span class="r872 r">flags</span> &amp; <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#252bcdc8f903cf33" class="i field">NullValueMeansEmptyList</a>) == <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#252bcdc8f903cf33" class="i field">NullValueMeansEmptyList</a>)
                {
                    <b>return</b> <b>new</b> <span class="t">TList</span>();
                }
                <b>else</b>
                {
                    <b>return</b> <b>default</b>(<span class="r868 r t">TList</span>);
                }
            }
            <b>else</b>
            {
                <span class="r868 r t">TList</span> <span id="r874 rd" class="r874 r">newList</span> = <b>new</b> <span class="t">TList</span>();
                <b>foreach</b> (<b>object</b> <span id="r875 rd" class="r875 r">deserializedItem</span> <b>in</b> <span class="r873 r">deserializedList</span>)
                {
                    <span class="r869 r t">TItem</span> <span id="r876 rd" class="r876 r">item</span> = (<span class="r869 r t">TItem</span>)<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r875 r">deserializedItem</span>, <b>typeof</b>(<span class="r869 r t">TItem</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    <span class="r874 r">newList</span>.<span class="i">Add</span>(<span class="r876 r">item</span>);
                }
 
                <b>return</b> <span class="r874 r">newList</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Rehydration of miscellaneous types
 
        <b>private static object</b> <a id="5b30692383676c0a" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydratePrimitiveHashtable</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r877 rd" class="r877 r">pso</span>)
        {
            <span class="i">Hashtable</span> <span id="r878 rd" class="r878 r">hashtable</span> = (<span class="i">Hashtable</span>)<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r877 r">pso</span>, <b>typeof</b>(<span class="i">Hashtable</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            <b>return</b> <b>new</b> <a href="#728e9bd88978fac9" class="t constructor">PSPrimitiveDictionary</a>(<span class="r878 r">hashtable</span>);
        }
 
        <b>private static object</b> <a id="69ee498ffe396327" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateSwitchParameter</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r879 rd" class="r879 r">pso</span>)
        {
            <b>return</b> <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>&gt;(<span class="r879 r">pso</span>, <span class="s">&quot;IsPresent&quot;</span>);
        }
 
        <b>private static</b> <span class="i">CultureInfo</span> <a id="afef2986548059ca" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateCultureInfo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r880 rd" class="r880 r">pso</span>)
        {
            <b>string</b> <span id="r881 rd" class="r881 r">s</span> = <span class="r880 r">pso</span>.<a href="MshObject.cs.html#298666357e641f03" class="i method">ToString</a>();
            <b>return</b> <b>new</b> <span class="i">CultureInfo</span>(<span class="r881 r">s</span>);
        }
 
        <b>private static</b> <a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a> <a id="5c5f11306421a72d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydratePSListModifier</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r882 rd" class="r882 r">pso</span>)
        {
            <span class="i">Hashtable</span> <span id="r883 rd" class="r883 r">h</span> = <b>new</b> <span class="i">Hashtable</span>();
 
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r884 rd" class="r884 r">addProperty</span> = <span class="r882 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a>.<a href="hostifaces/ListModifier.cs.html#fed30b5a3c8fb0ca" class="i field">AddKey</a>];
            <b>if</b> ((<span class="r884 r">addProperty</span> != <b>null</b>) &amp;&amp; (<span class="r884 r">addProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>))
            {
                <span class="r883 r">h</span>.<span class="i">Add</span>(<a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a>.<a href="hostifaces/ListModifier.cs.html#fed30b5a3c8fb0ca" class="i field">AddKey</a>, <span class="r884 r">addProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
            }
 
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r885 rd" class="r885 r">removeProperty</span> = <span class="r882 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a>.<a href="hostifaces/ListModifier.cs.html#0d323f27bd5679f4" class="i field">RemoveKey</a>];
            <b>if</b> ((<span class="r885 r">removeProperty</span> != <b>null</b>) &amp;&amp; (<span class="r885 r">removeProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>))
            {
                <span class="r883 r">h</span>.<span class="i">Add</span>(<a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a>.<a href="hostifaces/ListModifier.cs.html#0d323f27bd5679f4" class="i field">RemoveKey</a>, <span class="r885 r">removeProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
            }
 
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r886 rd" class="r886 r">replaceProperty</span> = <span class="r882 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a>.<a href="hostifaces/ListModifier.cs.html#e3ec35ffe0f0a17e" class="i field">ReplaceKey</a>];
            <b>if</b> ((<span class="r886 r">replaceProperty</span> != <b>null</b>) &amp;&amp; (<span class="r886 r">replaceProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>))
            {
                <span class="r883 r">h</span>.<span class="i">Add</span>(<a href="hostifaces/ListModifier.cs.html#c1e57da97dcae456" class="t t">PSListModifier</a>.<a href="hostifaces/ListModifier.cs.html#e3ec35ffe0f0a17e" class="i field">ReplaceKey</a>, <span class="r886 r">replaceProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
            }
 
            <b>return</b> <b>new</b> <a href="hostifaces/ListModifier.cs.html#51f3c973d5f8454c" class="t constructor">PSListModifier</a>(<span class="r883 r">h</span>);
        }
 
        <b>private static</b> <a href="CommandCompletion/CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="74fc017c6ad39d4f" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateCompletionResult</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r887 rd" class="r887 r">pso</span>)
        {
            <b>string</b> <span id="r888 rd" class="r888 r">completionText</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r887 r">pso</span>, <span class="s">&quot;CompletionText&quot;</span>);
            <b>string</b> <span id="r889 rd" class="r889 r">listItemText</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r887 r">pso</span>, <span class="s">&quot;ListItemText&quot;</span>);
            <b>string</b> <span id="r890 rd" class="r890 r">toolTip</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r887 r">pso</span>, <span class="s">&quot;ToolTip&quot;</span>);
            <a href="CommandCompletion/CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a> <span id="r891 rd" class="r891 r">resultType</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="CommandCompletion/CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>&gt;(<span class="r887 r">pso</span>, <span class="s">&quot;ResultType&quot;</span>);
 
            <b>return</b> <b>new</b> <a href="CommandCompletion/CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r888 r">completionText</span>, <span class="r889 r">listItemText</span>, <span class="r891 r">resultType</span>, <span class="r890 r">toolTip</span>);
        }
 
        <b>private static</b> <a href="Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a> <a id="8a2c35beaf2469f4" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateModuleSpecification</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r892 rd" class="r892 r">pso</span>)
        {
            <b>return</b> <b>new</b> <a href="Modules/ModuleSpecification.cs.html#a06529b49cc6cb36" class="t constructor">ModuleSpecification</a>
            {
                <a href="Modules/ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r892 r">pso</span>, <span class="s">&quot;Name&quot;</span>),
                <a href="Modules/ModuleSpecification.cs.html#062a45e81a3542d6" class="i property">Guid</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">Guid</span>?&gt;(<span class="r892 r">pso</span>, <span class="s">&quot;Guid&quot;</span>),
                <a href="Modules/ModuleSpecification.cs.html#b7b161dc81e4fbe9" class="i property">Version</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">Version</span>&gt;(<span class="r892 r">pso</span>, <span class="s">&quot;Version&quot;</span>),
                <a href="Modules/ModuleSpecification.cs.html#7d051126154e5fa1" class="i property">MaximumVersion</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r892 r">pso</span>, <span class="s">&quot;MaximumVersion&quot;</span>),
                <a href="Modules/ModuleSpecification.cs.html#ad460cb887264b84" class="i property">RequiredVersion</a> =
                                                    <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">Version</span>&gt;(<span class="r892 r">pso</span>, <span class="s">&quot;RequiredVersion&quot;</span>)
            };
        }
 
        <b>private static</b> <a href="CommandCompletion/CommandCompletion.cs.html#a9d35cade4030f50" class="t t">CommandCompletion</a> <a id="122b6c1828bd94f4" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateCommandCompletion</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r893 rd" class="r893 r">pso</span>)
        {
            <b>var</b> <span id="r894 rd" class="r894 r">completions</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="CommandCompletion/CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>foreach</b> (<b>var</b> <span id="r895 rd" class="r895 r">match</span> <b>in</b> <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">ArrayList</span>&gt;(<span class="r893 r">pso</span>, <span class="s">&quot;CompletionMatches&quot;</span>))
            {
                <span class="r894 r">completions</span>.<span class="i">Add</span>((<a href="CommandCompletion/CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>)<span class="r895 r">match</span>);
            }
 
            <b>var</b> <span id="r896 rd" class="r896 r">currentMatchIndex</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r893 r">pso</span>, <span class="s">&quot;CurrentMatchIndex&quot;</span>);
            <b>var</b> <span id="r897 rd" class="r897 r">replacementIndex</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r893 r">pso</span>, <span class="s">&quot;ReplacementIndex&quot;</span>);
            <b>var</b> <span id="r898 rd" class="r898 r">replacementLength</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r893 r">pso</span>, <span class="s">&quot;ReplacementLength&quot;</span>);
            <b>return</b> <b>new</b> <a href="CommandCompletion/CommandCompletion.cs.html#5326ccdefb90b656" class="t constructor">CommandCompletion</a>(<span class="r894 r">completions</span>, <span class="r896 r">currentMatchIndex</span>, <span class="r897 r">replacementIndex</span>, <span class="r898 r">replacementLength</span>);
        }
 
        <b>private static</b> <a href="remoting/client/Job.cs.html#8f788812e1264af5" class="t t">JobStateInfo</a> <a id="eac87d7b886b61b5" href="../R/eac87d7b886b61b5.html" target="n" data-glyph="76,1" class="i method">RehydrateJobStateInfo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r899 rd" class="r899 r">pso</span>)
        {
            <a href="remoting/client/Job.cs.html#fac7cdff9aee3e4f" class="k">var</a> <span id="r900 rd" class="r900 r">jobState</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="remoting/client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>&gt;(<span class="r899 r">pso</span>, <span class="s">&quot;State&quot;</span>);
 
            <span class="i">Exception</span> <span id="r901 rd" class="r901 r">reason</span> = <b>null</b>;
            <b>object</b> <span id="r902 rd" class="r902 r">propertyValue</span> = <b>null</b>;
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r903 rd" class="r903 r">property</span> = <span class="r899 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Reason&quot;</span>];
            <b>string</b> <span id="r904 rd" class="r904 r">message</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r903 r">property</span> != <b>null</b>)
            {
                <span class="r902 r">propertyValue</span> = <span class="r903 r">property</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
            }
 
            <b>if</b> (<span class="r902 r">propertyValue</span> != <b>null</b>)
            {
                <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r902 r">propertyValue</span>, <b>typeof</b>(<span class="i">Exception</span>)))
                {
                    <span class="c">// if we have a deserialized remote or any other exception, use its message to construct</span>
                    <span class="c">// an exception</span>
                    <span class="r904 r">message</span> = <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r902 r">propertyValue</span>).<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Message&quot;</span>].<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> <b>as string</b>;
                }
                <b>else</b> <b>if</b> (<span class="r902 r">propertyValue</span> <b>is</b> <span class="i">Exception</span>)
                {
                    <span class="r901 r">reason</span> = (<span class="i">Exception</span>)<span class="r902 r">propertyValue</span>;
                }
                <b>else</b>
                {
                    <span class="r904 r">message</span> = <span class="r902 r">propertyValue</span>.<span class="i">ToString</span>();
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r904 r">message</span>))
                {
                    <b>try</b>
                    {
                        <span class="r901 r">reason</span> = (<span class="i">Exception</span>)<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r904 r">message</span>, <b>typeof</b>(<span class="i">Exception</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                        <span class="c">// it is ok to eat this exception since we do not want</span>
                        <span class="c">// rehydration to fail</span>
                        <span class="r901 r">reason</span> = <b>null</b>;
                    }
                }
            }
 
            <b>return</b> <b>new</b> <a href="remoting/client/Job.cs.html#c9b5221f53e16cd6" class="t constructor">JobStateInfo</a>(<span class="r900 r">jobState</span>, <span class="r901 r">reason</span>);
        }
 
        <b>internal static</b> <a href="remoting/client/Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <a id="ad9bb3a357f5b3f1" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateJobStateEventArgs</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r905 rd" class="r905 r">pso</span>)
        {
            <a href="remoting/client/Job.cs.html#8f788812e1264af5" class="k">var</a> <span id="r906 rd" class="r906 r">jobStateInfo</span> = <a href="#eac87d7b886b61b5" class="i method">RehydrateJobStateInfo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r905 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;JobStateInfo&quot;</span>].<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>));
            <a href="remoting/client/Job.cs.html#8f788812e1264af5" class="t t">JobStateInfo</a> <span id="r907 rd" class="r907 r">previousJobStateInfo</span> = <b>null</b>;
            <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="k">var</a> <span id="r908 rd" class="r908 r">previousJobStateInfoProperty</span> = <span class="r905 r">pso</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;PreviousJobStateInfo&quot;</span>];
 
            <b>if</b> (<span class="r908 r">previousJobStateInfoProperty</span> != <b>null</b> &amp;&amp; <span class="r908 r">previousJobStateInfoProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>)
            {
                <span class="r907 r">previousJobStateInfo</span> = <a href="#eac87d7b886b61b5" class="i method">RehydrateJobStateInfo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r908 r">previousJobStateInfoProperty</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>));
            }
 
            <b>return</b> <b>new</b> <a href="remoting/client/Job.cs.html#18e6fc44c599c11a" class="t constructor">JobStateEventArgs</a>(<span class="r906 r">jobStateInfo</span>, <span class="r907 r">previousJobStateInfo</span>);
        }
 
        <b>internal static</b> <a href="remoting/commands/PSRemotingCmdlet.cs.html#8626ee928362b305" class="t t">PSSessionOption</a> <a id="4e806593a2f1c155" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydratePSSessionOption</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r909 rd" class="r909 r">pso</span>)
        {
            <a href="remoting/commands/PSRemotingCmdlet.cs.html#8626ee928362b305" class="t t">PSSessionOption</a> <span id="r910 rd" class="r910 r">option</span> = <b>new</b> <a href="remoting/commands/PSRemotingCmdlet.cs.html#90c789cd47314cbe" class="t constructor">PSSessionOption</a>();
 
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#e85ec0b1616d3e82" class="i property">ApplicationArguments</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;ApplicationArguments&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#b5da140f3b9891e8" class="i property">CancelTimeout</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">TimeSpan</span>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;CancelTimeout&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#6c50153de319204f" class="i property">Culture</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">CultureInfo</span>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;Culture&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#42111d69f31e90b0" class="i property">IdleTimeout</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">TimeSpan</span>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;IdleTimeout&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#28f392672e3eb863" class="i property">MaximumConnectionRedirectionCount</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;MaximumConnectionRedirectionCount&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#fad12c194ba02bac" class="i property">MaximumReceivedDataSizePerCommand</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>?&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;MaximumReceivedDataSizePerCommand&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#0587b36e63bc9ed4" class="i property">MaximumReceivedObjectSize</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>?&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;MaximumReceivedObjectSize&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#4da96a141e629777" class="i property">NoCompression</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;NoCompression&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#a684dcf48d8b8d3a" class="i property">NoEncryption</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;NoEncryption&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#fc82bbd8845feda4" class="i property">NoMachineProfile</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;NoMachineProfile&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#9a175c6e14dd145c" class="i property">OpenTimeout</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">TimeSpan</span>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;OpenTimeout&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#1c7eb8442453b9b7" class="i property">OperationTimeout</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">TimeSpan</span>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;OperationTimeout&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#0a36421122250739" class="i property">OutputBufferingMode</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="remoting/common/RunspaceConnectionInfo.cs.html#9cb40ac520a09a1d" class="t t">OutputBufferingMode</a>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;OutputBufferingMode&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#0da743e6d3ee732d" class="i property">MaxConnectionRetryCount</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;MaxConnectionRetryCount&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#bf46cf340b00816f" class="i property">ProxyAccessType</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="remoting/commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;ProxyAccessType&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#fffb36093e5ccf4f" class="i property">ProxyAuthentication</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="remoting/common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;ProxyAuthentication&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#7be1964b0ead807f" class="i property">ProxyCredential</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;ProxyCredential&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#eb570bd42a230549" class="i property">SkipCACheck</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;SkipCACheck&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#a8cc5d801c0dd2dd" class="i property">SkipCNCheck</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;SkipCNCheck&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#9861329a549ae83a" class="i property">SkipRevocationCheck</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;SkipRevocationCheck&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#17de5256f95a13f0" class="i property">UICulture</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">CultureInfo</span>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;UICulture&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#b584449b5c4b13fb" class="i property">UseUTF16</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;UseUTF16&quot;</span>);
            <span class="r910 r">option</span>.<a href="remoting/commands/PSRemotingCmdlet.cs.html#21aa0b34dea85206" class="i property">IncludePortInSPN</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r909 r">pso</span>, <span class="s">&quot;IncludePortInSPN&quot;</span>);
 
            <b>return</b> <span class="r910 r">option</span>;
        }
 
        <b>internal static</b> <a href="debugger/Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="b9d766f4b3c4b8c3" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateLineBreakpoint</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r911 rd" class="r911 r">pso</span>)
        {
            <b>string</b> <span id="r912 rd" class="r912 r">script</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r911 r">pso</span>, <span class="s">&quot;Script&quot;</span>);
            <b>int</b> <span id="r913 rd" class="r913 r">line</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r911 r">pso</span>, <span class="s">&quot;Line&quot;</span>);
            <b>int</b> <span id="r914 rd" class="r914 r">column</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r911 r">pso</span>, <span class="s">&quot;Column&quot;</span>);
            <b>int</b> <span id="r915 rd" class="r915 r">id</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r911 r">pso</span>, <span class="s">&quot;Id&quot;</span>);
            <b>bool</b> <span id="r916 rd" class="r916 r">enabled</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r911 r">pso</span>, <span class="s">&quot;Enabled&quot;</span>);
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r917 rd" class="r917 r">action</span> = <a href="#d320f798513d652e" class="i method">RehydrateScriptBlock</a>(
                <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r911 r">pso</span>, <span class="s">&quot;Action&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>));
 
            <a href="debugger/Breakpoint.cs.html#8289c87b2cf2e5fd" class="k">var</a> <span id="r918 rd" class="r918 r">bp</span> = <b>new</b> <a href="debugger/Breakpoint.cs.html#7352e9e0a80a7686" class="t constructor">LineBreakpoint</a>(<span class="r912 r">script</span>, <span class="r913 r">line</span>, <span class="r914 r">column</span>, <span class="r917 r">action</span>, <span class="r915 r">id</span>);
            <span class="r918 r">bp</span>.<a href="debugger/Breakpoint.cs.html#cdff320c74cd3408" class="i method">SetEnabled</a>(<span class="r916 r">enabled</span>);
            <b>return</b> <span class="r918 r">bp</span>;
        }
 
        <b>internal static</b> <a href="debugger/Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="db1b0f300b607342" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateCommandBreakpoint</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r919 rd" class="r919 r">pso</span>)
        {
            <b>string</b> <span id="r920 rd" class="r920 r">script</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r919 r">pso</span>, <span class="s">&quot;Script&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a> | <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>);
            <b>string</b> <span id="r921 rd" class="r921 r">command</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r919 r">pso</span>, <span class="s">&quot;Command&quot;</span>);
            <b>int</b> <span id="r922 rd" class="r922 r">id</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r919 r">pso</span>, <span class="s">&quot;Id&quot;</span>);
            <b>bool</b> <span id="r923 rd" class="r923 r">enabled</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r919 r">pso</span>, <span class="s">&quot;Enabled&quot;</span>);
            <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r924 rd" class="r924 r">pattern</span> = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r921 r">command</span>, <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#e7978967739ff542" class="i field">Compiled</a> | <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r925 rd" class="r925 r">action</span> = <a href="#d320f798513d652e" class="i method">RehydrateScriptBlock</a>(
                <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r919 r">pso</span>, <span class="s">&quot;Action&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>));
 
            <a href="debugger/Breakpoint.cs.html#36af4b04ff98769a" class="k">var</a> <span id="r926 rd" class="r926 r">bp</span> = <b>new</b> <a href="debugger/Breakpoint.cs.html#9ac230921fe4106c" class="t constructor">CommandBreakpoint</a>(<span class="r920 r">script</span>, <span class="r924 r">pattern</span>, <span class="r921 r">command</span>, <span class="r925 r">action</span>, <span class="r922 r">id</span>);
            <span class="r926 r">bp</span>.<a href="debugger/Breakpoint.cs.html#cdff320c74cd3408" class="i method">SetEnabled</a>(<span class="r923 r">enabled</span>);
            <b>return</b> <span class="r926 r">bp</span>;
        }
 
        <b>internal static</b> <a href="debugger/Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="28d44ddf53ceac1b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateVariableBreakpoint</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r927 rd" class="r927 r">pso</span>)
        {
            <b>string</b> <span id="r928 rd" class="r928 r">script</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r927 r">pso</span>, <span class="s">&quot;Script&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a> | <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>);
            <b>string</b> <span id="r929 rd" class="r929 r">variableName</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r927 r">pso</span>, <span class="s">&quot;Variable&quot;</span>);
            <b>int</b> <span id="r930 rd" class="r930 r">id</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r927 r">pso</span>, <span class="s">&quot;Id&quot;</span>);
            <b>bool</b> <span id="r931 rd" class="r931 r">enabled</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r927 r">pso</span>, <span class="s">&quot;Enabled&quot;</span>);
            <a href="debugger/Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a> <span id="r932 rd" class="r932 r">access</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="debugger/Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a>&gt;(<span class="r927 r">pso</span>, <span class="s">&quot;AccessMode&quot;</span>);
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r933 rd" class="r933 r">action</span> = <a href="#d320f798513d652e" class="i method">RehydrateScriptBlock</a>(
                <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r927 r">pso</span>, <span class="s">&quot;Action&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>));
 
            <a href="debugger/Breakpoint.cs.html#939ec0f40914ad61" class="k">var</a> <span id="r934 rd" class="r934 r">bp</span> = <b>new</b> <a href="debugger/Breakpoint.cs.html#e0501e72fdb08611" class="t constructor">VariableBreakpoint</a>(<span class="r928 r">script</span>, <span class="r929 r">variableName</span>, <span class="r932 r">access</span>, <span class="r933 r">action</span>, <span class="r930 r">id</span>);
            <span class="r934 r">bp</span>.<a href="debugger/Breakpoint.cs.html#cdff320c74cd3408" class="i method">SetEnabled</a>(<span class="r931 r">enabled</span>);
            <b>return</b> <span class="r934 r">bp</span>;
        }
 
        <b>internal static</b> <a href="debugger/debugger.cs.html#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a> <a id="1b902eefd28e4654" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateBreakpointUpdatedEventArgs</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r935 rd" class="r935 r">pso</span>)
        {
            <a href="debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r936 rd" class="r936 r">bp</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<span class="r935 r">pso</span>, <span class="s">&quot;Breakpoint&quot;</span>);
            <a href="debugger/debugger.cs.html#7f495a71915b9312" class="t t">BreakpointUpdateType</a> <span id="r937 rd" class="r937 r">bpUpdateType</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="debugger/debugger.cs.html#7f495a71915b9312" class="t t">BreakpointUpdateType</a>&gt;(<span class="r935 r">pso</span>, <span class="s">&quot;UpdateType&quot;</span>);
            <b>int</b> <span id="r938 rd" class="r938 r">bpCount</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r935 r">pso</span>, <span class="s">&quot;BreakpointCount&quot;</span>);
 
            <b>return</b> <b>new</b> <a href="debugger/debugger.cs.html#af659be6c5f84358" class="t constructor">BreakpointUpdatedEventArgs</a>(<span class="r936 r">bp</span>, <span class="r937 r">bpUpdateType</span>, <span class="r938 r">bpCount</span>);
        }
 
        <b>internal static</b> <a href="debugger/debugger.cs.html#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="056e1207e18aee62" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateDebuggerCommand</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r939 rd" class="r939 r">pso</span>)
        {
            <b>string</b> <span id="r940 rd" class="r940 r">command</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r939 r">pso</span>, <span class="s">&quot;Command&quot;</span>);
            <b>bool</b> <span id="r941 rd" class="r941 r">repeatOnEnter</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r939 r">pso</span>, <span class="s">&quot;RepeatOnEnter&quot;</span>);
            <b>bool</b> <span id="r942 rd" class="r942 r">executedByDebugger</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r939 r">pso</span>, <span class="s">&quot;ExecutedByDebugger&quot;</span>);
            <a href="debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a>? <span id="r943 rd" class="r943 r">resumeAction</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a>?&gt;(<span class="r939 r">pso</span>, <span class="s">&quot;ResumeAction&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>);
 
            <b>return</b> <b>new</b> <a href="debugger/debugger.cs.html#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<span class="r940 r">command</span>, <span class="r943 r">resumeAction</span>, <span class="r941 r">repeatOnEnter</span>, <span class="r942 r">executedByDebugger</span>);
        }
 
        <b>internal static</b> <a href="debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="2a2d548e787dafeb" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateDebuggerCommandResults</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r944 rd" class="r944 r">pso</span>)
        {
            <a href="debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a>? <span id="r945 rd" class="r945 r">resumeAction</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a>?&gt;(<span class="r944 r">pso</span>, <span class="s">&quot;ResumeAction&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>);
            <b>bool</b> <span id="r946 rd" class="r946 r">evaluatedByDebugger</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r944 r">pso</span>, <span class="s">&quot;EvaluatedByDebugger&quot;</span>);
 
            <b>return</b> <b>new</b> <a href="debugger/debugger.cs.html#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<span class="r945 r">resumeAction</span>, <span class="r946 r">evaluatedByDebugger</span>);
        }
 
        <b>internal static</b> <a href="debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <a id="270e62d12ef84fc0" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">RehydrateDebuggerStopEventArgs</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r947 rd" class="r947 r">pso</span>)
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r948 rd" class="r948 r">psoInvocationInfo</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r947 r">pso</span>, <span class="s">&quot;SerializedInvocationInfo&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a> | <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
            <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r949 rd" class="r949 r">invocationInfo</span> = (<span class="r948 r">psoInvocationInfo</span> != <b>null</b>) ? <b>new</b> <a href="InvocationInfo.cs.html#4817611dedebd2b0" class="t constructor">InvocationInfo</a>(<span class="r948 r">psoInvocationInfo</span>) : <b>null</b>;
            <a href="debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r950 rd" class="r950 r">resumeAction</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a>&gt;(<span class="r947 r">pso</span>, <span class="s">&quot;ResumeAction&quot;</span>);
            <span class="i">Collection</span>&lt;<a href="debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r951 rd" class="r951 r">breakpoints</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;();
            <b>foreach</b> (<b>var</b> <span id="r952 rd" class="r952 r">item</span> <b>in</b> <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">ArrayList</span>&gt;(<span class="r947 r">pso</span>, <span class="s">&quot;Breakpoints&quot;</span>))
            {
                <a href="debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r953 rd" class="r953 r">bp</span> = <span class="r952 r">item</span> <b>as</b> <a href="debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>;
                <b>if</b> (<span class="r953 r">bp</span> != <b>null</b>)
                {
                    <span class="r951 r">breakpoints</span>.<span class="i">Add</span>(<span class="r953 r">bp</span>);
                }
            }
 
            <b>return</b> <b>new</b> <a href="debugger/debugger.cs.html#7ac766b9a835f3a6" class="t constructor">DebuggerStopEventArgs</a>(<span class="r949 r">invocationInfo</span>, <span class="r951 r">breakpoints</span>, <span class="r950 r">resumeAction</span>);
        }
 
        <b>private static</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="d320f798513d652e" href="../R/d320f798513d652e.html" target="n" data-glyph="76,1" class="i method">RehydrateScriptBlock</a>(<b>string</b> <span id="r954 rd" class="r954 r">script</span>)
        {
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r954 r">script</span>))
            {
                <b>return</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="lang/scriptblock.cs.html#adfac0fa7bf5725f" class="i method">Create</a>(<span class="r954 r">script</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Rehydration of security-related types
 
        <b>private static</b> <a href="Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="72c5717dbb05b01d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydratePSCredential</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r955 rd" class="r955 r">pso</span>)
        {
            <b>string</b> <span id="r956 rd" class="r956 r">userName</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r955 r">pso</span>, <span class="s">&quot;UserName&quot;</span>);
            <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecureString</span> <span id="r957 rd" class="r957 r">password</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecureString</span>&gt;(<span class="r955 r">pso</span>, <span class="s">&quot;Password&quot;</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r956 r">userName</span>))
            {
                <b>return</b> <a href="Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a>.<a href="Credential.cs.html#8c5314944c80f8ac" class="i property">Empty</a>;
            }
            <b>else</b>
            {
                <b>return</b> <b>new</b> <span class="t">PSCredential</span>(<span class="r956 r">userName</span>, <span class="r957 r">password</span>);
            }
        }
 
        <b>internal static</b> <a href="remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a> <a id="55391c9759698adf" href="../R/55391c9759698adf.html" target="n" data-glyph="74,1" class="i method">RehydratePSSenderInfo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r958 rd" class="r958 r">pso</span>)
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r959 rd" class="r959 r">userInfo</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r958 r">pso</span>, <span class="s">&quot;UserInfo&quot;</span>);
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r960 rd" class="r960 r">userIdentity</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r959 r">userInfo</span>, <span class="s">&quot;Identity&quot;</span>);
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r961 rd" class="r961 r">certDetails</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r960 r">userIdentity</span>, <span class="s">&quot;CertificateDetails&quot;</span>);
 
            <a href="remoting/fanin/PSPrincipal.cs.html#51c78fc6fd1d052d" class="t t">PSCertificateDetails</a> <span id="r962 rd" class="r962 r">psCertDetails</span> = <span class="r961 r">certDetails</span> == <b>null</b> ? <b>null</b> : <b>new</b> <a href="remoting/fanin/PSPrincipal.cs.html#14df078d42c823bc" class="t constructor">PSCertificateDetails</a>(
                <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r961 r">certDetails</span>, <span class="s">&quot;Subject&quot;</span>),
                <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r961 r">certDetails</span>, <span class="s">&quot;IssuerName&quot;</span>),
                <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r961 r">certDetails</span>, <span class="s">&quot;IssuerThumbprint&quot;</span>));
            <a href="remoting/fanin/PSPrincipal.cs.html#39528f52ff89f7c2" class="t t">PSIdentity</a> <span id="r963 rd" class="r963 r">psIdentity</span> = <b>new</b> <a href="remoting/fanin/PSPrincipal.cs.html#3c9c1564875caeb1" class="t constructor">PSIdentity</a>(
                <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r960 r">userIdentity</span>, <span class="s">&quot;AuthenticationType&quot;</span>),
                <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r960 r">userIdentity</span>, <span class="s">&quot;IsAuthenticated&quot;</span>),
                <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r960 r">userIdentity</span>, <span class="s">&quot;Name&quot;</span>),
                <span class="r962 r">psCertDetails</span>);
            <a href="remoting/fanin/PSPrincipal.cs.html#f38f79fd26abc753" class="t t">PSPrincipal</a> <span id="r964 rd" class="r964 r">psPrincipal</span> = <b>new</b> <span class="t">PSPrincipal</span>(<span class="r963 r">psIdentity</span>, <span class="i">WindowsIdentity</span>.<span class="i">GetCurrent</span>());
 
            <a href="remoting/fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a> <span id="r965 rd" class="r965 r">senderInfo</span> = <b>new</b> <a href="remoting/fanin/PSPrincipal.cs.html#041d397e8ed43c11" class="t constructor">PSSenderInfo</a>(<span class="r964 r">psPrincipal</span>, <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r958 r">pso</span>, <span class="s">&quot;ConnectionString&quot;</span>));
 
            <span class="r965 r">senderInfo</span>.<a href="remoting/fanin/PSPrincipal.cs.html#c495b1f3e6e5123e" class="i property">ClientTimeZone</a> = <span class="i">TimeZoneInfo</span>.<span class="i">Local</span>;
            <span class="r965 r">senderInfo</span>.<a href="remoting/fanin/PSPrincipal.cs.html#fbb9c1201251c818" class="i property">ApplicationArguments</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>&gt;(<span class="r958 r">pso</span>, <span class="s">&quot;ApplicationArguments&quot;</span>);
 
            <b>return</b> <span class="r965 r">senderInfo</span>;
        }
 
        <b>private static</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>.<span class="i">X509Certificate2</span> <a id="575b4fa791fedd72" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateX509Certificate2</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r966 rd" class="r966 r">pso</span>)
        {
            <b>byte</b>[] <span id="r967 rd" class="r967 r">rawData</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>byte</b>[]&gt;(<span class="r966 r">pso</span>, <span class="s">&quot;RawData&quot;</span>);
            <b>return</b> <b>new</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>.<span class="i">X509Certificate2</span>(<span class="r967 r">rawData</span>);
        }
 
        <b>private static</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>.<span class="i">X500DistinguishedName</span> <a id="0026aabb19921698" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateX500DistinguishedName</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r968 rd" class="r968 r">pso</span>)
        {
            <b>byte</b>[] <span id="r969 rd" class="r969 r">rawData</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>byte</b>[]&gt;(<span class="r968 r">pso</span>, <span class="s">&quot;RawData&quot;</span>);
            <b>return</b> <b>new</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>.<span class="i">X509Certificates</span>.<span class="i">X500DistinguishedName</span>(<span class="r969 r">rawData</span>);
        }
 
        <b>private static</b> <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">IPAddress</span> <a id="a637d75dfc0a799b" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateIPAddress</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r970 rd" class="r970 r">pso</span>)
        {
            <b>string</b> <span id="r971 rd" class="r971 r">s</span> = <span class="r970 r">pso</span>.<a href="MshObject.cs.html#298666357e641f03" class="i method">ToString</a>();
            <b>return</b> <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">IPAddress</span>.<span class="i">Parse</span>(<span class="r971 r">s</span>);
        }
 
        <b>private static</b> <span class="i">MailAddress</span> <a id="5e76d4ad2271cf02" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateMailAddress</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r972 rd" class="r972 r">pso</span>)
        {
            <b>string</b> <span id="r973 rd" class="r973 r">s</span> = <span class="r972 r">pso</span>.<a href="MshObject.cs.html#298666357e641f03" class="i method">ToString</a>();
            <b>return</b> <b>new</b> <span class="i">MailAddress</span>(<span class="r973 r">s</span>);
        }
 
        <b>private static</b> <span class="r974 r t">T</span> <a id="883d4d9068acb525" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateObjectSecurity</a>&lt;<span id="r974 rd t" class="r974 r t">T</span>&gt;(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r975 rd" class="r975 r">pso</span>)
            <b>where</b> <span class="r974 r t">T</span> : <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>.<span class="i">ObjectSecurity</span>, <b>new</b>()
        {
            <b>string</b> <span id="r976 rd" class="r976 r">sddl</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r975 r">pso</span>, <span class="s">&quot;SDDL&quot;</span>);
 
            <span class="r974 r t">T</span> <span id="r977 rd" class="r977 r">t</span> = <b>new</b> <span class="t">T</span>();
            <span class="r977 r">t</span>.<span class="i">SetSecurityDescriptorSddlForm</span>(<span class="r976 r">sddl</span>);
            <b>return</b> <span class="r977 r">t</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Rehydration of types needed by implicit remoting
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the boolean properties of ParameterSetMetadata object encoded as an integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r978 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSObject for which to obtain the flags</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Boolean properties of ParameterSetMetadata object encoded as an integer</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">UInt32</span> <a id="b35a5c3be80c86ca" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetParameterSetMetadataFlags</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r978 rd" class="r978 r">instance</span>)
        {
            <b>if</b> (<span class="r978 r">instance</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r978 r">instance</span>));
            }
 
            <b>if</b> (!(<span class="r978 r">instance</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a> <span id="r979 rd" class="r979 r">parameterSetMetadata</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r978 r">instance</span>));
            }
 
            <b>return</b> (<span class="i">UInt32</span>)(<span class="r979 r">parameterSetMetadata</span>.<a href="TypeMetadata.cs.html#2bcc204c02219a15" class="i property">Flags</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the full remoting serialized PSObject for the InvocationInfo property</span>
        <span class="c">///</span><span class="c"> of the DebuggerStopEventArgs type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r980 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">InvocationInfo instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PSObject containing serialized InvocationInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="7230db132410f78b" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetInvocationInfo</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r980 rd" class="r980 r">instance</span>)
        {
            <b>if</b> (<span class="r980 r">instance</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r980 r">instance</span>));
            }
 
            <b>if</b> (!(<span class="r980 r">instance</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r981 rd" class="r981 r">dbgStopEventArgs</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r980 r">instance</span>));
            }
 
            <b>if</b> (<span class="r981 r">dbgStopEventArgs</span>.<a href="debugger/debugger.cs.html#bf5b2fd8de78c287" class="i property">InvocationInfo</a> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r982 rd" class="r982 r">psoInvocationInfo</span> = <b>new</b> <a href="MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
            <span class="r981 r">dbgStopEventArgs</span>.<a href="debugger/debugger.cs.html#bf5b2fd8de78c287" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#a046fd5ea44698d2" class="i method">ToPSObjectForRemoting</a>(<span class="r982 r">psoInvocationInfo</span>);
            <b>return</b> <span class="r982 r">psoInvocationInfo</span>;
        }
 
        <b>private static</b> <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a> <a id="b2ef1aa00575d06e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateParameterSetMetadata</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r983 rd" class="r983 r">pso</span>)
        {
            <b>int</b> <span id="r984 rd" class="r984 r">position</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r983 r">pso</span>, <span class="s">&quot;Position&quot;</span>);
            <span class="i">UInt32</span> <span id="r985 rd" class="r985 r">flags</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">UInt32</span>&gt;(<span class="r983 r">pso</span>, <span class="s">&quot;Flags&quot;</span>);
            <b>string</b> <span id="r986 rd" class="r986 r">helpMessage</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r983 r">pso</span>, <span class="s">&quot;HelpMessage&quot;</span>);
            <b>return</b> <b>new</b> <a href="TypeMetadata.cs.html#7058f55e15034cae" class="t constructor">ParameterSetMetadata</a>(<span class="r984 r">position</span>, (<a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>.<a href="TypeMetadata.cs.html#6a4c3e1acdb95960" class="t t">ParameterFlags</a>)<span class="r985 r">flags</span>, <span class="r986 r">helpMessage</span>);
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a> <a id="2d8445bb6e680f1e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateDisplayEntry</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r987 rd" class="r987 r">deserializedDisplayEntry</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="k">var</a> <span id="r988 rd" class="r988 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#289486cf809dcf69" class="t constructor">DisplayEntry</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#96a5a26c84c885b2" class="i property">Value</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r987 r">deserializedDisplayEntry</span>, <span class="s">&quot;Value&quot;</span>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3f8798835111f4f6" class="i property">ValueType</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#2f044210ced40398" class="t t">DisplayEntryValueType</a>&gt;(<span class="r987 r">deserializedDisplayEntry</span>, <span class="s">&quot;ValueType&quot;</span>)
            };
            <b>return</b> <span class="r988 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a> <a id="e82220d670889dee" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateEntrySelectedBy</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r989 rd" class="r989 r">deserializedEsb</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="k">var</a> <span id="r990 rd" class="r990 r">result</span> = <b>new</b> <span class="t">EntrySelectedBy</span>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#cd692e73c9519ed6" class="i property">TypeNames</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<b>string</b>&gt;, <b>string</b>&gt;(<span class="r989 r">deserializedEsb</span>, <span class="s">&quot;TypeNames&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f6e5a365f98e421c" class="i property">SelectionCondition</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r989 r">deserializedEsb</span>, <span class="s">&quot;SelectionCondition&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>)
            };
            <b>return</b> <span class="r990 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#ab1e040d09a19665" class="t t">WideControlEntryItem</a> <a id="ad63e10b3c10fb6a" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateWideControlEntryItem</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r991 rd" class="r991 r">deserializedEntryItem</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="k">var</a> <span id="r992 rd" class="r992 r">entrySelectedBy</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a>&gt;(<span class="r991 r">deserializedEntryItem</span>, <span class="s">&quot;EntrySelectedBy&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
            <b>if</b> (<span class="r992 r">entrySelectedBy</span> == <b>null</b>)
            {
                <b>var</b> <span id="r993 rd" class="r993 r">selectedBy</span> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<b>string</b>&gt;, <b>string</b>&gt;(<span class="r991 r">deserializedEntryItem</span>, <span class="s">&quot;SelectedBy&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
                <span class="r992 r">entrySelectedBy</span> = <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a>.<span class="i">Get</span>(<span class="r993 r">selectedBy</span>, <b>null</b>);
            }
 
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#ab1e040d09a19665" class="k">var</a> <span id="r994 rd" class="r994 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#7ede8b289f0aadf0" class="t constructor">WideControlEntryItem</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#946f08dc9f355afd" class="i property">DisplayEntry</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r991 r">deserializedEntryItem</span>, <span class="s">&quot;DisplayEntry&quot;</span>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#5e3dd1099dddc6fb" class="i property">EntrySelectedBy</a> = <span class="r992 r">entrySelectedBy</span>,
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#c40b4537d783b1e3" class="i property">FormatString</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r991 r">deserializedEntryItem</span>, <span class="s">&quot;FormatString&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
            };
            <b>return</b> <span class="r994 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#d0834c53815ad342" class="t t">ListControlEntryItem</a> <a id="d9216a78594a6b16" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateListControlEntryItem</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r995 rd" class="r995 r">deserializedEntryItem</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#d0834c53815ad342" class="k">var</a> <span id="r996 rd" class="r996 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#13f443272cecb45c" class="t constructor">ListControlEntryItem</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#e69e05bde3391bf8" class="i property">DisplayEntry</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r995 r">deserializedEntryItem</span>, <span class="s">&quot;DisplayEntry&quot;</span>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#30ea198bd95c1f36" class="i property">ItemSelectionCondition</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r995 r">deserializedEntryItem</span>, <span class="s">&quot;ItemSelectionCondition&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#40dd9a776021a410" class="i property">FormatString</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r995 r">deserializedEntryItem</span>, <span class="s">&quot;FormatString&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#93e69304e03a2437" class="i property">Label</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r995 r">deserializedEntryItem</span>, <span class="s">&quot;Label&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>)
            };
            <b>return</b> <span class="r996 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#e4f4c1fbd5d6efe8" class="t t">ListControlEntry</a> <a id="39e256be852d2453" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateListControlEntry</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r997 rd" class="r997 r">deserializedEntry</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="k">var</a> <span id="r998 rd" class="r998 r">entrySelectedBy</span> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a>&gt;(<span class="r997 r">deserializedEntry</span>, <span class="s">&quot;EntrySelectedBy&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
            <b>if</b> (<span class="r998 r">entrySelectedBy</span> == <b>null</b>)
            {
                <b>var</b> <span id="r999 rd" class="r999 r">selectedBy</span> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<b>string</b>&gt;, <b>string</b>&gt;(<span class="r997 r">deserializedEntry</span>, <span class="s">&quot;SelectedBy&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
                <span class="r998 r">entrySelectedBy</span> = <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a>.<span class="i">Get</span>(<span class="r999 r">selectedBy</span>, <b>null</b>);
            }
 
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#e4f4c1fbd5d6efe8" class="k">var</a> <span id="r1000 rd" class="r1000 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#55616ac934b4cbca" class="t constructor">ListControlEntry</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#c10497e464c8461a" class="i property">Items</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#d0834c53815ad342" class="t t">ListControlEntryItem</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#d0834c53815ad342" class="t t">ListControlEntryItem</a>&gt;(<span class="r997 r">deserializedEntry</span>, <span class="s">&quot;Items&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#ab619676685153e0" class="i property">EntrySelectedBy</a> = <span class="r998 r">entrySelectedBy</span>
            };
            <b>return</b> <span class="r1000 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#8de7b62acebc6e04" class="t t">TableControlColumnHeader</a> <a id="70d61b567d5c9b83" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateTableControlColumnHeader</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1001 rd" class="r1001 r">deserializedHeader</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#8de7b62acebc6e04" class="k">var</a> <span id="r1002 rd" class="r1002 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#d5d52c657a55c869" class="t constructor">TableControlColumnHeader</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#9fae49121f8122e5" class="i property">Alignment</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#5d5d9c04f517dc20" class="t t">Alignment</a>&gt;(<span class="r1001 r">deserializedHeader</span>, <span class="s">&quot;Alignment&quot;</span>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#93830a3c616efeb1" class="i property">Label</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r1001 r">deserializedHeader</span>, <span class="s">&quot;Label&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#3aed1911459539e0" class="i property">Width</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r1001 r">deserializedHeader</span>, <span class="s">&quot;Width&quot;</span>)
            };
            <b>return</b> <span class="r1002 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#e171f7796c952fb2" class="t t">TableControlColumn</a> <a id="465be04657236177" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateTableControlColumn</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1003 rd" class="r1003 r">deserializedColumn</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#e171f7796c952fb2" class="k">var</a> <span id="r1004 rd" class="r1004 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#9a1c34d78d39ed91" class="t constructor">TableControlColumn</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#b2de72aba7f19508" class="i property">Alignment</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#5d5d9c04f517dc20" class="t t">Alignment</a>&gt;(<span class="r1003 r">deserializedColumn</span>, <span class="s">&quot;Alignment&quot;</span>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#463718fcd69927ea" class="i property">DisplayEntry</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r1003 r">deserializedColumn</span>, <span class="s">&quot;DisplayEntry&quot;</span>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#4b5874e23c64d0bf" class="i property">FormatString</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r1003 r">deserializedColumn</span>, <span class="s">&quot;FormatString&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>)
            };
            <b>return</b> <span class="r1004 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#c9bb940410c81f0f" class="t t">TableControlRow</a> <a id="8ff2e8d2f56abb3d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateTableControlRow</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1005 rd" class="r1005 r">deserializedRow</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#c9bb940410c81f0f" class="k">var</a> <span id="r1006 rd" class="r1006 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#bc59c4ca019064f1" class="t constructor">TableControlRow</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#8be9232743b53353" class="i property">Wrap</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r1005 r">deserializedRow</span>, <span class="s">&quot;Wrap&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#b52d7269e2906737" class="i property">SelectedBy</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a>&gt;(<span class="r1005 r">deserializedRow</span>, <span class="s">&quot;EntrySelectedBy&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#0f5b11944f6bcfcd" class="i property">Columns</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#e171f7796c952fb2" class="t t">TableControlColumn</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#e171f7796c952fb2" class="t t">TableControlColumn</a>&gt;(<span class="r1005 r">deserializedRow</span>, <span class="s">&quot;Columns&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>)
            };
            <b>return</b> <span class="r1006 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#a7c2e8cb994c8339" class="t t">CustomControlEntry</a> <a id="52290139db74a7e6" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateCustomControlEntry</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1007 rd" class="r1007 r">deserializedEntry</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#a7c2e8cb994c8339" class="k">var</a> <span id="r1008 rd" class="r1008 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#b336f971051b021c" class="t constructor">CustomControlEntry</a>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#f49790bf8be7823b" class="i property">CustomItems</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c0bc0eb3b8fe54ed" class="t t">CustomItemBase</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c0bc0eb3b8fe54ed" class="t t">CustomItemBase</a>&gt;(<span class="r1007 r">deserializedEntry</span>, <span class="s">&quot;CustomItems&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#dbcc1be4601a7e29" class="i field">MissingPropertyBad</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#859f4591a1f37fa9" class="i property">SelectedBy</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3481adc3de670f93" class="t t">EntrySelectedBy</a>&gt;(<span class="r1007 r">deserializedEntry</span>, <span class="s">&quot;SelectedBy&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>)
            };
            <b>return</b> <span class="r1008 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c0bc0eb3b8fe54ed" class="t t">CustomItemBase</a> <a id="49a448b0f3119eb7" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateCustomItemBase</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1009 rd" class="r1009 r">deserializedItem</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c0bc0eb3b8fe54ed" class="t t">CustomItemBase</a> <span id="r1010 rd" class="r1010 r">result</span>;
 
            <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1009 r">deserializedItem</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#52a96854438dccab" class="t t">CustomItemNewline</a>)))
            {
                <span class="r1010 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#789890bd422d8d3c" class="t constructor">CustomItemNewline</a>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#8108962f5fb3e409" class="i property">Count</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;Count&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#dbcc1be4601a7e29" class="i field">MissingPropertyBad</a>)
                };
            }
            <b>else</b> <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1009 r">deserializedItem</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#f453f8c422da83be" class="t t">CustomItemText</a>)))
            {
                <span class="r1010 r">result</span> = <b>new</b> <span class="t">CustomItemText</span>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#9ccc3fd090fc0f86" class="i property">Text</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;Text&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#dbcc1be4601a7e29" class="i field">MissingPropertyBad</a>)
                };
            }
            <b>else</b> <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1009 r">deserializedItem</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#200cf1eb48d34b81" class="t t">CustomItemFrame</a>)))
            {
                <span class="r1010 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#bf12e79499bc37fa" class="t constructor">CustomItemFrame</a>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#09f9cf9ee7ec46ff" class="i property">FirstLineHanging</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>uint</b>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;FirstLineHanging&quot;</span>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#d6da2961b76bae85" class="i property">FirstLineIndent</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>uint</b>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;FirstLineIndent&quot;</span>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#b851165dc9c289ad" class="i property">RightIndent</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>uint</b>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;RightIndent&quot;</span>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#a78e7c63b79990c4" class="i property">LeftIndent</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>uint</b>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;LeftIndent&quot;</span>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#9daec3fb6f0670d6" class="i property">CustomItems</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c0bc0eb3b8fe54ed" class="t t">CustomItemBase</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c0bc0eb3b8fe54ed" class="t t">CustomItemBase</a>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;CustomItems&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#dbcc1be4601a7e29" class="i field">MissingPropertyBad</a>)
                };
            }
            <b>else</b> <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1009 r">deserializedItem</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#c1e93f76e8cdd84a" class="t t">CustomItemExpression</a>)))
            {
                <span class="r1010 r">result</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#4d1db4bda64a6c8c" class="t constructor">CustomItemExpression</a>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#470749defc285826" class="i property">EnumerateCollection</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;EnumerateCollection&quot;</span>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#bba179c9a85e42f8" class="i property">CustomControl</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#fb8209059b0d94bb" class="t t">CustomControl</a>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;CustomControl&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#84e5d2b6c125cbe8" class="i property">Expression</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;Expression&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#6c91a4f6e26b3af7" class="i property">ItemSelectionCondition</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r1009 r">deserializedItem</span>, <span class="s">&quot;ItemSelectionCondition&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>)
                };
            }
            <b>else</b>
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r1009 r">deserializedItem</span>));
            }
 
            <b>return</b> <span class="r1010 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#87760d4efd2e8d05" class="t t">PSControl</a> <a id="233d4d71598e2b2d" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydratePSControl</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1011 rd" class="r1011 r">deserializedControl</span>)
        {
            <span class="c">// Earlier versions of PowerShell did not have all of the possible properties in a control, so we must</span>
            <span class="c">// use MissingPropertyOk to allow for connections to those older endpoints.</span>
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#87760d4efd2e8d05" class="t t">PSControl</a> <span id="r1012 rd" class="r1012 r">result</span>;
            <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1011 r">deserializedControl</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#2e6dff0a2047d6b4" class="t t">TableControl</a>)))
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#2e6dff0a2047d6b4" class="k">var</a> <span id="r1013 rd" class="r1013 r">tableControl</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#cb973217cbb39604" class="t constructor">TableControl</a>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#0671dde3ec81943d" class="i property">AutoSize</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;AutoSize&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#227d96e14c7d2946" class="i property">HideTableHeaders</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;HideTableHeaders&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#5fc1a2b45115c238" class="i property">Headers</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#8de7b62acebc6e04" class="t t">TableControlColumnHeader</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#8de7b62acebc6e04" class="t t">TableControlColumnHeader</a>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;Headers&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#128f02444b16da05" class="i property">Rows</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#c9bb940410c81f0f" class="t t">TableControlRow</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#c9bb940410c81f0f" class="t t">TableControlRow</a>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;Rows&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>)
                };
                <span class="r1012 r">result</span> = <span class="r1013 r">tableControl</span>;
            }
            <b>else</b> <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1011 r">deserializedControl</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#0a7aab714f1c3a67" class="t t">ListControl</a>)))
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#0a7aab714f1c3a67" class="k">var</a> <span id="r1014 rd" class="r1014 r">listControl</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#cd48558e6ca23a47" class="t constructor">ListControl</a>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#8d5082c6940b2f46" class="i property">Entries</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#e4f4c1fbd5d6efe8" class="t t">ListControlEntry</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#e4f4c1fbd5d6efe8" class="t t">ListControlEntry</a>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;Entries&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>)
                };
                <span class="r1012 r">result</span> = <span class="r1014 r">listControl</span>;
            }
            <b>else</b> <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1011 r">deserializedControl</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#05413cd678f4777b" class="t t">WideControl</a>)))
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#05413cd678f4777b" class="k">var</a> <span id="r1015 rd" class="r1015 r">wideControl</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#2998a73847a5fc84" class="t constructor">WideControl</a>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#ba9536686d4b2448" class="i property">AutoSize</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;Alignment&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#a69d31d155bf74ea" class="i property">Columns</a> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>uint</b>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;Columns&quot;</span>),
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#031e76f3060590f9" class="i property">Entries</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#ab1e040d09a19665" class="t t">WideControlEntryItem</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#ab1e040d09a19665" class="t t">WideControlEntryItem</a>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;Entries&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>)
                };
                <span class="r1012 r">result</span> = <span class="r1015 r">wideControl</span>;
            }
            <b>else</b> <b>if</b> (<a href="#27835b221aec7524" class="t t">Deserializer</a>.<span class="i">IsDeserializedInstanceOfType</span>(<span class="r1011 r">deserializedControl</span>, <b>typeof</b>(<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#fb8209059b0d94bb" class="t t">CustomControl</a>)))
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#fb8209059b0d94bb" class="k">var</a> <span id="r1016 rd" class="r1016 r">customControl</span> = <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#66937acbba516f26" class="t constructor">CustomControl</a>
                {
                    <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#f7141e607124ed02" class="i property">Entries</a> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#a7c2e8cb994c8339" class="t t">CustomControlEntry</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#a7c2e8cb994c8339" class="t t">CustomControlEntry</a>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;Entries&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>)
                };
                <span class="r1012 r">result</span> = <span class="r1016 r">customControl</span>;
            }
            <b>else</b>
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="s">&quot;pso&quot;</span>);
            }
 
            <span class="r1012 r">result</span>.<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#0c27a644c20f470b" class="i property">GroupBy</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#1876ab43931a64c1" class="t t">PSControlGroupBy</a>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;GroupBy&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
            <span class="r1012 r">result</span>.<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#2ab4d12080d2166d" class="i property">OutOfBand</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r1011 r">deserializedControl</span>, <span class="s">&quot;OutOfBand&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
            <b>return</b> <span class="r1012 r">result</span>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#1876ab43931a64c1" class="t t">PSControlGroupBy</a> <a id="4ec3a4ca2d8b7a6e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateGroupBy</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1017 rd" class="r1017 r">deserializedGroupBy</span>)
        {
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#1876ab43931a64c1" class="k">var</a> <span id="r1018 rd" class="r1018 r">result</span> = <b>new</b> <span class="t">PSControlGroupBy</span>
            {
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#7e27302bb0b4dd66" class="i property">CustomControl</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#fb8209059b0d94bb" class="t t">CustomControl</a>&gt;(<span class="r1017 r">deserializedGroupBy</span>, <span class="s">&quot;CustomControl&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#3c83fba85164f02c" class="i property">Expression</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#ca8865c5954381a8" class="t t">DisplayEntry</a>&gt;(<span class="r1017 r">deserializedGroupBy</span>, <span class="s">&quot;Expression&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>),
                <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#5dae5f095868de08" class="i property">Label</a> = <a href="#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r1017 r">deserializedGroupBy</span>, <span class="s">&quot;Label&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#57368bb545aac544" class="i field">NullValueOk</a>)
            };
            <b>return</b> <span class="r1018 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the boolean properties of ParameterSetMetadata object encoded as an integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1019 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSObject for which to obtain the flags</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Boolean properties of ParameterSetMetadata object encoded as an integer</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">Guid</span> <a id="7d1e520cc4d7405e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetFormatViewDefinitionInstanceId</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1019 rd" class="r1019 r">instance</span>)
        {
            <b>if</b> (<span class="r1019 r">instance</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1019 r">instance</span>));
            }
 
            <b>if</b> (!(<span class="r1019 r">instance</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f06b7548d648d6d9" class="t t">FormatViewDefinition</a> <span id="r1020 rd" class="r1020 r">formatViewDefinition</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1019 r">instance</span>));
            }
 
            <b>return</b> <span class="r1020 r">formatViewDefinition</span>.<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#1915d462433bb1bd" class="i property">InstanceId</a>;
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f06b7548d648d6d9" class="t t">FormatViewDefinition</a> <a id="afce09f2dffec6b3" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateFormatViewDefinition</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1021 rd" class="r1021 r">deserializedViewDefinition</span>)
        {
            <b>string</b> <span id="r1022 rd" class="r1022 r">name</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r1021 r">deserializedViewDefinition</span>, <span class="s">&quot;Name&quot;</span>);
            <span class="i">Guid</span> <span id="r1023 rd" class="r1023 r">instanceId</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<span class="i">Guid</span>&gt;(<span class="r1021 r">deserializedViewDefinition</span>, <span class="s">&quot;InstanceId&quot;</span>);
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#87760d4efd2e8d05" class="t t">PSControl</a> <span id="r1024 rd" class="r1024 r">control</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#87760d4efd2e8d05" class="t t">PSControl</a>&gt;(<span class="r1021 r">deserializedViewDefinition</span>, <span class="s">&quot;Control&quot;</span>);
 
            <b>return</b> <b>new</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#c4568e8461501192" class="t constructor">FormatViewDefinition</a>(<span class="r1022 r">name</span>, <span class="r1024 r">control</span>, <span class="r1023 r">instanceId</span>);
        }
 
        <b>private static</b> <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f507ec3cc270989a" class="t t">ExtendedTypeDefinition</a> <a id="27c622e8529e0288" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RehydrateExtendedTypeDefinition</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1025 rd" class="r1025 r">deserializedTypeDefinition</span>)
        {
            <span class="c">// Prefer TypeNames to TypeName - as it was incorrect to create multiple ExtendedTypeDefinitions for a group of types.</span>
            <span class="c">// But if a new PowerShell connects to an old endpoint, TypeNames will be missing, so fall back to TypeName in that case.</span>
            <b>string</b> <span id="r1026 rd" class="r1026 r">typeName</span>;
            <b>var</b> <span id="r1027 rd" class="r1027 r">typeNames</span> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<b>string</b>&gt;, <b>string</b>&gt;(<span class="r1025 r">deserializedTypeDefinition</span>, <span class="s">&quot;TypeNames&quot;</span>, <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#7004b900d60ba66b" class="i field">MissingPropertyOk</a>);
            <b>if</b> (<span class="r1027 r">typeNames</span> == <b>null</b> || <span class="r1027 r">typeNames</span>.<span class="i">Count</span> == 0)
            {
                <span class="r1026 r">typeName</span> = <a href="#5d7913c018439f74" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r1025 r">deserializedTypeDefinition</span>, <span class="s">&quot;TypeName&quot;</span>);
            }
            <b>else</b>
            {
                <span class="r1026 r">typeName</span> = <span class="r1027 r">typeNames</span>[0];
            }
 
            <span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f06b7548d648d6d9" class="t t">FormatViewDefinition</a>&gt; <span id="r1028 rd" class="r1028 r">viewDefinitions</span> = <a href="#6e6d1f7cd3b91e53" class="i method">RehydrateList</a>&lt;<span class="i">List</span>&lt;<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f06b7548d648d6d9" class="t t">FormatViewDefinition</a>&gt;, <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f06b7548d648d6d9" class="t t">FormatViewDefinition</a>&gt;(
                <span class="r1025 r">deserializedTypeDefinition</span>,
                <span class="s">&quot;FormatViewDefinition&quot;</span>,
                <a href="#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="#1b33ebafc3a3678e" class="i field">NullValueBad</a>);
 
            <a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#f507ec3cc270989a" class="k">var</a> <span id="r1029 rd" class="r1029 r">result</span> = <b>new</b> <span class="t">ExtendedTypeDefinition</span>(<span class="r1026 r">typeName</span>, <span class="r1028 r">viewDefinitions</span>);
            <b>if</b> (<span class="r1027 r">typeNames</span> != <b>null</b> &amp;&amp; <span class="r1027 r">typeNames</span>.<span class="i">Count</span> &gt; 1)
            {
                <b>for</b> (<b>var</b> <span id="r1030 rd" class="r1030 r">i</span> = 1; <span class="r1030 r">i</span> &lt; <span class="r1027 r">typeNames</span>.<span class="i">Count</span>; <span class="r1030 r">i</span>++)
                {
                    <span class="r1029 r">result</span>.<a href="../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#1b8df980714da796" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="r1027 r">typeNames</span>[<span class="r1030 r">i</span>]);
                }
            }
 
            <b>return</b> <span class="r1029 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
