<!DOCTYPE html>
<html><head><title>cmdlet.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1835);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/cmdlet.cs" target="_top">engine\cmdlet.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Resources</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines members and overrides used by Cmdlets.</span>
    <span class="c">///</span><span class="c"> All Cmdlets must derive from </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> There are two ways to create a Cmdlet: by deriving from the Cmdlet base class, and by</span>
    <span class="c">///</span><span class="c"> deriving from the PSCmdlet base class.  The Cmdlet base class is the primary means by</span>
    <span class="c">///</span><span class="c"> which users create their own Cmdlets.  Extending this class provides support for the most</span>
    <span class="c">///</span><span class="c"> common functionality, including object output and record processing.</span>
    <span class="c">///</span><span class="c"> If your Cmdlet requires access to the MSH Runtime (for example, variables in the session state,</span>
    <span class="c">///</span><span class="c"> access to the host, or information about the current Cmdlet Providers,) then you should instead</span>
    <span class="c">///</span><span class="c"> derive from the PSCmdlet base class.</span>
    <span class="c">///</span><span class="c"> In both cases, users should first develop and implement an object model to accomplish their</span>
    <span class="c">///</span><span class="c"> task, extending the Cmdlet or PSCmdlet classes only as a thin management layer.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<a href="CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <b>public abstract class</b> <a id="b0d421ff1d7581f9" href="../R/b0d421ff1d7581f9.html" target="n" data-glyph="0,0" class="t t">Cmdlet</a> : <a href="CommandBase.cs.html#26cb3aadccaa58ac" class="t t">InternalCommand</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Lists the common parameters that are added by the PowerShell engine to any cmdlet that derives</span>
        <span class="c">///</span><span class="c"> from PSCmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="c2e19a049c38e66b" href="../R/c2e19a049c38e66b.html" target="n" data-glyph="102,1" class="i property">CommonParameters</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8dcd057a399b418e" class="i field">s_commonParameters</a>.<span class="i">Value</span>;
            }
        }
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">HashSet</span>&lt;<b>string</b>&gt;&gt; <a id="8dcd057a399b418e" href="../R/8dcd057a399b418e.html" target="n" data-glyph="46,1" class="i field">s_commonParameters</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">HashSet</span>&lt;<b>string</b>&gt;&gt;(
            () =&gt;
            {
                <b>return</b> <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) {
                    <span class="s">&quot;Verbose&quot;</span>, <span class="s">&quot;Debug&quot;</span>, <span class="s">&quot;ErrorAction&quot;</span>, <span class="s">&quot;WarningAction&quot;</span>, <span class="s">&quot;InformationAction&quot;</span>,
                    <span class="s">&quot;ErrorVariable&quot;</span>, <span class="s">&quot;WarningVariable&quot;</span>, <span class="s">&quot;OutVariable&quot;</span>,
                    <span class="s">&quot;OutBuffer&quot;</span>, <span class="s">&quot;PipelineVariable&quot;</span>, <span class="s">&quot;InformationVariable&quot;</span> };
            }
        );
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Lists the common parameters that are added by the PowerShell engine when a cmdlet defines</span>
        <span class="c">///</span><span class="c"> additional capabilities (SupportsShouldProcess, SupportsTransactions)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="ac60d06f71c5a641" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">OptionalCommonParameters</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#27a2dd6aaeae0b47" class="i field">s_optionalCommonParameters</a>.<span class="i">Value</span>;
            }
        }
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">HashSet</span>&lt;<b>string</b>&gt;&gt; <a id="27a2dd6aaeae0b47" href="../R/27a2dd6aaeae0b47.html" target="n" data-glyph="46,1" class="i field">s_optionalCommonParameters</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">HashSet</span>&lt;<b>string</b>&gt;&gt;(
            () =&gt;
            {
                <b>return</b> <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) {
                    <span class="s">&quot;WhatIf&quot;</span>, <span class="s">&quot;Confirm&quot;</span>, <span class="s">&quot;UseTransaction&quot;</span> };
            }
        );
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is this command stopping?</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If Stopping is true, many Cmdlet methods will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> In general, if a Cmdlet&#39;s override implementation of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> throws </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, the best thing to do is to</span>
        <span class="c">///</span><span class="c"> shut down the operation and return to the caller.</span>
        <span class="c">///</span><span class="c"> It is acceptable to not catch </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> and allow the exception to reach ProcessRecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="38ad9a6bd7f45057" href="../R/38ad9a6bd7f45057.html" target="n" data-glyph="102,1" class="i property">Stopping</a>
        {
            <b>get</b>
            {
                <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
                {
                    <b>return</b> <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="CommandBase.cs.html#5f88a0f944bebc93" class="i property">IsStopping</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter set in effect.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">the parameter set name</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="87e820a4c96a43d6" href="../R/87e820a4c96a43d6.html" target="n" data-glyph="104,1" class="i property">_ParameterSetName</a>
        {
            <b>get</b> { <b>return</b> <a href="#3b7a6bf9a44f3ac9" class="i field">_parameterSetName</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">parameterSetName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the valid parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="464de8fab6b163d3" href="../R/464de8fab6b163d3.html" target="n" data-glyph="74,1" class="i method">SetParameterSetName</a>(<b>string</b> <span id="r0 rd" class="r0 r">parameterSetName</span>)
        {
            <a href="#3b7a6bf9a44f3ac9" class="i field">_parameterSetName</a> = <span class="r0 r">parameterSetName</span>;
        }
 
        <b>private string</b> <a id="3b7a6bf9a44f3ac9" href="../R/3b7a6bf9a44f3ac9.html" target="n" data-glyph="46,1" class="i field">_parameterSetName</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Override Internal
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, performs initialization</span>
        <span class="c">///</span><span class="c"> of command execution.</span>
        <span class="c">///</span><span class="c"> Default implementation in the base class just returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="06afe94e4c21c9ed" href="../R/06afe94e4c21c9ed.html" target="n" data-glyph="74,1" class="i method">DoBeginProcessing</a>()
        {
            <a href="MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a> <span id="r1 rd" class="r1 r">mshRuntime</span> = <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#fa3830ca3ad4b256" class="i property">CommandRuntime</a> <b>as</b> <a href="MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a>;
 
            <b>if</b> (<span class="r1 r">mshRuntime</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r1 r">mshRuntime</span>.<a href="MshCommandRuntime.cs.html#84be5d945a0edf7b" class="i property">UseTransaction</a> &amp;&amp;
                   (!<a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#8034b8ed99ff105b" class="i property">HasTransaction</a>))
                {
                    <b>string</b> <span id="r2 rd" class="r2 r">error</span> = <span class="i">TransactionStrings</span>.<span class="i">NoTransactionStarted</span>;
 
                    <b>if</b> (<a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#0006ba4076497784" class="i property">IsLastTransactionCommitted</a>)
                    {
                        <span class="r2 r">error</span> = <span class="i">TransactionStrings</span>.<span class="i">NoTransactionStartedFromCommit</span>;
                    }
                    <b>else</b> <b>if</b> (<a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="ExecutionContext.cs.html#d432bf41e44dd9db" class="i property">TransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#ff1be75b1e651fd1" class="i property">IsLastTransactionRolledBack</a>)
                    {
                        <span class="r2 r">error</span> = <span class="i">TransactionStrings</span>.<span class="i">NoTransactionStartedFromRollback</span>;
                    }
 
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r2 r">error</span>);
                }
            }
 
            <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#ca41319604ac804f" class="i method">BeginProcessing</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, performs execution</span>
        <span class="c">///</span><span class="c"> of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="42be3595b710dd9b" href="../R/42be3595b710dd9b.html" target="n" data-glyph="74,1" class="i method">DoProcessRecord</a>()
        {
            <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#f98800b8478b2288" class="i method">ProcessRecord</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, performs clean-up</span>
        <span class="c">///</span><span class="c"> after the command execution.</span>
        <span class="c">///</span><span class="c"> Default implementation in the base class just returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="0da60bee5d5b7507" href="../R/0da60bee5d5b7507.html" target="n" data-glyph="74,1" class="i method">DoEndProcessing</a>()
        {
            <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#a5fa661c704b7117" class="i method">EndProcessing</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, interrupts currently</span>
        <span class="c">///</span><span class="c"> running code within the command. It should interrupt BeginProcessing,</span>
        <span class="c">///</span><span class="c"> ProcessRecord, and EndProcessing.</span>
        <span class="c">///</span><span class="c"> Default implementation in the base class just returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="a844c9f8203eb400" href="../R/a844c9f8203eb400.html" target="n" data-glyph="74,1" class="i method">DoStopProcessing</a>()
        {
            <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#ed29eac69e2abf69" class="i method">StopProcessing</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Override Internal
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> internal_members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes the new instance of Cmdlet class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Only subclasses of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> can be created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected</b> <a id="ebccc96aa1bc765c" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">Cmdlet</a>()
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Cmdlet virtuals
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the resource string corresponding to</span>
        <span class="c">///</span><span class="c"> baseName and resourceId from the current assembly.</span>
        <span class="c">///</span><span class="c"> You should override this if you require a different behavior.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">baseName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The base resource name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">resourceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The resource id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The resource string corresponding to baseName and resourceId.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invalid </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">baseName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">resourceId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, or</span>
        <span class="c">///</span><span class="c"> string not found in resources</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This behavior may be used when the Cmdlet specifies</span>
        <span class="c">///</span><span class="c"> HelpMessageBaseName and HelpMessageResourceId when defining</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> or when it uses the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ErrorPackage.cs.html#d882fa1d2308673f" class="t t">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> constructor variants which take baseName and resourceId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ErrorPackage.cs.html#d882fa1d2308673f" class="t t">ErrorDetails</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public virtual string</b> <a id="5c4315de0df8dce1" href="../R/5c4315de0df8dce1.html" target="n" data-glyph="72,1" class="i method">GetResourceString</a>(<b>string</b> <span id="r3 rd" class="r3 r">baseName</span>, <b>string</b> <span id="r4 rd" class="r4 r">resourceId</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r3 r">baseName</span>))
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">baseName</span>));
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r4 r">resourceId</span>))
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r4 r">resourceId</span>));
 
                <span class="i">ResourceManager</span> <span id="r5 rd" class="r5 r">manager</span> = <a href="../utils/ResourceManagerCache.cs.html#ce506566c7e4a091" class="t t">ResourceManagerCache</a>.<span class="i">GetResourceManager</span>(<a href="#b0d421ff1d7581f9" class="k">this</a>.<span class="i">GetType</span>().<span class="i">Assembly</span>, <span class="r3 r">baseName</span>);
                <b>string</b> <span id="r6 rd" class="r6 r">retValue</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="r6 r">retValue</span> = <span class="r5 r">manager</span>.<span class="i">GetString</span>(<span class="r4 r">resourceId</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>);
                }
                <b>catch</b> (<span class="i">MissingManifestResourceException</span>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r3 r">baseName</span>), <span class="i">GetErrorText</span>.<span class="i">ResourceBaseNameFailure</span>, <span class="r3 r">baseName</span>);
                }
 
                <b>if</b> (<span class="r6 r">retValue</span> == <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r4 r">resourceId</span>), <span class="i">GetErrorText</span>.<span class="i">ResourceIdFailure</span>, <span class="r4 r">resourceId</span>);
                }
 
                <b>return</b> <span class="r6 r">retValue</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Cmdlet virtuals
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Write
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Holds the command runtime object for this command. This object controls</span>
        <span class="c">///</span><span class="c"> what actually happens when a write is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a> <a id="fa3830ca3ad4b256" href="../R/fa3830ca3ad4b256.html" target="n" data-glyph="102,1" class="i property">CommandRuntime</a>
        {
            <b>get</b>
            {
                <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
                {
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>;
                }
            }
 
            <b>set</b>
            {
                <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
                {
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal variant: Writes the specified error to the error pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do not call WriteError(e.ErrorRecord).</span>
        <span class="c">///</span><span class="c"> The ErrorRecord contained in the ErrorRecord property of</span>
        <span class="c">///</span><span class="c"> an exception which implements IContainsErrorRecord</span>
        <span class="c">///</span><span class="c"> should not be passed directly to WriteError, since it contains</span>
        <span class="c">///</span><span class="c"> a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#0468337cc591c6b2" class="t t">ParentContainsErrorRecordException</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> rather than the real exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> terminates the command, where</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> allows the command to continue.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="7746d1a8f41a36d5" href="../R/7746d1a8f41a36d5.html" target="n" data-glyph="72,1" class="i method">WriteError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r7 rd" class="r7 r">errorRecord</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a>(<span class="r7 r">errorRecord</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteError&quot;</span>);
            }
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the object to the output pipe.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">sendToPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that needs to be written.  This will be written as</span>
        <span class="c">///</span><span class="c"> a single object, even if it is an enumeration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteObject may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<span class="i">WriteObject</span>(<b>object</b>,<b>bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="d3cfb6f38afe5ee0" href="../R/d3cfb6f38afe5ee0.html" target="n" data-glyph="72,1" class="i method">WriteObject</a>(<b>object</b> <span id="r8 rd" class="r8 r">sendToPipeline</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">WriteObject</span>(<span class="r8 r">sendToPipeline</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteObject&quot;</span>);
            }
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes one or more objects to the output pipe.</span>
        <span class="c">///</span><span class="c"> If the object is a collection and the enumerateCollection flag</span>
        <span class="c">///</span><span class="c"> is true, the objects in the collection</span>
        <span class="c">///</span><span class="c"> will be written individually.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">sendToPipeline</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object that needs to be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">enumerateCollection</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the collection should be enumerated</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteObject may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<span class="i">WriteObject</span>(<b>object</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="5805a280861be556" href="../R/5805a280861be556.html" target="n" data-glyph="72,1" class="i method">WriteObject</a>(<b>object</b> <span id="r9 rd" class="r9 r">sendToPipeline</span>, <b>bool</b> <span id="r10 rd" class="r10 r">enumerateCollection</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">WriteObject</span>(<span class="r9 r">sendToPipeline</span>, <span class="r10 r">enumerateCollection</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteObject&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display verbose information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Verbose output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteVerbose may only be called during a call to this Cmdlets&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteVerbose to display more detailed information about</span>
        <span class="c">///</span><span class="c"> the activity of your Cmdlet.  By default, verbose output will</span>
        <span class="c">///</span><span class="c"> not be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> VerbosePreference shell variable</span>
        <span class="c">///</span><span class="c"> or the -Verbose and -Debug command-line options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#be99e4c15c8c7557" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#2001742b423b982c" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="377660744c64cd7e" href="../R/377660744c64cd7e.html" target="n" data-glyph="72,1" class="i method">WriteVerbose</a>(<b>string</b> <span id="r11 rd" class="r11 r">text</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#31d60f57070e2a28" class="i method">WriteVerbose</a>(<span class="r11 r">text</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteVerbose&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display warning information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Warning output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteWarning may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteWarning to display warnings about</span>
        <span class="c">///</span><span class="c"> the activity of your Cmdlet.  By default, warning output will</span>
        <span class="c">///</span><span class="c"> be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> WarningPreference shell variable</span>
        <span class="c">///</span><span class="c"> or the -Verbose and -Debug command-line options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#be99e4c15c8c7557" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#377660744c64cd7e" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#2001742b423b982c" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="dda5a07d1a8a6cba" href="../R/dda5a07d1a8a6cba.html" target="n" data-glyph="72,1" class="i method">WriteWarning</a>(<b>string</b> <span id="r12 rd" class="r12 r">text</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#e79b401949338dbb" class="i method">WriteWarning</a>(<span class="r12 r">text</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteWarning&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write text into pipeline execution log.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Text to be written to log.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteWarning may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteCommandDetail to write important information about cmdlet execution to</span>
        <span class="c">///</span><span class="c"> pipeline execution log.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If LogPipelineExecutionDetail is turned on, this information will be written</span>
        <span class="c">///</span><span class="c"> to monad log under log category &quot;Pipeline execution detail&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#be99e4c15c8c7557" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#377660744c64cd7e" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#2001742b423b982c" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="1c8f96ac5e840c56" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WriteCommandDetail</a>(<b>string</b> <span id="r13 rd" class="r13 r">text</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#33e9a26cbade5803" class="i method">WriteCommandDetail</a>(<span class="r13 r">text</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteCommandDetail&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display progress information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">progressRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Progress information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteProgress may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteProgress to display progress information about</span>
        <span class="c">///</span><span class="c"> the activity of your Cmdlet, when the operation of your Cmdlet</span>
        <span class="c">///</span><span class="c"> could potentially take a long time.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> By default, progress output will</span>
        <span class="c">///</span><span class="c"> be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> ProgressPreference shell variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#be99e4c15c8c7557" class="i method">WriteDebug</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#377660744c64cd7e" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="2001742b423b982c" href="../R/2001742b423b982c.html" target="n" data-glyph="72,1" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r14 rd" class="r14 r">progressRecord</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#baaf77bfae870779" class="i method">WriteProgress</a>(<span class="r14 r">progressRecord</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteProgress&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Displays progress output if enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">sourceId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Identifies which command is reporting progress</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">progressRecord</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Progress status to be displayed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e3c96c3f4d6c3412" href="../R/e3c96c3f4d6c3412.html" target="n" data-glyph="74,1" class="i method">WriteProgress</a>(
            <span class="i">Int64</span> <span id="r15 rd" class="r15 r">sourceId</span>,
            <a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r16 rd" class="r16 r">progressRecord</span>)
        {
            <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#e712282e7a3eee8b" class="i method">WriteProgress</a>(<span class="r15 r">sourceId</span>, <span class="r16 r">progressRecord</span>);
            <b>else</b>
                <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteProgress&quot;</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display debug information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debug output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteDebug may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteDebug to display debug information on the inner workings</span>
        <span class="c">///</span><span class="c"> of your Cmdlet.  By default, debug output will</span>
        <span class="c">///</span><span class="c"> not be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> DebugPreference shell variable or the -Debug command-line option.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#377660744c64cd7e" class="i method">WriteVerbose</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#2001742b423b982c" class="i method">WriteProgress</a>(<a href="ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public void</b> <a id="be99e4c15c8c7557" href="../R/be99e4c15c8c7557.html" target="n" data-glyph="72,1" class="i method">WriteDebug</a>(<b>string</b> <span id="r17 rd" class="r17 r">text</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#b2028ee3964807dc" class="i method">WriteDebug</a>(<span class="r17 r">text</span>);
                <b>else</b>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteDebug&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Route information to the user or host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">messageData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object / message data to transmit to the hosting application.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">tags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any tags to be associated with the message data. These can later be used to filter</span>
        <span class="c">///</span><span class="c"> or separate objects being sent to the host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteInformation may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteInformation to transmit information to the user about the activity</span>
        <span class="c">///</span><span class="c"> of your Cmdlet.  By default, informational output will</span>
        <span class="c">///</span><span class="c"> be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> InformationPreference shell variable or the -InformationPreference command-line option.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d39d94290d054da5" href="../R/d39d94290d054da5.html" target="n" data-glyph="72,1" class="i method">WriteInformation</a>(<b>object</b> <span id="r18 rd" class="r18 r">messageData</span>, <b>string</b>[] <span id="r19 rd" class="r19 r">tags</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <a href="ICommandRuntime.cs.html#5043391d15599ea3" class="t t">ICommandRuntime2</a> <span id="r20 rd" class="r20 r">commandRuntime2</span> = <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> <b>as</b> <a href="ICommandRuntime.cs.html#5043391d15599ea3" class="t t">ICommandRuntime2</a>;
                <b>if</b> (<span class="r20 r">commandRuntime2</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r21 rd" class="r21 r">source</span> = <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>.<a href="InvocationInfo.cs.html#f655312f60d6e9b8" class="i property">PSCommandPath</a>;
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r21 r">source</span>))
                    {
                        <span class="r21 r">source</span> = <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                    }
 
                    <a href="InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r22 rd" class="r22 r">informationRecord</span> = <b>new</b> <a href="InformationRecord.cs.html#ad6024c01523a97e" class="t constructor">InformationRecord</a>(<span class="r18 r">messageData</span>, <span class="r21 r">source</span>);
 
                    <b>if</b> (<span class="r19 r">tags</span> != <b>null</b>)
                    {
                        <span class="r22 r">informationRecord</span>.<a href="InformationRecord.cs.html#4fb6c3e3e60ff9d7" class="i property">Tags</a>.<span class="i">AddRange</span>(<span class="r19 r">tags</span>);
                    }
 
                    <span class="r20 r">commandRuntime2</span>.<a href="ICommandRuntime.cs.html#dcc71c88127972f6" class="i method">WriteInformation</a>(<span class="r22 r">informationRecord</span>);
                }
                <b>else</b>
                {
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteInformation&quot;</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Route information to the user or host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">informationRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The information record to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> WriteInformation may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use WriteInformation to transmit information to the user about the activity</span>
        <span class="c">///</span><span class="c"> of your Cmdlet.  By default, informational output will</span>
        <span class="c">///</span><span class="c"> be displayed, although this can be configured with the</span>
        <span class="c">///</span><span class="c"> InformationPreference shell variable or the -InformationPreference command-line option.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f38cc55507c70e22" href="../R/f38cc55507c70e22.html" target="n" data-glyph="72,1" class="i method">WriteInformation</a>(<a href="InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r23 rd" class="r23 r">informationRecord</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <a href="ICommandRuntime.cs.html#5043391d15599ea3" class="t t">ICommandRuntime2</a> <span id="r24 rd" class="r24 r">commandRuntime2</span> = <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> <b>as</b> <a href="ICommandRuntime.cs.html#5043391d15599ea3" class="t t">ICommandRuntime2</a>;
                <b>if</b> (<span class="r24 r">commandRuntime2</span> != <b>null</b>)
                {
                    <span class="r24 r">commandRuntime2</span>.<a href="ICommandRuntime.cs.html#dcc71c88127972f6" class="i method">WriteInformation</a>(<span class="r23 r">informationRecord</span>);
                }
                <b>else</b>
                {
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;WriteInformation&quot;</span>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Write
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ShouldProcess
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target resource being acted upon. This will</span>
        <span class="c">///</span><span class="c"> potentially be displayed to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype1&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType1 : Cmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(filename))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#fee13e39455d3a34" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>,<b>out</b> <a href="#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="45a4136cf5b777da" href="../R/45a4136cf5b777da.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(<b>string</b> <span id="r25 rd" class="r25 r">target</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">ShouldProcess</span>(<span class="r25 r">target</span>);
                <b>else</b>
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This variant allows the caller to specify text for both the</span>
        <span class="c">///</span><span class="c"> target resource and the action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">target</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target resource being acted upon. This will</span>
        <span class="c">///</span><span class="c"> potentially be displayed to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the action which is being performed. This will</span>
        <span class="c">///</span><span class="c"> potentially be displayed to the user. (default is Cmdlet name)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype2&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType2 : Cmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(filename, &quot;delete&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#fee13e39455d3a34" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>,<b>out</b> <a href="#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="5f125d2ab6d0970d" href="../R/5f125d2ab6d0970d.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(<b>string</b> <span id="r26 rd" class="r26 r">target</span>, <b>string</b> <span id="r27 rd" class="r27 r">action</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">ShouldProcess</span>(<span class="r26 r">target</span>, <span class="r27 r">action</span>);
                <b>else</b>
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This variant allows the caller to specify the complete text</span>
        <span class="c">///</span><span class="c"> describing the operation, rather than just the name and action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">verboseDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual description of the action to be performed.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Continue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">verboseWarning</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Inquire.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> if the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">caption</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype3&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType3 : Cmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#fee13e39455d3a34" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>,<b>out</b> <a href="#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="6babd36f7e136213" href="../R/6babd36f7e136213.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r28 rd" class="r28 r">verboseDescription</span>,
            <b>string</b> <span id="r29 rd" class="r29 r">verboseWarning</span>,
            <b>string</b> <span id="r30 rd" class="r30 r">caption</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">ShouldProcess</span>(<span class="r28 r">verboseDescription</span>, <span class="r29 r">verboseWarning</span>, <span class="r30 r">caption</span>);
                <b>else</b>
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm the operation with the user.  Cmdlets which make changes</span>
        <span class="c">///</span><span class="c"> (e.g. delete files, stop services etc.) should call ShouldProcess</span>
        <span class="c">///</span><span class="c"> to give the user the opportunity to confirm that the operation</span>
        <span class="c">///</span><span class="c"> should actually be performed.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This variant allows the caller to specify the complete text</span>
        <span class="c">///</span><span class="c"> describing the operation, rather than just the name and action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">verboseDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual description of the action to be performed.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Continue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">verboseWarning</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> This is what will be displayed to the user for</span>
        <span class="c">///</span><span class="c"> ActionPreference.Inquire.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> if the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">caption</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">shouldProcessReason</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates the reason(s) why ShouldProcess returned what it returned.</span>
        <span class="c">///</span><span class="c"> Only the reasons enumerated in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#40cc5cec3eccab94" class="t t">ShouldProcessReason</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> are returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldProcess returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Cmdlet should declare</span>
        <span class="c">///</span><span class="c"> [Cmdlet( SupportsShouldProcess = true )]</span>
        <span class="c">///</span><span class="c"> if-and-only-if it calls ShouldProcess before making changes.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldProcess will take into account command-line settings</span>
        <span class="c">///</span><span class="c"> and preference variables in determining what it should return</span>
        <span class="c">///</span><span class="c"> and whether it should prompt the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is terminated due to ActionPreference.Stop</span>
        <span class="c">///</span><span class="c"> or ActionPreference.Inquire, this method will throw</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> but the command failure will ultimately be</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype3&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType3 : Cmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     ShouldProcessReason shouldProcessReason;</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;,</span>
        <span class="c">///</span><span class="c">                         out shouldProcessReason))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="fee13e39455d3a34" href="../R/fee13e39455d3a34.html" target="n" data-glyph="72,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r31 rd" class="r31 r">verboseDescription</span>,
            <b>string</b> <span id="r32 rd" class="r32 r">verboseWarning</span>,
            <b>string</b> <span id="r33 rd" class="r33 r">caption</span>,
            <b>out</b> <a href="#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r34 rd" class="r34 r">shouldProcessReason</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">ShouldProcess</span>(<span class="r31 r">verboseDescription</span>, <span class="r32 r">verboseWarning</span>, <span class="r33 r">caption</span>, <b>out</b> <span class="r34 r">shouldProcessReason</span>);
                <b>else</b>
                {
                    <span class="r34 r">shouldProcessReason</span> = <a href="#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>.<a href="#401296eb0e0f2185" class="i field">None</a>;
                    <b>return</b> <b>true</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ShouldProcess
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ShouldContinue
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm an operation or grouping of operations with the user.</span>
        <span class="c">///</span><span class="c"> This differs from ShouldProcess in that it is not affected by</span>
        <span class="c">///</span><span class="c"> preference settings or command-line parameters,</span>
        <span class="c">///</span><span class="c"> it always does the query.</span>
        <span class="c">///</span><span class="c"> This variant only offers Yes/No, not YesToAll/NoToAll.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> when the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue should also offer a &quot;bool Force&quot;</span>
        <span class="c">///</span><span class="c"> parameter which bypasses the calls to ShouldContinue</span>
        <span class="c">///</span><span class="c"> and ShouldProcess.</span>
        <span class="c">///</span><span class="c"> If this is not done, it will be difficult to use the Cmdlet</span>
        <span class="c">///</span><span class="c"> from scripts and non-interactive hosts.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue must still verify operations</span>
        <span class="c">///</span><span class="c"> which will make changes using ShouldProcess.</span>
        <span class="c">///</span><span class="c"> This will assure that settings such as -WhatIf work properly.</span>
        <span class="c">///</span><span class="c"> You may call ShouldContinue either before or after ShouldProcess.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets may have different &quot;classes&quot; of confirmations.  For example,</span>
        <span class="c">///</span><span class="c"> &quot;del&quot; confirms whether files in a particular directory should be</span>
        <span class="c">///</span><span class="c"> deleted, whether read-only files should be deleted, etc.</span>
        <span class="c">///</span><span class="c"> Cmdlets can use ShouldContinue to store YesToAll/NoToAll members</span>
        <span class="c">///</span><span class="c"> for each such &quot;class&quot; to keep track of whether the user has</span>
        <span class="c">///</span><span class="c"> confirmed &quot;delete all read-only files&quot; etc.</span>
        <span class="c">///</span><span class="c"> ShouldProcess offers YesToAll/NoToAll automatically,</span>
        <span class="c">///</span><span class="c"> but answering YesToAll or NoToAll applies to all subsequent calls</span>
        <span class="c">///</span><span class="c"> to ShouldProcess for the Cmdlet instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype4&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType4 : Cmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 [Parameter]</span>
        <span class="c">///</span><span class="c">                 public SwitchParameter Force</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return force; }</span>
        <span class="c">///</span><span class="c">                     set { force = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private bool force;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         if (IsReadOnly(filename))</span>
        <span class="c">///</span><span class="c">                         {</span>
        <span class="c">///</span><span class="c">                             if (!Force </span><span class="c">&amp;amp;</span><span class="c">&amp;amp;</span><span class="c"> !ShouldContinue(</span>
        <span class="c">///</span><span class="c">                                     string.Format(&quot;File {0} is read-only.  Are you sure you want to delete read-only file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                                     &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                                     )</span>
        <span class="c">///</span><span class="c">                             {</span>
        <span class="c">///</span><span class="c">                                 return;</span>
        <span class="c">///</span><span class="c">                             }</span>
        <span class="c">///</span><span class="c">                         }</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6e88c33df41aa1b5" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>,<b>ref bool</b>,<b>ref bool</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public bool</b> <a id="7c0240b4b2b7c267" href="../R/7c0240b4b2b7c267.html" target="n" data-glyph="72,1" class="i method">ShouldContinue</a>(<b>string</b> <span id="r35 rd" class="r35 r">query</span>, <b>string</b> <span id="r36 rd" class="r36 r">caption</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">ShouldContinue</span>(<span class="r35 r">query</span>, <span class="r36 r">caption</span>);
                <b>else</b>
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm an operation or grouping of operations with the user.</span>
        <span class="c">///</span><span class="c"> This differs from ShouldProcess in that it is not affected by</span>
        <span class="c">///</span><span class="c"> preference settings or command-line parameters,</span>
        <span class="c">///</span><span class="c"> it always does the query.</span>
        <span class="c">///</span><span class="c"> This variant offers Yes, No, YesToAll and NoToAll.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> when the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">yesToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects YesToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">noToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects NoToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue should also offer a &quot;bool Force&quot;</span>
        <span class="c">///</span><span class="c"> parameter which bypasses the calls to ShouldContinue</span>
        <span class="c">///</span><span class="c"> and ShouldProcess.</span>
        <span class="c">///</span><span class="c"> If this is not done, it will be difficult to use the Cmdlet</span>
        <span class="c">///</span><span class="c"> from scripts and non-interactive hosts.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue must still verify operations</span>
        <span class="c">///</span><span class="c"> which will make changes using ShouldProcess.</span>
        <span class="c">///</span><span class="c"> This will assure that settings such as -WhatIf work properly.</span>
        <span class="c">///</span><span class="c"> You may call ShouldContinue either before or after ShouldProcess.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets may have different &quot;classes&quot; of confirmations.  For example,</span>
        <span class="c">///</span><span class="c"> &quot;del&quot; confirms whether files in a particular directory should be</span>
        <span class="c">///</span><span class="c"> deleted, whether read-only files should be deleted, etc.</span>
        <span class="c">///</span><span class="c"> Cmdlets can use ShouldContinue to store YesToAll/NoToAll members</span>
        <span class="c">///</span><span class="c"> for each such &quot;class&quot; to keep track of whether the user has</span>
        <span class="c">///</span><span class="c"> confirmed &quot;delete all read-only files&quot; etc.</span>
        <span class="c">///</span><span class="c"> ShouldProcess offers YesToAll/NoToAll automatically,</span>
        <span class="c">///</span><span class="c"> but answering YesToAll or NoToAll applies to all subsequent calls</span>
        <span class="c">///</span><span class="c"> to ShouldProcess for the Cmdlet instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype4&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType5 : Cmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 [Parameter]</span>
        <span class="c">///</span><span class="c">                 public SwitchParameter Force</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return force; }</span>
        <span class="c">///</span><span class="c">                     set { force = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private bool force;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 private bool yesToAll;</span>
        <span class="c">///</span><span class="c">                 private bool noToAll;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         if (IsReadOnly(filename))</span>
        <span class="c">///</span><span class="c">                         {</span>
        <span class="c">///</span><span class="c">                             if (!Force </span><span class="c">&amp;amp;</span><span class="c">&amp;amp;</span><span class="c"> !ShouldContinue(</span>
        <span class="c">///</span><span class="c">                                     string.Format(&quot;File {0} is read-only.  Are you sure you want to delete read-only file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                                     &quot;Delete file&quot;),</span>
        <span class="c">///</span><span class="c">                                     ref yesToAll,</span>
        <span class="c">///</span><span class="c">                                     ref noToAll</span>
        <span class="c">///</span><span class="c">                                     )</span>
        <span class="c">///</span><span class="c">                             {</span>
        <span class="c">///</span><span class="c">                                 return;</span>
        <span class="c">///</span><span class="c">                             }</span>
        <span class="c">///</span><span class="c">                         }</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1045:DoNotPassTypesByReference&quot;</span>)]
        <b>public bool</b> <a id="6e88c33df41aa1b5" href="../R/6e88c33df41aa1b5.html" target="n" data-glyph="72,1" class="i method">ShouldContinue</a>(
            <b>string</b> <span id="r37 rd" class="r37 r">query</span>, <b>string</b> <span id="r38 rd" class="r38 r">caption</span>, <b>ref bool</b> <span id="r39 rd" class="r39 r">yesToAll</span>, <b>ref bool</b> <span id="r40 rd" class="r40 r">noToAll</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">ShouldContinue</span>(<span class="r37 r">query</span>, <span class="r38 r">caption</span>, <b>ref</b> <span class="r39 r">yesToAll</span>, <b>ref</b> <span class="r40 r">noToAll</span>);
                <b>else</b>
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Confirm an operation or grouping of operations with the user.</span>
        <span class="c">///</span><span class="c"> This differs from ShouldProcess in that it is not affected by</span>
        <span class="c">///</span><span class="c"> preference settings or command-line parameters,</span>
        <span class="c">///</span><span class="c"> it always does the query.</span>
        <span class="c">///</span><span class="c"> This variant offers Yes, No, YesToAll and NoToAll.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">query</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Textual query of whether the action should be performed,</span>
        <span class="c">///</span><span class="c"> usually in the form of a question.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">caption</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caption of the window which may be displayed</span>
        <span class="c">///</span><span class="c"> when the user is prompted whether or not to perform the action.</span>
        <span class="c">///</span><span class="c"> It may be displayed by some hosts, but not all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">hasSecurityImpact</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the operation being confirmed has a security impact. If specified,</span>
        <span class="c">///</span><span class="c"> the default option selected in the selection menu is &#39;No&#39;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">yesToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects YesToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">noToAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true iff user selects NoToAll.  If this is already true,</span>
        <span class="c">///</span><span class="c"> ShouldContinue will bypass the prompt and return false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline has already been terminated, or was terminated</span>
        <span class="c">///</span><span class="c"> during the execution of this method.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow PipelineStoppedException</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of ProcessRecord etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Not permitted at this time or from this thread.</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns true, the operation should be performed.</span>
        <span class="c">///</span><span class="c"> If ShouldContinue returns false, the operation should not be</span>
        <span class="c">///</span><span class="c"> performed, and the Cmdlet should move on to the next target resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue should also offer a &quot;bool Force&quot;</span>
        <span class="c">///</span><span class="c"> parameter which bypasses the calls to ShouldContinue</span>
        <span class="c">///</span><span class="c"> and ShouldProcess.</span>
        <span class="c">///</span><span class="c"> If this is not done, it will be difficult to use the Cmdlet</span>
        <span class="c">///</span><span class="c"> from scripts and non-interactive hosts.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets using ShouldContinue must still verify operations</span>
        <span class="c">///</span><span class="c"> which will make changes using ShouldProcess.</span>
        <span class="c">///</span><span class="c"> This will assure that settings such as -WhatIf work properly.</span>
        <span class="c">///</span><span class="c"> You may call ShouldContinue either before or after ShouldProcess.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ShouldContinue may only be called during a call to this Cmdlet&#39;s</span>
        <span class="c">///</span><span class="c"> implementation of ProcessRecord, BeginProcessing or EndProcessing,</span>
        <span class="c">///</span><span class="c"> and only from that thread.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Cmdlets may have different &quot;classes&quot; of confirmations.  For example,</span>
        <span class="c">///</span><span class="c"> &quot;del&quot; confirms whether files in a particular directory should be</span>
        <span class="c">///</span><span class="c"> deleted, whether read-only files should be deleted, etc.</span>
        <span class="c">///</span><span class="c"> Cmdlets can use ShouldContinue to store YesToAll/NoToAll members</span>
        <span class="c">///</span><span class="c"> for each such &quot;class&quot; to keep track of whether the user has</span>
        <span class="c">///</span><span class="c"> confirmed &quot;delete all read-only files&quot; etc.</span>
        <span class="c">///</span><span class="c"> ShouldProcess offers YesToAll/NoToAll automatically,</span>
        <span class="c">///</span><span class="c"> but answering YesToAll or NoToAll applies to all subsequent calls</span>
        <span class="c">///</span><span class="c"> to ShouldProcess for the Cmdlet instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;</span><span class="c">snippet</span> <span class="c">Code</span><span class="c">=</span><span class="c">&quot;</span><span class="c">C#</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">         namespace Microsoft.Samples.MSH.Cmdlet</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             [Cmdlet(VerbsCommon.Remove,&quot;myobjecttype4&quot;)]</span>
        <span class="c">///</span><span class="c">             public class RemoveMyObjectType5 : Cmdlet</span>
        <span class="c">///</span><span class="c">             {</span>
        <span class="c">///</span><span class="c">                 [Parameter( Mandatory = true )]</span>
        <span class="c">///</span><span class="c">                 public string Filename</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return filename; }</span>
        <span class="c">///</span><span class="c">                     set { filename = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private string filename;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 [Parameter]</span>
        <span class="c">///</span><span class="c">                 public SwitchParameter Force</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     get { return force; }</span>
        <span class="c">///</span><span class="c">                     set { force = value; }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">                 private bool force;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 private bool yesToAll;</span>
        <span class="c">///</span><span class="c">                 private bool noToAll;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">                 public override void ProcessRecord()</span>
        <span class="c">///</span><span class="c">                 {</span>
        <span class="c">///</span><span class="c">                     if (ShouldProcess(</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Deleting file {0}&quot;,filename),</span>
        <span class="c">///</span><span class="c">                         string.Format(&quot;Are you sure you want to delete file {0}&quot;, filename),</span>
        <span class="c">///</span><span class="c">                         &quot;Delete file&quot;))</span>
        <span class="c">///</span><span class="c">                     {</span>
        <span class="c">///</span><span class="c">                         if (IsReadOnly(filename))</span>
        <span class="c">///</span><span class="c">                         {</span>
        <span class="c">///</span><span class="c">                             if (!Force </span><span class="c">&amp;amp;</span><span class="c">&amp;amp;</span><span class="c"> !ShouldContinue(</span>
        <span class="c">///</span><span class="c">                                     string.Format(&quot;File {0} is read-only.  Are you sure you want to delete read-only file {0}?&quot;, filename),</span>
        <span class="c">///</span><span class="c">                                     &quot;Delete file&quot;),</span>
        <span class="c">///</span><span class="c">                                     ref yesToAll,</span>
        <span class="c">///</span><span class="c">                                     ref noToAll</span>
        <span class="c">///</span><span class="c">                                     )</span>
        <span class="c">///</span><span class="c">                             {</span>
        <span class="c">///</span><span class="c">                                 return;</span>
        <span class="c">///</span><span class="c">                             }</span>
        <span class="c">///</span><span class="c">                         }</span>
        <span class="c">///</span><span class="c">                         // delete the object</span>
        <span class="c">///</span><span class="c">                     }</span>
        <span class="c">///</span><span class="c">                 }</span>
        <span class="c">///</span><span class="c">             }</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     </span><span class="c">&lt;/</span><span class="c">snippet</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#7c0240b4b2b7c267" class="i method">ShouldContinue</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#45a4136cf5b777da" class="i method">ShouldProcess</a>(<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#6babd36f7e136213" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1045:DoNotPassTypesByReference&quot;</span>)]
        <b>public bool</b> <a id="e346064898773ae2" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldContinue</a>(
            <b>string</b> <span id="r41 rd" class="r41 r">query</span>, <b>string</b> <span id="r42 rd" class="r42 r">caption</span>, <b>bool</b> <span id="r43 rd" class="r43 r">hasSecurityImpact</span>, <b>ref bool</b> <span id="r44 rd" class="r44 r">yesToAll</span>, <b>ref bool</b> <span id="r45 rd" class="r45 r">noToAll</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                {
                    <a href="ICommandRuntime.cs.html#5043391d15599ea3" class="t t">ICommandRuntime2</a> <span id="r46 rd" class="r46 r">runtime2</span> = <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> <b>as</b> <a href="ICommandRuntime.cs.html#5043391d15599ea3" class="t t">ICommandRuntime2</a>;
                    <b>if</b> (<span class="r46 r">runtime2</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="r46 r">runtime2</span>.<span class="i">ShouldContinue</span>(<span class="r41 r">query</span>, <span class="r42 r">caption</span>, <span class="r43 r">hasSecurityImpact</span>, <b>ref</b> <span class="r44 r">yesToAll</span>, <b>ref</b> <span class="r45 r">noToAll</span>);
                    }
                    <b>else</b>
                    {
                        <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<span class="i">ShouldContinue</span>(<span class="r41 r">query</span>, <span class="r42 r">caption</span>, <b>ref</b> <span class="r44 r">yesToAll</span>, <b>ref</b> <span class="r45 r">noToAll</span>);
                    }
                }
                <b>else</b>
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Run the cmdlet and get the results as a collection. This is an internal</span>
        <span class="c">///</span><span class="c"> routine that is used by Invoke to build the underlying collection of</span>
        <span class="c">///</span><span class="c"> results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Returns an list of results.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<b>object</b>&gt; <a id="6d4ec30e22a1a877" href="../R/6d4ec30e22a1a877.html" target="n" data-glyph="74,1" class="i method">GetResults</a>()
        {
            <span class="c">// Prevent invocation of things that derive from PSCmdlet.</span>
            <b>if</b> (<a href="#b0d421ff1d7581f9" class="k">this</a> <b>is</b> <a href="../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>)
            {
                <b>string</b> <span id="r47 rd" class="r47 r">msg</span> = <span class="i">CommandBaseStrings</span>.<span class="i">CannotInvokePSCmdletsDirectly</span>;
 
                <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">InvalidOperationException</span>(<span class="r47 r">msg</span>);
            }
 
            <b>var</b> <span id="r48 rd" class="r48 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
            <b>if</b> (<a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> == <b>null</b>)
            {
                <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#fa3830ca3ad4b256" class="i property">CommandRuntime</a> = <b>new</b> <a href="DefaultCommandRuntime.cs.html#859f59f7e1a47f93" class="t constructor">DefaultCommandRuntime</a>(<span class="r48 r">result</span>);
            }
 
            <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#ca41319604ac804f" class="i method">BeginProcessing</a>();
            <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#f98800b8478b2288" class="i method">ProcessRecord</a>();
            <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#a5fa661c704b7117" class="i method">EndProcessing</a>();
 
            <b>return</b> <span class="r48 r">result</span>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke this cmdlet object returning a collection of results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The results that were produced by this class.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IEnumerable</span> <a id="74225c7aa50345b4" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Invoke</a>()
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r49 rd" class="r49 r">data</span> = <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#6d4ec30e22a1a877" class="i method">GetResults</a>();
                <b>for</b> (<b>int</b> <span id="r50 rd" class="r50 r">i</span> = 0; <span class="r50 r">i</span> &lt; <span class="r49 r">data</span>.<span class="i">Count</span>; <span class="r50 r">i</span>++)
                    <b>yield</b> <b>return</b> <span class="r49 r">data</span>[<span class="r50 r">i</span>];
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a strongly-typed enumerator for the results of this cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type returned by the enumerator</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An instance of the appropriate enumerator.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidCastException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown when the object returned by the cmdlet cannot be converted to the target type.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IEnumerable</span>&lt;<span class="r51 r t">T</span>&gt; <a id="b16be0bb50d56431" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Invoke</a>&lt;<span id="r51 rd t" class="r51 r t">T</span>&gt;()
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r52 rd" class="r52 r">data</span> = <a href="#b0d421ff1d7581f9" class="k">this</a>.<a href="#6d4ec30e22a1a877" class="i method">GetResults</a>();
                <b>for</b> (<b>int</b> <span id="r53 rd" class="r53 r">i</span> = 0; <span class="r53 r">i</span> &lt; <span class="r52 r">data</span>.<span class="i">Count</span>; <span class="r53 r">i</span>++)
                    <b>yield</b> <b>return</b> (<span class="r51 r t">T</span>)<span class="r52 r">data</span>[<span class="r53 r">i</span>];
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ShouldContinue
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Transaction Support
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if a transaction is available and active.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="794277d21aa1757e" href="../R/794277d21aa1757e.html" target="n" data-glyph="72,1" class="i method">TransactionAvailable</a>()
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#b4a196b557bc25bd" class="i method">TransactionAvailable</a>();
                <b>else</b>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> suppress 56503
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;TransactionAvailable&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an object that surfaces the current PowerShell transaction.</span>
        <span class="c">///</span><span class="c"> When this object is disposed, PowerShell resets the active transaction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1065:DoNotRaiseExceptionsInUnexpectedLocations&quot;</span>)]
        <b>public</b> <a href="../CoreCLR/CorePsStub.cs.html#f4565df9151a2fcf" class="t t">PSTransactionContext</a> <a id="64c8f19647a51837" href="../R/64c8f19647a51837.html" target="n" data-glyph="102,1" class="i property">CurrentPSTransaction</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                    <b>return</b> <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#d0aa35ea79ee2b0d" class="i property">CurrentPSTransaction</a>;
                <b>else</b>
                    <span class="c">// We want to throw in this situation, and want to use a</span>
                    <span class="c">// property because it mimics the C# using(TransactionScope ...) syntax</span>
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">NotImplementedException</span>(<span class="s">&quot;CurrentPSTransaction&quot;</span>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Transaction Support
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ThrowTerminatingError
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Terminate the command and report an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error which caused the command to be terminated</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> always</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> terminates the command, where</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ICommandRuntime.cs.html#ea5faa24de5f394a" class="t t">ICommandRuntime</a>.<a href="ICommandRuntime.cs.html#3238d38a6aa8a1ed" class="i method">WriteError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> allows the command to continue.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The cmdlet can also terminate the command by simply throwing</span>
        <span class="c">///</span><span class="c"> any exception.  When the cmdlet&#39;s implementation of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#f98800b8478b2288" class="i method">ProcessRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#ca41319604ac804f" class="i method">BeginProcessing</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#a5fa661c704b7117" class="i method">EndProcessing</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> throws an exception, the Engine will always catch the exception</span>
        <span class="c">///</span><span class="c"> and report it as a terminating error.</span>
        <span class="c">///</span><span class="c"> However, it is preferred for the cmdlet to call</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> so that the additional information in</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> is available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#e3346d70990a1763" class="i method">ThrowTerminatingError</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> always throws</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> regardless of what error was specified in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">errorRecord</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> The Cmdlet should generally just allow</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> to percolate up to the caller of</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#f98800b8478b2288" class="i method">ProcessRecord</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>.<span class="i">DoesNotReturn</span>]
        <b>public void</b> <a id="e3346d70990a1763" href="../R/e3346d70990a1763.html" target="n" data-glyph="72,1" class="i method">ThrowTerminatingError</a>(<a href="ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r54 rd" class="r54 r">errorRecord</span>)
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
                <b>if</b> (<span class="r54 r">errorRecord</span> == <b>null</b>)
                    <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r54 r">errorRecord</span>));
 
                <b>if</b> (<a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a> != <b>null</b>)
                {
                    <a href="CommandBase.cs.html#71eb09c6dd471a86" class="i field">commandRuntime</a>.<a href="ICommandRuntime.cs.html#a203cbbfd6c76e57" class="i method">ThrowTerminatingError</a>(<span class="r54 r">errorRecord</span>);
                }
                <b>else</b> <b>if</b> (<span class="r54 r">errorRecord</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a> != <b>null</b>)
                {
                    <b>throw</b> <span class="r54 r">errorRecord</span>.<a href="ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>;
                }
                <b>else</b>
                {
                    <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">InvalidOperationException</span>(<span class="r54 r">errorRecord</span>.<a href="ErrorPackage.cs.html#cab659be098926dd" class="i method">ToString</a>());
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ThrowTerminatingError
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Exposed API Override
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, performs initialization</span>
        <span class="c">///</span><span class="c"> of command execution.</span>
        <span class="c">///</span><span class="c"> Default implementation in the base class just returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual Cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="ca41319604ac804f" href="../R/ca41319604ac804f.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, performs execution</span>
        <span class="c">///</span><span class="c"> of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual Cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="f98800b8478b2288" href="../R/f98800b8478b2288.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, performs clean-up</span>
        <span class="c">///</span><span class="c"> after the command execution.</span>
        <span class="c">///</span><span class="c"> Default implementation in the base class just returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual Cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="a5fa661c704b7117" href="../R/a5fa661c704b7117.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When overridden in the derived class, interrupts currently</span>
        <span class="c">///</span><span class="c"> running code within the command. It should interrupt BeginProcessing,</span>
        <span class="c">///</span><span class="c"> ProcessRecord, and EndProcessing.</span>
        <span class="c">///</span><span class="c"> Default implementation in the base class just returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Exception</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is overridden in the implementation of</span>
        <span class="c">///</span><span class="c"> individual Cmdlets, and can throw literally any exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="ed29eac69e2abf69" href="../R/ed29eac69e2abf69.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <b>using</b> (<a href="../CoreCLR/CorePsStub.cs.html#6d758ac5b09394e4" class="t t">PSTransactionManager</a>.<a href="../CoreCLR/CorePsStub.cs.html#d6d4cf3db02d03bb" class="i method">GetEngineProtectionScope</a>())
            {
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Exposed API Override
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public_methods
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This describes the reason why ShouldProcess returned what it returned.</span>
    <span class="c">///</span><span class="c"> Not all possible reasons are covered.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="#fee13e39455d3a34" class="i method">ShouldProcess</a>(<b>string</b>,<b>string</b>,<b>string</b>,<b>out</b> <a href="#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="40cc5cec3eccab94" href="../R/40cc5cec3eccab94.html" target="n" data-glyph="18,0" class="t t"><span id="cc7203fa3b29f5e6">ShouldProcessReason</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c"> none of the reasons below </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="401296eb0e0f2185" href="../R/401296eb0e0f2185.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WhatIf behavior was requested.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In the MSH host, WhatIf behavior can be requested explicitly</span>
        <span class="c">///</span><span class="c"> for one cmdlet instance using the -WhatIf commandline parameter,</span>
        <span class="c">///</span><span class="c"> or implicitly for all SupportsShouldProcess cmdlets with $WhatIfPreference.</span>
        <span class="c">///</span><span class="c"> Other hosts may have other ways to request WhatIf behavior.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="21f7663d1daafa62" href="../R/21f7663d1daafa62.html" target="n" data-glyph="24,1" class="i field">WhatIf</a> = 0x1,
    }
}
</pre></td></tr></table></div></body></html>
