<!DOCTYPE html>
<html><head><title>TypeMetadata.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1553);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/TypeMetadata.cs" target="_top">engine\TypeMetadata.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Debug</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class represents the compiled metadata for a parameter set.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="3ad07bd1eab767d8" href="../R/3ad07bd1eab767d8.html" target="n" data-glyph="0,0" class="t t">ParameterSetMetadata</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private bool</b> <a id="c4ab7a76fccec088" href="../R/c4ab7a76fccec088.html" target="n" data-glyph="46,1" class="i field">_isMandatory</a>;
        <b>private int</b> <a id="a5af6a94de717268" href="../R/a5af6a94de717268.html" target="n" data-glyph="46,1" class="i field">_position</a>;
        <b>private bool</b> <a id="e2203e6e6da9e57b" href="../R/e2203e6e6da9e57b.html" target="n" data-glyph="46,1" class="i field">_valueFromPipeline</a>;
        <b>private bool</b> <a id="da8ce6ec48d593fd" href="../R/da8ce6ec48d593fd.html" target="n" data-glyph="46,1" class="i field">_valueFromPipelineByPropertyName</a>;
        <b>private bool</b> <a id="cbb30278cddc4665" href="../R/cbb30278cddc4665.html" target="n" data-glyph="46,1" class="i field">_valueFromRemainingArguments</a>;
        <b>private string</b> <a id="82e97dfb6d50caf9" href="../R/82e97dfb6d50caf9.html" target="n" data-glyph="46,1" class="i field">_helpMessage</a>;
        <b>private string</b> <a id="f8f5d5927b670b77" href="../R/f8f5d5927b670b77.html" target="n" data-glyph="46,1" class="i field">_helpMessageBaseName</a>;
        <b>private string</b> <a id="f3225a5d21b61709" href="../R/f3225a5d21b61709.html" target="n" data-glyph="46,1" class="i field">_helpMessageResourceId</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">psMD</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e9398807b617e586" href="../R/e9398807b617e586.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetMetadata</a>(<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r0 rd" class="r0 r">psMD</span>)
        {
            <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r0 r">psMD</span> != <b>null</b>, <span class="s">&quot;ParameterSetSpecificMetadata cannot be null&quot;</span>);
            <a href="#dc1e8817172a1138" class="i method">Initialize</a>(<span class="r0 r">psMD</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A copy constructor that creates a deep copy of the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">other</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> ParameterSetMetadata object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">other</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to copy.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7d394d5a70690006" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetMetadata</a>(<a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a> <span id="r1 rd" class="r1 r">other</span>)
        {
            <b>if</b> (<span class="r1 r">other</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1 r">other</span>));
            }
 
            <a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a> = <span class="r1 r">other</span>.<a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a>;
            <a href="#f8f5d5927b670b77" class="i field">_helpMessageBaseName</a> = <span class="r1 r">other</span>.<a href="#f8f5d5927b670b77" class="i field">_helpMessageBaseName</a>;
            <a href="#f3225a5d21b61709" class="i field">_helpMessageResourceId</a> = <span class="r1 r">other</span>.<a href="#f3225a5d21b61709" class="i field">_helpMessageResourceId</a>;
            <a href="#c4ab7a76fccec088" class="i field">_isMandatory</a> = <span class="r1 r">other</span>.<a href="#c4ab7a76fccec088" class="i field">_isMandatory</a>;
            <a href="#a5af6a94de717268" class="i field">_position</a> = <span class="r1 r">other</span>.<a href="#a5af6a94de717268" class="i field">_position</a>;
            <a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a> = <span class="r1 r">other</span>.<a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a>;
            <a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a> = <span class="r1 r">other</span>.<a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a>;
            <a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a> = <span class="r1 r">other</span>.<a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the parameter is mandatory for this parameterset, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="283fb56a052f5b50" href="../R/283fb56a052f5b50.html" target="n" data-glyph="102,1" class="i property">IsMandatory</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c4ab7a76fccec088" class="i field">_isMandatory</a>;
            }
 
            <b>set</b>
            {
                <a href="#c4ab7a76fccec088" class="i field">_isMandatory</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the parameter is allowed to be positional for this parameter set, this returns</span>
        <span class="c">///</span><span class="c"> the position it is allowed to be in. If it is not positional, this returns int.MinValue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public int</b> <a id="620667384c6972cf" href="../R/620667384c6972cf.html" target="n" data-glyph="102,1" class="i property">Position</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a5af6a94de717268" class="i field">_position</a>;
            }
 
            <b>set</b>
            {
                <a href="#a5af6a94de717268" class="i field">_position</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies that this parameter can take values from the incoming pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="42dda21263485bc8" href="../R/42dda21263485bc8.html" target="n" data-glyph="102,1" class="i property">ValueFromPipeline</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a>;
            }
 
            <b>set</b>
            {
                <a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies that this parameter can take values from a property from the incoming</span>
        <span class="c">///</span><span class="c"> pipeline object with the same name as the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="234d26f3a22f2e9e" href="../R/234d26f3a22f2e9e.html" target="n" data-glyph="102,1" class="i property">ValueFromPipelineByPropertyName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a>;
            }
 
            <b>set</b>
            {
                <a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies if this parameter takes all the remaining unbound</span>
        <span class="c">///</span><span class="c"> arguments that were specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="56989427e0a6e9c0" href="../R/56989427e0a6e9c0.html" target="n" data-glyph="102,1" class="i property">ValueFromRemainingArguments</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a>;
            }
 
            <b>set</b>
            {
                <a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A short description for this parameter, suitable for presentation as a tool tip.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="94a13fefbf6d5886" href="../R/94a13fefbf6d5886.html" target="n" data-glyph="102,1" class="i property">HelpMessage</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a>;
            }
 
            <b>set</b>
            {
                <a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The base name of the resource for a help message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b6f97301ed870640" href="../R/b6f97301ed870640.html" target="n" data-glyph="102,1" class="i property">HelpMessageBaseName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f8f5d5927b670b77" class="i field">_helpMessageBaseName</a>;
            }
 
            <b>set</b>
            {
                <a href="#f8f5d5927b670b77" class="i field">_helpMessageBaseName</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Id of the resource for a help message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="d68147e47d55a741" href="../R/d68147e47d55a741.html" target="n" data-glyph="102,1" class="i property">HelpMessageResourceId</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f3225a5d21b61709" class="i field">_helpMessageResourceId</a>;
            }
 
            <b>set</b>
            {
                <a href="#f3225a5d21b61709" class="i field">_helpMessageResourceId</a> = <b>value</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private / Internal Methods &amp; Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">psMD</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="dc1e8817172a1138" href="../R/dc1e8817172a1138.html" target="n" data-glyph="74,1" class="i method">Initialize</a>(<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r2 rd" class="r2 r">psMD</span>)
        {
            <a href="#c4ab7a76fccec088" class="i field">_isMandatory</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#9ef997a363d3cc80" class="i property">IsMandatory</a>;
            <a href="#a5af6a94de717268" class="i field">_position</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#5fe039f108b3ea8f" class="i property">Position</a>;
            <a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a>;
            <a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#9d3ceb11c1e2558a" class="i property">ValueFromPipelineByPropertyName</a>;
            <a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a>;
            <a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#067ab0fb1477db92" class="i property">HelpMessage</a>;
            <a href="#f8f5d5927b670b77" class="i field">_helpMessageBaseName</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#5f25034a4b159117" class="i property">HelpMessageBaseName</a>;
            <a href="#f3225a5d21b61709" class="i field">_helpMessageResourceId</a> = <span class="r2 r">psMD</span>.<a href="ParameterSetSpecificMetadata.cs.html#bf3aa755a84c5c70" class="i property">HelpMessageResourceId</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compares this instance with the supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">second</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">second</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object to compare this instance with</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the metadata is same. false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="7dad26b3169df6ac" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Equals</a>(<a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a> <span id="r3 rd" class="r3 r">second</span>)
        {
            <b>if</b> ((<a href="#c4ab7a76fccec088" class="i field">_isMandatory</a> != <span class="r3 r">second</span>.<a href="#c4ab7a76fccec088" class="i field">_isMandatory</a>) ||
                (<a href="#a5af6a94de717268" class="i field">_position</a> != <span class="r3 r">second</span>.<a href="#a5af6a94de717268" class="i field">_position</a>) ||
                (<a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a> != <span class="r3 r">second</span>.<a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a>) ||
                (<a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a> != <span class="r3 r">second</span>.<a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a>) ||
                (<a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a> != <span class="r3 r">second</span>.<a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a>) ||
                (<a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a> != <span class="r3 r">second</span>.<a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a>) ||
                (<a href="#f8f5d5927b670b77" class="i field">_helpMessageBaseName</a> != <span class="r3 r">second</span>.<a href="#f8f5d5927b670b77" class="i field">_helpMessageBaseName</a>) ||
                (<a href="#f3225a5d21b61709" class="i field">_helpMessageResourceId</a> != <span class="r3 r">second</span>.<a href="#f3225a5d21b61709" class="i field">_helpMessageResourceId</a>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Efficient serialization + rehydration logic
 
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="6a4c3e1acdb95960" href="../R/6a4c3e1acdb95960.html" target="n" data-glyph="20,1" class="t t"><span id="4da94473790918cb">ParameterFlags</span></a> : <b>uint</b>
        {
            <a id="f307820c98dcae7c" href="../R/f307820c98dcae7c.html" target="n" data-glyph="24,2" class="i field">Mandatory</a> = 0x01,
            <a id="097b158bf63460a7" href="../R/097b158bf63460a7.html" target="n" data-glyph="24,2" class="i field">ValueFromPipeline</a> = 0x02,
            <a id="0434f4f99e37f1f6" href="../R/0434f4f99e37f1f6.html" target="n" data-glyph="24,2" class="i field">ValueFromPipelineByPropertyName</a> = 0x04,
            <a id="e6fdc53e5577f172" href="../R/e6fdc53e5577f172.html" target="n" data-glyph="24,2" class="i field">ValueFromRemainingArguments</a> = 0x08,
        }
 
        <b>internal</b> <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a> <a id="2bcc204c02219a15" href="../R/2bcc204c02219a15.html" target="n" data-glyph="104,1" class="i property">Flags</a>
        {
            <b>get</b>
            {
                <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a> <span id="r4 rd" class="r4 r">flags</span> = 0;
                <b>if</b> (<a href="#283fb56a052f5b50" class="i property">IsMandatory</a>) { <span class="r4 r">flags</span> |= <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#f307820c98dcae7c" class="i field">Mandatory</a>; }
 
                <b>if</b> (<a href="#42dda21263485bc8" class="i property">ValueFromPipeline</a>) { <span class="r4 r">flags</span> |= <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#097b158bf63460a7" class="i field">ValueFromPipeline</a>; }
 
                <b>if</b> (<a href="#234d26f3a22f2e9e" class="i property">ValueFromPipelineByPropertyName</a>) { <span class="r4 r">flags</span> |= <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#0434f4f99e37f1f6" class="i field">ValueFromPipelineByPropertyName</a>; }
 
                <b>if</b> (<a href="#56989427e0a6e9c0" class="i property">ValueFromRemainingArguments</a>) { <span class="r4 r">flags</span> |= <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#e6fdc53e5577f172" class="i field">ValueFromRemainingArguments</a>; }
 
                <b>return</b> <span class="r4 r">flags</span>;
            }
 
            <b>set</b>
            {
                <a href="#3ad07bd1eab767d8" class="k">this</a>.<a href="#283fb56a052f5b50" class="i property">IsMandatory</a> = ((<b>value</b> &amp; <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#f307820c98dcae7c" class="i field">Mandatory</a>) == <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#f307820c98dcae7c" class="i field">Mandatory</a>);
                <a href="#3ad07bd1eab767d8" class="k">this</a>.<a href="#42dda21263485bc8" class="i property">ValueFromPipeline</a> = ((<b>value</b> &amp; <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#097b158bf63460a7" class="i field">ValueFromPipeline</a>) == <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#097b158bf63460a7" class="i field">ValueFromPipeline</a>);
                <a href="#3ad07bd1eab767d8" class="k">this</a>.<a href="#234d26f3a22f2e9e" class="i property">ValueFromPipelineByPropertyName</a> = ((<b>value</b> &amp; <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#0434f4f99e37f1f6" class="i field">ValueFromPipelineByPropertyName</a>) == <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#0434f4f99e37f1f6" class="i field">ValueFromPipelineByPropertyName</a>);
                <a href="#3ad07bd1eab767d8" class="k">this</a>.<a href="#56989427e0a6e9c0" class="i property">ValueFromRemainingArguments</a> = ((<b>value</b> &amp; <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#e6fdc53e5577f172" class="i field">ValueFromRemainingArguments</a>) == <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="#e6fdc53e5577f172" class="i field">ValueFromRemainingArguments</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used by rehydration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7058f55e15034cae" href="../R/7058f55e15034cae.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetMetadata</a>(
            <b>int</b> <span id="r5 rd" class="r5 r">position</span>,
            <a href="#6a4c3e1acdb95960" class="t t">ParameterFlags</a> <span id="r6 rd" class="r6 r">flags</span>,
            <b>string</b> <span id="r7 rd" class="r7 r">helpMessage</span>)
        {
            <a href="#3ad07bd1eab767d8" class="k">this</a>.<a href="#620667384c6972cf" class="i property">Position</a> = <span class="r5 r">position</span>;
            <a href="#3ad07bd1eab767d8" class="k">this</a>.<a href="#2bcc204c02219a15" class="i property">Flags</a> = <span class="r6 r">flags</span>;
            <a href="#3ad07bd1eab767d8" class="k">this</a>.<a href="#94a13fefbf6d5886" class="i property">HelpMessage</a> = <span class="r7 r">helpMessage</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Proxy Parameter Generation
 
        <b>private const string</b> <a id="4209981781cb3e3b" href="../R/4209981781cb3e3b.html" target="n" data-glyph="10,1" class="i field">MandatoryFormat</a> = <span class="s">@&quot;{0}Mandatory=$true&quot;</span>;
        <b>private const string</b> <a id="7a93a99e4ef8ed19" href="../R/7a93a99e4ef8ed19.html" target="n" data-glyph="10,1" class="i field">PositionFormat</a> = <span class="s">@&quot;{0}Position={1}&quot;</span>;
        <b>private const string</b> <a id="9fba69d3c7b4ff07" href="../R/9fba69d3c7b4ff07.html" target="n" data-glyph="10,1" class="i field">ValueFromPipelineFormat</a> = <span class="s">@&quot;{0}ValueFromPipeline=$true&quot;</span>;
        <b>private const string</b> <a id="b1ebb5ca25b5113c" href="../R/b1ebb5ca25b5113c.html" target="n" data-glyph="10,1" class="i field">ValueFromPipelineByPropertyNameFormat</a> = <span class="s">@&quot;{0}ValueFromPipelineByPropertyName=$true&quot;</span>;
        <b>private const string</b> <a id="cc2724a16c0cf4ab" href="../R/cc2724a16c0cf4ab.html" target="n" data-glyph="10,1" class="i field">ValueFromRemainingArgumentsFormat</a> = <span class="s">@&quot;{0}ValueFromRemainingArguments=$true&quot;</span>;
        <b>private const string</b> <a id="86361748f1a4fab5" href="../R/86361748f1a4fab5.html" target="n" data-glyph="10,1" class="i field">HelpMessageFormat</a> = <span class="s">@&quot;{0}HelpMessage=&#39;{1}&#39;&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="3a387016f0aef4b3" href="../R/3a387016f0aef4b3.html" target="n" data-glyph="74,1" class="i method">GetProxyParameterData</a>()
        {
            <span class="i">Text</span>.<span class="i">StringBuilder</span> <span id="r8 rd" class="r8 r">result</span> = <b>new</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">StringBuilder</span>();
            <b>string</b> <span id="r9 rd" class="r9 r">prefix</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<a href="#c4ab7a76fccec088" class="i field">_isMandatory</a>)
            {
                <span class="r8 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#4209981781cb3e3b" class="i field">MandatoryFormat</a>, <span class="r9 r">prefix</span>);
                <span class="r9 r">prefix</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <b>if</b> (<a href="#a5af6a94de717268" class="i field">_position</a> != <span class="i">Int32</span>.<span class="i">MinValue</span>)
            {
                <span class="r8 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#7a93a99e4ef8ed19" class="i field">PositionFormat</a>, <span class="r9 r">prefix</span>, <a href="#a5af6a94de717268" class="i field">_position</a>);
                <span class="r9 r">prefix</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <b>if</b> (<a href="#e2203e6e6da9e57b" class="i field">_valueFromPipeline</a>)
            {
                <span class="r8 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#9fba69d3c7b4ff07" class="i field">ValueFromPipelineFormat</a>, <span class="r9 r">prefix</span>);
                <span class="r9 r">prefix</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <b>if</b> (<a href="#da8ce6ec48d593fd" class="i field">_valueFromPipelineByPropertyName</a>)
            {
                <span class="r8 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#b1ebb5ca25b5113c" class="i field">ValueFromPipelineByPropertyNameFormat</a>, <span class="r9 r">prefix</span>);
                <span class="r9 r">prefix</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <b>if</b> (<a href="#cbb30278cddc4665" class="i field">_valueFromRemainingArguments</a>)
            {
                <span class="r8 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#cc2724a16c0cf4ab" class="i field">ValueFromRemainingArgumentsFormat</a>, <span class="r9 r">prefix</span>);
                <span class="r9 r">prefix</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a>))
            {
                <span class="r8 r">result</span>.<span class="i">AppendFormat</span>(
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#86361748f1a4fab5" class="i field">HelpMessageFormat</a>,
                    <span class="r9 r">prefix</span>,
                    <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#82e97dfb6d50caf9" class="i field">_helpMessage</a>));
                <span class="r9 r">prefix</span> = <span class="s">&quot;, &quot;</span>;
            }
 
            <b>return</b> <span class="r8 r">result</span>.<span class="i">ToString</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class represents the compiled metadata for a parameter.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="8202ce4164ad3758" href="../R/8202ce4164ad3758.html" target="n" data-glyph="0,0" class="t t">ParameterMetadata</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private string</b> <a id="0d89ad3e8aaa8701" href="../R/0d89ad3e8aaa8701.html" target="n" data-glyph="46,1" class="i field">_name</a>;
        <b>private</b> <span class="i">Type</span> <a id="fd93349a13aebcff" href="../R/fd93349a13aebcff.html" target="n" data-glyph="46,1" class="i field">_parameterType</a>;
        <b>private bool</b> <a id="9a11ae8e9af4b886" href="../R/9a11ae8e9af4b886.html" target="n" data-glyph="46,1" class="i field">_isDynamic</a>;
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>&gt; <a id="673e2b802878ec27" href="../R/673e2b802878ec27.html" target="n" data-glyph="46,1" class="i field">_parameterSets</a>;
        <b>private</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="d31f7dcacbcce700" href="../R/d31f7dcacbcce700.html" target="n" data-glyph="46,1" class="i field">_aliases</a>;
        <b>private</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <a id="df4711f2d77f29b5" href="../R/df4711f2d77f29b5.html" target="n" data-glyph="46,1" class="i field">_attributes</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a ParameterMetadata instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="65e0a2cab6ea9bce" href="../R/65e0a2cab6ea9bce.html" target="n" data-glyph="72,1" class="t constructor">ParameterMetadata</a>(<b>string</b> <span id="r10 rd" class="r10 r">name</span>)
            : <a href="#c71723d4ad973d6c" class="k">this</a>(<span class="r10 r">name</span>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a ParameterMetadata instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">parameterType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Type of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="c71723d4ad973d6c" href="../R/c71723d4ad973d6c.html" target="n" data-glyph="72,1" class="t constructor">ParameterMetadata</a>(<b>string</b> <span id="r11 rd" class="r11 r">name</span>, <span class="i">Type</span> <span id="r12 rd" class="r12 r">parameterType</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r11 r">name</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r11 r">name</span>));
            }
 
            <a href="#0d89ad3e8aaa8701" class="i field">_name</a> = <span class="r11 r">name</span>;
            <a href="#fd93349a13aebcff" class="i field">_parameterType</a> = <span class="r12 r">parameterType</span>;
 
            <a href="#df4711f2d77f29b5" class="i field">_attributes</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;();
            <a href="#d31f7dcacbcce700" class="i field">_aliases</a> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <a href="#673e2b802878ec27" class="i field">_parameterSets</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A copy constructor that creates a deep copy of the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">other</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> ParameterMetadata object.</span>
        <span class="c">///</span><span class="c"> Instances of Attribute and Type classes are copied by reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">other</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to copy.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8ef731bbfd2a986d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ParameterMetadata</a>(<a href="#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r13 rd" class="r13 r">other</span>)
        {
            <b>if</b> (<span class="r13 r">other</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r13 r">other</span>));
            }
 
            <a href="#9a11ae8e9af4b886" class="i field">_isDynamic</a> = <span class="r13 r">other</span>.<a href="#9a11ae8e9af4b886" class="i field">_isDynamic</a>;
            <a href="#0d89ad3e8aaa8701" class="i field">_name</a> = <span class="r13 r">other</span>.<a href="#0d89ad3e8aaa8701" class="i field">_name</a>;
            <a href="#fd93349a13aebcff" class="i field">_parameterType</a> = <span class="r13 r">other</span>.<a href="#fd93349a13aebcff" class="i field">_parameterType</a>;
 
            <span class="c">// deep copy</span>
            <a href="#d31f7dcacbcce700" class="i field">_aliases</a> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r13 r">other</span>.<a href="#d31f7dcacbcce700" class="i field">_aliases</a>.<span class="i">Count</span>));
            <b>foreach</b> (<b>string</b> <span id="r14 rd" class="r14 r">alias</span> <b>in</b> <span class="r13 r">other</span>.<a href="#d31f7dcacbcce700" class="i field">_aliases</a>)
            {
                <a href="#d31f7dcacbcce700" class="i field">_aliases</a>.<span class="i">Add</span>(<span class="r14 r">alias</span>);
            }
 
            <span class="c">// deep copy of the collection, collection items (Attributes) copied by reference</span>
            <b>if</b> (<span class="r13 r">other</span>.<a href="#df4711f2d77f29b5" class="i field">_attributes</a> == <b>null</b>)
            {
                <a href="#df4711f2d77f29b5" class="i field">_attributes</a> = <b>null</b>;
            }
            <b>else</b>
            {
                <a href="#df4711f2d77f29b5" class="i field">_attributes</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;(<b>new</b> <span class="i">List</span>&lt;<span class="i">Attribute</span>&gt;(<span class="r13 r">other</span>.<a href="#df4711f2d77f29b5" class="i field">_attributes</a>.<span class="i">Count</span>));
                <b>foreach</b> (<span class="i">Attribute</span> <span id="r15 rd" class="r15 r">attribute</span> <b>in</b> <span class="r13 r">other</span>.<a href="#df4711f2d77f29b5" class="i field">_attributes</a>)
                {
                    <a href="#df4711f2d77f29b5" class="i field">_attributes</a>.<span class="i">Add</span>(<span class="r15 r">attribute</span>);
                }
            }
 
            <span class="c">// deep copy</span>
            <a href="#673e2b802878ec27" class="i field">_parameterSets</a> = <b>null</b>;
            <b>if</b> (<span class="r13 r">other</span>.<a href="#673e2b802878ec27" class="i field">_parameterSets</a> == <b>null</b>)
            {
                <a href="#673e2b802878ec27" class="i field">_parameterSets</a> = <b>null</b>;
            }
            <b>else</b>
            {
                <a href="#673e2b802878ec27" class="i field">_parameterSets</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>&gt;(<span class="r13 r">other</span>.<a href="#673e2b802878ec27" class="i field">_parameterSets</a>.<span class="i">Count</span>);
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>&gt; <span id="r16 rd" class="r16 r">entry</span> <b>in</b> <span class="r13 r">other</span>.<a href="#673e2b802878ec27" class="i field">_parameterSets</a>)
                {
                    <a href="#673e2b802878ec27" class="i field">_parameterSets</a>.<span class="i">Add</span>(<span class="r16 r">entry</span>.<span class="i">Key</span>, <b>new</b> <span class="t">ParameterSetMetadata</span>(<span class="r16 r">entry</span>.<span class="i">Value</span>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An internal constructor which constructs a ParameterMetadata object</span>
        <span class="c">///</span><span class="c"> from compiled command parameter metadata. ParameterMetadata</span>
        <span class="c">///</span><span class="c"> is a proxy written on top of CompiledCommandParameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">cmdParameterMD</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal CompiledCommandParameter metadata</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="f52c31fb7fafa0b1" href="../R/f52c31fb7fafa0b1.html" target="n" data-glyph="74,1" class="t constructor">ParameterMetadata</a>(<a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r17 rd" class="r17 r">cmdParameterMD</span>)
        {
            <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r17 r">cmdParameterMD</span> != <b>null</b>,
                <span class="s">&quot;CompiledCommandParameter cannot be null&quot;</span>);
 
            <a href="#f130c0a08b2469aa" class="i method">Initialize</a>(<span class="r17 r">cmdParameterMD</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used by implicit remoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="c08aed8fde1461dd" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ParameterMetadata</a>(
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r18 rd" class="r18 r">aliases</span>,
            <b>bool</b> <span id="r19 rd" class="r19 r">isDynamic</span>,
            <b>string</b> <span id="r20 rd" class="r20 r">name</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>&gt; <span id="r21 rd" class="r21 r">parameterSets</span>,
            <span class="i">Type</span> <span id="r22 rd" class="r22 r">parameterType</span>)
        {
            <a href="#d31f7dcacbcce700" class="i field">_aliases</a> = <span class="r18 r">aliases</span>;
            <a href="#9a11ae8e9af4b886" class="i field">_isDynamic</a> = <span class="r19 r">isDynamic</span>;
            <a href="#0d89ad3e8aaa8701" class="i field">_name</a> = <span class="r20 r">name</span>;
            <a href="#673e2b802878ec27" class="i field">_parameterSets</a> = <span class="r21 r">parameterSets</span>;
            <a href="#fd93349a13aebcff" class="i field">_parameterType</a> = <span class="r22 r">parameterType</span>;
            <a href="#df4711f2d77f29b5" class="i field">_attributes</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Methods/Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the name of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="12f6ecd22fc50a11" href="../R/12f6ecd22fc50a11.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#0d89ad3e8aaa8701" class="i field">_name</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<b>value</b>))
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Name&quot;</span>);
                }
 
                <a href="#0d89ad3e8aaa8701" class="i field">_name</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Type information of the Parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="d2c0f0c200c53478" href="../R/d2c0f0c200c53478.html" target="n" data-glyph="102,1" class="i property">ParameterType</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fd93349a13aebcff" class="i field">_parameterType</a>;
            }
 
            <b>set</b>
            {
                <a href="#fd93349a13aebcff" class="i field">_parameterType</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ParameterSets metadata that this parameter belongs to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>&gt; <a id="ddcfa30101fb45a0" href="../R/ddcfa30101fb45a0.html" target="n" data-glyph="102,1" class="i property">ParameterSets</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#673e2b802878ec27" class="i field">_parameterSets</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies if the parameter is Dynamic.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="7fd42dfb4ae4f4fd" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsDynamic</a>
        {
            <b>get</b> { <b>return</b> <a href="#9a11ae8e9af4b886" class="i field">_isDynamic</a>; }
 
            <b>set</b> { <a href="#9a11ae8e9af4b886" class="i field">_isDynamic</a> = <b>value</b>; }
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the alias names for this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="d47a3e4024479369" href="../R/d47a3e4024479369.html" target="n" data-glyph="102,1" class="i property">Aliases</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d31f7dcacbcce700" class="i field">_aliases</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the attributes found on the member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <a id="6e5f6f9087cc2460" href="../R/6e5f6f9087cc2460.html" target="n" data-glyph="102,1" class="i property">Attributes</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#df4711f2d77f29b5" class="i field">_attributes</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies if the parameter is a SwitchParameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4431449ea131b97b" href="../R/4431449ea131b97b.html" target="n" data-glyph="102,1" class="i property">SwitchParameter</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#fd93349a13aebcff" class="i field">_parameterType</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#fd93349a13aebcff" class="i field">_parameterType</a>.<span class="i">Equals</span>(<b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>));
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a dictionary of parameter metadata for the supplied </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLR Type for which the parameter metadata is constructed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A Dictionary of ParameterMetadata keyed by parameter name.</span>
        <span class="c">///</span><span class="c"> null if no parameter metadata is found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> type is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <a id="d132ed958bebe690" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetParameterMetadata</a>(<span class="i">Type</span> <span id="r23 rd" class="r23 r">type</span>)
        {
            <b>if</b> (<span class="r23 r">type</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r23 r">type</span>));
            }
 
            <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r24 rd" class="r24 r">cmdMetaData</span> = <b>new</b> <a href="CommandMetadata.cs.html#b9218398fb562257" class="t constructor">CommandMetadata</a>(<span class="r23 r">type</span>);
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <span id="r25 rd" class="r25 r">result</span> = <span class="r24 r">cmdMetaData</span>.<a href="CommandMetadata.cs.html#3f6c73a7b157f755" class="i property">Parameters</a>;
            <span class="c">// early GC.</span>
            <span class="r24 r">cmdMetaData</span> = <b>null</b>;
            <b>return</b> <span class="r25 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods/Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">compiledParameterMD</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="f130c0a08b2469aa" href="../R/f130c0a08b2469aa.html" target="n" data-glyph="74,1" class="i method">Initialize</a>(<a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r26 rd" class="r26 r">compiledParameterMD</span>)
        {
            <a href="#0d89ad3e8aaa8701" class="i field">_name</a> = <span class="r26 r">compiledParameterMD</span>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
            <a href="#fd93349a13aebcff" class="i field">_parameterType</a> = <span class="r26 r">compiledParameterMD</span>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>;
            <a href="#9a11ae8e9af4b886" class="i field">_isDynamic</a> = <span class="r26 r">compiledParameterMD</span>.<a href="CompiledCommandParameter.cs.html#62f88918e8e4f395" class="i property">IsDynamic</a>;
 
            <span class="c">// Create parameter set metadata</span>
            <a href="#673e2b802878ec27" class="i field">_parameterSets</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>string</b> <span id="r27 rd" class="r27 r">key</span> <b>in</b> <span class="r26 r">compiledParameterMD</span>.<a href="CompiledCommandParameter.cs.html#67c5e886aa97d751" class="i property">ParameterSetData</a>.<span class="i">Keys</span>)
            {
                <a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r28 rd" class="r28 r">pMD</span> = <span class="r26 r">compiledParameterMD</span>.<a href="CompiledCommandParameter.cs.html#67c5e886aa97d751" class="i property">ParameterSetData</a>[<span class="r27 r">key</span>];
                <a href="#673e2b802878ec27" class="i field">_parameterSets</a>.<span class="i">Add</span>(<span class="r27 r">key</span>, <b>new</b> <a href="#e9398807b617e586" class="t constructor">ParameterSetMetadata</a>(<span class="r28 r">pMD</span>));
            }
 
            <span class="c">// Create aliases for this parameter</span>
            <a href="#d31f7dcacbcce700" class="i field">_aliases</a> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<b>string</b> <span id="r29 rd" class="r29 r">alias</span> <b>in</b> <span class="r26 r">compiledParameterMD</span>.<a href="CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>)
            {
                <a href="#d31f7dcacbcce700" class="i field">_aliases</a>.<span class="i">Add</span>(<span class="r29 r">alias</span>);
            }
 
            <span class="c">// Create attributes for this parameter</span>
            <a href="#df4711f2d77f29b5" class="i field">_attributes</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;();
            <b>foreach</b> (<b>var</b> <span id="r30 rd" class="r30 r">attrib</span> <b>in</b> <span class="r26 r">compiledParameterMD</span>.<a href="CompiledCommandParameter.cs.html#f2f9b722fb3a36da" class="i property">CompiledAttributes</a>)
            {
                <a href="#df4711f2d77f29b5" class="i field">_attributes</a>.<span class="i">Add</span>(<span class="r30 r">attrib</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">cmdParameterMetadata</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <a id="048a9efefa0d22ed" href="../R/048a9efefa0d22ed.html" target="n" data-glyph="74,1" class="i method">GetParameterMetadata</a>(<a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a>
            <span id="r31 rd" class="r31 r">cmdParameterMetadata</span>)
        {
            <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r31 r">cmdParameterMetadata</span> != <b>null</b>, <span class="s">&quot;cmdParameterMetadata cannot be null&quot;</span>);
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <span id="r32 rd" class="r32 r">result</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>foreach</b> (<b>var</b> <span id="r33 rd" class="r33 r">keyValuePair</span> <b>in</b> <span class="r31 r">cmdParameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#d586f3508cda9bf3" class="i property">BindableParameters</a>)
            {
                <b>var</b> <span id="r34 rd" class="r34 r">key</span> = <span class="r33 r">keyValuePair</span>.<span class="i">Key</span>;
                <b>var</b> <span id="r35 rd" class="r35 r">mergedCompiledPMD</span> = <span class="r33 r">keyValuePair</span>.<span class="i">Value</span>;
                <a href="#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r36 rd" class="r36 r">parameterMetaData</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="r35 r">mergedCompiledPMD</span>.<span class="i">Parameter</span>);
                <span class="r32 r">result</span>.<span class="i">Add</span>(<span class="r34 r">key</span>, <span class="r36 r">parameterMetaData</span>);
            }
 
            <b>return</b> <span class="r32 r">result</span>;
        }
 
        <b>internal bool</b> <a id="587dd2a060d92ec1" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsMatchingType</a>(<a href="CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a> <span id="r37 rd" class="r37 r">psTypeName</span>)
        {
            <span class="i">Type</span> <span id="r38 rd" class="r38 r">dotNetType</span> = <span class="r37 r">psTypeName</span>.<a href="CommandInfo.cs.html#df5aa9a70e9b5611" class="i property">Type</a>;
            <b>if</b> (<span class="r38 r">dotNetType</span> != <b>null</b>)
            {
                <span class="c">// ConstrainedLanguage note - This conversion is analyzed, but actually invoked via regular conversion.</span>
                <b>bool</b> <span id="r39 rd" class="r39 r">parameterAcceptsObjects</span> =
                    ((<b>int</b>)(<a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">FigureConversion</span>(<b>typeof</b>(<b>object</b>), <a href="#8202ce4164ad3758" class="k">this</a>.<a href="#d2c0f0c200c53478" class="i property">ParameterType</a>).<a href="LanguagePrimitives.cs.html#fcaf7d7aa628a092" class="i property">Rank</a>)) &gt;=
                    (<b>int</b>)(<a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#ea5247ec42277d3c" class="i field">AssignableS2A</a>);
                <b>if</b> (<span class="r38 r">dotNetType</span>.<span class="i">Equals</span>(<b>typeof</b>(<b>object</b>)))
                {
                    <b>return</b> <span class="r39 r">parameterAcceptsObjects</span>;
                }
 
                <b>if</b> (<span class="r39 r">parameterAcceptsObjects</span>)
                {
                    <b>return</b> (<span class="r37 r">psTypeName</span>.<a href="CommandInfo.cs.html#df5aa9a70e9b5611" class="i property">Type</a> != <b>null</b>) &amp;&amp; (<span class="r37 r">psTypeName</span>.<a href="CommandInfo.cs.html#df5aa9a70e9b5611" class="i property">Type</a>.<span class="i">Equals</span>(<b>typeof</b>(<b>object</b>)));
                }
 
                <span class="c">// ConstrainedLanguage note - This conversion is analyzed, but actually invoked via regular conversion.</span>
                <a href="LanguagePrimitives.cs.html#4cbbe0ec8ab6946f" class="k">var</a> <span id="r40 rd" class="r40 r">conversionData</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#7b24dbc305e38140" class="i method">FigureConversion</a>(<span class="r38 r">dotNetType</span>, <a href="#8202ce4164ad3758" class="k">this</a>.<a href="#d2c0f0c200c53478" class="i property">ParameterType</a>);
                <b>if</b> (<span class="r40 r">conversionData</span> != <b>null</b>)
                {
                    <b>if</b> ((<b>int</b>)(<span class="r40 r">conversionData</span>.<a href="LanguagePrimitives.cs.html#fcaf7d7aa628a092" class="i property">Rank</a>) &gt;= (<b>int</b>)(<a href="LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="LanguagePrimitives.cs.html#01a2ddaf3750244b" class="i field">NumericImplicitS2A</a>))
                    {
                        <b>return</b> <b>true</b>;
                    }
                }
 
                <b>return</b> <b>false</b>;
            }
 
            <a href="regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r41 rd" class="r41 r">wildcardPattern</span> = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(
                <span class="s">&quot;*&quot;</span> + (<span class="r37 r">psTypeName</span>.<a href="CommandInfo.cs.html#77cc6b79382c5568" class="i property">Name</a> ?? <b>string</b>.<span class="i">Empty</span>),
                <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a> | <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#c83c96a47a1cc99d" class="i field">CultureInvariant</a>);
            <b>if</b> (<span class="r41 r">wildcardPattern</span>.<span class="i">IsMatch</span>(<a href="#8202ce4164ad3758" class="k">this</a>.<a href="#d2c0f0c200c53478" class="i property">ParameterType</a>.<span class="i">FullName</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#8202ce4164ad3758" class="k">this</a>.<a href="#d2c0f0c200c53478" class="i property">ParameterType</a>.<span class="i">IsArray</span> &amp;&amp; <span class="r41 r">wildcardPattern</span>.<span class="i">IsMatch</span>((<a href="#8202ce4164ad3758" class="k">this</a>.<a href="#d2c0f0c200c53478" class="i property">ParameterType</a>.<span class="i">GetElementType</span>().<span class="i">FullName</span>)))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#8202ce4164ad3758" class="k">this</a>.<a href="#6e5f6f9087cc2460" class="i property">Attributes</a> != <b>null</b>)
            {
                <a href="Attributes.cs.html#bfd81d7e698be9e1" class="t t">PSTypeNameAttribute</a> <span id="r42 rd" class="r42 r">typeNameAttribute</span> = <a href="#8202ce4164ad3758" class="k">this</a>.<a href="#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">OfType</span>&lt;<a href="Attributes.cs.html#bfd81d7e698be9e1" class="t t">PSTypeNameAttribute</a>&gt;().<span class="i">FirstOrDefault</span>();
                <b>if</b> (<span class="r42 r">typeNameAttribute</span> != <b>null</b> &amp;&amp; <span class="r41 r">wildcardPattern</span>.<a href="regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r42 r">typeNameAttribute</span>.<a href="Attributes.cs.html#2a028c02be06fb7f" class="i property">PSTypeName</a>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Proxy Parameter generation
 
        <span class="c">// The formats are prefixed with {0} to enable easy formatting.</span>
        <b>private const string</b> <a id="2dbb56860752e43c" href="../R/2dbb56860752e43c.html" target="n" data-glyph="10,1" class="i field">ParameterNameFormat</a> = <span class="s">@&quot;{0}${{{1}}}&quot;</span>;
        <b>private const string</b> <a id="6c3abbf3aba38b46" href="../R/6c3abbf3aba38b46.html" target="n" data-glyph="10,1" class="i field">ParameterTypeFormat</a> = <span class="s">@&quot;{0}[{1}]&quot;</span>;
        <b>private const string</b> <a id="1942f59b44547e23" href="../R/1942f59b44547e23.html" target="n" data-glyph="10,1" class="i field">ParameterSetNameFormat</a> = <span class="s">&quot;ParameterSetName=&#39;{0}&#39;&quot;</span>;
        <b>private const string</b> <a id="d093987bf118c55f" href="../R/d093987bf118c55f.html" target="n" data-glyph="10,1" class="i field">AliasesFormat</a> = <span class="s">@&quot;{0}[Alias({1})]&quot;</span>;
        <b>private const string</b> <a id="7a8a5db2cfa9380c" href="../R/7a8a5db2cfa9380c.html" target="n" data-glyph="10,1" class="i field">ValidateLengthFormat</a> = <span class="s">@&quot;{0}[ValidateLength({1}, {2})]&quot;</span>;
        <b>private const string</b> <a id="0f62115994284dcf" href="../R/0f62115994284dcf.html" target="n" data-glyph="10,1" class="i field">ValidateRangeRangeKindFormat</a> = <span class="s">@&quot;{0}[ValidateRange([System.Management.Automation.ValidateRangeKind]::{1})]&quot;</span>;
        <b>private const string</b> <a id="ce7c9d4d28c1ffec" href="../R/ce7c9d4d28c1ffec.html" target="n" data-glyph="10,1" class="i field">ValidateRangeFloatFormat</a> = <span class="s">@&quot;{0}[ValidateRange({1:R}, {2:R})]&quot;</span>;
        <b>private const string</b> <a id="fa500d012fd96460" href="../R/fa500d012fd96460.html" target="n" data-glyph="10,1" class="i field">ValidateRangeFormat</a> = <span class="s">@&quot;{0}[ValidateRange({1}, {2})]&quot;</span>;
        <b>private const string</b> <a id="cebe164244c1dfee" href="../R/cebe164244c1dfee.html" target="n" data-glyph="10,1" class="i field">ValidatePatternFormat</a> = <span class="s">&quot;{0}[ValidatePattern(&#39;{1}&#39;)]&quot;</span>;
        <b>private const string</b> <a id="af99f58edf6c7aae" href="../R/af99f58edf6c7aae.html" target="n" data-glyph="10,1" class="i field">ValidateScriptFormat</a> = <span class="s">@&quot;{0}[ValidateScript({{ {1} }})]&quot;</span>;
        <b>private const string</b> <a id="3bf1cfab5835e6fe" href="../R/3bf1cfab5835e6fe.html" target="n" data-glyph="10,1" class="i field">ValidateCountFormat</a> = <span class="s">@&quot;{0}[ValidateCount({1}, {2})]&quot;</span>;
        <b>private const string</b> <a id="812ef3b88a1f54df" href="../R/812ef3b88a1f54df.html" target="n" data-glyph="10,1" class="i field">ValidateSetFormat</a> = <span class="s">@&quot;{0}[ValidateSet({1})]&quot;</span>;
        <b>private const string</b> <a id="621077ac0357afa1" href="../R/621077ac0357afa1.html" target="n" data-glyph="10,1" class="i field">ValidateNotNullFormat</a> = <span class="s">@&quot;{0}[ValidateNotNull()]&quot;</span>;
        <b>private const string</b> <a id="b589539568d3a3d5" href="../R/b589539568d3a3d5.html" target="n" data-glyph="10,1" class="i field">ValidateNotNullOrEmptyFormat</a> = <span class="s">@&quot;{0}[ValidateNotNullOrEmpty()]&quot;</span>;
        <b>private const string</b> <a id="d3a57e00ed7b767a" href="../R/d3a57e00ed7b767a.html" target="n" data-glyph="10,1" class="i field">AllowNullFormat</a> = <span class="s">@&quot;{0}[AllowNull()]&quot;</span>;
        <b>private const string</b> <a id="b852c945610ec4a2" href="../R/b852c945610ec4a2.html" target="n" data-glyph="10,1" class="i field">AllowEmptyStringFormat</a> = <span class="s">@&quot;{0}[AllowEmptyString()]&quot;</span>;
        <b>private const string</b> <a id="acabe07d1ff5c213" href="../R/acabe07d1ff5c213.html" target="n" data-glyph="10,1" class="i field">AllowEmptyCollectionFormat</a> = <span class="s">@&quot;{0}[AllowEmptyCollection()]&quot;</span>;
        <b>private const string</b> <a id="79bd1c21152d8c20" href="../R/79bd1c21152d8c20.html" target="n" data-glyph="10,1" class="i field">PSTypeNameFormat</a> = <span class="s">@&quot;{0}[PSTypeName(&#39;{1}&#39;)]&quot;</span>;
        <b>private const string</b> <a id="6e10b23a625bda7e" href="../R/6e10b23a625bda7e.html" target="n" data-glyph="10,1" class="i field">ObsoleteFormat</a> = <span class="s">@&quot;{0}[Obsolete({1})]&quot;</span>;
        <b>private const string</b> <a id="ad5f475cd6ba1a67" href="../R/ad5f475cd6ba1a67.html" target="n" data-glyph="10,1" class="i field">CredentialAttributeFormat</a> = <span class="s">@&quot;{0}[System.Management.Automation.CredentialAttribute()]&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">prefix</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> prefix that is added to every new-line. Used for tabbing content.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">paramNameOverride</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The paramNameOverride is used as the parameter name if it is not null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">isProxyForCmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter is for a cmdlet and requires a Parameter attribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="2a1160df97f333f8" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetProxyParameterData</a>(<b>string</b> <span id="r43 rd" class="r43 r">prefix</span>, <b>string</b> <span id="r44 rd" class="r44 r">paramNameOverride</span>, <b>bool</b> <span id="r45 rd" class="r45 r">isProxyForCmdlet</span>)
        {
            <span class="i">Text</span>.<span class="i">StringBuilder</span> <span id="r46 rd" class="r46 r">result</span> = <b>new</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">StringBuilder</span>();
 
            <b>if</b> (<a href="#673e2b802878ec27" class="i field">_parameterSets</a> != <b>null</b> &amp;&amp; <span class="r45 r">isProxyForCmdlet</span>)
            {
                <b>foreach</b> (<b>var</b> <span id="r47 rd" class="r47 r">pair</span> <b>in</b> <a href="#673e2b802878ec27" class="i field">_parameterSets</a>)
                {
                    <b>string</b> <span id="r48 rd" class="r48 r">parameterSetName</span> = <span class="r47 r">pair</span>.<span class="i">Key</span>;
                    <a href="#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a> <span id="r49 rd" class="r49 r">parameterSet</span> = <span class="r47 r">pair</span>.<span class="i">Value</span>;
                    <b>string</b> <span id="r50 rd" class="r50 r">paramSetData</span> = <span class="r49 r">parameterSet</span>.<a href="#3a387016f0aef4b3" class="i method">GetProxyParameterData</a>();
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r50 r">paramSetData</span>) || !<span class="r48 r">parameterSetName</span>.<span class="i">Equals</span>(<a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>))
                    {
                        <b>string</b> <span id="r51 rd" class="r51 r">separator</span> = <b>string</b>.<span class="i">Empty</span>;
                        <span class="r46 r">result</span>.<span class="i">Append</span>(<span class="r43 r">prefix</span>);
                        <span class="r46 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;[Parameter(&quot;</span>);
                        <b>if</b> (!<span class="r48 r">parameterSetName</span>.<span class="i">Equals</span>(<a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>))
                        {
                            <span class="r46 r">result</span>.<span class="i">AppendFormat</span>(
                                <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                <a href="#1942f59b44547e23" class="i field">ParameterSetNameFormat</a>,
                                <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<span class="r48 r">parameterSetName</span>));
                            <span class="r51 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                        }
 
                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r50 r">paramSetData</span>))
                        {
                            <span class="r46 r">result</span>.<span class="i">Append</span>(<span class="r51 r">separator</span>);
                            <span class="r46 r">result</span>.<span class="i">Append</span>(<span class="r50 r">paramSetData</span>);
                        }
 
                        <span class="r46 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;)]&quot;</span>);
                    }
                }
            }
 
            <b>if</b> ((<a href="#d31f7dcacbcce700" class="i field">_aliases</a> != <b>null</b>) &amp;&amp; (<a href="#d31f7dcacbcce700" class="i field">_aliases</a>.<span class="i">Count</span> &gt; 0))
            {
                <span class="i">Text</span>.<span class="i">StringBuilder</span> <span id="r52 rd" class="r52 r">aliasesData</span> = <b>new</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">StringBuilder</span>();
                <b>string</b> <span id="r53 rd" class="r53 r">comma</span> = <b>string</b>.<span class="i">Empty</span>; <span class="c">// comma is not need for the first element</span>
 
                <b>foreach</b> (<b>string</b> <span id="r54 rd" class="r54 r">alias</span> <b>in</b> <a href="#d31f7dcacbcce700" class="i field">_aliases</a>)
                {
                    <span class="r52 r">aliasesData</span>.<span class="i">AppendFormat</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="s">&quot;{0}&#39;{1}&#39;&quot;</span>,
                        <span class="r53 r">comma</span>,
                        <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<span class="r54 r">alias</span>));
                    <span class="r53 r">comma</span> = <span class="s">&quot;,&quot;</span>;
                }
 
                <span class="r46 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#d093987bf118c55f" class="i field">AliasesFormat</a>, <span class="r43 r">prefix</span>, <span class="r52 r">aliasesData</span>.<span class="i">ToString</span>());
            }
 
            <b>if</b> ((<a href="#df4711f2d77f29b5" class="i field">_attributes</a> != <b>null</b>) &amp;&amp; (<a href="#df4711f2d77f29b5" class="i field">_attributes</a>.<span class="i">Count</span> &gt; 0))
            {
                <b>foreach</b> (<span class="i">Attribute</span> <span id="r55 rd" class="r55 r">attrib</span> <b>in</b> <a href="#df4711f2d77f29b5" class="i field">_attributes</a>)
                {
                    <b>string</b> <span id="r56 rd" class="r56 r">attribData</span> = <a href="#cc06b509a0f6f963" class="i method">GetProxyAttributeData</a>(<span class="r55 r">attrib</span>, <span class="r43 r">prefix</span>);
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r56 r">attribData</span>))
                    {
                        <span class="r46 r">result</span>.<span class="i">Append</span>(<span class="r56 r">attribData</span>);
                    }
                }
            }
 
            <b>if</b> (<a href="#4431449ea131b97b" class="i property">SwitchParameter</a>)
            {
                <span class="r46 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#6c3abbf3aba38b46" class="i field">ParameterTypeFormat</a>, <span class="r43 r">prefix</span>, <span class="s">&quot;switch&quot;</span>);
            }
            <b>else</b> <b>if</b> (<a href="#fd93349a13aebcff" class="i field">_parameterType</a> != <b>null</b>)
            {
                <span class="r46 r">result</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#6c3abbf3aba38b46" class="i field">ParameterTypeFormat</a>, <span class="r43 r">prefix</span>, <a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="MshObject.cs.html#edc1ecfda5d75ea9" class="i method">Type</a>(<a href="#fd93349a13aebcff" class="i field">_parameterType</a>));
            }
 
            <span class="c">/* 1. CredentialAttribute needs to go after the type
             * 2. To avoid risk, I don&#39;t want to move other attributes to go here / after the type */</span>
            <a href="../security/CredentialParameter.cs.html#f56cfbff08958505" class="t t">CredentialAttribute</a> <span id="r57 rd" class="r57 r">credentialAttrib</span> = <a href="#df4711f2d77f29b5" class="i field">_attributes</a>.<span class="i">OfType</span>&lt;<a href="../security/CredentialParameter.cs.html#f56cfbff08958505" class="t t">CredentialAttribute</a>&gt;().<span class="i">FirstOrDefault</span>();
            <b>if</b> (<span class="r57 r">credentialAttrib</span> != <b>null</b>)
            {
                <b>string</b> <span id="r58 rd" class="r58 r">attribData</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#ad5f475cd6ba1a67" class="i field">CredentialAttributeFormat</a>, <span class="r43 r">prefix</span>);
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r58 r">attribData</span>))
                {
                    <span class="r46 r">result</span>.<span class="i">Append</span>(<span class="r58 r">attribData</span>);
                }
            }
 
            <span class="r46 r">result</span>.<span class="i">AppendFormat</span>(
                <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                <a href="#2dbb56860752e43c" class="i field">ParameterNameFormat</a>,
                <span class="r43 r">prefix</span>,
                <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#0f0d039735cefa4d" class="i method">EscapeVariableName</a>(<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r44 r">paramNameOverride</span>) ? <a href="#0d89ad3e8aaa8701" class="i field">_name</a> : <span class="r44 r">paramNameOverride</span>));
            <b>return</b> <span class="r46 r">result</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates proxy data for attributes like ValidateLength, ValidateRange etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">attrib</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attribute to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">prefix</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prefix string to add.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attribute&#39;s proxy string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="cc06b509a0f6f963" href="../R/cc06b509a0f6f963.html" target="n" data-glyph="76,1" class="i method">GetProxyAttributeData</a>(<span class="i">Attribute</span> <span id="r59 rd" class="r59 r">attrib</span>, <b>string</b> <span id="r60 rd" class="r60 r">prefix</span>)
        {
            <b>string</b> <span id="r61 rd" class="r61 r">result</span>;
 
            <a href="Attributes.cs.html#0840b3256ccc8f77" class="t t">ValidateLengthAttribute</a> <span id="r62 rd" class="r62 r">validLengthAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#0840b3256ccc8f77" class="t t">ValidateLengthAttribute</a>;
            <b>if</b> (<span class="r62 r">validLengthAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#7a8a5db2cfa9380c" class="i field">ValidateLengthFormat</a>, <span class="r60 r">prefix</span>,
                    <span class="r62 r">validLengthAttrib</span>.<a href="Attributes.cs.html#3e939cba7c40461a" class="i property">MinLength</a>,
                    <span class="r62 r">validLengthAttrib</span>.<a href="Attributes.cs.html#684b47bf1f186d38" class="i property">MaxLength</a>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#6495dd85010f3443" class="t t">ValidateRangeAttribute</a> <span id="r63 rd" class="r63 r">validRangeAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#6495dd85010f3443" class="t t">ValidateRangeAttribute</a>;
            <b>if</b> (<span class="r63 r">validRangeAttrib</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r63 r">validRangeAttrib</span>.<a href="Attributes.cs.html#a59c2c012f76a0c6" class="i property">RangeKind</a>.<span class="i">HasValue</span>)
                {
                    <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <a href="#0f62115994284dcf" class="i field">ValidateRangeRangeKindFormat</a>,
                        <span class="r60 r">prefix</span>,
                        <span class="r63 r">validRangeAttrib</span>.<a href="Attributes.cs.html#a59c2c012f76a0c6" class="i property">RangeKind</a>.<span class="i">ToString</span>());
                    <b>return</b> <span class="r61 r">result</span>;
                }
                <b>else</b>
                {
                    <span class="i">Type</span> <span id="r64 rd" class="r64 r">rangeType</span> = <span class="r63 r">validRangeAttrib</span>.<a href="Attributes.cs.html#bb230b676909a714" class="i property">MinRange</a>.<span class="i">GetType</span>();
                    <b>string</b> <span id="r65 rd" class="r65 r">format</span>;
 
                    <b>if</b> (<span class="r64 r">rangeType</span> == <b>typeof</b>(<b>float</b>) || <span class="r64 r">rangeType</span> == <b>typeof</b>(<b>double</b>))
                    {
                        <span class="r65 r">format</span> = <a href="#ce7c9d4d28c1ffec" class="i field">ValidateRangeFloatFormat</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r65 r">format</span> = <a href="#fa500d012fd96460" class="i field">ValidateRangeFormat</a>;
                    }
 
                    <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="r65 r">format</span>,
                        <span class="r60 r">prefix</span>,
                        <span class="r63 r">validRangeAttrib</span>.<a href="Attributes.cs.html#bb230b676909a714" class="i property">MinRange</a>,
                        <span class="r63 r">validRangeAttrib</span>.<a href="Attributes.cs.html#d484815dfc65d2e2" class="i property">MaxRange</a>);
                    <b>return</b> <span class="r61 r">result</span>;
                }
            }
 
            <a href="Attributes.cs.html#14ce8e5cc36e9b3e" class="t t">AllowNullAttribute</a> <span id="r66 rd" class="r66 r">allowNullAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#14ce8e5cc36e9b3e" class="t t">AllowNullAttribute</a>;
            <b>if</b> (<span class="r66 r">allowNullAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#d3a57e00ed7b767a" class="i field">AllowNullFormat</a>, <span class="r60 r">prefix</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#4ddba8f39c29ef4b" class="t t">AllowEmptyStringAttribute</a> <span id="r67 rd" class="r67 r">allowEmptyStringAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#4ddba8f39c29ef4b" class="t t">AllowEmptyStringAttribute</a>;
            <b>if</b> (<span class="r67 r">allowEmptyStringAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#b852c945610ec4a2" class="i field">AllowEmptyStringFormat</a>, <span class="r60 r">prefix</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#2f3b6df5412d8c54" class="t t">AllowEmptyCollectionAttribute</a> <span id="r68 rd" class="r68 r">allowEmptyColAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#2f3b6df5412d8c54" class="t t">AllowEmptyCollectionAttribute</a>;
            <b>if</b> (<span class="r68 r">allowEmptyColAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#acabe07d1ff5c213" class="i field">AllowEmptyCollectionFormat</a>, <span class="r60 r">prefix</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#03062544c856ad82" class="t t">ValidatePatternAttribute</a> <span id="r69 rd" class="r69 r">patternAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#03062544c856ad82" class="t t">ValidatePatternAttribute</a>;
            <b>if</b> (<span class="r69 r">patternAttrib</span> != <b>null</b>)
            {
                <span class="c">/* TODO: Validate Pattern dont support Options in ScriptCmdletText.
                StringBuilder regexOps = new System.Text.StringBuilder();
                string or = string.Empty;
                string[] regexOptionEnumValues = Enum.GetNames(typeof(System.Text.RegularExpressions.RegexOptions));
 
                foreach (string regexOption in regexOptionEnumValues)
                {
                    System.Text.RegularExpressions.RegexOptions option = (System.Text.RegularExpressions.RegexOptions) Enum.Parse(
                        typeof(System.Text.RegularExpressions.RegexOptions),
                        regexOption, true);
                    if ((option &amp; patternAttrib.Options) == option)
                    {
                        tracer.WriteLine(&quot;Regex option {0} found&quot;, regexOption);
                        regexOps.AppendFormat(CultureInfo.InvariantCulture,
                            &quot;{0}[System.Text.RegularExpressions.RegexOptions]::{1}&quot;, or,
                            option.ToString()
                            );
                        or = &quot;|&quot;;
                    }
                }*/</span>
 
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#cebe164244c1dfee" class="i field">ValidatePatternFormat</a>, <span class="r60 r">prefix</span>,
                    <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<span class="r69 r">patternAttrib</span>.<a href="Attributes.cs.html#7138346d0a0f606d" class="i property">RegexPattern</a>)
                    <span class="c">/*,regexOps.ToString()*/</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#69d196403a4d103c" class="t t">ValidateCountAttribute</a> <span id="r70 rd" class="r70 r">countAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#69d196403a4d103c" class="t t">ValidateCountAttribute</a>;
            <b>if</b> (<span class="r70 r">countAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#3bf1cfab5835e6fe" class="i field">ValidateCountFormat</a>, <span class="r60 r">prefix</span>, <span class="r70 r">countAttrib</span>.<a href="Attributes.cs.html#9991ffc3c5d6c75d" class="i property">MinLength</a>, <span class="r70 r">countAttrib</span>.<a href="Attributes.cs.html#c3b4cf1db45cc6cf" class="i property">MaxLength</a>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#30630ef4e72decfd" class="t t">ValidateNotNullAttribute</a> <span id="r71 rd" class="r71 r">notNullAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#30630ef4e72decfd" class="t t">ValidateNotNullAttribute</a>;
            <b>if</b> (<span class="r71 r">notNullAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#621077ac0357afa1" class="i field">ValidateNotNullFormat</a>, <span class="r60 r">prefix</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#6046c0828ea7bcf9" class="t t">ValidateNotNullOrEmptyAttribute</a> <span id="r72 rd" class="r72 r">notNullEmptyAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#6046c0828ea7bcf9" class="t t">ValidateNotNullOrEmptyAttribute</a>;
            <b>if</b> (<span class="r72 r">notNullEmptyAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#b589539568d3a3d5" class="i field">ValidateNotNullOrEmptyFormat</a>, <span class="r60 r">prefix</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#33a6a027748d30a4" class="t t">ValidateSetAttribute</a> <span id="r73 rd" class="r73 r">setAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#33a6a027748d30a4" class="t t">ValidateSetAttribute</a>;
            <b>if</b> (<span class="r73 r">setAttrib</span> != <b>null</b>)
            {
                <span class="i">Text</span>.<span class="i">StringBuilder</span> <span id="r74 rd" class="r74 r">values</span> = <b>new</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">StringBuilder</span>();
                <b>string</b> <span id="r75 rd" class="r75 r">comma</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>foreach</b> (<b>string</b> <span id="r76 rd" class="r76 r">validValue</span> <b>in</b> <span class="r73 r">setAttrib</span>.<a href="Attributes.cs.html#7e92ecc5d5d777ac" class="i property">ValidValues</a>)
                {
                    <span class="r74 r">values</span>.<span class="i">AppendFormat</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="s">&quot;{0}&#39;{1}&#39;&quot;</span>,
                        <span class="r75 r">comma</span>,
                        <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<span class="r76 r">validValue</span>));
                    <span class="r75 r">comma</span> = <span class="s">&quot;,&quot;</span>;
                }
 
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#812ef3b88a1f54df" class="i field">ValidateSetFormat</a>, <span class="r60 r">prefix</span>, <span class="r74 r">values</span>.<span class="i">ToString</span>()<span class="c">/*, setAttrib.IgnoreCase*/</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#99ceaba676cd521e" class="t t">ValidateScriptAttribute</a> <span id="r77 rd" class="r77 r">scriptAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#99ceaba676cd521e" class="t t">ValidateScriptAttribute</a>;
            <b>if</b> (<span class="r77 r">scriptAttrib</span> != <b>null</b>)
            {
                <span class="c">// Talked with others and I think it is okay to use *unescaped* value from sb.ToString()</span>
                <span class="c">// 1. implicit remoting is not bringing validation scripts across</span>
                <span class="c">// 2. other places in code also assume that contents of a script block can be parsed</span>
                <span class="c">//    without escaping</span>
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#af99f58edf6c7aae" class="i field">ValidateScriptFormat</a>, <span class="r60 r">prefix</span>, <span class="r77 r">scriptAttrib</span>.<a href="Attributes.cs.html#06b4e2930c2d65e6" class="i property">ScriptBlock</a>.<a href="runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>());
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <a href="Attributes.cs.html#bfd81d7e698be9e1" class="t t">PSTypeNameAttribute</a> <span id="r78 rd" class="r78 r">psTypeNameAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <a href="Attributes.cs.html#bfd81d7e698be9e1" class="t t">PSTypeNameAttribute</a>;
            <b>if</b> (<span class="r78 r">psTypeNameAttrib</span> != <b>null</b>)
            {
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#79bd1c21152d8c20" class="i field">PSTypeNameFormat</a>,
                    <span class="r60 r">prefix</span>,
                    <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<span class="r78 r">psTypeNameAttrib</span>.<a href="Attributes.cs.html#2a028c02be06fb7f" class="i property">PSTypeName</a>));
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <span class="i">ObsoleteAttribute</span> <span id="r79 rd" class="r79 r">obsoleteAttrib</span> = <span class="r59 r">attrib</span> <b>as</b> <span class="i">ObsoleteAttribute</span>;
            <b>if</b> (<span class="r79 r">obsoleteAttrib</span> != <b>null</b>)
            {
                <b>string</b> <span id="r80 rd" class="r80 r">parameters</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>if</b> (<span class="r79 r">obsoleteAttrib</span>.<span class="i">IsError</span>)
                {
                    <b>string</b> <span id="r81 rd" class="r81 r">message</span> = <span class="s">&quot;&#39;&quot;</span> + <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<span class="i">EscapeSingleQuotedStringContent</span>(<span class="r79 r">obsoleteAttrib</span>.<span class="i">Message</span>) + <span class="s">&quot;&#39;&quot;</span>;
                    <span class="r80 r">parameters</span> = <span class="r81 r">message</span> + <span class="s">&quot;, $true&quot;</span>;
                }
                <b>else</b> <b>if</b> (<span class="r79 r">obsoleteAttrib</span>.<span class="i">Message</span> != <b>null</b>)
                {
                    <span class="r80 r">parameters</span> = <span class="s">&quot;&#39;&quot;</span> + <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<span class="i">EscapeSingleQuotedStringContent</span>(<span class="r79 r">obsoleteAttrib</span>.<span class="i">Message</span>) + <span class="s">&quot;&#39;&quot;</span>;
                }
 
                <span class="r61 r">result</span> = <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <a href="#6e10b23a625bda7e" class="i field">ObsoleteFormat</a>,
                    <span class="r60 r">prefix</span>,
                    <span class="r80 r">parameters</span>);
                <b>return</b> <span class="r61 r">result</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The metadata associated with a bindable type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="a8f6662c681b78f9" href="../R/a8f6662c681b78f9.html" target="n" data-glyph="2,0" class="t t">InternalParameterMetadata</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or constructs an instance of the InternalParameterMetadata for the specified runtime-defined parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">runtimeDefinedParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runtime-defined parameter collection that describes the parameters and their metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">processingDynamicParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if dynamic parameters are being processed, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">checkNames</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check for reserved parameter names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the TypeMetadata for the specified runtime-defined parameters. The metadata</span>
        <span class="c">///</span><span class="c"> is always constructed on demand and never cached.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">runtimeDefinedParameters</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <a id="37a5e8eb404da755" href="../R/37a5e8eb404da755.html" target="n" data-glyph="74,1" class="i method">Get</a>(<a href="PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <span id="r82 rd" class="r82 r">runtimeDefinedParameters</span>,
                                                      <b>bool</b> <span id="r83 rd" class="r83 r">processingDynamicParameters</span>,
                                                      <b>bool</b> <span id="r84 rd" class="r84 r">checkNames</span>)
        {
            <b>if</b> (<span class="r82 r">runtimeDefinedParameters</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;runtimeDefinedParameter&quot;</span>);
            }
 
            <b>return</b> <b>new</b> <a href="#6c688dab6aa8c359" class="t constructor">InternalParameterMetadata</a>(<span class="r82 r">runtimeDefinedParameters</span>, <span class="r83 r">processingDynamicParameters</span>, <span class="r84 r">checkNames</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or constructs an instance of the InternalParameterMetadata for the specified type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type to get the metadata for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current engine context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">processingDynamicParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if dynamic parameters are being processed, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the TypeMetadata for the specified type. The metadata may get</span>
        <span class="c">///</span><span class="c"> constructed on-demand or may be retrieved from the cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <a id="7af90786dfc7589c" href="../R/7af90786dfc7589c.html" target="n" data-glyph="74,1" class="i method">Get</a>(<span class="i">Type</span> <span id="r85 rd" class="r85 r">type</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r86 rd" class="r86 r">context</span>, <b>bool</b> <span id="r87 rd" class="r87 r">processingDynamicParameters</span>)
        {
            <b>if</b> (<span class="r85 r">type</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r85 r">type</span>));
            }
 
            <a href="#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r88 rd" class="r88 r">result</span>;
            <b>if</b> (<span class="r86 r">context</span> == <b>null</b> || !<a href="#f313e93d541142fe" class="i field">s_parameterMetadataCache</a>.<span class="i">TryGetValue</span>(<span class="r85 r">type</span>.<span class="i">AssemblyQualifiedName</span>, <b>out</b> <span class="r88 r">result</span>))
            {
                <span class="r88 r">result</span> = <b>new</b> <a href="#54ff3b4825aa55db" class="t constructor">InternalParameterMetadata</a>(<span class="r85 r">type</span>, <span class="r87 r">processingDynamicParameters</span>);
 
                <b>if</b> (<span class="r86 r">context</span> != <b>null</b>)
                {
                    <a href="#f313e93d541142fe" class="i field">s_parameterMetadataCache</a>.<span class="i">TryAdd</span>(<span class="r85 r">type</span>.<span class="i">AssemblyQualifiedName</span>, <span class="r88 r">result</span>);
                }
            }
 
            <b>return</b> <span class="r88 r">result</span>;
        }
 
        <span class="c">//</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs an instance of the InternalParameterMetadata using the metadata in the</span>
        <span class="c">///</span><span class="c"> runtime-defined parameter collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">runtimeDefinedParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The collection of runtime-defined parameters that declare the parameters and their</span>
        <span class="c">///</span><span class="c"> metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">processingDynamicParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if dynamic parameters are being processed, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">checkNames</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the parameter name has been reserved.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">runtimeDefinedParameters</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6c688dab6aa8c359" href="../R/6c688dab6aa8c359.html" target="n" data-glyph="74,1" class="t constructor">InternalParameterMetadata</a>(<a href="PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <span id="r89 rd" class="r89 r">runtimeDefinedParameters</span>, <b>bool</b> <span id="r90 rd" class="r90 r">processingDynamicParameters</span>, <b>bool</b> <span id="r91 rd" class="r91 r">checkNames</span>)
        {
            <b>if</b> (<span class="r89 r">runtimeDefinedParameters</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r89 r">runtimeDefinedParameters</span>));
            }
 
            <a href="#4d6de531af2428a3" class="i method">ConstructCompiledParametersUsingRuntimeDefinedParameters</a>(<span class="r89 r">runtimeDefinedParameters</span>, <span class="r90 r">processingDynamicParameters</span>, <span class="r91 r">checkNames</span>);
        }
 
        <span class="c">//</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs an instance of the InternalParameterMetadata using the reflection information retrieved</span>
        <span class="c">///</span><span class="c"> from the enclosing bindable object type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">type</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type information for the bindable object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">processingDynamicParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if dynamic parameters are being processed, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">type</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="54ff3b4825aa55db" href="../R/54ff3b4825aa55db.html" target="n" data-glyph="74,1" class="t constructor">InternalParameterMetadata</a>(<span class="i">Type</span> <span id="r92 rd" class="r92 r">type</span>, <b>bool</b> <span id="r93 rd" class="r93 r">processingDynamicParameters</span>)
        {
            <b>if</b> (<span class="r92 r">type</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r92 r">type</span>));
            }
 
            <a href="#686cd7dddc9043c5" class="i field">_type</a> = <span class="r92 r">type</span>;
            <a href="#0fc30f7784d92e42" class="i property">TypeName</a> = <span class="r92 r">type</span>.<span class="i">Name</span>;
 
            <a href="#2d9c38d3805484ed" class="i method">ConstructCompiledParametersUsingReflection</a>(<span class="r93 r">processingDynamicParameters</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type name of the bindable type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="0fc30f7784d92e42" href="../R/0fc30f7784d92e42.html" target="n" data-glyph="104,1" class="i property">TypeName</a> { <b>get</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a dictionary of the compiled parameter metadata for this Type.</span>
        <span class="c">///</span><span class="c"> The dictionary keys are the names of the parameters (or aliases) and</span>
        <span class="c">///</span><span class="c"> the values are the compiled parameter metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a>&gt; <a id="6a8e3f7bd944a14f" href="../R/6a8e3f7bd944a14f.html" target="n" data-glyph="104,1" class="i property">BindableParameters</a> { <b>get</b>; }
 
            = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a dictionary of the parameters that have been aliased to other names. The key is</span>
        <span class="c">///</span><span class="c"> the alias name and the value is the CompiledCommandParameter metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a>&gt; <a id="f7290dc9779e8ba7" href="../R/f7290dc9779e8ba7.html" target="n" data-glyph="104,1" class="i property">AliasedParameters</a> { <b>get</b>; }
 
            = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The type information for the class that implements the bindable object.</span>
        <span class="c">///</span><span class="c"> This member is null in all cases except when constructed with using reflection</span>
        <span class="c">///</span><span class="c"> against the Type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Type</span> <a id="686cd7dddc9043c5" href="../R/686cd7dddc9043c5.html" target="n" data-glyph="46,1" class="i field">_type</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flags used when reflecting against the object to create the metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly</b> <span class="i">BindingFlags</span> <a id="6909ecbd4c662d02" href="../R/6909ecbd4c662d02.html" target="n" data-glyph="44,1" class="i field">metaDataBindingFlags</a> = (<span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> helper methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Fills in the data for an instance of this class using the specified runtime-defined parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">runtimeDefinedParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A description of the parameters and their metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">processingDynamicParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if dynamic parameters are being processed, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">checkNames</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the parameter name has been reserved.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4d6de531af2428a3" href="../R/4d6de531af2428a3.html" target="n" data-glyph="76,1" class="i method">ConstructCompiledParametersUsingRuntimeDefinedParameters</a>(
            <a href="PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <span id="r94 rd" class="r94 r">runtimeDefinedParameters</span>,
            <b>bool</b> <span id="r95 rd" class="r95 r">processingDynamicParameters</span>,
            <b>bool</b> <span id="r96 rd" class="r96 r">checkNames</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r94 r">runtimeDefinedParameters</span> != <b>null</b>,
                <span class="s">&quot;This method should only be called when constructed with a valid runtime-defined parameter collection&quot;</span>);
 
            <b>foreach</b> (<a href="PseudoParameters.cs.html#68fb670c5eb25328" class="t t">RuntimeDefinedParameter</a> <span id="r97 rd" class="r97 r">parameterDefinition</span> <b>in</b> <span class="r94 r">runtimeDefinedParameters</span>.<span class="i">Values</span>)
            {
                <span class="c">// Create the compiled parameter and add it to the bindable parameters collection</span>
                <b>if</b> (<span class="r95 r">processingDynamicParameters</span>)
                {
                    <span class="c">// When processing dynamic parameters, parameter definitions come from the user,</span>
                    <span class="c">// Invalid data could be passed in, or the parameter could be actually disabled.</span>
                    <b>if</b> (<span class="r97 r">parameterDefinition</span> == <b>null</b> || <span class="r97 r">parameterDefinition</span>.<a href="PseudoParameters.cs.html#32dd42a58dc2269b" class="i method">IsDisabled</a>()) { <b>continue</b>; }
                }
 
                <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r98 rd" class="r98 r">parameter</span> = <b>new</b> <a href="CompiledCommandParameter.cs.html#5c8e5809815ab7e7" class="t constructor">CompiledCommandParameter</a>(<span class="r97 r">parameterDefinition</span>, <span class="r95 r">processingDynamicParameters</span>);
                <a href="#26eca0f27db79be9" class="i method">AddParameter</a>(<span class="r98 r">parameter</span>, <span class="r96 r">checkNames</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compiles the parameter using reflection against the CLR type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">processingDynamicParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if dynamic parameters are being processed, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2d9c38d3805484ed" href="../R/2d9c38d3805484ed.html" target="n" data-glyph="76,1" class="i method">ConstructCompiledParametersUsingReflection</a>(<b>bool</b> <span id="r99 rd" class="r99 r">processingDynamicParameters</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <a href="#686cd7dddc9043c5" class="i field">_type</a> != <b>null</b>,
                <span class="s">&quot;This method should only be called when constructed with the Type&quot;</span>);
 
            <span class="c">// Get the property and field info</span>
 
            <span class="i">PropertyInfo</span>[] <span id="r100 rd" class="r100 r">properties</span> = <a href="#686cd7dddc9043c5" class="i field">_type</a>.<span class="i">GetProperties</span>(<a href="#6909ecbd4c662d02" class="i field">metaDataBindingFlags</a>);
            <span class="i">FieldInfo</span>[] <span id="r101 rd" class="r101 r">fields</span> = <a href="#686cd7dddc9043c5" class="i field">_type</a>.<span class="i">GetFields</span>(<a href="#6909ecbd4c662d02" class="i field">metaDataBindingFlags</a>);
 
            <b>foreach</b> (<span class="i">PropertyInfo</span> <span id="r102 rd" class="r102 r">property</span> <b>in</b> <span class="r100 r">properties</span>)
            {
                <span class="c">// Check whether the property is a parameter</span>
                <b>if</b> (!<span class="i">IsMemberAParameter</span>(<span class="r102 r">property</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="i">AddParameter</span>(<span class="r102 r">property</span>, <span class="r99 r">processingDynamicParameters</span>);
            }
 
            <b>foreach</b> (<span class="i">FieldInfo</span> <span id="r103 rd" class="r103 r">field</span> <b>in</b> <span class="r101 r">fields</span>)
            {
                <span class="c">// Check whether the field is a parameter</span>
                <b>if</b> (!<span class="i">IsMemberAParameter</span>(<span class="r103 r">field</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="i">AddParameter</span>(<span class="r103 r">field</span>, <span class="r99 r">processingDynamicParameters</span>);
            }
        }
 
        <b>private static void</b> <a id="273c0f999dde3248" href="../R/273c0f999dde3248.html" target="n" data-glyph="76,1" class="i method">CheckForReservedParameter</a>(<b>string</b> <span id="r104 rd" class="r104 r">name</span>)
        {
            <b>if</b> (<span class="r104 r">name</span>.<span class="i">Equals</span>(<span class="s">&quot;SelectProperty&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                ||
                <span class="r104 r">name</span>.<span class="i">Equals</span>(<span class="s">&quot;SelectObject&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>throw</b> <b>new</b> <span class="t">MetadataException</span>(
                            <span class="s">&quot;ReservedParameterName&quot;</span>,
                            <b>null</b>,
                            <span class="i">DiscoveryExceptions</span>.<span class="i">ReservedParameterName</span>,
                            <span class="r104 r">name</span>);
            }
        }
 
        <span class="c">// This call verifies that the parameter is unique or</span>
        <span class="c">// can be deemed unique. If not, an exception is thrown.</span>
        <span class="c">// If it is unique (or deemed unique), then it is added</span>
        <span class="c">// to the bindableParameters collection</span>
        <span class="c">//</span>
        <b>private void</b> <a id="2ef4539cf2a16888" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddParameter</a>(<span class="i">MemberInfo</span> <span id="r105 rd" class="r105 r">member</span>, <b>bool</b> <span id="r106 rd" class="r106 r">processingDynamicParameters</span>)
        {
            <b>bool</b> <span id="r107 rd" class="r107 r">error</span> = <b>false</b>;
            <b>bool</b> <span id="r108 rd" class="r108 r">useExisting</span> = <b>false</b>;
 
            <span class="i">CheckForReservedParameter</span>(<span class="r105 r">member</span>.<span class="i">Name</span>);
 
            <b>do</b> <span class="c">// false loop</span>
            {
                <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r109 rd" class="r109 r">existingParameter</span>;
                <b>if</b> (!<a href="#6a8e3f7bd944a14f" class="i property">BindableParameters</a>.<span class="i">TryGetValue</span>(<span class="r105 r">member</span>.<span class="i">Name</span>, <b>out</b> <span class="r109 r">existingParameter</span>))
                {
                    <b>break</b>;
                }
 
                <span class="i">Type</span> <span id="r110 rd" class="r110 r">existingParamDeclaringType</span> = <span class="r109 r">existingParameter</span>.<a href="CompiledCommandParameter.cs.html#a2e30ceb9dd6db60" class="i property">DeclaringType</a>;
 
                <b>if</b> (<span class="r110 r">existingParamDeclaringType</span> == <b>null</b>)
                {
                    <span class="r107 r">error</span> = <b>true</b>;
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r110 r">existingParamDeclaringType</span>.<span class="i">IsSubclassOf</span>(<span class="r105 r">member</span>.<span class="i">DeclaringType</span>))
                {
                    <span class="r108 r">useExisting</span> = <b>true</b>;
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r105 r">member</span>.<span class="i">DeclaringType</span>.<span class="i">IsSubclassOf</span>(<span class="r110 r">existingParamDeclaringType</span>))
                {
                    <span class="c">// Need to swap out the new member for the parameter definition</span>
                    <span class="c">// that is already defined.</span>
 
                    <a href="#66e4d899200e932c" class="i method">RemoveParameter</a>(<span class="r109 r">existingParameter</span>);
                    <b>break</b>;
                }
 
                <span class="r107 r">error</span> = <b>true</b>;
            } <b>while</b> (<b>false</b>);
 
            <b>if</b> (<span class="r107 r">error</span>)
            {
                <span class="c">// A duplicate parameter was found and could not be deemed unique</span>
                <span class="c">// through inheritance.</span>
 
                <b>throw</b> <b>new</b> <span class="t">MetadataException</span>(
                    <span class="s">&quot;DuplicateParameterDefinition&quot;</span>,
                    <b>null</b>,
                    <span class="i">ParameterBinderStrings</span>.<span class="i">DuplicateParameterDefinition</span>,
                    <span class="r105 r">member</span>.<span class="i">Name</span>);
            }
 
            <b>if</b> (!<span class="r108 r">useExisting</span>)
            {
                <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r111 rd" class="r111 r">parameter</span> = <b>new</b> <a href="CompiledCommandParameter.cs.html#e13daa1f4cfa8b6c" class="t constructor">CompiledCommandParameter</a>(<span class="r105 r">member</span>, <span class="r106 r">processingDynamicParameters</span>);
                <a href="#26eca0f27db79be9" class="i method">AddParameter</a>(<span class="r111 r">parameter</span>, <b>true</b>);
            }
        }
 
        <b>private void</b> <a id="26eca0f27db79be9" href="../R/26eca0f27db79be9.html" target="n" data-glyph="76,1" class="i method">AddParameter</a>(<a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r112 rd" class="r112 r">parameter</span>, <b>bool</b> <span id="r113 rd" class="r113 r">checkNames</span>)
        {
            <b>if</b> (<span class="r113 r">checkNames</span>)
            {
                <a href="#273c0f999dde3248" class="i method">CheckForReservedParameter</a>(<span class="r112 r">parameter</span>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
            }
 
            <a href="#6a8e3f7bd944a14f" class="i property">BindableParameters</a>.<span class="i">Add</span>(<span class="r112 r">parameter</span>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r112 r">parameter</span>);
 
            <span class="c">// Now add entries in the parameter aliases collection for any aliases.</span>
 
            <b>foreach</b> (<b>string</b> <span id="r114 rd" class="r114 r">alias</span> <b>in</b> <span class="r112 r">parameter</span>.<a href="CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>)
            {
                <b>if</b> (<a href="#f7290dc9779e8ba7" class="i property">AliasedParameters</a>.<span class="i">ContainsKey</span>(<span class="r114 r">alias</span>))
                {
                    <b>throw</b> <b>new</b> <span class="t">MetadataException</span>(
                            <span class="s">&quot;AliasDeclaredMultipleTimes&quot;</span>,
                            <b>null</b>,
                            <span class="i">DiscoveryExceptions</span>.<span class="i">AliasDeclaredMultipleTimes</span>,
                            <span class="r114 r">alias</span>);
                }
 
                <a href="#f7290dc9779e8ba7" class="i property">AliasedParameters</a>.<span class="i">Add</span>(<span class="r114 r">alias</span>, <span class="r112 r">parameter</span>);
            }
        }
 
        <b>private void</b> <a id="66e4d899200e932c" href="../R/66e4d899200e932c.html" target="n" data-glyph="76,1" class="i method">RemoveParameter</a>(<a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r115 rd" class="r115 r">parameter</span>)
        {
            <a href="#6a8e3f7bd944a14f" class="i property">BindableParameters</a>.<span class="i">Remove</span>(<span class="r115 r">parameter</span>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
 
            <span class="c">// Now add entries in the parameter aliases collection for any aliases.</span>
 
            <b>foreach</b> (<b>string</b> <span id="r116 rd" class="r116 r">alias</span> <b>in</b> <span class="r115 r">parameter</span>.<a href="CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>)
            {
                <a href="#f7290dc9779e8ba7" class="i property">AliasedParameters</a>.<span class="i">Remove</span>(<span class="r116 r">alias</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified member represents a parameter based on its attributes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">member</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The member to check to see if it is a parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if at least one ParameterAttribute is declared on the member, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If GetCustomAttributes fails on </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">member</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="7a7d237b10683f89" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsMemberAParameter</a>(<span class="i">MemberInfo</span> <span id="r117 rd" class="r117 r">member</span>)
        {
            <b>try</b>
            {
                <b>var</b> <span id="r118 rd" class="r118 r">expAttribute</span> = <span class="r117 r">member</span>.<span class="i">GetCustomAttributes</span>&lt;<a href="ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>&gt;(<span class="i">inherit</span>: <b>false</b>).<span class="i">FirstOrDefault</span>();
                <b>if</b> (<span class="r118 r">expAttribute</span> != <b>null</b> &amp;&amp; <span class="r118 r">expAttribute</span>.<span class="i">ToHide</span>) { <b>return</b> <b>false</b>; }
 
                <b>var</b> <span id="r119 rd" class="r119 r">hasAnyVisibleParamAttributes</span> = <b>false</b>;
                <b>var</b> <span id="r120 rd" class="r120 r">paramAttributes</span> = <span class="r117 r">member</span>.<span class="i">GetCustomAttributes</span>&lt;<a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>&gt;(<span class="i">inherit</span>: <b>false</b>);
                <b>foreach</b> (<b>var</b> <span id="r121 rd" class="r121 r">paramAttribute</span> <b>in</b> <span class="r120 r">paramAttributes</span>)
                {
                    <b>if</b> (!<span class="r121 r">paramAttribute</span>.<span class="i">ToHide</span>)
                    {
                        <span class="r119 r">hasAnyVisibleParamAttributes</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
 
                <b>return</b> <span class="r119 r">hasAnyVisibleParamAttributes</span>;
            }
            <b>catch</b> (<a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a> <span id="r122 rd" class="r122 r">metadataException</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">MetadataException</span>(
                    <span class="s">&quot;GetCustomAttributesMetadataException&quot;</span>,
                    <span class="r122 r">metadataException</span>,
                    <span class="i">Metadata</span>.<span class="i">MetadataMemberInitialization</span>,
                    <span class="r117 r">member</span>.<span class="i">Name</span>,
                    <span class="r122 r">metadataException</span>.<span class="i">Message</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r123 rd" class="r123 r">argumentException</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">MetadataException</span>(
                    <span class="s">&quot;GetCustomAttributesArgumentException&quot;</span>,
                    <span class="r123 r">argumentException</span>,
                    <span class="i">Metadata</span>.<span class="i">MetadataMemberInitialization</span>,
                    <span class="r117 r">member</span>.<span class="i">Name</span>,
                    <span class="r123 r">argumentException</span>.<span class="i">Message</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> helper methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Metadata cache
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The cache of the type metadata. The key for the cache is the Type.FullName.</span>
        <span class="c">///</span><span class="c"> Note, this is a case-sensitive dictionary because Type names are case sensitive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>.<span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <a href="#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>&gt; <a id="f313e93d541142fe" href="../R/f313e93d541142fe.html" target="n" data-glyph="46,1" class="i field">s_parameterMetadataCache</a> =
            <b>new</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>.<span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <a href="#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>&gt;(<span class="i">StringComparer</span>.<span class="i">Ordinal</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Metadata cache
    }
}
</pre></td></tr></table></div></body></html>
