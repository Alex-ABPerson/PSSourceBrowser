<!DOCTYPE html>
<html><head><title>Job.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(4538);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/client/Job.cs" target="_top">engine\remoting\client\Job.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Tracing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<span class="c">// Stops compiler from warning about unknown warnings</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enumeration for job status values. Indicates the status</span>
    <span class="c">///</span><span class="c"> of the result object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="fac7cdff9aee3e4f" href="../../../R/fac7cdff9aee3e4f.html" target="n" data-glyph="18,0" class="t t"><span id="58bd23ff401ffaf9">JobState</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execution of command in job not started.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1213da49468b8ccd" href="../../../R/1213da49468b8ccd.html" target="n" data-glyph="24,1" class="i field">NotStarted</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execution of command in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8b3e2b923f5b0e5d" href="../../../R/8b3e2b923f5b0e5d.html" target="n" data-glyph="24,1" class="i field">Running</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execution of command completed in all</span>
        <span class="c">///</span><span class="c"> computernames/runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="db36b340edc064ae" href="../../../R/db36b340edc064ae.html" target="n" data-glyph="24,1" class="i field">Completed</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An error was encountered when trying to executed</span>
        <span class="c">///</span><span class="c"> command in one or more computernames/runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4d2acd22ba4f0da9" href="../../../R/4d2acd22ba4f0da9.html" target="n" data-glyph="24,1" class="i field">Failed</a> = 3,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command execution is cancelled (stopped) in one or more</span>
        <span class="c">///</span><span class="c"> computernames/runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="223c91574b18631a" href="../../../R/223c91574b18631a.html" target="n" data-glyph="24,1" class="i field">Stopped</a> = 4,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command execution is blocked (on user input host calls etc)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d73e45c1ea393a18" href="../../../R/d73e45c1ea393a18.html" target="n" data-glyph="24,1" class="i field">Blocked</a> = 5,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The job has been suspended.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2da89c5a929a8381" href="../../../R/2da89c5a929a8381.html" target="n" data-glyph="24,1" class="i field">Suspended</a> = 6,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The job is a remote job and has been disconnected from the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a6de52aa4733f7cb" href="../../../R/a6de52aa4733f7cb.html" target="n" data-glyph="24,1" class="i field">Disconnected</a> = 7,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Suspend is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1340456ba13acdcb" href="../../../R/1340456ba13acdcb.html" target="n" data-glyph="24,1" class="i field">Suspending</a> = 8,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="57a9991c9eea4421" href="../../../R/57a9991c9eea4421.html" target="n" data-glyph="24,1" class="i field">Stopping</a> = 9,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Script execution is halted in a debugger stop.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="3a538a4d2b74d6fc" href="../../../R/3a538a4d2b74d6fc.html" target="n" data-glyph="24,1" class="i field">AtBreakpoint</a> = 10
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines exception which is thrown when state of the PSJob is different</span>
    <span class="c">///</span><span class="c"> from the expected state.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="dc278bb168e942bb" href="../../../R/dc278bb168e942bb.html" target="n" data-glyph="0,0" class="t t">InvalidJobStateException</a> : <span class="i">SystemException</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of InvalidPSJobStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="3af7bd55b5411a77" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidJobStateException</a>()
            : <b>base</b>
        (
            <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>
            (
                <span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidJobStateGeneral</span>
            )
        )
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of InvalidPSJobStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error message that explains the reason for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="6086c2e2e4d307ce" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidJobStateException</a>(<b>string</b> <span id="r0 rd" class="r0 r">message</span>)
            : <b>base</b>(<span class="r0 r">message</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of InvalidPSJobStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The error message that explains the reason for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The exception that is the cause of the current exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="3308b012830a5a85" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidJobStateException</a>(<b>string</b> <span id="r1 rd" class="r1 r">message</span>, <span class="i">Exception</span> <span id="r2 rd" class="r2 r">innerException</span>)
            : <b>base</b>(<span class="r1 r">message</span>, <span class="r2 r">innerException</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of InvalidJobStateException class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">currentState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Job State at the time of the error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">actionMessage</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An additional message that gives more information about the error. Used</span>
        <span class="c">///</span><span class="c"> for context after a generalized error message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c80eb7ee795df225" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">InvalidJobStateException</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r3 rd" class="r3 r">currentState</span>, <b>string</b> <span id="r4 rd" class="r4 r">actionMessage</span>)
            : <b>base</b>
        (
            <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>
            (
                <span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidJobStateSpecific</span>, <span class="r3 r">currentState</span>, <span class="r4 r">actionMessage</span>
            )
        )
        {
            <a href="#651ebb0bcda4e761" class="i field">_currState</a> = <span class="r3 r">currentState</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidPSJobStateException and defines value of</span>
        <span class="c">///</span><span class="c"> CurrentState.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">currentState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current state of powershell.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="8e23b35147b74756" href="../../../R/8e23b35147b74756.html" target="n" data-glyph="74,1" class="t constructor">InvalidJobStateException</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r5 rd" class="r5 r">currentState</span>)
            : <b>base</b>
        (
            <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>
            (
                <span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidJobStateGeneral</span>
            )
        )
        {
            <a href="#651ebb0bcda4e761" class="i field">_currState</a> = <span class="r5 r">currentState</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ISerializable Members
 
        <span class="c">// No need to implement GetObjectData</span>
        <span class="c">// if all fields are static or [NonSerialized]</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the InvalidPSJobStateException</span>
        <span class="c">///</span><span class="c"> class with serialized data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SerializationInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that holds the serialized object</span>
        <span class="c">///</span><span class="c"> data about the exception being thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">StreamingContext</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that contains contextual information</span>
        <span class="c">///</span><span class="c"> about the source or destination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b>
        <a id="5e02c055b7e45e9d" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">InvalidJobStateException</a>(<span class="i">SerializationInfo</span> <span id="r6 rd" class="r6 r">info</span>, <span class="i">StreamingContext</span> <span id="r7 rd" class="r7 r">context</span>)
            : <b>base</b>(<span class="r6 r">info</span>, <span class="r7 r">context</span>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets CurrentState of the Job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <a id="03d1c08efbcd52de" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CurrentState</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#651ebb0bcda4e761" class="i field">_currState</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> State of job when exception was thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">NonSerialized</span>]
        <b>private readonly</b> <a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <a id="651ebb0bcda4e761" href="../../../R/651ebb0bcda4e761.html" target="n" data-glyph="46,1" class="i field">_currState</a> = 0;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Type which has information about JobState and Exception</span>
    <span class="c">///</span><span class="c"> ,if any, associated with JobState.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="8f788812e1264af5" href="../../../R/8f788812e1264af5.html" target="n" data-glyph="0,0" class="t t">JobStateInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for state changes not resulting from an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Execution state.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="a797c55ae803218c" href="../../../R/a797c55ae803218c.html" target="n" data-glyph="72,1" class="t constructor">JobStateInfo</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r8 rd" class="r8 r">state</span>)
            : <a href="#c9b5221f53e16cd6" class="k">this</a>(<span class="r8 r">state</span>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for state changes with an optional error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The new state.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A non-null exception if the state change was</span>
        <span class="c">///</span><span class="c"> caused by an error,otherwise; null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c9b5221f53e16cd6" href="../../../R/c9b5221f53e16cd6.html" target="n" data-glyph="72,1" class="t constructor">JobStateInfo</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r9 rd" class="r9 r">state</span>, <span class="i">Exception</span> <span id="r10 rd" class="r10 r">reason</span>)
        {
            <a href="#245057a5f4a9ed30" class="i property">State</a> = <span class="r9 r">state</span>;
            <a href="#5814932cc8525971" class="i property">Reason</a> = <span class="r10 r">reason</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy constructor to support cloning.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">jobStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Source information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">throws</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ArgumentNullException when </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">jobStateInfo</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">throws</span><span class="c">&gt;</span>
        <b>internal</b> <a id="be4164a2496361f9" href="../../../R/be4164a2496361f9.html" target="n" data-glyph="74,1" class="t constructor">JobStateInfo</a>(<a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <span id="r11 rd" class="r11 r">jobStateInfo</span>)
        {
            <a href="#245057a5f4a9ed30" class="i property">State</a> = <span class="r11 r">jobStateInfo</span>.<a href="#245057a5f4a9ed30" class="i property">State</a>;
            <a href="#5814932cc8525971" class="i property">Reason</a> = <span class="r11 r">jobStateInfo</span>.<a href="#5814932cc8525971" class="i property">Reason</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The state of the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This value indicates the state of the job .</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <a id="245057a5f4a9ed30" href="../../../R/245057a5f4a9ed30.html" target="n" data-glyph="102,1" class="i property">State</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The reason for the state change, if caused by an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of this property is non-null if the state</span>
        <span class="c">///</span><span class="c"> changed due to an error. Otherwise, the value of this</span>
        <span class="c">///</span><span class="c"> property is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Exception</span> <a id="5814932cc8525971" href="../../../R/5814932cc8525971.html" target="n" data-glyph="102,1" class="i property">Reason</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override for ToString()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="4f22c738876a5e59" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#245057a5f4a9ed30" class="i property">State</a>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clones this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Cloned object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <a id="82ea86316c10a9fd" href="../../../R/82ea86316c10a9fd.html" target="n" data-glyph="74,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <a href="#be4164a2496361f9" class="t constructor">JobStateInfo</a>(<a href="#8f788812e1264af5" class="k">this</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private_fields
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private_fields
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Event arguments passed to JobStateEvent handlers</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e1ff43f6998863de" class="t t">Job</a>.<a href="#a099819afc059aeb" class="i">StateChanged</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="efe480d4e86a46d4" href="../../../R/efe480d4e86a46d4.html" target="n" data-glyph="0,0" class="t t">JobStateEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor of JobStateEventArgs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">jobStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current state of the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="541d6111289d0acf" href="../../../R/541d6111289d0acf.html" target="n" data-glyph="72,1" class="t constructor">JobStateEventArgs</a>(<a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <span id="r12 rd" class="r12 r">jobStateInfo</span>)
            : <a href="#18e6fc44c599c11a" class="k">this</a>(<span class="r12 r">jobStateInfo</span>, <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor of JobStateEventArgs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">jobStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The current state of the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">previousJobStateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The previous state of the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="18e6fc44c599c11a" href="../../../R/18e6fc44c599c11a.html" target="n" data-glyph="72,1" class="t constructor">JobStateEventArgs</a>(<a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <span id="r13 rd" class="r13 r">jobStateInfo</span>, <a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <span id="r14 rd" class="r14 r">previousJobStateInfo</span>)
        {
            <b>if</b> (<span class="r13 r">jobStateInfo</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r13 r">jobStateInfo</span>));
            }
 
            <a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a> = <span class="r13 r">jobStateInfo</span>;
            <a href="#6302f233913a7ce2" class="i property">PreviousJobStateInfo</a> = <span class="r14 r">previousJobStateInfo</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public_properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Info about the current state of the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <a id="7e34bf23c7781be3" href="../../../R/7e34bf23c7781be3.html" target="n" data-glyph="102,1" class="i property">JobStateInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Info about the previous state of the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <a id="6302f233913a7ce2" href="../../../R/6302f233913a7ce2.html" target="n" data-glyph="102,1" class="i property">PreviousJobStateInfo</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public_properties
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Object that must be created by PowerShell to allow reuse of an ID for a job.</span>
    <span class="c">///</span><span class="c"> Also allows setting of the Instance Id so that jobs may be recreated.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="746f37dcfb77f63f" href="../../../R/746f37dcfb77f63f.html" target="n" data-glyph="0,0" class="t t">JobIdentifier</a>
    {
        <b>internal</b> <a id="33ece2fd525215d7" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">JobIdentifier</a>(<b>int</b> <span id="r15 rd" class="r15 r">id</span>, <span class="i">Guid</span> <span id="r16 rd" class="r16 r">instanceId</span>)
        {
            <b>if</b> (<span class="r15 r">id</span> &lt;= 0)
                <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r15 r">id</span>), <span class="i">RemotingErrorIdStrings</span>.<span class="i">JobSessionIdLessThanOne</span>, <span class="r15 r">id</span>);
            <a href="#da5600775d20288c" class="i property">Id</a> = <span class="r15 r">id</span>;
            <a href="#c359feffe2905cd7" class="i property">InstanceId</a> = <span class="r16 r">instanceId</span>;
        }
 
        <b>internal int</b> <a id="da5600775d20288c" href="../../../R/da5600775d20288c.html" target="n" data-glyph="104,1" class="i property">Id</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Guid</span> <a id="c359feffe2905cd7" href="../../../R/c359feffe2905cd7.html" target="n" data-glyph="104,1" class="i property">InstanceId</a> { <b>get</b>; <b>private set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Interface to expose a job debugger.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="0a5020043aef4132" href="../../../R/0a5020043aef4132.html" target="n" data-glyph="48,0" class="t t">IJobDebugger</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job Debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a>? <a id="a3c4b1b7836de96a" href="../../../R/a3c4b1b7836de96a.html" target="n" data-glyph="102,1" class="i property">Debugger</a>
        {
            <b>get</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if job is running asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>bool</b> <a id="3e4fd95ba1813b1f" href="../../../R/3e4fd95ba1813b1f.html" target="n" data-glyph="102,1" class="i property">IsAsync</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents a command running in background. A job object can internally</span>
    <span class="c">///</span><span class="c"> contain many child job objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="e1ff43f6998863de" href="../../../R/e1ff43f6998863de.html" target="n" data-glyph="0,0" class="t t">Job</a> : <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="47807e473d67bda3" href="../../../R/47807e473d67bda3.html" target="n" data-glyph="75,1" class="t constructor">Job</a>()
        {
            <a href="#aa91c39ac1b0bcec" class="i property">Id</a> = <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#1350b3dc0f1ea8fb" class="i field">s_jobIdSeed</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="74a42d7ce4759be3" href="../../../R/74a42d7ce4759be3.html" target="n" data-glyph="75,1" class="t constructor">Job</a>(<b>string</b> <span id="r17 rd" class="r17 r">command</span>)
            : <a href="#47807e473d67bda3" class="k">this</a>()
        {
            <a href="#8cc82c1860b7ef46" class="i property">Command</a> = <span class="r17 r">command</span>;
            <a href="#f64d66fac851d63e" class="i field">_name</a> = <a href="#ae15ab43277234b5" class="i method">AutoGenerateJobName</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="8083742b97acc268" href="../../../R/8083742b97acc268.html" target="n" data-glyph="75,1" class="t constructor">Job</a>(<b>string</b> <span id="r18 rd" class="r18 r">command</span>, <b>string</b> <span id="r19 rd" class="r19 r">name</span>)
            : <a href="#74a42d7ce4759be3" class="k">this</a>(<span class="r18 r">command</span>)
        {
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r19 r">name</span>))
            {
                <a href="#f64d66fac851d63e" class="i field">_name</a> = <span class="r19 r">name</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">childJobs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Child jobs of this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="e7e8f9709e2cfedc" href="../../../R/e7e8f9709e2cfedc.html" target="n" data-glyph="75,1" class="t constructor">Job</a>(<b>string</b> <span id="r20 rd" class="r20 r">command</span>, <b>string</b> <span id="r21 rd" class="r21 r">name</span>, <span class="i">IList</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <span id="r22 rd" class="r22 r">childJobs</span>)
            : <a href="#8083742b97acc268" class="k">this</a>(<span class="r20 r">command</span>, <span class="r21 r">name</span>)
        {
            <a href="#9403a8b63f7b33ab" class="i field">_childJobs</a> = <span class="r22 r">childJobs</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">token</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id and InstanceId pair to be used for this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">The JobIdentifier is a token that must be issued by PowerShell to allow</span>
        <span class="c">///</span><span class="c"> reuse of the Id. This is the only way to set either Id or instance Id.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected</b> <a id="be222e44b9c2d6d7" href="../../../R/be222e44b9c2d6d7.html" target="n" data-glyph="75,1" class="t constructor">Job</a>(<b>string</b> <span id="r23 rd" class="r23 r">command</span>, <b>string</b> <span id="r24 rd" class="r24 r">name</span>, <a href="#746f37dcfb77f63f" class="t t">JobIdentifier</a> <span id="r25 rd" class="r25 r">token</span>)
        {
            <b>if</b> (<span class="r25 r">token</span> == <b>null</b>)
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<span class="r25 r">token</span>), <span class="i">RemotingErrorIdStrings</span>.<span class="i">JobIdentifierNull</span>);
            <b>if</b> (<span class="r25 r">token</span>.<a href="#da5600775d20288c" class="i property">Id</a> &gt; <a href="#1350b3dc0f1ea8fb" class="i field">s_jobIdSeed</a>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r25 r">token</span>), <span class="i">RemotingErrorIdStrings</span>.<span class="i">JobIdNotYetAssigned</span>, <span class="r25 r">token</span>.<a href="#da5600775d20288c" class="i property">Id</a>);
            }
 
            <a href="#8cc82c1860b7ef46" class="i property">Command</a> = <span class="r23 r">command</span>;
 
            <a href="#aa91c39ac1b0bcec" class="i property">Id</a> = <span class="r25 r">token</span>.<a href="#da5600775d20288c" class="i property">Id</a>;
            <a href="#958365243a8fc2cd" class="i property">InstanceId</a> = <span class="r25 r">token</span>.<a href="#c359feffe2905cd7" class="i property">InstanceId</a>;
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">name</span>))
            {
                <a href="#f64d66fac851d63e" class="i field">_name</a> = <span class="r24 r">name</span>;
            }
            <b>else</b>
            {
                <a href="#f64d66fac851d63e" class="i field">_name</a> = <a href="#ae15ab43277234b5" class="i method">AutoGenerateJobName</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">InstanceId to be used for this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">The InstanceId may need to be set to maintain job identity across</span>
        <span class="c">///</span><span class="c"> instances of the process.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected</b> <a id="5a60b335d7bfb6a1" href="../../../R/5a60b335d7bfb6a1.html" target="n" data-glyph="75,1" class="t constructor">Job</a>(<b>string</b> <span id="r26 rd" class="r26 r">command</span>, <b>string</b> <span id="r27 rd" class="r27 r">name</span>, <span class="i">Guid</span> <span id="r28 rd" class="r28 r">instanceId</span>)
            : <a href="#8083742b97acc268" class="k">this</a>(<span class="r26 r">command</span>, <span class="r27 r">name</span>)
        {
            <a href="#958365243a8fc2cd" class="i property">InstanceId</a> = <span class="r28 r">instanceId</span>;
        }
 
        <b>internal static string</b> <a id="c189fa8a2b16ee06" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetCommandTextFromInvocationInfo</a>(<a href="../../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r29 rd" class="r29 r">invocationInfo</span>)
        {
            <b>if</b> (<span class="r29 r">invocationInfo</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="../../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r30 rd" class="r30 r">scriptExtent</span> = <span class="r29 r">invocationInfo</span>.<a href="../../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>;
            <b>if</b> ((<span class="r30 r">scriptExtent</span> != <b>null</b>) &amp;&amp; (<span class="r30 r">scriptExtent</span>.<a href="../../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a> != <b>null</b>) &amp;&amp; !<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r30 r">scriptExtent</span>.<a href="../../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../../parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>))
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r30 r">scriptExtent</span>.<a href="../../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../../parser/Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a> &gt; 0, <span class="s">&quot;Column numbers start at 1&quot;</span>);
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r30 r">scriptExtent</span>.<a href="../../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../../parser/Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a> &lt;= <span class="r30 r">scriptExtent</span>.<a href="../../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../../parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>.<span class="i">Length</span>, <span class="s">&quot;Column numbers are not greater than the length of a line&quot;</span>);
                <b>return</b> <span class="r30 r">scriptExtent</span>.<a href="../../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../../parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>.<span class="i">AsSpan</span>(<span class="r30 r">scriptExtent</span>.<a href="../../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../../parser/Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a> - 1).<span class="i">Trim</span>().<span class="i">ToString</span>();
            }
 
            <b>return</b> <span class="r29 r">invocationInfo</span>.<a href="../../InvocationInfo.cs.html#57f452abf157b50b" class="i property">InvocationName</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private</b> <span class="i">ManualResetEvent</span> <a id="d0937726bf5ffe8a" href="../../../R/d0937726bf5ffe8a.html" target="n" data-glyph="46,1" class="i field">_finished</a> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>false</b>);
 
        <b>private string</b> <a id="f64d66fac851d63e" href="../../../R/f64d66fac851d63e.html" target="n" data-glyph="46,1" class="i field">_name</a>;
        <b>private</b> <span class="i">IList</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <a id="9403a8b63f7b33ab" href="../../../R/9403a8b63f7b33ab.html" target="n" data-glyph="46,1" class="i field">_childJobs</a>;
        <b>internal readonly object</b> <a id="d933c0709e639dd1" href="../../../R/d933c0709e639dd1.html" target="n" data-glyph="44,1" class="i field">syncObject</a> = <b>new</b> <b>object</b>();   <span class="c">// object used for synchronization</span>
        <span class="c">// ISSUE: Should Result be public property</span>
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a>&gt; <a id="10870d263c69d67d" href="../../../R/10870d263c69d67d.html" target="n" data-glyph="46,1" class="i field">_results</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a>&gt;();
        <b>private bool</b> <a id="c9e25ca75d26e0c6" href="../../../R/c9e25ca75d26e0c6.html" target="n" data-glyph="46,1" class="i field">_resultsOwner</a> = <b>true</b>;
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="c028986e2a9d6fb7" href="../../../R/c028986e2a9d6fb7.html" target="n" data-glyph="46,1" class="i field">_error</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
        <b>private bool</b> <a id="50b45664ed9d2caa" href="../../../R/50b45664ed9d2caa.html" target="n" data-glyph="46,1" class="i field">_errorOwner</a> = <b>true</b>;
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>&gt; <a id="3e4ca26742c9d2f4" href="../../../R/3e4ca26742c9d2f4.html" target="n" data-glyph="46,1" class="i field">_progress</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>&gt;();
        <b>private bool</b> <a id="c9f3aee739f3a0ff" href="../../../R/c9f3aee739f3a0ff.html" target="n" data-glyph="46,1" class="i field">_progressOwner</a> = <b>true</b>;
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>&gt; <a id="da9d6f63622a3ca7" href="../../../R/da9d6f63622a3ca7.html" target="n" data-glyph="46,1" class="i field">_verbose</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>&gt;();
        <b>private bool</b> <a id="aea402feba6f5458" href="../../../R/aea402feba6f5458.html" target="n" data-glyph="46,1" class="i field">_verboseOwner</a> = <b>true</b>;
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt; <a id="6c773089098c55ae" href="../../../R/6c773089098c55ae.html" target="n" data-glyph="46,1" class="i field">_warning</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt;();
        <b>private bool</b> <a id="69d1d59474501818" href="../../../R/69d1d59474501818.html" target="n" data-glyph="46,1" class="i field">_warningOwner</a> = <b>true</b>;
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>&gt; <a id="e988cdf58b9ab5da" href="../../../R/e988cdf58b9ab5da.html" target="n" data-glyph="46,1" class="i field">_debug</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>&gt;();
        <b>private bool</b> <a id="e0153fdea5b7fdf2" href="../../../R/e0153fdea5b7fdf2.html" target="n" data-glyph="46,1" class="i field">_debugOwner</a> = <b>true</b>;
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>&gt; <a id="e254cc8daa67676e" href="../../../R/e254cc8daa67676e.html" target="n" data-glyph="46,1" class="i field">_information</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>&gt;();
        <b>private bool</b> <a id="480e4edead7694cd" href="../../../R/480e4edead7694cd.html" target="n" data-glyph="46,1" class="i field">_informationOwner</a> = <b>true</b>;
        <b>private</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="278d4c5d7c1a63cb" href="../../../R/278d4c5d7c1a63cb.html" target="n" data-glyph="46,1" class="i field">_output</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
        <b>private bool</b> <a id="fc031da5f4882455" href="../../../R/fc031da5f4882455.html" target="n" data-glyph="46,1" class="i field">_outputOwner</a> = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Static variable which is incremented to generate id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="1350b3dc0f1ea8fb" href="../../../R/1350b3dc0f1ea8fb.html" target="n" data-glyph="46,1" class="i field">s_jobIdSeed</a> = 0;
 
        <b>private string</b> <a id="87b5c17a430820d9" href="../../../R/87b5c17a430820d9.html" target="n" data-glyph="46,1" class="i field">_jobTypeName</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Job Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command Invoked by this Job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="8cc82c1860b7ef46" href="../../../R/8cc82c1860b7ef46.html" target="n" data-glyph="102,1" class="i property">Command</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Status of the command execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <a id="896d1d1f27daae5f" href="../../../R/896d1d1f27daae5f.html" target="n" data-glyph="102,1" class="i property">JobStateInfo</a> { <b>get</b>; <b>private set</b>; } = <b>new</b> <a href="#a797c55ae803218c" class="t constructor">JobStateInfo</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#1213da49468b8ccd" class="i field">NotStarted</a>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait Handle which is signaled when job is finished.</span>
        <span class="c">///</span><span class="c"> This is set when state of the job is set to Completed,</span>
        <span class="c">///</span><span class="c"> Stopped or Failed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">WaitHandle</span> <a id="b1600ff0c937953b" href="../../../R/b1600ff0c937953b.html" target="n" data-glyph="102,1" class="i property">Finished</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#e1ff43f6998863de" class="k">this</a>.<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <b>if</b> (<a href="#d0937726bf5ffe8a" class="i field">_finished</a> != <b>null</b>)
                    {
                        <b>return</b> <a href="#d0937726bf5ffe8a" class="i field">_finished</a>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// Damage control mode:</span>
                        <span class="c">// Somebody is trying to get Finished handle for an already disposed Job instance.</span>
                        <span class="c">// Return an already triggered handle (disposed job is finished by definition).</span>
                        <span class="c">// The newly created handle will not be disposed in a deterministic manner</span>
                        <span class="c">// and in some circumstances can be mistaken for a handle leak.</span>
                        <b>return</b> <b>new</b> <span class="i">ManualResetEvent</span>(<b>true</b>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unique identifier for this job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="958365243a8fc2cd" href="../../../R/958365243a8fc2cd.html" target="n" data-glyph="102,1" class="i property">InstanceId</a> { <b>get</b>; } = <span class="i">Guid</span>.<span class="i">NewGuid</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Short identifier for this result which will be</span>
        <span class="c">///</span><span class="c"> recycled and used within a process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="aa91c39ac1b0bcec" href="../../../R/aa91c39ac1b0bcec.html" target="n" data-glyph="102,1" class="i property">Id</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name for identifying this job object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="6332c7ef857bb146" href="../../../R/6332c7ef857bb146.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f64d66fac851d63e" class="i field">_name</a>;
            }
 
            <b>set</b>
            {
                <a href="#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
                <a href="#f64d66fac851d63e" class="i field">_name</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of child jobs contained within this job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">IList</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <a id="db120f2476b59753" href="../../../R/db120f2476b59753.html" target="n" data-glyph="102,1" class="i property">ChildJobs</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#9403a8b63f7b33ab" class="i field">_childJobs</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                    {
                        <b>if</b> (<a href="#9403a8b63f7b33ab" class="i field">_childJobs</a> == <b>null</b>)
                        {
                            <a href="#9403a8b63f7b33ab" class="i field">_childJobs</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt;();
                        }
                    }
                }
 
                <b>return</b> <a href="#9403a8b63f7b33ab" class="i field">_childJobs</a>;
            }
        }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Success status of the command execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract string</b> <a id="b5918469cf3d561b" href="../../../R/b5918469cf3d561b.html" target="n" data-glyph="102,1" class="i property">StatusMessage</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that more data is available in this</span>
        <span class="c">///</span><span class="c"> result object for reading.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract bool</b> <a id="bdbea4d2ac6ecc6b" href="../../../R/bdbea4d2ac6ecc6b.html" target="n" data-glyph="102,1" class="i property">HasMoreData</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Time job was started.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span>? <a id="7ed5cb1dfd270632" href="../../../R/7ed5cb1dfd270632.html" target="n" data-glyph="102,1" class="i property">PSBeginTime</a> { <b>get</b>; <b>protected set</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Time job stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">DateTime</span>? <a id="b4585c98af5cbea6" href="../../../R/b4585c98af5cbea6.html" target="n" data-glyph="102,1" class="i property">PSEndTime</a> { <b>get</b>; <b>protected set</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job type name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="48fbced17e8f44b3" href="../../../R/48fbced17e8f44b3.html" target="n" data-glyph="102,1" class="i property">PSJobTypeName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#87b5c17a430820d9" class="i field">_jobTypeName</a>;
            }
 
            <b>protected internal set</b>
            {
                <a href="#87b5c17a430820d9" class="i field">_jobTypeName</a> = <b>value</b> ?? <a href="#e1ff43f6998863de" class="k">this</a>.<span class="i">GetType</span>().<span class="i">ToString</span>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> results
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Result objects from this job. If this object is not a</span>
        <span class="c">///</span><span class="c"> leaf node (with no children), then this will</span>
        <span class="c">///</span><span class="c"> aggregate the results from all child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a>&gt; <a id="2f6fd0f4814916f6" href="../../../R/2f6fd0f4814916f6.html" target="n" data-glyph="104,1" class="i property">Results</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#10870d263c69d67d" class="i field">_results</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Results&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#c9e25ca75d26e0c6" class="i field">_resultsOwner</a> = <b>false</b>;
                    <a href="#10870d263c69d67d" class="i field">_results</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates if a particular Job type uses the</span>
        <span class="c">///</span><span class="c"> internal results collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="fd6ecf089f9dc9c7" href="../../../R/fd6ecf089f9dc9c7.html" target="n" data-glyph="104,1" class="i property">UsesResultsCollection</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Suppresses forwarding of job output into a cmdlet (like Receive-Job).</span>
        <span class="c">///</span><span class="c"> This flag modifies functionality of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#bae3ecf98f6c407d" class="i method">WriteObject</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method, so that it doesnt add output-processing to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#2f6fd0f4814916f6" class="i property">Results</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="65eb3d4c4ed21ef4" href="../../../R/65eb3d4c4ed21ef4.html" target="n" data-glyph="104,1" class="i property">SuppressOutputForwarding</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal virtual void</b> <a id="bae3ecf98f6c407d" href="../../../R/bae3ecf98f6c407d.html" target="n" data-glyph="74,1" class="i method">WriteObject</a>(<b>object</b> <span id="r31 rd" class="r31 r">outputObject</span>)
        {
            <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r32 rd" class="r32 r">pso</span> = (<span class="r31 r">outputObject</span> == <b>null</b>) ? <b>null</b> : <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r31 r">outputObject</span>);
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#9f3b4cf91a5477ce" class="i property">Output</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r32 r">pso</span>);
 
            <b>if</b> (!<a href="#65eb3d4c4ed21ef4" class="i property">SuppressOutputForwarding</a>)
            {
                <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#503ddb460914a8c9" class="i field">Output</a>, <span class="r32 r">pso</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allows propagating of terminating exceptions from remote &quot;throw&quot; statement</span>
        <span class="c">///</span><span class="c"> (normally / by default all remote errors are transformed into non-terminating errors.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="e09e33b0daa549e5" href="../../../R/e09e33b0daa549e5.html" target="n" data-glyph="104,1" class="i property">PropagateThrows</a> { <b>get</b>; <b>set</b>; }
 
        <b>private void</b> <a id="01d3dcf4bdbd5537" href="../../../R/01d3dcf4bdbd5537.html" target="n" data-glyph="76,1" class="i method">WriteError</a>(<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r33 rd" class="r33 r">cmdlet</span>, <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r34 rd" class="r34 r">errorRecord</span>)
        {
            <b>if</b> (<a href="#e1ff43f6998863de" class="k">this</a>.<a href="#e09e33b0daa549e5" class="i property">PropagateThrows</a>)
            {
                <span class="i">Exception</span> <span id="r35 rd" class="r35 r">e</span> = <a href="#db24c7db0f6aae16" class="i method">GetExceptionFromErrorRecord</a>(<span class="r34 r">errorRecord</span>);
                <b>if</b> (<span class="r35 r">e</span> != <b>null</b>)
                    <b>throw</b> <span class="r35 r">e</span>;
            }
 
            <span class="r34 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#b119c9996bde5b66" class="i property">PreserveInvocationInfoOnce</a> = <b>true</b>;
            <span class="r33 r">cmdlet</span>.<a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r34 r">errorRecord</span>);
        }
 
        <b>private static</b> <span class="i">Exception</span> <a id="db24c7db0f6aae16" href="../../../R/db24c7db0f6aae16.html" target="n" data-glyph="76,1" class="i method">GetExceptionFromErrorRecord</a>(<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r36 rd" class="r36 r">errorRecord</span>)
        {
            <b>if</b> (!(<span class="r36 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a> <b>is</b> <a href="../../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r37 rd" class="r37 r">runtimeException</span>))
                <b>return</b> <b>null</b>;
 
            <b>if</b> (!(<span class="r37 r">runtimeException</span> <b>is</b> <a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r38 rd" class="r38 r">remoteException</span>))
                <b>return</b> <b>null</b>;
 
            <a href="../../MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r39 rd" class="r39 r">wasThrownFromThrow</span> =
                <span class="r38 r">remoteException</span>.<a href="../../NativeCommandProcessor.cs.html#68770fe9884c0f08" class="i property">SerializedRemoteException</a>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;WasThrownFromThrowStatement&quot;</span>];
            <b>if</b> (<span class="r39 r">wasThrownFromThrow</span> == <b>null</b> || !((<b>bool</b>)<span class="r39 r">wasThrownFromThrow</span>.<a href="../../MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>))
                <b>return</b> <b>null</b>;
 
            <span class="r37 r">runtimeException</span>.<a href="../../../utils/RuntimeException.cs.html#07e13566c1a5f36a" class="i property">WasThrownFromThrowStatement</a> = <b>true</b>;
            <b>return</b> <span class="r37 r">runtimeException</span>;
        }
 
        <b>internal virtual void</b> <a id="f1efa785e9495a67" href="../../../R/f1efa785e9495a67.html" target="n" data-glyph="74,1" class="i method">WriteError</a>(<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r40 rd" class="r40 r">errorRecord</span>)
        {
            <a href="#322c09d9eb167da1" class="i property">Error</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r40 r">errorRecord</span>);
            <b>if</b> (<a href="#e09e33b0daa549e5" class="i property">PropagateThrows</a>)
            {
                <span class="i">Exception</span> <span id="r41 rd" class="r41 r">exception</span> = <a href="#db24c7db0f6aae16" class="i method">GetExceptionFromErrorRecord</a>(<span class="r40 r">errorRecord</span>);
                <b>if</b> (<span class="r41 r">exception</span> != <b>null</b>)
                {
                    <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">PSStreamObject</span>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#8878b3e33dd40ac1" class="i field">Exception</a>, <span class="r41 r">exception</span>));
                    <b>return</b>;
                }
            }
 
            <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#88738d1bbe207cf8" class="i field">Error</a>, <span class="r40 r">errorRecord</span>));
        }
 
        <b>internal void</b> <a id="b522bfe215c61459" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteError</a>(<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r42 rd" class="r42 r">errorRecord</span>, <b>out</b> <span class="i">Exception</span> <span id="r43 rd" class="r43 r">exceptionThrownOnCmdletThread</span>)
        {
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#322c09d9eb167da1" class="i property">Error</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r42 r">errorRecord</span>);
            <a href="#e1ff43f6998863de" class="k">this</a>.<span class="i">InvokeCmdletMethodAndWaitForResults</span>&lt;<b>object</b>&gt;(
                (<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r44 rd" class="r44 r">cmdlet</span>) =&gt;
                {
                    <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#01d3dcf4bdbd5537" class="i method">WriteError</a>(<span class="r44 r">cmdlet</span>, <span class="r42 r">errorRecord</span>);
                    <b>return</b> <b>null</b>;
                },
                <b>out</b> <span class="r43 r">exceptionThrownOnCmdletThread</span>);
        }
 
        <b>internal virtual void</b> <a id="e10d3e6d4bddf65f" href="../../../R/e10d3e6d4bddf65f.html" target="n" data-glyph="74,1" class="i method">WriteWarning</a>(<b>string</b> <span id="r45 rd" class="r45 r">message</span>)
        {
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2271b8dbce732fb7" class="i property">Warning</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../hostifaces/InformationalRecord.cs.html#cd27eb702abe7363" class="t constructor">WarningRecord</a>(<span class="r45 r">message</span>));
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#94b7fb40f26df4b8" class="i field">Warning</a>, <span class="r45 r">message</span>));
        }
 
        <b>internal virtual void</b> <a id="637abee795875362" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteVerbose</a>(<b>string</b> <span id="r46 rd" class="r46 r">message</span>)
        {
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2c4a777567a6240d" class="i property">Verbose</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../hostifaces/InformationalRecord.cs.html#edcf8ae61b2e64b0" class="t constructor">VerboseRecord</a>(<span class="r46 r">message</span>));
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#a460f5b9e6091568" class="i field">Verbose</a>, <span class="r46 r">message</span>));
        }
 
        <b>internal virtual void</b> <a id="2cea48951630e278" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteDebug</a>(<b>string</b> <span id="r47 rd" class="r47 r">message</span>)
        {
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#fcf5aa47c1f50562" class="i property">Debug</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../hostifaces/InformationalRecord.cs.html#e4b0e2a3d91478e0" class="t constructor">DebugRecord</a>(<span class="r47 r">message</span>));
            <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#b0bf390dba8a183f" class="i field">Debug</a>, <span class="r47 r">message</span>));
        }
 
        <b>internal virtual void</b> <a id="09558aae0df2b344" href="../../../R/09558aae0df2b344.html" target="n" data-glyph="74,1" class="i method">WriteProgress</a>(<a href="../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r48 rd" class="r48 r">progressRecord</span>)
        {
            <b>if</b> ((<span class="r48 r">progressRecord</span>.<a href="../../ProgressRecord.cs.html#730521203ee4eba0" class="i property">ParentActivityId</a> == (-1)) &amp;&amp; (<a href="#1b14241119bd83c7" class="i field">_parentActivityId</a> != <b>null</b>))
            {
                <span class="r48 r">progressRecord</span> = <b>new</b> <a href="../../ProgressRecord.cs.html#90bbc41a000f2235" class="t constructor">ProgressRecord</a>(<span class="r48 r">progressRecord</span>) { <a href="../../ProgressRecord.cs.html#730521203ee4eba0" class="i property">ParentActivityId</a> = <a href="#1b14241119bd83c7" class="i field">_parentActivityId</a>.<span class="i">Value</span> };
            }
 
            <a href="#0566bc7c986755b8" class="i property">Progress</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r48 r">progressRecord</span>);
            <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#c7356a25d651f7d9" class="i field">Progress</a>, <span class="r48 r">progressRecord</span>));
        }
 
        <b>internal virtual void</b> <a id="4145b07235b8dc87" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteInformation</a>(<a href="../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r49 rd" class="r49 r">informationRecord</span>)
        {
            <a href="#501ba88f677f8460" class="i property">Information</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r49 r">informationRecord</span>);
            <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#d540061bc850b342" class="i field">Information</a>, <span class="r49 r">informationRecord</span>));
        }
 
        <b>private</b> <span class="i">Lazy</span>&lt;<b>int</b>&gt; <a id="1b14241119bd83c7" href="../../../R/1b14241119bd83c7.html" target="n" data-glyph="46,1" class="i field">_parentActivityId</a>;
 
        <b>internal void</b> <a id="d970c7bbd5843f38" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetParentActivityIdGetter</a>(<span class="i">Func</span>&lt;<b>int</b>&gt; <span id="r50 rd" class="r50 r">parentActivityIdGetter</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r50 r">parentActivityIdGetter</span> != <b>null</b>, <span class="s">&quot;Caller should verify parentActivityIdGetter != null&quot;</span>);
            <a href="#1b14241119bd83c7" class="i field">_parentActivityId</a> = <b>new</b> <span class="i">Lazy</span>&lt;<b>int</b>&gt;(<span class="r50 r">parentActivityIdGetter</span>);
        }
 
        <b>internal bool</b> <a id="441aede0b124b2bd" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ShouldContinue</a>(<b>string</b> <span id="r51 rd" class="r51 r">query</span>, <b>string</b> <span id="r52 rd" class="r52 r">caption</span>)
        {
            <span class="i">Exception</span> <span id="r53 rd" class="r53 r">exceptionThrownOnCmdletThread</span>;
            <b>return</b> <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#bce470fe720e6f69" class="i method">ShouldContinue</a>(<span class="r51 r">query</span>, <span class="r52 r">caption</span>, <b>out</b> <span class="r53 r">exceptionThrownOnCmdletThread</span>);
        }
 
        <b>internal bool</b> <a id="bce470fe720e6f69" href="../../../R/bce470fe720e6f69.html" target="n" data-glyph="74,1" class="i method">ShouldContinue</a>(<b>string</b> <span id="r54 rd" class="r54 r">query</span>, <b>string</b> <span id="r55 rd" class="r55 r">caption</span>, <b>out</b> <span class="i">Exception</span> <span id="r56 rd" class="r56 r">exceptionThrownOnCmdletThread</span>)
        {
            <b>bool</b> <span id="r57 rd" class="r57 r">methodResult</span> = <span class="i">InvokeCmdletMethodAndWaitForResults</span>(
                <span id="r58 rd" class="r58 r">cmdlet</span> =&gt; <span class="r58 r">cmdlet</span>.<span class="i">ShouldContinue</span>(<span class="r54 r">query</span>, <span class="r55 r">caption</span>),
                <b>out</b> <span class="r56 r">exceptionThrownOnCmdletThread</span>);
            <b>return</b> <span class="r57 r">methodResult</span>;
        }
 
        <b>internal virtual void</b> <a id="920800fc559ec827" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NonblockingShouldProcess</a>(
            <b>string</b> <span id="r59 rd" class="r59 r">verboseDescription</span>,
            <b>string</b> <span id="r60 rd" class="r60 r">verboseWarning</span>,
            <b>string</b> <span id="r61 rd" class="r61 r">caption</span>)
        {
            <span class="i">InvokeCmdletMethodAndIgnoreResults</span>(
                (<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r62 rd" class="r62 r">cmdlet</span>) =&gt;
                {
                    <a href="../../cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r63 rd" class="r63 r">throwAwayProcessReason</span>;
                    <span class="r62 r">cmdlet</span>.<a href="../../cmdlet.cs.html#fee13e39455d3a34" class="i method">ShouldProcess</a>(
                        <span class="r59 r">verboseDescription</span>,
                        <span class="r60 r">verboseWarning</span>,
                        <span class="r61 r">caption</span>,
                        <b>out</b> <span class="r63 r">throwAwayProcessReason</span>);
                });
        }
 
        <b>internal virtual bool</b> <a id="8f3e17cf5b4cb349" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ShouldProcess</a>(
            <b>string</b> <span id="r64 rd" class="r64 r">verboseDescription</span>,
            <b>string</b> <span id="r65 rd" class="r65 r">verboseWarning</span>,
            <b>string</b> <span id="r66 rd" class="r66 r">caption</span>,
            <b>out</b> <a href="../../cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r67 rd" class="r67 r">shouldProcessReason</span>,
            <b>out</b> <span class="i">Exception</span> <span id="r68 rd" class="r68 r">exceptionThrownOnCmdletThread</span>)
        {
            <a href="../../cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a> <span id="r69 rd" class="r69 r">closureSafeShouldProcessReason</span> = <a href="../../cmdlet.cs.html#40cc5cec3eccab94" class="t t">ShouldProcessReason</a>.<a href="../../cmdlet.cs.html#401296eb0e0f2185" class="i field">None</a>;
 
            <b>bool</b> <span id="r70 rd" class="r70 r">methodResult</span> = <span class="i">InvokeCmdletMethodAndWaitForResults</span>(
                <span id="r71 rd" class="r71 r">cmdlet</span> =&gt; <span class="r71 r">cmdlet</span>.<span class="i">ShouldProcess</span>(
                    <span class="r64 r">verboseDescription</span>,
                    <span class="r65 r">verboseWarning</span>,
                    <span class="r66 r">caption</span>,
                    <b>out</b> <span class="r69 r">closureSafeShouldProcessReason</span>),
                <b>out</b> <span class="r68 r">exceptionThrownOnCmdletThread</span>);
 
            <span class="r67 r">shouldProcessReason</span> = <span class="r69 r">closureSafeShouldProcessReason</span>;
            <b>return</b> <span class="r70 r">methodResult</span>;
        }
 
        <b>private void</b> <a id="fa0ebe895ca989ee" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">InvokeCmdletMethodAndIgnoreResults</a>(<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt; <span id="r72 rd" class="r72 r">invokeCmdletMethod</span>)
        {
            <b>object</b> <span id="r73 rd" class="r73 r">resultsLock</span> = <b>new</b> <b>object</b>();
            <a href="../common/psstreamobject.cs.html#c8c8b295c95c2773" class="t t">CmdletMethodInvoker</a>&lt;<b>object</b>&gt; <span id="r74 rd" class="r74 r">methodInvoker</span> = <b>new</b> <span class="t">CmdletMethodInvoker</span>&lt;<b>object</b>&gt;
            {
                <a href="../common/psstreamobject.cs.html#cb125fff2365a4e5" class="i property">Action</a> = (<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r75 rd" class="r75 r">cmdlet</span>) =&gt; { <span class="r72 r">invokeCmdletMethod</span>(<span class="r75 r">cmdlet</span>); <b>return</b> <b>null</b>; },
                <a href="../common/psstreamobject.cs.html#dd813341bd39d91e" class="i property">Finished</a> = <b>null</b>,
                <a href="../common/psstreamobject.cs.html#b6908db24fb0258f" class="i property">SyncObject</a> = <span class="r73 r">resultsLock</span>
            };
            <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#fd9fdebfc7557450" class="i field">BlockingError</a>, <span class="r74 r">methodInvoker</span>));
        }
 
        <b>private</b> <span class="r76 r t">T</span> <a id="640e39262d224c97" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">InvokeCmdletMethodAndWaitForResults</a>&lt;<span id="r76 rd t" class="r76 r t">T</span>&gt;(<span class="i">Func</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>, <span class="r76 r t">T</span>&gt; <span id="r77 rd" class="r77 r">invokeCmdletMethodAndReturnResult</span>, <b>out</b> <span class="i">Exception</span> <span id="r78 rd" class="r78 r">exceptionThrownOnCmdletThread</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r77 r">invokeCmdletMethodAndReturnResult</span> != <b>null</b>, <span class="s">&quot;Caller should verify invokeCmdletMethodAndReturnResult != null&quot;</span>);
 
            <span class="r76 r t">T</span> <span id="r79 rd" class="r79 r">methodResult</span> = <b>default</b>(<span class="r76 r t">T</span>);
            <span class="i">Exception</span> <span id="r80 rd" class="r80 r">closureSafeExceptionThrownOnCmdletThread</span> = <b>null</b>;
            <b>object</b> <span id="r81 rd" class="r81 r">resultsLock</span> = <b>new</b> <b>object</b>();
            <b>using</b> (<b>var</b> <span id="r82 rd" class="r82 r">gotResultEvent</span> = <b>new</b> <span class="i">ManualResetEventSlim</span>(<b>false</b>))
            {
                <span class="i">EventHandler</span>&lt;<a href="#efe480d4e86a46d4" class="t t">JobStateEventArgs</a>&gt; <span id="r83 rd" class="r83 r">stateChangedEventHandler</span> =
                    (<b>object</b> <span id="r84 rd" class="r84 r">sender</span>, <a href="#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r85 rd" class="r85 r">eventArgs</span>) =&gt;
                    {
                        <b>if</b> (<a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<span class="r85 r">eventArgs</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>) || <span class="r85 r">eventArgs</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#57a9991c9eea4421" class="i field">Stopping</a>)
                        {
                            <b>lock</b> (<span class="r81 r">resultsLock</span>)
                            {
                                <span class="r80 r">closureSafeExceptionThrownOnCmdletThread</span> = <b>new</b> <span class="i">OperationCanceledException</span>();
                            }
 
                            <span class="r82 r">gotResultEvent</span>.<span class="i">Set</span>();
                        }
                    };
                <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#a099819afc059aeb" class="i">StateChanged</a> += <span class="r83 r">stateChangedEventHandler</span>;
                <span class="i">Interlocked</span>.<span class="i">MemoryBarrier</span>();
                <b>try</b>
                {
                    <span class="r83 r">stateChangedEventHandler</span>(<b>null</b>, <b>new</b> <a href="#541d6111289d0acf" class="t constructor">JobStateEventArgs</a>(<a href="#e1ff43f6998863de" class="k">this</a>.<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>));
 
                    <b>if</b> (!<span class="r82 r">gotResultEvent</span>.<span class="i">IsSet</span>)
                    {
                        <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>);
 
                        <span class="c">// addition to results column happens here</span>
                        <a href="../common/psstreamobject.cs.html#c8c8b295c95c2773" class="t t">CmdletMethodInvoker</a>&lt;<span class="r76 r t">T</span>&gt; <span id="r86 rd" class="r86 r">methodInvoker</span> = <b>new</b> <span class="t">CmdletMethodInvoker</span>&lt;<span class="r76 r t">T</span>&gt;
                        {
                            <a href="../common/psstreamobject.cs.html#cb125fff2365a4e5" class="i property">Action</a> = <span class="r77 r">invokeCmdletMethodAndReturnResult</span>,
                            <a href="../common/psstreamobject.cs.html#dd813341bd39d91e" class="i property">Finished</a> = <span class="r82 r">gotResultEvent</span>,
                            <a href="../common/psstreamobject.cs.html#b6908db24fb0258f" class="i property">SyncObject</a> = <span class="r81 r">resultsLock</span>
                        };
                        <a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a> <span id="r87 rd" class="r87 r">objectType</span> = <a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#2e8526d24ef5c568" class="i field">ShouldMethod</a>;
 
                        <b>if</b> (<b>typeof</b>(<span class="r76 r t">T</span>) == <b>typeof</b>(<b>object</b>))
                            <span class="r87 r">objectType</span> = <a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#fd9fdebfc7557450" class="i field">BlockingError</a>;
 
                        <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<span class="r87 r">objectType</span>, <span class="r86 r">methodInvoker</span>));
 
                        <span class="r82 r">gotResultEvent</span>.<span class="i">Wait</span>();
                        <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>);
 
                        <b>lock</b> (<span class="r81 r">resultsLock</span>)
                        {
                            <b>if</b> (<span class="r80 r">closureSafeExceptionThrownOnCmdletThread</span> == <b>null</b>) <span class="c">// stateChangedEventHandler didn&#39;t set the results?  = ok to clobber results?</span>
                            {
                                <span class="r80 r">closureSafeExceptionThrownOnCmdletThread</span> = <span class="r86 r">methodInvoker</span>.<a href="../common/psstreamobject.cs.html#92d6352734412e8f" class="i property">ExceptionThrownOnCmdletThread</a>;
                                <span class="r79 r">methodResult</span> = <span class="r86 r">methodInvoker</span>.<a href="../common/psstreamobject.cs.html#76d82cf8c83e8782" class="i property">MethodResult</a>;
                            }
                        }
                    }
                }
                <b>finally</b>
                {
                    <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#a099819afc059aeb" class="i">StateChanged</a> -= <span class="r83 r">stateChangedEventHandler</span>;
                }
            }
 
            <b>lock</b> (<span class="r81 r">resultsLock</span>)
            {
                <span class="r78 r">exceptionThrownOnCmdletThread</span> = <span class="r80 r">closureSafeExceptionThrownOnCmdletThread</span>;
                <b>return</b> <span class="r79 r">methodResult</span>;
            }
        }
 
        <b>internal virtual void</b> <a id="f208383be4fef0e1" href="../../../R/f208383be4fef0e1.html" target="n" data-glyph="74,1" class="i method">ForwardAvailableResultsToCmdlet</a>(<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r88 rd" class="r88 r">cmdlet</span>)
        {
            <b>foreach</b> (<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a> <span id="r89 rd" class="r89 r">obj</span> <b>in</b> <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#403be942120e2d89" class="i method">ReadAll</a>())
            {
                <span class="r89 r">obj</span>.<a href="../common/psstreamobject.cs.html#30251b327ff3554b" class="i method">WriteStreamObject</a>(<span class="r88 r">cmdlet</span>);
            }
        }
 
        <b>internal virtual void</b> <a id="522a6d51afb8814c" href="../../../R/522a6d51afb8814c.html" target="n" data-glyph="74,1" class="i method">ForwardAllResultsToCmdlet</a>(<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r90 rd" class="r90 r">cmdlet</span>)
        {
            <b>foreach</b> (<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a> <span id="r91 rd" class="r91 r">obj</span> <b>in</b> <a href="#e1ff43f6998863de" class="k">this</a>.<a href="#2f6fd0f4814916f6" class="i property">Results</a>)
            {
                <span class="r91 r">obj</span>.<a href="../common/psstreamobject.cs.html#30251b327ff3554b" class="i method">WriteStreamObject</a>(<span class="r90 r">cmdlet</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is introduce for delaying the loading of streams</span>
        <span class="c">///</span><span class="c"> for a particular job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="3ce98aa0f0f76eca" href="../../../R/3ce98aa0f0f76eca.html" target="n" data-glyph="75,1" class="i method">DoLoadJobStreams</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unloads job streams information. Enables jobs to</span>
        <span class="c">///</span><span class="c"> clear stream information from memory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="4041b3a309afb6fb" href="../../../R/4041b3a309afb6fb.html" target="n" data-glyph="75,1" class="i method">DoUnloadJobStreams</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Load the required job streams.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f70dfdf490c1a9dc" href="../../../R/f70dfdf490c1a9dc.html" target="n" data-glyph="72,1" class="i method">LoadJobStreams</a>()
        {
            <b>if</b> (<a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a>) <b>return</b>;
 
            <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
            {
                <b>if</b> (<a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a>) <b>return</b>;
 
                <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>true</b>;
            }
 
            <b>try</b>
            {
                <a href="#3ce98aa0f0f76eca" class="i method">DoLoadJobStreams</a>();
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r92 rd" class="r92 r">e</span>)
            {
                <span class="c">// third party call-out for platform API</span>
                <span class="c">// Therefore it is fine to eat the exception</span>
                <span class="c">// here</span>
                <b>using</b> (<a href="../../../utils/PowerShellETWTracer.cs.html#3fd13a01d0177ce2" class="t t">PowerShellTraceSource</a> <span id="r93 rd" class="r93 r">tracer</span> = <a href="../../../utils/PowerShellETWTracer.cs.html#37e484a307a595c3" class="t t">PowerShellTraceSourceFactory</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#c94a9fbfef99a75d" class="i method">GetTraceSource</a>())
                {
                    <span class="r93 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r92 r">e</span>);
                }
            }
        }
 
        <b>private bool</b> <a id="87510ee356293669" href="../../../R/87510ee356293669.html" target="n" data-glyph="46,1" class="i field">_jobStreamsLoaded</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unload the required job streams.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="177fc7faf7c227ab" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">UnloadJobStreams</a>()
        {
            <b>if</b> (!<a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a>) <b>return</b>;
 
            <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
            {
                <b>if</b> (!<a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a>) <b>return</b>;
                <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>false</b>;
            }
 
            <b>try</b>
            {
                <a href="#4041b3a309afb6fb" class="i method">DoUnloadJobStreams</a>();
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r94 rd" class="r94 r">e</span>)
            {
                <span class="c">// third party call-out for platform API</span>
                <span class="c">// Therefore it is fine to eat the exception</span>
                <span class="c">// here</span>
                <b>using</b> (<a href="../../../utils/PowerShellETWTracer.cs.html#3fd13a01d0177ce2" class="t t">PowerShellTraceSource</a> <span id="r95 rd" class="r95 r">tracer</span> = <a href="../../../utils/PowerShellETWTracer.cs.html#37e484a307a595c3" class="t t">PowerShellTraceSourceFactory</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#c94a9fbfef99a75d" class="i method">GetTraceSource</a>())
                {
                    <span class="r95 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r94 r">e</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the output buffer. Output of job is written</span>
        <span class="c">///</span><span class="c"> into this buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot set to a null value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="9f3b4cf91a5477ce" href="../../../R/9f3b4cf91a5477ce.html" target="n" data-glyph="102,1" class="i property">Output</a>
        {
            <b>get</b>
            {
                <a href="#f70dfdf490c1a9dc" class="i method">LoadJobStreams</a>(); <span class="c">// for delayed loading</span>
                <b>return</b> <a href="#278d4c5d7c1a63cb" class="i field">_output</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Output&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#fc031da5f4882455" class="i field">_outputOwner</a> = <b>false</b>;
                    <a href="#278d4c5d7c1a63cb" class="i field">_output</a> = <b>value</b>;
                    <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>true</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the error buffer. Errors of job are written</span>
        <span class="c">///</span><span class="c"> into this buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot set to a null value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="322c09d9eb167da1" href="../../../R/322c09d9eb167da1.html" target="n" data-glyph="102,1" class="i property">Error</a>
        {
            <b>get</b>
            {
                <a href="#f70dfdf490c1a9dc" class="i method">LoadJobStreams</a>(); <span class="c">// for delayed loading</span>
                <b>return</b> <a href="#c028986e2a9d6fb7" class="i field">_error</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Error&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#50b45664ed9d2caa" class="i field">_errorOwner</a> = <b>false</b>;
                    <a href="#c028986e2a9d6fb7" class="i field">_error</a> = <b>value</b>;
                    <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>true</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the progress buffer. Progress of job is written</span>
        <span class="c">///</span><span class="c"> into this buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot set to a null value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>&gt; <a id="0566bc7c986755b8" href="../../../R/0566bc7c986755b8.html" target="n" data-glyph="102,1" class="i property">Progress</a>
        {
            <b>get</b>
            {
                <a href="#f70dfdf490c1a9dc" class="i method">LoadJobStreams</a>(); <span class="c">// for delayed loading</span>
                <b>return</b> <a href="#3e4ca26742c9d2f4" class="i field">_progress</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Progress&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#c9f3aee739f3a0ff" class="i field">_progressOwner</a> = <b>false</b>;
                    <a href="#3e4ca26742c9d2f4" class="i field">_progress</a> = <b>value</b>;
                    <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>true</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the verbose buffer. Verbose output of job is written to</span>
        <span class="c">///</span><span class="c"> this stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a>&gt; <a id="2c4a777567a6240d" href="../../../R/2c4a777567a6240d.html" target="n" data-glyph="102,1" class="i property">Verbose</a>
        {
            <b>get</b>
            {
                <a href="#f70dfdf490c1a9dc" class="i method">LoadJobStreams</a>(); <span class="c">// for delayed loading</span>
                <b>return</b> <a href="#da9d6f63622a3ca7" class="i field">_verbose</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Verbose&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#aea402feba6f5458" class="i field">_verboseOwner</a> = <b>false</b>;
                    <a href="#da9d6f63622a3ca7" class="i field">_verbose</a> = <b>value</b>;
                    <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>true</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the debug buffer. Debug output of Job is written</span>
        <span class="c">///</span><span class="c"> to this buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot set to a null value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a>&gt; <a id="fcf5aa47c1f50562" href="../../../R/fcf5aa47c1f50562.html" target="n" data-glyph="102,1" class="i property">Debug</a>
        {
            <b>get</b>
            {
                <a href="#f70dfdf490c1a9dc" class="i method">LoadJobStreams</a>(); <span class="c">// for delayed loading</span>
                <b>return</b> <a href="#e988cdf58b9ab5da" class="i field">_debug</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Debug&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#e0153fdea5b7fdf2" class="i field">_debugOwner</a> = <b>false</b>;
                    <a href="#e988cdf58b9ab5da" class="i field">_debug</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the warning buffer. Warnings of job are written to</span>
        <span class="c">///</span><span class="c"> this buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot set to a null value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt; <a id="2271b8dbce732fb7" href="../../../R/2271b8dbce732fb7.html" target="n" data-glyph="102,1" class="i property">Warning</a>
        {
            <b>get</b>
            {
                <a href="#f70dfdf490c1a9dc" class="i method">LoadJobStreams</a>(); <span class="c">// for delayed loading</span>
                <b>return</b> <a href="#6c773089098c55ae" class="i field">_warning</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Warning&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#69d1d59474501818" class="i field">_warningOwner</a> = <b>false</b>;
                    <a href="#6c773089098c55ae" class="i field">_warning</a> = <b>value</b>;
                    <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>true</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the information buffer. Information records of job are written to</span>
        <span class="c">///</span><span class="c"> this buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cannot set to a null value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>&gt; <a id="501ba88f677f8460" href="../../../R/501ba88f677f8460.html" target="n" data-glyph="102,1" class="i property">Information</a>
        {
            <b>get</b>
            {
                <a href="#f70dfdf490c1a9dc" class="i method">LoadJobStreams</a>(); <span class="c">// for delayed loading</span>
                <b>return</b> <a href="#e254cc8daa67676e" class="i field">_information</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;Information&quot;</span>);
                }
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#f6213ffafc3566f3" class="i method">AssertChangesAreAccepted</a>();
                    <a href="#480e4edead7694cd" class="i field">_informationOwner</a> = <b>false</b>;
                    <a href="#e254cc8daa67676e" class="i field">_information</a> = <b>value</b>;
                    <a href="#87510ee356293669" class="i field">_jobStreamsLoaded</a> = <b>true</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates a location where this job is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract string</b> <a id="537225f6e8ddf06c" href="../../../R/537225f6e8ddf06c.html" target="n" data-glyph="102,1" class="i property">Location</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> results
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Connect/Disconnect
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns boolean indicating whether the underlying</span>
        <span class="c">///</span><span class="c"> transport for the job (or child jobs) supports</span>
        <span class="c">///</span><span class="c"> connect/disconnect semantics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="ec3e93fac14c410e" href="../../../R/ec3e93fac14c410e.html" target="n" data-glyph="104,1" class="i property">CanDisconnect</a>
        {
            <b>get</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns runspaces associated with the Job, including</span>
        <span class="c">///</span><span class="c"> child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">IEnumerable of RemoteRunspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <span class="i">IEnumerable</span>&lt;<a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>&gt; <a id="b918365500b66fe3" href="../../../R/b918365500b66fe3.html" target="n" data-glyph="74,1" class="i method">GetRunspaces</a>()
        {
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Job Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Job State and State Change Event
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when state of the job changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1051:DoNotDeclareVisibleInstanceFields&quot;</span>)]
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#efe480d4e86a46d4" class="t t">JobStateEventArgs</a>&gt; <a id="a099819afc059aeb" href="../../../R/a099819afc059aeb.html" target="n" data-glyph="30,1" class="i">StateChanged</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets Job State.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> New State of Job</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="2bd9d7abde5f33f7" href="../../../R/2bd9d7abde5f33f7.html" target="n" data-glyph="75,1" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r96 rd" class="r96 r">state</span>)
        {
            <a href="#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<span class="r96 r">state</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets Job State.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> New State of Job</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reason associated with the state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c3fb91c6ec548ed8" href="../../../R/c3fb91c6ec548ed8.html" target="n" data-glyph="74,1" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r97 rd" class="r97 r">state</span>, <span class="i">Exception</span> <span id="r98 rd" class="r98 r">reason</span>)
        {
            <b>using</b> (<a href="../../../utils/PowerShellETWTracer.cs.html#3fd13a01d0177ce2" class="t t">PowerShellTraceSource</a> <span id="r99 rd" class="r99 r">tracer</span> = <a href="../../../utils/PowerShellETWTracer.cs.html#37e484a307a595c3" class="t t">PowerShellTraceSourceFactory</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#c94a9fbfef99a75d" class="i method">GetTraceSource</a>())
            {
                <a href="#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
 
                <b>bool</b> <span id="r100 rd" class="r100 r">alldone</span> = <b>false</b>;
                <a href="#8f788812e1264af5" class="t t">JobStateInfo</a> <span id="r101 rd" class="r101 r">previousState</span> = <a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>;
 
                <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                {
                    <a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a> = <b>new</b> <a href="#c9b5221f53e16cd6" class="t constructor">JobStateInfo</a>(<span class="r97 r">state</span>, <span class="r98 r">reason</span>);
 
                    <b>if</b> (<span class="r97 r">state</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>)
                    {
                        <span class="c">// BeginTime is set only once.</span>
                        <b>if</b> (<a href="#7ed5cb1dfd270632" class="i property">PSBeginTime</a> == <b>null</b>)
                        {
                            <a href="#7ed5cb1dfd270632" class="i property">PSBeginTime</a> = <span class="i">DateTime</span>.<span class="i">Now</span>;
                        }
                    }
                    <b>else</b> <b>if</b> (<a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<span class="r97 r">state</span>))
                    {
                        <span class="r100 r">alldone</span> = <b>true</b>;
 
                        <span class="c">// EndTime is set only once.</span>
                        <b>if</b> (<a href="#b4585c98af5cbea6" class="i property">PSEndTime</a> == <b>null</b>)
                        {
                            <a href="#b4585c98af5cbea6" class="i property">PSEndTime</a> = <span class="i">DateTime</span>.<span class="i">Now</span>;
                        }
                    }
                }
 
                <b>if</b> (<span class="r100 r">alldone</span>)
                {
                    <a href="#dca29ffce44d207a" class="i method">CloseAllStreams</a>();
 
                    <b>if</b> (<a href="#823edc09e0ad7060" class="i field">_processingOutput</a>)
                    {
                        <b>try</b>
                        {
                            <span class="c">// Still marked as processing output.  Send final state changed.</span>
                            <a href="#014345012974f316" class="i method">HandleOutputProcessingStateChanged</a>(<a href="#e1ff43f6998863de" class="k">this</a>, <b>new</b> <a href="#74417b7db0a01033" class="t constructor">OutputProcessingStateEventArgs</a>(<b>false</b>));
                        }
                        <b>catch</b> (<span class="i">Exception</span>)
                        {
                        }
                    }
                }
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
                <span class="c">// Exception raised in the eventhandler are not error in job.</span>
                <span class="c">// silently ignore them.</span>
                <b>try</b>
                {
                    <span class="r99 r">tracer</span>.<span class="i">WriteMessage</span>(<span class="s">&quot;Job&quot;</span>, <span class="s">&quot;SetJobState&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#e1ff43f6998863de" class="k">this</a>, <span class="s">&quot;Invoking StateChanged event&quot;</span>, <b>null</b>);
                    <a href="#a099819afc059aeb" class="i">StateChanged</a>.<span class="i">SafeInvoke</span>(<a href="#e1ff43f6998863de" class="k">this</a>, <b>new</b> <a href="#18e6fc44c599c11a" class="t constructor">JobStateEventArgs</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#82ea86316c10a9fd" class="i method">Clone</a>(), <span class="r101 r">previousState</span>));
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r102 rd" class="r102 r">exception</span>) <span class="c">// ignore non-severe exceptions</span>
                {
                    <span class="r99 r">tracer</span>.<span class="i">WriteMessage</span>(<span class="s">&quot;Job&quot;</span>, <span class="s">&quot;SetJobState&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#e1ff43f6998863de" class="k">this</a>,
                                        <span class="s">&quot;Some Job StateChange event handler threw an unhandled exception.&quot;</span>, <b>null</b>);
                    <span class="r99 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r102 r">exception</span>);
                }
 
                <span class="c">// finished needs to be set after StateChanged event</span>
                <span class="c">// has been raised</span>
                <b>if</b> (<span class="r100 r">alldone</span>)
                {
                    <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                    {
                        <b>if</b> (<a href="#d0937726bf5ffe8a" class="i field">_finished</a> != <b>null</b>)
                        {
                            <a href="#d0937726bf5ffe8a" class="i field">_finished</a>.<span class="i">Set</span>();
                        }
                    }
                }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Job State and State Change Event
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Job Public Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop this job object. If job contains child job, this should</span>
        <span class="c">///</span><span class="c"> stop child job objects also.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="5e60404c217f5d42" href="../../../R/5e60404c217f5d42.html" target="n" data-glyph="72,1" class="i method">StopJob</a>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Job Public Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private/Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the items in results collection</span>
        <span class="c">///</span><span class="c"> after clearing up all the internal</span>
        <span class="c">///</span><span class="c"> structures.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Collection of stream objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a>&gt; <a id="8c95de2662ddb0c9" href="../../../R/8c95de2662ddb0c9.html" target="n" data-glyph="74,1" class="i method">ReadAll</a>()
        {
            <a href="#9f3b4cf91a5477ce" class="i property">Output</a>.<a href="../../hostifaces/PSDataCollection.cs.html#8358de7f8ecc84ec" class="i method">Clear</a>();
            <a href="#322c09d9eb167da1" class="i property">Error</a>.<a href="../../hostifaces/PSDataCollection.cs.html#8358de7f8ecc84ec" class="i method">Clear</a>();
            <a href="#fcf5aa47c1f50562" class="i property">Debug</a>.<a href="../../hostifaces/PSDataCollection.cs.html#8358de7f8ecc84ec" class="i method">Clear</a>();
            <a href="#2271b8dbce732fb7" class="i property">Warning</a>.<a href="../../hostifaces/PSDataCollection.cs.html#8358de7f8ecc84ec" class="i method">Clear</a>();
            <a href="#2c4a777567a6240d" class="i property">Verbose</a>.<a href="../../hostifaces/PSDataCollection.cs.html#8358de7f8ecc84ec" class="i method">Clear</a>();
            <a href="#0566bc7c986755b8" class="i property">Progress</a>.<a href="../../hostifaces/PSDataCollection.cs.html#8358de7f8ecc84ec" class="i method">Clear</a>();
 
            <b>return</b> <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#403be942120e2d89" class="i method">ReadAll</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper function to check if job is finished.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="d7179d2607549d3b" href="../../../R/d7179d2607549d3b.html" target="n" data-glyph="74,1" class="i method">IsFinishedState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r103 rd" class="r103 r">state</span>)
        {
            <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
            {
                <b>return</b> (<span class="r103 r">state</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#db36b340edc064ae" class="i field">Completed</a> || <span class="r103 r">state</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#4d2acd22ba4f0da9" class="i field">Failed</a> || <span class="r103 r">state</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#223c91574b18631a" class="i field">Stopped</a>);
            }
        }
 
        <b>internal bool</b> <a id="431bfb528e72aa9f" href="../../../R/431bfb528e72aa9f.html" target="n" data-glyph="74,1" class="i method">IsPersistentState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r104 rd" class="r104 r">state</span>)
        {
            <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
            {
                <b>return</b> (<a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<span class="r104 r">state</span>) || <span class="r104 r">state</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a> || <span class="r104 r">state</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#2da89c5a929a8381" class="i field">Suspended</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if the current instance can accept changes like</span>
        <span class="c">///</span><span class="c"> changing one of the properties like Output, Error etc.</span>
        <span class="c">///</span><span class="c"> If changes are not allowed, throws an exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell instance cannot be changed in its</span>
        <span class="c">///</span><span class="c"> current state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f6213ffafc3566f3" href="../../../R/f6213ffafc3566f3.html" target="n" data-glyph="76,1" class="i method">AssertChangesAreAccepted</a>()
        {
            <a href="#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
            {
                <b>if</b> (<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>)
                {
                    <b>throw</b> <b>new</b> <a href="#8e23b35147b74756" class="t constructor">InvalidJobStateException</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Automatically generate a job name if the user</span>
        <span class="c">///</span><span class="c"> does not supply one.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Auto generated job name.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Since the user can script/program against the</span>
        <span class="c">///</span><span class="c"> job name, the auto generated name will not be</span>
        <span class="c">///</span><span class="c"> localizable</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected string</b> <a id="ae15ab43277234b5" href="../../../R/ae15ab43277234b5.html" target="n" data-glyph="75,1" class="i method">AutoGenerateJobName</a>()
        {
            <b>return</b> <span class="s">&quot;Job&quot;</span> + <a href="#aa91c39ac1b0bcec" class="i property">Id</a>.<span class="i">ToString</span>(<span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if the current powershell instance is disposed.</span>
        <span class="c">///</span><span class="c"> If disposed, throws ObjectDisposedException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="0328c940aee2761d" href="../../../R/0328c940aee2761d.html" target="n" data-glyph="74,1" class="i method">AssertNotDisposed</a>()
        {
            <b>if</b> (<a href="#805ebf238ad1e839" class="i field">_isDisposed</a>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#02739f4db42486af" class="i method">NewObjectDisposedException</a>(<span class="s">&quot;PSJob&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A helper method to close all the streams.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="dca29ffce44d207a" href="../../../R/dca29ffce44d207a.html" target="n" data-glyph="74,1" class="i method">CloseAllStreams</a>()
        {
            <span class="c">// The Complete() method includes raising public notification events that third parties can</span>
            <span class="c">// handle and potentially throw exceptions on the notification thread.  We don&#39;t want to</span>
            <span class="c">// propagate those exceptions because it prevents this thread from completing its processing.</span>
            <b>if</b> (<a href="#c9e25ca75d26e0c6" class="i field">_resultsOwner</a>) { <b>try</b> { <a href="#10870d263c69d67d" class="i field">_results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r105 rd" class="r105 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r105 r">e</span>); } }
 
            <b>if</b> (<a href="#fc031da5f4882455" class="i field">_outputOwner</a>) { <b>try</b> { <a href="#278d4c5d7c1a63cb" class="i field">_output</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r106 rd" class="r106 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r106 r">e</span>); } }
 
            <b>if</b> (<a href="#50b45664ed9d2caa" class="i field">_errorOwner</a>) { <b>try</b> { <a href="#c028986e2a9d6fb7" class="i field">_error</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r107 rd" class="r107 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r107 r">e</span>); } }
 
            <b>if</b> (<a href="#c9f3aee739f3a0ff" class="i field">_progressOwner</a>) { <b>try</b> { <a href="#3e4ca26742c9d2f4" class="i field">_progress</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r108 rd" class="r108 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r108 r">e</span>); } }
 
            <b>if</b> (<a href="#aea402feba6f5458" class="i field">_verboseOwner</a>) { <b>try</b> { <a href="#da9d6f63622a3ca7" class="i field">_verbose</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r109 rd" class="r109 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r109 r">e</span>); } }
 
            <b>if</b> (<a href="#69d1d59474501818" class="i field">_warningOwner</a>) { <b>try</b> { <a href="#6c773089098c55ae" class="i field">_warning</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r110 rd" class="r110 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r110 r">e</span>); } }
 
            <b>if</b> (<a href="#e0153fdea5b7fdf2" class="i field">_debugOwner</a>) { <b>try</b> { <a href="#e988cdf58b9ab5da" class="i field">_debug</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r111 rd" class="r111 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r111 r">e</span>); } }
 
            <b>if</b> (<a href="#480e4edead7694cd" class="i field">_informationOwner</a>) { <b>try</b> { <a href="#e254cc8daa67676e" class="i field">_information</a>.<a href="../../hostifaces/PSDataCollection.cs.html#0a8262d798e33fc6" class="i method">Complete</a>(); } <b>catch</b> (<span class="i">Exception</span> <span id="r112 rd" class="r112 r">e</span>) { <a href="#e59e32893e84b2b7" class="i method">TraceException</a>(<span class="r112 r">e</span>); } }
        }
 
        <b>private static void</b> <a id="e59e32893e84b2b7" href="../../../R/e59e32893e84b2b7.html" target="n" data-glyph="76,1" class="i method">TraceException</a>(<span class="i">Exception</span> <span id="r113 rd" class="r113 r">e</span>)
        {
            <b>using</b> (<a href="../../../utils/PowerShellETWTracer.cs.html#3fd13a01d0177ce2" class="t t">PowerShellTraceSource</a> <span id="r114 rd" class="r114 r">tracer</span> = <a href="../../../utils/PowerShellETWTracer.cs.html#37e484a307a595c3" class="t t">PowerShellTraceSourceFactory</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#c94a9fbfef99a75d" class="i method">GetTraceSource</a>())
            {
                <span class="r114 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r113 r">e</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the job for the specified location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">location</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Location to filter on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Collection of jobs.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <a id="6e1d44c476877cbf" href="../../../R/6e1d44c476877cbf.html" target="n" data-glyph="74,1" class="i method">GetJobsForLocation</a>(<b>string</b> <span id="r115 rd" class="r115 r">location</span>)
        {
            <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <span id="r116 rd" class="r116 r">returnJobList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt;();
 
            <b>foreach</b> (<a href="#e1ff43f6998863de" class="t t">Job</a> <span id="r117 rd" class="r117 r">job</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r117 r">job</span>.<a href="#537225f6e8ddf06c" class="i property">Location</a>, <span class="r115 r">location</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r116 r">returnJobList</span>.<span class="i">Add</span>(<span class="r117 r">job</span>);
                }
            }
 
            <b>return</b> <span class="r116 r">returnJobList</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private/Internal Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose all managed resources. This will suppress finalizer on the object from getting called by</span>
        <span class="c">///</span><span class="c"> calling System.GC.SuppressFinalize(this).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a1b7a0cd2d734ade" href="../../../R/a1b7a0cd2d734ade.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#19b362abde0789e5" class="i method">Dispose</a>(<b>true</b>);
            <span class="c">// To prevent derived types with finalizers from having to re-implement System.IDisposable to call it,</span>
            <span class="c">// unsealed types without finalizers should still call SuppressFinalize.</span>
            <span class="i n">System</span>.<span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#e1ff43f6998863de" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Release all the resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if true, release all the managed objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="19b362abde0789e5" href="../../../R/19b362abde0789e5.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r118 rd" class="r118 r">disposing</span>)
        {
            <b>if</b> (<span class="r118 r">disposing</span>)
            {
                <b>if</b> (!<a href="#805ebf238ad1e839" class="i field">_isDisposed</a>)
                {
                    <a href="#dca29ffce44d207a" class="i method">CloseAllStreams</a>();
 
                    <span class="c">// release the WaitHandle</span>
                    <b>lock</b> (<a href="#d933c0709e639dd1" class="i field">syncObject</a>)
                    {
                        <b>if</b> (<a href="#d0937726bf5ffe8a" class="i field">_finished</a> != <b>null</b>)
                        {
                            <a href="#d0937726bf5ffe8a" class="i field">_finished</a>.<span class="i">Dispose</span>();
                            <a href="#d0937726bf5ffe8a" class="i field">_finished</a> = <b>null</b>;
                        }
                    }
 
                    <span class="c">// Only dispose the collections if we&#39;ve created them...</span>
                    <b>if</b> (<a href="#c9e25ca75d26e0c6" class="i field">_resultsOwner</a>) <a href="#10870d263c69d67d" class="i field">_results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                    <b>if</b> (<a href="#fc031da5f4882455" class="i field">_outputOwner</a>) <a href="#278d4c5d7c1a63cb" class="i field">_output</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                    <b>if</b> (<a href="#50b45664ed9d2caa" class="i field">_errorOwner</a>) <a href="#c028986e2a9d6fb7" class="i field">_error</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                    <b>if</b> (<a href="#e0153fdea5b7fdf2" class="i field">_debugOwner</a>) <a href="#e988cdf58b9ab5da" class="i field">_debug</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                    <b>if</b> (<a href="#480e4edead7694cd" class="i field">_informationOwner</a>) <a href="#e254cc8daa67676e" class="i field">_information</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                    <b>if</b> (<a href="#aea402feba6f5458" class="i field">_verboseOwner</a>) <a href="#da9d6f63622a3ca7" class="i field">_verbose</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                    <b>if</b> (<a href="#69d1d59474501818" class="i field">_warningOwner</a>) <a href="#6c773089098c55ae" class="i field">_warning</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                    <b>if</b> (<a href="#c9f3aee739f3a0ff" class="i field">_progressOwner</a>) <a href="#3e4ca26742c9d2f4" class="i field">_progress</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
 
                    <a href="#805ebf238ad1e839" class="i field">_isDisposed</a> = <b>true</b>;
                }
            }
        }
 
        <b>private bool</b> <a id="805ebf238ad1e839" href="../../../R/805ebf238ad1e839.html" target="n" data-glyph="46,1" class="i field">_isDisposed</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> MonitorOutputProcessing
 
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<a href="#7e5214a3bc47f956" class="t t">OutputProcessingStateEventArgs</a>&gt; <a id="63d86448ba938f17" href="../../../R/63d86448ba938f17.html" target="n" data-glyph="32,1" class="i">OutputProcessingStateChanged</a>;
 
        <b>private bool</b> <a id="823edc09e0ad7060" href="../../../R/823edc09e0ad7060.html" target="n" data-glyph="46,1" class="i field">_processingOutput</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> MonitorOutputProcessing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="72d48c1ba69954a8" href="../../../R/72d48c1ba69954a8.html" target="n" data-glyph="104,1" class="i property">MonitorOutputProcessing</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <b>internal void</b> <a id="b41adcf1d4aff556" href="../../../R/b41adcf1d4aff556.html" target="n" data-glyph="74,1" class="i method">SetMonitorOutputProcessing</a>(<a href="#ee25bd0d06df876c" class="t t">IOutputProcessingState</a> <span id="r119 rd" class="r119 r">outputProcessingState</span>)
        {
            <b>if</b> (<span class="r119 r">outputProcessingState</span> != <b>null</b>)
            {
                <span class="r119 r">outputProcessingState</span>.<a href="#61b35f1d6bd1a26c" class="i">OutputProcessingStateChanged</a> += <span class="i">HandleOutputProcessingStateChanged</span>;
            }
        }
 
        <b>internal void</b> <a id="87a43c0cc2ce114a" href="../../../R/87a43c0cc2ce114a.html" target="n" data-glyph="74,1" class="i method">RemoveMonitorOutputProcessing</a>(<a href="#ee25bd0d06df876c" class="t t">IOutputProcessingState</a> <span id="r120 rd" class="r120 r">outputProcessingState</span>)
        {
            <b>if</b> (<span class="r120 r">outputProcessingState</span> != <b>null</b>)
            {
                <span class="r120 r">outputProcessingState</span>.<a href="#61b35f1d6bd1a26c" class="i">OutputProcessingStateChanged</a> -= <span class="i">HandleOutputProcessingStateChanged</span>;
            }
        }
 
        <b>private void</b> <a id="014345012974f316" href="../../../R/014345012974f316.html" target="n" data-glyph="76,1" class="i method">HandleOutputProcessingStateChanged</a>(<b>object</b> <span id="r121 rd" class="r121 r">sender</span>, <a href="#7e5214a3bc47f956" class="t t">OutputProcessingStateEventArgs</a> <span id="r122 rd" class="r122 r">e</span>)
        {
            <a href="#823edc09e0ad7060" class="i field">_processingOutput</a> = <span class="r122 r">e</span>.<a href="#814114db50065da3" class="i property">ProcessingOutput</a>;
            <a href="#63d86448ba938f17" class="i">OutputProcessingStateChanged</a>.<span class="i">SafeInvoke</span>&lt;<a href="#7e5214a3bc47f956" class="t t">OutputProcessingStateEventArgs</a>&gt;(<a href="#e1ff43f6998863de" class="k">this</a>, <span class="r122 r">e</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Top level job object for remoting. This contains multiple child job</span>
    <span class="c">///</span><span class="c"> objects. Each child job object invokes command on one remote machine.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Not removing the prefix &quot;PS&quot; as this signifies powershell specific remoting job</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="3e3a8a0a8fbfcb51" href="../../../R/3e3a8a0a8fbfcb51.html" target="n" data-glyph="2,0" class="t t">PSRemotingJob</a> : <a href="#e1ff43f6998863de" class="t t">Job</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal constructor for initializing PSRemotingJob using</span>
        <span class="c">///</span><span class="c"> computer names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">computerNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">names of computers for</span>
        <span class="c">///</span><span class="c"> which the job object is being created</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">computerNameHelpers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">list of helper objects</span>
        <span class="c">///</span><span class="c"> corresponding to the computer names</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r125 r">remoteCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">remote command corresponding to this</span>
        <span class="c">///</span><span class="c"> job object</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> a friendly name for the job object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1811:AvoidUncalledPrivateCode&quot;</span>)]
        <b>internal</b> <a id="2b7e659d7be2999b" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">PSRemotingJob</a>(<b>string</b>[] <span id="r123 rd" class="r123 r">computerNames</span>,
                        <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r124 rd" class="r124 r">computerNameHelpers</span>, <b>string</b> <span id="r125 rd" class="r125 r">remoteCommand</span>, <b>string</b> <span id="r126 rd" class="r126 r">name</span>)
            : <a href="#643b86a66b9973de" class="k">this</a>(<span class="r123 r">computerNames</span>, <span class="r124 r">computerNameHelpers</span>, <span class="r125 r">remoteCommand</span>, 0, <span class="r126 r">name</span>)
        { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal constructor for initializing job using</span>
        <span class="c">///</span><span class="c"> PSSession objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">remoteRunspaceInfos</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">array of runspace info</span>
        <span class="c">///</span><span class="c"> objects on which the remote command is executed</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">runspaceHelpers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of helper objects for the</span>
        <span class="c">///</span><span class="c"> runspaces</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">remoteCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> remote command corresponding to this</span>
        <span class="c">///</span><span class="c"> job object</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">a friendly name for the job object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="2ece50e312693471" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">PSRemotingJob</a>(<a href="remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>[] <span id="r127 rd" class="r127 r">remoteRunspaceInfos</span>,
                        <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r128 rd" class="r128 r">runspaceHelpers</span>, <b>string</b> <span id="r129 rd" class="r129 r">remoteCommand</span>, <b>string</b> <span id="r130 rd" class="r130 r">name</span>)
            : <a href="#a8c71adaf8534f95" class="k">this</a>(<span class="r127 r">remoteRunspaceInfos</span>, <span class="r128 r">runspaceHelpers</span>, <span class="r129 r">remoteCommand</span>, 0, <span class="r130 r">name</span>)
        { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal constructor for initializing PSRemotingJob using</span>
        <span class="c">///</span><span class="c"> computer names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">computerNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">names of computers for</span>
        <span class="c">///</span><span class="c"> which the result object is being created</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r132 r">computerNameHelpers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">list of helper objects</span>
        <span class="c">///</span><span class="c"> corresponding to the computer names</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">remoteCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">remote command corresponding to this</span>
        <span class="c">///</span><span class="c"> result object</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">throttleLimit</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Throttle limit to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="643b86a66b9973de" href="../../../R/643b86a66b9973de.html" target="n" data-glyph="74,1" class="t constructor">PSRemotingJob</a>(<b>string</b>[] <span id="r131 rd" class="r131 r">computerNames</span>,
                        <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r132 rd" class="r132 r">computerNameHelpers</span>, <b>string</b> <span id="r133 rd" class="r133 r">remoteCommand</span>,
                            <b>int</b> <span id="r134 rd" class="r134 r">throttleLimit</span>, <b>string</b> <span id="r135 rd" class="r135 r">name</span>)
            : <a href="#8083742b97acc268" class="k">base</a>(<span class="r133 r">remoteCommand</span>, <span class="r135 r">name</span>)
        {
            <span class="c">// Create child jobs for each object in the list</span>
            <b>foreach</b> (<a href="../commands/PSRemotingCmdlet.cs.html#5ff009e2ef1552ca" class="t t">ExecutionCmdletHelperComputerName</a> <span id="r136 rd" class="r136 r">helper</span> <b>in</b> <span class="r132 r">computerNameHelpers</span>)
            {
                <span class="c">// Create Child Job and Register for its StateChanged Event</span>
                <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r137 rd" class="r137 r">childJob</span> = <b>new</b> <a href="#0a3d2328481b6045" class="t constructor">PSRemotingChildJob</a>(<span class="r133 r">remoteCommand</span>,
                                            <span class="r136 r">helper</span>, <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>);
                <span class="r137 r">childJob</span>.<a href="#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleChildJobStateChanged</span>;
                <span class="r137 r">childJob</span>.<a href="#fc97382bec536f59" class="i">JobUnblocked</a> += <span class="i">HandleJobUnblocked</span>;
 
                <span class="c">// Add this job to list of childjobs</span>
                <a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Add</span>(<span class="r137 r">childJob</span>);
            }
 
            <a href="#b737f38b49c171ba" class="i method">CommonInit</a>(<span class="r134 r">throttleLimit</span>, <span class="r132 r">computerNameHelpers</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal constructor for initializing job using</span>
        <span class="c">///</span><span class="c"> PSSession objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">remoteRunspaceInfos</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">array of runspace info</span>
        <span class="c">///</span><span class="c"> objects on which the remote command is executed</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">runspaceHelpers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of helper objects for the</span>
        <span class="c">///</span><span class="c"> runspaces</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">remoteCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> remote command corresponding to this</span>
        <span class="c">///</span><span class="c"> result object</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">throttleLimit</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Throttle limit to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a8c71adaf8534f95" href="../../../R/a8c71adaf8534f95.html" target="n" data-glyph="74,1" class="t constructor">PSRemotingJob</a>(<a href="remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>[] <span id="r138 rd" class="r138 r">remoteRunspaceInfos</span>,
                        <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r139 rd" class="r139 r">runspaceHelpers</span>, <b>string</b> <span id="r140 rd" class="r140 r">remoteCommand</span>,
                        <b>int</b> <span id="r141 rd" class="r141 r">throttleLimit</span>, <b>string</b> <span id="r142 rd" class="r142 r">name</span>)
            : <a href="#8083742b97acc268" class="k">base</a>(<span class="r140 r">remoteCommand</span>, <span class="r142 r">name</span>)
        {
            <span class="c">// Create child jobs for each object in the list</span>
            <b>for</b> (<b>int</b> <span id="r143 rd" class="r143 r">i</span> = 0; <span class="r143 r">i</span> &lt; <span class="r138 r">remoteRunspaceInfos</span>.<span class="i">Length</span>; <span class="r143 r">i</span>++)
            {
                <a href="../commands/PSRemotingCmdlet.cs.html#921dba60b3314c0b" class="t t">ExecutionCmdletHelperRunspace</a> <span id="r144 rd" class="r144 r">helper</span> = (<a href="../commands/PSRemotingCmdlet.cs.html#921dba60b3314c0b" class="t t">ExecutionCmdletHelperRunspace</a>)<span class="r139 r">runspaceHelpers</span>[<span class="r143 r">i</span>];
 
                <span class="c">// Create Child Job object and Register for its state changed event</span>
                <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r145 rd" class="r145 r">job</span> = <b>new</b> <a href="#0a3d2328481b6045" class="t constructor">PSRemotingChildJob</a>(<span class="r140 r">remoteCommand</span>,
                                <span class="r144 r">helper</span>, <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>);
                <span class="r145 r">job</span>.<a href="#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleChildJobStateChanged</span>;
                <span class="r145 r">job</span>.<a href="#fc97382bec536f59" class="i">JobUnblocked</a> += <span class="i">HandleJobUnblocked</span>;
 
                <span class="c">// Add the child job to list of child jobs</span>
                <a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Add</span>(<span class="r145 r">job</span>);
            }
 
            <a href="#b737f38b49c171ba" class="i method">CommonInit</a>(<span class="r141 r">throttleLimit</span>, <span class="r139 r">runspaceHelpers</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a job object and child jobs for each disconnected pipeline/runspace</span>
        <span class="c">///</span><span class="c"> provided in the list of ExecutionCmdletHelperRunspace items.  The runspace</span>
        <span class="c">///</span><span class="c"> object must have a remote running command that can be connected to.</span>
        <span class="c">///</span><span class="c"> Use Connect() method to transition to the connected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">helpers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of DisconnectedJobOperation objects with disconnected pipelines.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r147 r">throttleLimit</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Throttle limit value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r148 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Job name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r149 r">aggregateResults</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Aggregate results.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="9afee2391a53da8e" href="../../../R/9afee2391a53da8e.html" target="n" data-glyph="74,1" class="t constructor">PSRemotingJob</a>(<span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r146 rd" class="r146 r">helpers</span>,
                               <b>int</b> <span id="r147 rd" class="r147 r">throttleLimit</span>, <b>string</b> <span id="r148 rd" class="r148 r">name</span>, <b>bool</b> <span id="r149 rd" class="r149 r">aggregateResults</span>)
            : <b>base</b>(<b>string</b>.<span class="i">Empty</span>, <span class="r148 r">name</span>)
        {
            <span class="c">// All pipeline objects must be in &quot;disconnected&quot; state and associated to running</span>
            <span class="c">// remote commands.  Once the jobs are connected they can be stopped using the</span>
            <span class="c">// ExecutionCmdletHelperRunspace object and ThrottleManager.</span>
            <b>foreach</b> (<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r150 rd" class="r150 r">helper</span> <b>in</b> <span class="r146 r">helpers</span>)
            {
                <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r151 rd" class="r151 r">job</span> = <b>new</b> <a href="#4f6ee4f59c75275c" class="t constructor">PSRemotingChildJob</a>(<span class="r150 r">helper</span>, <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>, <span class="r149 r">aggregateResults</span>);
                <span class="r151 r">job</span>.<a href="#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleChildJobStateChanged</span>;
                <span class="r151 r">job</span>.<a href="#fc97382bec536f59" class="i">JobUnblocked</a> += <span class="i">HandleJobUnblocked</span>;
 
                <a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Add</span>(<span class="r151 r">job</span>);
            }
 
            <span class="c">// Since no results are produced by any streams. We should</span>
            <span class="c">// close all the streams.</span>
            <a href="#e1ff43f6998863de" class="k">base</a>.<a href="#dca29ffce44d207a" class="i method">CloseAllStreams</a>();
 
            <span class="c">// Set status to &quot;disconnected&quot;.</span>
            <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>);
 
            <span class="c">// Submit the disconnected operation helpers to the throttle manager</span>
            <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#c88c6759bac73d6d" class="i property">ThrottleLimit</a> = <span class="r147 r">throttleLimit</span>;
            <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#ee8f2ac038103ebc" class="i method">SubmitOperations</a>(<span class="r146 r">helpers</span>);
            <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#75a1eec170a5d6bc" class="i method">EndSubmitOperations</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="51d348545f204002" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">PSRemotingJob</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialization common to both constructors.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b737f38b49c171ba" href="../../../R/b737f38b49c171ba.html" target="n" data-glyph="76,1" class="i method">CommonInit</a>(<b>int</b> <span id="r152 rd" class="r152 r">throttleLimit</span>, <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r153 rd" class="r153 r">helpers</span>)
        {
            <span class="c">// Since no results are produced by any streams. We should</span>
            <span class="c">// close all the streams</span>
            <a href="#e1ff43f6998863de" class="k">base</a>.<a href="#dca29ffce44d207a" class="i method">CloseAllStreams</a>();
 
            <span class="c">// set status to &quot;in progress&quot;</span>
            <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>);
 
            <span class="c">// submit operations to the throttle manager</span>
            <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#c88c6759bac73d6d" class="i property">ThrottleLimit</a> = <span class="r152 r">throttleLimit</span>;
            <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#ee8f2ac038103ebc" class="i method">SubmitOperations</a>(<span class="r153 r">helpers</span>);
            <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#75a1eec170a5d6bc" class="i method">EndSubmitOperations</a>();
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get entity result for the specified computer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">computername for which entity</span>
        <span class="c">///</span><span class="c"> result is required</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Entity result.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <a id="4fa564a4d1ac28d0" href="../../../R/4fa564a4d1ac28d0.html" target="n" data-glyph="74,1" class="i method">GetJobsForComputer</a>(<b>string</b> <span id="r154 rd" class="r154 r">computerName</span>)
        {
            <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <span id="r155 rd" class="r155 r">returnJobList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt;();
 
            <b>foreach</b> (<a href="#e1ff43f6998863de" class="t t">Job</a> <span id="r156 rd" class="r156 r">j</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (!(<span class="r156 r">j</span> <b>is</b> <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r157 rd" class="r157 r">child</span>)) <b>continue</b>;
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r157 r">child</span>.<a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#7ff4c79fcb624bf1" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a>, <span class="r154 r">computerName</span>,
                                <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r155 r">returnJobList</span>.<span class="i">Add</span>(<span class="r157 r">child</span>);
                }
            }
 
            <b>return</b> <span class="r155 r">returnJobList</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get entity result for the specified runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r158 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">runspace for which entity</span>
        <span class="c">///</span><span class="c"> result is required</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Entity result.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <a id="204d80d20c5fcf33" href="../../../R/204d80d20c5fcf33.html" target="n" data-glyph="74,1" class="i method">GetJobsForRunspace</a>(<a href="remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r158 rd" class="r158 r">runspace</span>)
        {
            <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <span id="r159 rd" class="r159 r">returnJobList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt;();
 
            <b>foreach</b> (<a href="#e1ff43f6998863de" class="t t">Job</a> <span id="r160 rd" class="r160 r">j</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (!(<span class="r160 r">j</span> <b>is</b> <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r161 rd" class="r161 r">child</span>)) <b>continue</b>;
                <b>if</b> (<span class="r161 r">child</span>.<a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>.<span class="i">Equals</span>(<span class="r158 r">runspace</span>.<a href="remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>))
                {
                    <span class="r159 r">returnJobList</span>.<span class="i">Add</span>(<span class="r161 r">child</span>);
                }
            }
 
            <b>return</b> <span class="r159 r">returnJobList</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get entity result for the specified helper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r162 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">helper for which entity</span>
        <span class="c">///</span><span class="c"> result is required</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Entity result.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <a id="aa4cc1e872c34c48" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetJobsForOperation</a>(<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r162 rd" class="r162 r">operation</span>)
        {
            <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt; <span id="r163 rd" class="r163 r">returnJobList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#e1ff43f6998863de" class="t t">Job</a>&gt;();
            <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r164 rd" class="r164 r">helper</span> = <span class="r162 r">operation</span> <b>as</b> <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>;
 
            <b>foreach</b> (<a href="#e1ff43f6998863de" class="t t">Job</a> <span id="r165 rd" class="r165 r">j</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (!(<span class="r165 r">j</span> <b>is</b> <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r166 rd" class="r166 r">child</span>)) <b>continue</b>;
                <b>if</b> (<span class="r166 r">child</span>.<a href="#ded04bc1d30f6e94" class="i property">Helper</a>.<span class="i">Equals</span>(<span class="r164 r">helper</span>))
                {
                    <span class="r163 r">returnJobList</span>.<span class="i">Add</span>(<span class="r166 r">child</span>);
                }
            }
 
            <b>return</b> <span class="r163 r">returnJobList</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> internal methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Connection Support
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connect all child jobs if they are in a disconnected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b4b99d9012296349" href="../../../R/b4b99d9012296349.html" target="n" data-glyph="74,1" class="i method">ConnectJobs</a>()
        {
            <span class="c">// Create connect operation objects for each child job object to connect.</span>
            <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r167 rd" class="r167 r">connectJobOperations</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt;();
            <b>foreach</b> (<a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r168 rd" class="r168 r">childJob</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r168 r">childJob</span>.<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>)
                {
                    <span class="r167 r">connectJobOperations</span>.<span class="i">Add</span>(<b>new</b> <a href="#1ff9f0e06ae9aac5" class="t constructor">ConnectJobOperation</a>(<span class="r168 r">childJob</span>));
                }
            }
 
            <b>if</b> (<span class="r167 r">connectJobOperations</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b>;
            }
 
            <span class="c">// Submit the connect job operation.</span>
            <span class="c">// Return only after the connect operation completes.</span>
            <a href="#3a69ff95bcdff88a" class="i method">SubmitAndWaitForConnect</a>(<span class="r167 r">connectJobOperations</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connect a single child job associated with the provided runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">runspaceInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace instance id for child job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5afa040097909638" href="../../../R/5afa040097909638.html" target="n" data-glyph="74,1" class="i method">ConnectJob</a>(<span class="i">Guid</span> <span id="r169 rd" class="r169 r">runspaceInstanceId</span>)
        {
            <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r170 rd" class="r170 r">connectJobOperations</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt;();
            <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r171 rd" class="r171 r">childJob</span> = <a href="#c9e8b7dbddf4b032" class="i method">FindDisconnectedChildJob</a>(<span class="r169 r">runspaceInstanceId</span>);
            <b>if</b> (<span class="r171 r">childJob</span> != <b>null</b>)
            {
                <span class="r170 r">connectJobOperations</span>.<span class="i">Add</span>(<b>new</b> <a href="#1ff9f0e06ae9aac5" class="t constructor">ConnectJobOperation</a>(<span class="r171 r">childJob</span>));
            }
 
            <b>if</b> (<span class="r170 r">connectJobOperations</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b>;
            }
 
            <span class="c">// Submit the connect job operation.</span>
            <span class="c">// Return only after the connect operation completes.</span>
            <a href="#3a69ff95bcdff88a" class="i method">SubmitAndWaitForConnect</a>(<span class="r170 r">connectJobOperations</span>);
        }
 
        <b>private static void</b> <a id="3a69ff95bcdff88a" href="../../../R/3a69ff95bcdff88a.html" target="n" data-glyph="76,1" class="i method">SubmitAndWaitForConnect</a>(<span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r172 rd" class="r172 r">connectJobOperations</span>)
        {
            <b>using</b> (<a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <span id="r173 rd" class="r173 r">connectThrottleManager</span> = <b>new</b> <a href="../common/throttlemanager.cs.html#21c77408b36939a4" class="t constructor">ThrottleManager</a>())
            {
                <b>using</b> (<span class="i">ManualResetEvent</span> <span id="r174 rd" class="r174 r">connectResult</span> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>false</b>))
                {
                    <span class="i">EventHandler</span>&lt;<span class="i">EventArgs</span>&gt; <span id="r175 rd" class="r175 r">throttleCompleteEventHandler</span> =
                        (<b>object</b> <span id="r176 rd" class="r176 r">sender</span>, <span class="i">EventArgs</span> <span id="r177 rd" class="r177 r">eventArgs</span>) =&gt; <span class="r174 r">connectResult</span>.<span class="i">Set</span>();
 
                    <span class="r173 r">connectThrottleManager</span>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> += <span class="r175 r">throttleCompleteEventHandler</span>;
                    <b>try</b>
                    {
                        <span class="r173 r">connectThrottleManager</span>.<a href="../common/throttlemanager.cs.html#c88c6759bac73d6d" class="i property">ThrottleLimit</a> = 0;
                        <span class="r173 r">connectThrottleManager</span>.<a href="../common/throttlemanager.cs.html#ee8f2ac038103ebc" class="i method">SubmitOperations</a>(<span class="r172 r">connectJobOperations</span>);
                        <span class="r173 r">connectThrottleManager</span>.<a href="../common/throttlemanager.cs.html#75a1eec170a5d6bc" class="i method">EndSubmitOperations</a>();
 
                        <span class="r174 r">connectResult</span>.<span class="i">WaitOne</span>();
                    }
                    <b>finally</b>
                    {
                        <span class="r173 r">connectThrottleManager</span>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> -= <span class="r175 r">throttleCompleteEventHandler</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Simple throttle operation class for connecting jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="494f641109a2eb2d" href="../../../R/494f641109a2eb2d.html" target="n" data-glyph="4,1" class="t t">ConnectJobOperation</a> : <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>
        {
            <b>private readonly</b> <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <a id="0d5080658af1ae38" href="../../../R/0d5080658af1ae38.html" target="n" data-glyph="46,2" class="i field">_psRemoteChildJob</a>;
 
            <b>internal</b> <a id="1ff9f0e06ae9aac5" href="../../../R/1ff9f0e06ae9aac5.html" target="n" data-glyph="74,2" class="t constructor">ConnectJobOperation</a>(<a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r178 rd" class="r178 r">job</span>)
            {
                <a href="#0d5080658af1ae38" class="i field">_psRemoteChildJob</a> = <span class="r178 r">job</span>;
                <a href="#0d5080658af1ae38" class="i field">_psRemoteChildJob</a>.<a href="#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">ChildJobStateChangedHandler</span>;
            }
 
            <b>internal override void</b> <a id="f1ed27a6d828b9c0" href="../../../R/f1ed27a6d828b9c0.html" target="n" data-glyph="74,2" class="i method">StartOperation</a>()
            {
                <b>bool</b> <span id="r179 rd" class="r179 r">startedSuccessfully</span> = <b>true</b>;
 
                <b>try</b>
                {
                    <a href="#0d5080658af1ae38" class="i field">_psRemoteChildJob</a>.<a href="#94b09a2e06129487" class="i method">ConnectAsync</a>();
                }
                <b>catch</b> (<a href="#dc278bb168e942bb" class="t t">InvalidJobStateException</a> <span id="r180 rd" class="r180 r">e</span>)
                {
                    <span class="r179 r">startedSuccessfully</span> = <b>false</b>;
 
                    <b>string</b> <span id="r181 rd" class="r181 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobConnectFailed</span>, <a href="#0d5080658af1ae38" class="i field">_psRemoteChildJob</a>.<a href="#6332c7ef857bb146" class="i property">Name</a>);
                    <span class="i">Exception</span> <span id="r182 rd" class="r182 r">reason</span> = <b>new</b> <span class="t">RuntimeException</span>(<span class="r181 r">msg</span>, <span class="r180 r">e</span>);
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r183 rd" class="r183 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r182 r">reason</span>, <span class="s">&quot;PSJobConnectFailed&quot;</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <a href="#0d5080658af1ae38" class="i field">_psRemoteChildJob</a>);
                    <a href="#0d5080658af1ae38" class="i field">_psRemoteChildJob</a>.<a href="#f1efa785e9495a67" class="i method">WriteError</a>(<span class="r183 r">errorRecord</span>);
                }
 
                <b>if</b> (!<span class="r179 r">startedSuccessfully</span>)
                {
                    <a href="#5c553c0ec08d068e" class="i method">RemoveEventCallback</a>();
                    <a href="#43594ed8eaa68b11" class="i method">SendStartComplete</a>();
                }
            }
 
            <b>internal override void</b> <a id="53bb2cfab945601e" href="../../../R/53bb2cfab945601e.html" target="n" data-glyph="74,2" class="i method">StopOperation</a>()
            {
                <a href="#5c553c0ec08d068e" class="i method">RemoveEventCallback</a>();
 
                <span class="c">// Cannot stop a connect attempt.</span>
                <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r184 rd" class="r184 r">operationStateEventArgs</span> = <b>new</b> <span class="t">OperationStateEventArgs</span>();
                <span class="r184 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#8648129d937c33ce" class="i property">OperationState</a> = <a href="../common/throttlemanager.cs.html#6cf95059c5d2ad6e" class="t t">OperationState</a>.<a href="../common/throttlemanager.cs.html#c2e1a69d3e84f187" class="i field">StopComplete</a>;
                <a href="#4767d05c3bbf71e3" class="i">OperationComplete</a>.<span class="i">SafeInvoke</span>(<a href="#494f641109a2eb2d" class="k">this</a>, <span class="r184 r">operationStateEventArgs</span>);
            }
 
            <b>internal override event</b> <span class="i">EventHandler</span>&lt;<a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a>&gt; <a id="4767d05c3bbf71e3" href="../../../R/4767d05c3bbf71e3.html" target="n" data-glyph="32,2" class="i">OperationComplete</a>;
 
            <b>private void</b> <a id="e1cd077dd2475d53" href="../../../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">ChildJobStateChangedHandler</a>(<b>object</b> <span id="r185 rd" class="r185 r">sender</span>, <a href="#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r186 rd" class="r186 r">eArgs</span>)
            {
                <b>if</b> (<span class="r186 r">eArgs</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>)
                {
                    <b>return</b>;
                }
 
                <a href="#5c553c0ec08d068e" class="i method">RemoveEventCallback</a>();
                <a href="#43594ed8eaa68b11" class="i method">SendStartComplete</a>();
            }
 
            <b>private void</b> <a id="43594ed8eaa68b11" href="../../../R/43594ed8eaa68b11.html" target="n" data-glyph="76,2" class="i method">SendStartComplete</a>()
            {
                <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r187 rd" class="r187 r">operationStateEventArgs</span> = <b>new</b> <span class="t">OperationStateEventArgs</span>();
                <span class="r187 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#8648129d937c33ce" class="i property">OperationState</a> = <a href="../common/throttlemanager.cs.html#6cf95059c5d2ad6e" class="t t">OperationState</a>.<a href="../common/throttlemanager.cs.html#bad569808247de6a" class="i field">StartComplete</a>;
                <a href="#4767d05c3bbf71e3" class="i">OperationComplete</a>.<span class="i">SafeInvoke</span>(<a href="#494f641109a2eb2d" class="k">this</a>, <span class="r187 r">operationStateEventArgs</span>);
            }
 
            <b>private void</b> <a id="5c553c0ec08d068e" href="../../../R/5c553c0ec08d068e.html" target="n" data-glyph="76,2" class="i method">RemoveEventCallback</a>()
            {
                <a href="#0d5080658af1ae38" class="i field">_psRemoteChildJob</a>.<a href="#a099819afc059aeb" class="i">StateChanged</a> -= <span class="i">ChildJobStateChangedHandler</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Finds the disconnected child job associated with this runspace and returns</span>
        <span class="c">///</span><span class="c"> the PowerShell object that is remotely executing the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">runspaceInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace instance Id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Associated PowerShell object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="e93acba99fef72c7" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetAssociatedPowerShellObject</a>(<span class="i">Guid</span> <span id="r188 rd" class="r188 r">runspaceInstanceId</span>)
        {
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r189 rd" class="r189 r">ps</span> = <b>null</b>;
            <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r190 rd" class="r190 r">childJob</span> = <a href="#c9e8b7dbddf4b032" class="i method">FindDisconnectedChildJob</a>(<span class="r188 r">runspaceInstanceId</span>);
            <b>if</b> (<span class="r190 r">childJob</span> != <b>null</b>)
            {
                <span class="r189 r">ps</span> = <span class="r190 r">childJob</span>.<a href="#1905180c5908dffb" class="i method">GetPowerShell</a>();
            }
 
            <b>return</b> <span class="r189 r">ps</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method to find a disconnected child job associated with</span>
        <span class="c">///</span><span class="c"> a given runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r191 r">runspaceInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace Id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PSRemotingChildJob object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <a id="c9e8b7dbddf4b032" href="../../../R/c9e8b7dbddf4b032.html" target="n" data-glyph="76,1" class="i method">FindDisconnectedChildJob</a>(<span class="i">Guid</span> <span id="r191 rd" class="r191 r">runspaceInstanceId</span>)
        {
            <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r192 rd" class="r192 r">rtnJob</span> = <b>null</b>;
 
            <b>foreach</b> (<a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r193 rd" class="r193 r">childJob</span> <b>in</b> <a href="#3e3a8a0a8fbfcb51" class="k">this</a>.<a href="#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> ((<span class="r193 r">childJob</span>.<a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>.<span class="i">Equals</span>(<span class="r191 r">runspaceInstanceId</span>)) &amp;&amp;
                    (<span class="r193 r">childJob</span>.<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>))
                {
                    <span class="r192 r">rtnJob</span> = <span class="r193 r">childJob</span>;
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r192 r">rtnJob</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal method to stop a job without first connecting it if it is in</span>
        <span class="c">///</span><span class="c"> a disconnected state.  This supports Receive-PSSession where it abandons</span>
        <span class="c">///</span><span class="c"> a currently running/disconnected job when user selects -OutTarget Host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="cad160d4765e3cc7" href="../../../R/cad160d4765e3cc7.html" target="n" data-glyph="74,1" class="i method">InternalStopJob</a>()
        {
            <b>if</b> (<a href="#a7e17cb24f279ed1" class="i field">_isDisposed</a> || <a href="#669645ba47e97a27" class="i field">_stopIsCalled</a> || <a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
            {
                <b>return</b>;
            }
 
            <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#a7e17cb24f279ed1" class="i field">_isDisposed</a> || <a href="#669645ba47e97a27" class="i field">_stopIsCalled</a> || <a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
                {
                    <b>return</b>;
                }
 
                <a href="#669645ba47e97a27" class="i field">_stopIsCalled</a> = <b>true</b>;
            }
 
            <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#255a5e90af99543c" class="i method">StopAllOperations</a>();
 
            <a href="#b1600ff0c937953b" class="i property">Finished</a>.<span class="i">WaitOne</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private bool</b> <a id="5890f56756425caf" href="../../../R/5890f56756425caf.html" target="n" data-glyph="46,1" class="i field">_moreData</a> = <b>true</b>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates if more data is available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This has more data if any of the child jobs have more data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="e865091c1571862d" href="../../../R/e865091c1571862d.html" target="n" data-glyph="102,1" class="i property">HasMoreData</a>
        {
            <b>get</b>
            {
                <span class="c">// moreData is initially set to true, and it</span>
                <span class="c">// will remain so until the async result</span>
                <span class="c">// object has completed execution.</span>
 
                <b>if</b> (<a href="#5890f56756425caf" class="i field">_moreData</a> &amp;&amp; <a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
                {
                    <b>bool</b> <span id="r194 rd" class="r194 r">atleastOneChildHasMoreData</span> = <b>false</b>;
 
                    <b>for</b> (<b>int</b> <span id="r195 rd" class="r195 r">i</span> = 0; <span class="r195 r">i</span> &lt; <a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>; <span class="r195 r">i</span>++)
                    {
                        <b>if</b> (<a href="#db120f2476b59753" class="i property">ChildJobs</a>[<span class="r195 r">i</span>].<span class="i">HasMoreData</span>)
                        {
                            <span class="r194 r">atleastOneChildHasMoreData</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
 
                    <a href="#5890f56756425caf" class="i field">_moreData</a> = <span class="r194 r">atleastOneChildHasMoreData</span>;
                }
 
                <b>return</b> <a href="#5890f56756425caf" class="i field">_moreData</a>;
            }
        }
 
        <b>private bool</b> <a id="669645ba47e97a27" href="../../../R/669645ba47e97a27.html" target="n" data-glyph="46,1" class="i field">_stopIsCalled</a> = <b>false</b>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop Job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="76c5cbd5aa693a85" href="../../../R/76c5cbd5aa693a85.html" target="n" data-glyph="72,1" class="i method">StopJob</a>()
        {
            <span class="c">// If the job is in a disconnected state then try to connect it</span>
            <span class="c">// so that it can be stopped on the server.</span>
            <b>if</b> (<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>)
            {
                <b>bool</b> <span id="r196 rd" class="r196 r">ConnectSuccessful</span>;
 
                <b>try</b>
                {
                    <a href="#b4b99d9012296349" class="i method">ConnectJobs</a>();
                    <span class="r196 r">ConnectSuccessful</span> = <b>true</b>;
                }
                <b>catch</b> (<a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a>)
                {
                    <span class="r196 r">ConnectSuccessful</span> = <b>false</b>;
                }
                <b>catch</b> (<a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a>)
                {
                    <span class="r196 r">ConnectSuccessful</span> = <b>false</b>;
                }
                <b>catch</b> (<a href="../../../utils/MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a>)
                {
                    <span class="r196 r">ConnectSuccessful</span> = <b>false</b>;
                }
 
                <b>if</b> (!<span class="r196 r">ConnectSuccessful</span> &amp;&amp; <a href="#3e3a8a0a8fbfcb51" class="k">this</a>.<a href="#322c09d9eb167da1" class="i property">Error</a>.<a href="../../hostifaces/PSDataCollection.cs.html#c160386455270a8f" class="i property">IsOpen</a>)
                {
                    <b>string</b> <span id="r197 rd" class="r197 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">StopJobNotConnected</span>, <a href="#3e3a8a0a8fbfcb51" class="k">this</a>.<a href="#6332c7ef857bb146" class="i property">Name</a>);
                    <span class="i">Exception</span> <span id="r198 rd" class="r198 r">reason</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<span class="r197 r">msg</span>);
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r199 rd" class="r199 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r198 r">reason</span>, <span class="s">&quot;StopJobCannotConnectToServer&quot;</span>,
                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <a href="#3e3a8a0a8fbfcb51" class="k">this</a>);
                    <a href="#f1efa785e9495a67" class="i method">WriteError</a>(<span class="r199 r">errorRecord</span>);
 
                    <b>return</b>;
                }
            }
 
            <a href="#cad160d4765e3cc7" class="i method">InternalStopJob</a>();
        }
 
        <b>private string</b> <a id="0bc0c3141fc80429" href="../../../R/0bc0c3141fc80429.html" target="n" data-glyph="46,1" class="i field">_statusMessage</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Message indicating status of the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="4af571ac48da60dd" href="../../../R/4af571ac48da60dd.html" target="n" data-glyph="102,1" class="i property">StatusMessage</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#0bc0c3141fc80429" class="i field">_statusMessage</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Invoke-Command cmdlet to show/hide computername property value.</span>
        <span class="c">///</span><span class="c"> Format and Output has capability to understand RemoteObjects and this property lets</span>
        <span class="c">///</span><span class="c"> Format and Output decide whether to show/hide computername.</span>
        <span class="c">///</span><span class="c"> Default is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="b0e94f782a20f2ee" href="../../../R/b0e94f782a20f2ee.html" target="n" data-glyph="104,1" class="i property">HideComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2e53e4e025f56a10" class="i field">_hideComputerName</a>;
            }
 
            <b>set</b>
            {
                <a href="#2e53e4e025f56a10" class="i field">_hideComputerName</a> = <b>value</b>;
                <b>foreach</b> (<a href="#e1ff43f6998863de" class="t t">Job</a> <span id="r200 rd" class="r200 r">job</span> <b>in</b> <a href="#3e3a8a0a8fbfcb51" class="k">this</a>.<a href="#db120f2476b59753" class="i property">ChildJobs</a>)
                {
                    <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r201 rd" class="r201 r">rJob</span> = <span class="r200 r">job</span> <b>as</b> <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a>;
                    <b>if</b> (<span class="r201 r">rJob</span> != <b>null</b>)
                    {
                        <span class="r201 r">rJob</span>.<a href="#a9153cb43ef732da" class="i property">HideComputerName</a> = <b>value</b>;
                    }
                }
            }
        }
 
        <b>private bool</b> <a id="2e53e4e025f56a10" href="../../../R/2e53e4e025f56a10.html" target="n" data-glyph="46,1" class="i field">_hideComputerName</a> = <b>true</b>;
 
        <span class="c">// ISSUE: Implement StatusMessage</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks the status of remote command execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1811:AvoidUncalledPrivateCode&quot;</span>)]
        <b>private void</b> <a id="2f04750494082380" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SetStatusMessage</a>()
        {
            <a href="#0bc0c3141fc80429" class="i field">_statusMessage</a> = <span class="s">&quot;test&quot;</span>;
            <span class="c">//        bool localErrors = false; // if local errors are present</span>
            <span class="c">//        bool setFinished = false;    // if finished needs to be set</span>
 
            <span class="c">//        statusMessage = &quot;OK&quot;;</span>
 
            <span class="c">//        lock (syncObject)</span>
            <span class="c">//        {</span>
            <span class="c">//            if (finishedCount == ChildJobs.Count)</span>
            <span class="c">//            {</span>
            <span class="c">//                // ISSUE: Change this code to look in to child jobs for exception</span>
            <span class="c">//                if (errors.Count &gt; 0)</span>
            <span class="c">//                {</span>
            <span class="c">//                    statusMessage = &quot;LocalErrors&quot;;</span>
            <span class="c">//                    localErrors = true;</span>
            <span class="c">//                }</span>
 
            <span class="c">//                // check for status of remote command</span>
            <span class="c">//                for (int i = 0; i &lt; ChildJobs.Count; i++)</span>
            <span class="c">//                {</span>
            <span class="c">//                    PSRemotingChildJob childJob = ChildJobs[i] as PSRemotingChildJob;</span>
            <span class="c">//                    if (childJob == null) continue;</span>
            <span class="c">//                    if (childJob.ContainsErrors)</span>
            <span class="c">//                    {</span>
            <span class="c">//                        if (localErrors)</span>
            <span class="c">//                        {</span>
            <span class="c">//                            statusMessage = &quot;LocalAndRemoteErrors&quot;;</span>
            <span class="c">//                        }</span>
            <span class="c">//                        else</span>
            <span class="c">//                        {</span>
            <span class="c">//                            statusMessage = &quot;RemoteErrors&quot;;</span>
            <span class="c">//                        }</span>
            <span class="c">//                        break;</span>
            <span class="c">//                    }</span>
            <span class="c">//                }</span>
 
            <span class="c">//                setFinished = true;</span>
            <span class="c">//            }</span>
            <span class="c">//        }</span>
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> finish logic
 
        <span class="c">// This variable is set to true if atleast one child job failed.</span>
        <b>private bool</b> <a id="373fa38c0400b751" href="../../../R/373fa38c0400b751.html" target="n" data-glyph="46,1" class="i field">_atleastOneChildJobFailed</a> = <b>false</b>;
 
        <span class="c">// count of number of child jobs which have finished</span>
        <b>private int</b> <a id="e09861f968104594" href="../../../R/e09861f968104594.html" target="n" data-glyph="46,1" class="i field">_finishedChildJobsCount</a> = 0;
 
        <span class="c">// count of number of child jobs which are blocked</span>
        <b>private int</b> <a id="071b131ce3321593" href="../../../R/071b131ce3321593.html" target="n" data-glyph="46,1" class="i field">_blockedChildJobsCount</a> = 0;
 
        <span class="c">// count of child jobs that are in disconnected state.</span>
        <b>private int</b> <a id="4c2de82d528892a9" href="../../../R/4c2de82d528892a9.html" target="n" data-glyph="46,1" class="i field">_disconnectedChildJobsCount</a> = 0;
 
        <span class="c">// count of child jobs that are in Debug halted state.</span>
        <b>private int</b> <a id="f0835ea060dac2dd" href="../../../R/f0835ea060dac2dd.html" target="n" data-glyph="46,1" class="i field">_debugChildJobsCount</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles the StateChanged event from each of the child job objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r202 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r203 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a40688315ca5fd47" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleChildJobStateChanged</a>(<b>object</b> <span id="r202 rd" class="r202 r">sender</span>, <a href="#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r203 rd" class="r203 r">e</span>)
        {
            <span class="c">// Update object state to reflect disconnect state related changes in child jobs.</span>
            <a href="#ab8e5bd074a61ead" class="i method">CheckDisconnectedAndUpdateState</a>(<span class="r203 r">e</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>, <span class="r203 r">e</span>.<a href="#6302f233913a7ce2" class="i property">PreviousJobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>);
 
            <b>if</b> (<span class="r203 r">e</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>)
            {
                <span class="c">// increment count of blocked child jobs</span>
                <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>)
                {
                    <a href="#071b131ce3321593" class="i field">_blockedChildJobsCount</a>++;
                }
 
                <span class="c">// if any of the child job is blocked, we set state to blocked</span>
                <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>, <b>null</b>);
                <b>return</b>;
            }
 
            <span class="c">// Handle transition of child job to Debug halt state.</span>
            <b>if</b> (<span class="r203 r">e</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#3a538a4d2b74d6fc" class="i field">AtBreakpoint</a>)
            {
                <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>) { <a href="#f0835ea060dac2dd" class="i field">_debugChildJobsCount</a>++; }
 
                <span class="c">// If any child jobs are Debug halted, we set state to Debug.</span>
                <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#3a538a4d2b74d6fc" class="i field">AtBreakpoint</a>);
                <b>return</b>;
            }
 
            <span class="c">// Handle transition of child job back to running state.</span>
            <b>if</b> ((<span class="r203 r">e</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>) &amp;&amp;
                (<span class="r203 r">e</span>.<a href="#6302f233913a7ce2" class="i property">PreviousJobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#3a538a4d2b74d6fc" class="i field">AtBreakpoint</a>))
            {
                <b>int</b> <span id="r204 rd" class="r204 r">totalDebugCount</span>;
                <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>) { <span class="r204 r">totalDebugCount</span> = --<a href="#f0835ea060dac2dd" class="i field">_debugChildJobsCount</a>; }
 
                <b>if</b> (<span class="r204 r">totalDebugCount</span> == 0)
                {
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>);
                    <b>return</b>;
                }
            }
 
            <span class="c">// Ignore state changes which are not resulting in state change to finished.</span>
            <b>if</b> (!<a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<span class="r203 r">e</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r203 r">e</span>.<a href="#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#4d2acd22ba4f0da9" class="i field">Failed</a>)
            {
                <span class="c">// If any of the child job failed, we set status to failed</span>
                <a href="#373fa38c0400b751" class="i field">_atleastOneChildJobFailed</a> = <b>true</b>;
            }
 
            <b>bool</b> <span id="r205 rd" class="r205 r">allChildJobsFinished</span> = <b>false</b>;
            <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>)
            {
                <a href="#e09861f968104594" class="i field">_finishedChildJobsCount</a>++;
 
                <span class="c">// We are done</span>
                <b>if</b> (<a href="#e09861f968104594" class="i field">_finishedChildJobsCount</a> + <a href="#4c2de82d528892a9" class="i field">_disconnectedChildJobsCount</a>
                    == <a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                {
                    <span class="r205 r">allChildJobsFinished</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="r205 r">allChildJobsFinished</span>)
            {
                <span class="c">// if any child job failed, set status to failed</span>
                <span class="c">// If stop was called set, status to stopped</span>
                <span class="c">// else completed</span>
                <b>if</b> (<a href="#4c2de82d528892a9" class="i field">_disconnectedChildJobsCount</a> &gt; 0)
                {
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>);
                }
                <b>else</b> <b>if</b> (<a href="#373fa38c0400b751" class="i field">_atleastOneChildJobFailed</a>)
                {
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#4d2acd22ba4f0da9" class="i field">Failed</a>);
                }
                <b>else</b> <b>if</b> (<a href="#669645ba47e97a27" class="i field">_stopIsCalled</a>)
                {
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#223c91574b18631a" class="i field">Stopped</a>);
                }
                <b>else</b>
                {
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#db36b340edc064ae" class="i field">Completed</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Updates the parent job state based on state of all child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r206 r">newState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">New child job state.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">prevState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Previous child job state.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ab8e5bd074a61ead" href="../../../R/ab8e5bd074a61ead.html" target="n" data-glyph="76,1" class="i method">CheckDisconnectedAndUpdateState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r206 rd" class="r206 r">newState</span>, <a href="#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r207 rd" class="r207 r">prevState</span>)
        {
            <b>if</b> (<a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
            {
                <b>return</b>;
            }
 
            <span class="c">// Do all logic inside a lock to ensure it is atomic against</span>
            <span class="c">// multiple job thread state changes.</span>
            <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>)
            {
                <b>if</b> (<span class="r206 r">newState</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>)
                {
                    ++(<a href="#4c2de82d528892a9" class="i field">_disconnectedChildJobsCount</a>);
 
                    <span class="c">// If previous state was Blocked then we need to decrement the count</span>
                    <span class="c">// since it is now Disconnected.</span>
                    <b>if</b> (<span class="r207 r">prevState</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>)
                    {
                        --<a href="#071b131ce3321593" class="i field">_blockedChildJobsCount</a>;
                    }
 
                    <span class="c">// If all unfinished and unblocked child jobs are disconnected then this</span>
                    <span class="c">// parent job becomes disconnected.</span>
                    <b>if</b> ((<a href="#4c2de82d528892a9" class="i field">_disconnectedChildJobsCount</a> +
                         <a href="#e09861f968104594" class="i field">_finishedChildJobsCount</a> +
                         <a href="#071b131ce3321593" class="i field">_blockedChildJobsCount</a>) == <a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                    {
                        <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>, <b>null</b>);
                    }
                }
                <b>else</b>
                {
                    <b>if</b> (<span class="r207 r">prevState</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>)
                    {
                        --(<a href="#4c2de82d528892a9" class="i field">_disconnectedChildJobsCount</a>);
                    }
 
                    <b>if</b> ((<span class="r206 r">newState</span> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>) &amp;&amp; (<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>))
                    {
                        <span class="c">// Note that SetJobState() takes a lock so it is unnecessary to do</span>
                        <span class="c">// this under a lock here.</span>
                        <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>, <b>null</b>);
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> finish logic
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Release all the resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r208 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if true, release all the managed objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="4142337f7a15f18d" href="../../../R/4142337f7a15f18d.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r208 rd" class="r208 r">disposing</span>)
        {
            <b>if</b> (<span class="r208 r">disposing</span>)
            {
                <b>if</b> (<a href="#a7e17cb24f279ed1" class="i field">_isDisposed</a>)
                {
                    <b>return</b>;
                }
 
                <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>)
                {
                    <b>if</b> (<a href="#a7e17cb24f279ed1" class="i field">_isDisposed</a>)
                    {
                        <b>return</b>;
                    }
 
                    <a href="#a7e17cb24f279ed1" class="i field">_isDisposed</a> = <b>true</b>;
                }
 
                <b>try</b>
                {
                    <b>if</b> (!<a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
                    {
                        <a href="#76c5cbd5aa693a85" class="i method">StopJob</a>();
                    }
 
                    <b>foreach</b> (<a href="#e1ff43f6998863de" class="t t">Job</a> <span id="r209 rd" class="r209 r">job</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
                    {
                        <span class="r209 r">job</span>.<a href="#a1b7a0cd2d734ade" class="i method">Dispose</a>();
                    }
 
                    <a href="#bbb28d1f020f8964" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd620168185a530e" class="i method">Dispose</a>();
                }
                <b>finally</b>
                {
                    <a href="#e1ff43f6998863de" class="k">base</a>.<a href="#19b362abde0789e5" class="i method">Dispose</a>(<span class="r208 r">disposing</span>);
                }
            }
        }
 
        <b>private bool</b> <a id="a7e17cb24f279ed1" href="../../../R/a7e17cb24f279ed1.html" target="n" data-glyph="46,1" class="i field">_isDisposed</a> = <b>false</b>;
 
        <b>private string</b> <a id="ce511fdc5d4dc228" href="../../../R/ce511fdc5d4dc228.html" target="n" data-glyph="76,1" class="i method">ConstructLocation</a>()
        {
            <span class="i">StringBuilder</span> <span id="r210 rd" class="r210 r">location</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>if</b> (<a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> &gt; 0)
            {
                <b>foreach</b> (<a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r211 rd" class="r211 r">job</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
                {
                    <span class="r210 r">location</span>.<span class="i">Append</span>(<span class="r211 r">job</span>.<a href="#aa52fd55c72e3e49" class="i property">Location</a>);
                    <span class="r210 r">location</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                }
 
                <span class="r210 r">location</span>.<span class="i">Remove</span>(<span class="r210 r">location</span>.<span class="i">Length</span> - 1, 1);
            }
 
            <b>return</b> <span class="r210 r">location</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computers on which this job is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="1ee6dbae2c4292d1" href="../../../R/1ee6dbae2c4292d1.html" target="n" data-glyph="102,1" class="i property">Location</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ce511fdc5d4dc228" class="i method">ConstructLocation</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns boolean indicating whether the underlying</span>
        <span class="c">///</span><span class="c"> transport for the job (or child jobs) supports</span>
        <span class="c">///</span><span class="c"> connect/disconnect semantics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="6ac13acd484dfc61" href="../../../R/6ac13acd484dfc61.html" target="n" data-glyph="104,1" class="i property">CanDisconnect</a>
        {
            <b>get</b>
            {
                <span class="c">// If one child job can disconnect then all of them can since</span>
                <span class="c">// all child jobs use the same remote runspace transport.</span>
                <b>return</b> (<a href="#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> &gt; 0) &amp;&amp; <a href="#db120f2476b59753" class="i property">ChildJobs</a>[0].<span class="i">CanDisconnect</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns runspaces associated with the Job, including</span>
        <span class="c">///</span><span class="c"> child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">IEnumerable of RemoteRunspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <span class="i">IEnumerable</span>&lt;<a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>&gt; <a id="8c43bdc93b83800e" href="../../../R/8c43bdc93b83800e.html" target="n" data-glyph="74,1" class="i method">GetRunspaces</a>()
        {
            <span class="i">List</span>&lt;<a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>&gt; <span id="r212 rd" class="r212 r">runspaces</span> = <b>new</b> <span class="i">List</span>&lt;<a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>&gt;();
            <b>foreach</b> (<a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r213 rd" class="r213 r">job</span> <b>in</b> <a href="#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <span class="r212 r">runspaces</span>.<span class="i">Add</span>(<span class="r213 r">job</span>.<a href="#08647015a50a05bd" class="i property">Runspace</a> <b>as</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>);
            }
 
            <b>return</b> <span class="r212 r">runspaces</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles JobUnblocked event from a child job and decrements</span>
        <span class="c">///</span><span class="c"> count of blocked child jobs. When count reaches 0, sets the</span>
        <span class="c">///</span><span class="c"> state of the parent job to running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r214 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender of this event, unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r215 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">event arguments, should be empty in this</span>
        <span class="c">///</span><span class="c"> case</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="13f69fded28b912c" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleJobUnblocked</a>(<b>object</b> <span id="r214 rd" class="r214 r">sender</span>, <span class="i">EventArgs</span> <span id="r215 rd" class="r215 r">eventArgs</span>)
        {
            <b>bool</b> <span id="r216 rd" class="r216 r">unblockjob</span> = <b>false</b>;
 
            <b>lock</b> (<a href="#84991f17336132f0" class="i field">_syncObject</a>)
            {
                <a href="#071b131ce3321593" class="i field">_blockedChildJobsCount</a>--;
 
                <b>if</b> (<a href="#071b131ce3321593" class="i field">_blockedChildJobsCount</a> == 0)
                {
                    <span class="r216 r">unblockjob</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="r216 r">unblockjob</span>)
            {
                <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>, <b>null</b>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private readonly</b> <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <a id="bbb28d1f020f8964" href="../../../R/bbb28d1f020f8964.html" target="n" data-glyph="46,1" class="i field">_throttleManager</a> = <b>new</b> <a href="../common/throttlemanager.cs.html#21c77408b36939a4" class="t constructor">ThrottleManager</a>();
 
        <b>private readonly object</b> <a id="84991f17336132f0" href="../../../R/84991f17336132f0.html" target="n" data-glyph="46,1" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();           <span class="c">// sync object</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> DisconnectedJobOperation class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Simple throttle operation class for PSRemoting jobs created in the</span>
    <span class="c">///</span><span class="c"> disconnected state.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="53823b92d1353d85" href="../../../R/53823b92d1353d85.html" target="n" data-glyph="2,0" class="t t">DisconnectedJobOperation</a> : <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>
    {
        <b>internal</b> <a id="43da61b848d1a10d" href="../../../R/43da61b848d1a10d.html" target="n" data-glyph="74,1" class="t constructor">DisconnectedJobOperation</a>(<a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r217 rd" class="r217 r">pipeline</span>)
        {
            <a href="#53823b92d1353d85" class="k">this</a>.<a href="../commands/PSRemotingCmdlet.cs.html#858f6547d7a6190c" class="i field">pipeline</a> = <span class="r217 r">pipeline</span>;
            <a href="#53823b92d1353d85" class="k">this</a>.<a href="../commands/PSRemotingCmdlet.cs.html#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#c0baffefeaa75abd" class="i">StateChanged</a> += <span class="i">HandlePipelineStateChanged</span>;
        }
 
        <b>internal override void</b> <a id="56c0963c0debe8fd" href="../../../R/56c0963c0debe8fd.html" target="n" data-glyph="74,1" class="i method">StartOperation</a>()
        {
            <span class="c">// This is a no-op since disconnected jobs (pipelines) have</span>
            <span class="c">// already been started.</span>
        }
 
        <b>internal override void</b> <a id="7b1fc1e207db43e9" href="../../../R/7b1fc1e207db43e9.html" target="n" data-glyph="74,1" class="i method">StopOperation</a>()
        {
            <b>if</b> (<a href="../commands/PSRemotingCmdlet.cs.html#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a> ||
                <a href="../commands/PSRemotingCmdlet.cs.html#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a> ||
                <a href="../commands/PSRemotingCmdlet.cs.html#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>)
            {
                <span class="c">// If the pipeline state has reached Complete/Failed/Stopped</span>
                <span class="c">// by the time control reaches here, then this operation</span>
                <span class="c">// becomes a no-op. However, an OperationComplete would have</span>
                <span class="c">// already been raised from the handler.</span>
                <a href="../commands/PSRemotingCmdlet.cs.html#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#112721a0ffd69637" class="i method">StopAsync</a>();
            }
            <b>else</b>
            {
                <span class="c">// Will have to raise OperationComplete from here,</span>
                <span class="c">// else ThrottleManager will have</span>
                <a href="#f3f44de1bc146b71" class="i method">SendStopComplete</a>();
            }
        }
 
        <b>internal override event</b> <span class="i">EventHandler</span>&lt;<a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a>&gt; <a id="2fd614023c9b17b8" href="../../../R/2fd614023c9b17b8.html" target="n" data-glyph="32,1" class="i">OperationComplete</a>;
 
        <b>private void</b> <a id="8d6eba1bee85cd87" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandlePipelineStateChanged</a>(<b>object</b> <span id="r218 rd" class="r218 r">sender</span>, <a href="../../hostifaces/Pipeline.cs.html#f088a79047187694" class="t t">PipelineStateEventArgs</a> <span id="r219 rd" class="r219 r">stateEventArgs</span>)
        {
            <a href="../../hostifaces/Pipeline.cs.html#62fb09153673bbf3" class="t t">PipelineStateInfo</a> <span id="r220 rd" class="r220 r">stateInfo</span> = <span class="r219 r">stateEventArgs</span>.<a href="../../hostifaces/Pipeline.cs.html#90fde3748e993197" class="i property">PipelineStateInfo</a>;
 
            <b>switch</b> (<span class="r220 r">stateInfo</span>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a>)
            {
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#17a7706ccaf63f5c" class="i field">Stopping</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>:
                    <b>return</b>;
            }
 
            <span class="i">SendStopComplete</span>(<span class="r219 r">stateEventArgs</span>);
        }
 
        <b>private void</b> <a id="f3f44de1bc146b71" href="../../../R/f3f44de1bc146b71.html" target="n" data-glyph="76,1" class="i method">SendStopComplete</a>(<span class="i">EventArgs</span> <span id="r221 rd" class="r221 r">eventArgs</span> = <b>null</b>)
        {
            <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r222 rd" class="r222 r">operationStateEventArgs</span> = <b>new</b> <span class="t">OperationStateEventArgs</span>();
            <span class="r222 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#c68f18b126779ae0" class="i property">BaseEvent</a> = <span class="r221 r">eventArgs</span>;
            <span class="r222 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#8648129d937c33ce" class="i property">OperationState</a> = <a href="../common/throttlemanager.cs.html#6cf95059c5d2ad6e" class="t t">OperationState</a>.<a href="../common/throttlemanager.cs.html#c2e1a69d3e84f187" class="i field">StopComplete</a>;
            <a href="#2fd614023c9b17b8" class="i">OperationComplete</a>.<span class="i">SafeInvoke</span>(<a href="#53823b92d1353d85" class="k">this</a>, <span class="r222 r">operationStateEventArgs</span>);
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class for RemotingChildJob object. This job object invokes command</span>
    <span class="c">///</span><span class="c"> on one remote machine.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> TODO: I am not sure whether to change this internal to just RemotingChildJob.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Not removing the prefix &quot;PS&quot; as this signifies powershell specific remoting job</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="d1388b6af9650b2e" href="../../../R/d1388b6af9650b2e.html" target="n" data-glyph="2,0" class="t t">PSRemotingChildJob</a> : <a href="#e1ff43f6998863de" class="t t">Job</a>, <a href="#0a5020043aef4132" class="t t">IJobDebugger</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of PSRemotingChildJob.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r223 r">remoteCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r224 r">helper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r225 r">throttleManager</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="0a3d2328481b6045" href="../../../R/0a3d2328481b6045.html" target="n" data-glyph="74,1" class="t constructor">PSRemotingChildJob</a>(<b>string</b> <span id="r223 rd" class="r223 r">remoteCommand</span>, <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r224 rd" class="r224 r">helper</span>, <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <span id="r225 rd" class="r225 r">throttleManager</span>)
            : <a href="#74a42d7ce4759be3" class="k">base</a>(<span class="r223 r">remoteCommand</span>)
        {
            <a href="#fd6ecf089f9dc9c7" class="i property">UsesResultsCollection</a> = <b>true</b>;
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r224 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a> <b>is</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>, <span class="s">&quot;Pipeline passed should be a remote pipeline&quot;</span>);
 
            <a href="#ded04bc1d30f6e94" class="i property">Helper</a> = <span class="r224 r">helper</span>;
            <a href="#08647015a50a05bd" class="i property">Runspace</a> = <span class="r224 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#cefa43f64a3ac790" class="i property">Runspace</a>;
            <a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a> = <span class="r224 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a> <b>as</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>;
            <a href="#516548804be81d41" class="i field">_throttleManager</a> = <span class="r225 r">throttleManager</span>;
 
            <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r226 rd" class="r226 r">remoteRS</span> = <a href="#08647015a50a05bd" class="i property">Runspace</a> <b>as</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
            <b>if</b> ((<span class="r226 r">remoteRS</span> != <b>null</b>) &amp;&amp; (<span class="r226 r">remoteRS</span>.<a href="remoterunspace.cs.html#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>))
            {
                <span class="r226 r">remoteRS</span>.<a href="remoterunspace.cs.html#f21dad86b0e2d67e" class="i">URIRedirectionReported</a> += <span class="i">HandleURIDirectionReported</span>;
            }
 
            <a href="#0f9af92314d5920a" class="i method">AggregateResultsFromHelper</a>(<span class="r224 r">helper</span>);
 
            <a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#3cd2a1e80935c2fb" class="i">AvailabilityChanged</a> += <span class="i">HandleRunspaceAvailabilityChanged</span>;
 
            <a href="#48ba2b5a84d42ee0" class="i method">RegisterThrottleComplete</a>(<span class="r225 r">throttleManager</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a disconnected child job that is able to connect to a remote</span>
        <span class="c">///</span><span class="c"> runspace/command on a server.  The ExecutionCmdletHelperRunspace must</span>
        <span class="c">///</span><span class="c"> contain a remote pipeline object in a disconnected state.  In addition</span>
        <span class="c">///</span><span class="c"> the pipeline runspace must be associated with a valid running remote</span>
        <span class="c">///</span><span class="c"> command that can be connected to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">helper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ExecutionCmdletHelper object containing runspace and pipeline objects.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">throttleManager</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ThrottleManger object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">aggregateResults</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Aggregate results.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="4f6ee4f59c75275c" href="../../../R/4f6ee4f59c75275c.html" target="n" data-glyph="74,1" class="t constructor">PSRemotingChildJob</a>(<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r227 rd" class="r227 r">helper</span>, <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <span id="r228 rd" class="r228 r">throttleManager</span>, <b>bool</b> <span id="r229 rd" class="r229 r">aggregateResults</span> = <b>false</b>)
        {
            <a href="#fd6ecf089f9dc9c7" class="i property">UsesResultsCollection</a> = <b>true</b>;
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<span class="r227 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a> <b>is</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>), <span class="s">&quot;Helper pipeline object should be a remote pipeline&quot;</span>);
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<span class="r227 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>), <span class="s">&quot;Remote pipeline object must be in Disconnected state.&quot;</span>);
 
            <a href="#ded04bc1d30f6e94" class="i property">Helper</a> = <span class="r227 r">helper</span>;
            <a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a> = <span class="r227 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a> <b>as</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>;
            <a href="#08647015a50a05bd" class="i property">Runspace</a> = <span class="r227 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#cefa43f64a3ac790" class="i property">Runspace</a>;
            <a href="#516548804be81d41" class="i field">_throttleManager</a> = <span class="r228 r">throttleManager</span>;
 
            <b>if</b> (<span class="r229 r">aggregateResults</span>)
            {
                <a href="#0f9af92314d5920a" class="i method">AggregateResultsFromHelper</a>(<span class="r227 r">helper</span>);
            }
            <b>else</b>
            {
                <a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>.<a href="remotepipeline.cs.html#7001904b7a393079" class="i">StateChanged</a> += <span class="i">HandlePipelineStateChanged</span>;
                <a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>.<a href="remotepipeline.cs.html#29d3347675fb48d8" class="i property">Output</a>.<a href="../../../utils/IObjectReader.cs.html#ab790c5de0e4e578" class="i">DataReady</a> += <span class="i">HandleOutputReady</span>;
                <a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>.<a href="remotepipeline.cs.html#bac27ff1276c3b0d" class="i property">Error</a>.<a href="../../../utils/IObjectReader.cs.html#ab790c5de0e4e578" class="i">DataReady</a> += <span class="i">HandleErrorReady</span>;
            }
 
            <a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#3cd2a1e80935c2fb" class="i">AvailabilityChanged</a> += <span class="i">HandleRunspaceAvailabilityChanged</span>;
 
            <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r230 rd" class="r230 r">operation</span> = <span class="r227 r">helper</span> <b>as</b> <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>;
            <span class="r230 r">operation</span>.<a href="../common/throttlemanager.cs.html#d2b8440ede8b9b06" class="i">OperationComplete</a> += <span class="i">HandleOperationComplete</span>;
 
            <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="3142f15e5a1c9c79" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">PSRemotingChildJob</a>()
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the remote pipeline that this job represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="94b09a2e06129487" href="../../../R/94b09a2e06129487.html" target="n" data-glyph="74,1" class="i method">ConnectAsync</a>()
        {
            <b>if</b> (<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> != <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>)
            {
                <b>throw</b> <b>new</b> <a href="#8e23b35147b74756" class="t constructor">InvalidJobStateException</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>);
            }
 
            <a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>.<a href="remotepipeline.cs.html#ec400610bd67c95c" class="i method">ConnectAsync</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> stop
 
        <span class="c">// bool isStopCalled = false;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="c4ffdec9864b6eb7" href="../../../R/c4ffdec9864b6eb7.html" target="n" data-glyph="72,1" class="i method">StopJob</a>()
        {
            <b>if</b> (<a href="#0e38020f37ff8160" class="i field">_isDisposed</a> || <a href="#6ea8b1d2c2f95fb9" class="i field">_stopIsCalled</a> || <a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
            {
                <b>return</b>;
            }
 
            <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
            {
                <b>if</b> (<a href="#0e38020f37ff8160" class="i field">_isDisposed</a> || <a href="#6ea8b1d2c2f95fb9" class="i field">_stopIsCalled</a> || <a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>))
                {
                    <b>return</b>;
                }
 
                <a href="#6ea8b1d2c2f95fb9" class="i field">_stopIsCalled</a> = <b>true</b>;
            }
 
            <a href="#516548804be81d41" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#9fdde813aaf8678c" class="i method">StopOperation</a>(<a href="#ded04bc1d30f6e94" class="i property">Helper</a>);
 
            <span class="c">// if IgnoreStop is set, then StopOperation will</span>
            <span class="c">// return immediately, but StopJob should only</span>
            <span class="c">// return when job is complete. Waiting on the</span>
            <span class="c">// wait handle will ensure that its blocked</span>
            <span class="c">// until the job reaches a terminal state</span>
            <a href="#b1600ff0c937953b" class="i property">Finished</a>.<span class="i">WaitOne</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> stop
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Status Message associated with the Job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="6de3a34d9397f8fa" href="../../../R/6de3a34d9397f8fa.html" target="n" data-glyph="102,1" class="i property">StatusMessage</a>
        {
            <b>get</b>
            {
                <span class="c">// ISSUE implement this.</span>
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates if there is more data available in</span>
        <span class="c">///</span><span class="c"> this Job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="73555a9b245b8574" href="../../../R/73555a9b245b8574.html" target="n" data-glyph="102,1" class="i property">HasMoreData</a>
        {
            <b>get</b>
            {
                <b>return</b> (<a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#c160386455270a8f" class="i property">IsOpen</a> || <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#e7cb43bbebbb4aca" class="i property">Count</a> &gt; 0);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the computer on which this command is</span>
        <span class="c">///</span><span class="c"> running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="aa52fd55c72e3e49" href="../../../R/aa52fd55c72e3e49.html" target="n" data-glyph="102,1" class="i property">Location</a>
        {
            <b>get</b>
            {
                <b>return</b> (<a href="#08647015a50a05bd" class="i property">Runspace</a> != <b>null</b>) ? <a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#7ff4c79fcb624bf1" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a> : <b>string</b>.<span class="i">Empty</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="08647015a50a05bd" href="../../../R/08647015a50a05bd.html" target="n" data-glyph="102,1" class="i property">Runspace</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper associated with this entity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <a id="ded04bc1d30f6e94" href="../../../R/ded04bc1d30f6e94.html" target="n" data-glyph="104,1" class="i property">Helper</a> { <b>get</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Invoke-Command cmdlet to show/hide computername property value.</span>
        <span class="c">///</span><span class="c"> Format and Output has capability to understand RemoteObjects and this property lets</span>
        <span class="c">///</span><span class="c"> Format and Output decide whether to show/hide computername.</span>
        <span class="c">///</span><span class="c"> Default is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="a9153cb43ef732da" href="../../../R/a9153cb43ef732da.html" target="n" data-glyph="104,1" class="i property">HideComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9b1d354270ee90df" class="i field">_hideComputerName</a>;
            }
 
            <b>set</b>
            {
                <a href="#9b1d354270ee90df" class="i field">_hideComputerName</a> = <b>value</b>;
                <b>foreach</b> (<a href="#e1ff43f6998863de" class="t t">Job</a> <span id="r231 rd" class="r231 r">job</span> <b>in</b> <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#db120f2476b59753" class="i property">ChildJobs</a>)
                {
                    <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r232 rd" class="r232 r">rJob</span> = <span class="r231 r">job</span> <b>as</b> <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a>;
                    <b>if</b> (<span class="r232 r">rJob</span> != <b>null</b>)
                    {
                        <span class="r232 r">rJob</span>.<a href="#a9153cb43ef732da" class="i property">HideComputerName</a> = <b>value</b>;
                    }
                }
            }
        }
 
        <b>private bool</b> <a id="9b1d354270ee90df" href="../../../R/9b1d354270ee90df.html" target="n" data-glyph="46,1" class="i field">_hideComputerName</a> = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property that indicates this disconnected child job was</span>
        <span class="c">///</span><span class="c"> previously in the Blocked state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="ffbfaa3edeb24ae7" href="../../../R/ffbfaa3edeb24ae7.html" target="n" data-glyph="104,1" class="i property">DisconnectedAndBlocked</a> { <b>get</b>; <b>private set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns boolean indicating whether the underlying</span>
        <span class="c">///</span><span class="c"> transport for the job (or child jobs) supports</span>
        <span class="c">///</span><span class="c"> connect/disconnect semantics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="dde861de25cbe8ad" href="../../../R/dde861de25cbe8ad.html" target="n" data-glyph="104,1" class="i property">CanDisconnect</a>
        {
            <b>get</b>
            {
                <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r233 rd" class="r233 r">remoteRS</span> = <a href="#08647015a50a05bd" class="i property">Runspace</a> <b>as</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                <b>return</b> <span class="r233 r">remoteRS</span> != <b>null</b> &amp;&amp; <span class="r233 r">remoteRS</span>.<a href="remoterunspace.cs.html#0dd004643a4ef610" class="i property">CanDisconnect</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IJobDebugger
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job Debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="45d43e22ad9c0b9f" href="../../../R/45d43e22ad9c0b9f.html" target="n" data-glyph="102,1" class="i property">Debugger</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#4b1042a70c3da57b" class="i field">_jobDebugger</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
                    {
                        <b>if</b> ((<a href="#4b1042a70c3da57b" class="i field">_jobDebugger</a> == <b>null</b>) &amp;&amp;
                            (<a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> != <b>null</b>))
                        {
                            <a href="#4b1042a70c3da57b" class="i field">_jobDebugger</a> = <b>new</b> <a href="#ac3c5b0bbe806cf1" class="t constructor">RemotingJobDebugger</a>(<a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>, <a href="#08647015a50a05bd" class="i property">Runspace</a>, <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#6332c7ef857bb146" class="i property">Name</a>);
                        }
                    }
                }
 
                <b>return</b> <a href="#4b1042a70c3da57b" class="i field">_jobDebugger</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if job is synchronous and can be debugged.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="024811ad07756227" href="../../../R/024811ad07756227.html" target="n" data-glyph="102,1" class="i property">IsAsync</a>
        {
            <b>get</b> { <b>return</b> <a href="#582475946ee6f486" class="i field">_isAsync</a>; }
 
            <b>set</b> { <a href="#582475946ee6f486" class="i field">_isAsync</a> = <b>true</b>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handler which will handle output ready events of the</span>
        <span class="c">///</span><span class="c"> pipeline. The output objects are queued on to the</span>
        <span class="c">///</span><span class="c"> internal stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r234 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">the pipeline reader which raised</span>
        <span class="c">///</span><span class="c"> this event</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r235 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Information describing the ready event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="fbbb1830719743c5" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleOutputReady</a>(<b>object</b> <span id="r234 rd" class="r234 r">sender</span>, <span class="i">EventArgs</span> <span id="r235 rd" class="r235 r">eventArgs</span>)
        {
            <a href="../../../utils/ObjectReader.cs.html#e7b370fd04a9d878" class="t t">PSDataCollectionPipelineReader</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>, <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r236 rd" class="r236 r">reader</span> =
                    <span class="r234 r">sender</span> <b>as</b> <a href="../../../utils/ObjectReader.cs.html#e7b370fd04a9d878" class="t t">PSDataCollectionPipelineReader</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>, <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;;
 
            <span class="i">Collection</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r237 rd" class="r237 r">output</span> = <span class="r236 r">reader</span>.<a href="../../../utils/ObjectReader.cs.html#eacc994b76ebbe24" class="i method">NonBlockingRead</a>();
 
            <b>foreach</b> (<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r238 rd" class="r238 r">dataObject</span> <b>in</b> <span class="r237 r">output</span>)
            {
                <span class="c">// attach origin information only if it doesn&#39;t exist</span>
                <span class="c">// in case of a second-hop scenario, the origin information</span>
                <span class="c">// will already be added at the second hop machine</span>
                <b>if</b> (<span class="r238 r">dataObject</span> != <b>null</b>)
                {
                    <span class="c">// if the server has already added some properties, which we do not</span>
                    <span class="c">// want to trust, we simply replace them with the server&#39;s</span>
                    <span class="c">// identity we know of</span>
 
                    <b>if</b> (<span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#b64ee1a165cf4e4d" class="i field">ComputerNameNoteProperty</a>] != <b>null</b>)
                    {
                        <span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../MshMemberInfo.cs.html#52ffbbd5ebd48ac7" class="i method">Remove</a>(<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#b64ee1a165cf4e4d" class="i field">ComputerNameNoteProperty</a>);
                    }
 
                    <b>if</b> (<span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#283cde56f2755f0c" class="i field">RunspaceIdNoteProperty</a>] != <b>null</b>)
                    {
                        <span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../MshMemberInfo.cs.html#52ffbbd5ebd48ac7" class="i method">Remove</a>(<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#283cde56f2755f0c" class="i field">RunspaceIdNoteProperty</a>);
                    }
 
                    <span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#b64ee1a165cf4e4d" class="i field">ComputerNameNoteProperty</a>, <span class="r236 r">reader</span>.<a href="../../../utils/ObjectReader.cs.html#dd88046271547a1a" class="i property">ComputerName</a>));
                    <span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#283cde56f2755f0c" class="i field">RunspaceIdNoteProperty</a>, <span class="r236 r">reader</span>.<a href="../../../utils/ObjectReader.cs.html#cd21670d80044f03" class="i property">RunspaceId</a>));
                    <span class="c">// PSShowComputerName is present for all the objects (from remoting)..this is to allow PSComputerName to be selected.</span>
                    <span class="c">// Ex: Invoke-Command localhost,blah { gps } | select PSComputerName should work.</span>
                    <b>if</b> (<span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#63fb661fa395e3a3" class="i field">ShowComputerNameNoteProperty</a>] == <b>null</b>)
                    {
                        <a href="../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r239 rd" class="r239 r">showComputerNameNP</span> = <b>new</b> <span class="t">PSNoteProperty</span>(<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#63fb661fa395e3a3" class="i field">ShowComputerNameNoteProperty</a>, !<a href="#9b1d354270ee90df" class="i field">_hideComputerName</a>);
                        <span class="r238 r">dataObject</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r239 r">showComputerNameNP</span>);
                    }
                }
 
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#bae3ecf98f6c407d" class="i method">WriteObject</a>(<span class="r238 r">dataObject</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handler which will handle error ready events of the</span>
        <span class="c">///</span><span class="c"> pipeline. The error records are queued on to the</span>
        <span class="c">///</span><span class="c"> internal stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r240 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">the pipeline reader which raised</span>
        <span class="c">///</span><span class="c"> this event</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r241 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Information describing the ready event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="6e6f70ecd6096de5" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleErrorReady</a>(<b>object</b> <span id="r240 rd" class="r240 r">sender</span>, <span class="i">EventArgs</span> <span id="r241 rd" class="r241 r">eventArgs</span>)
        {
            <a href="../../../utils/ObjectReader.cs.html#e7b370fd04a9d878" class="t t">PSDataCollectionPipelineReader</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>, <b>object</b>&gt; <span id="r242 rd" class="r242 r">reader</span> =
                <span class="r240 r">sender</span> <b>as</b> <a href="../../../utils/ObjectReader.cs.html#e7b370fd04a9d878" class="t t">PSDataCollectionPipelineReader</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>, <b>object</b>&gt;;
 
            <span class="i">Collection</span>&lt;<b>object</b>&gt; <span id="r243 rd" class="r243 r">error</span> = <span class="r242 r">reader</span>.<a href="../../../utils/ObjectReader.cs.html#eacc994b76ebbe24" class="i method">NonBlockingRead</a>();
 
            <b>foreach</b> (<b>object</b> <span id="r244 rd" class="r244 r">errorData</span> <b>in</b> <span class="r243 r">error</span>)
            {
                <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r245 rd" class="r245 r">er</span> = <span class="r244 r">errorData</span> <b>as</b> <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>;
                <b>if</b> (<span class="r245 r">er</span> != <b>null</b>)
                {
                    <a href="RemotingErrorRecord.cs.html#d35b80d1e8544bca" class="t t">OriginInfo</a> <span id="r246 rd" class="r246 r">originInfo</span> = <b>new</b> <a href="RemotingErrorRecord.cs.html#7cf40752461163ee" class="t constructor">OriginInfo</a>(<span class="r242 r">reader</span>.<a href="../../../utils/ObjectReader.cs.html#dd88046271547a1a" class="i property">ComputerName</a>, <span class="r242 r">reader</span>.<a href="../../../utils/ObjectReader.cs.html#cd21670d80044f03" class="i property">RunspaceId</a>);
 
                    <a href="RemotingErrorRecord.cs.html#6c773c1aec04d13e" class="t t">RemotingErrorRecord</a> <span id="r247 rd" class="r247 r">errorRecord</span> =
                        <b>new</b> <a href="RemotingErrorRecord.cs.html#8a136e54d763669f" class="t constructor">RemotingErrorRecord</a>(<span class="r245 r">er</span>, <span class="r246 r">originInfo</span>);
                    <span class="r247 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#b119c9996bde5b66" class="i property">PreserveInvocationInfoOnce</a> = <b>true</b>;
 
                    <span class="c">// ISSUE: Add an Assert for ErrorRecord.</span>
                    <span class="c">// Add to the PSRemotingChild jobs streams</span>
                    <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#f1efa785e9495a67" class="i method">WriteError</a>(<span class="r247 r">errorRecord</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When the client remote session reports a URI redirection, this method will report the</span>
        <span class="c">///</span><span class="c"> message to the user as a Warning using Host method calls.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r248 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r249 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="79846dde5ce8d9a9" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">HandleURIDirectionReported</a>(<b>object</b> <span id="r248 rd" class="r248 r">sender</span>, <a href="../common/misc.cs.html#16d1e16a7ed9f8cc" class="t t">RemoteDataEventArgs</a>&lt;<span class="i">Uri</span>&gt; <span id="r249 rd" class="r249 r">eventArgs</span>)
        {
            <b>string</b> <span id="r250 rd" class="r250 r">message</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">URIRedirectWarningToHost</span>, <span class="r249 r">eventArgs</span>.<a href="../common/misc.cs.html#0896dbbd394ce2e6" class="i property">Data</a>.<span class="i">OriginalString</span>);
            <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#e10d3e6d4bddf65f" class="i method">WriteWarning</a>(<span class="r250 r">message</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle method executor stream events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r251 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The sender.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r252 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The event args.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4f16df36f294194e" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleHostCalls</a>(<b>object</b> <span id="r251 rd" class="r251 r">sender</span>, <span class="i">EventArgs</span> <span id="r252 rd" class="r252 r">eventArgs</span>)
        {
            <a href="../../../utils/ObjectStream.cs.html#247cf7c4c5dec5a4" class="t t">ObjectStream</a> <span id="r253 rd" class="r253 r">hostCallsStream</span> = <span class="r251 r">sender</span> <b>as</b> <a href="../../../utils/ObjectStream.cs.html#247cf7c4c5dec5a4" class="t t">ObjectStream</a>;
 
            <b>if</b> (<span class="r253 r">hostCallsStream</span> != <b>null</b>)
            {
                <span class="i">Collection</span>&lt;<b>object</b>&gt; <span id="r254 rd" class="r254 r">hostCallMethodExecutors</span> =
                    <span class="r253 r">hostCallsStream</span>.<a href="../../../utils/ObjectStream.cs.html#d427df41689c67c8" class="i method">NonBlockingRead</a>(<span class="r253 r">hostCallsStream</span>.<a href="../../../utils/ObjectStream.cs.html#b5624cc19833edff" class="i property">Count</a>);
 
                <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
                {
                    <b>foreach</b> (<a href="ClientMethodExecutor.cs.html#6caf7f9a511e4a89" class="t t">ClientMethodExecutor</a> <span id="r255 rd" class="r255 r">hostCallMethodExecutor</span> <b>in</b> <span class="r254 r">hostCallMethodExecutors</span>)
                    {
                        <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#8f6aab2eba59bf6b" class="i field">MethodExecutor</a>, <span class="r255 r">hostCallMethodExecutor</span>));
 
                        <span class="c">// if the call id of the underlying remote host call is not ServerDispatchTable.VoidCallId</span>
                        <span class="c">// then the call is waiting on user input. Change state to Blocked</span>
                        <b>if</b> (<span class="r255 r">hostCallMethodExecutor</span>.<a href="ClientMethodExecutor.cs.html#33dec854ccf65195" class="i property">RemoteHostCall</a>.<a href="../common/WireDataFormat/RemoteHost.cs.html#ed3a8d27765a7622" class="i property">CallId</a> != <a href="../common/DispatchTable.cs.html#94d3b488e4e40b16" class="t t">ServerDispatchTable</a>.<a href="../common/DispatchTable.cs.html#7f54015985f8241e" class="i field">VoidCallId</a>)
                        {
                            <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>, <b>null</b>);
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle changes in pipeline states.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r256 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r257 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="e288ed37cbf9a6d3" href="../../../R/e288ed37cbf9a6d3.html" target="n" data-glyph="75,1" class="i method">HandlePipelineStateChanged</a>(<b>object</b> <span id="r256 rd" class="r256 r">sender</span>, <a href="../../hostifaces/Pipeline.cs.html#f088a79047187694" class="t t">PipelineStateEventArgs</a> <span id="r257 rd" class="r257 r">e</span>)
        {
            <b>if</b> ((<a href="#08647015a50a05bd" class="i property">Runspace</a> != <b>null</b>) &amp;&amp; (<span class="r257 r">e</span>.<a href="../../hostifaces/Pipeline.cs.html#90fde3748e993197" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> != <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>))
            {
                <span class="c">// since we got state changed event..we dont need to listen on</span>
                <span class="c">// URI redirections anymore</span>
                ((<a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>)<a href="#08647015a50a05bd" class="i property">Runspace</a>).<a href="remoterunspace.cs.html#f21dad86b0e2d67e" class="i">URIRedirectionReported</a> -= <span class="i">HandleURIDirectionReported</span>;
            }
 
            <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r258 rd" class="r258 r">state</span> = <span class="r257 r">e</span>.<a href="../../hostifaces/Pipeline.cs.html#90fde3748e993197" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a>;
            <b>switch</b> (<span class="r258 r">state</span>)
            {
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                    <b>if</b> (<a href="#ffbfaa3edeb24ae7" class="i property">DisconnectedAndBlocked</a>)
                    {
                        <a href="#ffbfaa3edeb24ae7" class="i property">DisconnectedAndBlocked</a> = <b>false</b>;
                        <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>);
                    }
                    <b>else</b>
                    {
                        <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>);
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>:
                    <a href="#ffbfaa3edeb24ae7" class="i property">DisconnectedAndBlocked</a> = (<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>);
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>);
                    <b>break</b>;
            }
 
            <span class="c">// Question: Why is the DoFinish() call on terminal pipeline state deleted</span>
            <span class="c">// Answer: Because in the runspace case, when pipeline reaches a terminal state</span>
            <span class="c">// OperationComplete will be raised and DoFinish() is called on OperationComplete</span>
            <span class="c">// In the computer name case, once pipeline reaches a terminal state, runspace is</span>
            <span class="c">// closed which will result in an OperationComplete event</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle a throttle complete event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r259 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender of this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r260 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Not used in this method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="192f824141275313" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleThrottleComplete</a>(<b>object</b> <span id="r259 rd" class="r259 r">sender</span>, <span class="i">EventArgs</span> <span id="r260 rd" class="r260 r">eventArgs</span>)
        {
            <span class="c">// Question: Why do we register for HandleThrottleComplete when we have already</span>
            <span class="c">// registered for PipelineStateChangedEvent?</span>
            <span class="c">// Answer: Because ThrottleManager at a given time can have some pipelines which are</span>
            <span class="c">// still not started. If TM.Stop() is called, then it simply discards those pipelines and</span>
            <span class="c">// PipelineStateChangedEvent is not called for them. For such jobs, we depend on</span>
            <span class="c">// HandleThrottleComplete to mark the finish of job.</span>
 
            <span class="c">// Question: So it is possible in some cases DoFinish can be called twice.</span>
            <span class="c">// Answer: Yes: One from PipelineStateChangedEvent and Another here. But</span>
            <span class="c">// DoFinish has logic to check if it has been already called and second call</span>
            <span class="c">// becomes noOp.</span>
            <a href="#d9bf570e34b051c2" class="i method">DoFinish</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle the operation complete event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender of this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r262 r">stateEventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Operation complete event args.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="5fcf1edfa748610f" href="../../../R/5fcf1edfa748610f.html" target="n" data-glyph="75,1" class="i method">HandleOperationComplete</a>(<b>object</b> <span id="r261 rd" class="r261 r">sender</span>, <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r262 rd" class="r262 r">stateEventArgs</span>)
        {
            <span class="c">// Question:Why are we registering for OperationComplete if we already</span>
            <span class="c">// registering for StateChangedEvent and ThrottleComplete event</span>
            <span class="c">// Answer:Because in case of computer, if Runspace.Open it self fails,</span>
            <span class="c">// no pipeline is created and no pipeline state changed event is raised.</span>
            <span class="c">// We can wait for throttle complete, but it is raised only when all the</span>
            <span class="c">// operations are completed and this means that status of job is not updated</span>
            <span class="c">// untill Operation Complete.</span>
            <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r263 rd" class="r263 r">helper</span> = <span class="r261 r">sender</span> <b>as</b> <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>;
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r263 r">helper</span> != <b>null</b>, <span class="s">&quot;Sender of OperationComplete has to be ExecutionCmdletHelper&quot;</span>);
 
            <a href="#d88f8869319cca36" class="i method">DeterminedAndSetJobState</a>(<span class="r263 r">helper</span>);
        }
 
        <b>private bool</b> <a id="6566dc20e84e6e9c" href="../../../R/6566dc20e84e6e9c.html" target="n" data-glyph="46,1" class="i field">_doFinishCalled</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method marks the completion state for Job. Also if job failed, it processes the</span>
        <span class="c">///</span><span class="c"> reason of failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="d9bf570e34b051c2" href="../../../R/d9bf570e34b051c2.html" target="n" data-glyph="75,1" class="i method">DoFinish</a>()
        {
            <b>if</b> (<a href="#6566dc20e84e6e9c" class="i field">_doFinishCalled</a>)
                <b>return</b>;
 
            <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
            {
                <b>if</b> (<a href="#6566dc20e84e6e9c" class="i field">_doFinishCalled</a>)
                    <b>return</b>;
 
                <a href="#6566dc20e84e6e9c" class="i field">_doFinishCalled</a> = <b>true</b>;
            }
 
            <a href="#d88f8869319cca36" class="i method">DeterminedAndSetJobState</a>(<a href="#ded04bc1d30f6e94" class="i property">Helper</a>);
 
            <a href="#9958cce461f74195" class="i method">DoCleanupOnFinished</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the pretty formated error record associated with the reason of failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="883d7c010a27119d" href="../../../R/883d7c010a27119d.html" target="n" data-glyph="46,1" class="i field">_failureErrorRecord</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the pretty formated error record associated with the reason of failure.</span>
        <span class="c">///</span><span class="c"> This is set if Job state is Failed and Reason has a exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="b82370f19db56028" href="../../../R/b82370f19db56028.html" target="n" data-glyph="104,1" class="i property">FailureErrorRecord</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#883d7c010a27119d" class="i field">_failureErrorRecord</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process the exceptions to decide reason for job failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r264 r">helper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r265 r">failureException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r266 r">failureErrorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="3f99aa1651cfdfd9" href="../../../R/3f99aa1651cfdfd9.html" target="n" data-glyph="75,1" class="i method">ProcessJobFailure</a>(<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r264 rd" class="r264 r">helper</span>, <b>out</b> <span class="i">Exception</span> <span id="r265 rd" class="r265 r">failureException</span>,
                            <b>out</b> <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r266 rd" class="r266 r">failureErrorRecord</span>)
        {
            <span class="c">//      There are three errors possible</span>
            <span class="c">//      1. The remote runspace is in (or went into) a</span>
            <span class="c">//         broken state. This information is available</span>
            <span class="c">//         in the runspace state information</span>
            <span class="c">//      2. The remote pipeline failed because of an</span>
            <span class="c">//         exception. This information is available</span>
            <span class="c">//         in the pipeline state information</span>
            <span class="c">//      3. Runspace.OpenAsync or Pipeline.InvokeAsync threw exception</span>
            <span class="c">//         They are in Helper.InternalException</span>
 
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r264 r">helper</span> != <b>null</b>, <span class="s">&quot;helper is null&quot;</span>);
 
            <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r267 rd" class="r267 r">pipeline</span> = <span class="r264 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a> <b>as</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>;
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r267 r">pipeline</span> != <b>null</b>, <span class="s">&quot;pipeline is null&quot;</span>);
 
            <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r268 rd" class="r268 r">runspace</span> = <span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#7238bed80a1fe41f" class="i method">GetRunspace</a>() <b>as</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r268 r">runspace</span> != <b>null</b>, <span class="s">&quot;runspace is null&quot;</span>);
 
            <span class="r265 r">failureException</span> = <b>null</b>;
            <span class="r266 r">failureErrorRecord</span> = <b>null</b>;
 
            <b>if</b> (<span class="r264 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#898693983c97b181" class="i property">InternalException</a> != <b>null</b>)
            {
                <b>string</b> <span id="r269 rd" class="r269 r">errorId</span> = <span class="s">&quot;RemotePipelineExecutionFailed&quot;</span>;
                <span class="r265 r">failureException</span> = <span class="r264 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#898693983c97b181" class="i property">InternalException</a>;
                <b>if</b> ((<span class="r265 r">failureException</span> <b>is</b> <a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a>) || (<span class="r265 r">failureException</span> <b>is</b> <a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a>))
                {
                    <span class="r269 r">errorId</span> = <span class="s">&quot;InvalidSessionState&quot;</span>;
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r265 r">failureException</span>.<span class="i">Source</span>))
                    {
                        <span class="r269 r">errorId</span> = <b>string</b>.<span class="i">Format</span>(<span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                            <span class="s">&quot;{0},{1}&quot;</span>, <span class="r269 r">errorId</span>, <span class="r265 r">failureException</span>.<span class="i">Source</span>);
                    }
                }
 
                <span class="r266 r">failureErrorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r264 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#898693983c97b181" class="i property">InternalException</a>,
                       <span class="r269 r">errorId</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#9aa2436d61de1f73" class="i field">OperationStopped</a>,
                            <span class="r264 r">helper</span>);
            }
            <span class="c">// there is a failure reason available in the runspace</span>
            <b>else</b> <b>if</b> ((<span class="r268 r">runspace</span>.<a href="remoterunspace.cs.html#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a>) ||
                     (<span class="r268 r">runspace</span>.<a href="remoterunspace.cs.html#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#c342411ef74d93be" class="i property">Reason</a> != <b>null</b>))
            {
                <span class="r265 r">failureException</span> = <span class="r268 r">runspace</span>.<a href="remoterunspace.cs.html#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#c342411ef74d93be" class="i property">Reason</a>;
                <b>object</b> <span id="r270 rd" class="r270 r">targetObject</span> = <span class="r268 r">runspace</span>.<a href="remoterunspace.cs.html#912a4002c4156bbf" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a>;
 
                <b>string</b> <span id="r271 rd" class="r271 r">errorDetails</span> = <b>null</b>;
 
                <span class="c">// set the transport message in the error detail so that</span>
                <span class="c">// the user can directly get to see the message without</span>
                <span class="c">// having to mine through the error record details</span>
                <a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a> <span id="r272 rd" class="r272 r">transException</span> =
                            <span class="r265 r">failureException</span> <b>as</b> <a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a>;
 
                <b>string</b> <span id="r273 rd" class="r273 r">fullyQualifiedErrorId</span> =
                    <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/WSManTransportManager.cs.html#b4291df75d9bc408" class="t t">WSManTransportManagerUtils</a>.<a href="../fanin/WSManTransportManager.cs.html#d3bf2dfca72ae399" class="i method">GetFQEIDFromTransportError</a>(
                        (<span class="r272 r">transException</span> != <b>null</b>) ? <span class="r272 r">transException</span>.<a href="../common/remotingexceptions.cs.html#f96218464c4b7244" class="i property">ErrorCode</a> : 0,
                        <span class="s">&quot;PSSessionStateBroken&quot;</span>);
 
                <b>if</b> (<span class="r272 r">transException</span> != <b>null</b>)
                {
                    <span class="r271 r">errorDetails</span> = <span class="s">&quot;[&quot;</span> + <span class="r268 r">runspace</span>.<a href="remoterunspace.cs.html#912a4002c4156bbf" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a> + <span class="s">&quot;] &quot;</span>;
 
                    <b>if</b> (<span class="r272 r">transException</span>.<a href="../common/remotingexceptions.cs.html#f96218464c4b7244" class="i property">ErrorCode</a> ==
                        <span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#325ee0cf8be4313d" class="i field">ERROR_WSMAN_REDIRECT_REQUESTED</a>)
                    {
                        <span class="c">// Handling a special case for redirection..we should talk about</span>
                        <span class="c">// AllowRedirection parameter and WSManMaxRedirectionCount preference</span>
                        <span class="c">// variables</span>
                        <b>string</b> <span id="r274 rd" class="r274 r">message</span> = <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                            <span class="i">RemotingErrorIdStrings</span>.<span class="i">URIRedirectionReported</span>,
                            <span class="r272 r">transException</span>.<span class="i">Message</span>,
                            <span class="s">&quot;MaximumConnectionRedirectionCount&quot;</span>,
                            <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<a href="../commands/PSRemotingCmdlet.cs.html#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="../commands/PSRemotingCmdlet.cs.html#079ce7151f202fe2" class="i field">DEFAULT_SESSION_OPTION</a>,
                            <span class="s">&quot;AllowRedirection&quot;</span>);
 
                        <span class="r271 r">errorDetails</span> += <span class="r274 r">message</span>;
                    }
                    <b>else</b> <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r272 r">transException</span>.<span class="i">Message</span>))
                    {
                        <span class="r271 r">errorDetails</span> += <span class="r272 r">transException</span>.<span class="i">Message</span>;
                    }
                    <b>else</b> <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r272 r">transException</span>.<a href="../common/remotingexceptions.cs.html#9008a0cafbbfa4d3" class="i property">TransportMessage</a>))
                    {
                        <span class="r271 r">errorDetails</span> += <span class="r272 r">transException</span>.<a href="../common/remotingexceptions.cs.html#9008a0cafbbfa4d3" class="i property">TransportMessage</a>;
                    }
                }
 
                <b>if</b> (<span class="r265 r">failureException</span> == <b>null</b>)
                {
                    <span class="r265 r">failureException</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(
                        <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                            <span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteRunspaceOpenUnknownState</span>,
                            <span class="r268 r">runspace</span>.<a href="remoterunspace.cs.html#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>));
                }
 
                <span class="r266 r">failureErrorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#63310140b5760920" class="t constructor">ErrorRecord</a>(<span class="r265 r">failureException</span>, <span class="r270 r">targetObject</span>,
                                <span class="r273 r">fullyQualifiedErrorId</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#7650567b7604bddc" class="i field">OpenError</a>,
                                <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>, <span class="r271 r">errorDetails</span>, <b>null</b>);
            }
            <b>else</b> <b>if</b> (<span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#088450944502051f" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#425f1d8027f15e68" class="i field">Failed</a>
                || (<span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#088450944502051f" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>
                    &amp;&amp; <span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#088450944502051f" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#abf480477d10c9b4" class="i property">Reason</a> != <b>null</b>
                    &amp;&amp; <span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#088450944502051f" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#abf480477d10c9b4" class="i property">Reason</a> <b>is not</b> <a href="../../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>))
            {
                <span class="c">// Pipeline stopped state is also an error condition if the associated exception is not &#39;PipelineStoppedException&#39;.</span>
                <b>object</b> <span id="r275 rd" class="r275 r">targetObject</span> = <span class="r268 r">runspace</span>.<a href="remoterunspace.cs.html#912a4002c4156bbf" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a>;
                <span class="r265 r">failureException</span> = <span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#088450944502051f" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#abf480477d10c9b4" class="i property">Reason</a>;
                <b>if</b> (<span class="r265 r">failureException</span> != <b>null</b>)
                {
                    <a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r276 rd" class="r276 r">rException</span> = <span class="r265 r">failureException</span> <b>as</b> <a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a>;
 
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r277 rd" class="r277 r">errorRecord</span> = <b>null</b>;
                    <b>if</b> (<span class="r276 r">rException</span> != <b>null</b>)
                    {
                        <span class="r277 r">errorRecord</span> = <span class="r276 r">rException</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>;
 
                        <span class="c">// A RemoteException will hide a PipelineStoppedException, which should be ignored.</span>
                        <b>if</b> (<span class="r277 r">errorRecord</span> != <b>null</b> &amp;&amp;
                            <span class="r277 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>.<span class="i">Equals</span>(<span class="s">&quot;PipelineStopped&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="c">// PipelineStoppedException should not be reported as error.</span>
                            <span class="r265 r">failureException</span> = <b>null</b>;
                            <b>return</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// at this point, there may be no failure reason available in</span>
                        <span class="c">// the runspace because the remoting protocol</span>
                        <span class="c">// layer may not have yet assigned it to the runspace</span>
                        <span class="c">// in such a case, the remoting protocol layer would have</span>
                        <span class="c">// assigned an exception in the client end to the pipeline</span>
                        <span class="c">// create an error record from it and write it out</span>
                        <span class="r277 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#088450944502051f" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#abf480477d10c9b4" class="i property">Reason</a>,
                                                        <span class="s">&quot;JobFailure&quot;</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#9aa2436d61de1f73" class="i field">OperationStopped</a>,
                                                            <span class="r275 r">targetObject</span>);
                    }
 
                    <b>string</b> <span id="r278 rd" class="r278 r">computerName</span> = ((<a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>)<span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#7238bed80a1fe41f" class="i method">GetRunspace</a>()).<a href="remoterunspace.cs.html#912a4002c4156bbf" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a>;
                    <span class="i">Guid</span> <span id="r279 rd" class="r279 r">runspaceId</span> = <span class="r267 r">pipeline</span>.<a href="remotepipeline.cs.html#7238bed80a1fe41f" class="i method">GetRunspace</a>().<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>;
 
                    <a href="RemotingErrorRecord.cs.html#d35b80d1e8544bca" class="t t">OriginInfo</a> <span id="r280 rd" class="r280 r">originInfo</span> = <b>new</b> <a href="RemotingErrorRecord.cs.html#7cf40752461163ee" class="t constructor">OriginInfo</a>(<span class="r278 r">computerName</span>, <span class="r279 r">runspaceId</span>);
 
                    <span class="r266 r">failureErrorRecord</span> = <b>new</b> <a href="RemotingErrorRecord.cs.html#8a136e54d763669f" class="t constructor">RemotingErrorRecord</a>(<span class="r277 r">errorRecord</span>, <span class="r280 r">originInfo</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Release all the resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r281 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if true, release all the managed objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="5395a4ee03b34fa7" href="../../../R/5395a4ee03b34fa7.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r281 rd" class="r281 r">disposing</span>)
        {
            <b>if</b> (<span class="r281 r">disposing</span>)
            {
                <b>if</b> (<a href="#0e38020f37ff8160" class="i field">_isDisposed</a>)
                {
                    <b>return</b>;
                }
 
                <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
                {
                    <b>if</b> (<a href="#0e38020f37ff8160" class="i field">_isDisposed</a>)
                    {
                        <b>return</b>;
                    }
 
                    <a href="#0e38020f37ff8160" class="i field">_isDisposed</a> = <b>true</b>;
                }
 
                <b>try</b>
                {
                    <a href="#9958cce461f74195" class="i method">DoCleanupOnFinished</a>();
                }
                <b>finally</b>
                {
                    <a href="#e1ff43f6998863de" class="k">base</a>.<a href="#19b362abde0789e5" class="i method">Dispose</a>(<span class="r281 r">disposing</span>);
                }
            }
        }
 
        <b>private bool</b> <a id="0e38020f37ff8160" href="../../../R/0e38020f37ff8160.html" target="n" data-glyph="46,1" class="i field">_isDisposed</a> = <b>false</b>;
 
        <b>private bool</b> <a id="85c994ae2d9bf25a" href="../../../R/85c994ae2d9bf25a.html" target="n" data-glyph="46,1" class="i field">_cleanupDone</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cleanup after state changes to finished.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="9958cce461f74195" href="../../../R/9958cce461f74195.html" target="n" data-glyph="75,1" class="i method">DoCleanupOnFinished</a>()
        {
            <b>bool</b> <span id="r282 rd" class="r282 r">doCleanup</span> = <b>false</b>;
            <b>if</b> (!<a href="#85c994ae2d9bf25a" class="i field">_cleanupDone</a>)
            {
                <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
                {
                    <b>if</b> (!<a href="#85c994ae2d9bf25a" class="i field">_cleanupDone</a>)
                    {
                        <a href="#85c994ae2d9bf25a" class="i field">_cleanupDone</a> = <b>true</b>;
                        <span class="r282 r">doCleanup</span> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (!<span class="r282 r">doCleanup</span>) <b>return</b>;
 
            <a href="#3e6df123882459d5" class="i method">StopAggregateResultsFromHelper</a>(<a href="#ded04bc1d30f6e94" class="i property">Helper</a>);
            <a href="#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#3cd2a1e80935c2fb" class="i">AvailabilityChanged</a> -= <span class="i">HandleRunspaceAvailabilityChanged</span>;
            <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r283 rd" class="r283 r">operation</span> = <a href="#ded04bc1d30f6e94" class="i property">Helper</a> <b>as</b> <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>;
            <span class="r283 r">operation</span>.<a href="../common/throttlemanager.cs.html#d2b8440ede8b9b06" class="i">OperationComplete</a> -= <span class="i">HandleOperationComplete</span>;
            <a href="#ae1a1949e8682f44" class="i method">UnregisterThrottleComplete</a>(<a href="#516548804be81d41" class="i field">_throttleManager</a>);
            <a href="#516548804be81d41" class="i field">_throttleManager</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Aggregates results from the pipeline associated</span>
        <span class="c">///</span><span class="c"> with the specified helper.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r284 r">helper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">helper whose pipeline results</span>
        <span class="c">///</span><span class="c"> need to be aggregated</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="0f9af92314d5920a" href="../../../R/0f9af92314d5920a.html" target="n" data-glyph="75,1" class="i method">AggregateResultsFromHelper</a>(<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r284 rd" class="r284 r">helper</span>)
        {
            <span class="c">// Get the pipeline associated with this helper and register for appropriate events</span>
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r285 rd" class="r285 r">pipeline</span> = <span class="r284 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>;
            <span class="r285 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#e61d6d76ceba7ad2" class="i property">Output</a>.<a href="../../../utils/IObjectReader.cs.html#ab790c5de0e4e578" class="i">DataReady</a> += <span class="i">HandleOutputReady</span>;
            <span class="r285 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#cc6ca02e9720dc4a" class="i property">Error</a>.<a href="../../../utils/IObjectReader.cs.html#ab790c5de0e4e578" class="i">DataReady</a> += <span class="i">HandleErrorReady</span>;
            <span class="r285 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#c0baffefeaa75abd" class="i">StateChanged</a> += <span class="i">HandlePipelineStateChanged</span>;
 
            <span class="c">// Register handler for method executor object stream.</span>
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r285 r">pipeline</span> <b>is</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>, <span class="s">&quot;pipeline is RemotePipeline&quot;</span>);
            <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r286 rd" class="r286 r">remotePipeline</span> = <span class="r285 r">pipeline</span> <b>as</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>;
            <span class="r286 r">remotePipeline</span>.<a href="remotepipeline.cs.html#5d6a281a19d5de40" class="i property">MethodExecutorStream</a>.<a href="../../../utils/ObjectStream.cs.html#16ab48f9b8a043bb" class="i">DataReady</a> += <span class="i">HandleHostCalls</span>;
            <span class="r286 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#c29a7555dab6febc" class="i property">Progress</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="i">HandleProgressAdded</span>;
            <span class="r286 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#a0a7066f9b712955" class="i property">Warning</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="i">HandleWarningAdded</span>;
            <span class="r286 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#8e878317a3e80c79" class="i property">Verbose</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="i">HandleVerboseAdded</span>;
            <span class="r286 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#96bfebc26e0f381d" class="i property">Debug</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="i">HandleDebugAdded</span>;
            <span class="r286 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#afec31161428f7a7" class="i property">Information</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += <span class="i">HandleInformationAdded</span>;
 
            <span class="c">// Enable method executor stream so that host methods are queued up</span>
            <span class="c">// on it instead of being executed asynchronously when they arrive.</span>
            <span class="r286 r">remotePipeline</span>.<a href="remotepipeline.cs.html#63fb608d14323ae9" class="i property">IsMethodExecutorStreamEnabled</a> = <b>true</b>;
 
            <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r287 rd" class="r287 r">operation</span> = <span class="r284 r">helper</span> <b>as</b> <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>;
            <span class="r287 r">operation</span>.<a href="../common/throttlemanager.cs.html#d2b8440ede8b9b06" class="i">OperationComplete</a> += <span class="i">HandleOperationComplete</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline is not null, returns the pipeline&#39;s PowerShell</span>
        <span class="c">///</span><span class="c"> If it is null, then returns the PowerShell with the specified</span>
        <span class="c">///</span><span class="c"> instance Id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Remote pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r289 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance as described in event args.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PowerShell instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="8d4859fdd7ed3ec1" href="../../../R/8d4859fdd7ed3ec1.html" target="n" data-glyph="76,1" class="i method">GetPipelinePowerShell</a>(<a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r288 rd" class="r288 r">pipeline</span>, <span class="i">Guid</span> <span id="r289 rd" class="r289 r">instanceId</span>)
        {
            <b>if</b> (<span class="r288 r">pipeline</span> != <b>null</b>)
            {
                <b>return</b> <span class="r288 r">pipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>;
            }
 
            <b>return</b> <a href="#362ee7f1640ff753" class="i method">GetPowerShell</a>(<span class="r289 r">instanceId</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When a debug message is raised in the underlying PowerShell</span>
        <span class="c">///</span><span class="c"> add it to the jobs debug stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r290 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r291 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments describing this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a9ec36010fbdd501" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleDebugAdded</a>(<b>object</b> <span id="r290 rd" class="r290 r">sender</span>, <a href="../../hostifaces/PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r291 rd" class="r291 r">eventArgs</span>)
        {
            <b>int</b> <span id="r292 rd" class="r292 r">index</span> = <span class="r291 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>;
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r293 rd" class="r293 r">powershell</span> = <a href="#8d4859fdd7ed3ec1" class="i method">GetPipelinePowerShell</a>(<a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>, <span class="r291 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#86d3385322bd1ad4" class="i property">PowerShellInstanceId</a>);
 
            <b>if</b> (<span class="r293 r">powershell</span> != <b>null</b>)
            {
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#fcf5aa47c1f50562" class="i property">Debug</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r293 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#96bfebc26e0f381d" class="i property">Debug</a><a href="../../hostifaces/PSDataCollection.cs.html#0fbfd44b65c14b0d">[</a><span class="r292 r">index</span>]);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When a verbose message is raised in the underlying PowerShell</span>
        <span class="c">///</span><span class="c"> add it to the jobs verbose stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r294 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r295 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments describing this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="78b55fa151d71747" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleVerboseAdded</a>(<b>object</b> <span id="r294 rd" class="r294 r">sender</span>, <a href="../../hostifaces/PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r295 rd" class="r295 r">eventArgs</span>)
        {
            <b>int</b> <span id="r296 rd" class="r296 r">index</span> = <span class="r295 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>;
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r297 rd" class="r297 r">powershell</span> = <a href="#8d4859fdd7ed3ec1" class="i method">GetPipelinePowerShell</a>(<a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>, <span class="r295 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#86d3385322bd1ad4" class="i property">PowerShellInstanceId</a>);
 
            <b>if</b> (<span class="r297 r">powershell</span> != <b>null</b>)
            {
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#2c4a777567a6240d" class="i property">Verbose</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r297 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#8e878317a3e80c79" class="i property">Verbose</a><a href="../../hostifaces/PSDataCollection.cs.html#0fbfd44b65c14b0d">[</a><span class="r296 r">index</span>]);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When a warning message is raised in the underlying PowerShell</span>
        <span class="c">///</span><span class="c"> add it to the jobs warning stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r298 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r299 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments describing this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="07c7b58e21f8f128" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleWarningAdded</a>(<b>object</b> <span id="r298 rd" class="r298 r">sender</span>, <a href="../../hostifaces/PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r299 rd" class="r299 r">eventArgs</span>)
        {
            <b>int</b> <span id="r300 rd" class="r300 r">index</span> = <span class="r299 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>;
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r301 rd" class="r301 r">powershell</span> = <a href="#8d4859fdd7ed3ec1" class="i method">GetPipelinePowerShell</a>(<a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>, <span class="r299 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#86d3385322bd1ad4" class="i property">PowerShellInstanceId</a>);
 
            <b>if</b> (<span class="r301 r">powershell</span> != <b>null</b>)
            {
                <a href="../../hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a> <span id="r302 rd" class="r302 r">warningRecord</span> = <span class="r301 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#a0a7066f9b712955" class="i property">Warning</a><a href="../../hostifaces/PSDataCollection.cs.html#0fbfd44b65c14b0d">[</a><span class="r300 r">index</span>];
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#2271b8dbce732fb7" class="i property">Warning</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r302 r">warningRecord</span>);
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#4e47907012e4b689" class="i field">WarningRecord</a>, <span class="r302 r">warningRecord</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When a progress message is raised in the underlying PowerShell</span>
        <span class="c">///</span><span class="c"> add it to the jobs progress tream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r303 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments describing this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="32cb45d1f71268af" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleProgressAdded</a>(<b>object</b> <span id="r303 rd" class="r303 r">sender</span>, <a href="../../hostifaces/PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r304 rd" class="r304 r">eventArgs</span>)
        {
            <b>int</b> <span id="r305 rd" class="r305 r">index</span> = <span class="r304 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>;
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r306 rd" class="r306 r">powershell</span> = <a href="#8d4859fdd7ed3ec1" class="i method">GetPipelinePowerShell</a>(<a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>, <span class="r304 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#86d3385322bd1ad4" class="i property">PowerShellInstanceId</a>);
 
            <b>if</b> (<span class="r306 r">powershell</span> != <b>null</b>)
            {
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#0566bc7c986755b8" class="i property">Progress</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r306 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#c29a7555dab6febc" class="i property">Progress</a><a href="../../hostifaces/PSDataCollection.cs.html#0fbfd44b65c14b0d">[</a><span class="r305 r">index</span>]);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When a Information message is raised in the underlying PowerShell</span>
        <span class="c">///</span><span class="c"> add it to the jobs Information stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r307 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments describing this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ce40bef47d432e8f" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleInformationAdded</a>(<b>object</b> <span id="r307 rd" class="r307 r">sender</span>, <a href="../../hostifaces/PSDataCollection.cs.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r308 rd" class="r308 r">eventArgs</span>)
        {
            <b>int</b> <span id="r309 rd" class="r309 r">index</span> = <span class="r308 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#0ed8637c462f29c7" class="i property">Index</a>;
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r310 rd" class="r310 r">powershell</span> = <a href="#8d4859fdd7ed3ec1" class="i method">GetPipelinePowerShell</a>(<a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>, <span class="r308 r">eventArgs</span>.<a href="../../hostifaces/PSDataCollection.cs.html#86d3385322bd1ad4" class="i property">PowerShellInstanceId</a>);
 
            <b>if</b> (<span class="r310 r">powershell</span> != <b>null</b>)
            {
                <a href="../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r311 rd" class="r311 r">informationRecord</span> = <span class="r310 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#afec31161428f7a7" class="i property">Information</a><a href="../../hostifaces/PSDataCollection.cs.html#0fbfd44b65c14b0d">[</a><span class="r309 r">index</span>];
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#501ba88f677f8460" class="i property">Information</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<span class="r311 r">informationRecord</span>);
 
                <span class="c">// Host output is handled by the hosting APIs directly, so we need to add a tag that it was</span>
                <span class="c">// forwarded so that it is not written twice.</span>
                <span class="c">//  For all other Information records, forward them.</span>
                <b>if</b> (<span class="r311 r">informationRecord</span>.<a href="../../InformationRecord.cs.html#4fb6c3e3e60ff9d7" class="i property">Tags</a>.<span class="i">Contains</span>(<span class="s">&quot;PSHOST&quot;</span>))
                {
                    <span class="r311 r">informationRecord</span>.<a href="../../InformationRecord.cs.html#4fb6c3e3e60ff9d7" class="i property">Tags</a>.<span class="i">Add</span>(<span class="s">&quot;FORWARDED&quot;</span>);
                }
 
                <a href="#d1388b6af9650b2e" class="k">this</a>.<a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../common/psstreamobject.cs.html#7ce6eaead896f9b1" class="t constructor">PSStreamObject</a>(<a href="../common/psstreamobject.cs.html#661e2c05b778accf" class="t t">PSStreamObjectType</a>.<a href="../common/psstreamobject.cs.html#d540061bc850b342" class="i field">Information</a>, <span class="r311 r">informationRecord</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops collecting results from the pipeline associated with</span>
        <span class="c">///</span><span class="c"> the specified helper.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r312 r">helper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">helper class whose pipeline results</span>
        <span class="c">///</span><span class="c"> aggregation has to be stopped</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="3e6df123882459d5" href="../../../R/3e6df123882459d5.html" target="n" data-glyph="75,1" class="i method">StopAggregateResultsFromHelper</a>(<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r312 rd" class="r312 r">helper</span>)
        {
            <span class="c">// Get the pipeline associated with this helper and register for appropriate events</span>
            <a href="#19bb1b72f67c7895" class="i method">RemoveAggreateCallbacksFromHelper</a>(<span class="r312 r">helper</span>);
 
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r313 rd" class="r313 r">pipeline</span> = <span class="r312 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>;
            <span class="r313 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#78d9f1f80ba7c462" class="i method">Dispose</a>();
            <span class="r313 r">pipeline</span> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes aggregate callbacks from pipeline so that a new job object can</span>
        <span class="c">///</span><span class="c"> be created and can add its own callbacks.</span>
        <span class="c">///</span><span class="c"> This is to support Invoke-Command auto-disconnect where a new PSRemoting</span>
        <span class="c">///</span><span class="c"> job must be created to pass back to user for connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r314 r">helper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Helper class.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="19bb1b72f67c7895" href="../../../R/19bb1b72f67c7895.html" target="n" data-glyph="75,1" class="i method">RemoveAggreateCallbacksFromHelper</a>(<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r314 rd" class="r314 r">helper</span>)
        {
            <span class="c">// Remove old data output callbacks from pipeline so new callbacks can be added.</span>
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r315 rd" class="r315 r">pipeline</span> = <span class="r314 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>;
            <span class="r315 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#e61d6d76ceba7ad2" class="i property">Output</a>.<a href="../../../utils/IObjectReader.cs.html#ab790c5de0e4e578" class="i">DataReady</a> -= <span class="i">HandleOutputReady</span>;
            <span class="r315 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#cc6ca02e9720dc4a" class="i property">Error</a>.<a href="../../../utils/IObjectReader.cs.html#ab790c5de0e4e578" class="i">DataReady</a> -= <span class="i">HandleErrorReady</span>;
            <span class="r315 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#c0baffefeaa75abd" class="i">StateChanged</a> -= <span class="i">HandlePipelineStateChanged</span>;
 
            <span class="c">// Remove old data aggregation and host calls.</span>
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r315 r">pipeline</span> <b>is</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>, <span class="s">&quot;pipeline is RemotePipeline&quot;</span>);
            <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r316 rd" class="r316 r">remotePipeline</span> = <span class="r315 r">pipeline</span> <b>as</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>;
            <span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#5d6a281a19d5de40" class="i property">MethodExecutorStream</a>.<a href="../../../utils/ObjectStream.cs.html#16ab48f9b8a043bb" class="i">DataReady</a> -= <span class="i">HandleHostCalls</span>;
            <b>if</b> (<span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a> != <b>null</b>)
            {
                <span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#c29a7555dab6febc" class="i property">Progress</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="i">HandleProgressAdded</span>;
                <span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#a0a7066f9b712955" class="i property">Warning</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="i">HandleWarningAdded</span>;
                <span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#8e878317a3e80c79" class="i property">Verbose</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="i">HandleVerboseAdded</span>;
                <span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#96bfebc26e0f381d" class="i property">Debug</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="i">HandleDebugAdded</span>;
                <span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../../hostifaces/PowerShell.cs.html#afec31161428f7a7" class="i property">Information</a>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> -= <span class="i">HandleInformationAdded</span>;
                <span class="r316 r">remotePipeline</span>.<a href="remotepipeline.cs.html#63fb608d14323ae9" class="i property">IsMethodExecutorStreamEnabled</a> = <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Register for throttle complete from the specified</span>
        <span class="c">///</span><span class="c"> throttlemanager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r317 r">throttleManager</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="48ba2b5a84d42ee0" href="../../../R/48ba2b5a84d42ee0.html" target="n" data-glyph="75,1" class="i method">RegisterThrottleComplete</a>(<a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <span id="r317 rd" class="r317 r">throttleManager</span>)
        {
            <span class="r317 r">throttleManager</span>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> += <span class="i">HandleThrottleComplete</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unregister for throttle complete from the specified</span>
        <span class="c">///</span><span class="c"> throttle manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r318 r">throttleManager</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="ae1a1949e8682f44" href="../../../R/ae1a1949e8682f44.html" target="n" data-glyph="75,1" class="i method">UnregisterThrottleComplete</a>(<a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <span id="r318 rd" class="r318 r">throttleManager</span>)
        {
            <span class="r318 r">throttleManager</span>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> -= <span class="i">HandleThrottleComplete</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determine the current state of the job based on the underlying</span>
        <span class="c">///</span><span class="c"> pipeline state and set the state accordingly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">helper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="d88f8869319cca36" href="../../../R/d88f8869319cca36.html" target="n" data-glyph="75,1" class="i method">DeterminedAndSetJobState</a>(<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r319 rd" class="r319 r">helper</span>)
        {
            <span class="i">Exception</span> <span id="r320 rd" class="r320 r">failureException</span>;
            <span class="c">// Process the reason in case of failure.</span>
            <a href="#3f99aa1651cfdfd9" class="i method">ProcessJobFailure</a>(<span class="r319 r">helper</span>, <b>out</b> <span class="r320 r">failureException</span>, <b>out</b> <a href="#883d7c010a27119d" class="i field">_failureErrorRecord</a>);
 
            <b>if</b> (<span class="r320 r">failureException</span> != <b>null</b>)
            {
                <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#4d2acd22ba4f0da9" class="i field">Failed</a>, <span class="r320 r">failureException</span>);
            }
            <b>else</b>
            {
                <span class="c">// Get the state of the pipeline</span>
                <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r321 rd" class="r321 r">state</span> = <span class="r319 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a>;
                <b>if</b> (<span class="r321 r">state</span> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>)
                {
                    <span class="c">// This is a case in which pipeline was not started and TM.Stop was</span>
                    <span class="c">// called. See comment in HandleThrottleComplete</span>
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#223c91574b18631a" class="i field">Stopped</a>);
                }
                <b>else</b> <b>if</b> (<span class="r321 r">state</span> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>)
                {
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#db36b340edc064ae" class="i field">Completed</a>);
                }
                <b>else</b>
                {
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#223c91574b18631a" class="i field">Stopped</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set the state of the current job from blocked to</span>
        <span class="c">///</span><span class="c"> running and raise an event indicating to this</span>
        <span class="c">///</span><span class="c"> parent job that this job is unblocked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b4817be72ea6932b" href="../../../R/b4817be72ea6932b.html" target="n" data-glyph="74,1" class="i method">UnblockJob</a>()
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#d73e45c1ea393a18" class="i field">Blocked</a>,
                <span class="s">&quot;Current state of job must be blocked before it can be unblocked&quot;</span>);
 
            <a href="#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>, <b>null</b>);
 
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#fc97382bec536f59" class="i">JobUnblocked</a> != <b>null</b>, <span class="s">&quot;Parent job must register for JobUnblocked event from all child jobs&quot;</span>);
            <a href="#fc97382bec536f59" class="i">JobUnblocked</a>.<span class="i">SafeInvoke</span>(<a href="#d1388b6af9650b2e" class="k">this</a>, <span class="i">EventArgs</span>.<span class="i">Empty</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the PowerShell for the specified instance id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r322 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance id of powershell.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Powershell instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="362ee7f1640ff753" href="../../../R/362ee7f1640ff753.html" target="n" data-glyph="74,1" class="i method">GetPowerShell</a>(<span class="i">Guid</span> <span id="r322 rd" class="r322 r">instanceId</span>)
        {
            <span class="c">// this should be called only in the derived implementation</span>
            <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the PowerShell object associated with this remote child job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PowerShell object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="1905180c5908dffb" href="../../../R/1905180c5908dffb.html" target="n" data-glyph="74,1" class="i method">GetPowerShell</a>()
        {
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r323 rd" class="r323 r">ps</span> = <b>null</b>;
            <b>if</b> (<a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a> != <b>null</b>)
            {
                <span class="r323 r">ps</span> = <a href="#88b2c5b073dd9f4b" class="i field">_remotePipeline</a>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>;
            }
 
            <b>return</b> <span class="r323 r">ps</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Monitor runspace availability and if it goes to RemoteDebug then set</span>
        <span class="c">///</span><span class="c"> job state to Debug.  Set back to Running when availability goes back to</span>
        <span class="c">///</span><span class="c"> Busy (indicating the script/command is running again).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r324 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r325 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RunspaceAvailabilityEventArgs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ae4ef6054ccce8d1" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleRunspaceAvailabilityChanged</a>(<b>object</b> <span id="r324 rd" class="r324 r">sender</span>, <a href="../../hostifaces/Connection.cs.html#cb349d0617c35bc7" class="t t">RunspaceAvailabilityEventArgs</a> <span id="r325 rd" class="r325 r">e</span>)
        {
            <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r326 rd" class="r326 r">prevAvailability</span> = <a href="#f04cad52092b0ff1" class="i field">_prevRunspaceAvailability</a>;
            <a href="#f04cad52092b0ff1" class="i field">_prevRunspaceAvailability</a> = <span class="r325 r">e</span>.<a href="../../hostifaces/Connection.cs.html#374d403c14f99b8f" class="i property">RunspaceAvailability</a>;
 
            <b>if</b> (<span class="r325 r">e</span>.<a href="../../hostifaces/Connection.cs.html#374d403c14f99b8f" class="i property">RunspaceAvailability</a> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#244d7672812dd8a9" class="i field">RemoteDebug</a>)
            {
                <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#3a538a4d2b74d6fc" class="i field">AtBreakpoint</a>);
            }
            <b>else</b> <b>if</b> ((<span class="r326 r">prevAvailability</span> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#244d7672812dd8a9" class="i field">RemoteDebug</a>) &amp;&amp;
                     (<span class="r325 r">e</span>.<a href="../../hostifaces/Connection.cs.html#374d403c14f99b8f" class="i property">RunspaceAvailability</a> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#aed194b80737a544" class="i field">Busy</a>))
            {
                <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised by this job to indicate to its parent that</span>
        <span class="c">///</span><span class="c"> its now unblocked by the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal event</b> <span class="i">EventHandler</span> <a id="fc97382bec536f59" href="../../../R/fc97382bec536f59.html" target="n" data-glyph="32,1" class="i">JobUnblocked</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <span class="c">// helper associated with this job object</span>
        <b>private readonly</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <a id="88b2c5b073dd9f4b" href="../../../R/88b2c5b073dd9f4b.html" target="n" data-glyph="46,1" class="i field">_remotePipeline</a> = <b>null</b>;
 
        <span class="c">// object used for synchronization</span>
        <b>protected object</b> <a id="68c550aa08e5d25f" href="../../../R/68c550aa08e5d25f.html" target="n" data-glyph="45,1" class="i field">SyncObject</a> = <b>new</b> <b>object</b>();
 
        <b>private</b> <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <a id="516548804be81d41" href="../../../R/516548804be81d41.html" target="n" data-glyph="46,1" class="i field">_throttleManager</a>;
        <b>private bool</b> <a id="6ea8b1d2c2f95fb9" href="../../../R/6ea8b1d2c2f95fb9.html" target="n" data-glyph="46,1" class="i field">_stopIsCalled</a> = <b>false</b>;
 
        <b>private volatile</b> <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="4b1042a70c3da57b" href="../../../R/4b1042a70c3da57b.html" target="n" data-glyph="46,1" class="i field">_jobDebugger</a>;
 
        <b>private bool</b> <a id="582475946ee6f486" href="../../../R/582475946ee6f486.html" target="n" data-glyph="46,1" class="i field">_isAsync</a> = <b>true</b>;
 
        <b>private</b> <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <a id="f04cad52092b0ff1" href="../../../R/f04cad52092b0ff1.html" target="n" data-glyph="46,1" class="i field">_prevRunspaceAvailability</a> = <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#a5172055c7a11352" class="i field">None</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is a debugger wrapper class used to allow debugging of</span>
    <span class="c">///</span><span class="c"> remoting jobs that implement the IJobDebugger interface.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="2ad6213302b234f5" href="../../../R/2ad6213302b234f5.html" target="n" data-glyph="2,0" class="t t">RemotingJobDebugger</a> : <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Members
 
        <b>private readonly</b> <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="6846b581c4b5bc48" href="../../../R/6846b581c4b5bc48.html" target="n" data-glyph="46,1" class="i field">_wrappedDebugger</a>;
        <b>private readonly</b> <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="a87b730143258efd" href="../../../R/a87b730143258efd.html" target="n" data-glyph="46,1" class="i field">_runspace</a>;
        <b>private readonly string</b> <a id="cbd232fc7896675f" href="../../../R/cbd232fc7896675f.html" target="n" data-glyph="46,1" class="i field">_jobName</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <b>private</b> <a id="fb2b4001fb693c71" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">RemotingJobDebugger</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r327 r">debugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debugger to wrap.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r328 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r329 r">jobName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of associated job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="ac3c5b0bbe806cf1" href="../../../R/ac3c5b0bbe806cf1.html" target="n" data-glyph="72,1" class="t constructor">RemotingJobDebugger</a>(
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r327 rd" class="r327 r">debugger</span>,
            <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r328 rd" class="r328 r">runspace</span>,
            <b>string</b> <span id="r329 rd" class="r329 r">jobName</span>)
        {
            <b>if</b> (<span class="r327 r">debugger</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r327 r">debugger</span>));
            }
 
            <b>if</b> (<span class="r328 r">runspace</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r328 r">runspace</span>));
            }
 
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a> = <span class="r327 r">debugger</span>;
            <a href="#a87b730143258efd" class="i field">_runspace</a> = <span class="r328 r">runspace</span>;
            <a href="#cbd232fc7896675f" class="i field">_jobName</a> = <span class="r329 r">jobName</span> ?? <b>string</b>.<span class="i">Empty</span>;
 
            <span class="c">// Create handlers for wrapped debugger events.</span>
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#373cb831745ae38e" class="i">BreakpointUpdated</a> += <span class="i">HandleBreakpointUpdated</span>;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#4cf8436684b1ce9c" class="i">DebuggerStop</a> += <span class="i">HandleDebuggerStop</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Debugger overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Evaluates provided command either as a debugger specific command</span>
        <span class="c">///</span><span class="c"> or a PowerShell command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r330 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r331 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommandResults.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="a3cda687cc603500" href="../../../R/a3cda687cc603500.html" target="n" data-glyph="72,1" class="i method">ProcessCommand</a>(<a href="../../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r330 rd" class="r330 r">command</span>, <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r331 rd" class="r331 r">output</span>)
        {
            <span class="c">// Special handling for the prompt command.</span>
            <b>if</b> (<span class="r330 r">command</span>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>.<span class="i">Trim</span>().<span class="i">Equals</span>(<span class="s">&quot;prompt&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <a href="#b9fd7e33cf28cb44" class="i method">HandlePromptCommand</a>(<span class="r331 r">output</span>);
            }
 
            <b>return</b> <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#f752da7b39207812" class="i method">ProcessCommand</a>(<span class="r330 r">command</span>, <span class="r331 r">output</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided set of breakpoints to the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r332 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Breakpoints to set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r333 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="f753cd3d1827dd82" href="../../../R/f753cd3d1827dd82.html" target="n" data-glyph="72,1" class="i method">SetBreakpoints</a>(<span class="i">IEnumerable</span>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r332 rd" class="r332 r">breakpoints</span>, <b>int</b>? <span id="r333 rd" class="r333 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#843320f23c8b6ab7" class="i method">SetBreakpoints</a>(<span class="r332 r">breakpoints</span>, <span class="r333 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a breakpoint by id, primarily for Enable/Disable/Remove-PSBreakpoint cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r334 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r335 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A a breakpoint with the specified id.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="73b0e486518652a8" href="../../../R/73b0e486518652a8.html" target="n" data-glyph="72,1" class="i method">GetBreakpoint</a>(<b>int</b> <span id="r334 rd" class="r334 r">id</span>, <b>int</b>? <span id="r335 rd" class="r335 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#b6e003b1e66c5826" class="i method">GetBreakpoint</a>(<span class="r334 r">id</span>, <span class="r335 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns breakpoints on a runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r336 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A list of breakpoints in a runspace.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="bf033f31a0c57eb5" href="../../../R/bf033f31a0c57eb5.html" target="n" data-glyph="72,1" class="i method">GetBreakpoints</a>(<b>int</b>? <span id="r336 rd" class="r336 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#bece37496a1551b3" class="i method">GetBreakpoints</a>(<span class="r336 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a command breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r337 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r338 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r339 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the command is invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r340 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="fe5e9d11268386c8" href="../../../R/fe5e9d11268386c8.html" target="n" data-glyph="72,1" class="i method">SetCommandBreakpoint</a>(<b>string</b> <span id="r337 rd" class="r337 r">command</span>, <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r338 rd" class="r338 r">action</span>, <b>string</b> <span id="r339 rd" class="r339 r">path</span>, <b>int</b>? <span id="r340 rd" class="r340 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#770250464b312a9d" class="i method">SetCommandBreakpoint</a>(<span class="r337 r">command</span>, <span class="r338 r">action</span>, <span class="r339 r">path</span>, <span class="r340 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a line breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r341 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r342 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line in the script file where the breakpoint may be hit. This value must be greater than or equal to 1.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r343 r">column</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column in the script file where the breakpoint may be hit. If 0, the breakpoint will trigger on any statement on the line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r344 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r345 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The line breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="f27189ac3880cd00" href="../../../R/f27189ac3880cd00.html" target="n" data-glyph="72,1" class="i method">SetLineBreakpoint</a>(<b>string</b> <span id="r341 rd" class="r341 r">path</span>, <b>int</b> <span id="r342 rd" class="r342 r">line</span>, <b>int</b> <span id="r343 rd" class="r343 r">column</span>, <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r344 rd" class="r344 r">action</span>, <b>int</b>? <span id="r345 rd" class="r345 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#76c772e72e8f9e60" class="i method">SetLineBreakpoint</a>(<span class="r341 r">path</span>, <span class="r342 r">line</span>, <span class="r343 r">column</span>, <span class="r344 r">action</span>, <span class="r345 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r346 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r347 r">accessMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable access mode that will trigger the breakpoint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r348 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r349 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the variable is accessed using the specified access mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r350 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The variable breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="ed13718778c39f60" href="../../../R/ed13718778c39f60.html" target="n" data-glyph="72,1" class="i method">SetVariableBreakpoint</a>(<b>string</b> <span id="r346 rd" class="r346 r">variableName</span>, <a href="../../debugger/Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a> <span id="r347 rd" class="r347 r">accessMode</span>, <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r348 rd" class="r348 r">action</span>, <b>string</b> <span id="r349 rd" class="r349 r">path</span>, <b>int</b>? <span id="r350 rd" class="r350 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#9563c4fb2f0b68d1" class="i method">SetVariableBreakpoint</a>(<span class="r346 r">variableName</span>, <span class="r347 r">accessMode</span>, <span class="r348 r">action</span>, <span class="r349 r">path</span>, <span class="r350 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a breakpoint from the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r351 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to remove from the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r352 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the breakpoint was removed from the debugger; false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="4bdb5f34502e3f72" href="../../../R/4bdb5f34502e3f72.html" target="n" data-glyph="72,1" class="i method">RemoveBreakpoint</a>(<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r351 rd" class="r351 r">breakpoint</span>, <b>int</b>? <span id="r352 rd" class="r352 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#7137c8a1ec351631" class="i method">RemoveBreakpoint</a>(<span class="r351 r">breakpoint</span>, <span class="r352 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r353 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r354 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="ad74301d9dd42bc4" href="../../../R/ad74301d9dd42bc4.html" target="n" data-glyph="72,1" class="i method">EnableBreakpoint</a>(<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r353 rd" class="r353 r">breakpoint</span>, <b>int</b>? <span id="r354 rd" class="r354 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#670aef2cabe5355b" class="i method">EnableBreakpoint</a>(<span class="r353 r">breakpoint</span>, <span class="r354 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r355 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r356 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="8c19ad082d6d36a9" href="../../../R/8c19ad082d6d36a9.html" target="n" data-glyph="72,1" class="i method">DisableBreakpoint</a>(<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r355 rd" class="r355 r">breakpoint</span>, <b>int</b>? <span id="r356 rd" class="r356 r">runspaceId</span>) =&gt;
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#a7be3be2de328046" class="i method">DisableBreakpoint</a>(<span class="r355 r">breakpoint</span>, <span class="r356 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the debugger resume action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r357 r">resumeAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DebuggerResumeAction.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="70d50b0eaa7f9e10" href="../../../R/70d50b0eaa7f9e10.html" target="n" data-glyph="72,1" class="i method">SetDebuggerAction</a>(<a href="../../debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r357 rd" class="r357 r">resumeAction</span>)
        {
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#63acc80e32c25892" class="i method">SetDebuggerAction</a>(<span class="r357 r">resumeAction</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops a running command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="02367e1e4cf18ca7" href="../../../R/02367e1e4cf18ca7.html" target="n" data-glyph="72,1" class="i method">StopProcessCommand</a>()
        {
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#bcb115e0eda53c00" class="i method">StopProcessCommand</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns current debugger stop event arguments if debugger is in</span>
        <span class="c">///</span><span class="c"> debug stop state.  Otherwise returns null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerStopEventArgs.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <a id="e63ba487ffbf8c89" href="../../../R/e63ba487ffbf8c89.html" target="n" data-glyph="72,1" class="i method">GetDebuggerStopArgs</a>()
        {
            <b>return</b> <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#0d780deedecb8a4a" class="i method">GetDebuggerStopArgs</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the parent debugger, breakpoints, and other debugging context information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r358 r">parent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r359 r">breakPoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of breakpoints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r360 r">startAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debugger mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r361 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell host.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r362 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="6aeb8cb8d8c9276e" href="../../../R/6aeb8cb8d8c9276e.html" target="n" data-glyph="72,1" class="i method">SetParent</a>(
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r358 rd" class="r358 r">parent</span>,
            <span class="i">IEnumerable</span>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r359 rd" class="r359 r">breakPoints</span>,
            <a href="../../debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a>? <span id="r360 rd" class="r360 r">startAction</span>,
            <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r361 rd" class="r361 r">host</span>,
            <a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a> <span id="r362 rd" class="r362 r">path</span>)
        {
            <span class="c">// For now always enable step mode debugging.</span>
            <a href="#e4f0422e5eea82ca" class="i method">SetDebuggerStepMode</a>(<b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the debugger mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="6770e9677c21cf9a" href="../../../R/6770e9677c21cf9a.html" target="n" data-glyph="72,1" class="i method">SetDebugMode</a>(<a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a> <span id="r363 rd" class="r363 r">mode</span>)
        {
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<span class="r363 r">mode</span>);
 
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">base</a>.<a href="../../debugger/debugger.cs.html#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<span class="r363 r">mode</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns IEnumerable of CallStackFrame objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">IEnumerable</span>&lt;<a href="../../debugger/debugger.cs.html#70d153384f134926" class="t t">CallStackFrame</a>&gt; <a id="830f9c17db266cd2" href="../../../R/830f9c17db266cd2.html" target="n" data-glyph="72,1" class="i method">GetCallStack</a>()
        {
            <b>return</b> <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#03b6be6c2122937e" class="i method">GetCallStack</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets debugger stepping mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r364 r">enabled</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if stepping is to be enabled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="e4f0422e5eea82ca" href="../../../R/e4f0422e5eea82ca.html" target="n" data-glyph="72,1" class="i method">SetDebuggerStepMode</a>(<b>bool</b> <span id="r364 rd" class="r364 r">enabled</span>)
        {
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<span class="r364 r">enabled</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CheckStateAndRaiseStopEvent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="032e4393cde7499c" href="../../../R/032e4393cde7499c.html" target="n" data-glyph="74,1" class="i method">CheckStateAndRaiseStopEvent</a>()
        {
            <a href="remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a> <span id="r365 rd" class="r365 r">remoteDebugger</span> = <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a> <b>as</b> <a href="remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a>;
            <b>if</b> (<span class="r365 r">remoteDebugger</span> != <b>null</b>)
            {
                <span class="r365 r">remoteDebugger</span>.<a href="remoterunspace.cs.html#7707b91fc96fac5a" class="i method">CheckStateAndRaiseStopEvent</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when debugger is stopped at a breakpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="008a3717fd1119bb" href="../../../R/008a3717fd1119bb.html" target="n" data-glyph="102,1" class="i property">InBreakpoint</a>
        {
            <b>get</b> { <b>return</b> <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#564232f4b51d11aa" class="i property">InBreakpoint</a>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private methods
 
        <b>private void</b> <a id="385976cce4d9120d" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleDebuggerStop</a>(<b>object</b> <span id="r366 rd" class="r366 r">sender</span>, <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r367 rd" class="r367 r">e</span>)
        {
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r368 rd" class="r368 r">remoteRunningCmd</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="c">// For remote debugging drain/block output channel.</span>
                <span class="r368 r">remoteRunningCmd</span> = <a href="#68703eb451e12b10" class="i method">DrainAndBlockRemoteOutput</a>();
 
                <a href="#2ad6213302b234f5" class="k">this</a>.<a href="../../debugger/debugger.cs.html#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<span class="r367 r">e</span>);
            }
            <b>finally</b>
            {
                <a href="#dab434e3c455cac5" class="i method">RestoreRemoteOutput</a>(<span class="r368 r">remoteRunningCmd</span>);
            }
        }
 
        <b>private</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="68703eb451e12b10" href="../../../R/68703eb451e12b10.html" target="n" data-glyph="76,1" class="i method">DrainAndBlockRemoteOutput</a>()
        {
            <span class="c">// We only do this for remote runspaces.</span>
            <b>if</b> (<a href="#a87b730143258efd" class="i field">_runspace</a> <b>is not</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>) { <b>return</b> <b>null</b>; }
 
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r369 rd" class="r369 r">runningCmd</span> = <a href="#a87b730143258efd" class="i field">_runspace</a>.<a href="../../hostifaces/Connection.cs.html#9db062bececf98bd" class="i method">GetCurrentlyRunningPipeline</a>();
            <b>if</b> (<span class="r369 r">runningCmd</span> != <b>null</b>)
            {
                <span class="r369 r">runningCmd</span>.<a href="../../hostifaces/Pipeline.cs.html#f60de8c84957b18a" class="i method">DrainIncomingData</a>();
                <span class="r369 r">runningCmd</span>.<a href="../../hostifaces/Pipeline.cs.html#edfe3fa78612efce" class="i method">SuspendIncomingData</a>();
 
                <b>return</b> <span class="r369 r">runningCmd</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static void</b> <a id="dab434e3c455cac5" href="../../../R/dab434e3c455cac5.html" target="n" data-glyph="76,1" class="i method">RestoreRemoteOutput</a>(<a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r370 rd" class="r370 r">runningCmd</span>)
        {
            <b>if</b> (<span class="r370 r">runningCmd</span> != <b>null</b>)
            {
                <span class="r370 r">runningCmd</span>.<a href="../../hostifaces/Pipeline.cs.html#eba54449dfca431c" class="i method">ResumeIncomingData</a>();
            }
        }
 
        <b>private void</b> <a id="aa126a4047f8e734" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleBreakpointUpdated</a>(<b>object</b> <span id="r371 rd" class="r371 r">sender</span>, <a href="../../debugger/debugger.cs.html#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a> <span id="r372 rd" class="r372 r">e</span>)
        {
            <a href="#2ad6213302b234f5" class="k">this</a>.<a href="../../debugger/debugger.cs.html#8aab7ff30ec5430c" class="i method">RaiseBreakpointUpdatedEvent</a>(<span class="r372 r">e</span>);
        }
 
        <b>private</b> <a href="../../debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="b9fd7e33cf28cb44" href="../../../R/b9fd7e33cf28cb44.html" target="n" data-glyph="76,1" class="i method">HandlePromptCommand</a>(<a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r373 rd" class="r373 r">output</span>)
        {
            <span class="c">// Nested debugged runspace prompt should look like:</span>
            <span class="c">// [DBG]: [JobName]: PS C:\&gt;&gt;</span>
            <b>string</b> <span id="r374 rd" class="r374 r">promptScript</span> = <span class="s">&quot;&#39;[DBG]: &#39;&quot;</span> + <span class="s">&quot; + &quot;</span> + <span class="s">&quot;&#39;[&quot;</span> + <a href="../../lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="../../lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#cbd232fc7896675f" class="i field">_jobName</a>) + <span class="s">&quot;]: &#39;&quot;</span> + <span class="s">&quot; + &quot;</span> + <span class="s">@&quot;&quot;&quot;PS $($executionContext.SessionState.Path.CurrentLocation)&gt;&gt; &quot;&quot;&quot;</span>;
            <a href="../../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r375 rd" class="r375 r">promptCommand</span> = <b>new</b> <a href="../../hostifaces/PSCommand.cs.html#45c724f1a0c9f07a" class="t constructor">PSCommand</a>();
            <span class="r375 r">promptCommand</span>.<a href="../../hostifaces/PSCommand.cs.html#432fcb03d95e8672" class="i method">AddScript</a>(<span class="r374 r">promptScript</span>);
            <a href="#6846b581c4b5bc48" class="i field">_wrappedDebugger</a>.<a href="../../debugger/debugger.cs.html#f752da7b39207812" class="i method">ProcessCommand</a>(<span class="r375 r">promptCommand</span>, <span class="r373 r">output</span>);
 
            <b>return</b> <b>new</b> <a href="../../debugger/debugger.cs.html#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>true</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This job is used for running as a job the results from multiple</span>
    <span class="c">///</span><span class="c"> pipelines. This is used in synchronous Invoke-Expression execution.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> TODO: I am not sure whether to change this internal to just InvokeExpressionSyncJob.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Not removing the prefix &quot;PS&quot; as this signifies powershell specific remoting job</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="60022000292afa6c" href="../../../R/60022000292afa6c.html" target="n" data-glyph="2,0" class="t t">PSInvokeExpressionSyncJob</a> : <a href="#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>&gt; <a id="ac3f4d16443a893f" href="../../../R/ac3f4d16443a893f.html" target="n" data-glyph="46,1" class="i field">_helpers</a> = <b>new</b> <span class="i">List</span>&lt;<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>&gt;();
        <b>private readonly</b> <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <a id="e9011e5f32895ff4" href="../../../R/e9011e5f32895ff4.html" target="n" data-glyph="46,1" class="i field">_throttleManager</a>;
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <a id="f3f4d18ce48a9777" href="../../../R/f3f4d18ce48a9777.html" target="n" data-glyph="46,1" class="i field">_powershells</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt;();
 
        <b>private int</b> <a id="4b967a5999f60fb4" href="../../../R/4b967a5999f60fb4.html" target="n" data-glyph="46,1" class="i field">_pipelineFinishedCount</a>;
        <b>private int</b> <a id="46d2e616c726b898" href="../../../R/46d2e616c726b898.html" target="n" data-glyph="46,1" class="i field">_pipelineDisconnectedCount</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct an invoke-expression sync job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r376 r">operations</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of operations to use.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r377 r">throttleManager</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">throttle manager to use for</span>
        <span class="c">///</span><span class="c"> this job</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="0527d32134643ec0" href="../../../R/0527d32134643ec0.html" target="n" data-glyph="74,1" class="t constructor">PSInvokeExpressionSyncJob</a>(<span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r376 rd" class="r376 r">operations</span>, <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <span id="r377 rd" class="r377 r">throttleManager</span>)
        {
            <a href="#fd6ecf089f9dc9c7" class="i property">UsesResultsCollection</a> = <b>true</b>;
            <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#20fe51d62499cf69" class="i method">AddRef</a>();
 
            <a href="#e9011e5f32895ff4" class="i field">_throttleManager</a> = <span class="r377 r">throttleManager</span>;
            <a href="#48ba2b5a84d42ee0" class="i method">RegisterThrottleComplete</a>(<a href="#e9011e5f32895ff4" class="i field">_throttleManager</a>);
 
            <b>foreach</b> (<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r378 rd" class="r378 r">operation</span> <b>in</b> <span class="r376 r">operations</span>)
            {
                <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r379 rd" class="r379 r">helper</span> = <span class="r378 r">operation</span> <b>as</b> <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>;
 
                <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r380 rd" class="r380 r">remoteRS</span> = <span class="r379 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#cefa43f64a3ac790" class="i property">Runspace</a> <b>as</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                <b>if</b> (<span class="r380 r">remoteRS</span> != <b>null</b>)
                {
                    <span class="r380 r">remoteRS</span>.<a href="remoterunspace.cs.html#a776d5953488773f" class="i">StateChanged</a> += <span class="i">HandleRunspaceStateChanged</span>;
 
                    <b>if</b> (<span class="r380 r">remoteRS</span>.<a href="remoterunspace.cs.html#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>)
                    {
                        <span class="r380 r">remoteRS</span>.<a href="remoterunspace.cs.html#f21dad86b0e2d67e" class="i">URIRedirectionReported</a> += <span class="i">HandleURIDirectionReported</span>;
                    }
                }
 
                <a href="#ac3f4d16443a893f" class="i field">_helpers</a>.<span class="i">Add</span>(<span class="r379 r">helper</span>);
                <a href="#0f9af92314d5920a" class="i method">AggregateResultsFromHelper</a>(<span class="r379 r">helper</span>);
 
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r379 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a> <b>is</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>, <span class="s">&quot;Only remote pipeline can be used in InvokeExpressionSyncJob&quot;</span>);
                <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r381 rd" class="r381 r">pipeline</span> = <span class="r379 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a> <b>as</b> <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>;
                <a href="#f3f4d18ce48a9777" class="i field">_powershells</a>.<span class="i">Add</span>(<span class="r381 r">pipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#d8c9867186529e49" class="i property">InstanceId</a>, <span class="r381 r">pipeline</span>.<a href="remotepipeline.cs.html#ea6d8045e5ac0559" class="i property">PowerShell</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Methods
 
        <b>private bool</b> <a id="af7c070cf5c2989e" href="../../../R/af7c070cf5c2989e.html" target="n" data-glyph="46,1" class="i field">_cleanupDone</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clean up once job is finished.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="f5bb5205c91ee67f" href="../../../R/f5bb5205c91ee67f.html" target="n" data-glyph="75,1" class="i method">DoCleanupOnFinished</a>()
        {
            <b>bool</b> <span id="r382 rd" class="r382 r">doCleanup</span> = <b>false</b>;
            <b>if</b> (!<a href="#af7c070cf5c2989e" class="i field">_cleanupDone</a>)
            {
                <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
                {
                    <b>if</b> (!<a href="#af7c070cf5c2989e" class="i field">_cleanupDone</a>)
                    {
                        <a href="#af7c070cf5c2989e" class="i field">_cleanupDone</a> = <b>true</b>;
                        <span class="r382 r">doCleanup</span> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (!<span class="r382 r">doCleanup</span>) <b>return</b>;
 
            <b>foreach</b> (<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r383 rd" class="r383 r">helper</span> <b>in</b> <a href="#ac3f4d16443a893f" class="i field">_helpers</a>)
            {
                <span class="c">// cleanup remote runspace related handlers</span>
                <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r384 rd" class="r384 r">remoteRS</span> = <span class="r383 r">helper</span>.<a href="../commands/PSRemotingCmdlet.cs.html#07b1b44d725ec8ba" class="i property">PipelineRunspace</a> <b>as</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                <b>if</b> (<span class="r384 r">remoteRS</span> != <b>null</b>)
                {
                    <span class="r384 r">remoteRS</span>.<a href="remoterunspace.cs.html#a776d5953488773f" class="i">StateChanged</a> -= <span class="i">HandleRunspaceStateChanged</span>;
                    <span class="r384 r">remoteRS</span>.<a href="remoterunspace.cs.html#f21dad86b0e2d67e" class="i">URIRedirectionReported</a> -= <span class="i">HandleURIDirectionReported</span>;
                }
 
                <a href="#3e6df123882459d5" class="i method">StopAggregateResultsFromHelper</a>(<span class="r383 r">helper</span>);
            }
 
            <a href="#ae1a1949e8682f44" class="i method">UnregisterThrottleComplete</a>(<a href="#e9011e5f32895ff4" class="i field">_throttleManager</a>);
            <span class="c">// throttleManager = null;</span>
 
            <a href="#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#737fb48bd51a18aa" class="i method">DecrementRef</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Release all resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r385 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if called by Dispose().</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="5551b486ce2c0630" href="../../../R/5551b486ce2c0630.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r385 rd" class="r385 r">disposing</span>)
        {
            <a href="#d1388b6af9650b2e" class="k">base</a>.<a href="#5395a4ee03b34fa7" class="i method">Dispose</a>(<span class="r385 r">disposing</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles operation complete from the operations. Adds an error record</span>
        <span class="c">///</span><span class="c"> to results whenever an error is encountered.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r386 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender of this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r387 r">stateEventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Arguments describing this event, unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="20ee5fc82de3ca23" href="../../../R/20ee5fc82de3ca23.html" target="n" data-glyph="75,1" class="i method">HandleOperationComplete</a>(<b>object</b> <span id="r386 rd" class="r386 r">sender</span>, <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r387 rd" class="r387 r">stateEventArgs</span>)
        {
            <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r388 rd" class="r388 r">helper</span> = <span class="r386 r">sender</span> <b>as</b> <a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>;
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r388 r">helper</span> != <b>null</b>, <span class="s">&quot;Sender of OperationComplete has to be ExecutionCmdletHelper&quot;</span>);
 
            <span class="i">Exception</span> <span id="r389 rd" class="r389 r">failureException</span>;
            <span class="c">// Process the reason in case of failure.</span>
            <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r390 rd" class="r390 r">failureErrorRecord</span>;
 
            <a href="#3f99aa1651cfdfd9" class="i method">ProcessJobFailure</a>(<span class="r388 r">helper</span>, <b>out</b> <span class="r389 r">failureException</span>, <b>out</b> <span class="r390 r">failureErrorRecord</span>);
 
            <b>if</b> (<span class="r390 r">failureErrorRecord</span> != <b>null</b>)
            {
                <a href="#60022000292afa6c" class="k">this</a>.<a href="#f1efa785e9495a67" class="i method">WriteError</a>(<span class="r390 r">failureErrorRecord</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle changes in pipeline states.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r391 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r392 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="ef5579a0d2fb3b53" href="../../../R/ef5579a0d2fb3b53.html" target="n" data-glyph="75,1" class="i method">HandlePipelineStateChanged</a>(<b>object</b> <span id="r391 rd" class="r391 r">sender</span>, <a href="../../hostifaces/Pipeline.cs.html#f088a79047187694" class="t t">PipelineStateEventArgs</a> <span id="r392 rd" class="r392 r">e</span>)
        {
            <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r393 rd" class="r393 r">state</span> = <span class="r392 r">e</span>.<a href="../../hostifaces/Pipeline.cs.html#90fde3748e993197" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a>;
            <b>switch</b> (<span class="r393 r">state</span>)
            {
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                    <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#8b3e2b923f5b0e5d" class="i field">Running</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#425f1d8027f15e68" class="i field">Failed</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>:
                    <a href="#51beff72a9596307" class="i method">CheckForAndSetDisconnectedState</a>(<span class="r393 r">state</span>);
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks for a condition where all pipelines are either finished</span>
        <span class="c">///</span><span class="c"> or disconnected and at least one pipeline is disconnected.</span>
        <span class="c">///</span><span class="c"> In this case the Job state is set to Disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="51beff72a9596307" href="../../../R/51beff72a9596307.html" target="n" data-glyph="76,1" class="i method">CheckForAndSetDisconnectedState</a>(<a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r394 rd" class="r394 r">pipelineState</span>)
        {
            <b>bool</b> <span id="r395 rd" class="r395 r">setJobStateToDisconnected</span>;
            <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
            {
                <b>if</b> (<a href="#2d55e79ec67c0f48" class="i method">IsTerminalState</a>())
                {
                    <b>return</b>;
                }
 
                <b>switch</b> (<span class="r394 r">pipelineState</span>)
                {
                    <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>:
                    <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#425f1d8027f15e68" class="i field">Failed</a>:
                    <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>:
                        <a href="#4b967a5999f60fb4" class="i field">_pipelineFinishedCount</a> += 1;
                        <b>break</b>;
 
                    <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>:
                        <a href="#46d2e616c726b898" class="i field">_pipelineDisconnectedCount</a> += 1;
                        <b>break</b>;
                }
 
                <span class="r395 r">setJobStateToDisconnected</span> = ((<a href="#4b967a5999f60fb4" class="i field">_pipelineFinishedCount</a> + <a href="#46d2e616c726b898" class="i field">_pipelineDisconnectedCount</a>) == <a href="#ac3f4d16443a893f" class="i field">_helpers</a>.<span class="i">Count</span> &amp;&amp;
                                              <a href="#46d2e616c726b898" class="i field">_pipelineDisconnectedCount</a> &gt; 0);
            }
 
            <b>if</b> (<span class="r395 r">setJobStateToDisconnected</span>)
            {
                <span class="c">// Job cannot finish with pipelines in disconnected state.</span>
                <span class="c">// Set Job state to Disconnected.</span>
                <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to stop all operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="fbaf22b3fa77846f" href="../../../R/fbaf22b3fa77846f.html" target="n" data-glyph="72,1" class="i method">StopJob</a>()
        {
            <a href="#e9011e5f32895ff4" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#255a5e90af99543c" class="i method">StopAllOperations</a>();
        }
 
        <b>private bool</b> <a id="acff0a0a88a9f42c" href="../../../R/acff0a0a88a9f42c.html" target="n" data-glyph="46,1" class="i field">_doFinishCalled</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method marks the completion state for Job. Also if job failed, it processes the</span>
        <span class="c">///</span><span class="c"> reason of failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="227adc1a4eccf545" href="../../../R/227adc1a4eccf545.html" target="n" data-glyph="75,1" class="i method">DoFinish</a>()
        {
            <b>if</b> (<a href="#acff0a0a88a9f42c" class="i field">_doFinishCalled</a>)
                <b>return</b>;
 
            <b>lock</b> (<a href="#68c550aa08e5d25f" class="i field">SyncObject</a>)
            {
                <b>if</b> (<a href="#acff0a0a88a9f42c" class="i field">_doFinishCalled</a>)
                    <b>return</b>;
 
                <a href="#acff0a0a88a9f42c" class="i field">_doFinishCalled</a> = <b>true</b>;
            }
 
            <b>foreach</b> (<a href="../commands/PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r396 rd" class="r396 r">helper</span> <b>in</b> <a href="#ac3f4d16443a893f" class="i field">_helpers</a>)
            {
                <a href="#d88f8869319cca36" class="i method">DeterminedAndSetJobState</a>(<span class="r396 r">helper</span>);
            }
 
            <b>if</b> (<a href="#ac3f4d16443a893f" class="i field">_helpers</a>.<span class="i">Count</span> == 0 &amp;&amp; <a href="#60022000292afa6c" class="k">this</a>.<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#1213da49468b8ccd" class="i field">NotStarted</a>)
            {
                <a href="#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#db36b340edc064ae" class="i field">Completed</a>);
            }
 
            <a href="#f5bb5205c91ee67f" class="i method">DoCleanupOnFinished</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the PowerShell instance for the specified id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r397 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance id of PowerShell.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PowerShell instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="0c87ffcf6a988ee2" href="../../../R/0c87ffcf6a988ee2.html" target="n" data-glyph="74,1" class="i method">GetPowerShell</a>(<span class="i">Guid</span> <span id="r397 rd" class="r397 r">instanceId</span>)
        {
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r398 rd" class="r398 r">powershell</span> = <b>null</b>;
 
            <a href="#f3f4d18ce48a9777" class="i field">_powershells</a>.<span class="i">TryGetValue</span>(<span class="r397 r">instanceId</span>, <b>out</b> <span class="r398 r">powershell</span>);
 
            <b>return</b> <span class="r398 r">powershell</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Protected Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Event Handlers
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to unregister URI Redirection handler.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r399 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r400 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="baf8479a5f69bc6c" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleRunspaceStateChanged</a>(<b>object</b> <span id="r399 rd" class="r399 r">sender</span>, <a href="../../hostifaces/Connection.cs.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a> <span id="r400 rd" class="r400 r">e</span>)
        {
            <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r401 rd" class="r401 r">remoteRS</span> = <span class="r399 r">sender</span> <b>as</b> <a href="remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
            <span class="c">// remote runspace must be connected (or connection failed)</span>
            <span class="c">// we dont need URI redirection any more..so clear it</span>
            <b>if</b> (<span class="r401 r">remoteRS</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r400 r">e</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#3990ad8b3e3feec7" class="i field">Opening</a>)
                {
                    <span class="r401 r">remoteRS</span>.<a href="remoterunspace.cs.html#f21dad86b0e2d67e" class="i">URIRedirectionReported</a> -= <span class="i">HandleURIDirectionReported</span>;
 
                    <b>if</b> (<span class="r400 r">e</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
                    {
                        <span class="r401 r">remoteRS</span>.<a href="remoterunspace.cs.html#a776d5953488773f" class="i">StateChanged</a> -= <span class="i">HandleRunspaceStateChanged</span>;
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Submits the operations created in the constructor for invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="f4313603389747ea" href="../../../R/f4313603389747ea.html" target="n" data-glyph="74,1" class="i method">StartOperations</a>(<span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r402 rd" class="r402 r">operations</span>)
        {
            <span class="c">// submit operations to the throttle manager</span>
            <a href="#e9011e5f32895ff4" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#ee8f2ac038103ebc" class="i method">SubmitOperations</a>(<span class="r402 r">operations</span>);
            <a href="#e9011e5f32895ff4" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#75a1eec170a5d6bc" class="i method">EndSubmitOperations</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the job is in a terminal state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True, if job in terminal state</span>
        <span class="c">///</span><span class="c"> false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="2d55e79ec67c0f48" href="../../../R/2d55e79ec67c0f48.html" target="n" data-glyph="74,1" class="i method">IsTerminalState</a>()
        {
            <b>return</b> (<a href="#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="#60022000292afa6c" class="k">this</a>.<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a>) ||
                    <a href="#60022000292afa6c" class="k">this</a>.<a href="#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="#245057a5f4a9ed30" class="i property">State</a> == <a href="#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="#a6de52aa4733f7cb" class="i field">Disconnected</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a collection of all powershells for this job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Collection of PowerShell objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <a id="990794abb8c5fc87" href="../../../R/990794abb8c5fc87.html" target="n" data-glyph="74,1" class="i method">GetPowerShells</a>()
        {
            <span class="i">Collection</span>&lt;<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <span id="r403 rd" class="r403 r">powershellsToReturn</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt;();
            <b>foreach</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r404 rd" class="r404 r">ps</span> <b>in</b> <a href="#f3f4d18ce48a9777" class="i field">_powershells</a>.<span class="i">Values</span>)
            {
                <span class="r403 r">powershellsToReturn</span>.<span class="i">Add</span>(<span class="r404 r">ps</span>);
            }
 
            <b>return</b> <span class="r403 r">powershellsToReturn</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a disconnected remoting job object that contains all</span>
        <span class="c">///</span><span class="c"> remote pipelines/runspaces that are in the Disconnected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#3e3a8a0a8fbfcb51" class="t t">PSRemotingJob</a> <a id="16403bfb2148ff19" href="../../../R/16403bfb2148ff19.html" target="n" data-glyph="74,1" class="i method">CreateDisconnectedRemotingJob</a>()
        {
            <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r405 rd" class="r405 r">disconnectedJobHelpers</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt;();
            <b>foreach</b> (<b>var</b> <span id="r406 rd" class="r406 r">helper</span> <b>in</b> <a href="#ac3f4d16443a893f" class="i field">_helpers</a>)
            {
                <b>if</b> (<span class="r406 r">helper</span>.<span class="i">Pipeline</span>.<span class="i">PipelineStateInfo</span>.<span class="i">State</span> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>)
                {
                    <span class="c">// Remove data callbacks from the old helper.</span>
                    <span class="i">RemoveAggreateCallbacksFromHelper</span>(<span class="r406 r">helper</span>);
 
                    <span class="c">// Create new helper used to create the new Disconnected PSRemoting job.</span>
                    <span class="r405 r">disconnectedJobHelpers</span>.<span class="i">Add</span>(<b>new</b> <span class="t">DisconnectedJobOperation</span>(<span class="r406 r">helper</span>.<span class="i">Pipeline</span>));
                }
            }
 
            <b>if</b> (<span class="r405 r">disconnectedJobHelpers</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <a href="#9afee2391a53da8e" class="t constructor">PSRemotingJob</a>(<span class="r405 r">disconnectedJobHelpers</span>, 0, <a href="#6332c7ef857bb146" class="i property">Name</a>, <b>true</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Methods
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> OutputProcessingState class
 
    <b>internal class</b> <a id="7e5214a3bc47f956" href="../../../R/7e5214a3bc47f956.html" target="n" data-glyph="2,0" class="t t">OutputProcessingStateEventArgs</a> : <span class="i">EventArgs</span>
    {
        <b>internal bool</b> <a id="814114db50065da3" href="../../../R/814114db50065da3.html" target="n" data-glyph="104,1" class="i property">ProcessingOutput</a> { <b>get</b>; }
 
        <b>internal</b> <a id="74417b7db0a01033" href="../../../R/74417b7db0a01033.html" target="n" data-glyph="74,1" class="t constructor">OutputProcessingStateEventArgs</a>(<b>bool</b> <span id="r407 rd" class="r407 r">processingOutput</span>)
        {
            <a href="#814114db50065da3" class="i property">ProcessingOutput</a> = <span class="r407 r">processingOutput</span>;
        }
    }
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>internal interface</b> <a id="ee25bd0d06df876c" href="../../../R/ee25bd0d06df876c.html" target="n" data-glyph="50,0" class="t t">IOutputProcessingState</a>
    {
        <b>event</b> <span class="i">EventHandler</span>&lt;<a href="#7e5214a3bc47f956" class="t t">OutputProcessingStateEventArgs</a>&gt;? <a id="61b35f1d6bd1a26c" href="../../../R/61b35f1d6bd1a26c.html" target="n" data-glyph="30,1" class="i">OutputProcessingStateChanged</a>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
