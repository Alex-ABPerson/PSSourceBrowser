<!DOCTYPE html>
<html><head><title>remoterunspace.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(3340);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/client/remoterunspace.cs" target="_top">engine\remoting\client\remoterunspace.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Tracing</span>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Principal</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Remote runspace which will be created on the client side. This</span>
    <span class="c">///</span><span class="c"> runspace is wrapped on a RunspacePool(1).</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="e2c1bde75e106663" href="../../../R/e2c1bde75e106663.html" target="n" data-glyph="2,0" class="t t">RemoteRunspace</a> : <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>&gt; <a id="53c9b4a51ec51f1c" href="../../../R/53c9b4a51ec51f1c.html" target="n" data-glyph="46,1" class="i field">_runningPipelines</a> = <b>new</b> <span class="i">List</span>&lt;<a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>&gt;();
        <b>private readonly object</b> <a id="1f24f199e5aec10e" href="../../../R/1f24f199e5aec10e.html" target="n" data-glyph="46,1" class="i field">_syncRoot</a> = <b>new</b> <b>object</b>();
        <b>private</b> <a href="../../hostifaces/Connection.cs.html#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <a id="06c7b1d55d2a9713" href="../../../R/06c7b1d55d2a9713.html" target="n" data-glyph="46,1" class="i field">_runspaceStateInfo</a> = <b>new</b> <a href="../../hostifaces/Connection.cs.html#e093e4ce616b2fff" class="t constructor">RunspaceStateInfo</a>(<a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>);
        <b>private readonly bool</b> <a id="6db25a65f39972b1" href="../../../R/6db25a65f39972b1.html" target="n" data-glyph="46,1" class="i field">_bSessionStateProxyCallInProgress</a> = <b>false</b>;
        <b>private readonly</b> <a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="c4391ba3b1d570d8" href="../../../R/c4391ba3b1d570d8.html" target="n" data-glyph="46,1" class="i field">_connectionInfo</a>;
        <b>private</b> <a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a> <a id="8a40c1ce926f8e92" href="../../../R/8a40c1ce926f8e92.html" target="n" data-glyph="46,1" class="i field">_remoteDebugger</a>;
        <b>private</b> <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="aca31638427f469c" href="../../../R/aca31638427f469c.html" target="n" data-glyph="46,1" class="i field">_applicationPrivateData</a>;
 
        <b>private bool</b> <a id="513fe6dcf85dd222" href="../../../R/513fe6dcf85dd222.html" target="n" data-glyph="46,1" class="i field">_disposed</a> = <b>false</b>;
 
        <span class="c">// the following two variables have been added for supporting</span>
        <span class="c">// the Invoke-Command | Invoke-Command scenario</span>
        <b>private</b> <a href="../commands/InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a> <a id="6b32b618e8c80fbb" href="../../../R/6b32b618e8c80fbb.html" target="n" data-glyph="46,1" class="i field">_currentInvokeCommand</a> = <b>null</b>;
        <b>private long</b> <a id="38210701210a18cc" href="../../../R/38210701210a18cc.html" target="n" data-glyph="46,1" class="i field">_currentLocalPipelineId</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is queue of all the state change event which have occured for</span>
        <span class="c">///</span><span class="c"> this runspace. RaiseRunspaceStateEvents raises event for each</span>
        <span class="c">///</span><span class="c"> item in this queue. We don&#39;t raise events from with SetRunspaceState</span>
        <span class="c">///</span><span class="c"> because SetRunspaceState is often called from with in the a lock.</span>
        <span class="c">///</span><span class="c"> Raising event with in a lock introduces chances of deadlock in GUI</span>
        <span class="c">///</span><span class="c"> applications.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Queue</span>&lt;<a href="#ba808de64a8d1159" class="t t">RunspaceEventQueueItem</a>&gt; <a id="5fdf1cbf2720e1d9" href="../../../R/5fdf1cbf2720e1d9.html" target="n" data-glyph="46,1" class="i field">_runspaceEventQueue</a> = <b>new</b> <span class="i">Queue</span>&lt;<a href="#ba808de64a8d1159" class="t t">RunspaceEventQueueItem</a>&gt;();
 
        <b>protected class</b> <a id="ba808de64a8d1159" href="../../../R/ba808de64a8d1159.html" target="n" data-glyph="3,1" class="t t">RunspaceEventQueueItem</a>
        {
            <b>public</b> <a id="774d0ce08b6ace59" href="../../../R/774d0ce08b6ace59.html" target="n" data-glyph="72,2" class="t constructor">RunspaceEventQueueItem</a>(<a href="../../hostifaces/Connection.cs.html#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <span id="r0 rd" class="r0 r">runspaceStateInfo</span>, <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r1 rd" class="r1 r">currentAvailability</span>, <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r2 rd" class="r2 r">newAvailability</span>)
            {
                <a href="#ba808de64a8d1159" class="k">this</a>.<a href="#c2ece9a2879fa828" class="i field">RunspaceStateInfo</a> = <span class="r0 r">runspaceStateInfo</span>;
                <a href="#ba808de64a8d1159" class="k">this</a>.<a href="#87cf7de1bfabb37b" class="i field">CurrentRunspaceAvailability</a> = <span class="r1 r">currentAvailability</span>;
                <a href="#ba808de64a8d1159" class="k">this</a>.<a href="#ad41641c6d3f8c8c" class="i field">NewRunspaceAvailability</a> = <span class="r2 r">newAvailability</span>;
            }
 
            <b>public</b> <a href="../../hostifaces/Connection.cs.html#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <a id="c2ece9a2879fa828" href="../../../R/c2ece9a2879fa828.html" target="n" data-glyph="42,2" class="i field">RunspaceStateInfo</a>;
            <b>public</b> <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <a id="87cf7de1bfabb37b" href="../../../R/87cf7de1bfabb37b.html" target="n" data-glyph="42,2" class="i field">CurrentRunspaceAvailability</a>;
            <b>public</b> <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <a id="ad41641c6d3f8c8c" href="../../../R/ad41641c6d3f8c8c.html" target="n" data-glyph="42,2" class="i field">NewRunspaceAvailability</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In RemoteRunspace, it is required to invoke pipeline</span>
        <span class="c">///</span><span class="c"> as part of open call (i.e. while state is Opening).</span>
        <span class="c">///</span><span class="c"> If this property is true, runspace state check is</span>
        <span class="c">///</span><span class="c"> not performed in AddToRunningPipelineList call.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="8cd4a23a305c8948" href="../../../R/8cd4a23a305c8948.html" target="n" data-glyph="46,1" class="i field">_bypassRunspaceStateCheck</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In RemoteRunspace, it is required to invoke pipeline</span>
        <span class="c">///</span><span class="c"> as part of open call (i.e. while state is Opening).</span>
        <span class="c">///</span><span class="c"> If this property is true, runspace state check is</span>
        <span class="c">///</span><span class="c"> not performed in AddToRunningPipelineList call.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="9db9ac3ec2d96515" href="../../../R/../../0000000000.html" target="n" data-glyph="105,1" class="i property">ByPassRunspaceStateCheck</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8cd4a23a305c8948" class="i field">_bypassRunspaceStateCheck</a>;
            }
 
            <b>set</b>
            {
                <a href="#8cd4a23a305c8948" class="i field">_bypassRunspaceStateCheck</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Temporary place to remember whether to close this runspace on pop or not.</span>
        <span class="c">///</span><span class="c"> Used by Start-PSSession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="a7ae975f02f2273a" href="../../../R/a7ae975f02f2273a.html" target="n" data-glyph="104,1" class="i property">ShouldCloseOnPop</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a remote runspace based on the connection information</span>
        <span class="c">///</span><span class="c"> and the specified host.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The TypeTable to use while deserializing/serializing remote objects.</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by serializer:</span>
        <span class="c">///</span><span class="c">   1. SerializationMethod</span>
        <span class="c">///</span><span class="c">   2. SerializationDepth</span>
        <span class="c">///</span><span class="c">   3. SpecificSerializationProperties</span>
        <span class="c">///</span><span class="c"> TypeTable has the following information used by deserializer:</span>
        <span class="c">///</span><span class="c">   1. TargetTypeForDeserialization</span>
        <span class="c">///</span><span class="c">   2. TypeConverter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">connection information which identifies</span>
        <span class="c">///</span><span class="c"> the remote computer</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host on the client.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">applicationArguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for remote runspace session.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id for remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Application arguments the server can see in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>.<a href="../fanin/PSPrincipal.cs.html#fbb9c1201251c818" class="i property">ApplicationArguments</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="926354f3385f000b" href="../../../R/926354f3385f000b.html" target="n" data-glyph="74,1" class="t constructor">RemoteRunspace</a>(<a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r3 rd" class="r3 r">typeTable</span>, <a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r4 rd" class="r4 r">connectionInfo</span>, <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r5 rd" class="r5 r">host</span>, <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r6 rd" class="r6 r">applicationArguments</span>, <b>string</b> <span id="r7 rd" class="r7 r">name</span> = <b>null</b>, <b>int</b> <span id="r8 rd" class="r8 r">id</span> = -1)
        {
            <a href="../../../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<a href="../../../utils/tracing/PSEtwLog.cs.html#eb082c36055bc9a6" class="i method">SetActivityIdForCurrentThread</a>(<a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>);
            <a href="../../../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogOperationalVerbose</span>(<a href="../common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="../common/PSETWTracer.cs.html#a255099a076d8029" class="i field">RunspaceConstructor</a>, <a href="../common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="../common/PSETWTracer.cs.html#ae0914f768747b55" class="i field">Constructor</a>,
                        <a href="../common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="../common/PSETWTracer.cs.html#752e56066810e4f0" class="i field">CreateRunspace</a>, <a href="../common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="../common/PSETWTracer.cs.html#05d709c2010b41d5" class="i field">UseAlwaysOperational</a>,
                        <a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>.<span class="i">ToString</span>());
 
            <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> = <span class="r4 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#54d6b570b04d9a9d" class="i method">InternalCopy</a>();
            <a href="#5acb867ec64a8846" class="i property">OriginalConnectionInfo</a> = <span class="r4 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#54d6b570b04d9a9d" class="i method">InternalCopy</a>();
 
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a> = <b>new</b> <a href="../../hostifaces/RunspacePool.cs.html#3c62d815c5c87586" class="t constructor">RunspacePool</a>(1, 1, <span class="r3 r">typeTable</span>, <span class="r5 r">host</span>, <span class="r6 r">applicationArguments</span>, <span class="r4 r">connectionInfo</span>, <span class="r7 r">name</span>);
 
            <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#dc4a27f6417e113a" class="i property">PSSessionId</a> = <span class="r8 r">id</span>;
 
            <a href="#4f7e7914d53a7141" class="i method">SetEventHandlers</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a RemoteRunspace object based on the passed in RunspacePool object,</span>
        <span class="c">///</span><span class="c"> with a starting state of Disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">runspacePool</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e6404ee9cc04ab4d" href="../../../R/e6404ee9cc04ab4d.html" target="n" data-glyph="74,1" class="t constructor">RemoteRunspace</a>(<a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r9 rd" class="r9 r">runspacePool</span>)
        {
            <span class="c">// The RemoteRunspace object can only be constructed this way with a RunspacePool that</span>
            <span class="c">// is in the disconnected state.</span>
            <b>if</b> (<span class="r9 r">runspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#a7f9e215f0cbb1ce" class="i property">RunspacePoolStateInfo</a>.<a href="../common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a> != <a href="../../hostifaces/RunspacePool.cs.html#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="../../hostifaces/RunspacePool.cs.html#fb0d368190577383" class="i field">Disconnected</a>
                || <span class="r9 r">runspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#1be40490ab48aaff" class="i property">ConnectionInfo</a> <b>is not</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">InvalidRunspacePool</span>);
            }
 
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a> = <span class="r9 r">runspacePool</span>;
 
            <span class="c">// The remote runspace pool object can only have the value one set for min/max pools.</span>
            <span class="c">// This sets the runspace pool object min/max pool values to one.  The PSRP/WSMan stack</span>
            <span class="c">// will fail during connection if the min/max pool values do not match.</span>
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#e689d36cea00ed6f" class="i method">SetMinRunspaces</a>(1);
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#727b84250aea3ef8" class="i method">SetMaxRunspaces</a>(1);
 
            <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> = <span class="r9 r">runspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#1be40490ab48aaff" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#54d6b570b04d9a9d" class="i method">InternalCopy</a>();
 
            <span class="c">// Update runspace DisconnectedOn and ExpiresOn property from WSManConnectionInfo</span>
            <a href="#fb4264ddd97f64dd" class="i method">UpdateDisconnectExpiresOn</a>();
 
            <span class="c">// Initial state must be Disconnected.</span>
            <a href="#0bcbab8d2ca28248" class="i method">SetRunspaceState</a>(<a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>, <b>null</b>);
 
            <span class="c">// Normal Availability for a disconnected runspace is &quot;None&quot;, which means it can be connected.</span>
            <span class="c">// However, we can also have disconnected runspace objects that are *not* available for</span>
            <span class="c">// connection and in this case the Availability is set to &quot;Busy&quot;.</span>
            <a href="#c575c4729e91c2ed" class="i field">_runspaceAvailability</a> = <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#e9793c4f5c63d814" class="i property">AvailableForConnection</a> ?
                <span class="i n">Runspaces</span>.<a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#a5172055c7a11352" class="i field">None</a> : <span class="i n">Runspaces</span>.<a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#aed194b80737a544" class="i field">Busy</a>;
 
            <a href="#4f7e7914d53a7141" class="i method">SetEventHandlers</a>();
 
            <a href="../../../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<a href="../../../utils/tracing/PSEtwLog.cs.html#eb082c36055bc9a6" class="i method">SetActivityIdForCurrentThread</a>(<a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>);
            <a href="../../../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogOperationalVerbose</span>(<a href="../common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="../common/PSETWTracer.cs.html#a255099a076d8029" class="i field">RunspaceConstructor</a>, <a href="../common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="../common/PSETWTracer.cs.html#ae0914f768747b55" class="i field">Constructor</a>,
                        <a href="../common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="../common/PSETWTracer.cs.html#752e56066810e4f0" class="i field">CreateRunspace</a>, <a href="../common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="../common/PSETWTracer.cs.html#05d709c2010b41d5" class="i field">UseAlwaysOperational</a>,
                        <a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>.<span class="i">ToString</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper function to set event handlers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4f7e7914d53a7141" href="../../../R/4f7e7914d53a7141.html" target="n" data-glyph="76,1" class="i method">SetEventHandlers</a>()
        {
            <span class="c">// RemoteRunspace must have the same instanceID as its contained RunspacePool instance because</span>
            <span class="c">// the PSRP/WinRS layer tracks remote runspace Ids.</span>
            <a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a> = <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#d23018748ccb0099" class="i property">InstanceId</a>;
 
            <a href="#bb4a6170f9ae0254" class="i field">_eventManager</a> = <b>new</b> <a href="../../EventManager.cs.html#d82a84754b379863" class="t constructor">PSRemoteEventManager</a>(<a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a>, <a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>);
 
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#e81fb7a9266008ab" class="i">StateChanged</a> += <span class="i">HandleRunspacePoolStateChanged</span>;
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#272c7966a4f4bd80" class="i">HostCallReceived</a> += <span class="i">HandleHostCallReceived</span>;
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#4d85229304b06ad8" class="i">URIRedirectionReported</a> += <span class="i">HandleURIDirectionReported</span>;
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#12b18eb6ea299c91" class="i">ForwardEvent</a> += <span class="i">HandleRunspacePoolForwardEvent</span>;
            <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#4cbabe5737b8c8dc" class="i">SessionCreateCompleted</a> += <span class="i">HandleSessionCreateCompleted</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialsessionstate information for this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <a id="cd82feda06bff923" href="../../../R/cd82feda06bff923.html" target="n" data-glyph="102,1" class="i property">InitialSessionState</a>
        {
            <b>get</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56503
 
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#a7ba17ebc98e51be" class="i method">NewNotImplementedException</a>();
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56503
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Manager for JobSourceAdapters registered in this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="JobManager.cs.html#d9cecc2436bd3c7d" class="t t">JobManager</a> <a id="8039b05d92a0e1df" href="../../../R/8039b05d92a0e1df.html" target="n" data-glyph="102,1" class="i property">JobManager</a>
        {
            <b>get</b>
            {
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56503
 
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#a7ba17ebc98e51be" class="i method">NewNotImplementedException</a>();
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56503
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return version of this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Version</span> <a id="869a6ccaaa1d023d" href="../../../R/869a6ccaaa1d023d.html" target="n" data-glyph="102,1" class="i property">Version</a> { <b>get</b>; } = <a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#ad63365ac7690eeb" class="i property">PSVersion</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PS Version running on server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Version</span> <a id="97e1e286f840d73f" href="../../../R/97e1e286f840d73f.html" target="n" data-glyph="104,1" class="i property">ServerVersion</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieve information about current state of the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Connection.cs.html#0cb1ed33bb1d35e3" class="t t">RunspaceStateInfo</a> <a id="a76d07f84f3f8c60" href="../../../R/a76d07f84f3f8c60.html" target="n" data-glyph="102,1" class="i property">RunspaceStateInfo</a>
        {
            <b>get</b>
            {
                <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
                {
                    <span class="c">// Do not return internal state.</span>
                    <b>return</b> <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#d8101f7e931fd53a" class="i method">Clone</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property determines whether a new thread is create for each invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any updates to the value of this property must be done before the Runspace is opened</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An attempt to change this property was made after opening the Runspace</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The thread options cannot be changed to the requested value</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a> <a id="50afededdbdb0c8a" href="../../../R/50afededdbdb0c8a.html" target="n" data-glyph="102,1" class="i property">ThreadOptions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dc876dd65cfa765d" class="i field">_createThreadOptions</a>;
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
                {
                    <b>if</b> (<b>value</b> != <a href="#dc876dd65cfa765d" class="i field">_createThreadOptions</a>)
                    {
                        <b>if</b> (<a href="#e2c1bde75e106663" class="k">this</a>.<a href="#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>)
                        {
                            <b>throw</b> <b>new</b> <a href="../../hostifaces/Connection.cs.html#15409056950584a1" class="t constructor">InvalidRunspaceStateException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">ChangePropertyAfterOpen</span>));
                        }
 
                        <a href="#dc876dd65cfa765d" class="i field">_createThreadOptions</a> = <b>value</b>;
                    }
                }
            }
        }
 
        <b>private</b> <a href="../../hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a> <a id="dc876dd65cfa765d" href="../../../R/dc876dd65cfa765d.html" target="n" data-glyph="46,1" class="i field">_createThreadOptions</a> = <a href="../../hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a>.<a href="../../hostifaces/Connection.cs.html#84e3ebfc04cbd4e5" class="i field">Default</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the current availability of the Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <a id="c9a8dc56926b5fdf" href="../../../R/c9a8dc56926b5fdf.html" target="n" data-glyph="102,1" class="i property">RunspaceAvailability</a>
        {
            <b>get</b> { <b>return</b> <a href="#c575c4729e91c2ed" class="i field">_runspaceAvailability</a>; }
 
            <b>protected set</b> { <a href="#c575c4729e91c2ed" class="i field">_runspaceAvailability</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <a id="c575c4729e91c2ed" href="../../../R/c575c4729e91c2ed.html" target="n" data-glyph="46,1" class="i field">_runspaceAvailability</a> = <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#a5172055c7a11352" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when RunspaceState changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override event</b> <span class="i">EventHandler</span>&lt;<a href="../../hostifaces/Connection.cs.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a>&gt; <a id="a776d5953488773f" href="../../../R/a776d5953488773f.html" target="n" data-glyph="30,1" class="i">StateChanged</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when the availability of the Runspace changes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override event</b> <span class="i">EventHandler</span>&lt;<a href="../../hostifaces/Connection.cs.html#cb349d0617c35bc7" class="t t">RunspaceAvailabilityEventArgs</a>&gt; <a id="8f847c0cd64cdb1d" href="../../../R/8f847c0cd64cdb1d.html" target="n" data-glyph="30,1" class="i">AvailabilityChanged</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if there are any subscribers to the AvailabilityChanged event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="bc1cd084f3386521" href="../../../R/bc1cd084f3386521.html" target="n" data-glyph="104,1" class="i property">HasAvailabilityChangedSubscribers</a>
        {
            <b>get</b> { <b>return</b> <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#8f847c0cd64cdb1d" class="i">AvailabilityChanged</a> != <b>null</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the AvailabilityChanged event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="ee1aba2073fccf99" href="../../../R/ee1aba2073fccf99.html" target="n" data-glyph="75,1" class="i method">OnAvailabilityChanged</a>(<a href="../../hostifaces/Connection.cs.html#cb349d0617c35bc7" class="t t">RunspaceAvailabilityEventArgs</a> <span id="r10 rd" class="r10 r">e</span>)
        {
            <span class="i">EventHandler</span>&lt;<a href="../../hostifaces/Connection.cs.html#cb349d0617c35bc7" class="t t">RunspaceAvailabilityEventArgs</a>&gt; <span id="r11 rd" class="r11 r">eh</span> = <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#8f847c0cd64cdb1d" class="i">AvailabilityChanged</a>;
 
            <b>if</b> (<span class="r11 r">eh</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="r11 r">eh</span>(<a href="#e2c1bde75e106663" class="k">this</a>, <span class="r10 r">e</span>);
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connection information to this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="912a4002c4156bbf" href="../../../R/912a4002c4156bbf.html" target="n" data-glyph="102,1" class="i property">ConnectionInfo</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ConnectionInfo originally supplied by the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="5acb867ec64a8846" href="../../../R/5acb867ec64a8846.html" target="n" data-glyph="102,1" class="i property">OriginalConnectionInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the event manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../EventManager.cs.html#0fd88f72d27f82bd" class="t t">PSEventManager</a> <a id="5b35598bcb0cb4ef" href="../../../R/5b35598bcb0cb4ef.html" target="n" data-glyph="102,1" class="i property">Events</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#bb4a6170f9ae0254" class="i field">_eventManager</a>;
            }
        }
 
        <b>private</b> <a href="../../EventManager.cs.html#027edd8f06b1bbd1" class="t t">PSRemoteEventManager</a> <a id="bb4a6170f9ae0254" href="../../../R/bb4a6170f9ae0254.html" target="n" data-glyph="46,1" class="i field">_eventManager</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56503
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the execution context for this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="60159954a8c6729f" href="../../../R/60159954a8c6729f.html" target="n" data-glyph="104,1" class="i property">GetExecutionContext</a>
        {
            <b>get</b>
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#a7ba17ebc98e51be" class="i method">NewNotImplementedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the internal host is in a nested prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="3b5074afe3b3e241" href="../../../R/3b5074afe3b3e241.html" target="n" data-glyph="104,1" class="i property">InNestedPrompt</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>false</b>; <span class="c">// nested prompts are not supported on remote runspaces</span>
            }
        }
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56503
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the client remote session associated with this</span>
        <span class="c">///</span><span class="c"> runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This member is actually not required</span>
        <span class="c">///</span><span class="c"> for the product code. However, there are</span>
        <span class="c">///</span><span class="c"> existing transport manager tests which depend on</span>
        <span class="c">///</span><span class="c"> the same. Once transport manager is modified,</span>
        <span class="c">///</span><span class="c"> this needs to be removed</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="clientremotesession.cs.html#e2e97fb58c308155" class="t t">ClientRemoteSession</a> <a id="51ec67af49935cb9" href="../../../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">ClientRemoteSession</a>
        {
            <b>get</b>
            {
                <b>try</b>
                {
                    <b>return</b> <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#6629c704c27c6e09" class="i property">DataStructureHandler</a>.<a href="RemotingProtocol2.cs.html#e60f2ab4626e155d" class="i property">RemoteSession</a>;
                }
                <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r12 rd" class="r12 r">e</span>)
                {
                    <b>throw</b> <span class="r12 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets command information on a currently running remote command.</span>
        <span class="c">///</span><span class="c"> If no command is running then null is returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="RemoteRunspacePoolInternal.cs.html#b586ca980bfda5bc" class="t t">ConnectCommandInfo</a> <a id="c7d59b1aea27b0c9" href="../../../R/c7d59b1aea27b0c9.html" target="n" data-glyph="104,1" class="i property">RemoteCommand</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#70f4b2d341860095" class="i property">ConnectCommands</a> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#70f4b2d341860095" class="i property">ConnectCommands</a>.<span class="i">Length</span> &lt; 2, <span class="s">&quot;RemoteRunspace should have no more than one remote running command.&quot;</span>);
                <b>if</b> (<a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#70f4b2d341860095" class="i property">ConnectCommands</a>.<span class="i">Length</span> &gt; 0)
                {
                    <b>return</b> <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#70f4b2d341860095" class="i property">ConnectCommands</a>[0];
                }
                <b>else</b>
                {
                    <b>return</b> <b>null</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets friendly name for the remote PSSession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="3e2394bcbf12f720" href="../../../R/3e2394bcbf12f720.html" target="n" data-glyph="104,1" class="i property">PSSessionName</a>
        {
            <b>get</b> { <b>return</b> <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#1a2dda11a58f900f" class="i property">Name</a>; }
 
            <b>set</b> { <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#1a2dda11a58f900f" class="i property">Name</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Id value for the remote PSSession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="dc4a27f6417e113a" href="../../../R/dc4a27f6417e113a.html" target="n" data-glyph="104,1" class="i property">PSSessionId</a> { <b>get</b>; <b>set</b>; } = -1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if Runspace supports disconnect.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="0dd004643a4ef610" href="../../../R/0dd004643a4ef610.html" target="n" data-glyph="104,1" class="i property">CanDisconnect</a>
        {
            <b>get</b> { <b>return</b> <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#008af9ea26573908" class="i property">CanDisconnect</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if Runspace can be connected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="be12cabf607e3495" href="../../../R/be12cabf607e3495.html" target="n" data-glyph="104,1" class="i property">CanConnect</a>
        {
            <b>get</b> { <b>return</b> <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#e9793c4f5c63d814" class="i property">AvailableForConnection</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is used to indicate a special loopback remote session used for JEA restrictions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="9ee81e5f28211346" href="../../../R/9ee81e5f28211346.html" target="n" data-glyph="104,1" class="i property">IsConfiguredLoopBack</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="8c26a63dda2acb44" href="../../../R/8c26a63dda2acb44.html" target="n" data-glyph="102,1" class="i property">Debugger</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8a40c1ce926f8e92" class="i field">_remoteDebugger</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Open
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Open the runspace Asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not BeforeOpen</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="5ee422637ef72aad" href="../../../R/5ee422637ef72aad.html" target="n" data-glyph="72,1" class="i method">OpenAsync</a>()
        {
            <a href="#ebd59e3648e04793" class="i method">AssertIfStateIsBeforeOpen</a>();
 
            <b>try</b>
            {
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ec8a57919fd4239b" class="i method">BeginOpen</a>(<b>null</b>, <b>null</b>);
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r13 rd" class="r13 r">e</span>)
            {
                <b>throw</b> <span class="r13 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Open the runspace synchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not BeforeOpen</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="8f5246099264f315" href="../../../R/8f5246099264f315.html" target="n" data-glyph="72,1" class="i method">Open</a>()
        {
            <a href="#ebd59e3648e04793" class="i method">AssertIfStateIsBeforeOpen</a>();
 
            <b>try</b>
            {
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#4d933f8550b5ef22" class="i property">ThreadOptions</a> = <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#50afededdbdb0c8a" class="i property">ThreadOptions</a>;
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#e96b2efb9719a701" class="i property">ApartmentState</a> = <a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#7483ec8556438ee9" class="i property">ApartmentState</a>;
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#60da411b81c3454e" class="i method">Open</a>();
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r14 rd" class="r14 r">e</span>)
            {
                <b>throw</b> <span class="r14 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Open
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Close
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Close the runspace Asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="0bab9589a46f6bec" href="../../../R/0bab9589a46f6bec.html" target="n" data-glyph="72,1" class="i method">CloseAsync</a>()
        {
            <b>try</b>
            {
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#b435606c04d0d7ab" class="i method">BeginClose</a>(<b>null</b>, <b>null</b>);
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r15 rd" class="r15 r">e</span>)
            {
                <b>throw</b> <span class="r15 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Close the runspace synchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attempts to execute pipelines after a call to close will fail.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="93d0f66da676bbe4" href="../../../R/93d0f66da676bbe4.html" target="n" data-glyph="72,1" class="i method">Close</a>()
        {
            <b>try</b>
            {
                <span class="i">IAsyncResult</span> <span id="r16 rd" class="r16 r">result</span> = <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#b435606c04d0d7ab" class="i method">BeginClose</a>(<b>null</b>, <b>null</b>);
 
                <a href="#f6ee4443bbc388aa" class="i method">WaitForFinishofPipelines</a>();
 
                <span class="c">// It is possible for the result ASyncResult object to be null if the runspace</span>
                <span class="c">// pool is already being closed from a server initiated close event.</span>
                <b>if</b> (<span class="r16 r">result</span> != <b>null</b>)
                {
                    <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#d4e9397647c8d9a0" class="i method">EndClose</a>(<span class="r16 r">result</span>);
                }
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r17 rd" class="r17 r">e</span>)
            {
                <b>throw</b> <span class="r17 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if called from Dispose.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="51ff9cf743cba4c3" href="../../../R/51ff9cf743cba4c3.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r18 rd" class="r18 r">disposing</span>)
        {
            <b>try</b>
            {
                <b>if</b> (<a href="#513fe6dcf85dd222" class="i field">_disposed</a>)
                {
                    <b>return</b>;
                }
 
                <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
                {
                    <b>if</b> (<a href="#513fe6dcf85dd222" class="i field">_disposed</a>)
                    {
                        <b>return</b>;
                    }
 
                    <a href="#513fe6dcf85dd222" class="i field">_disposed</a> = <b>true</b>;
                }
 
                <b>if</b> (<span class="r18 r">disposing</span>)
                {
                    <b>try</b>
                    {
                        <a href="#93d0f66da676bbe4" class="i method">Close</a>();
                    }
                    <b>catch</b> (<a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a>)
                    {
                        <span class="c">//</span>
                        <span class="c">// If the WinRM listener has been removed before the runspace is closed, then calling</span>
                        <span class="c">// Close() will cause a PSRemotingTransportException.  We don&#39;t want this exception</span>
                        <span class="c">// surfaced.  Most developers don&#39;t expect an exception from calling Dispose.</span>
                        <span class="c">// See [Windows 8 Bugs] 968184.</span>
                        <span class="c">//</span>
                    }
 
                    <b>if</b> (<a href="#8a40c1ce926f8e92" class="i field">_remoteDebugger</a> != <b>null</b>)
                    {
                        <span class="c">// Release RunspacePool event forwarding handlers.</span>
                        <a href="#8a40c1ce926f8e92" class="i field">_remoteDebugger</a>.<a href="#dbb0d321ad875ed4" class="i method">Dispose</a>();
                    }
 
                    <b>try</b>
                    {
                        <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#e81fb7a9266008ab" class="i">StateChanged</a> -= <span class="i">HandleRunspacePoolStateChanged</span>;
                        <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#272c7966a4f4bd80" class="i">HostCallReceived</a> -= <span class="i">HandleHostCallReceived</span>;
                        <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#4d85229304b06ad8" class="i">URIRedirectionReported</a> -= <span class="i">HandleURIDirectionReported</span>;
                        <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#12b18eb6ea299c91" class="i">ForwardEvent</a> -= <span class="i">HandleRunspacePoolForwardEvent</span>;
                        <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#4cbabe5737b8c8dc" class="i">SessionCreateCompleted</a> -= <span class="i">HandleSessionCreateCompleted</span>;
 
                        <a href="#bb4a6170f9ae0254" class="i field">_eventManager</a> = <b>null</b>;
 
                        <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#3db8df3e6fc80b2b" class="i method">Dispose</a>();
                        <span class="c">// _runspacePool = null;</span>
                    }
                    <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r19 rd" class="r19 r">e</span>)
                    {
                        <b>throw</b> <span class="r19 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
                    }
                }
            }
            <b>finally</b>
            {
                <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="k">base</a>.<a href="../../hostifaces/Connection.cs.html#86b34aeb9ee1837f" class="i method">Dispose</a>(<span class="r18 r">disposing</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Close
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Reset Runspace State
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets the runspace state to allow for fast reuse. Not all of the runspace</span>
        <span class="c">///</span><span class="c"> elements are reset. The goal is to minimize the chance of the user taking</span>
        <span class="c">///</span><span class="c"> accidental dependencies on prior runspace state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../../utils/MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when runspace is not in proper state or availability or if the</span>
        <span class="c">///</span><span class="c"> reset operation fails in the remote session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="853b3bcb5aaa3ad8" href="../../../R/853b3bcb5aaa3ad8.html" target="n" data-glyph="72,1" class="i method">ResetRunspaceState</a>()
        {
            <a href="../../../utils/MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a> <span id="r20 rd" class="r20 r">invalidOperation</span> = <b>null</b>;
 
            <b>if</b> (<a href="#e2c1bde75e106663" class="k">this</a>.<a href="#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <span class="i n">Runspaces</span>.<a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
            {
                <span class="r20 r">invalidOperation</span> = <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                        <span class="i">RunspaceStrings</span>.<span class="i">RunspaceNotInOpenedState</span>, <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>);
            }
            <b>else</b> <b>if</b> (<a href="#e2c1bde75e106663" class="k">this</a>.<a href="#c9a8dc56926b5fdf" class="i property">RunspaceAvailability</a> != <span class="i n">Runspaces</span>.<a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#64bc5c5290cfb16d" class="i field">Available</a>)
            {
                <span class="r20 r">invalidOperation</span> = <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                        <span class="i">RunspaceStrings</span>.<span class="i">ConcurrentInvokeNotAllowed</span>);
            }
            <b>else</b>
            {
                <b>bool</b> <span id="r21 rd" class="r21 r">success</span> = <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#e39ebaaa11f3f4de" class="i method">ResetRunspaceState</a>();
                <b>if</b> (!<span class="r21 r">success</span>)
                {
                    <span class="r20 r">invalidOperation</span> = <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                }
            }
 
            <b>if</b> (<span class="r20 r">invalidOperation</span> != <b>null</b>)
            {
                <span class="r20 r">invalidOperation</span>.<span class="i">Source</span> = <span class="s">&quot;ResetRunspaceState&quot;</span>;
                <b>throw</b> <span class="r20 r">invalidOperation</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Disconnect-Connect
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries the server for disconnected runspaces and creates an array of runspace</span>
        <span class="c">///</span><span class="c"> objects associated with each disconnected runspace on the server.  Each</span>
        <span class="c">///</span><span class="c"> runspace object in the returned array is in the Disconnected state and can be</span>
        <span class="c">///</span><span class="c"> connected to the server by calling the Connect() method on the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for the target server.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client host object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">TypeTable object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of Runspace objects each in the Disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>[] <a id="e1f63f7eb9dcb8c7" href="../../../R/e1f63f7eb9dcb8c7.html" target="n" data-glyph="74,1" class="i method">GetRemoteRunspaces</a>(<a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r22 rd" class="r22 r">connectionInfo</span>, <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r23 rd" class="r23 r">host</span>, <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r24 rd" class="r24 r">typeTable</span>)
        {
            <span class="i">List</span>&lt;<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt; <span id="r25 rd" class="r25 r">runspaces</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt;();
            <a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a>[] <span id="r26 rd" class="r26 r">runspacePools</span> = <a href="RemoteRunspacePoolInternal.cs.html#1aba79be5da56f57" class="t t">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#9f0c620f91f8243e" class="i method">GetRemoteRunspacePools</a>(<span class="r22 r">connectionInfo</span>, <span class="r23 r">host</span>, <span class="r24 r">typeTable</span>);
 
            <span class="c">// We don&#39;t yet know how many runspaces there are in these runspace pool objects.  This information isn&#39;t updated</span>
            <span class="c">// until a Connect() is performed.  But we can use the ConnectCommands list to prune runspace pool objects that</span>
            <span class="c">// clearly have more than one command/runspace.</span>
            <b>foreach</b> (<a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r27 rd" class="r27 r">runspacePool</span> <b>in</b> <span class="r26 r">runspacePools</span>)
            {
                <b>if</b> (<span class="r27 r">runspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#70f4b2d341860095" class="i property">ConnectCommands</a>.<span class="i">Length</span> &lt; 2)
                {
                    <span class="r25 r">runspaces</span>.<span class="i">Add</span>(<b>new</b> <a href="#e6404ee9cc04ab4d" class="t constructor">RemoteRunspace</a>(<span class="r27 r">runspacePool</span>));
                }
            }
 
            <b>return</b> <span class="r25 r">runspaces</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a single disconnected remote Runspace object based on connection information and</span>
        <span class="c">///</span><span class="c"> session / command identifiers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Connection object for target machine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">sessionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Session Id to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">commandId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional command Id to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional PSHost.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">typeTable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Optional TypeTable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Disconnect remote Runspace object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="6b92f18377ef4303" href="../../../R/6b92f18377ef4303.html" target="n" data-glyph="74,1" class="i method">GetRemoteRunspace</a>(<a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r28 rd" class="r28 r">connectionInfo</span>, <span class="i">Guid</span> <span id="r29 rd" class="r29 r">sessionId</span>, <span class="i">Guid</span>? <span id="r30 rd" class="r30 r">commandId</span>, <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r31 rd" class="r31 r">host</span>, <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r32 rd" class="r32 r">typeTable</span>)
        {
            <a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r33 rd" class="r33 r">runspacePool</span> = <a href="RemoteRunspacePoolInternal.cs.html#1aba79be5da56f57" class="t t">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#ed21571a445e674d" class="i method">GetRemoteRunspacePool</a>(
                <span class="r28 r">connectionInfo</span>,
                <span class="r29 r">sessionId</span>,
                <span class="r30 r">commandId</span>,
                <span class="r31 r">host</span>,
                <span class="r32 r">typeTable</span>);
 
            <b>return</b> <b>new</b> <a href="#e6404ee9cc04ab4d" class="t constructor">RemoteRunspace</a>(<span class="r33 r">runspacePool</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the runspace synchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the remote runspace and any running command from the server</span>
        <span class="c">///</span><span class="c"> machine.  Any data generated by the running command on the server is</span>
        <span class="c">///</span><span class="c"> cached on the server machine.  This runspace object goes to the disconnected</span>
        <span class="c">///</span><span class="c"> state.  This object can be reconnected to the server by calling the</span>
        <span class="c">///</span><span class="c"> Connect() method.</span>
        <span class="c">///</span><span class="c"> If the remote runspace on the server remains disconnected for the IdleTimeout</span>
        <span class="c">///</span><span class="c"> value (as defined in the WSManConnectionInfo object) then it is closed and</span>
        <span class="c">///</span><span class="c"> torn down on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Opened.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="7d32a4b8aba7cb8c" href="../../../R/7d32a4b8aba7cb8c.html" target="n" data-glyph="72,1" class="i method">Disconnect</a>()
        {
            <b>if</b> (!<a href="#0dd004643a4ef610" class="i property">CanDisconnect</a>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">DisconnectNotSupportedOnServer</span>);
            }
 
            <a href="#f951d2c0d819530c" class="i method">UpdatePoolDisconnectOptions</a>();
 
            <b>try</b>
            {
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#c941ba06f6efbbc1" class="i method">Disconnect</a>();
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r34 rd" class="r34 r">e</span>)
            {
                <b>throw</b> <span class="r34 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the runspace asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disconnects the remote runspace and any running command from the server</span>
        <span class="c">///</span><span class="c"> machine.  Any data generated by the running command on the server is</span>
        <span class="c">///</span><span class="c"> cached on the server machine.  This runspace object goes to the disconnected</span>
        <span class="c">///</span><span class="c"> state.  This object can be reconnected to the server by calling the</span>
        <span class="c">///</span><span class="c"> Connect() method.</span>
        <span class="c">///</span><span class="c"> If the remote runspace on the server remains disconnected for the IdleTimeout</span>
        <span class="c">///</span><span class="c"> value (as defined in the WSManConnectionInfo object) then it is closed and</span>
        <span class="c">///</span><span class="c"> torn down on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Opened.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="69452270facf0a86" href="../../../R/69452270facf0a86.html" target="n" data-glyph="72,1" class="i method">DisconnectAsync</a>()
        {
            <b>if</b> (!<a href="#0dd004643a4ef610" class="i property">CanDisconnect</a>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">DisconnectNotSupportedOnServer</span>);
            }
 
            <a href="#f951d2c0d819530c" class="i method">UpdatePoolDisconnectOptions</a>();
 
            <b>try</b>
            {
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#6d0eed98930ab834" class="i method">BeginDisconnect</a>(<b>null</b>, <b>null</b>);
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r35 rd" class="r35 r">e</span>)
            {
                <b>throw</b> <span class="r35 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace to its remote counterpart synchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace object to its corresponding runspace on the target</span>
        <span class="c">///</span><span class="c"> server machine.  The target server machine is identified by the connection</span>
        <span class="c">///</span><span class="c"> object passed in during construction.  The remote runspace is identified</span>
        <span class="c">///</span><span class="c"> by the internal runspace Guid value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="25aba598f1a8b95a" href="../../../R/25aba598f1a8b95a.html" target="n" data-glyph="72,1" class="i method">Connect</a>()
        {
            <b>if</b> (!<a href="#be12cabf607e3495" class="i property">CanConnect</a>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">CannotConnect</span>);
            }
 
            <a href="#f951d2c0d819530c" class="i method">UpdatePoolDisconnectOptions</a>();
 
            <b>try</b>
            {
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#cf5c13f99a02f2b1" class="i method">Connect</a>();
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r36 rd" class="r36 r">e</span>)
            {
                <b>throw</b> <span class="r36 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects a runspace to its remote counterpart asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connects the runspace object to its corresponding runspace on the target</span>
        <span class="c">///</span><span class="c"> server machine.  The target server machine is identified by the connection</span>
        <span class="c">///</span><span class="c"> object passed in during construction.  The remote runspace is identified</span>
        <span class="c">///</span><span class="c"> by the internal runspace Guid value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RunspaceState is not Disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="66cfd31dd6adce00" href="../../../R/66cfd31dd6adce00.html" target="n" data-glyph="72,1" class="i method">ConnectAsync</a>()
        {
            <b>if</b> (!<a href="#be12cabf607e3495" class="i property">CanConnect</a>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">CannotConnect</span>);
            }
 
            <a href="#f951d2c0d819530c" class="i method">UpdatePoolDisconnectOptions</a>();
 
            <b>try</b>
            {
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ee6829cf26256ff2" class="i method">BeginConnect</a>(<b>null</b>, <b>null</b>);
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r37 rd" class="r37 r">e</span>)
            {
                <b>throw</b> <span class="r37 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PipeLine object in the disconnected state for the currently disconnected</span>
        <span class="c">///</span><span class="c"> remote running command associated with this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Pipeline object in disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="fda899b257b9c0a6" href="../../../R/fda899b257b9c0a6.html" target="n" data-glyph="72,1" class="i method">CreateDisconnectedPipeline</a>()
        {
            <b>if</b> (<a href="#c7d59b1aea27b0c9" class="i property">RemoteCommand</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NoDisconnectedCommand</span>);
            }
 
            <b>return</b> <b>new</b> <a href="remotepipeline.cs.html#709351a766991b78" class="t constructor">RemotePipeline</a>(<a href="#e2c1bde75e106663" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PowerShell object in the disconnected state for the currently disconnected</span>
        <span class="c">///</span><span class="c"> remote running command associated with this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PowerShell object in disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="bad01a8f72019b0d" href="../../../R/bad01a8f72019b0d.html" target="n" data-glyph="72,1" class="i method">CreateDisconnectedPowerShell</a>()
        {
            <b>if</b> (<a href="#c7d59b1aea27b0c9" class="i property">RemoteCommand</a> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NoDisconnectedCommand</span>);
            }
 
            <b>return</b> <b>new</b> <a href="../../hostifaces/PowerShell.cs.html#9d89b3548a1395c2" class="t constructor">PowerShell</a>(<a href="#c7d59b1aea27b0c9" class="i property">RemoteCommand</a>, <a href="#e2c1bde75e106663" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns Runspace capabilities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RunspaceCapability.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a> <a id="558ae0c453ba9c2e" href="../../../R/558ae0c453ba9c2e.html" target="n" data-glyph="72,1" class="i method">GetCapabilities</a>()
        {
            <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a> <span id="r38 rd" class="r38 r">returnCaps</span> = <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a>.<a href="../../hostifaces/Connection.cs.html#9ed1c376ca1193e2" class="i field">Default</a>;
 
            <b>if</b> (<a href="#0dd004643a4ef610" class="i property">CanDisconnect</a>)
            {
                <span class="r38 r">returnCaps</span> |= <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a>.<a href="../../hostifaces/Connection.cs.html#809b1422aeb42750" class="i field">SupportsDisconnect</a>;
            }
 
            <b>if</b> (<a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> <b>is</b> <a href="../common/RunspaceConnectionInfo.cs.html#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a>)
            {
                <span class="r38 r">returnCaps</span> |= <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a>.<a href="../../hostifaces/Connection.cs.html#bbaad78d6b858edf" class="i field">NamedPipeTransport</a>;
            }
            <b>else</b> <b>if</b> (<a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> <b>is</b> <a href="../common/RunspaceConnectionInfo.cs.html#3906a420e89ab01e" class="t t">VMConnectionInfo</a>)
            {
                <span class="r38 r">returnCaps</span> |= <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a>.<a href="../../hostifaces/Connection.cs.html#a7e8e2e8c62058c6" class="i field">VMSocketTransport</a>;
            }
            <b>else</b> <b>if</b> (<a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> <b>is</b> <a href="../common/RunspaceConnectionInfo.cs.html#c9fcf5b14ea1c33c" class="t t">SSHConnectionInfo</a>)
            {
                <span class="r38 r">returnCaps</span> |= <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a>.<a href="../../hostifaces/Connection.cs.html#1a92af2f13919c93" class="i field">SSHTransport</a>;
            }
            <b>else</b>
            {
                <a href="../common/RunspaceConnectionInfo.cs.html#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a> <span id="r39 rd" class="r39 r">containerConnectionInfo</span> = <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a>;
 
                <b>if</b> ((<span class="r39 r">containerConnectionInfo</span> != <b>null</b>) &amp;&amp;
                    (<span class="r39 r">containerConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#ee338ee5bc920bf9" class="i property">ContainerProc</a>.<a href="../common/RunspaceConnectionInfo.cs.html#96d9b1e4448dc129" class="i property">RuntimeId</a> == <span class="i">Guid</span>.<span class="i">Empty</span>))
                {
                    <span class="r38 r">returnCaps</span> |= <a href="../../hostifaces/Connection.cs.html#381534d5ae10528e" class="t t">RunspaceCapability</a>.<a href="../../hostifaces/Connection.cs.html#bbaad78d6b858edf" class="i field">NamedPipeTransport</a>;
                }
            }
 
            <b>return</b> <span class="r38 r">returnCaps</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Update the pool disconnect options so that any changes will be</span>
        <span class="c">///</span><span class="c"> passed to the server during the disconnect/connect operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f951d2c0d819530c" href="../../../R/f951d2c0d819530c.html" target="n" data-glyph="76,1" class="i method">UpdatePoolDisconnectOptions</a>()
        {
            <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r40 rd" class="r40 r">runspaceWSManConnectionInfo</span> = <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#1be40490ab48aaff" class="i property">ConnectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>;
            <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r41 rd" class="r41 r">wsManConnectionInfo</span> = <a href="#912a4002c4156bbf" class="i property">ConnectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>;
 
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r40 r">runspaceWSManConnectionInfo</span> != <b>null</b>, <span class="s">&quot;Disconnect-Connect feature is currently only supported for WSMan transport&quot;</span>);
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r41 r">wsManConnectionInfo</span> != <b>null</b>, <span class="s">&quot;Disconnect-Connect feature is currently only supported for WSMan transport&quot;</span>);
 
            <span class="r40 r">runspaceWSManConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#0c117c8cb5b1de8b" class="i property">IdleTimeout</a> = <span class="r41 r">wsManConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#0c117c8cb5b1de8b" class="i property">IdleTimeout</a>;
            <span class="r40 r">runspaceWSManConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#10ef35a810ea13c2" class="i property">OutputBufferingMode</a> = <span class="r41 r">wsManConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#10ef35a810ea13c2" class="i property">OutputBufferingMode</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Remote Debugging
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remote DebuggerStop event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<a href="../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="5183f3d7600aeaf8" href="../../../R/5183f3d7600aeaf8.html" target="n" data-glyph="32,1" class="i">RemoteDebuggerStop</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remote BreakpointUpdated event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<a href="../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a>&gt; <a id="50319f28a3da4cc3" href="../../../R/50319f28a3da4cc3.html" target="n" data-glyph="32,1" class="i">RemoteDebuggerBreakpointUpdated</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> CreatePipeline
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create an empty pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An empty pipeline.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="ba07b4eedf69ef65" href="../../../R/ba07b4eedf69ef65.html" target="n" data-glyph="72,1" class="i method">CreatePipeline</a>()
        {
            <b>return</b> <a href="#5fb6b4633a60138b" class="i method">CoreCreatePipeline</a>(<b>null</b>, <b>false</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a pipeline from a command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A valid command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A pipeline pre-filled with Commands specified in commandString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="312f6ca07aee2b09" href="../../../R/312f6ca07aee2b09.html" target="n" data-glyph="72,1" class="i method">CreatePipeline</a>(<b>string</b> <span id="r42 rd" class="r42 r">command</span>)
        {
            <b>if</b> (<span class="r42 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r42 r">command</span>));
            }
 
            <b>return</b> <a href="#5fb6b4633a60138b" class="i method">CoreCreatePipeline</a>(<span class="r42 r">command</span>, <b>false</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a pipeline from a command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A valid command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">addToHistory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true command is added to history.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A pipeline pre-filled with Commands specified in commandString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="dc5da93fcae98b98" href="../../../R/dc5da93fcae98b98.html" target="n" data-glyph="72,1" class="i method">CreatePipeline</a>(<b>string</b> <span id="r43 rd" class="r43 r">command</span>, <b>bool</b> <span id="r44 rd" class="r44 r">addToHistory</span>)
        {
            <b>if</b> (<span class="r43 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r43 r">command</span>));
            }
 
            <b>return</b> <a href="#5fb6b4633a60138b" class="i method">CoreCreatePipeline</a>(<span class="r43 r">command</span>, <span class="r44 r">addToHistory</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a nested pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Nested pipelines are needed for nested prompt scenario. Nested</span>
        <span class="c">///</span><span class="c"> prompt requires that we execute new pipelines( child pipelines)</span>
        <span class="c">///</span><span class="c"> while current pipeline (lets call it parent pipeline) is blocked.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Not supported in remoting</span>
        <span class="c">///</span><span class="c"> scenarios</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="939ee9c9b73a6bc8" href="../../../R/939ee9c9b73a6bc8.html" target="n" data-glyph="72,1" class="i method">CreateNestedPipeline</a>()
        {
            <b>return</b> <a href="#5fb6b4633a60138b" class="i method">CoreCreatePipeline</a>(<b>null</b>, <b>false</b>, <b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a nested pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A valid command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">addToHistory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true command is added to history.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A pipeline pre-filled with Commands specified in commandString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Not supported in remoting</span>
        <span class="c">///</span><span class="c"> scenarios</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="e5c05d880f34d087" href="../../../R/e5c05d880f34d087.html" target="n" data-glyph="72,1" class="i method">CreateNestedPipeline</a>(<b>string</b> <span id="r45 rd" class="r45 r">command</span>, <b>bool</b> <span id="r46 rd" class="r46 r">addToHistory</span>)
        {
            <b>if</b> (<span class="r45 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r45 r">command</span>));
            }
 
            <b>return</b> <a href="#5fb6b4633a60138b" class="i method">CoreCreatePipeline</a>(<span class="r45 r">command</span>, <span class="r46 r">addToHistory</span>, <b>true</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> CreatePipeline
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Running Pipeline Management
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add the pipeline to list of pipelines in execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pipeline to add to the</span>
        <span class="c">///</span><span class="c"> list of pipelines in execution</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown if the runspace is not in the Opened state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">pipeline</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="8972c614252a0f5e" href="../../../R/8972c614252a0f5e.html" target="n" data-glyph="74,1" class="i method">AddToRunningPipelineList</a>(<a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r47 rd" class="r47 r">pipeline</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r47 r">pipeline</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <b>if</b> (!<a href="#8cd4a23a305c8948" class="i field">_bypassRunspaceStateCheck</a> &amp;&amp;
                    <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a> &amp;&amp;
                    <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>) <span class="c">// Disconnected runspaces can have running pipelines.</span>
                {
                    <a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a> <span id="r48 rd" class="r48 r">e</span> =
                        <b>new</b> <a href="../../hostifaces/Connection.cs.html#ff1c45fc227fc3d7" class="t constructor">InvalidRunspaceStateException</a>
                        (
                            <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">RunspaceNotOpenForPipeline</span>,
                                <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>.<span class="i">ToString</span>()
                            ),
                            <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>,
                            <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>
                        );
                    <b>if</b> (<a href="#e2c1bde75e106663" class="k">this</a>.<a href="#912a4002c4156bbf" class="i property">ConnectionInfo</a> != <b>null</b>)
                    {
                        <span class="r48 r">e</span>.<span class="i">Source</span> = <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#912a4002c4156bbf" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a>;
                    }
 
                    <b>throw</b> <span class="r48 r">e</span>;
                }
 
                <span class="c">// Add the pipeline to list of Executing pipeline.</span>
                <span class="c">// Note:_runningPipelines is always accessed with the lock so</span>
                <span class="c">// there is no need to create a synchronized version of list</span>
                <a href="#53c9b4a51ec51f1c" class="i field">_runningPipelines</a>.<span class="i">Add</span>(<span class="r47 r">pipeline</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove the pipeline from list of pipelines in execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pipeline to remove from the</span>
        <span class="c">///</span><span class="c"> list of pipelines in execution</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">pipeline</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="265f5f610b55e0aa" href="../../../R/265f5f610b55e0aa.html" target="n" data-glyph="74,1" class="i method">RemoveFromRunningPipelineList</a>(<a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r49 rd" class="r49 r">pipeline</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r49 r">pipeline</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>,
                             <span class="s">&quot;Runspace should not be before open when pipeline is running&quot;</span>);
 
                <span class="c">// Remove the pipeline to list of Executing pipeline.</span>
                <span class="c">// Note:_runningPipelines is always accessed with the lock so</span>
                <span class="c">// there is no need to create a synchronized version of list</span>
                <a href="#53c9b4a51ec51f1c" class="i field">_runningPipelines</a>.<span class="i">Remove</span>(<span class="r49 r">pipeline</span>);
                <span class="r49 r">pipeline</span>.<a href="remotepipeline.cs.html#cf9dafc85fda0d41" class="i property">PipelineFinishedEvent</a>.<span class="i">Set</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check to see, if there is any other pipeline running in this</span>
        <span class="c">///</span><span class="c"> runspace. If not, then add this to the list of pipelines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pipeline to check and add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">syncCall</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">whether this is being called from</span>
        <span class="c">///</span><span class="c"> a synchronous method call</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="0d361b6b1aca5cf1" href="../../../R/0d361b6b1aca5cf1.html" target="n" data-glyph="74,1" class="i method">DoConcurrentCheckAndAddToRunningPipelines</a>(<a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r50 rd" class="r50 r">pipeline</span>, <b>bool</b> <span id="r51 rd" class="r51 r">syncCall</span>)
        {
            <span class="c">// Concurrency check should be done under runspace lock</span>
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <b>if</b> (<a href="#6db25a65f39972b1" class="i field">_bSessionStateProxyCallInProgress</a>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NoPipelineWhenSessionStateProxyInProgress</span>);
                }
 
                <span class="c">// Delegate to pipeline to do check if it is fine to invoke if another</span>
                <span class="c">// pipeline is running.</span>
                <span class="r50 r">pipeline</span>.<a href="remotepipeline.cs.html#1712c30986703063" class="i method">DoConcurrentCheck</a>(<span class="r51 r">syncCall</span>);
                <span class="c">// Finally add to the list of running pipelines.</span>
                <a href="#8972c614252a0f5e" class="i method">AddToRunningPipelineList</a>(<span class="r50 r">pipeline</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Running Pipeline Management
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> SessionState Proxy
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns SessionState proxy object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../../hostifaces/Connection.cs.html#6d877a4c99871852" class="t t">SessionStateProxy</a> <a id="a95702a8785fafcf" href="../../../R/a95702a8785fafcf.html" target="n" data-glyph="74,1" class="i method">GetSessionStateProxy</a>()
        {
            <b>return</b> <a href="#c58d08d927b17243" class="i field">_sessionStateProxy</a> ??= <b>new</b> <a href="#7a1b424d0f2d5775" class="t constructor">RemoteSessionStateProxy</a>(<a href="#e2c1bde75e106663" class="k">this</a>);
        }
 
        <b>private</b> <a href="#10d5d3dbc99047bc" class="t t">RemoteSessionStateProxy</a> <a id="c58d08d927b17243" href="../../../R/c58d08d927b17243.html" target="n" data-glyph="46,1" class="i field">_sessionStateProxy</a> = <b>null</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> SessionState Proxy
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <b>private void</b> <a id="1deb3a5deeccdfc6" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleRunspacePoolStateChanged</a>(<b>object</b> <span id="r52 rd" class="r52 r">sender</span>, <a href="../../hostifaces/RunspacePool.cs.html#ff0d60fc9c4fde6c" class="t t">RunspacePoolStateChangedEventArgs</a> <span id="r53 rd" class="r53 r">e</span>)
        {
            <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r54 rd" class="r54 r">newState</span> = (<a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>)<span class="r53 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#5c91747fcd8ee469" class="i property">RunspacePoolStateInfo</a>.<a href="../common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a>;
 
            <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r55 rd" class="r55 r">prevState</span> = <a href="#0bcbab8d2ca28248" class="i method">SetRunspaceState</a>(<span class="r54 r">newState</span>, <span class="r53 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#5c91747fcd8ee469" class="i property">RunspacePoolStateInfo</a>.<a href="../common/RunspacePoolStateInfo.cs.html#dcad0aee1f0be83d" class="i property">Reason</a>);
 
            <b>switch</b> (<span class="r54 r">newState</span>)
            {
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>:
                    <b>switch</b> (<span class="r55 r">prevState</span>)
                    {
                        <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#3990ad8b3e3feec7" class="i field">Opening</a>:
                            <span class="c">// For newly opened remote runspaces, set the debug mode based on the</span>
                            <span class="c">// associated host.  This involves running a remote command and is Ok</span>
                            <span class="c">// since this event is called on a worker thread and not a WinRM callback.</span>
                            <a href="#a36a635d44102ca6" class="i method">SetDebugModeOnOpen</a>();
                            <b>break</b>;
 
                        <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#1c027aab2310d438" class="i field">Connecting</a>:
                            <a href="#fb4264ddd97f64dd" class="i method">UpdateDisconnectExpiresOn</a>();
 
                            <span class="c">// Application private data containing server debug state is updated on</span>
                            <span class="c">// a *reconstruct* connect operation when _applicationPrivateData is null.</span>
                            <span class="c">// Pass new information to the debugger.</span>
                            <b>if</b> (<a href="#aca31638427f469c" class="i field">_applicationPrivateData</a> == <b>null</b>)
                            {
                                <a href="#aca31638427f469c" class="i field">_applicationPrivateData</a> = <a href="#b6a31aec547092fc" class="i method">GetApplicationPrivateData</a>();
                                <a href="#04769a8059f53592" class="i method">SetDebugInfo</a>(<a href="#aca31638427f469c" class="i field">_applicationPrivateData</a>);
                            }
 
                            <b>break</b>;
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>:
                    <a href="#fb4264ddd97f64dd" class="i method">UpdateDisconnectExpiresOn</a>();
                    <b>break</b>;
            }
 
            <a href="#fcc11b2e7d9b1911" class="i method">RaiseRunspaceStateEvents</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set debug mode on remote session based on the interactive host</span>
        <span class="c">///</span><span class="c"> setting, if available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a36a635d44102ca6" href="../../../R/a36a635d44102ca6.html" target="n" data-glyph="76,1" class="i method">SetDebugModeOnOpen</a>()
        {
            <span class="c">// Update client remote debugger based on server capabilities.</span>
            <a href="#aca31638427f469c" class="i field">_applicationPrivateData</a> = <a href="#b6a31aec547092fc" class="i method">GetApplicationPrivateData</a>();
            <b>bool</b> <span id="r56 rd" class="r56 r">serverSupportsDebugging</span> = <a href="#04769a8059f53592" class="i method">SetDebugInfo</a>(<a href="#aca31638427f469c" class="i field">_applicationPrivateData</a>);
            <b>if</b> (!<span class="r56 r">serverSupportsDebugging</span>) { <b>return</b>; }
 
            <span class="c">// Set server side initial debug mode based on interactive host.</span>
            <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a> <span id="r57 rd" class="r57 r">hostDebugMode</span> = <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="../../debugger/debugger.cs.html#cb8333d199605cfe" class="i field">Default</a>;
            <b>try</b>
            {
                <a href="../../hostifaces/MshHost.cs.html#8baf67daeba803e8" class="t t">IHostSupportsInteractiveSession</a> <span id="r58 rd" class="r58 r">interactiveHost</span> =
                    <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#836d29f1e729f0db" class="i property">Host</a> <b>as</b> <a href="../../hostifaces/MshHost.cs.html#8baf67daeba803e8" class="t t">IHostSupportsInteractiveSession</a>;
                <b>if</b> (<span class="r58 r">interactiveHost</span> != <b>null</b> &amp;&amp;
                    <span class="r58 r">interactiveHost</span>.<a href="../../hostifaces/MshHost.cs.html#bb0974f45a993c53" class="i property">Runspace</a> != <b>null</b> &amp;&amp;
                    <span class="r58 r">interactiveHost</span>.<a href="../../hostifaces/MshHost.cs.html#bb0974f45a993c53" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> != <b>null</b>)
                {
                    <span class="r57 r">hostDebugMode</span> = <span class="r58 r">interactiveHost</span>.<a href="../../hostifaces/MshHost.cs.html#bb0974f45a993c53" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="../../debugger/debugger.cs.html#cb370f0b35bef91f" class="i property">DebugMode</a>;
                }
            }
            <b>catch</b> (<a href="../../../utils/MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a>) { }
 
            <b>if</b> ((<span class="r57 r">hostDebugMode</span> &amp; <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="../../debugger/debugger.cs.html#36492991f477f6e1" class="i field">RemoteScript</a>) == <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="../../debugger/debugger.cs.html#36492991f477f6e1" class="i field">RemoteScript</a>)
            {
                <b>try</b>
                {
                    <a href="#8a40c1ce926f8e92" class="i field">_remoteDebugger</a>.<a href="#f13f581861467dbe" class="i method">SetDebugMode</a>(<span class="r57 r">hostDebugMode</span>);
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                }
            }
        }
 
        <b>private bool</b> <a id="04769a8059f53592" href="../../../R/04769a8059f53592.html" target="n" data-glyph="76,1" class="i method">SetDebugInfo</a>(<a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r59 rd" class="r59 r">psApplicationPrivateData</span>)
        {
            <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>? <span id="r60 rd" class="r60 r">debugMode</span> = <b>null</b>;
            <b>bool</b> <span id="r61 rd" class="r61 r">inDebugger</span> = <b>false</b>;
            <b>int</b> <span id="r62 rd" class="r62 r">breakpointCount</span> = 0;
            <b>bool</b> <span id="r63 rd" class="r63 r">breakAll</span> = <b>false</b>;
            <a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a> <span id="r64 rd" class="r64 r">unhandledBreakpointMode</span> = <a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="../../debugger/debugger.cs.html#e18be175ebce8c0f" class="i field">Ignore</a>;
 
            <b>if</b> (<span class="r59 r">psApplicationPrivateData</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r59 r">psApplicationPrivateData</span>.<span class="i">ContainsKey</span>(<a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#46a1c160f1d054dc" class="i field">DebugModeSetting</a>))
                {
                    <span class="r60 r">debugMode</span> = (<a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>)(<b>int</b>)<span class="r59 r">psApplicationPrivateData</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#46a1c160f1d054dc" class="i field">DebugModeSetting</a>];
                }
 
                <b>if</b> (<span class="r59 r">psApplicationPrivateData</span>.<span class="i">ContainsKey</span>(<a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#76c2c2baeca66c2e" class="i field">DebugStopState</a>))
                {
                    <span class="r61 r">inDebugger</span> = (<b>bool</b>)<span class="r59 r">psApplicationPrivateData</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#76c2c2baeca66c2e" class="i field">DebugStopState</a>];
                }
 
                <b>if</b> (<span class="r59 r">psApplicationPrivateData</span>.<span class="i">ContainsKey</span>(<a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#31fa1e5da6bfb371" class="i field">DebugBreakpointCount</a>))
                {
                    <span class="r62 r">breakpointCount</span> = (<b>int</b>)<span class="r59 r">psApplicationPrivateData</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#31fa1e5da6bfb371" class="i field">DebugBreakpointCount</a>];
                }
 
                <b>if</b> (<span class="r59 r">psApplicationPrivateData</span>.<span class="i">ContainsKey</span>(<a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#95446cab5697e706" class="i field">BreakAllSetting</a>))
                {
                    <span class="r63 r">breakAll</span> = (<b>bool</b>)<span class="r59 r">psApplicationPrivateData</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#95446cab5697e706" class="i field">BreakAllSetting</a>];
                }
 
                <b>if</b> (<span class="r59 r">psApplicationPrivateData</span>.<span class="i">ContainsKey</span>(<a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#2d5564777b060192" class="i field">UnhandledBreakpointModeSetting</a>))
                {
                    <span class="r64 r">unhandledBreakpointMode</span> = (<a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>)(<b>int</b>)<span class="r59 r">psApplicationPrivateData</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#2d5564777b060192" class="i field">UnhandledBreakpointModeSetting</a>];
                }
 
                <b>if</b> (<span class="r59 r">psApplicationPrivateData</span>.<span class="i">ContainsKey</span>(<a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#6f3eb6d7f2bfc1d8" class="i field">PSVersionTableName</a>))
                {
                    <a href="../../serialization.cs.html#04756020c00714fe" class="k">var</a> <span id="r65 rd" class="r65 r">psVersionTable</span> = <span class="r59 r">psApplicationPrivateData</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#6f3eb6d7f2bfc1d8" class="i field">PSVersionTableName</a>] <b>as</b> <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>;
                    <b>if</b> (<span class="r65 r">psVersionTable</span>.<span class="i">ContainsKey</span>(<a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#6452abbf2d72fad5" class="i field">PSVersionName</a>))
                    {
                        <a href="#97e1e286f840d73f" class="i property">ServerVersion</a> = <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r65 r">psVersionTable</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#6452abbf2d72fad5" class="i field">PSVersionName</a>]) <b>as</b> <span class="i">Version</span>;
                    }
                }
            }
 
            <b>if</b> (<span class="r60 r">debugMode</span> != <b>null</b>)
            {
                <span class="c">// Server supports remote debugging.  Create Debugger object for</span>
                <span class="c">// this remote runspace.</span>
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#8a40c1ce926f8e92" class="i field">_remoteDebugger</a> == <b>null</b>, <span class="s">&quot;Remote runspace should not have a debugger yet.&quot;</span>);
                <a href="#8a40c1ce926f8e92" class="i field">_remoteDebugger</a> = <b>new</b> <a href="#13260eea360b207c" class="t constructor">RemoteDebugger</a>(<a href="#e2c1bde75e106663" class="k">this</a>);
 
                <span class="c">// Set initial debugger state.</span>
                <a href="#8a40c1ce926f8e92" class="i field">_remoteDebugger</a>.<a href="#d9ea653db6a5f3fb" class="i method">SetClientDebugInfo</a>(<span class="r60 r">debugMode</span>, <span class="r61 r">inDebugger</span>, <span class="r62 r">breakpointCount</span>, <span class="r63 r">breakAll</span>, <span class="r64 r">unhandledBreakpointMode</span>, <a href="#97e1e286f840d73f" class="i property">ServerVersion</a>);
 
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Asserts if the current state of the runspace is BeforeOpen.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ebd59e3648e04793" href="../../../R/ebd59e3648e04793.html" target="n" data-glyph="76,1" class="i method">AssertIfStateIsBeforeOpen</a>()
        {
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <span class="c">// Call fails if RunspaceState is not BeforeOpen.</span>
                <b>if</b> (<a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>)
                {
                    <a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a> <span id="r66 rd" class="r66 r">e</span> =
                        <b>new</b> <a href="../../hostifaces/Connection.cs.html#ff1c45fc227fc3d7" class="t constructor">InvalidRunspaceStateException</a>
                        (
                            <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RunspaceStrings</span>.<span class="i">CannotOpenAgain</span>,
                                <b>new</b> <b>object</b>[] { <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>.<span class="i">ToString</span>() }
                            ),
                            <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>,
                            <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>
                        );
                    <b>throw</b> <span class="r66 r">e</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set the new runspace state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The new state.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An exception indicating the state change is the</span>
        <span class="c">///</span><span class="c"> result of an error, otherwise; null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Previous runspace state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the internal runspace state information member variable. It also</span>
        <span class="c">///</span><span class="c"> adds RunspaceStateInfo to a queue.</span>
        <span class="c">///</span><span class="c"> RaiseRunspaceStateEvents raises event for each item in this queue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <a id="0bcbab8d2ca28248" href="../../../R/0bcbab8d2ca28248.html" target="n" data-glyph="76,1" class="i method">SetRunspaceState</a>(<a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r67 rd" class="r67 r">state</span>, <span class="i">Exception</span> <span id="r68 rd" class="r68 r">reason</span>)
        {
            <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r69 rd" class="r69 r">prevState</span>;
 
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <span class="r69 r">prevState</span> = <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>;
                <b>if</b> (<span class="r67 r">state</span> != <span class="r69 r">prevState</span>)
                {
                    <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a> = <b>new</b> <a href="../../hostifaces/Connection.cs.html#80f3eb369399a1aa" class="t constructor">RunspaceStateInfo</a>(<span class="r67 r">state</span>, <span class="r68 r">reason</span>);
 
                    <span class="c">// Add _runspaceStateInfo to _runspaceEventQueue.</span>
                    <span class="c">// RaiseRunspaceStateEvents will raise event for each item</span>
                    <span class="c">// in this queue.</span>
                    <span class="c">// Note:We are doing clone here instead of passing the member</span>
                    <span class="c">// _runspaceStateInfo because we donot want outside</span>
                    <span class="c">// to change our runspace state.</span>
                    <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r70 rd" class="r70 r">previousAvailability</span> = <a href="#c575c4729e91c2ed" class="i field">_runspaceAvailability</a>;
 
                    <a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#0c1c7b064191c408" class="i method">UpdateRunspaceAvailability</a>(<a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>, <b>false</b>);
 
                    <a href="#5fdf1cbf2720e1d9" class="i field">_runspaceEventQueue</a>.<span class="i">Enqueue</span>(
                        <b>new</b> <a href="#774d0ce08b6ace59" class="t constructor">RunspaceEventQueueItem</a>(
                            <a href="#06c7b1d55d2a9713" class="i field">_runspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#d8101f7e931fd53a" class="i method">Clone</a>(),
                            <span class="r70 r">previousAvailability</span>,
                            <a href="#c575c4729e91c2ed" class="i field">_runspaceAvailability</a>));
 
                    <a href="../../../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogOperationalVerbose</span>(<a href="../common/PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="../common/PSETWTracer.cs.html#da437a82f69eef5b" class="i field">RunspaceStateChange</a>, <a href="../common/PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="../common/PSETWTracer.cs.html#399fd86ea109ec79" class="i field">Open</a>,
                                <a href="../common/PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="../common/PSETWTracer.cs.html#752e56066810e4f0" class="i field">CreateRunspace</a>, <a href="../common/PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="../common/PSETWTracer.cs.html#05d709c2010b41d5" class="i field">UseAlwaysOperational</a>,
                                <span class="r67 r">state</span>.<span class="i">ToString</span>());
                }
            }
 
            <b>return</b> <span class="r69 r">prevState</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises events for changes in runspace state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="fcc11b2e7d9b1911" href="../../../R/fcc11b2e7d9b1911.html" target="n" data-glyph="76,1" class="i method">RaiseRunspaceStateEvents</a>()
        {
            <span class="i">Queue</span>&lt;<a href="#ba808de64a8d1159" class="t t">RunspaceEventQueueItem</a>&gt; <span id="r71 rd" class="r71 r">tempEventQueue</span> = <b>null</b>;
            <span class="i">EventHandler</span>&lt;<a href="../../hostifaces/Connection.cs.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a>&gt; <span id="r72 rd" class="r72 r">stateChanged</span> = <b>null</b>;
            <b>bool</b> <span id="r73 rd" class="r73 r">hasAvailabilityChangedSubscribers</span> = <b>false</b>;
 
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <span class="r72 r">stateChanged</span> = <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#a776d5953488773f" class="i">StateChanged</a>;
                <span class="r73 r">hasAvailabilityChangedSubscribers</span> = <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#bc1cd084f3386521" class="i property">HasAvailabilityChangedSubscribers</a>;
 
                <b>if</b> (<span class="r72 r">stateChanged</span> != <b>null</b> || <span class="r73 r">hasAvailabilityChangedSubscribers</span>)
                {
                    <span class="r71 r">tempEventQueue</span> = <a href="#5fdf1cbf2720e1d9" class="i field">_runspaceEventQueue</a>;
                    <a href="#5fdf1cbf2720e1d9" class="i field">_runspaceEventQueue</a> = <b>new</b> <span class="i">Queue</span>&lt;<a href="#ba808de64a8d1159" class="t t">RunspaceEventQueueItem</a>&gt;();
                }
                <b>else</b>
                {
                    <span class="c">// Clear the events if there are no EventHandlers. This</span>
                    <span class="c">// ensures that events do not get called for state</span>
                    <span class="c">// changes prior to their registration.</span>
                    <a href="#5fdf1cbf2720e1d9" class="i field">_runspaceEventQueue</a>.<span class="i">Clear</span>();
                }
            }
 
            <b>if</b> (<span class="r71 r">tempEventQueue</span> != <b>null</b>)
            {
                <b>while</b> (<span class="r71 r">tempEventQueue</span>.<span class="i">Count</span> &gt; 0)
                {
                    <a href="#ba808de64a8d1159" class="t t">RunspaceEventQueueItem</a> <span id="r74 rd" class="r74 r">queueItem</span> = <span class="r71 r">tempEventQueue</span>.<span class="i">Dequeue</span>();
 
                    <b>if</b> (<span class="r73 r">hasAvailabilityChangedSubscribers</span> &amp;&amp; <span class="r74 r">queueItem</span>.<a href="#ad41641c6d3f8c8c" class="i field">NewRunspaceAvailability</a> != <span class="r74 r">queueItem</span>.<a href="#87cf7de1bfabb37b" class="i field">CurrentRunspaceAvailability</a>)
                    {
                        <a href="#e2c1bde75e106663" class="k">this</a>.<a href="#ee1aba2073fccf99" class="i method">OnAvailabilityChanged</a>(<b>new</b> <a href="../../hostifaces/Connection.cs.html#38ab95beeaebfcf6" class="t constructor">RunspaceAvailabilityEventArgs</a>(<span class="r74 r">queueItem</span>.<a href="#ad41641c6d3f8c8c" class="i field">NewRunspaceAvailability</a>));
                    }
 
                    <span class="c">// Exception raised by events are not error condition for runspace</span>
                    <span class="c">// object.</span>
                    <b>if</b> (<span class="r72 r">stateChanged</span> != <b>null</b>)
                    {
                        <b>try</b>
                        {
                            <span class="r72 r">stateChanged</span>(<a href="#e2c1bde75e106663" class="k">this</a>, <b>new</b> <a href="../../hostifaces/Connection.cs.html#6e0b792adcfea770" class="t constructor">RunspaceStateEventArgs</a>(<span class="r74 r">queueItem</span>.<a href="#c2ece9a2879fa828" class="i field">RunspaceStateInfo</a>));
                        }
                        <b>catch</b> (<span class="i">Exception</span>)
                        {
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">addToHistory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">isNested</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="5fb6b4633a60138b" href="../../../R/5fb6b4633a60138b.html" target="n" data-glyph="76,1" class="i method">CoreCreatePipeline</a>(<b>string</b> <span id="r75 rd" class="r75 r">command</span>, <b>bool</b> <span id="r76 rd" class="r76 r">addToHistory</span>, <b>bool</b> <span id="r77 rd" class="r77 r">isNested</span>)
        {
            <b>return</b> <b>new</b> <a href="remotepipeline.cs.html#715b55e2c4cff8c1" class="t constructor">RemotePipeline</a>(<a href="#e2c1bde75e106663" class="k">this</a>, <span class="r75 r">command</span>, <span class="r76 r">addToHistory</span>, <span class="r77 r">isNested</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits till all the pipelines running in the runspace have</span>
        <span class="c">///</span><span class="c"> finished execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Finishof&quot;</span>)]
        <b>private bool</b> <a id="f6ee4443bbc388aa" href="../../../R/f6ee4443bbc388aa.html" target="n" data-glyph="76,1" class="i method">WaitForFinishofPipelines</a>()
        {
            <span class="c">// Take a snapshot of list of active pipelines.</span>
            <span class="c">// Note:Before we enter to this CloseHelper routine</span>
            <span class="c">// CoreClose has already set the state of Runspace</span>
            <span class="c">// to closing. So no new pipelines can be executed on this</span>
            <span class="c">// runspace and so no new pipelines will be added to</span>
            <span class="c">// _runningPipelines. However we still need to lock because</span>
            <span class="c">// running pipelines can be removed from this.</span>
            <a href="remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a>[] <span id="r78 rd" class="r78 r">runningPipelines</span>;
 
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <span class="r78 r">runningPipelines</span> = <a href="#53c9b4a51ec51f1c" class="i field">_runningPipelines</a>.<span class="i">ToArray</span>();
            }
 
            <b>if</b> (<span class="r78 r">runningPipelines</span>.<span class="i">Length</span> &gt; 0)
            {
                <span class="i">WaitHandle</span>[] <span id="r79 rd" class="r79 r">waitHandles</span> = <b>new</b> <span class="i">WaitHandle</span>[<span class="r78 r">runningPipelines</span>.<span class="i">Length</span>];
 
                <b>for</b> (<b>int</b> <span id="r80 rd" class="r80 r">i</span> = 0; <span class="r80 r">i</span> &lt; <span class="r78 r">runningPipelines</span>.<span class="i">Length</span>; <span class="r80 r">i</span>++)
                {
                    <span class="r79 r">waitHandles</span>[<span class="r80 r">i</span>] = <span class="r78 r">runningPipelines</span>[<span class="r80 r">i</span>].<a href="remotepipeline.cs.html#cf9dafc85fda0d41" class="i property">PipelineFinishedEvent</a>;
                }
 
                <b>return</b> <span class="i">WaitHandle</span>.<span class="i">WaitAll</span>(<span class="r79 r">waitHandles</span>);
            }
            <b>else</b>
            {
                <b>return</b> <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the currently executing pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Internal because it is needed by invoke-history</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="9ab3dedcf11ea947" href="../../../R/9ab3dedcf11ea947.html" target="n" data-glyph="74,1" class="i method">GetCurrentlyRunningPipeline</a>()
        {
            <b>lock</b> (<a href="#1f24f199e5aec10e" class="i field">_syncRoot</a>)
            {
                <b>if</b> (<a href="#53c9b4a51ec51f1c" class="i field">_runningPipelines</a>.<span class="i">Count</span> != 0)
                {
                    <b>return</b> (<a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a>)<a href="#53c9b4a51ec51f1c" class="i field">_runningPipelines</a>[<a href="#53c9b4a51ec51f1c" class="i field">_runningPipelines</a>.<span class="i">Count</span> - 1];
                }
                <b>else</b>
                {
                    <b>return</b> <b>null</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles any host calls received from the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender of this information, unused.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">arguments describing this event, contains</span>
        <span class="c">///</span><span class="c"> a RemoteHostCall object</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="425b7a4d696d8bab" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleHostCallReceived</a>(<b>object</b> <span id="r81 rd" class="r81 r">sender</span>, <a href="../common/misc.cs.html#16d1e16a7ed9f8cc" class="t t">RemoteDataEventArgs</a>&lt;<a href="../common/WireDataFormat/RemoteHost.cs.html#8bf334b011b63f92" class="t t">RemoteHostCall</a>&gt; <span id="r82 rd" class="r82 r">eventArgs</span>)
        {
            <a href="ClientMethodExecutor.cs.html#6caf7f9a511e4a89" class="t t">ClientMethodExecutor</a>.<span class="i">Dispatch</span>(
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#6629c704c27c6e09" class="i property">DataStructureHandler</a>.<a href="RemotingProtocol2.cs.html#38c23f3a35d84598" class="i property">TransportManager</a>,
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#836d29f1e729f0db" class="i property">Host</a>,
                <b>null</b>,       <span class="c">/* error stream */</span>
                <b>null</b>,       <span class="c">/* method executor stream */</span>
                <b>false</b>,      <span class="c">/* is method stream enabled */</span>
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>,
                <span class="i">Guid</span>.<span class="i">Empty</span>, <span class="c">/* powershell id */</span>
                <span class="r82 r">eventArgs</span>.<a href="../common/misc.cs.html#0896dbbd394ce2e6" class="i property">Data</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When the client remote session reports a URI redirection, this method will report the</span>
        <span class="c">///</span><span class="c"> message to the user as a Warning using Host method calls.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="346bdca50d0cf259" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleURIDirectionReported</a>(<b>object</b> <span id="r83 rd" class="r83 r">sender</span>, <a href="../common/misc.cs.html#16d1e16a7ed9f8cc" class="t t">RemoteDataEventArgs</a>&lt;<span class="i">Uri</span>&gt; <span id="r84 rd" class="r84 r">eventArgs</span>)
        {
            <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r85 rd" class="r85 r">wsmanConnectionInfo</span> = <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>;
            <b>if</b> (<span class="r85 r">wsmanConnectionInfo</span> != <b>null</b>)
            {
                <span class="c">// change the runspace&#39;s uri to the new URI.</span>
                <span class="r85 r">wsmanConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#eb73ffdb9b586505" class="i property">ConnectionUri</a> = <span class="r84 r">eventArgs</span>.<a href="../common/misc.cs.html#0896dbbd394ce2e6" class="i property">Data</a>;
                <a href="#f21dad86b0e2d67e" class="i">URIRedirectionReported</a>.<span class="i">SafeInvoke</span>(<a href="#e2c1bde75e106663" class="k">this</a>, <span class="r84 r">eventArgs</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Forward the events from the runspace pool to the current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8251aea07e8de5b7" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleRunspacePoolForwardEvent</a>(<b>object</b> <span id="r86 rd" class="r86 r">sender</span>, <a href="../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r87 rd" class="r87 r">e</span>)
        {
            <b>if</b> (<span class="r87 r">e</span>.<a href="../../EventManager.cs.html#d8b1da7bcf77174b" class="i property">SourceIdentifier</a>.<span class="i">Equals</span>(<a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#cac79a3f925f2c62" class="i field">RemoteDebuggerStopEvent</a>))
            {
                <span class="c">// Special processing for forwarded remote DebuggerStop event.</span>
                <a href="#5183f3d7600aeaf8" class="i">RemoteDebuggerStop</a>.<span class="i">SafeInvoke</span>(<a href="#e2c1bde75e106663" class="k">this</a>, <span class="r87 r">e</span>);
            }
            <b>else</b> <b>if</b> (<span class="r87 r">e</span>.<a href="../../EventManager.cs.html#d8b1da7bcf77174b" class="i property">SourceIdentifier</a>.<span class="i">Equals</span>(<a href="#89199d5c3f22d94e" class="t t">RemoteDebugger</a>.<a href="#9073ab7796b6f405" class="i field">RemoteDebuggerBreakpointUpdatedEvent</a>))
            {
                <span class="c">// Special processing for forwarded remote DebuggerBreakpointUpdated event.</span>
                <a href="#50319f28a3da4cc3" class="i">RemoteDebuggerBreakpointUpdated</a>.<span class="i">SafeInvoke</span>(<a href="#e2c1bde75e106663" class="k">this</a>, <span class="r87 r">e</span>);
            }
            <b>else</b>
            {
                <a href="#bb4a6170f9ae0254" class="i field">_eventManager</a>.<a href="../../EventManager.cs.html#58de5d4482103840" class="i method">AddForwardedEvent</a>(<span class="r87 r">e</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The session has been successfully created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="44a3a548f8fcae93" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleSessionCreateCompleted</a>(<b>object</b> <span id="r88 rd" class="r88 r">sender</span>, <a href="../fanin/BaseTransportManager.cs.html#7d43cc7a3ac54680" class="t t">CreateCompleteEventArgs</a> <span id="r89 rd" class="r89 r">eventArgs</span>)
        {
            <span class="c">// Update connectionInfo with updated information from the transport.</span>
            <b>if</b> (<span class="r89 r">eventArgs</span> != <b>null</b>)
            {
                <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#0c117c8cb5b1de8b" class="i property">IdleTimeout</a> = <span class="r89 r">eventArgs</span>.<a href="../fanin/BaseTransportManager.cs.html#42bc94ec2a83fd45" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#0c117c8cb5b1de8b" class="i property">IdleTimeout</a>;
                <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#8f5fff031b021f8b" class="i property">MaxIdleTimeout</a> = <span class="r89 r">eventArgs</span>.<a href="../fanin/BaseTransportManager.cs.html#42bc94ec2a83fd45" class="i property">ConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#8f5fff031b021f8b" class="i property">MaxIdleTimeout</a>;
                <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r90 rd" class="r90 r">wsmanConnectionInfo</span> = <a href="#c4391ba3b1d570d8" class="i field">_connectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>;
                <b>if</b> (<span class="r90 r">wsmanConnectionInfo</span> != <b>null</b>)
                {
                    <span class="r90 r">wsmanConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#10ef35a810ea13c2" class="i property">OutputBufferingMode</a> =
                        ((<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>)<span class="r89 r">eventArgs</span>.<a href="../fanin/BaseTransportManager.cs.html#42bc94ec2a83fd45" class="i property">ConnectionInfo</a>).<a href="../common/RunspaceConnectionInfo.cs.html#10ef35a810ea13c2" class="i property">OutputBufferingMode</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Updates runspace DisconnectedOn/ExpiresOn based on RS Pool connectionInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="fb4264ddd97f64dd" href="../../../R/fb4264ddd97f64dd.html" target="n" data-glyph="76,1" class="i method">UpdateDisconnectExpiresOn</a>()
        {
            <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r91 rd" class="r91 r">wsmanConnectionInfo</span> = <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#adb799cd03979b7a" class="i property">ConnectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>;
            <b>if</b> (<span class="r91 r">wsmanConnectionInfo</span> != <b>null</b>)
            {
                <a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#6c141feecce4dc09" class="i property">DisconnectedOn</a> = <span class="r91 r">wsmanConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#f332a5875710beac" class="i property">DisconnectedOn</a>;
                <a href="#e2c1bde75e106663" class="k">this</a>.<a href="../../hostifaces/Connection.cs.html#89b751705e0b934c" class="i property">ExpiresOn</a> = <span class="r91 r">wsmanConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#98dcfd36463927fb" class="i property">ExpiresOn</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if another Invoke-Command is executing</span>
        <span class="c">///</span><span class="c"> in this runspace in the currently running local pipeline</span>
        <span class="c">///</span><span class="c"> ahead on the specified invoke-command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">invokeCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">current invoke-command</span>
        <span class="c">///</span><span class="c"> instance</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">localPipelineId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Local pipeline id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True, if another invoke-command is running</span>
        <span class="c">///</span><span class="c"> before, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6bf1c2d23ce75a91" href="../../../R/6bf1c2d23ce75a91.html" target="n" data-glyph="74,1" class="i method">IsAnotherInvokeCommandExecuting</a>(<a href="../commands/InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a> <span id="r92 rd" class="r92 r">invokeCommand</span>,
            <b>long</b> <span id="r93 rd" class="r93 r">localPipelineId</span>)
        {
            <span class="c">// the invoke-command&#39;s pipeline should be the currently</span>
            <span class="c">// running pipeline. This will ensure that, we do not</span>
            <span class="c">// return true, when one invoke-command is running as a</span>
            <span class="c">// job and another invoke-command is entered at the</span>
            <span class="c">// console prompt</span>
            <b>if</b> (<a href="#38210701210a18cc" class="i field">_currentLocalPipelineId</a> != <span class="r93 r">localPipelineId</span> &amp;&amp; <a href="#38210701210a18cc" class="i field">_currentLocalPipelineId</a> != 0)
            {
                <b>return</b> <b>false</b>;
            }
            <b>else</b>
            {
                <span class="c">// the local pipeline ids are the same</span>
                <span class="c">// this invoke command is running may be</span>
                <span class="c">// running in the same pipeline as another</span>
                <span class="c">// invoke command</span>
                <b>if</b> (<a href="#6b32b618e8c80fbb" class="i field">_currentInvokeCommand</a> == <b>null</b>)
                {
                    <span class="c">// this is the first invoke-command, just</span>
                    <span class="c">// set the reference</span>
                    <a href="#3527d2ec9ac919ca" class="i method">SetCurrentInvokeCommand</a>(<span class="r92 r">invokeCommand</span>, <span class="r93 r">localPipelineId</span>);
                    <b>return</b> <b>false</b>;
                }
                <b>else</b> <b>if</b> (<a href="#6b32b618e8c80fbb" class="i field">_currentInvokeCommand</a>.<span class="i">Equals</span>(<span class="r92 r">invokeCommand</span>))
                {
                    <span class="c">// the currently active invoke command is the one</span>
                    <span class="c">// specified</span>
                    <b>return</b> <b>false</b>;
                }
                <b>else</b>
                {
                    <span class="c">// the local pipeline id is the same and there</span>
                    <span class="c">// is another invoke command that is active already</span>
                    <b>return</b> <b>true</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Keeps track of the current invoke command executing</span>
        <span class="c">///</span><span class="c"> within the current local pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">invokeCommand</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">reference to invoke command</span>
        <span class="c">///</span><span class="c"> which is currently being processed</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">localPipelineId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The local pipeline id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3527d2ec9ac919ca" href="../../../R/3527d2ec9ac919ca.html" target="n" data-glyph="74,1" class="i method">SetCurrentInvokeCommand</a>(<a href="../commands/InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a> <span id="r94 rd" class="r94 r">invokeCommand</span>,
            <b>long</b> <span id="r95 rd" class="r95 r">localPipelineId</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r94 r">invokeCommand</span> != <b>null</b>, <span class="s">&quot;InvokeCommand instance cannot be null, use ClearInvokeCommand() method to reset current command&quot;</span>);
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r95 r">localPipelineId</span> != 0, <span class="s">&quot;Local pipeline id needs to be supplied - cannot be 0&quot;</span>);
 
            <a href="#6b32b618e8c80fbb" class="i field">_currentInvokeCommand</a> = <span class="r94 r">invokeCommand</span>;
            <a href="#38210701210a18cc" class="i field">_currentLocalPipelineId</a> = <span class="r95 r">localPipelineId</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the current invoke-command reference stored within</span>
        <span class="c">///</span><span class="c"> this remote runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b4c12673c79a851b" href="../../../R/b4c12673c79a851b.html" target="n" data-glyph="74,1" class="i method">ClearInvokeCommand</a>()
        {
            <a href="#38210701210a18cc" class="i field">_currentLocalPipelineId</a> = 0;
            <a href="#6b32b618e8c80fbb" class="i field">_currentInvokeCommand</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Aborts any current Opening process.  If runspace is not opening then this has no effect.</span>
        <span class="c">///</span><span class="c"> This is currently *only* for named pipe connections where a connection</span>
        <span class="c">///</span><span class="c"> to a process is limited to a single client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="18a6a41cecaa5cb6" href="../../../R/18a6a41cecaa5cb6.html" target="n" data-glyph="74,1" class="i method">AbortOpen</a>()
        {
            <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/OutOfProcTransportManager.cs.html#96f96eb323f5892b" class="t t">NamedPipeClientSessionTransportManager</a> <span id="r96 rd" class="r96 r">transportManager</span> =
                <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#6629c704c27c6e09" class="i property">DataStructureHandler</a>.<a href="RemotingProtocol2.cs.html#38c23f3a35d84598" class="i property">TransportManager</a> <b>as</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/OutOfProcTransportManager.cs.html#96f96eb323f5892b" class="t t">NamedPipeClientSessionTransportManager</a>;
 
            <b>if</b> (<span class="r96 r">transportManager</span> != <b>null</b>)
            {
                <span class="r96 r">transportManager</span>.<a href="../fanin/OutOfProcTransportManager.cs.html#30bba8565888ba13" class="i method">AbortConnect</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Misc Properties / Events
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace pool that this remote runspace wraps.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <a id="52e4a4fcfd3da6a7" href="../../../R/52e4a4fcfd3da6a7.html" target="n" data-glyph="104,1" class="i property">RunspacePool</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> EventHandler used to report connection URI redirections to the application.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<a href="../common/misc.cs.html#16d1e16a7ed9f8cc" class="t t">RemoteDataEventArgs</a>&lt;<span class="i">Uri</span>&gt;&gt; <a id="f21dad86b0e2d67e" href="../../../R/f21dad86b0e2d67e.html" target="n" data-glyph="32,1" class="i">URIRedirectionReported</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Misc Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Application private data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Private data to be used by applications built on top of PowerShell.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Remote runspace gets its application private data from the server (when creating the remote runspace pool)</span>
        <span class="c">///</span><span class="c"> - calling this method on a remote runspace will block until the data is received from the server.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Runspaces that are part of a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> inherit application private data from the pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="b6a31aec547092fc" href="../../../R/b6a31aec547092fc.html" target="n" data-glyph="72,1" class="i method">GetApplicationPrivateData</a>()
        {
            <b>try</b>
            {
                <b>return</b> <a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#9e2816b4c51f890c" class="i method">GetApplicationPrivateData</a>();
            }
            <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r97 rd" class="r97 r">e</span>)
            {
                <b>throw</b> <span class="r97 r">e</span>.<a href="../../hostifaces/RunspacePool.cs.html#aeea64df1e9df609" class="i method">ToInvalidRunspaceStateException</a>();
            }
        }
 
        <b>internal override void</b> <a id="77b81551981bfe57" href="../../../R/77b81551981bfe57.html" target="n" data-glyph="74,1" class="i method">SetApplicationPrivateData</a>(<a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r98 rd" class="r98 r">applicationPrivateData</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;RemoteRunspace.SetApplicationPrivateData shouldn&#39;t be called - this runspace does not belong to a runspace pool [although it does use a remote runspace pool internally]&quot;</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Remote Debugger
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> RemoteDebugger.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="89199d5c3f22d94e" href="../../../R/89199d5c3f22d94e.html" target="n" data-glyph="2,0" class="t t">RemoteDebugger</a> : <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Members
 
        <b>private readonly</b> <a href="#e2c1bde75e106663" class="t t">RemoteRunspace</a> <a id="f97a9658009910e2" href="../../../R/f97a9658009910e2.html" target="n" data-glyph="46,1" class="i field">_runspace</a>;
        <b>private</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="3cd7413a018a656d" href="../../../R/3cd7413a018a656d.html" target="n" data-glyph="46,1" class="i field">_psDebuggerCommand</a>;
        <b>private bool</b> <a id="d77c22603b7175dd" href="../../../R/d77c22603b7175dd.html" target="n" data-glyph="46,1" class="i field">_remoteDebugSupported</a>;
        <b>private bool</b> <a id="78cd3ebe65165c1c" href="../../../R/78cd3ebe65165c1c.html" target="n" data-glyph="46,1" class="i field">_isActive</a>;
        <b>private int</b> <a id="0e7b79c01162da44" href="../../../R/0e7b79c01162da44.html" target="n" data-glyph="46,1" class="i field">_breakpointCount</a>;
        <b>private</b> <a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#8eec5a9ceb3db518" class="t t">RemoteDebuggingCapability</a> <a id="9c785cdcdae016b3" href="../../../R/9c785cdcdae016b3.html" target="n" data-glyph="46,1" class="i field">_remoteDebuggingCapability</a>;
        <b>private bool</b>? <a id="5c3a950369be9ecf" href="../../../R/5c3a950369be9ecf.html" target="n" data-glyph="46,1" class="i field">_remoteBreakpointManagementIsSupported</a>;
        <b>private volatile bool</b> <a id="50abf49e9e7ce258" href="../../../R/50abf49e9e7ce258.html" target="n" data-glyph="46,1" class="i field">_handleDebuggerStop</a>;
        <b>private bool</b> <a id="a5bedc596bafc770" href="../../../R/a5bedc596bafc770.html" target="n" data-glyph="46,1" class="i field">_isDebuggerSteppingEnabled</a>;
        <b>private</b> <a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a> <a id="d1107ffa0e28f788" href="../../../R/d1107ffa0e28f788.html" target="n" data-glyph="46,1" class="i field">_unhandledBreakpointMode</a>;
        <b>private bool</b> <a id="35ad674e41d80b9e" href="../../../R/35ad674e41d80b9e.html" target="n" data-glyph="46,1" class="i field">_detachCommand</a>;
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
        <span class="c">// Windows impersonation flow</span>
        <b>private</b> <span class="i">WindowsIdentity</span> <a id="f90d06bc7ea4f713" href="../../../R/f90d06bc7ea4f713.html" target="n" data-glyph="46,1" class="i field">_identityToPersonate</a>;
        <b>private bool</b> <a id="ff59bdc1777b8716" href="../../../R/ff59bdc1777b8716.html" target="n" data-glyph="46,1" class="i field">_identityPersonationChecked</a>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RemoteDebuggerStopEvent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="cac79a3f925f2c62" href="../../../R/cac79a3f925f2c62.html" target="n" data-glyph="6,1" class="i field">RemoteDebuggerStopEvent</a> = <span class="s">&quot;PSInternalRemoteDebuggerStopEvent&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RemoteDebuggerBreakpointUpdatedEvent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="9073ab7796b6f405" href="../../../R/9073ab7796b6f405.html" target="n" data-glyph="6,1" class="i field">RemoteDebuggerBreakpointUpdatedEvent</a> = <span class="s">&quot;PSInternalRemoteDebuggerBreakpointUpdatedEvent&quot;</span>;
 
        <span class="c">// Remote debugger settings</span>
        <b>public const string</b> <a id="46a1c160f1d054dc" href="../../../R/46a1c160f1d054dc.html" target="n" data-glyph="6,1" class="i field">DebugModeSetting</a> = <span class="s">&quot;DebugMode&quot;</span>;
        <b>public const string</b> <a id="76c2c2baeca66c2e" href="../../../R/76c2c2baeca66c2e.html" target="n" data-glyph="6,1" class="i field">DebugStopState</a> = <span class="s">&quot;DebugStop&quot;</span>;
        <b>public const string</b> <a id="31fa1e5da6bfb371" href="../../../R/31fa1e5da6bfb371.html" target="n" data-glyph="6,1" class="i field">DebugBreakpointCount</a> = <span class="s">&quot;DebugBreakpointCount&quot;</span>;
        <b>public const string</b> <a id="95446cab5697e706" href="../../../R/95446cab5697e706.html" target="n" data-glyph="6,1" class="i field">BreakAllSetting</a> = <span class="s">&quot;BreakAll&quot;</span>;
        <b>public const string</b> <a id="2d5564777b060192" href="../../../R/2d5564777b060192.html" target="n" data-glyph="6,1" class="i field">UnhandledBreakpointModeSetting</a> = <span class="s">&quot;UnhandledBreakpointMode&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <b>private</b> <a id="88c6b9ca5a8c6746" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">RemoteDebugger</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Associated remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="13260eea360b207c" href="../../../R/13260eea360b207c.html" target="n" data-glyph="72,1" class="t constructor">RemoteDebugger</a>(<a href="#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r99 rd" class="r99 r">runspace</span>)
        {
            <b>if</b> (<span class="r99 r">runspace</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r99 r">runspace</span>));
            }
 
            <a href="#f97a9658009910e2" class="i field">_runspace</a> = <span class="r99 r">runspace</span>;
 
            <a href="#d1107ffa0e28f788" class="i field">_unhandledBreakpointMode</a> = <a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="../../debugger/debugger.cs.html#e18be175ebce8c0f" class="i field">Ignore</a>;
 
            <span class="c">// Hook up remote debugger forwarded event handlers.</span>
            <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#5183f3d7600aeaf8" class="i">RemoteDebuggerStop</a> += <span class="i">HandleForwardedDebuggerStopEvent</span>;
            <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#50319f28a3da4cc3" class="i">RemoteDebuggerBreakpointUpdated</a> += <span class="i">HandleForwardedDebuggerBreakpointUpdatedEvent</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Class overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process debugger command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debugger PSCommand.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommandResults.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="b63181f1a274a7e9" href="../../../R/b63181f1a274a7e9.html" target="n" data-glyph="72,1" class="i method">ProcessCommand</a>(<a href="../../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r100 rd" class="r100 r">command</span>, <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r101 rd" class="r101 r">output</span>)
        {
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
            <a href="#35ad674e41d80b9e" class="i field">_detachCommand</a> = <b>false</b>;
 
            <b>if</b> (<span class="r100 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r100 r">command</span>));
            }
 
            <b>if</b> (<span class="r101 r">output</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r101 r">output</span>));
            }
 
            <b>if</b> (!<a href="../../debugger/debugger.cs.html#e0706ae30c7c5128" class="i property">DebuggerStopped</a>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(
                    <span class="i">DebuggerStrings</span>.<span class="i">CannotProcessDebuggerCommandNotStopped</span>,
                    <b>null</b>,
                    <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a>.<a href="../../debugger/debugger.cs.html#bd971f01dcc26533" class="i field">CannotProcessCommandNotStopped</a>,
                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                    <b>null</b>);
            }
 
            <a href="../../debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <span id="r102 rd" class="r102 r">results</span> = <b>null</b>;
 
            <span class="c">// Execute command on server.</span>
            <b>bool</b> <span id="r103 rd" class="r103 r">executionError</span> = <b>false</b>;
            <b>using</b> (<a href="#3cd7413a018a656d" class="i field">_psDebuggerCommand</a> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
            {
                <b>foreach</b> (<b>var</b> <span id="r104 rd" class="r104 r">cmd</span> <b>in</b> <span class="r100 r">command</span>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>)
                {
                    <span class="r104 r">cmd</span>.<span class="i">MergeMyResults</span>(<a href="../../hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="../../hostifaces/Command.cs.html#037d2fe8e28834f2" class="i field">All</a>, <a href="../../hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="../../hostifaces/Command.cs.html#c8d2233323d43e84" class="i field">Output</a>);
                    <a href="#3cd7413a018a656d" class="i field">_psDebuggerCommand</a>.<span class="i">AddCommand</span>(<span class="r104 r">cmd</span>);
                }
 
                <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r105 rd" class="r105 r">internalOutput</span> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
                <span class="r105 r">internalOutput</span>.<a href="../../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += (<span id="r106 rd" class="r106 r">sender</span>, <span id="r107 rd" class="r107 r">args</span>) =&gt;
                    {
                        <b>foreach</b> (<b>var</b> <span id="r108 rd" class="r108 r">item</span> <b>in</b> <span class="r105 r">internalOutput</span>.<a href="../../hostifaces/PSDataCollection.cs.html#403be942120e2d89" class="i method">ReadAll</a>())
                        {
                            <b>if</b> (<span class="r108 r">item</span> == <b>null</b>) { <b>return</b>; }
 
                            <a href="../../debugger/debugger.cs.html#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <span id="r109 rd" class="r109 r">dbgCmd</span> = <span class="r108 r">item</span>.<span class="i">BaseObject</span> <b>as</b> <a href="../../debugger/debugger.cs.html#bcdf979426ef3d7b" class="t t">DebuggerCommand</a>;
                            <b>if</b> (<span class="r109 r">dbgCmd</span> != <b>null</b>)
                            {
                                <b>bool</b> <span id="r110 rd" class="r110 r">executedByDebugger</span> = (<span class="r109 r">dbgCmd</span>.<a href="../../debugger/debugger.cs.html#4aad237c27ce8bd0" class="i property">ResumeAction</a> != <b>null</b> || <span class="r109 r">dbgCmd</span>.<a href="../../debugger/debugger.cs.html#ed0eefa60321fd1e" class="i property">ExecutedByDebugger</a>);
                                <span class="r102 r">results</span> = <b>new</b> <a href="../../debugger/debugger.cs.html#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<span class="r109 r">dbgCmd</span>.<a href="../../debugger/debugger.cs.html#4aad237c27ce8bd0" class="i property">ResumeAction</a>, <span class="r110 r">executedByDebugger</span>);
                            }
                            <b>else</b> <b>if</b> (<span class="r108 r">item</span>.<span class="i">BaseObject</span> <b>is</b> <a href="../../debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a>)
                            {
                                <span class="r102 r">results</span> = <span class="r108 r">item</span>.<span class="i">BaseObject</span> <b>as</b> <a href="../../debugger/debugger.cs.html#279d714bfd5743f3" class="t t">DebuggerCommandResults</a>;
                            }
                            <b>else</b>
                            {
                                <span class="r101 r">output</span>.<span class="i">Add</span>(<span class="r108 r">item</span>);
                            }
                        }
                    };
 
                <b>try</b>
                {
                    <a href="#3cd7413a018a656d" class="i field">_psDebuggerCommand</a>.<span class="i">Invoke</span>(<b>null</b>, <span class="r105 r">internalOutput</span>, <b>null</b>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r111 rd" class="r111 r">e</span>)
                {
                    <span class="r103 r">executionError</span> = <b>true</b>;
                    <a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r112 rd" class="r112 r">re</span> = <span class="r111 r">e</span> <b>as</b> <a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a>;
                    <b>if</b> ((<span class="r112 r">re</span> != <b>null</b>) &amp;&amp; (<span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a> != <b>null</b>))
                    {
                        <span class="c">// Allow the IncompleteParseException to throw so that the console</span>
                        <span class="c">// can handle here strings and continued parsing.</span>
                        <b>if</b> (<span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="../../ErrorPackage.cs.html#fc99e636c67fec35" class="i property">Reason</a> == <b>nameof</b>(<a href="../../../utils/ParserException.cs.html#35541cbf972c98ee" class="t t">IncompleteParseException</a>))
                        {
                            <b>throw</b> <b>new</b> <span class="t">IncompleteParseException</span>(
                                <span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>?.<span class="i">Message</span>,
                                <span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>);
                        }
 
                        <span class="c">// Allow the RemoteException and InvalidRunspacePoolStateException to propagate so that the host can</span>
                        <span class="c">// clean up the debug session.</span>
                        <b>if</b> ((<span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="../../ErrorPackage.cs.html#fc99e636c67fec35" class="i property">Reason</a> == <b>nameof</b>(<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a>)) ||
                            (<span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="../../ErrorPackage.cs.html#fc99e636c67fec35" class="i property">Reason</a> == <b>nameof</b>(<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a>)))
                        {
                            <b>throw</b> <b>new</b> <span class="t">PSRemotingTransportException</span>(
                                (<span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a> != <b>null</b>) ? <span class="r112 r">re</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">Message</span> : <b>string</b>.<span class="i">Empty</span>);
                        }
                    }
 
                    <span class="c">// Allow all PSRemotingTransportException and RemoteException errors to propagate as this</span>
                    <span class="c">// indicates a broken debug session.</span>
                    <b>if</b> ((<span class="r111 r">e</span> <b>is</b> <a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a>) || (<span class="r111 r">e</span> <b>is</b> <a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a>))
                    {
                        <b>throw</b>;
                    }
 
                    <span class="r101 r">output</span>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(
                        <b>new</b> <a href="../../MshObject.cs.html#3ee1d75e736c4afc" class="t constructor">PSObject</a>(
                            <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(
                            <span class="r111 r">e</span>,
                            <span class="s">&quot;DebuggerError&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                            <b>null</b>)));
                }
            }
 
            <span class="r103 r">executionError</span> = <span class="r103 r">executionError</span> || <a href="#3cd7413a018a656d" class="i field">_psDebuggerCommand</a>.<a href="../../hostifaces/PowerShell.cs.html#55e1a13ecd52fcd0" class="i property">HadErrors</a>;
            <a href="#3cd7413a018a656d" class="i field">_psDebuggerCommand</a> = <b>null</b>;
 
            <span class="c">// Special processing when the detach command is run.</span>
            <a href="#35ad674e41d80b9e" class="i field">_detachCommand</a> = (!<span class="r103 r">executionError</span>) &amp;&amp; (<span class="r100 r">command</span>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>.<span class="i">Count</span> &gt; 0) &amp;&amp; (<span class="r100 r">command</span>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>.<span class="i">Equals</span>(<span class="s">&quot;Detach&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
            <b>return</b> <span class="r102 r">results</span> ?? <b>new</b> <a href="../../debugger/debugger.cs.html#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopProcessCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="f6d9ee5db3a1dde5" href="../../../R/f6d9ee5db3a1dde5.html" target="n" data-glyph="72,1" class="i method">StopProcessCommand</a>()
        {
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r113 rd" class="r113 r">ps</span> = <a href="#3cd7413a018a656d" class="i field">_psDebuggerCommand</a>;
            <b>if</b> ((<span class="r113 r">ps</span> != <b>null</b>) &amp;&amp;
                (<span class="r113 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#39b81acd3aeb1582" class="i property">InvocationStateInfo</a>.<a href="../../hostifaces/PowerShell.cs.html#7a70ff5163d0f044" class="i property">State</a> == <a href="../../hostifaces/PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>.<a href="../../hostifaces/PowerShell.cs.html#7142407e9e49cf13" class="i field">Running</a>))
            {
                <span class="r113 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#23f9dce20b146f19" class="i method">BeginStop</a>(<b>null</b>, <b>null</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided set of breakpoints to the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Breakpoints to set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="2a6825e02d211ddf" href="../../../R/2a6825e02d211ddf.html" target="n" data-glyph="72,1" class="i method">SetBreakpoints</a>(<span class="i">IEnumerable</span>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r114 rd" class="r114 r">breakpoints</span>, <b>int</b>? <span id="r115 rd" class="r115 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>);
 
            <b>var</b> <span id="r116 rd" class="r116 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;BreakpointList&quot;</span>, <span class="r114 r">breakpoints</span> },
            };
 
            <b>if</b> (<span class="r115 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r116 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r115 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<a href="../../debugger/Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>, <span class="r116 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a breakpoint by id, primarily for Enable/Disable/Remove-PSBreakpoint cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The breakpoint with the specified id.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="d773a481f581cfa0" href="../../../R/d773a481f581cfa0.html" target="n" data-glyph="72,1" class="i method">GetBreakpoint</a>(<b>int</b> <span id="r117 rd" class="r117 r">id</span>, <b>int</b>? <span id="r118 rd" class="r118 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#cf39fd7a1c905683" class="i field">GetBreakpoint</a>);
 
            <b>var</b> <span id="r119 rd" class="r119 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;Id&quot;</span>, <span class="r117 r">id</span> },
            };
 
            <b>if</b> (<span class="r118 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r119 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r118 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#cf39fd7a1c905683" class="i field">GetBreakpoint</a>, <span class="r119 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns breakpoints primarily for the Get-PSBreakpoint cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A list of breakpoints in a runspace.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="7c60bf43182dc14d" href="../../../R/7c60bf43182dc14d.html" target="n" data-glyph="72,1" class="i method">GetBreakpoints</a>(<b>int</b>? <span id="r120 rd" class="r120 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#cf39fd7a1c905683" class="i field">GetBreakpoint</a>);
 
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
            <b>var</b> <span id="r121 rd" class="r121 r">breakpoints</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;();
 
            <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r122 rd" class="r122 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
            {
                <span class="r122 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#cf39fd7a1c905683" class="i field">GetBreakpoint</a>);
 
                <b>if</b> (<span class="r120 r">runspaceId</span>.<span class="i">HasValue</span>)
                {
                    <span class="r122 r">ps</span>.<span class="i">AddParameter</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r120 r">runspaceId</span>.<span class="i">Value</span>);
                }
 
                <span class="i">Collection</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r123 rd" class="r123 r">output</span> = <span class="r122 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#11053e110c66cae7" class="i method">Invoke</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
                <b>foreach</b> (<b>var</b> <span id="r124 rd" class="r124 r">item</span> <b>in</b> <span class="r123 r">output</span>)
                {
                    <b>if</b> (<span class="r124 r">item</span>?.<span class="i">BaseObject</span> <b>is</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r125 rd" class="r125 r">bp</span>)
                    {
                        <span class="r121 r">breakpoints</span>.<span class="i">Add</span>(<span class="r125 r">bp</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="i">TryGetRemoteDebuggerException</span>(<span class="r124 r">item</span>, <b>out</b> <span class="i">Exception</span> <span id="r126 rd" class="r126 r">ex</span>))
                    {
                        <b>throw</b> <span class="r126 r">ex</span>;
                    }
                }
            }
 
            <b>return</b> <span class="r121 r">breakpoints</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a command breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the command is invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="f9e79831201074a5" href="../../../R/f9e79831201074a5.html" target="n" data-glyph="72,1" class="i method">SetCommandBreakpoint</a>(<b>string</b> <span id="r127 rd" class="r127 r">command</span>, <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r128 rd" class="r128 r">action</span>, <b>string</b> <span id="r129 rd" class="r129 r">path</span>, <b>int</b>? <span id="r130 rd" class="r130 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>);
 
            <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r131 rd" class="r131 r">breakpoint</span> = <b>new</b> <a href="../../debugger/Breakpoint.cs.html#dfcb594c58315bfd" class="t constructor">CommandBreakpoint</a>(<span class="r129 r">path</span>, <b>null</b>, <span class="r127 r">command</span>, <span class="r128 r">action</span>);
            <b>var</b> <span id="r132 rd" class="r132 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;Breakpoint&quot;</span>, <span class="r131 r">breakpoint</span> },
            };
 
            <b>if</b> (<span class="r130 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r132 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r130 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<a href="../../debugger/Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>, <span class="r132 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a line breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line in the script file where the breakpoint may be hit. This value must be greater than or equal to 1.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">column</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column in the script file where the breakpoint may be hit. If 0, the breakpoint will trigger on any statement on the line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The line breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="3857a8f44d02316b" href="../../../R/3857a8f44d02316b.html" target="n" data-glyph="72,1" class="i method">SetLineBreakpoint</a>(<b>string</b> <span id="r133 rd" class="r133 r">path</span>, <b>int</b> <span id="r134 rd" class="r134 r">line</span>, <b>int</b> <span id="r135 rd" class="r135 r">column</span>, <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r136 rd" class="r136 r">action</span>, <b>int</b>? <span id="r137 rd" class="r137 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>);
 
            <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r138 rd" class="r138 r">breakpoint</span> = <b>new</b> <a href="../../debugger/Breakpoint.cs.html#1a2c3c92770133fc" class="t constructor">LineBreakpoint</a>(<span class="r133 r">path</span>, <span class="r134 r">line</span>, <span class="r135 r">column</span>, <span class="r136 r">action</span>);
 
            <b>var</b> <span id="r139 rd" class="r139 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;Breakpoint&quot;</span>, <span class="r138 r">breakpoint</span> },
            };
 
            <b>if</b> (<span class="r137 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r139 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r137 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<a href="../../debugger/Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>, <span class="r139 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">accessMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable access mode that will trigger the breakpoint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the variable is accessed using the specified access mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The variable breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="9161274098f85aac" href="../../../R/9161274098f85aac.html" target="n" data-glyph="72,1" class="i method">SetVariableBreakpoint</a>(<b>string</b> <span id="r140 rd" class="r140 r">variableName</span>, <a href="../../debugger/Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a> <span id="r141 rd" class="r141 r">accessMode</span>, <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r142 rd" class="r142 r">action</span>, <b>string</b> <span id="r143 rd" class="r143 r">path</span>, <b>int</b>? <span id="r144 rd" class="r144 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>);
 
            <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r145 rd" class="r145 r">breakpoint</span> = <b>new</b> <a href="../../debugger/Breakpoint.cs.html#9cd5182b74402cdf" class="t constructor">VariableBreakpoint</a>(<span class="r143 r">path</span>, <span class="r140 r">variableName</span>, <span class="r141 r">accessMode</span>, <span class="r142 r">action</span>);
 
            <b>var</b> <span id="r146 rd" class="r146 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;Breakpoint&quot;</span>, <span class="r145 r">breakpoint</span> },
            };
 
            <b>if</b> (<span class="r144 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r146 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r144 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<a href="../../debugger/Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#3716c680de6cb897" class="i field">SetBreakpoint</a>, <span class="r146 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a breakpoint from the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r147 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to remove from the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r148 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the breakpoint was removed from the debugger; false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="1e151e240c7dbf45" href="../../../R/1e151e240c7dbf45.html" target="n" data-glyph="72,1" class="i method">RemoveBreakpoint</a>(<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r147 rd" class="r147 r">breakpoint</span>, <b>int</b>? <span id="r148 rd" class="r148 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#613c530b58312444" class="i field">RemoveBreakpoint</a>);
 
            <b>if</b> (<span class="r147 r">breakpoint</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>var</b> <span id="r149 rd" class="r149 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;Id&quot;</span>, <span class="r147 r">breakpoint</span>.<a href="../../debugger/Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a> },
            };
 
            <b>if</b> (<span class="r148 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r149 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r148 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<b>bool</b>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#613c530b58312444" class="i field">RemoveBreakpoint</a>, <span class="r149 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="078459d61aa8eb26" href="../../../R/078459d61aa8eb26.html" target="n" data-glyph="72,1" class="i method">EnableBreakpoint</a>(<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r150 rd" class="r150 r">breakpoint</span>, <b>int</b>? <span id="r151 rd" class="r151 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#ec6a6ef1145f7cc0" class="i field">EnableBreakpoint</a>);
 
            <b>if</b> (<span class="r150 r">breakpoint</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>var</b> <span id="r152 rd" class="r152 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;Id&quot;</span>, <span class="r150 r">breakpoint</span>.<a href="../../debugger/Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a> },
            };
 
            <b>if</b> (<span class="r151 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r152 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r151 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#ec6a6ef1145f7cc0" class="i field">EnableBreakpoint</a>, <span class="r152 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="6db13f61e893f856" href="../../../R/6db13f61e893f856.html" target="n" data-glyph="72,1" class="i method">DisableBreakpoint</a>(<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r153 rd" class="r153 r">breakpoint</span>, <b>int</b>? <span id="r154 rd" class="r154 r">runspaceId</span>)
        {
            <span class="c">// This is supported only for PowerShell versions &gt;= 7.0</span>
            <a href="#23377e0828bc5d91" class="i method">CheckRemoteBreakpointManagementSupport</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#e194a804a121c067" class="i field">DisableBreakpoint</a>);
 
            <b>if</b> (<span class="r153 r">breakpoint</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>var</b> <span id="r155 rd" class="r155 r">functionParameters</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;
            {
                { <span class="s">&quot;Id&quot;</span>, <span class="r153 r">breakpoint</span>.<a href="../../debugger/Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a> },
            };
 
            <b>if</b> (<span class="r154 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="r155 r">functionParameters</span>.<span class="i">Add</span>(<span class="s">&quot;RunspaceId&quot;</span>, <span class="r154 r">runspaceId</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <a href="#f53679db8eb86563" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#e194a804a121c067" class="i field">DisableBreakpoint</a>, <span class="r155 r">functionParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SetDebuggerAction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r156 r">resumeAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DebuggerResumeAction.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="6fd89c26da68745e" href="../../../R/6fd89c26da68745e.html" target="n" data-glyph="72,1" class="i method">SetDebuggerAction</a>(<a href="../../debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r156 rd" class="r156 r">resumeAction</span>)
        {
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
            <a href="#3d69f1ace9579326" class="i method">SetRemoteDebug</a>(<b>false</b>, <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#aed194b80737a544" class="i field">Busy</a>);
 
            <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r157 rd" class="r157 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
            {
                <span class="r157 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#8c7b0e33df9a112f" class="i field">SetDebuggerAction</a>).<span class="i">AddParameter</span>(<span class="s">&quot;ResumeAction&quot;</span>, <span class="r156 r">resumeAction</span>);
                <span class="r157 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
 
                <span class="c">// If an error exception is returned then throw it here.</span>
                <b>if</b> (<span class="r157 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#f93842fee257462c" class="i property">ErrorBuffer</a>.<a href="../../hostifaces/PSDataCollection.cs.html#e7cb43bbebbb4aca" class="i property">Count</a> &gt; 0)
                {
                    <span class="i">Exception</span> <span id="r158 rd" class="r158 r">e</span> = <span class="r157 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#f93842fee257462c" class="i property">ErrorBuffer</a>[0].<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>;
                    <b>if</b> (<span class="r158 r">e</span> != <b>null</b>) { <b>throw</b> <span class="r158 r">e</span>; }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> GetDebuggerStopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerStopEventArgs.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <a id="398e154d86a08d73" href="../../../R/398e154d86a08d73.html" target="n" data-glyph="72,1" class="i method">GetDebuggerStopArgs</a>()
        {
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
            <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r159 rd" class="r159 r">rtnArgs</span> = <b>null</b>;
 
            <b>try</b>
            {
                <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r160 rd" class="r160 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
                {
                    <span class="r160 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#1f734cf12f44bf18" class="i field">GetDebuggerStopArgs</a>);
                    <span class="i">Collection</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r161 rd" class="r161 r">output</span> = <span class="r160 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#11053e110c66cae7" class="i method">Invoke</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
                    <b>foreach</b> (<b>var</b> <span id="r162 rd" class="r162 r">item</span> <b>in</b> <span class="r161 r">output</span>)
                    {
                        <b>if</b> (<span class="r162 r">item</span> == <b>null</b>) { <b>continue</b>; }
 
                        <span class="r159 r">rtnArgs</span> = <span class="r162 r">item</span>.<span class="i">BaseObject</span> <b>as</b> <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>;
                        <b>if</b> (<span class="r159 r">rtnArgs</span> != <b>null</b>) { <b>break</b>; }
                    }
                }
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
            }
 
            <b>return</b> <span class="r159 r">rtnArgs</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SetDebugMode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r163 r">mode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="f13f581861467dbe" href="../../../R/f13f581861467dbe.html" target="n" data-glyph="72,1" class="i method">SetDebugMode</a>(<a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a> <span id="r163 rd" class="r163 r">mode</span>)
        {
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
            <span class="c">// Only set debug mode on server if no commands are currently</span>
            <span class="c">// running on remote runspace.</span>
            <b>if</b> ((<a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#9ab3dedcf11ea947" class="i method">GetCurrentlyRunningPipeline</a>() != <b>null</b>) ||
                (<a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#c7d59b1aea27b0c9" class="i property">RemoteCommand</a> != <b>null</b>))
            {
                <b>return</b>;
            }
 
            <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r164 rd" class="r164 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
            {
                <span class="r164 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#ca9abcd81cc054f5" class="i method">SetIsNested</a>(<b>false</b>);
                <span class="r164 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#c56c21c0237f7823" class="i field">SetDebugMode</a>).<span class="i">AddParameter</span>(<span class="s">&quot;Mode&quot;</span>, <span class="r163 r">mode</span>);
                <span class="r164 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
            }
 
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">base</a>.<a href="../../debugger/debugger.cs.html#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<span class="r163 r">mode</span>);
 
            <a href="#61f8e407e1a7209f" class="i method">SetIsActive</a>(<a href="#0e7b79c01162da44" class="i field">_breakpointCount</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets debugger stepping mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r165 r">enabled</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if stepping is to be enabled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="a6e988d786689977" href="../../../R/a6e988d786689977.html" target="n" data-glyph="72,1" class="i method">SetDebuggerStepMode</a>(<b>bool</b> <span id="r165 rd" class="r165 r">enabled</span>)
        {
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
            <span class="c">// This is supported only for PowerShell versions &gt;= 5.0</span>
            <b>if</b> (!<a href="#9c785cdcdae016b3" class="i field">_remoteDebuggingCapability</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#834f3bb1e746792f" class="i method">IsCommandSupported</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#0c21b82302bcc9d8" class="i field">SetDebuggerStepMode</a>))
            {
                <b>return</b>;
            }
 
            <b>try</b>
            {
                <span class="c">// Ensure debugger is in correct mode.</span>
                <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">base</a>.<a href="../../debugger/debugger.cs.html#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="../../debugger/debugger.cs.html#8f7455ad81a2c081" class="i field">LocalScript</a> | <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="../../debugger/debugger.cs.html#36492991f477f6e1" class="i field">RemoteScript</a>);
 
                <span class="c">// Send Enable-DebuggerStepping virtual command.</span>
                <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r166 rd" class="r166 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
                {
                    <span class="r166 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#0c21b82302bcc9d8" class="i field">SetDebuggerStepMode</a>).<a href="../../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Enabled&quot;</span>, <span class="r165 r">enabled</span>);
                    <span class="r166 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
                    <a href="#a5bedc596bafc770" class="i field">_isDebuggerSteppingEnabled</a> = <span class="r165 r">enabled</span>;
                }
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// Don&#39;t propagate exceptions.</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when debugger is active with breakpoints.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="a3abe9431ccf8ada" href="../../../R/a3abe9431ccf8ada.html" target="n" data-glyph="102,1" class="i property">IsActive</a>
        {
            <b>get</b> { <b>return</b> <a href="#78cd3ebe65165c1c" class="i field">_isActive</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when debugger is stopped at a breakpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="a40ca9a4cbf2a60d" href="../../../R/a40ca9a4cbf2a60d.html" target="n" data-glyph="102,1" class="i property">InBreakpoint</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#50abf49e9e7ce258" class="i field">_handleDebuggerStop</a> || (<a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#c9a8dc56926b5fdf" class="i property">RunspaceAvailability</a> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#244d7672812dd8a9" class="i field">RemoteDebug</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InternalProcessCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r167 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r168 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../../debugger/debugger.cs.html#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="fa8698a373542f2f" href="../../../R/fa8698a373542f2f.html" target="n" data-glyph="74,1" class="i method">InternalProcessCommand</a>(<b>string</b> <span id="r167 rd" class="r167 r">command</span>, <span class="i">IList</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r168 rd" class="r168 r">output</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsRemote.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="87b125db1b217f21" href="../../../R/87b125db1b217f21.html" target="n" data-glyph="104,1" class="i property">IsRemote</a>
        {
            <b>get</b> { <b>return</b> <b>true</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets how the debugger deals with breakpoint events that are not handled.</span>
        <span class="c">///</span><span class="c">  Ignore - This is the default behavior and ignores any breakpoint event</span>
        <span class="c">///</span><span class="c">           if there is no handler.  Releases any preserved event.</span>
        <span class="c">///</span><span class="c">  Wait   - This mode preserves a breakpoint event until a handler is</span>
        <span class="c">///</span><span class="c">           subscribed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a> <a id="baf5bd8b4475bd35" href="../../../R/baf5bd8b4475bd35.html" target="n" data-glyph="104,1" class="i property">UnhandledBreakpointMode</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d1107ffa0e28f788" class="i field">_unhandledBreakpointMode</a>;
            }
 
            <b>set</b>
            {
                <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
                <span class="c">// This is supported only for PowerShell versions &gt;= 5.0</span>
                <b>if</b> (!<a href="#9c785cdcdae016b3" class="i field">_remoteDebuggingCapability</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#834f3bb1e746792f" class="i method">IsCommandSupported</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#242ffb6b28faef29" class="i field">SetUnhandledBreakpointMode</a>))
                {
                    <b>return</b>;
                }
 
                <a href="#3d69f1ace9579326" class="i method">SetRemoteDebug</a>(<b>false</b>, (<a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>?)<b>null</b>);
 
                <span class="c">// Send Set-PSUnhandledBreakpointMode virtual command.</span>
                <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r169 rd" class="r169 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
                {
                    <span class="r169 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#242ffb6b28faef29" class="i field">SetUnhandledBreakpointMode</a>).<span class="i">AddParameter</span>(<span class="s">&quot;UnhandledBreakpointMode&quot;</span>, <b>value</b>);
                    <span class="r169 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
                }
 
                <a href="#d1107ffa0e28f788" class="i field">_unhandledBreakpointMode</a> = <b>value</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="dbb0d321ad875ed4" href="../../../R/dbb0d321ad875ed4.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#5183f3d7600aeaf8" class="i">RemoteDebuggerStop</a> -= <span class="i">HandleForwardedDebuggerStopEvent</span>;
            <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#50319f28a3da4cc3" class="i">RemoteDebuggerBreakpointUpdated</a> -= <span class="i">HandleForwardedDebuggerBreakpointUpdatedEvent</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <b>if</b> (<a href="#f90d06bc7ea4f713" class="i field">_identityToPersonate</a> != <b>null</b>)
            {
                <a href="#f90d06bc7ea4f713" class="i field">_identityToPersonate</a>.<span class="i">Dispose</span>();
                <a href="#f90d06bc7ea4f713" class="i field">_identityToPersonate</a> = <b>null</b>;
            }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal method that checks the debug state of</span>
        <span class="c">///</span><span class="c"> the remote session and raises the DebuggerStop event</span>
        <span class="c">///</span><span class="c"> if debugger is in stopped state.</span>
        <span class="c">///</span><span class="c"> This is used internally to help clients get back to</span>
        <span class="c">///</span><span class="c"> debug state when reconnecting to remote session in debug state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="7707b91fc96fac5a" href="../../../R/7707b91fc96fac5a.html" target="n" data-glyph="74,1" class="i method">CheckStateAndRaiseStopEvent</a>()
        {
            <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r170 rd" class="r170 r">stopArgs</span> = <a href="#398e154d86a08d73" class="i method">GetDebuggerStopArgs</a>();
            <b>if</b> (<span class="r170 r">stopArgs</span> != <b>null</b>)
            {
                <a href="#513028761a75a3b7" class="i method">ProcessDebuggerStopEvent</a>(<span class="r170 r">stopArgs</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsRemoteDebug.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="70fd830e8344b495" href="../../../R/70fd830e8344b495.html" target="n" data-glyph="104,1" class="i property">IsRemoteDebug</a>
        {
            <b>get</b>;
            <b>private set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets client debug info state based on server info.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">debugMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debug mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r172 r">inBreakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Currently in breakpoint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r173 r">breakpointCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Breakpoint count.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r174 r">breakAll</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Break All setting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r175 r">unhandledBreakpointMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">UnhandledBreakpointMode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r176 r">serverPSVersion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Server PowerShell version.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="d9ea653db6a5f3fb" href="../../../R/d9ea653db6a5f3fb.html" target="n" data-glyph="74,1" class="i method">SetClientDebugInfo</a>(
            <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>? <span id="r171 rd" class="r171 r">debugMode</span>,
            <b>bool</b> <span id="r172 rd" class="r172 r">inBreakpoint</span>,
            <b>int</b> <span id="r173 rd" class="r173 r">breakpointCount</span>,
            <b>bool</b> <span id="r174 rd" class="r174 r">breakAll</span>,
            <a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a> <span id="r175 rd" class="r175 r">unhandledBreakpointMode</span>,
            <span class="i">Version</span> <span id="r176 rd" class="r176 r">serverPSVersion</span>)
        {
            <b>if</b> (<span class="r171 r">debugMode</span> != <b>null</b>)
            {
                <a href="#d77c22603b7175dd" class="i field">_remoteDebugSupported</a> = <b>true</b>;
                <a href="../../debugger/debugger.cs.html#cb370f0b35bef91f" class="i property">DebugMode</a> = <span class="r171 r">debugMode</span>.<span class="i">Value</span>;
            }
            <b>else</b>
            {
                <a href="#d77c22603b7175dd" class="i field">_remoteDebugSupported</a> = <b>false</b>;
            }
 
            <b>if</b> (<span class="r172 r">inBreakpoint</span>)
            {
                <a href="#3d69f1ace9579326" class="i method">SetRemoteDebug</a>(<b>true</b>, <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#244d7672812dd8a9" class="i field">RemoteDebug</a>);
            }
 
            <a href="#9c785cdcdae016b3" class="i field">_remoteDebuggingCapability</a> = <a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#8eec5a9ceb3db518" class="t t">RemoteDebuggingCapability</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#b2adfddf85f90cda" class="i method">CreateDebuggingCapability</a>(<span class="r176 r">serverPSVersion</span>);
 
            <a href="#0e7b79c01162da44" class="i field">_breakpointCount</a> = <span class="r173 r">breakpointCount</span>;
            <a href="#a5bedc596bafc770" class="i field">_isDebuggerSteppingEnabled</a> = <span class="r174 r">breakAll</span>;
            <a href="#d1107ffa0e28f788" class="i field">_unhandledBreakpointMode</a> = <span class="r175 r">unhandledBreakpointMode</span>;
            <a href="#61f8e407e1a7209f" class="i method">SetIsActive</a>(<span class="r173 r">breakpointCount</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a command is stopped while in debug stopped state and it</span>
        <span class="c">///</span><span class="c"> is the only command running then server is no longer debug stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="1bd583216f620d9b" href="../../../R/1bd583216f620d9b.html" target="n" data-glyph="74,1" class="i method">OnCommandStopped</a>()
        {
            <b>if</b> (<a href="#70fd830e8344b495" class="i property">IsRemoteDebug</a>)
            {
                <a href="#70fd830e8344b495" class="i property">IsRemoteDebug</a> = <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets breakpoint information from the target machine and passes that information</span>
        <span class="c">///</span><span class="c"> on through the BreakpointUpdated event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="2a1ec72c6a63704b" href="../../../R/2a1ec72c6a63704b.html" target="n" data-glyph="74,1" class="i method">SendBreakpointUpdatedEvents</a>()
        {
            <b>if</b> (!<a href="../../debugger/debugger.cs.html#ffe5f52a8cff3b39" class="i method">IsDebuggerBreakpointUpdatedEventSubscribed</a>() ||
                (<a href="#0e7b79c01162da44" class="i field">_breakpointCount</a> == 0))
            {
                <b>return</b>;
            }
 
            <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r177 rd" class="r177 r">breakpoints</span> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
 
            <span class="c">// Get breakpoint information by running &quot;Get-PSBreakpoint&quot; PowerShell command.</span>
            <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r178 rd" class="r178 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
            {
                <b>if</b> (!<a href="#89199d5c3f22d94e" class="k">this</a>.<a href="#a40ca9a4cbf2a60d" class="i property">InBreakpoint</a>)
                {
                    <span class="c">// Can&#39;t use nested PowerShell if we are not stopped in a breakpoint.</span>
                    <span class="r178 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#ca9abcd81cc054f5" class="i method">SetIsNested</a>(<b>false</b>);
                }
 
                <span class="r178 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<span class="s">&quot;Get-PSBreakpoint&quot;</span>);
                <span class="r178 r">ps</span>.<span class="i">Invoke</span>(<b>null</b>, <span class="r177 r">breakpoints</span>);
            }
 
            <span class="c">// Raise BreakpointUpdated event to client for each breakpoint.</span>
            <b>foreach</b> (<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r179 rd" class="r179 r">obj</span> <b>in</b> <span class="r177 r">breakpoints</span>)
            {
                <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r180 rd" class="r180 r">breakpoint</span> = <span class="r179 r">obj</span>.<a href="../../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <a href="../../debugger/Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>;
                <b>if</b> (<span class="r180 r">breakpoint</span> != <b>null</b>)
                {
                    <a href="../../debugger/debugger.cs.html#8aab7ff30ec5430c" class="i method">RaiseBreakpointUpdatedEvent</a>(
                        <b>new</b> <a href="../../debugger/debugger.cs.html#af659be6c5f84358" class="t constructor">BreakpointUpdatedEventArgs</a>(<span class="r180 r">breakpoint</span>, <a href="../../debugger/debugger.cs.html#7f495a71915b9312" class="t t">BreakpointUpdateType</a>.<a href="../../debugger/debugger.cs.html#215e5f765054ee2a" class="i field">Set</a>, <a href="#0e7b79c01162da44" class="i field">_breakpointCount</a>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsDebuggerSteppingEnabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="b089f0df15d7880c" href="../../../R/b089f0df15d7880c.html" target="n" data-glyph="104,1" class="i property">IsDebuggerSteppingEnabled</a>
        {
            <b>get</b> { <b>return</b> <a href="#a5bedc596bafc770" class="i field">_isDebuggerSteppingEnabled</a>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <b>private static bool</b> <a id="b490e2473b888ca7" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">TryGetRemoteDebuggerException</a>(
            <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r181 rd" class="r181 r">item</span>,
            <b>out</b> <span class="i">Exception</span> <span id="r182 rd" class="r182 r">exception</span>)
        {
            <span class="r182 r">exception</span> = <b>null</b>;
            <b>if</b> (<span class="r181 r">item</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>bool</b> <span id="r183 rd" class="r183 r">haveExceptionType</span> = <b>false</b>;
            <b>foreach</b> (<b>var</b> <span id="r184 rd" class="r184 r">typeName</span> <b>in</b> <span class="r181 r">item</span>.<a href="../../MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>)
            {
                <b>if</b> (<span class="r184 r">typeName</span>.<span class="i">Equals</span>(<span class="s">&quot;Deserialized.System.Exception&quot;</span>))
                {
                    <span class="r183 r">haveExceptionType</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r183 r">haveExceptionType</span>)
            {
                <b>var</b> <span id="r185 rd" class="r185 r">errorMessage</span> = <span class="r181 r">item</span>.<a href="../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="s">&quot;Message&quot;</span>]?.<a href="../../MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> ?? <b>string</b>.<span class="i">Empty</span>;
                <span class="r182 r">exception</span> = <b>new</b> <a href="../../NativeCommandProcessor.cs.html#25cde8b85ca92099" class="t constructor">RemoteException</a>(
                    <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(
                        <span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteDebuggerError</span>, <span class="r181 r">item</span>.<a href="../../MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>[0], <span class="r185 r">errorMessage</span>));
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">//</span>
        <span class="c">// Event handlers</span>
        <span class="c">//</span>
 
        <b>private void</b> <a id="47cc9806a5d3be3f" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleForwardedDebuggerStopEvent</a>(<b>object</b> <span id="r186 rd" class="r186 r">sender</span>, <a href="../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r187 rd" class="r187 r">e</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r187 r">e</span>.<a href="../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>.<span class="i">Length</span> == 1, <span class="s">&quot;Forwarded debugger stop event args must always contain one SourceArgs item.&quot;</span>);
            <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r188 rd" class="r188 r">args</span>;
            <b>if</b> (<span class="r187 r">e</span>.<a href="../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>[0] <b>is</b> <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <span class="r188 r">args</span> = ((<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r187 r">e</span>.<a href="../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>[0]).<a href="../../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>;
            }
            <b>else</b>
            {
                <span class="r188 r">args</span> = <span class="r187 r">e</span>.<a href="../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>[0] <b>as</b> <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>;
            }
 
            <a href="#513028761a75a3b7" class="i method">ProcessDebuggerStopEvent</a>(<span class="r188 r">args</span>);
        }
 
        <b>private void</b> <a id="513028761a75a3b7" href="../../../R/513028761a75a3b7.html" target="n" data-glyph="76,1" class="i method">ProcessDebuggerStopEvent</a>(<a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r189 rd" class="r189 r">args</span>)
        {
            <span class="c">// It is possible to get a stop event raise request while</span>
            <span class="c">// debugger is already in stop mode (after remote runspace debugger</span>
            <span class="c">// reconnect).  In this case ignore the request.</span>
            <b>if</b> (<a href="#50abf49e9e7ce258" class="i field">_handleDebuggerStop</a>) { <b>return</b>; }
 
            <span class="c">// Attempt to process debugger stop event on original thread if it</span>
            <span class="c">// is available (i.e., if it is blocked by EndInvoke).</span>
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r190 rd" class="r190 r">powershell</span> = <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#e739e4061d7c7d14" class="i method">GetCurrentRunningPowerShell</a>();
            <a href="../../hostifaces/AsyncResult.cs.html#f0fde6334f2a46e1" class="t t">AsyncResult</a> <span id="r191 rd" class="r191 r">invokeAsyncResult</span> = <span class="r190 r">powershell</span>?.<a href="../../hostifaces/PowerShell.cs.html#4f10d51ac16015a7" class="i property">EndInvokeAsyncResult</a>;
 
            <b>bool</b> <span id="r192 rd" class="r192 r">invokedOnBlockedThread</span> = <b>false</b>;
            <b>if</b> ((<span class="r191 r">invokeAsyncResult</span> != <b>null</b>) &amp;&amp; (!<span class="r191 r">invokeAsyncResult</span>.<a href="../../hostifaces/AsyncResult.cs.html#8d04b010297eb52a" class="i property">IsCompleted</a>))
            {
                <span class="r192 r">invokedOnBlockedThread</span> = <span class="r191 r">invokeAsyncResult</span>.<span class="i">InvokeCallbackOnThread</span>(
                    <span class="i">ProcessDebuggerStopEventProc</span>,
                    <span class="r189 r">args</span>);
            }
 
            <b>if</b> (!<span class="r192 r">invokedOnBlockedThread</span>)
            {
                <span class="c">// Otherwise run on worker thread.</span>
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                <a href="../../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">QueueWorkItemWithImpersonation</span>(
                    <a href="#f90d06bc7ea4f713" class="i field">_identityToPersonate</a>,
                    <span class="i">ProcessDebuggerStopEventProc</span>,
                    <span class="r189 r">args</span>);
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">                Threading.ThreadPool.QueueUserWorkItem(
                    ProcessDebuggerStopEventProc,
                    args);
 
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
        }
 
        <b>private void</b> <a id="93aa6322d0fc736c" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessDebuggerStopEventProc</a>(<b>object</b> <span id="r193 rd" class="r193 r">state</span>)
        {
            <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r194 rd" class="r194 r">prevAvailability</span> = <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#c9a8dc56926b5fdf" class="i property">RunspaceAvailability</a>;
            <b>bool</b> <span id="r195 rd" class="r195 r">restoreAvailability</span> = <b>true</b>;
 
            <b>try</b>
            {
                <a href="#50abf49e9e7ce258" class="i field">_handleDebuggerStop</a> = <b>true</b>;
 
                <span class="c">// Update runspace availability</span>
                <a href="#3d69f1ace9579326" class="i method">SetRemoteDebug</a>(<b>true</b>, <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#244d7672812dd8a9" class="i field">RemoteDebug</a>);
 
                <span class="c">// Raise event and wait for response.</span>
                <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r196 rd" class="r196 r">args</span> = <span class="r193 r">state</span> <b>as</b> <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>;
                <b>if</b> (<span class="r196 r">args</span> != <b>null</b>)
                {
                    <b>if</b> (<a href="../../debugger/debugger.cs.html#74257a81608a56cd" class="i method">IsDebuggerStopEventSubscribed</a>())
                    {
                        <b>try</b>
                        {
                            <span class="c">// Blocking call.</span>
                            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">base</a>.<a href="../../debugger/debugger.cs.html#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<span class="r196 r">args</span>);
                        }
                        <b>finally</b>
                        {
                            <a href="#50abf49e9e7ce258" class="i field">_handleDebuggerStop</a> = <b>false</b>;
                            <b>if</b> (!<a href="#35ad674e41d80b9e" class="i field">_detachCommand</a> &amp;&amp; !<span class="r196 r">args</span>.<a href="../../debugger/debugger.cs.html#9ff6d82303db72dc" class="i property">SuspendRemote</a>)
                            {
                                <a href="#6fd89c26da68745e" class="i method">SetDebuggerAction</a>(<span class="r196 r">args</span>.<a href="../../debugger/debugger.cs.html#b6941352f3c2c41c" class="i property">ResumeAction</a>);
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// If no debugger is subscribed to the DebuggerStop event then we</span>
                        <span class="c">// allow the server side script execution to remain blocked in debug</span>
                        <span class="c">// stop mode.  The runspace Availability reflects this and the client</span>
                        <span class="c">// must take action (attach debugger or release remote debugger stop</span>
                        <span class="c">// via SetDebuggerAction()).</span>
                        <span class="r195 r">restoreAvailability</span> = <b>false</b>;
                        <a href="#50abf49e9e7ce258" class="i field">_handleDebuggerStop</a> = <b>false</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// Null arguments may indicate that remote runspace was created without</span>
                    <span class="c">// default type table and so arguments cannot be serialized.  In this case</span>
                    <span class="c">// we don&#39;t want to block the remote side script execution.</span>
                    <a href="#50abf49e9e7ce258" class="i field">_handleDebuggerStop</a> = <b>false</b>;
                    <a href="#6fd89c26da68745e" class="i method">SetDebuggerAction</a>(<a href="../../debugger/debugger.cs.html#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="../../debugger/debugger.cs.html#c35cb32c2ab7ed0d" class="i field">Continue</a>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <a href="#50abf49e9e7ce258" class="i field">_handleDebuggerStop</a> = <b>false</b>;
            }
            <b>finally</b>
            {
                <span class="c">// Restore runspace availability.</span>
                <b>if</b> (<span class="r195 r">restoreAvailability</span> &amp;&amp; (<a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#c9a8dc56926b5fdf" class="i property">RunspaceAvailability</a> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#244d7672812dd8a9" class="i field">RemoteDebug</a>))
                {
                    <a href="#3d69f1ace9579326" class="i method">SetRemoteDebug</a>(<b>false</b>, <span class="r194 r">prevAvailability</span>);
                }
 
                <b>if</b> (<a href="#35ad674e41d80b9e" class="i field">_detachCommand</a>)
                {
                    <a href="#35ad674e41d80b9e" class="i field">_detachCommand</a> = <b>false</b>;
                }
            }
        }
 
        <b>private void</b> <a id="f302bdb5bbdbc547" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleForwardedDebuggerBreakpointUpdatedEvent</a>(<b>object</b> <span id="r197 rd" class="r197 r">sender</span>, <a href="../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r198 rd" class="r198 r">e</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r198 r">e</span>.<a href="../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>.<span class="i">Length</span> == 1, <span class="s">&quot;Forwarded debugger breakpoint event args must always contain one SourceArgs item.&quot;</span>);
            <a href="../../debugger/debugger.cs.html#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a> <span id="r199 rd" class="r199 r">bpArgs</span> = <span class="r198 r">e</span>.<a href="../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>[0] <b>as</b> <a href="../../debugger/debugger.cs.html#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a>;
 
            <b>if</b> (<span class="r199 r">bpArgs</span> != <b>null</b>)
            {
                <a href="#78b5e889230d90f2" class="i method">UpdateBreakpointCount</a>(<span class="r199 r">bpArgs</span>.<a href="../../debugger/debugger.cs.html#da3e4072e44924a9" class="i property">BreakpointCount</a>);
                <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">base</a>.<a href="../../debugger/debugger.cs.html#8aab7ff30ec5430c" class="i method">RaiseBreakpointUpdatedEvent</a>(<span class="r199 r">bpArgs</span>);
            }
        }
 
        <b>private</b> <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="8185951b4caf0684" href="../../../R/8185951b4caf0684.html" target="n" data-glyph="76,1" class="i method">GetNestedPowerShell</a>()
        {
            <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r200 rd" class="r200 r">ps</span> = <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>();
            <span class="r200 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> = <a href="#f97a9658009910e2" class="i field">_runspace</a>;
            <span class="r200 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#ca9abcd81cc054f5" class="i method">SetIsNested</a>(<b>true</b>);
 
            <b>return</b> <span class="r200 r">ps</span>;
        }
 
        <b>private void</b> <a id="0b234c07b17dc511" href="../../../R/0b234c07b17dc511.html" target="n" data-glyph="76,1" class="i method">CheckForValidateState</a>()
        {
            <b>if</b> (!<a href="#d77c22603b7175dd" class="i field">_remoteDebugSupported</a>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshInvalidOperationException.cs.html#26c9dca266e6a4d5" class="t constructor">PSInvalidOperationException</a>(
                    <span class="c">// The remote session to which you are connected does not support remote debugging.</span>
                    <span class="c">// You must connect to a remote computer that is running PowerShell {0} or greater.</span>
                    <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteDebuggingEndpointVersionError</span>, <a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#348dbcd31d88b8f0" class="i property">PSV4Version</a>),
                    <b>null</b>,
                    <span class="s">&quot;RemoteDebugger:RemoteDebuggingNotSupported&quot;</span>,
                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#8088845be39ec60c" class="i field">NotImplemented</a>,
                    <b>null</b>);
            }
 
            <b>if</b> (<a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
            {
                <b>throw</b> <b>new</b> <a href="../../hostifaces/Connection.cs.html#fc9543f8f1377b98" class="t constructor">InvalidRunspaceStateException</a>();
            }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <b>if</b> (!<a href="#ff59bdc1777b8716" class="i field">_identityPersonationChecked</a>)
            {
                <a href="#ff59bdc1777b8716" class="i field">_identityPersonationChecked</a> = <b>true</b>;
 
                <span class="c">// Save identity to impersonate.</span>
                <a href="../../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../Utils.cs.html#9b44ca7f35bc8c39" class="i method">TryGetWindowsImpersonatedIdentity</a>(<b>out</b> <a href="#f90d06bc7ea4f713" class="i field">_identityToPersonate</a>);
            }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <b>private void</b> <a id="3d69f1ace9579326" href="../../../R/3d69f1ace9579326.html" target="n" data-glyph="76,1" class="i method">SetRemoteDebug</a>(<b>bool</b> <span id="r201 rd" class="r201 r">remoteDebug</span>, <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>? <span id="r202 rd" class="r202 r">availability</span>)
        {
            <b>if</b> (<a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#70fd830e8344b495" class="i property">IsRemoteDebug</a> != <span class="r201 r">remoteDebug</span>)
            {
                <a href="#70fd830e8344b495" class="i property">IsRemoteDebug</a> = <span class="r201 r">remoteDebug</span>;
                <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="RemoteRunspacePoolInternal.cs.html#f8874da4a5c43ab5" class="i property">IsRemoteDebugStop</a> = <span class="r201 r">remoteDebug</span>;
            }
 
            <b>if</b> (<span class="r202 r">availability</span> != <b>null</b>)
            {
                <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r203 rd" class="r203 r">newAvailability</span> = <span class="r202 r">availability</span>.<span class="i">Value</span>;
 
                <b>if</b> ((<a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="#c9a8dc56926b5fdf" class="i property">RunspaceAvailability</a> != <span class="r203 r">newAvailability</span>) &amp;&amp;
                    (<span class="r201 r">remoteDebug</span> || (<span class="r203 r">newAvailability</span> != <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#244d7672812dd8a9" class="i field">RemoteDebug</a>)))
                {
                    <b>try</b>
                    {
                        <a href="#f97a9658009910e2" class="i field">_runspace</a>.<a href="../../hostifaces/Connection.cs.html#222554c22c4a3071" class="i method">UpdateRunspaceAvailability</a>(<span class="r203 r">newAvailability</span>, <b>true</b>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                    }
                }
            }
        }
 
        <b>private void</b> <a id="78b5e889230d90f2" href="../../../R/78b5e889230d90f2.html" target="n" data-glyph="76,1" class="i method">UpdateBreakpointCount</a>(<b>int</b> <span id="r204 rd" class="r204 r">bpCount</span>)
        {
            <a href="#0e7b79c01162da44" class="i field">_breakpointCount</a> = <span class="r204 r">bpCount</span>;
            <a href="#61f8e407e1a7209f" class="i method">SetIsActive</a>(<span class="r204 r">bpCount</span>);
        }
 
        <b>private void</b> <a id="61f8e407e1a7209f" href="../../../R/61f8e407e1a7209f.html" target="n" data-glyph="76,1" class="i method">SetIsActive</a>(<b>int</b> <span id="r205 rd" class="r205 r">breakpointCount</span>)
        {
            <b>if</b> ((<a href="../../debugger/debugger.cs.html#cb370f0b35bef91f" class="i property">DebugMode</a> &amp; <a href="../../debugger/debugger.cs.html#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="../../debugger/debugger.cs.html#36492991f477f6e1" class="i field">RemoteScript</a>) == 0)
            {
                <span class="c">// Debugger is always inactive if RemoteScript is not selected.</span>
                <b>if</b> (<a href="#78cd3ebe65165c1c" class="i field">_isActive</a>) { <a href="#78cd3ebe65165c1c" class="i field">_isActive</a> = <b>false</b>; }
 
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r205 r">breakpointCount</span> &gt; 0)
            {
                <b>if</b> (!<a href="#78cd3ebe65165c1c" class="i field">_isActive</a>) { <a href="#78cd3ebe65165c1c" class="i field">_isActive</a> = <b>true</b>; }
            }
            <b>else</b>
            {
                <b>if</b> (<a href="#78cd3ebe65165c1c" class="i field">_isActive</a>) { <a href="#78cd3ebe65165c1c" class="i field">_isActive</a> = <b>false</b>; }
            }
        }
 
        <b>private</b> <span class="r206 r t">T</span> <a id="f53679db8eb86563" href="../../../R/f53679db8eb86563.html" target="n" data-glyph="76,1" class="i method">InvokeRemoteBreakpointFunction</a>&lt;<span id="r206 rd t" class="r206 r t">T</span>&gt;(<b>string</b> <span id="r207 rd" class="r207 r">functionName</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r208 rd" class="r208 r">parameters</span>)
        {
            <a href="#0b234c07b17dc511" class="i method">CheckForValidateState</a>();
 
            <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r209 rd" class="r209 r">ps</span> = <a href="#8185951b4caf0684" class="i method">GetNestedPowerShell</a>())
            {
                <span class="r209 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<span class="r207 r">functionName</span>);
                <b>foreach</b> (<b>var</b> <span id="r210 rd" class="r210 r">parameterName</span> <b>in</b> <span class="r208 r">parameters</span>.<span class="i">Keys</span>)
                {
                    <span class="r209 r">ps</span>.<span class="i">AddParameter</span>(<span class="r210 r">parameterName</span>, <span class="r208 r">parameters</span>[<span class="r210 r">parameterName</span>]);
                }
 
                <span class="i">Collection</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r211 rd" class="r211 r">output</span> = <span class="r209 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#11053e110c66cae7" class="i method">Invoke</a>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
 
                <span class="c">// If an error exception is returned then throw it here.</span>
                <b>if</b> (<span class="r209 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#f93842fee257462c" class="i property">ErrorBuffer</a>.<a href="../../hostifaces/PSDataCollection.cs.html#e7cb43bbebbb4aca" class="i property">Count</a> &gt; 0)
                {
                    <span class="i">Exception</span> <span id="r212 rd" class="r212 r">e</span> = <span class="r209 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#f93842fee257462c" class="i property">ErrorBuffer</a>[0].<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>;
                    <b>if</b> (<span class="r212 r">e</span> != <b>null</b>)
                    {
                        <b>throw</b> <span class="r212 r">e</span>;
                    }
                }
 
                <span class="c">// This helper is only used to return a single output item of type T.</span>
                <b>foreach</b> (<b>var</b> <span id="r213 rd" class="r213 r">item</span> <b>in</b> <span class="r211 r">output</span>)
                {
                    <b>if</b> (<span class="r213 r">item</span>?.<span class="i">BaseObject</span> <b>is</b> <span class="r206 r t">T</span>)
                    {
                        <b>return</b> (<span class="r206 r t">T</span>)<span class="r213 r">item</span>.<span class="i">BaseObject</span>;
                    }
 
                    <b>if</b> (<span class="i">TryGetRemoteDebuggerException</span>(<span class="r213 r">item</span>, <b>out</b> <span class="i">Exception</span> <span id="r214 rd" class="r214 r">ex</span>))
                    {
                        <b>throw</b> <span class="r214 r">ex</span>;
                    }
                }
 
                <b>return</b> <b>default</b>(<span class="r206 r t">T</span>);
            }
        }
 
        <b>private void</b> <a id="23377e0828bc5d91" href="../../../R/23377e0828bc5d91.html" target="n" data-glyph="76,1" class="i method">CheckRemoteBreakpointManagementSupport</a>(<b>string</b> <span id="r215 rd" class="r215 r">breakpointCommandNameToCheck</span>)
        {
            <b>if</b> (<a href="#5c3a950369be9ecf" class="i field">_remoteBreakpointManagementIsSupported</a> == <b>null</b>)
            {
                <a href="#5c3a950369be9ecf" class="i field">_remoteBreakpointManagementIsSupported</a> = <a href="#9c785cdcdae016b3" class="i field">_remoteDebuggingCapability</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#834f3bb1e746792f" class="i method">IsCommandSupported</a>(<span class="r215 r">breakpointCommandNameToCheck</span>);
            }
 
            <b>if</b> (!<a href="#5c3a950369be9ecf" class="i field">_remoteBreakpointManagementIsSupported</a>.<span class="i">Value</span>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#021b4370ebdc2266" class="t constructor">PSNotSupportedException</a>(
                    <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(
                        <span class="i">DebuggerStrings</span>.<span class="i">CommandNotSupportedForRemoteUseInServerDebugger</span>,
                        <a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#78b2ba59f74e7676" class="t t">RemoteDebuggingCommands</a>.<a href="../common/WireDataFormat/RemoteDebuggingCapability.cs.html#7c682f229fbc81f1" class="i method">CleanCommandName</a>(<span class="r215 r">breakpointCommandNameToCheck</span>)));
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RemoteSessionStateProxy
 
    <b>internal class</b> <a id="10d5d3dbc99047bc" href="../../../R/10d5d3dbc99047bc.html" target="n" data-glyph="2,0" class="t t">RemoteSessionStateProxy</a> : <a href="../../hostifaces/Connection.cs.html#6d877a4c99871852" class="t t">SessionStateProxy</a>
    {
        <b>private readonly</b> <a href="#e2c1bde75e106663" class="t t">RemoteRunspace</a> <a id="97df6e598bbb9359" href="../../../R/97df6e598bbb9359.html" target="n" data-glyph="46,1" class="i field">_runspace</a>;
 
        <b>internal</b> <a id="7a1b424d0f2d5775" href="../../../R/7a1b424d0f2d5775.html" target="n" data-glyph="74,1" class="t constructor">RemoteSessionStateProxy</a>(<a href="#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r216 rd" class="r216 r">runspace</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r216 r">runspace</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
            <a href="#97df6e598bbb9359" class="i field">_runspace</a> = <span class="r216 r">runspace</span>;
        }
 
        <b>private</b> <span class="i">Exception</span> <a id="fc31a86deae7dcdb" href="../../../R/fc31a86deae7dcdb.html" target="n" data-glyph="46,1" class="i field">_isInNoLanguageModeException</a> = <b>null</b>;
        <b>private</b> <span class="i">Exception</span> <a id="77315ccaa6eb661b" href="../../../R/77315ccaa6eb661b.html" target="n" data-glyph="46,1" class="i field">_getVariableCommandNotFoundException</a> = <b>null</b>;
        <b>private</b> <span class="i">Exception</span> <a id="4e14e1b840a18d0c" href="../../../R/4e14e1b840a18d0c.html" target="n" data-glyph="46,1" class="i field">_setVariableCommandNotFoundException</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set a variable in session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the item to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r218 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new value of the item being set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="5ba04006d36f8383" href="../../../R/5ba04006d36f8383.html" target="n" data-glyph="72,1" class="i method">SetVariable</a>(<b>string</b> <span id="r217 rd" class="r217 r">name</span>, <b>object</b> <span id="r218 rd" class="r218 r">value</span>)
        {
            <b>if</b> (<span class="r217 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r217 r">name</span>));
            }
 
            <span class="c">// Verify the runspace has the Set-Variable command. For performance, throw if we got an error</span>
            <span class="c">// before.</span>
            <b>if</b> (<a href="#4e14e1b840a18d0c" class="i field">_setVariableCommandNotFoundException</a> != <b>null</b>)
                <b>throw</b> <a href="#4e14e1b840a18d0c" class="i field">_setVariableCommandNotFoundException</a>;
 
            <span class="c">// Since these are implemented as pipelines, we don&#39;t need to do our own</span>
            <span class="c">// locking of sessionStateCallInProgress like we do with local runspaces.</span>
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r219 rd" class="r219 r">remotePipeline</span> = <a href="#97df6e598bbb9359" class="i field">_runspace</a>.<a href="#ba07b4eedf69ef65" class="i method">CreatePipeline</a>();
            <a href="../../hostifaces/Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r220 rd" class="r220 r">command</span> = <b>new</b> <a href="../../hostifaces/Command.cs.html#6c075592cf04e686" class="t constructor">Command</a>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Set-Variable&quot;</span>);
            <span class="r220 r">command</span>.<a href="../../hostifaces/Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="../../hostifaces/Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<span class="s">&quot;Name&quot;</span>, <span class="r217 r">name</span>);
            <span class="r220 r">command</span>.<a href="../../hostifaces/Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="../../hostifaces/Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<span class="s">&quot;Value&quot;</span>, <span class="r218 r">value</span>);
            <span class="r219 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#55623b34b6a2a65a" class="i property">Commands</a>.<span class="i">Add</span>(<span class="r220 r">command</span>);
 
            <b>try</b>
            {
                <span class="r219 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#f211da0a5b795e94" class="i method">Invoke</a>();
            }
            <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r221 rd" class="r221 r">e</span>)
            {
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;CommandNotFoundException&quot;</span>, <span class="r221 r">e</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#4e14e1b840a18d0c" class="i field">_setVariableCommandNotFoundException</a> = <b>new</b> <span class="t">PSNotSupportedException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NotSupportedOnRestrictedRunspace</span>, <span class="r221 r">e</span>);
                    <b>throw</b> <a href="#4e14e1b840a18d0c" class="i field">_setVariableCommandNotFoundException</a>;
                }
                <b>else</b> <b>throw</b>;
            }
 
            <b>if</b> (<span class="r219 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#cc6ca02e9720dc4a" class="i property">Error</a>.<a href="../../../utils/IObjectReader.cs.html#fb103466fcdb6fb2" class="i property">Count</a> &gt; 0)
            {
                <span class="c">// Don&#39;t cache these errors, as they are related to the actual variable being set.</span>
                <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r222 rd" class="r222 r">error</span> = (<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)<span class="r219 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#cc6ca02e9720dc4a" class="i property">Error</a>.<a href="../../../utils/IObjectReader.cs.html#44674511beae23a4" class="i method">Read</a>();
                <b>throw</b> <b>new</b> <span class="t">PSNotSupportedException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NotSupportedOnRestrictedRunspace</span>, <span class="r222 r">error</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a variable out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r223 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name of variable to look up</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the specified variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> name is null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="74ebd5da8715cd18" href="../../../R/74ebd5da8715cd18.html" target="n" data-glyph="72,1" class="i method">GetVariable</a>(<b>string</b> <span id="r223 rd" class="r223 r">name</span>)
        {
            <b>if</b> (<span class="r223 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r223 r">name</span>));
            }
 
            <span class="c">// Verify the runspace has the Get-Variable command. For performance, throw if we got an error</span>
            <span class="c">// before.</span>
            <b>if</b> (<a href="#77315ccaa6eb661b" class="i field">_getVariableCommandNotFoundException</a> != <b>null</b>)
                <b>throw</b> <a href="#77315ccaa6eb661b" class="i field">_getVariableCommandNotFoundException</a>;
 
            <span class="c">// Since these are implemented as pipelines, we don&#39;t need to do our own</span>
            <span class="c">// locking of sessionStateCallInProgress like we do with local runspaces.</span>
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r224 rd" class="r224 r">remotePipeline</span> = <a href="#97df6e598bbb9359" class="i field">_runspace</a>.<a href="#ba07b4eedf69ef65" class="i method">CreatePipeline</a>();
            <a href="../../hostifaces/Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r225 rd" class="r225 r">command</span> = <b>new</b> <a href="../../hostifaces/Command.cs.html#6c075592cf04e686" class="t constructor">Command</a>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Get-Variable&quot;</span>);
            <span class="r225 r">command</span>.<a href="../../hostifaces/Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>.<a href="../../hostifaces/Parameter.cs.html#435d9001e2932613" class="i method">Add</a>(<span class="s">&quot;Name&quot;</span>, <span class="r223 r">name</span>);
            <span class="r224 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#55623b34b6a2a65a" class="i property">Commands</a>.<span class="i">Add</span>(<span class="r225 r">command</span>);
            <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>.<span class="i">Collection</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r226 rd" class="r226 r">result</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r226 r">result</span> = <span class="r224 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#f211da0a5b795e94" class="i method">Invoke</a>();
            }
            <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r227 rd" class="r227 r">e</span>)
            {
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;CommandNotFoundException&quot;</span>, <span class="r227 r">e</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#77315ccaa6eb661b" class="i field">_getVariableCommandNotFoundException</a> = <b>new</b> <span class="t">PSNotSupportedException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NotSupportedOnRestrictedRunspace</span>, <span class="r227 r">e</span>);
                    <b>throw</b> <a href="#77315ccaa6eb661b" class="i field">_getVariableCommandNotFoundException</a>;
                }
                <b>else</b> <b>throw</b>;
            }
 
            <b>if</b> (<span class="r224 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#cc6ca02e9720dc4a" class="i property">Error</a>.<a href="../../../utils/IObjectReader.cs.html#fb103466fcdb6fb2" class="i property">Count</a> &gt; 0)
            {
                <span class="c">// Don&#39;t cache these errors, as they are related to the actual variable being set.</span>
                <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r228 rd" class="r228 r">error</span> = (<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>)<span class="r224 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#cc6ca02e9720dc4a" class="i property">Error</a>.<a href="../../../utils/IObjectReader.cs.html#44674511beae23a4" class="i method">Read</a>();
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;CommandNotFoundException&quot;</span>, <span class="r228 r">error</span>.<a href="../../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>throw</b> <b>new</b> <span class="t">PSNotSupportedException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NotSupportedOnRestrictedRunspace</span>, <span class="r228 r">error</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>);
                }
                <b>else</b>
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="r228 r">error</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">Message</span>, <span class="r228 r">error</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>);
                }
            }
 
            <b>if</b> (<span class="r226 r">result</span>.<span class="i">Count</span> != 1)
                <b>return</b> <b>null</b>;
            <b>else</b>
                <b>return</b> <span class="r226 r">result</span>[0].<span class="i">Properties</span>[<span class="s">&quot;Value&quot;</span>].<span class="i">Value</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the list of applications out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="4c5e282702e4c45c" href="../../../R/4c5e282702e4c45c.html" target="n" data-glyph="102,1" class="i property">Applications</a>
        {
            <b>get</b>
            {
                <span class="c">// Verify the runspace has is not in NoLanguage mode. For performance, throw if we got an error</span>
                <span class="c">// before.</span>
                <b>if</b> (<a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a> != <b>null</b>)
                    <b>throw</b> <a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a>;
 
                <span class="c">// Since these are implemented as pipelines, we don&#39;t need to do our own</span>
                <span class="c">// locking of sessionStateCallInProgress like we do with local runspaces.</span>
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r229 rd" class="r229 r">remotePipeline</span> = <a href="#97df6e598bbb9359" class="i field">_runspace</a>.<a href="#ba07b4eedf69ef65" class="i method">CreatePipeline</a>();
                <span class="r229 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#55623b34b6a2a65a" class="i property">Commands</a>.<a href="../../hostifaces/Command.cs.html#78c5b464fbd0645d" class="i method">AddScript</a>(<span class="s">&quot;$executionContext.SessionState.Applications&quot;</span>);
 
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r230 rd" class="r230 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>try</b>
                {
                    <b>foreach</b> (<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r231 rd" class="r231 r">application</span> <b>in</b> <span class="r229 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#f211da0a5b795e94" class="i method">Invoke</a>())
                    {
                        <span class="r230 r">result</span>.<span class="i">Add</span>(<span class="r231 r">application</span>.<a href="../../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as string</b>);
                    }
                }
                <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r232 rd" class="r232 r">e</span>)
                {
                    <b>if</b> (<span class="r232 r">e</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="../../ErrorPackage.cs.html#f4073b5e554619ca" class="i property">Category</a> == <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#430a0c357a10c85c" class="i field">ParserError</a>)
                    {
                        <a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a> = <b>new</b> <span class="t">PSNotSupportedException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NotSupportedOnRestrictedRunspace</span>, <span class="r232 r">e</span>);
                        <b>throw</b> <a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a>;
                    }
                    <b>else</b> <b>throw</b>;
                }
 
                <b>return</b> <span class="r230 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the list of scripts out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="824cf54ee898fb88" href="../../../R/824cf54ee898fb88.html" target="n" data-glyph="102,1" class="i property">Scripts</a>
        {
            <b>get</b>
            {
                <span class="c">// Verify the runspace has is not in NoLanguage mode. For performance, throw if we got an error</span>
                <span class="c">// before.</span>
                <b>if</b> (<a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a> != <b>null</b>)
                    <b>throw</b> <a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a>;
 
                <span class="c">// Since these are implemented as pipelines, we don&#39;t need to do our own</span>
                <span class="c">// locking of sessionStateCallInProgress like we do with local runspaces.</span>
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r233 rd" class="r233 r">remotePipeline</span> = <a href="#97df6e598bbb9359" class="i field">_runspace</a>.<a href="#ba07b4eedf69ef65" class="i method">CreatePipeline</a>();
                <span class="r233 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#55623b34b6a2a65a" class="i property">Commands</a>.<a href="../../hostifaces/Command.cs.html#78c5b464fbd0645d" class="i method">AddScript</a>(<span class="s">&quot;$executionContext.SessionState.Scripts&quot;</span>);
 
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r234 rd" class="r234 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>try</b>
                {
                    <b>foreach</b> (<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r235 rd" class="r235 r">application</span> <b>in</b> <span class="r233 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#f211da0a5b795e94" class="i method">Invoke</a>())
                    {
                        <span class="r234 r">result</span>.<span class="i">Add</span>(<span class="r235 r">application</span>.<a href="../../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as string</b>);
                    }
                }
                <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r236 rd" class="r236 r">e</span>)
                {
                    <b>if</b> (<span class="r236 r">e</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="../../ErrorPackage.cs.html#f4073b5e554619ca" class="i property">Category</a> == <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#430a0c357a10c85c" class="i field">ParserError</a>)
                    {
                        <a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a> = <b>new</b> <span class="t">PSNotSupportedException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NotSupportedOnRestrictedRunspace</span>, <span class="r236 r">e</span>);
                        <b>throw</b> <a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a>;
                    }
                    <b>else</b> <b>throw</b>;
                }
 
                <b>return</b> <span class="r234 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access drives out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../DriveInterfaces.cs.html#af7db3a0f716ab5e" class="t t">DriveManagementIntrinsics</a> <a id="ddfe2e992606218e" href="../../../R/ddfe2e992606218e.html" target="n" data-glyph="102,1" class="i property">Drive</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get/Set the language mode out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="4b29048cc5b4e82e" href="../../../R/4b29048cc5b4e82e.html" target="n" data-glyph="102,1" class="i property">LanguageMode</a>
        {
            <b>get</b>
            {
                <span class="c">// Verify the runspace has is not in NoLanguage mode. For performance, return our</span>
                <span class="c">// cached value if we got an error before.</span>
                <b>if</b> (<a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a> != <b>null</b>)
                    <b>return</b> <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>;
 
                <span class="c">// Since these are implemented as pipelines, we don&#39;t need to do our own</span>
                <span class="c">// locking of sessionStateCallInProgress like we do with local runspaces.</span>
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r237 rd" class="r237 r">remotePipeline</span> = <a href="#97df6e598bbb9359" class="i field">_runspace</a>.<a href="#ba07b4eedf69ef65" class="i method">CreatePipeline</a>();
                <span class="r237 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#55623b34b6a2a65a" class="i property">Commands</a>.<a href="../../hostifaces/Command.cs.html#78c5b464fbd0645d" class="i method">AddScript</a>(<span class="s">&quot;$executionContext.SessionState.LanguageMode&quot;</span>);
 
                <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>.<span class="i">Collection</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r238 rd" class="r238 r">result</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="r238 r">result</span> = <span class="r237 r">remotePipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#f211da0a5b795e94" class="i method">Invoke</a>();
                }
                <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a> <span id="r239 rd" class="r239 r">e</span>)
                {
                    <b>if</b> (<span class="r239 r">e</span>.<a href="../../NativeCommandProcessor.cs.html#ae7bb0007ca4088a" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="../../ErrorPackage.cs.html#f4073b5e554619ca" class="i property">Category</a> == <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#430a0c357a10c85c" class="i field">ParserError</a>)
                    {
                        <a href="#fc31a86deae7dcdb" class="i field">_isInNoLanguageModeException</a> = <b>new</b> <span class="t">PSNotSupportedException</span>(<span class="i">RunspaceStrings</span>.<span class="i">NotSupportedOnRestrictedRunspace</span>, <span class="r239 r">e</span>);
                        <b>return</b> <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>;
                    }
                    <b>else</b> <b>throw</b>;
                }
 
                <b>return</b> (<a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>)<a href="../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r238 r">result</span>[0], <b>typeof</b>(<a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
 
            <b>set</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the module info out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="27332cffee619a3c" href="../../../R/27332cffee619a3c.html" target="n" data-glyph="102,1" class="i property">Module</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access paths and locations out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../PathInterfaces.cs.html#2a45e8d71562122c" class="t t">PathIntrinsics</a> <a id="1855c01e6e1be412" href="../../../R/1855c01e6e1be412.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access a provider out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../ProviderInterfaces.cs.html#5df802574bbd2fbe" class="t t">CmdletProviderManagementIntrinsics</a> <a id="c629f28dee9a4b44" href="../../../R/c629f28dee9a4b44.html" target="n" data-glyph="102,1" class="i property">Provider</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to access variables out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../VariableInterfaces.cs.html#a66e215a6e6c92d5" class="t t">PSVariableIntrinsics</a> <a id="96c0dd14bebac12b" href="../../../R/96c0dd14bebac12b.html" target="n" data-glyph="102,1" class="i property">PSVariable</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the APIs to build script blocks and execute script out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../MshCmdlet.cs.html#444c098e64ffcf20" class="t t">CommandInvocationIntrinsics</a> <a id="b556ba3bc021fd3b" href="../../../R/b556ba3bc021fd3b.html" target="n" data-glyph="102,1" class="i property">InvokeCommand</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the instance of the provider interface APIs out of session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace is not open.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Another SessionStateProxy call or another pipeline is in progress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../CmdletFamilyProviderInterfaces.cs.html#7e7c55aa110a0320" class="t t">ProviderIntrinsics</a> <a id="b3ae9e1c83be41dc" href="../../../R/b3ae9e1c83be41dc.html" target="n" data-glyph="102,1" class="i property">InvokeProvider</a>
        {
            <b>get</b>
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
