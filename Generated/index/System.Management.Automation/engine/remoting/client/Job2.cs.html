<!DOCTYPE html>
<html><head><title>Job2.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(2211);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/client/Job2.cs" target="_top">engine\remoting\client\Job2.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Tracing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<span class="c">// Stops compiler from warning about unknown warnings</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PowerShell v3 Job Extensions
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> New base class for a job that provides extended state</span>
    <span class="c">///</span><span class="c"> management functionality on the job. Since the existing</span>
    <span class="c">///</span><span class="c"> Job class is an abstract class and there are existing</span>
    <span class="c">///</span><span class="c"> implementations of the same, it is required to have a</span>
    <span class="c">///</span><span class="c"> new class that will have the extended functionality. This</span>
    <span class="c">///</span><span class="c"> is to ensure that backwards compatibility is maintained</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> However, this class will derive from the existing Job</span>
    <span class="c">///</span><span class="c"> class. The option of deprecating the existing class was</span>
    <span class="c">///</span><span class="c"> considered as well. In order to maintain backwards</span>
    <span class="c">///</span><span class="c"> compatibility of PowerShell job cmdlets they will have</span>
    <span class="c">///</span><span class="c"> to work with the old interface and hence deprecating</span>
    <span class="c">///</span><span class="c"> the Job class did not add any benefit rather than</span>
    <span class="c">///</span><span class="c"> deriving from the same.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">The following are some of the notes about</span>
    <span class="c">///</span><span class="c"> why the asynchronous operations are provided this way</span>
    <span class="c">///</span><span class="c"> in this class. There are two possible options in which</span>
    <span class="c">///</span><span class="c"> asynchronous support can be provided:</span>
    <span class="c">///</span><span class="c">     1. Classical pattern (Begin and End)</span>
    <span class="c">///</span><span class="c">     2. Event based pattern</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Although the PowerShell API uses the classical pattern</span>
    <span class="c">///</span><span class="c"> and we would like the Job API and PowerShell API to be</span>
    <span class="c">///</span><span class="c"> as close as possible, the classical pattern is inherently</span>
    <span class="c">///</span><span class="c"> complex to use.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="f76d5e2b49661689" href="../../../R/f76d5e2b49661689.html" target="n" data-glyph="0,0" class="t t">Job2</a> : <a href="Job.cs.html#e1ff43f6998863de" class="t t">Job</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> These are the parameters that can be used by a job</span>
        <span class="c">///</span><span class="c"> implementation when they want to specify parameters</span>
        <span class="c">///</span><span class="c"> to start a job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<a href="../../hostifaces/Parameter.cs.html#d9a8a30704d0880b" class="t t">CommandParameterCollection</a>&gt; <a id="a255ff46634c4bb8" href="../../../R/a255ff46634c4bb8.html" target="n" data-glyph="46,1" class="i field">_parameters</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object that will be used for thread synchronization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly object</b> <a id="df1bbffa28621154" href="../../../R/df1bbffa28621154.html" target="n" data-glyph="46,1" class="i field">_syncobject</a> = <b>new</b> <b>object</b>();
 
        <b>private const int</b> <a id="0acd9caec804899a" href="../../../R/0acd9caec804899a.html" target="n" data-glyph="10,1" class="i field">StartJobOperation</a> = 1;
        <b>private const int</b> <a id="682554795201fa3c" href="../../../R/682554795201fa3c.html" target="n" data-glyph="10,1" class="i field">StopJobOperation</a> = 2;
        <b>private const int</b> <a id="d027e89054d9b6d2" href="../../../R/d027e89054d9b6d2.html" target="n" data-glyph="10,1" class="i field">SuspendJobOperation</a> = 3;
        <b>private const int</b> <a id="511cd7af9ad0975a" href="../../../R/511cd7af9ad0975a.html" target="n" data-glyph="10,1" class="i field">ResumeJobOperation</a> = 4;
        <b>private const int</b> <a id="f887fa87e3d2abc0" href="../../../R/f887fa87e3d2abc0.html" target="n" data-glyph="10,1" class="i field">UnblockJobOperation</a> = 5;
 
        <b>private readonly</b> <a href="../../../utils/PowerShellETWTracer.cs.html#3fd13a01d0177ce2" class="t t">PowerShellTraceSource</a> <a id="9ca31a5a014e9899" href="../../../R/9ca31a5a014e9899.html" target="n" data-glyph="46,1" class="i field">_tracer</a> = <a href="../../../utils/PowerShellETWTracer.cs.html#37e484a307a595c3" class="t t">PowerShellTraceSourceFactory</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#c94a9fbfef99a75d" class="i method">GetTraceSource</a>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameters to be used to start a job.</span>
        <span class="c">///</span><span class="c"> This is a property because CommandParameterCollection</span>
        <span class="c">///</span><span class="c"> does not have a public constructor. Hence the</span>
        <span class="c">///</span><span class="c"> infrastructure creates an instance and provides</span>
        <span class="c">///</span><span class="c"> it for the implementations to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1002:DoNotExposeGenericLists&quot;</span>)]
        <b>public</b> <span class="i">List</span>&lt;<a href="../../hostifaces/Parameter.cs.html#d9a8a30704d0880b" class="t t">CommandParameterCollection</a>&gt; <a id="c1de8656aafc1dbf" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">StartParameters</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#a255ff46634c4bb8" class="i field">_parameters</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#df1bbffa28621154" class="i field">_syncobject</a>)
                    {
                        <b>if</b> (<a href="#a255ff46634c4bb8" class="i field">_parameters</a> == <b>null</b>)
                            <a href="#a255ff46634c4bb8" class="i field">_parameters</a> = <b>new</b> <span class="i">List</span>&lt;<a href="../../hostifaces/Parameter.cs.html#d9a8a30704d0880b" class="t t">CommandParameterCollection</a>&gt;();
                    }
                }
 
                <b>return</b> <a href="#a255ff46634c4bb8" class="i field">_parameters</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;value&quot;</span>);
                }
 
                <b>lock</b> (<a href="#df1bbffa28621154" class="i field">_syncobject</a>)
                {
                    <a href="#a255ff46634c4bb8" class="i field">_parameters</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected object</b> <a id="ec287f24f6364dc2" href="../../../R/../../0000000000.html" target="n" data-glyph="105,1" class="i property">SyncRoot</a>
        {
            <b>get</b> { <b>return</b> <a href="Job.cs.html#d933c0709e639dd1" class="i field">syncObject</a>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default no argument constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a id="02716953b97d8e49" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">Job2</a>() : <a href="Job.cs.html#47807e473d67bda3" class="k">base</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor which will initialize the job</span>
        <span class="c">///</span><span class="c"> with the associated command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">string representation</span>
        <span class="c">///</span><span class="c"> of the command the job is running</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="cfe00cbce6b6b64d" href="../../../R/cfe00cbce6b6b64d.html" target="n" data-glyph="75,1" class="t constructor">Job2</a>(<b>string</b> <span id="r0 rd" class="r0 r">command</span>) : <a href="Job.cs.html#74a42d7ce4759be3" class="k">base</a>(<span class="r0 r">command</span>) { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="df04e28048ad362a" href="../../../R/df04e28048ad362a.html" target="n" data-glyph="75,1" class="t constructor">Job2</a>(<b>string</b> <span id="r1 rd" class="r1 r">command</span>, <b>string</b> <span id="r2 rd" class="r2 r">name</span>)
            : <a href="Job.cs.html#8083742b97acc268" class="k">base</a>(<span class="r1 r">command</span>, <span class="r2 r">name</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">childJobs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Child jobs of this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="4d3e0691a1b0b68f" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">Job2</a>(<b>string</b> <span id="r3 rd" class="r3 r">command</span>, <b>string</b> <span id="r4 rd" class="r4 r">name</span>, <span class="i">IList</span>&lt;<a href="Job.cs.html#e1ff43f6998863de" class="t t">Job</a>&gt; <span id="r5 rd" class="r5 r">childJobs</span>)
            : <a href="Job.cs.html#e7e8f9709e2cfedc" class="k">base</a>(<span class="r3 r">command</span>, <span class="r4 r">name</span>, <span class="r5 r">childJobs</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command invoked by this job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">token</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">JobIdentifier token used to assign Id and InstanceId.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="984553b8cc1f8c82" href="../../../R/984553b8cc1f8c82.html" target="n" data-glyph="75,1" class="t constructor">Job2</a>(<b>string</b> <span id="r6 rd" class="r6 r">command</span>, <b>string</b> <span id="r7 rd" class="r7 r">name</span>, <a href="Job.cs.html#746f37dcfb77f63f" class="t t">JobIdentifier</a> <span id="r8 rd" class="r8 r">token</span>)
            : <a href="Job.cs.html#be222e44b9c2d6d7" class="k">base</a>(<span class="r6 r">command</span>, <span class="r7 r">name</span>, <span class="r8 r">token</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of this class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance ID to allow job identification across sessions.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="c721e4b0d81164a6" href="../../../R/c721e4b0d81164a6.html" target="n" data-glyph="75,1" class="t constructor">Job2</a>(<b>string</b> <span id="r9 rd" class="r9 r">command</span>, <b>string</b> <span id="r10 rd" class="r10 r">name</span>, <span class="i">Guid</span> <span id="r11 rd" class="r11 r">instanceId</span>)
            : <a href="Job.cs.html#5a60b335d7bfb6a1" class="k">base</a>(<span class="r9 r">command</span>, <span class="r10 r">name</span>, <span class="r11 r">instanceId</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> There is an internal method in Job which is not made</span>
        <span class="c">///</span><span class="c"> public. In order to make this available to someone</span>
        <span class="c">///</span><span class="c"> implementing a job it has to be added here. If the</span>
        <span class="c">///</span><span class="c"> original method is made public it has changes of</span>
        <span class="c">///</span><span class="c"> colliding with some implementation which may have</span>
        <span class="c">///</span><span class="c"> added that method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">state</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">State of the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">exception associated with the</span>
        <span class="c">///</span><span class="c"> job entering this state</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <b>new</b> <b>void</b> <a id="ac1c5474a9868cec" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">SetJobState</a>(<a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r12 rd" class="r12 r">state</span>, <span class="i">Exception</span> <span id="r13 rd" class="r13 r">reason</span>)
        {
            <a href="Job.cs.html#e1ff43f6998863de" class="k">base</a>.<a href="Job.cs.html#c3fb91c6ec548ed8" class="i method">SetJobState</a>(<span class="r12 r">state</span>, <span class="r13 r">reason</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Protected Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> State Management
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Start a job. The job will be started with the parameters</span>
        <span class="c">///</span><span class="c"> specified in StartParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">It is redundant to have a method named StartJob</span>
        <span class="c">///</span><span class="c"> on a job class. However, this is done so as to avoid</span>
        <span class="c">///</span><span class="c"> an FxCop violation &quot;CA1716:IdentifiersShouldNotMatchKeywords&quot;</span>
        <span class="c">///</span><span class="c"> Stop and Resume are reserved keyworks in C# and hence cannot</span>
        <span class="c">///</span><span class="c"> be used as method names. Therefore to be consistent it has</span>
        <span class="c">///</span><span class="c"> been decided to use *Job in the name of the methods</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="89e2de1203c1ba7a" href="../../../R/89e2de1203c1ba7a.html" target="n" data-glyph="72,1" class="i method">StartJob</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Start a job asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="eb40bb077f49c08c" href="../../../R/eb40bb077f49c08c.html" target="n" data-glyph="72,1" class="i method">StartJobAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event to be raise when the start job activity is completed.</span>
        <span class="c">///</span><span class="c"> This event should not be raised for</span>
        <span class="c">///</span><span class="c"> synchronous operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <a id="59209062bc2d85b7" href="../../../R/59209062bc2d85b7.html" target="n" data-glyph="30,1" class="i">StartJobCompleted</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method which can be extended or called by derived</span>
        <span class="c">///</span><span class="c"> classes to raise the event when start of</span>
        <span class="c">///</span><span class="c"> the job is completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">arguments describing</span>
        <span class="c">///</span><span class="c"> an exception that is associated with the event</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="42e530851ffeacd0" href="../../../R/42e530851ffeacd0.html" target="n" data-glyph="75,1" class="i method">OnStartJobCompleted</a>(<span class="i">AsyncCompletedEventArgs</span> <span id="r14 rd" class="r14 r">eventArgs</span>)
        {
            <a href="#b9f0f35e30c05e50" class="i method">RaiseCompletedHandler</a>(<a href="#0acd9caec804899a" class="i field">StartJobOperation</a>, <span class="r14 r">eventArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method which can be extended or called by derived</span>
        <span class="c">///</span><span class="c"> classes to raise the event when stopping a</span>
        <span class="c">///</span><span class="c"> job is completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">argument describing</span>
        <span class="c">///</span><span class="c"> an exception that is associated with the event</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="ae09405383e21cf0" href="../../../R/ae09405383e21cf0.html" target="n" data-glyph="75,1" class="i method">OnStopJobCompleted</a>(<span class="i">AsyncCompletedEventArgs</span> <span id="r15 rd" class="r15 r">eventArgs</span>)
        {
            <a href="#b9f0f35e30c05e50" class="i method">RaiseCompletedHandler</a>(<a href="#682554795201fa3c" class="i field">StopJobOperation</a>, <span class="r15 r">eventArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method which can be extended or called by derived</span>
        <span class="c">///</span><span class="c"> classes to raise the event when suspending a</span>
        <span class="c">///</span><span class="c"> job is completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">argument describing</span>
        <span class="c">///</span><span class="c"> an exception that is associated with the event</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="fb44555e56d92103" href="../../../R/fb44555e56d92103.html" target="n" data-glyph="75,1" class="i method">OnSuspendJobCompleted</a>(<span class="i">AsyncCompletedEventArgs</span> <span id="r16 rd" class="r16 r">eventArgs</span>)
        {
            <a href="#b9f0f35e30c05e50" class="i method">RaiseCompletedHandler</a>(<a href="#d027e89054d9b6d2" class="i field">SuspendJobOperation</a>, <span class="r16 r">eventArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method which can be extended or called by derived</span>
        <span class="c">///</span><span class="c"> classes to raise the event when resuming a</span>
        <span class="c">///</span><span class="c"> suspended job is completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">argument describing</span>
        <span class="c">///</span><span class="c"> an exception that is associated with the event</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="019728ffc1dc7ba6" href="../../../R/019728ffc1dc7ba6.html" target="n" data-glyph="75,1" class="i method">OnResumeJobCompleted</a>(<span class="i">AsyncCompletedEventArgs</span> <span id="r17 rd" class="r17 r">eventArgs</span>)
        {
            <a href="#b9f0f35e30c05e50" class="i method">RaiseCompletedHandler</a>(<a href="#511cd7af9ad0975a" class="i field">ResumeJobOperation</a>, <span class="r17 r">eventArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method which can be extended or called by derived</span>
        <span class="c">///</span><span class="c"> classes to raise the event when unblocking a</span>
        <span class="c">///</span><span class="c"> blocked job is completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">argument describing</span>
        <span class="c">///</span><span class="c"> an exception that is associated with the event</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="70ec56eb6acd9a04" href="../../../R/70ec56eb6acd9a04.html" target="n" data-glyph="75,1" class="i method">OnUnblockJobCompleted</a>(<span class="i">AsyncCompletedEventArgs</span> <span id="r18 rd" class="r18 r">eventArgs</span>)
        {
            <a href="#b9f0f35e30c05e50" class="i method">RaiseCompletedHandler</a>(<a href="#f887fa87e3d2abc0" class="i field">UnblockJobOperation</a>, <span class="r18 r">eventArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the appropriate event based on the operation</span>
        <span class="c">///</span><span class="c"> and the associated event arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">operation for which the event</span>
        <span class="c">///</span><span class="c"> needs to be raised</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b9f0f35e30c05e50" href="../../../R/b9f0f35e30c05e50.html" target="n" data-glyph="76,1" class="i method">RaiseCompletedHandler</a>(<b>int</b> <span id="r19 rd" class="r19 r">operation</span>, <span class="i">AsyncCompletedEventArgs</span> <span id="r20 rd" class="r20 r">eventArgs</span>)
        {
            <span class="c">// Make a temporary copy of the event to avoid possibility of</span>
            <span class="c">// a race condition if the last subscriber unsubscribes</span>
            <span class="c">// immediately after the null check and before the event is raised.</span>
            <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r21 rd" class="r21 r">handler</span> = <b>null</b>;
 
            <b>switch</b> (<span class="r19 r">operation</span>)
            {
                <b>case</b> <a href="#0acd9caec804899a" class="i field">StartJobOperation</a>:
                    {
                        <span class="r21 r">handler</span> = <a href="#59209062bc2d85b7" class="i">StartJobCompleted</a>;
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="#682554795201fa3c" class="i field">StopJobOperation</a>:
                    {
                        <span class="r21 r">handler</span> = <a href="#0462f78c49dda28a" class="i">StopJobCompleted</a>;
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="#d027e89054d9b6d2" class="i field">SuspendJobOperation</a>:
                    {
                        <span class="r21 r">handler</span> = <a href="#478203a25ff210ad" class="i">SuspendJobCompleted</a>;
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="#511cd7af9ad0975a" class="i field">ResumeJobOperation</a>:
                    {
                        <span class="r21 r">handler</span> = <a href="#dfe4fd4f7fcfbc16" class="i">ResumeJobCompleted</a>;
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="#f887fa87e3d2abc0" class="i field">UnblockJobOperation</a>:
                    {
                        <span class="r21 r">handler</span> = <a href="#b99cf7aba317dbd3" class="i">UnblockJobCompleted</a>;
                    }
 
                    <b>break</b>;
                <b>default</b>:
                    {
                        <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;this condition should not be hit, check the value of operation that you passed&quot;</span>);
                    }
 
                    <b>break</b>;
            }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
            <b>try</b>
            {
                <span class="r21 r">handler</span>?.<span class="i">Invoke</span>(<a href="#f76d5e2b49661689" class="k">this</a>, <span class="r20 r">eventArgs</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r22 rd" class="r22 r">exception</span>)
            {
                <span class="c">// errors in the handlers are not errors in the operation</span>
                <span class="c">// silently ignore them</span>
                <a href="#9ca31a5a014e9899" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r22 r">exception</span>);
            }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop a job asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="17da884baa3fadf4" href="../../../R/17da884baa3fadf4.html" target="n" data-glyph="72,1" class="i method">StopJobAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event to be raised when the asynchronous stopping of a job</span>
        <span class="c">///</span><span class="c"> is completed.This event should not be raised for</span>
        <span class="c">///</span><span class="c"> synchronous operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <a id="0462f78c49dda28a" href="../../../R/0462f78c49dda28a.html" target="n" data-glyph="30,1" class="i">StopJobCompleted</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Suspend a job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="ed4c7d28ed795b8b" href="../../../R/ed4c7d28ed795b8b.html" target="n" data-glyph="72,1" class="i method">SuspendJob</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Asynchronously suspend a job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="9b4cbe910069df5f" href="../../../R/9b4cbe910069df5f.html" target="n" data-glyph="72,1" class="i method">SuspendJobAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This event should be raised whenever the asynchronous suspend of</span>
        <span class="c">///</span><span class="c"> a job is completed. This event should not be raised for</span>
        <span class="c">///</span><span class="c"> synchronous operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <a id="478203a25ff210ad" href="../../../R/478203a25ff210ad.html" target="n" data-glyph="30,1" class="i">SuspendJobCompleted</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resume a suspended job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="a2b4cf4e386aaff5" href="../../../R/a2b4cf4e386aaff5.html" target="n" data-glyph="72,1" class="i method">ResumeJob</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resume a suspended job asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="4e17ceeded154106" href="../../../R/4e17ceeded154106.html" target="n" data-glyph="72,1" class="i method">ResumeJobAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This event should be raised whenever the asynchronous resume of</span>
        <span class="c">///</span><span class="c"> a suspended job is completed. This event should not be raised for</span>
        <span class="c">///</span><span class="c"> synchronous operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <a id="dfe4fd4f7fcfbc16" href="../../../R/dfe4fd4f7fcfbc16.html" target="n" data-glyph="30,1" class="i">ResumeJobCompleted</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unblock a blocked job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="be5db8ff5280357e" href="../../../R/be5db8ff5280357e.html" target="n" data-glyph="72,1" class="i method">UnblockJob</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unblock a blocked job asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="c15f310c3c8d7b6c" href="../../../R/c15f310c3c8d7b6c.html" target="n" data-glyph="72,1" class="i method">UnblockJobAsync</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopJob.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="4206530e3881feec" href="../../../R/4206530e3881feec.html" target="n" data-glyph="72,1" class="i method">StopJob</a>(<b>bool</b> <span id="r23 rd" class="r23 r">force</span>, <b>string</b> <span id="r24 rd" class="r24 r">reason</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopJobAsync.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="6edb4f047652cfba" href="../../../R/6edb4f047652cfba.html" target="n" data-glyph="72,1" class="i method">StopJobAsync</a>(<b>bool</b> <span id="r25 rd" class="r25 r">force</span>, <b>string</b> <span id="r26 rd" class="r26 r">reason</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SuspendJob.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="f3bfdcdf7d4b2445" href="../../../R/f3bfdcdf7d4b2445.html" target="n" data-glyph="72,1" class="i method">SuspendJob</a>(<b>bool</b> <span id="r27 rd" class="r27 r">force</span>, <b>string</b> <span id="r28 rd" class="r28 r">reason</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SuspendJobAsync.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="5fd0d4d06af170a7" href="../../../R/5fd0d4d06af170a7.html" target="n" data-glyph="72,1" class="i method">SuspendJobAsync</a>(<b>bool</b> <span id="r29 rd" class="r29 r">force</span>, <b>string</b> <span id="r30 rd" class="r30 r">reason</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This event should be raised whenever the asynchronous unblock</span>
        <span class="c">///</span><span class="c"> of a blocked job is completed. This event should not be raised for</span>
        <span class="c">///</span><span class="c"> synchronous operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <a id="b99cf7aba317dbd3" href="../../../R/b99cf7aba317dbd3.html" target="n" data-glyph="30,1" class="i">UnblockJobCompleted</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> State Management
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Specifies the various thread options that can be used</span>
    <span class="c">///</span><span class="c"> for the ThreadBasedJob.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="590aefff5953062f" href="../../../R/../../0000000000.html" target="n" data-glyph="18,0" class="t t"><span id="b95e889d011023d3">JobThreadOptions</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use the default behavior, which is to use a</span>
        <span class="c">///</span><span class="c"> ThreadPoolThread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="fdc5795c4efde5ea" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Default</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use a thread pool thread.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="726395327999d9bd" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">UseThreadPoolThread</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new thread everything and reuse.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9f57d0dc3ecb6196" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">UseNewThread</a> = 2,
    }
 
    <span class="c">/*/// &lt;summary&gt;
    /// This job will provide asynchronous behavior by running
    /// the user specified script block in a separate process.
    /// There will be options for running the scriptblock
    /// in a new process or an existing process.
    /// &lt;/summary&gt;
    /// &lt;remarks&gt;Jobs for the out-of-process activity manager
    /// can be implemented using this interface&lt;/remarks&gt;
    public abstract class ProcessBasedJob : Job2
    {
        public override void Start()
        {
            throw new NotImplementedException();
        }
 
        public override void StartAsync()
        {
            throw new NotImplementedException();
        }
    }*/</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Top level container job.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="bb6daa5ca3253eb3" href="../../../R/bb6daa5ca3253eb3.html" target="n" data-glyph="0,0" class="t t">ContainerParentJob</a> : <a href="#f76d5e2b49661689" class="t t">Job2</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private const string</b> <a id="53760dcd989ece54" href="../../../R/53760dcd989ece54.html" target="n" data-glyph="10,1" class="i field">TraceClassName</a> = <span class="s">&quot;ContainerParentJob&quot;</span>;
 
        <b>private bool</b> <a id="932372ac4db766fe" href="../../../R/932372ac4db766fe.html" target="n" data-glyph="46,1" class="i field">_moreData</a> = <b>true</b>;
        <b>private readonly object</b> <a id="8106b14c4c26d8f4" href="../../../R/8106b14c4c26d8f4.html" target="n" data-glyph="46,1" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();
        <b>private int</b> <a id="a234cd03fceceef2" href="../../../R/a234cd03fceceef2.html" target="n" data-glyph="46,1" class="i field">_isDisposed</a> = 0;
 
        <b>private const int</b> <a id="c2c248949db582c4" href="../../../R/c2c248949db582c4.html" target="n" data-glyph="10,1" class="i field">DisposedTrue</a> = 1;
        <b>private const int</b> <a id="e3768dce5942ee6c" href="../../../R/e3768dce5942ee6c.html" target="n" data-glyph="10,1" class="i field">DisposedFalse</a> = 0;
        <span class="c">// This variable is set to true if atleast one child job failed.</span>
 
        <span class="c">// count of number of child jobs which have finished</span>
        <b>private int</b> <a id="97339ee1c252c116" href="../../../R/97339ee1c252c116.html" target="n" data-glyph="46,1" class="i field">_finishedChildJobsCount</a> = 0;
 
        <span class="c">// count of number of child jobs which are blocked</span>
        <b>private int</b> <a id="6431dabf7e89a94b" href="../../../R/6431dabf7e89a94b.html" target="n" data-glyph="46,1" class="i field">_blockedChildJobsCount</a> = 0;
 
        <span class="c">// count of number of child jobs which are suspended</span>
        <b>private int</b> <a id="0cc53d11a5256422" href="../../../R/0cc53d11a5256422.html" target="n" data-glyph="46,1" class="i field">_suspendedChildJobsCount</a> = 0;
 
        <span class="c">// count of number of child jobs which are suspending</span>
        <b>private int</b> <a id="30d5c997b151eb97" href="../../../R/30d5c997b151eb97.html" target="n" data-glyph="46,1" class="i field">_suspendingChildJobsCount</a> = 0;
 
        <span class="c">// count of number of child jobs which failed</span>
        <b>private int</b> <a id="1669d8fee7bd7364" href="../../../R/1669d8fee7bd7364.html" target="n" data-glyph="46,1" class="i field">_failedChildJobsCount</a> = 0;
 
        <span class="c">// count of number of child jobs which stopped</span>
        <b>private int</b> <a id="f5e3bb69d7f6ed1c" href="../../../R/f5e3bb69d7f6ed1c.html" target="n" data-glyph="46,1" class="i field">_stoppedChildJobsCount</a> = 0;
 
        <b>private readonly</b> <a href="../../../utils/PowerShellETWTracer.cs.html#3fd13a01d0177ce2" class="t t">PowerShellTraceSource</a> <a id="675d2d3dd8362483" href="../../../R/675d2d3dd8362483.html" target="n" data-glyph="46,1" class="i field">_tracer</a> = <a href="../../../utils/PowerShellETWTracer.cs.html#37e484a307a595c3" class="t t">PowerShellTraceSourceFactory</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#c94a9fbfef99a75d" class="i method">GetTraceSource</a>();
        <b>private readonly</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="2a42dcaf70597da5" href="../../../R/2a42dcaf70597da5.html" target="n" data-glyph="46,1" class="i field">_executionError</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;();
 
        <b>private</b> <a href="../../EventManager.cs.html#0fd88f72d27f82bd" class="t t">PSEventManager</a> <a id="bb98cdd6747f3d64" href="../../../R/bb98cdd6747f3d64.html" target="n" data-glyph="46,1" class="i field">_eventManager</a>;
 
        <b>internal</b> <a href="../../EventManager.cs.html#0fd88f72d27f82bd" class="t t">PSEventManager</a> <a id="0b57a6c54adc96b2" href="../../../R/0b57a6c54adc96b2.html" target="n" data-glyph="104,1" class="i property">EventManager</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#bb98cdd6747f3d64" class="i field">_eventManager</a>;
            }
 
            <b>set</b>
            {
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#9bc35c5d45bdf03f" class="i method">WriteMessage</a>(<span class="s">&quot;Setting event manager for Job &quot;</span>, <a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>);
                <a href="#bb98cdd6747f3d64" class="i field">_eventManager</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">ManualResetEvent</span> <a id="b1b91ee0fa29983e" href="../../../R/b1b91ee0fa29983e.html" target="n" data-glyph="46,1" class="i field">_jobRunning</a>;
 
        <b>private</b> <span class="i">ManualResetEvent</span> <a id="15a7c274c74a785d" href="../../../R/15a7c274c74a785d.html" target="n" data-glyph="106,1" class="i property">JobRunning</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#b1b91ee0fa29983e" class="i field">_jobRunning</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#8106b14c4c26d8f4" class="i field">_syncObject</a>)
                    {
                        <b>if</b> (<a href="#b1b91ee0fa29983e" class="i field">_jobRunning</a> == <b>null</b>)
                        {
                            <span class="c">// this assert is required so that a wait handle</span>
                            <span class="c">// is not created after the object is disposed</span>
                            <span class="c">// which will result in a leak</span>
                            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
                            <a href="#b1b91ee0fa29983e" class="i field">_jobRunning</a> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>false</b>);
                        }
                    }
                }
 
                <b>return</b> <a href="#b1b91ee0fa29983e" class="i field">_jobRunning</a>;
            }
        }
 
        <b>private</b> <span class="i">ManualResetEvent</span> <a id="e669a766303f6b2b" href="../../../R/e669a766303f6b2b.html" target="n" data-glyph="46,1" class="i field">_jobSuspendedOrAborted</a>;
 
        <b>private</b> <span class="i">ManualResetEvent</span> <a id="b39295d7af9c1205" href="../../../R/b39295d7af9c1205.html" target="n" data-glyph="106,1" class="i property">JobSuspendedOrAborted</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#e669a766303f6b2b" class="i field">_jobSuspendedOrAborted</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#8106b14c4c26d8f4" class="i field">_syncObject</a>)
                    {
                        <b>if</b> (<a href="#e669a766303f6b2b" class="i field">_jobSuspendedOrAborted</a> == <b>null</b>)
                        {
                            <span class="c">// this assert is required so that a wait handle</span>
                            <span class="c">// is not created after the object is disposed</span>
                            <span class="c">// which will result in a leak</span>
                            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
                            <a href="#e669a766303f6b2b" class="i field">_jobSuspendedOrAborted</a> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>false</b>);
                        }
                    }
                }
 
                <b>return</b> <a href="#e669a766303f6b2b" class="i field">_jobSuspendedOrAborted</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a container parent job with the</span>
        <span class="c">///</span><span class="c"> specified command string and name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for display.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4ff6033df7f2fc74" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ContainerParentJob</a>(<b>string</b> <span id="r31 rd" class="r31 r">command</span>, <b>string</b> <span id="r32 rd" class="r32 r">name</span>)
            : <a href="#df04e28048ad362a" class="k">base</a>(<span class="r31 r">command</span>, <span class="r32 r">name</span>)
        {
            <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleMyStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a container parent job with the</span>
        <span class="c">///</span><span class="c"> specified command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="17bbffcc26766abb" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ContainerParentJob</a>(<b>string</b> <span id="r33 rd" class="r33 r">command</span>)
            : <a href="#cfe00cbce6b6b64d" class="k">base</a>(<span class="r33 r">command</span>)
        {
            <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleMyStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a container parent job with the</span>
        <span class="c">///</span><span class="c"> specified command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">jobId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">JobIdentifier token that allows reuse of an Id and Instance Id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="b4ca10686c3240f8" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ContainerParentJob</a>(<b>string</b> <span id="r34 rd" class="r34 r">command</span>, <b>string</b> <span id="r35 rd" class="r35 r">name</span>, <a href="Job.cs.html#746f37dcfb77f63f" class="t t">JobIdentifier</a> <span id="r36 rd" class="r36 r">jobId</span>)
            : <a href="#984553b8cc1f8c82" class="k">base</a>(<span class="r34 r">command</span>, <span class="r35 r">name</span>, <span class="r36 r">jobId</span>)
        {
            <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleMyStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a container parent job with the</span>
        <span class="c">///</span><span class="c"> specified command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance ID to allow job identification across sessions.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="f0d8332d4fd67a30" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ContainerParentJob</a>(<b>string</b> <span id="r37 rd" class="r37 r">command</span>, <b>string</b> <span id="r38 rd" class="r38 r">name</span>, <span class="i">Guid</span> <span id="r39 rd" class="r39 r">instanceId</span>)
            : <a href="#c721e4b0d81164a6" class="k">base</a>(<span class="r37 r">command</span>, <span class="r38 r">name</span>, <span class="r39 r">instanceId</span>)
        {
            <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleMyStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a container parent job with the</span>
        <span class="c">///</span><span class="c"> specified command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">jobId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">JobIdentifier token that allows reuse of an Id and Instance Id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">jobType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Job type name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="5e39926e78bd3b59" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ContainerParentJob</a>(<b>string</b> <span id="r40 rd" class="r40 r">command</span>, <b>string</b> <span id="r41 rd" class="r41 r">name</span>, <a href="Job.cs.html#746f37dcfb77f63f" class="t t">JobIdentifier</a> <span id="r42 rd" class="r42 r">jobId</span>, <b>string</b> <span id="r43 rd" class="r43 r">jobType</span>)
            : <a href="#984553b8cc1f8c82" class="k">base</a>(<span class="r40 r">command</span>, <span class="r41 r">name</span>, <span class="r42 r">jobId</span>)
        {
            <a href="Job.cs.html#48fbced17e8f44b3" class="i property">PSJobTypeName</a> = <span class="r43 r">jobType</span>;
            <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleMyStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a container parent job with the</span>
        <span class="c">///</span><span class="c"> specified command string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance ID to allow job identification across sessions.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">jobType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Job type name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="e3a94293d7be29e7" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ContainerParentJob</a>(<b>string</b> <span id="r44 rd" class="r44 r">command</span>, <b>string</b> <span id="r45 rd" class="r45 r">name</span>, <span class="i">Guid</span> <span id="r46 rd" class="r46 r">instanceId</span>, <b>string</b> <span id="r47 rd" class="r47 r">jobType</span>)
            : <a href="#c721e4b0d81164a6" class="k">base</a>(<span class="r44 r">command</span>, <span class="r45 r">name</span>, <span class="r46 r">instanceId</span>)
        {
            <a href="Job.cs.html#48fbced17e8f44b3" class="i property">PSJobTypeName</a> = <span class="r47 r">jobType</span>;
            <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleMyStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a container parent job with the specified command, name,</span>
        <span class="c">///</span><span class="c"> job type strings.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Friendly name for the job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">jobType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Job type name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="a1952b0057cd0717" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ContainerParentJob</a>(<b>string</b> <span id="r48 rd" class="r48 r">command</span>, <b>string</b> <span id="r49 rd" class="r49 r">name</span>, <b>string</b> <span id="r50 rd" class="r50 r">jobType</span>)
            : <a href="#df04e28048ad362a" class="k">base</a>(<span class="r48 r">command</span>, <span class="r49 r">name</span>)
        {
            <a href="Job.cs.html#48fbced17e8f44b3" class="i property">PSJobTypeName</a> = <span class="r50 r">jobType</span>;
            <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleMyStateChanged</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
 
        <b>internal</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="b1aeaf44b6b22003" href="../../../R/b1aeaf44b6b22003.html" target="n" data-glyph="104,1" class="i property">ExecutionError</a> { <b>get</b> { <b>return</b> <a href="#2a42dcaf70597da5" class="i field">_executionError</a>; } }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a child job to the parent job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">childJob</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Child job to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if the job is disposed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if child being added is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public void</b> <a id="4a3d96e3b1e0eeae" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AddChildJob</a>(<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r51 rd" class="r51 r">childJob</span>)
        {
            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <b>if</b> (<span class="r51 r">childJob</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r51 r">childJob</span>));
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;AddChildJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r51 r">childJob</span>, <span class="s">&quot;Adding Child to Parent with InstanceId : &quot;</span>, <a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
 
            <a href="Job.cs.html#8f788812e1264af5" class="t t">JobStateInfo</a> <span id="r52 rd" class="r52 r">childJobStateInfo</span>;
            <b>lock</b> (<span class="r51 r">childJob</span>.<a href="Job.cs.html#d933c0709e639dd1" class="i field">syncObject</a>)
            {
                <span class="c">// Store job&#39;s state and subscribe to State Changed event. Locking here will</span>
                <span class="c">// ensure that the jobstateinfo we get is the state before any state changed events are handled by ContainerParentJob.</span>
                <span class="r52 r">childJobStateInfo</span> = <span class="r51 r">childJob</span>.<a href="Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>;
                <span class="r51 r">childJob</span>.<a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleChildJobStateChanged</span>;
            }
 
            <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Add</span>(<span class="r51 r">childJob</span>);
            <a href="#15b3ab7c091fd57b" class="i method">ParentJobStateCalculation</a>(<b>new</b> <a href="Job.cs.html#18e6fc44c599c11a" class="t constructor">JobStateEventArgs</a>(<span class="r52 r">childJobStateInfo</span>, <b>new</b> <a href="Job.cs.html#a797c55ae803218c" class="t constructor">JobStateInfo</a>(<a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#1213da49468b8ccd" class="i field">NotStarted</a>)));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates if more data is available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This has more data if any of the child jobs have more data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="8501f2b5e94d2d94" href="../../../R/8501f2b5e94d2d94.html" target="n" data-glyph="102,1" class="i property">HasMoreData</a>
        {
            <b>get</b>
            {
                <span class="c">// moreData is initially set to true, and it</span>
                <span class="c">// will remain so until the async result</span>
                <span class="c">// object has completed execution.</span>
                <b>if</b> (<a href="#932372ac4db766fe" class="i field">_moreData</a> &amp;&amp; <a href="Job.cs.html#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a>))
                {
                    <b>bool</b> <span id="r53 rd" class="r53 r">atleastOneChildHasMoreData</span> = <b>false</b>;
 
                    <b>for</b> (<b>int</b> <span id="r54 rd" class="r54 r">i</span> = 0; <span class="r54 r">i</span> &lt; <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>; <span class="r54 r">i</span>++)
                    {
                        <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[<span class="r54 r">i</span>].<span class="i">HasMoreData</span>)
                        {
                            <span class="r53 r">atleastOneChildHasMoreData</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
 
                    <a href="#932372ac4db766fe" class="i field">_moreData</a> = <span class="r53 r">atleastOneChildHasMoreData</span>;
                }
 
                <b>return</b> <a href="#932372ac4db766fe" class="i field">_moreData</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Message indicating status of the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="537889f9e5df0b5a" href="../../../R/537889f9e5df0b5a.html" target="n" data-glyph="102,1" class="i property">StatusMessage</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#89d81d2b54b6af82" class="i method">ConstructStatusMessage</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Starts all jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if job is disposed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="cf000185241e90d4" href="../../../R/cf000185241e90d4.html" target="n" data-glyph="72,1" class="i method">StartJob</a>()
        {
            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
            <a href="#3d45df6407964c6a" class="i field">s_structuredTracer</a>.<a href="../../../utils/tracing/TracingGen.cs.html#5addba948f69472f" class="i method">BeginContainerParentJobExecution</a>(<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>);
 
            <span class="c">// If parent contains no child jobs then this method will not respond.  Throw error in this case.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNoChildJobs</span>);
            }
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r55 rd" class="r55 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r55 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// If there is only one child job, call the synchronous method on the child to avoid use of another thread.</span>
            <span class="c">// If there are multiple, we can run them in parallel using the asynchronous versions.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 1)
            {
                <a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r56 rd" class="r56 r">child</span> = <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[0] <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r56 r">child</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
                <b>try</b>
                {
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Single child job synchronously, child InstanceId: {0}&quot;</span>, <span class="r56 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <span class="r56 r">child</span>.<a href="#89e2de1203c1ba7a" class="i method">StartJob</a>();
                    <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">WaitOne</span>();
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r57 rd" class="r57 r">e</span>)
                {
                    <span class="c">// These exceptions are thrown by third party code. Adding them here to the collection</span>
                    <span class="c">// of execution errors to present consistent behavior of the object.</span>
 
                    <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r57 r">e</span>, <span class="s">&quot;ContainerParentJobStartError&quot;</span>,
                                                       <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r56 r">child</span>));
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Single child job threw exception, child InstanceId: {0}&quot;</span>, <span class="r56 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r57 r">e</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
                <b>return</b>;
            }
 
            <b>var</b> <span id="r58 rd" class="r58 r">completed</span> = <b>new</b> <span class="i">AutoResetEvent</span>(<b>false</b>);
            <span class="c">// Count of StartJobCompleted events from children.</span>
            <b>var</b> <span id="r59 rd" class="r59 r">startedChildJobsCount</span> = 0;
            <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r60 rd" class="r60 r">eventHandler</span> = (<b>object</b> <span id="r61 rd" class="r61 r">sender</span>, <span class="i">AsyncCompletedEventArgs</span> <span id="r62 rd" class="r62 r">e</span>) =&gt;
            {
                <a href="#f76d5e2b49661689" class="k">var</a> <span id="r63 rd" class="r63 r">childJob</span> = <span class="r61 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r63 r">childJob</span> != <b>null</b>,
                           <span class="s">&quot;StartJobCompleted only available on Job2&quot;</span>);
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Finished starting child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r63 r">childJob</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <b>if</b> (<span class="r62 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                {
                    <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(<span class="r62 r">e</span>.<span class="i">Error</span>,
                                        <span class="s">&quot;ContainerParentJobStartError&quot;</span>,
                                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>,
                                        <span class="r63 r">childJob</span>));
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r63 r">childJob</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r62 r">e</span>.<span class="i">Error</span>);
                }
 
                <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r59 r">startedChildJobsCount</span>);
                <b>if</b> (<span class="r59 r">startedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                {
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Finished starting all child jobs asynchronously&quot;</span>, <b>null</b>);
                    <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">WaitOne</span>();
                    <span class="r58 r">completed</span>.<span class="i">Set</span>();
                }
            };
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r64 rd" class="r64 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r64 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r64 r">job</span>.<a href="#59209062bc2d85b7" class="i">StartJobCompleted</a> += <span class="r60 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r64 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
 
                <span class="c">// This child job is created to run synchronously and so can be debugged.  Set</span>
                <span class="c">// the IJobDebugger.IsAsync accordingly.</span>
                <a href="../../debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a>.<a href="../../debugger/debugger.cs.html#973f65579300ad50" class="i method">SetDebugJobAsync</a>(<span class="r64 r">job</span> <b>as</b> <a href="Job.cs.html#0a5020043aef4132" class="t t">IJobDebugger</a>, <b>false</b>);
                <span class="r64 r">job</span>.<a href="#eb40bb077f49c08c" class="i method">StartJobAsync</a>();
            }
 
            <span class="r58 r">completed</span>.<span class="i">WaitOne</span>();
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r65 rd" class="r65 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r65 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r65 r">job</span>.<a href="#59209062bc2d85b7" class="i">StartJobCompleted</a> -= <span class="r60 r">eventHandler</span>;
            }
 
            <span class="c">/*
            if (ExecutionError.Count &gt; 0)
            {
                // Check to see expected behavior if one child job fails to start.
            }
 
            if (ExecutionError.Count == 1)
            {
                throw ExecutionError[0];
            } */</span>
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
        }
 
        <b>private static readonly</b> <a href="../../../P/5b1d077d1aa35b55.html#5b1d077d1aa35b55" class="t t">Tracer</a> <a id="3d45df6407964c6a" href="../../../R/3d45df6407964c6a.html" target="n" data-glyph="46,1" class="i field">s_structuredTracer</a> = <b>new</b> <a href="../../../utils/tracing/TracingGen.cs.html#3e4070d535f42333" class="t constructor">Tracer</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Starts all child jobs asynchronously.</span>
        <span class="c">///</span><span class="c"> When all child jobs are started, StartJobCompleted event is raised.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="993ccb86de5bef4e" href="../../../R/993ccb86de5bef4e.html" target="n" data-glyph="72,1" class="i method">StartJobAsync</a>()
        {
            <b>if</b> (<a href="#a234cd03fceceef2" class="i field">_isDisposed</a> == <a href="#c2c248949db582c4" class="i field">DisposedTrue</a>)
            {
                <a href="#42e530851ffeacd0" class="i method">OnStartJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>new</b> <span class="i">ObjectDisposedException</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>), <b>false</b>, <b>null</b>));
                <b>return</b>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
            <a href="#3d45df6407964c6a" class="i field">s_structuredTracer</a>.<a href="../../../utils/tracing/TracingGen.cs.html#5addba948f69472f" class="i method">BeginContainerParentJobExecution</a>(<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r66 rd" class="r66 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r66 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// Count of StartJobCompleted events from children.</span>
            <b>var</b> <span id="r67 rd" class="r67 r">startedChildJobsCount</span> = 0;
            <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r68 rd" class="r68 r">eventHandler</span> = <b>null</b>;
            <span class="r68 r">eventHandler</span> = (<span id="r69 rd" class="r69 r">sender</span>, <span id="r70 rd" class="r70 r">e</span>) =&gt;
             {
                 <a href="#f76d5e2b49661689" class="k">var</a> <span id="r71 rd" class="r71 r">childJob</span> = <span class="r69 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                 <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r71 r">childJob</span> != <b>null</b>, <span class="s">&quot;StartJobCompleted only available on Job2&quot;</span>);
                 <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                     <span class="s">&quot;Finished starting child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r71 r">childJob</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                 <b>if</b> (<span class="r70 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                 {
                     <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r70 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobStartAsyncError&quot;</span>,
                         <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r71 r">childJob</span>));
                     <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r71 r">childJob</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                     <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r70 r">e</span>.<span class="i">Error</span>);
                 }
 
                 <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r67 r">startedChildJobsCount</span>);
                 <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r68 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
                 <span class="r71 r">childJob</span>.<a href="#59209062bc2d85b7" class="i">StartJobCompleted</a> -= <span class="r68 r">eventHandler</span>;
 
                 <b>if</b> (<span class="r67 r">startedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                 {
                     <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Finished starting all child jobs asynchronously&quot;</span>, <b>null</b>);
 
                     <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">WaitOne</span>();
                     <span class="c">// There may be multiple exceptions raised. They</span>
                     <span class="c">// are stored in the Error stream of this job object, which is otherwise</span>
                     <span class="c">// unused.</span>
                     <a href="#42e530851ffeacd0" class="i method">OnStartJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>null</b>, <b>false</b>, <b>null</b>));
                 }
             };
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r72 rd" class="r72 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r72 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
                <span class="r72 r">job</span>.<a href="#59209062bc2d85b7" class="i">StartJobCompleted</a> += <span class="r68 r">eventHandler</span>;
 
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r72 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <span class="r72 r">job</span>.<a href="#eb40bb077f49c08c" class="i method">StartJobAsync</a>();
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StartJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resume all jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if job is disposed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="a39221dca7892920" href="../../../R/a39221dca7892920.html" target="n" data-glyph="72,1" class="i method">ResumeJob</a>()
        {
            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
 
            <span class="c">// If parent contains no child jobs then this method will not respond.  Throw error in this case.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNoChildJobs</span>);
            }
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r73 rd" class="r73 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r73 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// If there is only one child job, call the synchronous method on the child to avoid use of another thread.</span>
            <span class="c">// If there are multiple, we can run them in parallel using the asynchronous versions.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 1)
            {
                <a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r74 rd" class="r74 r">child</span> = <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[0] <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r74 r">child</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
                <b>try</b>
                {
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Single child job synchronously, child InstanceId: {0}&quot;</span>, <span class="r74 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <span class="r74 r">child</span>.<a href="#a2b4cf4e386aaff5" class="i method">ResumeJob</a>();
                    <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">WaitOne</span>();
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r75 rd" class="r75 r">e</span>)
                {
                    <span class="c">// These exceptions are thrown by third party code. Adding them here to the collection</span>
                    <span class="c">// of execution errors to present consistent behavior of the object.</span>
 
                    <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r75 r">e</span>, <span class="s">&quot;ContainerParentJobResumeError&quot;</span>,
                                                       <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r74 r">child</span>));
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Single child job threw exception, child InstanceId: {0}&quot;</span>, <span class="r74 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r75 r">e</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
                <b>return</b>;
            }
 
            <b>var</b> <span id="r76 rd" class="r76 r">completed</span> = <b>new</b> <span class="i">AutoResetEvent</span>(<b>false</b>);
            <span class="c">// Count of ResumeJobCompleted events from children.</span>
            <b>var</b> <span id="r77 rd" class="r77 r">resumedChildJobsCount</span> = 0;
            <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r78 rd" class="r78 r">eventHandler</span> = <b>null</b>;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r79 rd" class="r79 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r79 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r78 r">eventHandler</span> = (<b>object</b> <span id="r80 rd" class="r80 r">sender</span>, <span class="i">AsyncCompletedEventArgs</span> <span id="r81 rd" class="r81 r">e</span>) =&gt;
                                            {
                                                <a href="#f76d5e2b49661689" class="k">var</a> <span id="r82 rd" class="r82 r">childJob</span> = <span class="r80 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                                                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r82 r">childJob</span> != <b>null</b>, <span class="s">&quot;ResumeJobCompleted only available on Job2&quot;</span>);
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                    <span class="s">&quot;Finished resuming child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r79 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                                <b>if</b> (<span class="r81 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                                                {
                                                    <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r81 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobResumeError&quot;</span>,
                                                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r79 r">job</span>));
                                                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                        <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r79 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r81 r">e</span>.<span class="i">Error</span>);
                                                }
 
                                                <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r77 r">resumedChildJobsCount</span>);
                                                <b>if</b> (<span class="r77 r">resumedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                                                {
                                                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                        <span class="s">&quot;Finished resuming all child jobs asynchronously&quot;</span>, <b>null</b>);
                                                    <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">WaitOne</span>();
                                                    <span class="r76 r">completed</span>.<span class="i">Set</span>();
                                                }
                                            };
                <span class="r79 r">job</span>.<a href="#dfe4fd4f7fcfbc16" class="i">ResumeJobCompleted</a> += <span class="r78 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r79 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <span class="r79 r">job</span>.<a href="#4e17ceeded154106" class="i method">ResumeJobAsync</a>();
            }
 
            <span class="r76 r">completed</span>.<span class="i">WaitOne</span>();
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r78 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r83 rd" class="r83 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r83 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r83 r">job</span>.<a href="#dfe4fd4f7fcfbc16" class="i">ResumeJobCompleted</a> -= <span class="r78 r">eventHandler</span>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
 
            <span class="c">// Errors are taken from the Error collection by the cmdlet for ContainerParentJob.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resume all jobs asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="1a5db921e8bcd8aa" href="../../../R/1a5db921e8bcd8aa.html" target="n" data-glyph="72,1" class="i method">ResumeJobAsync</a>()
        {
            <b>if</b> (<a href="#a234cd03fceceef2" class="i field">_isDisposed</a> == <a href="#c2c248949db582c4" class="i field">DisposedTrue</a>)
            {
                <a href="#019728ffc1dc7ba6" class="i method">OnResumeJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>new</b> <span class="i">ObjectDisposedException</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>), <b>false</b>, <b>null</b>));
                <b>return</b>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r84 rd" class="r84 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r84 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// Count of ResumeJobCompleted events from children.</span>
            <b>var</b> <span id="r85 rd" class="r85 r">resumedChildJobsCount</span> = 0;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r86 rd" class="r86 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r86 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r87 rd" class="r87 r">eventHandler</span> = <b>null</b>;
                <span class="r87 r">eventHandler</span> = (<span id="r88 rd" class="r88 r">sender</span>, <span id="r89 rd" class="r89 r">e</span>) =&gt;
                                        {
                                            <a href="#f76d5e2b49661689" class="k">var</a> <span id="r90 rd" class="r90 r">childJob</span> = <span class="r88 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                                            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r90 r">childJob</span> != <b>null</b>, <span class="s">&quot;ResumeJobCompleted only available on Job2&quot;</span>);
                                            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                <span class="s">&quot;Finished resuming child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r86 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                            <b>if</b> (<span class="r89 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                                            {
                                                <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r89 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobResumeAsyncError&quot;</span>,
                                                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r86 r">job</span>));
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                    <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r86 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r89 r">e</span>.<span class="i">Error</span>);
                                            }
 
                                            <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r85 r">resumedChildJobsCount</span>);
                                            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r87 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
                                            <span class="r90 r">childJob</span>.<a href="#dfe4fd4f7fcfbc16" class="i">ResumeJobCompleted</a> -= <span class="r87 r">eventHandler</span>;
                                            <b>if</b> (<span class="r85 r">resumedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                                            {
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                    <span class="s">&quot;Finished resuming all child jobs asynchronously&quot;</span>, <b>null</b>);
 
                                                <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">WaitOne</span>();
                                                <span class="c">// There may be multiple exceptions raised. They</span>
                                                <span class="c">// are stored in the Error stream of this job object, which is otherwise</span>
                                                <span class="c">// unused.</span>
                                                <a href="#019728ffc1dc7ba6" class="i method">OnResumeJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>null</b>, <b>false</b>, <b>null</b>));
                                            }
                                        };
                <span class="r86 r">job</span>.<a href="#dfe4fd4f7fcfbc16" class="i">ResumeJobCompleted</a> += <span class="r87 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r86 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <span class="r86 r">job</span>.<a href="#4e17ceeded154106" class="i method">ResumeJobAsync</a>();
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;ResumeJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Suspends all jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if job is disposed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="6d42aa34db3cd447" href="../../../R/6d42aa34db3cd447.html" target="n" data-glyph="72,1" class="i method">SuspendJob</a>()
        {
            <a href="#0d518825cefafd18" class="i method">SuspendJobInternal</a>(<b>null</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Suspends all jobs forcefully.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Force flag for suspending forcefully.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reason for doing forceful suspend.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="6d567fbbabe6c77c" href="../../../R/6d567fbbabe6c77c.html" target="n" data-glyph="72,1" class="i method">SuspendJob</a>(<b>bool</b> <span id="r91 rd" class="r91 r">force</span>, <b>string</b> <span id="r92 rd" class="r92 r">reason</span>)
        {
            <a href="#0d518825cefafd18" class="i method">SuspendJobInternal</a>(<span class="r91 r">force</span>, <span class="r92 r">reason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Suspends all jobs asynchronously.</span>
        <span class="c">///</span><span class="c"> When all jobs have been suspended, SuspendJobCompleted is raised.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="6e3f85cb64b9f503" href="../../../R/6e3f85cb64b9f503.html" target="n" data-glyph="72,1" class="i method">SuspendJobAsync</a>()
        {
            <a href="#32aef0d093f472dd" class="i method">SuspendJobAsyncInternal</a>(<b>null</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Suspends all jobs asynchronously with force flag.</span>
        <span class="c">///</span><span class="c"> When all jobs have been suspended, SuspendJobCompleted is raised.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Force flag for suspending forcefully.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reason for doing forceful suspend.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="7b0ed21e6c3712e5" href="../../../R/7b0ed21e6c3712e5.html" target="n" data-glyph="72,1" class="i method">SuspendJobAsync</a>(<b>bool</b> <span id="r93 rd" class="r93 r">force</span>, <b>string</b> <span id="r94 rd" class="r94 r">reason</span>)
        {
            <a href="#32aef0d093f472dd" class="i method">SuspendJobAsyncInternal</a>(<span class="r93 r">force</span>, <span class="r94 r">reason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop all child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="b71402a8eb248c67" href="../../../R/b71402a8eb248c67.html" target="n" data-glyph="72,1" class="i method">StopJob</a>()
        {
            <a href="#8789862d7b220cb3" class="i method">StopJobInternal</a>(<b>null</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops all child jobs asynchronously.</span>
        <span class="c">///</span><span class="c"> Once all child jobs are stopped, StopJobCompleted event is raised.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="335398613711de7e" href="../../../R/335398613711de7e.html" target="n" data-glyph="72,1" class="i method">StopJobAsync</a>()
        {
            <a href="#c1124c1ea1c51281" class="i method">StopJobAsyncInternal</a>(<b>null</b>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopJob.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="0863a749497eb96f" href="../../../R/0863a749497eb96f.html" target="n" data-glyph="72,1" class="i method">StopJob</a>(<b>bool</b> <span id="r95 rd" class="r95 r">force</span>, <b>string</b> <span id="r96 rd" class="r96 r">reason</span>)
        {
            <a href="#8789862d7b220cb3" class="i method">StopJobInternal</a>(<span class="r95 r">force</span>, <span class="r96 r">reason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopJobAsync.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="2de5c3d10d859e3c" href="../../../R/2de5c3d10d859e3c.html" target="n" data-glyph="72,1" class="i method">StopJobAsync</a>(<b>bool</b> <span id="r97 rd" class="r97 r">force</span>, <b>string</b> <span id="r98 rd" class="r98 r">reason</span>)
        {
            <a href="#c1124c1ea1c51281" class="i method">StopJobAsyncInternal</a>(<span class="r97 r">force</span>, <span class="r98 r">reason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unblock all child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ObjectDisposedException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if job is disposed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="893908cb94e2c7f7" href="../../../R/893908cb94e2c7f7.html" target="n" data-glyph="72,1" class="i method">UnblockJob</a>()
        {
            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
 
            <span class="c">// If parent contains no child jobs then this method will not respond.  Throw error in this case.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNoChildJobs</span>);
            }
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r99 rd" class="r99 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r99 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// If there is only one child job, call the synchronous method on the child to avoid use of another thread.</span>
            <span class="c">// If there are multiple, we can run them in parallel using the asynchronous versions.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 1)
            {
                <a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r100 rd" class="r100 r">child</span> = <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[0] <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r100 r">child</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
                <b>try</b>
                {
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Single child job synchronously, child InstanceId: {0}&quot;</span>, <span class="r100 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <span class="r100 r">child</span>.<a href="#be5db8ff5280357e" class="i method">UnblockJob</a>();
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r101 rd" class="r101 r">e</span>)
                {
                    <span class="c">// These exceptions are thrown by third party code. Adding them here to the collection</span>
                    <span class="c">// of execution errors to present consistent behavior of the object.</span>
 
                    <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r101 r">e</span>, <span class="s">&quot;ContainerParentJobUnblockError&quot;</span>,
                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r100 r">child</span>));
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Single child job threw exception, child InstanceId: {0}&quot;</span>, <span class="r100 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r101 r">e</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
                <b>return</b>;
            }
 
            <b>var</b> <span id="r102 rd" class="r102 r">completed</span> = <b>new</b> <span class="i">AutoResetEvent</span>(<b>false</b>);
            <span class="c">// count of UnblockJobCompleted events from children.</span>
            <b>int</b> <span id="r103 rd" class="r103 r">unblockedChildJobsCount</span> = 0;
            <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r104 rd" class="r104 r">eventHandler</span> = <b>null</b>;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r105 rd" class="r105 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r105 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r104 r">eventHandler</span> = (<b>object</b> <span id="r106 rd" class="r106 r">sender</span>, <span class="i">AsyncCompletedEventArgs</span> <span id="r107 rd" class="r107 r">e</span>) =&gt;
                                        {
                                            <a href="#f76d5e2b49661689" class="k">var</a> <span id="r108 rd" class="r108 r">childJob</span> = <span class="r106 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                                            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r108 r">childJob</span> != <b>null</b>, <span class="s">&quot;UnblockJobCompleted only available on Job2&quot;</span>);
                                            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                <span class="s">&quot;Finished unblock child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r105 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                            <b>if</b> (<span class="r107 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                                            {
                                                <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r107 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobUnblockError&quot;</span>,
                                                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r108 r">childJob</span>));
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                    <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r105 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r107 r">e</span>.<span class="i">Error</span>);
                                            }
 
                                            <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r103 r">unblockedChildJobsCount</span>);
                                            <b>if</b> (<span class="r103 r">unblockedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                                            {
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                    <span class="s">&quot;Finished unblock all child jobs asynchronously&quot;</span>, <b>null</b>);
                                                <span class="r102 r">completed</span>.<span class="i">Set</span>();
                                            }
                                        };
                <span class="r105 r">job</span>.<a href="#b99cf7aba317dbd3" class="i">UnblockJobCompleted</a> += <span class="r104 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r105 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <span class="r105 r">job</span>.<a href="#c15f310c3c8d7b6c" class="i method">UnblockJobAsync</a>();
            }
 
            <span class="r102 r">completed</span>.<span class="i">WaitOne</span>();
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r104 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r109 rd" class="r109 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r109 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r109 r">job</span>.<a href="#b99cf7aba317dbd3" class="i">UnblockJobCompleted</a> -= <span class="r104 r">eventHandler</span>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
 
            <span class="c">// Errors are taken from the Error collection by the cmdlet for ContainerParentJob.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unblock all child jobs asynchronously.</span>
        <span class="c">///</span><span class="c"> Once all child jobs are unblocked, UnblockJobCompleted event is raised.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="e8ed0bf759b7fe94" href="../../../R/e8ed0bf759b7fe94.html" target="n" data-glyph="72,1" class="i method">UnblockJobAsync</a>()
        {
            <b>if</b> (<a href="#a234cd03fceceef2" class="i field">_isDisposed</a> == <a href="#c2c248949db582c4" class="i field">DisposedTrue</a>)
            {
                <a href="#70ec56eb6acd9a04" class="i method">OnUnblockJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>new</b> <span class="i">ObjectDisposedException</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>), <b>false</b>, <b>null</b>));
                <b>return</b>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r110 rd" class="r110 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r110 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// count of UnblockJobCompleted events from children.</span>
            <b>int</b> <span id="r111 rd" class="r111 r">unblockedChildJobsCount</span> = 0;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r112 rd" class="r112 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r112 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r113 rd" class="r113 r">eventHandler</span> = <b>null</b>;
                <span class="r113 r">eventHandler</span> = (<span id="r114 rd" class="r114 r">sender</span>, <span id="r115 rd" class="r115 r">e</span>) =&gt;
                                        {
                                            <a href="#f76d5e2b49661689" class="k">var</a> <span id="r116 rd" class="r116 r">childJob</span> = <span class="r114 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                                            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r116 r">childJob</span> != <b>null</b>, <span class="s">&quot;UnblockJobCompleted only available on Job2&quot;</span>);
                                            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                <span class="s">&quot;Finished unblock child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r112 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                            <b>if</b> (<span class="r115 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                                            {
                                                <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r115 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobUnblockError&quot;</span>,
                                                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r116 r">childJob</span>));
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                    <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r112 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r115 r">e</span>.<span class="i">Error</span>);
                                            }
 
                                            <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r111 r">unblockedChildJobsCount</span>);
                                            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r113 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
                                            <span class="r116 r">childJob</span>.<a href="#b99cf7aba317dbd3" class="i">UnblockJobCompleted</a> -= <span class="r113 r">eventHandler</span>;
                                            <b>if</b> (<span class="r111 r">unblockedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                                            {
                                                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                                    <span class="s">&quot;Finished unblock all child jobs asynchronously&quot;</span>, <b>null</b>);
 
                                                <span class="c">// State change is handled elsewhere.</span>
                                                <span class="c">// There may be multiple exceptions raised. They</span>
                                                <span class="c">// are stored in the Error stream of this job object, which is otherwise</span>
                                                <span class="c">// unused.</span>
                                                <a href="#70ec56eb6acd9a04" class="i method">OnUnblockJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>null</b>, <b>false</b>, <b>null</b>));
                                            }
                                        };
                <span class="r112 r">job</span>.<a href="#b99cf7aba317dbd3" class="i">UnblockJobCompleted</a> += <span class="r113 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r112 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <span class="r112 r">job</span>.<a href="#c15f310c3c8d7b6c" class="i method">UnblockJobAsync</a>();
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;UnblockJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> finish logic
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal synchronous SuspendJob, calls appropriate version if Force is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="0d518825cefafd18" href="../../../R/0d518825cefafd18.html" target="n" data-glyph="76,1" class="i method">SuspendJobInternal</a>(<b>bool</b>? <span id="r117 rd" class="r117 r">force</span>, <b>string</b> <span id="r118 rd" class="r118 r">reason</span>)
        {
            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
 
            <span class="c">// If parent contains no child jobs then this method will not respond.  Throw error in this case.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNoChildJobs</span>);
            }
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r119 rd" class="r119 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r119 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// If there is only one child job, call the synchronous method on the child to avoid use of another thread.</span>
            <span class="c">// If there are multiple, we can run them in parallel using the asynchronous versions.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 1)
            {
                <a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r120 rd" class="r120 r">child</span> = <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[0] <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r120 r">child</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
                <b>try</b>
                {
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                         <span class="s">&quot;Single child job synchronously, child InstanceId: {0} force: {1}&quot;</span>, <span class="r120 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r117 r">force</span>.<span class="i">ToString</span>());
                    <b>if</b> (<span class="r117 r">force</span>.<span class="i">HasValue</span>)
                        <span class="r120 r">child</span>.<span class="i">SuspendJob</span>(<span class="r117 r">force</span>.<span class="i">Value</span>, <span class="r118 r">reason</span>);
                    <b>else</b>
                        <span class="r120 r">child</span>.<a href="#ed4c7d28ed795b8b" class="i method">SuspendJob</a>();
                    <a href="#b39295d7af9c1205" class="i property">JobSuspendedOrAborted</a>.<span class="i">WaitOne</span>();
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r121 rd" class="r121 r">e</span>)
                {
                    <span class="c">// These exceptions are thrown by third party code. Adding them here to the collection</span>
                    <span class="c">// of execution errors to present consistent behavior of the object.</span>
 
                    <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r121 r">e</span>, <span class="s">&quot;ContainerParentJobSuspendError&quot;</span>,
                                                       <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r120 r">child</span>));
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Single child job threw exception, child InstanceId: {0} force: {1}&quot;</span>, <span class="r120 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r117 r">force</span>.<span class="i">ToString</span>());
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r121 r">e</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
                <b>return</b>;
            }
 
            <span class="i">AutoResetEvent</span> <span id="r122 rd" class="r122 r">completed</span> = <b>new</b> <span class="i">AutoResetEvent</span>(<b>false</b>);
            <b>var</b> <span id="r123 rd" class="r123 r">suspendedChildJobsCount</span> = 0;
            <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r124 rd" class="r124 r">eventHandler</span> = <b>null</b>;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r125 rd" class="r125 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r125 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r124 r">eventHandler</span> = (<b>object</b> <span id="r126 rd" class="r126 r">sender</span>, <span class="i">AsyncCompletedEventArgs</span> <span id="r127 rd" class="r127 r">e</span>) =&gt;
                {
                    <a href="#f76d5e2b49661689" class="k">var</a> <span id="r128 rd" class="r128 r">childJob</span> = <span class="r126 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r128 r">childJob</span> != <b>null</b>,
                                <span class="s">&quot;SuspendJobCompleted only available on Job2&quot;</span>);
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Finished suspending child job asynchronously, child InstanceId: {0} force: {1}&quot;</span>, <span class="r125 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r117 r">force</span>.<span class="i">ToString</span>());
                    <b>if</b> (<span class="r127 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                    {
                        <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r127 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobSuspendError&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r125 r">job</span>));
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                            <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0} force: {1}&quot;</span>, <span class="r125 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r117 r">force</span>.<span class="i">ToString</span>());
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r127 r">e</span>.<span class="i">Error</span>);
                    }
 
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r123 r">suspendedChildJobsCount</span>);
                    <b>if</b> (<span class="r123 r">suspendedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                    {
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                            <span class="s">&quot;Finished suspending all child jobs asynchronously&quot;</span>, <b>null</b>);
                        <a href="#b39295d7af9c1205" class="i property">JobSuspendedOrAborted</a>.<span class="i">WaitOne</span>();
                        <span class="r122 r">completed</span>.<span class="i">Set</span>();
                    }
                };
                <span class="r125 r">job</span>.<a href="#478203a25ff210ad" class="i">SuspendJobCompleted</a> += <span class="r124 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0} force: {1}&quot;</span>, <span class="r125 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r117 r">force</span>.<span class="i">ToString</span>());
                <b>if</b> (<span class="r117 r">force</span>.<span class="i">HasValue</span>)
                    <span class="r125 r">job</span>.<span class="i">SuspendJobAsync</span>(<span class="r117 r">force</span>.<span class="i">Value</span>, <span class="r118 r">reason</span>);
                <b>else</b>
                    <span class="r125 r">job</span>.<a href="#9b4cbe910069df5f" class="i method">SuspendJobAsync</a>();
            }
 
            <span class="r122 r">completed</span>.<span class="i">WaitOne</span>();
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r124 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r129 rd" class="r129 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r129 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r129 r">job</span>.<a href="#478203a25ff210ad" class="i">SuspendJobCompleted</a> -= <span class="r124 r">eventHandler</span>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
 
            <span class="c">// Errors are taken from the Error collection by the cmdlet for ContainerParentJob.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal SuspendJobAsync. Calls appropriate method if Force is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="32aef0d093f472dd" href="../../../R/32aef0d093f472dd.html" target="n" data-glyph="76,1" class="i method">SuspendJobAsyncInternal</a>(<b>bool</b>? <span id="r130 rd" class="r130 r">force</span>, <b>string</b> <span id="r131 rd" class="r131 r">reason</span>)
        {
            <b>if</b> (<a href="#a234cd03fceceef2" class="i field">_isDisposed</a> == <a href="#c2c248949db582c4" class="i field">DisposedTrue</a>)
            {
                <a href="#fb44555e56d92103" class="i method">OnSuspendJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>new</b> <span class="i">ObjectDisposedException</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>), <b>false</b>, <b>null</b>));
                <b>return</b>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r132 rd" class="r132 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r132 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// Count of SuspendJobCompleted events from children.</span>
            <b>var</b> <span id="r133 rd" class="r133 r">suspendedChildJobsCount</span> = 0;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r134 rd" class="r134 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r134 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r135 rd" class="r135 r">eventHandler</span> = <b>null</b>;
                <span class="r135 r">eventHandler</span> = (<span id="r136 rd" class="r136 r">sender</span>, <span id="r137 rd" class="r137 r">e</span>) =&gt;
                {
                    <a href="#f76d5e2b49661689" class="k">var</a> <span id="r138 rd" class="r138 r">childJob</span> = <span class="r136 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r138 r">childJob</span> != <b>null</b>, <span class="s">&quot;SuspendJobCompleted only available on Job2&quot;</span>);
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Finished suspending child job asynchronously, child InstanceId: {0} force: {1}&quot;</span>, <span class="r134 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r130 r">force</span>.<span class="i">ToString</span>());
                    <b>if</b> (<span class="r137 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                    {
                        <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r137 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobSuspendAsyncError&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r134 r">job</span>));
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                            <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0} force: {1}&quot;</span>, <span class="r134 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r130 r">force</span>.<span class="i">ToString</span>());
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r137 r">e</span>.<span class="i">Error</span>);
                    }
 
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r133 r">suspendedChildJobsCount</span>);
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r135 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
                    <span class="r138 r">childJob</span>.<a href="#478203a25ff210ad" class="i">SuspendJobCompleted</a> -= <span class="r135 r">eventHandler</span>;
                    <b>if</b> (<span class="r133 r">suspendedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                    {
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                <span class="s">&quot;Finished suspending all child jobs asynchronously&quot;</span>, <b>null</b>);
 
                        <a href="#b39295d7af9c1205" class="i property">JobSuspendedOrAborted</a>.<span class="i">WaitOne</span>();
                        <span class="c">// There may be multiple exceptions raised. They</span>
                        <span class="c">// are stored in the Error stream of this job object, which is otherwise</span>
                        <span class="c">// unused.</span>
                        <a href="#fb44555e56d92103" class="i method">OnSuspendJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>null</b>, <b>false</b>, <b>null</b>));
                    }
                };
                <span class="r134 r">job</span>.<a href="#478203a25ff210ad" class="i">SuspendJobCompleted</a> += <span class="r135 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0} force: {1}&quot;</span>, <span class="r134 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>(), <span class="r130 r">force</span>.<span class="i">ToString</span>());
                <b>if</b> (<span class="r130 r">force</span>.<span class="i">HasValue</span>)
                    <span class="r134 r">job</span>.<span class="i">SuspendJobAsync</span>(<span class="r130 r">force</span>.<span class="i">Value</span>, <span class="r131 r">reason</span>);
                <b>else</b>
                    <span class="r134 r">job</span>.<a href="#9b4cbe910069df5f" class="i method">SuspendJobAsync</a>();
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;SuspendJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopJob.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8789862d7b220cb3" href="../../../R/8789862d7b220cb3.html" target="n" data-glyph="76,1" class="i method">StopJobInternal</a>(<b>bool</b>? <span id="r139 rd" class="r139 r">force</span>, <b>string</b> <span id="r140 rd" class="r140 r">reason</span>)
        {
            <a href="Job.cs.html#0328c940aee2761d" class="i method">AssertNotDisposed</a>();
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
 
            <span class="c">// If parent contains no child jobs then this method will not respond.  Throw error in this case.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 0)
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNoChildJobs</span>);
            }
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r141 rd" class="r141 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r141 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// If there is only one child job, call the synchronous method on the child to avoid use of another thread.</span>
            <span class="c">// If there are multiple, we can run them in parallel using the asynchronous versions.</span>
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 1)
            {
                <a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r142 rd" class="r142 r">child</span> = <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[0] <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r142 r">child</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
                <b>try</b>
                {
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                         <span class="s">&quot;Single child job synchronously, child InstanceId: {0}&quot;</span>, <span class="r142 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <b>if</b> (<span class="r139 r">force</span>.<span class="i">HasValue</span>)
                        <span class="r142 r">child</span>.<span class="i">StopJob</span>(<span class="r139 r">force</span>.<span class="i">Value</span>, <span class="r140 r">reason</span>);
                    <b>else</b>
                        <span class="r142 r">child</span>.<a href="Job.cs.html#5e60404c217f5d42" class="i method">StopJob</a>();
                    <a href="Job.cs.html#b1600ff0c937953b" class="i property">Finished</a>.<span class="i">WaitOne</span>();
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r143 rd" class="r143 r">e</span>)
                {
                    <span class="c">// These exceptions are thrown by third party code. Adding them here to the collection</span>
                    <span class="c">// of execution errors to present consistent behavior of the object.</span>
 
                    <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r143 r">e</span>, <span class="s">&quot;ContainerParentJobStopError&quot;</span>,
                                                       <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r142 r">child</span>));
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                        <span class="s">&quot;Single child job threw exception, child InstanceId: {0}&quot;</span>, <span class="r142 r">child</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#ef79d5730aacde4f" class="i method">TraceException</a>(<span class="r143 r">e</span>);
                }
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
                <b>return</b>;
            }
 
            <span class="i">AutoResetEvent</span> <span id="r144 rd" class="r144 r">completed</span> = <b>new</b> <span class="i">AutoResetEvent</span>(<b>false</b>);
            <span class="c">// Count of StopJobCompleted events from children.</span>
            <b>var</b> <span id="r145 rd" class="r145 r">stoppedChildJobsCount</span> = 0;
            <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r146 rd" class="r146 r">eventHandler</span> = <b>null</b>;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r147 rd" class="r147 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r147 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r146 r">eventHandler</span> = (<b>object</b> <span id="r148 rd" class="r148 r">sender</span>, <span class="i">AsyncCompletedEventArgs</span> <span id="r149 rd" class="r149 r">e</span>) =&gt;
                {
                    <a href="#f76d5e2b49661689" class="k">var</a> <span id="r150 rd" class="r150 r">childJob</span> = <span class="r148 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r150 r">childJob</span> != <b>null</b>,
                                <span class="s">&quot;StopJobCompleted only available on Job2&quot;</span>);
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Finished stopping child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r147 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <b>if</b> (<span class="r149 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                    {
                        <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r149 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobStopError&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r147 r">job</span>));
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                            <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r147 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r149 r">e</span>.<span class="i">Error</span>);
                    }
 
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r145 r">stoppedChildJobsCount</span>);
                    <b>if</b> (<span class="r145 r">stoppedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                    {
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Finished stopping all child jobs asynchronously&quot;</span>, <b>null</b>);
                        <a href="Job.cs.html#b1600ff0c937953b" class="i property">Finished</a>.<span class="i">WaitOne</span>();
                        <span class="r144 r">completed</span>.<span class="i">Set</span>();
                    }
                };
                <span class="r147 r">job</span>.<a href="#0462f78c49dda28a" class="i">StopJobCompleted</a> += <span class="r146 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                     <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r147 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <b>if</b> (<span class="r139 r">force</span>.<span class="i">HasValue</span>)
                    <span class="r147 r">job</span>.<span class="i">StopJobAsync</span>(<span class="r139 r">force</span>.<span class="i">Value</span>, <span class="r140 r">reason</span>);
                <b>else</b>
                    <span class="r147 r">job</span>.<a href="#17da884baa3fadf4" class="i method">StopJobAsync</a>();
            }
 
            <span class="r144 r">completed</span>.<span class="i">WaitOne</span>();
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r146 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r151 rd" class="r151 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r151 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="r151 r">job</span>.<a href="#0462f78c49dda28a" class="i">StopJobCompleted</a> -= <span class="r146 r">eventHandler</span>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJob&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
 
            <span class="c">// Errors are taken from the Error collection by the cmdlet for ContainerParentJob.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopJobAsync.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">reason</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="c1124c1ea1c51281" href="../../../R/c1124c1ea1c51281.html" target="n" data-glyph="76,1" class="i method">StopJobAsyncInternal</a>(<b>bool</b>? <span id="r152 rd" class="r152 r">force</span>, <b>string</b> <span id="r153 rd" class="r153 r">reason</span>)
        {
            <b>if</b> (<a href="#a234cd03fceceef2" class="i field">_isDisposed</a> == <a href="#c2c248949db582c4" class="i field">DisposedTrue</a>)
            {
                <a href="#ae09405383e21cf0" class="i method">OnStopJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>new</b> <span class="i">ObjectDisposedException</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>), <b>false</b>, <b>null</b>));
                <b>return</b>;
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Entering method&quot;</span>, <b>null</b>);
 
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r154 rd" class="r154 r">job</span> <b>in</b> <a href="#bb6daa5ca3253eb3" class="k">this</a>.<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <b>if</b> (<span class="r154 r">job</span> == <b>null</b>) <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">JobActionInvalidWithNullChild</span>);
            }
 
            <span class="c">// count of StopJobCompleted events from children.</span>
            <b>int</b> <span id="r155 rd" class="r155 r">stoppedChildJobsCount</span> = 0;
            <b>foreach</b> (<a href="#f76d5e2b49661689" class="t t">Job2</a> <span id="r156 rd" class="r156 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r156 r">job</span> != <b>null</b>, <span class="s">&quot;Job is null after initial null check&quot;</span>);
 
                <span class="i">EventHandler</span>&lt;<span class="i">AsyncCompletedEventArgs</span>&gt; <span id="r157 rd" class="r157 r">eventHandler</span> = <b>null</b>;
                <span class="r157 r">eventHandler</span> = (<span id="r158 rd" class="r158 r">sender</span>, <span id="r159 rd" class="r159 r">e</span>) =&gt;
                {
                    <a href="#f76d5e2b49661689" class="k">var</a> <span id="r160 rd" class="r160 r">childJob</span> = <span class="r158 r">sender</span> <b>as</b> <a href="#f76d5e2b49661689" class="t t">Job2</a>;
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r160 r">childJob</span> != <b>null</b>, <span class="s">&quot;StopJobCompleted only available on Job2&quot;</span>);
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                        <span class="s">&quot;Finished stopping child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r156 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                    <b>if</b> (<span class="r159 r">e</span>.<span class="i">Error</span> != <b>null</b>)
                    {
                        <a href="#b1aeaf44b6b22003" class="i property">ExecutionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r159 r">e</span>.<span class="i">Error</span>, <span class="s">&quot;ContainerParentJobStopAsyncError&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#f33f25c3453e2e98" class="i field">InvalidResult</a>, <span class="r160 r">childJob</span>));
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                            <span class="s">&quot;Child job asynchronously had error, child InstanceId: {0}&quot;</span>, <span class="r156 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">TraceException</span>(<span class="r159 r">e</span>.<span class="i">Error</span>);
                    }
 
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r155 r">stoppedChildJobsCount</span>);
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r157 r">eventHandler</span> != <b>null</b>, <span class="s">&quot;Event handler magically disappeared&quot;</span>);
                    <span class="r160 r">childJob</span>.<a href="#0462f78c49dda28a" class="i">StopJobCompleted</a> -= <span class="r157 r">eventHandler</span>;
                    <b>if</b> (<span class="r155 r">stoppedChildJobsCount</span> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                    {
                        <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJobAsync-Handler&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                <span class="s">&quot;Finished stopping all child jobs asynchronously&quot;</span>, <b>null</b>);
 
                        <a href="Job.cs.html#b1600ff0c937953b" class="i property">Finished</a>.<span class="i">WaitOne</span>();
                        <span class="c">// There may be multiple exceptions raised. They</span>
                        <span class="c">// are stored in the Error stream of this job object, which is otherwise</span>
                        <span class="c">// unused.</span>
                        <a href="#ae09405383e21cf0" class="i method">OnStopJobCompleted</a>(<b>new</b> <span class="i">AsyncCompletedEventArgs</span>(<b>null</b>, <b>false</b>, <b>null</b>));
                    }
                };
                <span class="r156 r">job</span>.<a href="#0462f78c49dda28a" class="i">StopJobCompleted</a> += <span class="r157 r">eventHandler</span>;
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                    <span class="s">&quot;Child job asynchronously, child InstanceId: {0}&quot;</span>, <span class="r156 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>.<span class="i">ToString</span>());
                <b>if</b> (<span class="r152 r">force</span>.<span class="i">HasValue</span>)
                    <span class="r156 r">job</span>.<span class="i">StopJobAsync</span>(<span class="r152 r">force</span>.<span class="i">Value</span>, <span class="r153 r">reason</span>);
                <b>else</b>
                    <span class="r156 r">job</span>.<a href="#17da884baa3fadf4" class="i method">StopJobAsync</a>();
            }
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;StopJobAsync&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>, <span class="s">&quot;Exiting method&quot;</span>, <b>null</b>);
        }
 
        <b>private void</b> <a id="1469651b77f40d38" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleMyStateChanged</a>(<b>object</b> <span id="r161 rd" class="r161 r">sender</span>, <a href="Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r162 rd" class="r162 r">e</span>)
        {
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<a href="#53760dcd989ece54" class="i field">TraceClassName</a>, <span class="s">&quot;HandleMyStateChanged&quot;</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <a href="#bb6daa5ca3253eb3" class="k">this</a>,
                                 <span class="s">&quot;NewState: {0}; OldState: {1}&quot;</span>, <span class="r162 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a>.<span class="i">ToString</span>(),
                                 <span class="r162 r">e</span>.<a href="Job.cs.html#6302f233913a7ce2" class="i property">PreviousJobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a>.<span class="i">ToString</span>());
 
            <b>switch</b> (<span class="r162 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a>)
            {
                <b>case</b> <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#8b3e2b923f5b0e5d" class="i field">Running</a>:
                    {
                        <b>lock</b> (<a href="#8106b14c4c26d8f4" class="i field">_syncObject</a>)
                        {
                            <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">Set</span>();
 
                            <span class="c">// Do not create the event if it doesn&#39;t already exist. Suspend may never be called.</span>
                            <b>if</b> (<a href="#e669a766303f6b2b" class="i field">_jobSuspendedOrAborted</a> != <b>null</b>)
                                <a href="#b39295d7af9c1205" class="i property">JobSuspendedOrAborted</a>.<span class="i">Reset</span>();
                        }
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#2da89c5a929a8381" class="i field">Suspended</a>:
                    {
                        <b>lock</b> (<a href="#8106b14c4c26d8f4" class="i field">_syncObject</a>)
                        {
                            <a href="#b39295d7af9c1205" class="i property">JobSuspendedOrAborted</a>.<span class="i">Set</span>();
                            <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">Reset</span>();
                        }
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#4d2acd22ba4f0da9" class="i field">Failed</a>:
                <b>case</b> <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#db36b340edc064ae" class="i field">Completed</a>:
                <b>case</b> <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#223c91574b18631a" class="i field">Stopped</a>:
                    {
                        <b>lock</b> (<a href="#8106b14c4c26d8f4" class="i field">_syncObject</a>)
                        {
                            <a href="#b39295d7af9c1205" class="i property">JobSuspendedOrAborted</a>.<span class="i">Set</span>();
 
                            <span class="c">// Do not reset JobRunning when the state is terminal.</span>
                            <span class="c">// No thread should wait on a job transitioning again to</span>
                            <span class="c">// JobState.Running.</span>
                            <a href="#15a7c274c74a785d" class="i property">JobRunning</a>.<span class="i">Set</span>();
                        }
                    }
 
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles the StateChanged event from each of the child job objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r163 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r164 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="6a1a8dd878e565c4" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleChildJobStateChanged</a>(<b>object</b> <span id="r163 rd" class="r163 r">sender</span>, <a href="Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r164 rd" class="r164 r">e</span>)
        {
            <a href="#15b3ab7c091fd57b" class="i method">ParentJobStateCalculation</a>(<span class="r164 r">e</span>);
        }
 
        <b>private void</b> <a id="15b3ab7c091fd57b" href="../../../R/15b3ab7c091fd57b.html" target="n" data-glyph="76,1" class="i method">ParentJobStateCalculation</a>(<a href="Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r165 rd" class="r165 r">e</span>)
        {
            <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r166 rd" class="r166 r">computedState</span>;
            <b>if</b> (<span class="i">ComputeJobStateFromChildJobStates</span>(<span class="s">&quot;ContainerParentJob&quot;</span>, <span class="r165 r">e</span>, <b>ref</b> <a href="#6431dabf7e89a94b" class="i field">_blockedChildJobsCount</a>, <b>ref</b> <a href="#0cc53d11a5256422" class="i field">_suspendedChildJobsCount</a>, <b>ref</b> <a href="#30d5c997b151eb97" class="i field">_suspendingChildJobsCount</a>,
                    <b>ref</b> <a href="#97339ee1c252c116" class="i field">_finishedChildJobsCount</a>, <b>ref</b> <a href="#1669d8fee7bd7364" class="i field">_failedChildJobsCount</a>, <b>ref</b> <a href="#f5e3bb69d7f6ed1c" class="i field">_stoppedChildJobsCount</a>, <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>, <b>out</b> <span class="r166 r">computedState</span>))
            {
                <b>if</b> (<span class="r166 r">computedState</span> != <a href="Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a>)
                {
                    <b>if</b> (<a href="Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#1213da49468b8ccd" class="i field">NotStarted</a> &amp;&amp; <span class="r166 r">computedState</span> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#8b3e2b923f5b0e5d" class="i field">Running</a>)
                    {
                        <a href="Job.cs.html#7ed5cb1dfd270632" class="i property">PSBeginTime</a> = <span class="i">DateTime</span>.<span class="i">Now</span>;
                    }
 
                    <b>if</b> (!<a href="Job.cs.html#d7179d2607549d3b" class="i method">IsFinishedState</a>(<a href="Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a>) &amp;&amp; <a href="Job.cs.html#431bfb528e72aa9f" class="i method">IsPersistentState</a>(<span class="r166 r">computedState</span>))
                    {
                        <a href="Job.cs.html#b4585c98af5cbea6" class="i property">PSEndTime</a> = <span class="i">DateTime</span>.<span class="i">Now</span>;
                    }
 
                    <a href="Job.cs.html#2bd9d7abde5f33f7" class="i method">SetJobState</a>(<span class="r166 r">computedState</span>);
                }
 
                <b>if</b> (<a href="#97339ee1c252c116" class="i field">_finishedChildJobsCount</a> == <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>)
                {
                    <a href="#3d45df6407964c6a" class="i field">s_structuredTracer</a>.<a href="../../../utils/tracing/TracingGen.cs.html#23e6ede27e3a4bc6" class="i method">EndContainerParentJobExecution</a>(<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles the StateChanged event from each of the child job objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r167 r">traceClassName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r168 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">blockedChildJobsCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r">suspendedChildJobsCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">suspendingChildJobsCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r172 r">finishedChildJobsCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r173 r">stoppedChildJobsCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r174 r">childJobsCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r175 r">computedJobState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r176 r">failedChildJobsCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the job state needs to be modified, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="d6e32e251ff22495" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ComputeJobStateFromChildJobStates</a>(<b>string</b> <span id="r167 rd" class="r167 r">traceClassName</span>, <a href="Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r168 rd" class="r168 r">e</span>,
            <b>ref int</b> <span id="r169 rd" class="r169 r">blockedChildJobsCount</span>, <b>ref int</b> <span id="r170 rd" class="r170 r">suspendedChildJobsCount</span>, <b>ref int</b> <span id="r171 rd" class="r171 r">suspendingChildJobsCount</span>, <b>ref int</b> <span id="r172 rd" class="r172 r">finishedChildJobsCount</span>,
                <b>ref int</b> <span id="r176 rd" class="r176 r">failedChildJobsCount</span>, <b>ref int</b> <span id="r173 rd" class="r173 r">stoppedChildJobsCount</span>, <b>int</b> <span id="r174 rd" class="r174 r">childJobsCount</span>,
                    <b>out</b> <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r175 rd" class="r175 r">computedJobState</span>)
        {
            <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#1213da49468b8ccd" class="i field">NotStarted</a>;
 
            <b>using</b> (<a href="../../../utils/PowerShellETWTracer.cs.html#3fd13a01d0177ce2" class="t t">PowerShellTraceSource</a> <span id="r177 rd" class="r177 r">tracer</span> = <a href="../../../utils/PowerShellETWTracer.cs.html#37e484a307a595c3" class="t t">PowerShellTraceSourceFactory</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#c94a9fbfef99a75d" class="i method">GetTraceSource</a>())
            {
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#d73e45c1ea393a18" class="i field">Blocked</a>)
                {
                    <span class="c">// increment count of blocked child jobs</span>
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r169 r">blockedChildJobsCount</span>);
 
                    <span class="c">// if any of the child job is blocked, we set state to blocked</span>
                    <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is Blocked, at least one child job is blocked.&quot;</span>);
                    <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#d73e45c1ea393a18" class="i field">Blocked</a>;
                    <b>return</b> <b>true</b>;
                }
 
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#6302f233913a7ce2" class="i property">PreviousJobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#d73e45c1ea393a18" class="i field">Blocked</a>)
                {
                    <span class="c">// check if any of the child jobs were unblocked</span>
                    <span class="c">// in which case we need to check if the parent</span>
                    <span class="c">// job needs to be unblocked as well</span>
                    <span class="i">Interlocked</span>.<span class="i">Decrement</span>(<b>ref</b> <span class="r169 r">blockedChildJobsCount</span>);
 
                    <b>if</b> (<span class="r169 r">blockedChildJobsCount</span> == 0)
                    {
                        <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is unblocked, all child jobs are unblocked.&quot;</span>);
                        <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#8b3e2b923f5b0e5d" class="i field">Running</a>;
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>return</b> <b>false</b>;
                }
 
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#6302f233913a7ce2" class="i property">PreviousJobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#2da89c5a929a8381" class="i field">Suspended</a>)
                {
                    <span class="c">// decrement count of suspended child jobs</span>
                    <span class="c">// needed to determine when all incomplete child jobs are suspended for parent job state.</span>
                    <span class="i">Interlocked</span>.<span class="i">Decrement</span>(<b>ref</b> <span class="r170 r">suspendedChildJobsCount</span>);
                }
 
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#6302f233913a7ce2" class="i property">PreviousJobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#1340456ba13acdcb" class="i field">Suspending</a>)
                {
                    <span class="c">// decrement count of suspending child jobs</span>
                    <span class="c">// needed to determine when all incomplete child jobs are suspended for parent job state.</span>
                    <span class="i">Interlocked</span>.<span class="i">Decrement</span>(<b>ref</b> <span class="r171 r">suspendingChildJobsCount</span>);
                }
 
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#2da89c5a929a8381" class="i field">Suspended</a>)
                {
                    <span class="c">// increment count of suspended child jobs.</span>
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r170 r">suspendedChildJobsCount</span>);
 
                    <span class="c">// We know that at least one child is suspended. If all jobs are either complete or suspended, set the state.</span>
                    <b>if</b> (<span class="r170 r">suspendedChildJobsCount</span> + <span class="r172 r">finishedChildJobsCount</span> == <span class="r174 r">childJobsCount</span>)
                    {
                        <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is suspended, all child jobs are suspended.&quot;</span>);
                        <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#2da89c5a929a8381" class="i field">Suspended</a>;
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="c">// Job state should continue to be running unless:</span>
                    <span class="c">// at least one child is suspended</span>
                    <span class="c">// AND</span>
                    <span class="c">// all child jobs are either suspended or finished.</span>
                    <b>return</b> <b>false</b>;
                }
 
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#1340456ba13acdcb" class="i field">Suspending</a>)
                {
                    <span class="c">// increment count of suspending child jobs.</span>
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r171 r">suspendingChildJobsCount</span>);
 
                    <span class="c">// We know that at least one child is suspended. If all jobs are either complete or suspended, set the state.</span>
                    <b>if</b> (<span class="r170 r">suspendedChildJobsCount</span> + <span class="r172 r">finishedChildJobsCount</span> + <span class="r171 r">suspendingChildJobsCount</span> == <span class="r174 r">childJobsCount</span>)
                    {
                        <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is suspending, all child jobs are in suspending state.&quot;</span>);
                        <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#1340456ba13acdcb" class="i field">Suspending</a>;
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="c">// Job state should continue to be running unless:</span>
                    <span class="c">// at least one child is suspended, suspending</span>
                    <span class="c">// AND</span>
                    <span class="c">// all child jobs are either suspended or finished.</span>
                    <b>return</b> <b>false</b>;
                }
 
                <span class="c">// Ignore state changes which are not resulting in state change to finished.</span>
                <span class="c">// State will be Running once at least one child is running.</span>
                <b>if</b> ((<span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> != <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#db36b340edc064ae" class="i field">Completed</a> &amp;&amp; <span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> != <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#4d2acd22ba4f0da9" class="i field">Failed</a>) &amp;&amp; <span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> != <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#223c91574b18631a" class="i field">Stopped</a>)
                {
                    <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#8b3e2b923f5b0e5d" class="i field">Running</a>)
                    {
                        <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#8b3e2b923f5b0e5d" class="i field">Running</a>;
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="c">// if the job state is Suspended, we have already returned.</span>
                    <span class="c">// if the job state is NotStarted, do not set the state.</span>
                    <span class="c">// if the job state is blocked, we have already returned.</span>
                    <b>return</b> <b>false</b>;
                }
 
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#4d2acd22ba4f0da9" class="i field">Failed</a>)
                {
                    <span class="c">// If any of the child job failed, we set status to failed</span>
                    <span class="c">// we can set it right now and</span>
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r176 r">failedChildJobsCount</span>);
                }
 
                <span class="c">// If stop has not been called, but a child has been stopped, the parent should</span>
                <span class="c">// reflect the stopped state.</span>
                <b>if</b> (<span class="r168 r">e</span>.<a href="Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#223c91574b18631a" class="i field">Stopped</a>)
                {
                    <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r173 r">stoppedChildJobsCount</span>);
                }
 
                <b>bool</b> <span id="r178 rd" class="r178 r">allChildJobsFinished</span> = <b>false</b>;
 
                <b>int</b> <span id="r179 rd" class="r179 r">finishedChildJobsCountNew</span> = <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <span class="r172 r">finishedChildJobsCount</span>);
 
                <span class="c">// We are done</span>
                <b>if</b> (<span class="r179 r">finishedChildJobsCountNew</span> == <span class="r174 r">childJobsCount</span>)
                {
                    <span class="r178 r">allChildJobsFinished</span> = <b>true</b>;
                }
 
                <b>if</b> (<span class="r178 r">allChildJobsFinished</span>)
                {
                    <span class="c">// if any child job failed, set status to failed</span>
                    <span class="c">// If stop was called set, status to stopped</span>
                    <span class="c">// else completed);</span>
                    <b>if</b> (<span class="r176 r">failedChildJobsCount</span> &gt; 0)
                    {
                        <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is failed, at least one child job failed.&quot;</span>);
                        <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#4d2acd22ba4f0da9" class="i field">Failed</a>;
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r173 r">stoppedChildJobsCount</span> &gt; 0)
                    {
                        <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is stopped, stop is called.&quot;</span>);
                        <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#223c91574b18631a" class="i field">Stopped</a>;
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is completed.&quot;</span>);
                    <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#db36b340edc064ae" class="i field">Completed</a>;
                    <b>return</b> <b>true</b>;
                }
 
                <span class="c">// If not all jobs are finished, one child job may be suspended, even though this job did not finish.</span>
                <span class="c">// At this point, we know finishedChildJobsCountNew != childJobsCount</span>
                <b>if</b> (<span class="r170 r">suspendedChildJobsCount</span> + <span class="r179 r">finishedChildJobsCountNew</span> == <span class="r174 r">childJobsCount</span>)
                {
                    <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is suspended, all child jobs are suspended.&quot;</span>);
                    <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#2da89c5a929a8381" class="i field">Suspended</a>;
                    <b>return</b> <b>true</b>;
                }
 
                <span class="c">// If not all jobs are finished, one child job may be suspending, even though this job did not finish.</span>
                <span class="c">// At this point, we know finishedChildJobsCountNew != childJobsCount and finishChildJobsCount + suspendedChilJobsCout != childJobsCount</span>
                <b>if</b> (<span class="r171 r">suspendingChildJobsCount</span> + <span class="r170 r">suspendedChildJobsCount</span> + <span class="r179 r">finishedChildJobsCountNew</span> == <span class="r174 r">childJobsCount</span>)
                {
                    <span class="r177 r">tracer</span>.<a href="../../../utils/PowerShellETWTracer.cs.html#4c014549d43b287e" class="i method">WriteMessage</a>(<span class="r167 r">traceClassName</span>, <span class="s">&quot;: JobState is suspending, all child jobs are in suspending state.&quot;</span>);
                    <span class="r175 r">computedJobState</span> = <a href="Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="Job.cs.html#1340456ba13acdcb" class="i field">Suspending</a>;
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> finish logic
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Release all the resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r180 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if true, release all the managed objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="19dcc992f091f7be" href="../../../R/19dcc992f091f7be.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r180 rd" class="r180 r">disposing</span>)
        {
            <b>if</b> (!<span class="r180 r">disposing</span>) <b>return</b>;
            <b>if</b> (<span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#a234cd03fceceef2" class="i field">_isDisposed</a>, <a href="#c2c248949db582c4" class="i field">DisposedTrue</a>, <a href="#e3768dce5942ee6c" class="i field">DisposedFalse</a>) == <a href="#c2c248949db582c4" class="i field">DisposedTrue</a>) <b>return</b>;
 
            <b>try</b>
            {
                <a href="#1cdcc08cc8c84344" class="i method">UnregisterAllJobEvents</a>();
                <a href="#2a42dcaf70597da5" class="i field">_executionError</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
                <a href="Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> -= <span class="i">HandleMyStateChanged</span>;
 
                <b>foreach</b> (<a href="Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r181 rd" class="r181 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
                {
                    <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<span class="i">WriteMessage</span>(<span class="s">&quot;Disposing child job with id : &quot;</span> + <span class="r181 r">job</span>.<a href="Job.cs.html#aa91c39ac1b0bcec" class="i property">Id</a>);
                    <span class="r181 r">job</span>.<a href="Job.cs.html#a1b7a0cd2d734ade" class="i method">Dispose</a>();
                }
 
                <b>if</b> (<a href="#b1b91ee0fa29983e" class="i field">_jobRunning</a> != <b>null</b>)
                    <a href="#b1b91ee0fa29983e" class="i field">_jobRunning</a>.<span class="i">Dispose</span>();
 
                <b>if</b> (<a href="#e669a766303f6b2b" class="i field">_jobSuspendedOrAborted</a> != <b>null</b>)
                    <a href="#e669a766303f6b2b" class="i field">_jobSuspendedOrAborted</a>.<span class="i">Dispose</span>();
            }
            <b>finally</b>
            {
                <a href="#f76d5e2b49661689" class="k">base</a>.<a href="Job.cs.html#19b362abde0789e5" class="i method">Dispose</a>(<b>true</b>);
            }
        }
 
        <b>private string</b> <a id="de5cf04987f9450f" href="../../../R/de5cf04987f9450f.html" target="n" data-glyph="76,1" class="i method">ConstructLocation</a>()
        {
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a> == <b>null</b> || <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 0)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r182 rd" class="r182 r">location</span> = <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Select</span>(<b>static</b> (<span id="r183 rd" class="r183 r">job</span>) =&gt; <span class="r183 r">job</span>.<span class="i">Location</span>).<span class="i">Aggregate</span>((<span id="r184 rd" class="r184 r">s1</span>, <span id="r185 rd" class="r185 r">s2</span>) =&gt; <span class="r184 r">s1</span> + <span class="s">&#39;,&#39;</span> + <span class="r185 r">s2</span>);
            <b>return</b> <span class="r182 r">location</span>;
        }
 
        <b>private string</b> <a id="89d81d2b54b6af82" href="../../../R/89d81d2b54b6af82.html" target="n" data-glyph="76,1" class="i method">ConstructStatusMessage</a>()
        {
            <b>if</b> (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a> == <b>null</b> || <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> == 0)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
 
            <span class="i">StringBuilder</span> <span id="r186 rd" class="r186 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>for</b> (<b>int</b> <span id="r187 rd" class="r187 r">i</span> = 0; <span class="r187 r">i</span> &lt; <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span>; <span class="r187 r">i</span>++)
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[<span class="r187 r">i</span>].<span class="i">StatusMessage</span>))
                {
                    <span class="r186 r">sb</span>.<span class="i">Append</span>(<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>[<span class="r187 r">i</span>].<span class="i">StatusMessage</span>);
                }
 
                <b>if</b> (<span class="r187 r">i</span> &lt; (<a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> - 1))
                {
                    <span class="r186 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                }
            }
 
            <b>return</b> <span class="r186 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computers on which this job is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="93359c9e0f39cbe9" href="../../../R/93359c9e0f39cbe9.html" target="n" data-glyph="102,1" class="i property">Location</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#de5cf04987f9450f" class="i method">ConstructLocation</a>();
            }
        }
 
        <b>private void</b> <a id="88cc959af52ba7cb" href="../../../R/88cc959af52ba7cb.html" target="n" data-glyph="76,1" class="i method">UnregisterJobEvent</a>(<a href="Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r188 rd" class="r188 r">job</span>)
        {
            <b>string</b> <span id="r189 rd" class="r189 r">sourceIdentifier</span> = <span class="r188 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a> + <span class="s">&quot;:StateChanged&quot;</span>;
 
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#9bc35c5d45bdf03f" class="i method">WriteMessage</a>(<span class="s">&quot;Unregistering StateChanged event for job &quot;</span>, <span class="r188 r">job</span>.<a href="Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>);
            <b>foreach</b> (<a href="../../EventManager.cs.html#b185773a8f107fac" class="t t">PSEventSubscriber</a> <span id="r190 rd" class="r190 r">subscriber</span> <b>in</b>
                <a href="#0b57a6c54adc96b2" class="i property">EventManager</a>.<a href="../../EventManager.cs.html#6588fc2123e43a92" class="i property">Subscribers</a>.<span class="i">Where</span>(<span id="r191 rd" class="r191 r">subscriber</span> =&gt; <b>string</b>.<span class="i">Equals</span>(<span class="r191 r">subscriber</span>.<span class="i">SourceIdentifier</span>, <span class="r189 r">sourceIdentifier</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
            {
                <a href="#0b57a6c54adc96b2" class="i property">EventManager</a>.<a href="../../EventManager.cs.html#66c6cf23c037e49c" class="i method">UnsubscribeEvent</a>(<span class="r190 r">subscriber</span>);
                <b>break</b>;
            }
        }
 
        <b>private void</b> <a id="1cdcc08cc8c84344" href="../../../R/1cdcc08cc8c84344.html" target="n" data-glyph="76,1" class="i method">UnregisterAllJobEvents</a>()
        {
            <b>if</b> (<a href="#0b57a6c54adc96b2" class="i property">EventManager</a> == <b>null</b>)
            {
                <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#74d51c2de1926e3a" class="i method">WriteMessage</a>(<span class="s">&quot;No events subscribed, skipping event unregistrations&quot;</span>);
                <b>return</b>;
            }
 
            <b>foreach</b> (<b>var</b> <span id="r192 rd" class="r192 r">job</span> <b>in</b> <a href="Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <span class="i">UnregisterJobEvent</span>(<span class="r192 r">job</span>);
            }
 
            <a href="#88cc959af52ba7cb" class="i method">UnregisterJobEvent</a>(<a href="#bb6daa5ca3253eb3" class="k">this</a>);
            <a href="#675d2d3dd8362483" class="i field">_tracer</a>.<a href="../../../utils/PowerShellETWTracer.cs.html#74d51c2de1926e3a" class="i method">WriteMessage</a>(<span class="s">&quot;Setting event manager to null&quot;</span>);
            <a href="#0b57a6c54adc96b2" class="i property">EventManager</a> = <b>null</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Container exception for jobs that can map errors and exceptions</span>
    <span class="c">///</span><span class="c"> to specific lines in their input.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="a4812a0c60f7f1fc" href="../../../R/a4812a0c60f7f1fc.html" target="n" data-glyph="0,0" class="t t">JobFailedException</a> : <span class="i">SystemException</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new JobFailedException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="e4eccc5d0cc5d14f" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">JobFailedException</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new JobFailedException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r193 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The message of the exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8dbadfaf7623c9ca" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">JobFailedException</a>(<b>string</b> <span id="r193 rd" class="r193 r">message</span>)
            : <b>base</b>(<span class="r193 r">message</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new JobFailedException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The message of the exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The actual exception that caused this error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="d908d24f2fdfbeff" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">JobFailedException</a>(<b>string</b> <span id="r194 rd" class="r194 r">message</span>, <span class="i">Exception</span> <span id="r195 rd" class="r195 r">innerException</span>)
            : <b>base</b>(<span class="r194 r">message</span>, <span class="r195 r">innerException</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new JobFailedException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The actual exception that caused this error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r197 r">displayScriptPosition</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A ScriptExtent that describes where this error originated from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4513f5b62df1f6a2" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">JobFailedException</a>(<span class="i">Exception</span> <span id="r196 rd" class="r196 r">innerException</span>, <a href="../../parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a> <span id="r197 rd" class="r197 r">displayScriptPosition</span>)
        {
            <a href="#ad3c5f8f30468d25" class="i field">_reason</a> = <span class="r196 r">innerException</span>;
            <a href="#b64692f592360216" class="i field">_displayScriptPosition</a> = <span class="r197 r">displayScriptPosition</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r198 r">serializationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization info.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r199 r">streamingContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Streaming context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="4ecf6594849b7370" href="../../../R/../../0000000000.html" target="n" data-glyph="75,1" class="t constructor">JobFailedException</a>(<span class="i">SerializationInfo</span> <span id="r198 rd" class="r198 r">serializationInfo</span>, <span class="i">StreamingContext</span> <span id="r199 rd" class="r199 r">streamingContext</span>)
            : <b>base</b>(<span class="r198 r">serializationInfo</span>, <span class="r199 r">streamingContext</span>)
        {
            <a href="#ad3c5f8f30468d25" class="i field">_reason</a> = (<span class="i">Exception</span>)<span class="r198 r">serializationInfo</span>.<span class="i">GetValue</span>(<span class="s">&quot;Reason&quot;</span>, <b>typeof</b>(<span class="i">Exception</span>));
            <a href="#b64692f592360216" class="i field">_displayScriptPosition</a> = (<a href="../../parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a>)<span class="r198 r">serializationInfo</span>.<span class="i">GetValue</span>(<span class="s">&quot;DisplayScriptPosition&quot;</span>, <b>typeof</b>(<a href="../../parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The actual exception that caused this error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Exception</span> <a id="9084aaa80476201b" href="../../../R/9084aaa80476201b.html" target="n" data-glyph="102,1" class="i property">Reason</a> { <b>get</b> { <b>return</b> <a href="#ad3c5f8f30468d25" class="i field">_reason</a>; } }
 
        <b>private readonly</b> <span class="i">Exception</span> <a id="ad3c5f8f30468d25" href="../../../R/ad3c5f8f30468d25.html" target="n" data-glyph="46,1" class="i field">_reason</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The user-focused location from where this error originated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a> <a id="2391b55acde0b7a6" href="../../../R/2391b55acde0b7a6.html" target="n" data-glyph="102,1" class="i property">DisplayScriptPosition</a> { <b>get</b> { <b>return</b> <a href="#b64692f592360216" class="i field">_displayScriptPosition</a>; } }
 
        <b>private readonly</b> <a href="../../parser/Position.cs.html#2baf81cbd0f80531" class="t t">ScriptExtent</a> <a id="b64692f592360216" href="../../../R/b64692f592360216.html" target="n" data-glyph="46,1" class="i field">_displayScriptPosition</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the information for serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r200 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The standard SerializationInfo.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r201 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The standard StreaminContext.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="83098016ef70c62b" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetObjectData</a>(<span class="i">SerializationInfo</span> <span id="r200 rd" class="r200 r">info</span>, <span class="i">StreamingContext</span> <span id="r201 rd" class="r201 r">context</span>)
        {
            <b>if</b> (<span class="r200 r">info</span> == <b>null</b>)
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r200 r">info</span>));
 
            <b>base</b>.<span class="i">GetObjectData</span>(<span class="r200 r">info</span>, <span class="r201 r">context</span>);
 
            <span class="r200 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;Reason&quot;</span>, <a href="#ad3c5f8f30468d25" class="i field">_reason</a>);
            <span class="r200 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;DisplayScriptPosition&quot;</span>, <a href="#b64692f592360216" class="i field">_displayScriptPosition</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the reason for this exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="cc7627a9aae81002" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Message</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9084aaa80476201b" class="i property">Reason</a>.<span class="i">Message</span>;
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PowerShell v3 Job Extensions
}
</pre></td></tr></table></div></body></html>
