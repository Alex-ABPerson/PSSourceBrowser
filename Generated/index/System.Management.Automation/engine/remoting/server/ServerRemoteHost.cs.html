<!DOCTYPE html>
<html><head><title>ServerRemoteHost.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(478);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/server/ServerRemoteHost.cs" target="_top">engine\remoting\server\ServerRemoteHost.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Server</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The ServerRemoteHost class.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="ecbb655f955c09fc" href="../../../R/ecbb655f955c09fc.html" target="n" data-glyph="2,0" class="t t">ServerRemoteHost</a> : <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a>, <a href="../../hostifaces/MshHost.cs.html#8baf67daeba803e8" class="t t">IHostSupportsInteractiveSession</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remote host user interface.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="ServerRemoteHostUserInterface.cs.html#769615b794839ac1" class="t t">ServerRemoteHostUserInterface</a> <a id="8ff95210701eac0b" href="../../../R/8ff95210701eac0b.html" target="n" data-glyph="46,1" class="i field">_remoteHostUserInterface</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Server method executor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="ServerMethodExecutor.cs.html#6c3d83fbaceaa586" class="t t">ServerMethodExecutor</a> <a id="0994325fd3bbeac9" href="../../../R/0994325fd3bbeac9.html" target="n" data-glyph="46,1" class="i field">_serverMethodExecutor</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Client runspace pool id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Guid</span> <a id="8f9af3587779cc35" href="../../../R/8f9af3587779cc35.html" target="n" data-glyph="46,1" class="i field">_clientRunspacePoolId</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Client power shell id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Guid</span> <a id="25c22955875bad8b" href="../../../R/25c22955875bad8b.html" target="n" data-glyph="46,1" class="i field">_clientPowerShellId</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Transport manager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <a href="../fanin/BaseTransportManager.cs.html#3beeadac29de3a80" class="t t">AbstractServerTransportManager</a> <a id="30d5900b14d9f9dc" href="../../../R/30d5900b14d9f9dc.html" target="n" data-glyph="45,1" class="i field">_transportManager</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ServerDriverRemoteHost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="#1186c46a3c18ebd3" class="t t">ServerDriverRemoteHost</a> <a id="ffa3ee82ef3d5c1f" href="../../../R/ffa3ee82ef3d5c1f.html" target="n" data-glyph="46,1" class="i field">_serverDriverRemoteHost</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for ServerRemoteHost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a8d2f018c8225ed5" href="../../../R/a8d2f018c8225ed5.html" target="n" data-glyph="74,1" class="t constructor">ServerRemoteHost</a>(
            <span class="i">Guid</span> <span id="r0 rd" class="r0 r">clientRunspacePoolId</span>,
            <span class="i">Guid</span> <span id="r1 rd" class="r1 r">clientPowerShellId</span>,
            <a href="../common/WireDataFormat/RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a> <span id="r2 rd" class="r2 r">hostInfo</span>,
            <a href="../fanin/BaseTransportManager.cs.html#3beeadac29de3a80" class="t t">AbstractServerTransportManager</a> <span id="r3 rd" class="r3 r">transportManager</span>,
            <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r4 rd" class="r4 r">runspace</span>,
            <a href="#1186c46a3c18ebd3" class="t t">ServerDriverRemoteHost</a> <span id="r5 rd" class="r5 r">serverDriverRemoteHost</span>)
        {
            <a href="#8f9af3587779cc35" class="i field">_clientRunspacePoolId</a> = <span class="r0 r">clientRunspacePoolId</span>;
            <a href="#25c22955875bad8b" class="i field">_clientPowerShellId</a> = <span class="r1 r">clientPowerShellId</span>;
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r2 r">hostInfo</span> != <b>null</b>, <span class="s">&quot;Expected hostInfo != null&quot;</span>);
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r3 r">transportManager</span> != <b>null</b>, <span class="s">&quot;Expected transportManager != null&quot;</span>);
 
            <span class="c">// Set host-info and the transport-manager.</span>
            <a href="#a0dd7cdadaf12138" class="i property">HostInfo</a> = <span class="r2 r">hostInfo</span>;
            <a href="#30d5900b14d9f9dc" class="i field">_transportManager</a> = <span class="r3 r">transportManager</span>;
            <a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a> = <span class="r5 r">serverDriverRemoteHost</span>;
 
            <span class="c">// Create the executor for the host methods.</span>
            <a href="#0994325fd3bbeac9" class="i field">_serverMethodExecutor</a> = <b>new</b> <a href="ServerMethodExecutor.cs.html#d5a1aa33aa48f2b9" class="t constructor">ServerMethodExecutor</a>(
                <span class="r0 r">clientRunspacePoolId</span>, <span class="r1 r">clientPowerShellId</span>, <a href="#30d5900b14d9f9dc" class="i field">_transportManager</a>);
 
            <span class="c">// Use HostInfo to create host-UI as null or non-null based on the client&#39;s host-UI.</span>
            <a href="#8ff95210701eac0b" class="i field">_remoteHostUserInterface</a> = <span class="r2 r">hostInfo</span>.<a href="../common/WireDataFormat/RemoteSessionCapability.cs.html#6204fae495989f90" class="i property">IsHostUINull</a> ? <b>null</b> : <b>new</b> <a href="ServerRemoteHostUserInterface.cs.html#922ca238c42eb122" class="t constructor">ServerRemoteHostUserInterface</a>(<a href="#ecbb655f955c09fc" class="k">this</a>);
 
            <a href="#a181afe04897bdb3" class="i property">Runspace</a> = <span class="r4 r">runspace</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Server method executor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ServerMethodExecutor.cs.html#6c3d83fbaceaa586" class="t t">ServerMethodExecutor</a> <a id="f7e839b2399b6cb0" href="../../../R/f7e839b2399b6cb0.html" target="n" data-glyph="104,1" class="i property">ServerMethodExecutor</a>
        {
            <b>get</b> { <b>return</b> <a href="#0994325fd3bbeac9" class="i field">_serverMethodExecutor</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The user interface.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../hostifaces/MshHostUserInterface.cs.html#3fd0cd9d58631820" class="t t">PSHostUserInterface</a> <a id="f3c797acf3054603" href="../../../R/f3c797acf3054603.html" target="n" data-glyph="102,1" class="i property">UI</a>
        {
            <b>get</b> { <b>return</b> <a href="#8ff95210701eac0b" class="i field">_remoteHostUserInterface</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="252d013c2ab3128c" href="../../../R/252d013c2ab3128c.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> { <b>return</b> <span class="s">&quot;ServerRemoteHost&quot;</span>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Version</span> <a id="710a0b06fef211e3" href="../../../R/710a0b06fef211e3.html" target="n" data-glyph="102,1" class="i property">Version</a>
        {
            <b>get</b> { <b>return</b> <a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#7f28502b8f30d02e" class="i field">HostVersion</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Instance id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Guid</span> <a id="bab49cf7db4c6adf" href="../../../R/bab49cf7db4c6adf.html" target="n" data-glyph="102,1" class="i property">InstanceId</a> { <b>get</b>; } = <span class="i">Guid</span>.<span class="i">NewGuid</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is runspace pushed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="df2ec5f004755348" href="../../../R/df2ec5f004755348.html" target="n" data-glyph="102,1" class="i property">IsRunspacePushed</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a>.<a href="#8bbe1942c514c66e" class="i property">IsRunspacePushed</a>;
                }
                <b>else</b>
                {
                    <b>throw</b> <a href="../common/WireDataFormat/RemoteHost.cs.html#b4240fded240f14a" class="t t">RemoteHostExceptions</a>.<a href="../common/WireDataFormat/RemoteHost.cs.html#c1b4e1225a4fe52c" class="i method">NewNotImplementedException</a>(<a href="../host/RemoteHostMethodInfo.cs.html#de0cdb3501b9855e" class="t t">RemoteHostMethodId</a>.<a href="../host/RemoteHostMethodInfo.cs.html#70f1cbc8479ec1ea" class="i field">GetIsRunspacePushed</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="a181afe04897bdb3" href="../../../R/a181afe04897bdb3.html" target="n" data-glyph="102,1" class="i property">Runspace</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Host info.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../common/WireDataFormat/RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a> <a id="a0dd7cdadaf12138" href="../../../R/a0dd7cdadaf12138.html" target="n" data-glyph="104,1" class="i property">HostInfo</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Method Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set should exit.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="d13e8842e98c66f8" href="../../../R/d13e8842e98c66f8.html" target="n" data-glyph="72,1" class="i method">SetShouldExit</a>(<b>int</b> <span id="r6 rd" class="r6 r">exitCode</span>)
        {
            <a href="#0994325fd3bbeac9" class="i field">_serverMethodExecutor</a>.<a href="ServerMethodExecutor.cs.html#7a67091550c2793c" class="i method">ExecuteVoidMethod</a>(<a href="../host/RemoteHostMethodInfo.cs.html#de0cdb3501b9855e" class="t t">RemoteHostMethodId</a>.<a href="../host/RemoteHostMethodInfo.cs.html#f57e6d9a970a8352" class="i field">SetShouldExit</a>, <b>new</b> <b>object</b>[] { <span class="r6 r">exitCode</span> });
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enter nested prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="ae9bfcf8f6b5898d" href="../../../R/ae9bfcf8f6b5898d.html" target="n" data-glyph="72,1" class="i method">EnterNestedPrompt</a>()
        {
            <b>throw</b> <a href="../common/WireDataFormat/RemoteHost.cs.html#b4240fded240f14a" class="t t">RemoteHostExceptions</a>.<a href="../common/WireDataFormat/RemoteHost.cs.html#c1b4e1225a4fe52c" class="i method">NewNotImplementedException</a>(<a href="../host/RemoteHostMethodInfo.cs.html#de0cdb3501b9855e" class="t t">RemoteHostMethodId</a>.<a href="../host/RemoteHostMethodInfo.cs.html#f8e6acb555685c22" class="i field">EnterNestedPrompt</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Exit nested prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="d0b00341c79582a0" href="../../../R/d0b00341c79582a0.html" target="n" data-glyph="72,1" class="i method">ExitNestedPrompt</a>()
        {
            <b>throw</b> <a href="../common/WireDataFormat/RemoteHost.cs.html#b4240fded240f14a" class="t t">RemoteHostExceptions</a>.<a href="../common/WireDataFormat/RemoteHost.cs.html#c1b4e1225a4fe52c" class="i method">NewNotImplementedException</a>(<a href="../host/RemoteHostMethodInfo.cs.html#de0cdb3501b9855e" class="t t">RemoteHostMethodId</a>.<a href="../host/RemoteHostMethodInfo.cs.html#506e9db3f81c4fa9" class="i field">ExitNestedPrompt</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Notify begin application.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="affbe09572e060f8" href="../../../R/affbe09572e060f8.html" target="n" data-glyph="72,1" class="i method">NotifyBeginApplication</a>()
        {
            <span class="c">// This is called when a native application is executed on the server. It gives the</span>
            <span class="c">// host an opportunity to save state that might be altered by the native application.</span>
            <span class="c">// This call should not be sent to the client because the native application running</span>
            <span class="c">// on the server cannot affect the state of the machine on the client.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Notify end application.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="4eb04e864d143562" href="../../../R/4eb04e864d143562.html" target="n" data-glyph="72,1" class="i method">NotifyEndApplication</a>()
        {
            <span class="c">// See note in NotifyBeginApplication.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Current culture.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">CultureInfo</span> <a id="fed1c2fbc1388675" href="../../../R/fed1c2fbc1388675.html" target="n" data-glyph="102,1" class="i property">CurrentCulture</a>
        {
            <b>get</b>
            {
                <span class="c">// Return the thread&#39;s current culture and rely on WinRM to set this</span>
                <span class="c">// correctly based on the client&#39;s culture.</span>
                <b>return</b> <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Current ui culture.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">CultureInfo</span> <a id="6d92d3cd098a43d2" href="../../../R/6d92d3cd098a43d2.html" target="n" data-glyph="102,1" class="i property">CurrentUICulture</a>
        {
            <b>get</b>
            {
                <span class="c">// Return the thread&#39;s current UI culture and rely on WinRM to set</span>
                <span class="c">// this correctly based on the client&#39;s UI culture.</span>
                <b>return</b> <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Push runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="ef24d12ad35a2e66" href="../../../R/ef24d12ad35a2e66.html" target="n" data-glyph="72,1" class="i method">PushRunspace</a>(<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r7 rd" class="r7 r">runspace</span>)
        {
            <b>if</b> (<a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a> != <b>null</b>)
            {
                <a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a>.<a href="#62e50bac6513bdc9" class="i method">PushRunspace</a>(<span class="r7 r">runspace</span>);
            }
            <b>else</b>
            {
                <b>throw</b> <a href="../common/WireDataFormat/RemoteHost.cs.html#b4240fded240f14a" class="t t">RemoteHostExceptions</a>.<a href="../common/WireDataFormat/RemoteHost.cs.html#c1b4e1225a4fe52c" class="i method">NewNotImplementedException</a>(<a href="../host/RemoteHostMethodInfo.cs.html#de0cdb3501b9855e" class="t t">RemoteHostMethodId</a>.<a href="../host/RemoteHostMethodInfo.cs.html#2c409dec52c59208" class="i field">PushRunspace</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pop runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="89d26d67b5fb929f" href="../../../R/89d26d67b5fb929f.html" target="n" data-glyph="72,1" class="i method">PopRunspace</a>()
        {
            <b>if</b> ((<a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a> != <b>null</b>) &amp;&amp; (<a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a>.<a href="#8bbe1942c514c66e" class="i property">IsRunspacePushed</a>))
            {
                <b>if</b> (<a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a>.<a href="#854baaba2ef8914a" class="i property">PropagatePop</a>)
                {
                    <span class="c">// Forward the PopRunspace command to client and keep *this* pushed runspace as</span>
                    <span class="c">// the configured JEA restricted session.</span>
                    <a href="#0994325fd3bbeac9" class="i field">_serverMethodExecutor</a>.<a href="ServerMethodExecutor.cs.html#0f32a6d50fe5ce4e" class="i method">ExecuteVoidMethod</a>(<a href="../host/RemoteHostMethodInfo.cs.html#de0cdb3501b9855e" class="t t">RemoteHostMethodId</a>.<a href="../host/RemoteHostMethodInfo.cs.html#61537fe28d0ff3d9" class="i field">PopRunspace</a>);
                }
                <b>else</b>
                {
                    <a href="#ffa3ee82ef3d5c1f" class="i field">_serverDriverRemoteHost</a>.<a href="#4bfdbda58ed475b7" class="i method">PopRunspace</a>();
                }
            }
            <b>else</b>
            {
                <a href="#0994325fd3bbeac9" class="i field">_serverMethodExecutor</a>.<a href="ServerMethodExecutor.cs.html#0f32a6d50fe5ce4e" class="i method">ExecuteVoidMethod</a>(<a href="../host/RemoteHostMethodInfo.cs.html#de0cdb3501b9855e" class="t t">RemoteHostMethodId</a>.<a href="../host/RemoteHostMethodInfo.cs.html#61537fe28d0ff3d9" class="i field">PopRunspace</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The remote host class for the ServerRunspacePoolDriver.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="1186c46a3c18ebd3" href="../../../R/1186c46a3c18ebd3.html" target="n" data-glyph="2,0" class="t t">ServerDriverRemoteHost</a> : <a href="#ecbb655f955c09fc" class="t t">ServerRemoteHost</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <a id="f2b3bdd26bd5c779" href="../../../R/f2b3bdd26bd5c779.html" target="n" data-glyph="46,1" class="i field">_pushedRunspace</a>;
        <b>private</b> <a href="ServerRunspacePoolDriver.cs.html#659f74f76b5af7db" class="t t">ServerRemoteDebugger</a> <a id="535fb0958a8e066d" href="../../../R/535fb0958a8e066d.html" target="n" data-glyph="46,1" class="i field">_debugger</a>;
        <b>private bool</b> <a id="5ce5c6eb1e844bfb" href="../../../R/5ce5c6eb1e844bfb.html" target="n" data-glyph="46,1" class="i field">_hostSupportsPSEdit</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <b>internal</b> <a id="a741cc0373bf3335" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ServerDriverRemoteHost</a>(
            <span class="i">Guid</span> <span id="r8 rd" class="r8 r">clientRunspacePoolId</span>,
            <span class="i">Guid</span> <span id="r9 rd" class="r9 r">clientPowerShellId</span>,
            <a href="../common/WireDataFormat/RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a> <span id="r10 rd" class="r10 r">hostInfo</span>,
            <a href="../fanin/BaseTransportManager.cs.html#18630eb940dac0a0" class="t t">AbstractServerSessionTransportManager</a> <span id="r11 rd" class="r11 r">transportManager</span>,
            <a href="ServerRunspacePoolDriver.cs.html#659f74f76b5af7db" class="t t">ServerRemoteDebugger</a> <span id="r12 rd" class="r12 r">debugger</span>)
            : <a href="#a8d2f018c8225ed5" class="k">base</a>(<span class="r8 r">clientRunspacePoolId</span>, <span class="r9 r">clientPowerShellId</span>, <span class="r10 r">hostInfo</span>, <span class="r11 r">transportManager</span>, <b>null</b>, <b>null</b>)
        {
            <a href="#535fb0958a8e066d" class="i field">_debugger</a> = <span class="r12 r">debugger</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if runspace is pushed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="8bbe1942c514c66e" href="../../../R/8bbe1942c514c66e.html" target="n" data-glyph="102,1" class="i property">IsRunspacePushed</a>
        {
            <b>get</b>
            {
                <b>return</b> (<a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a> != <b>null</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Push runspace to use for remote command execution.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RemoteRunspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="62e50bac6513bdc9" href="../../../R/62e50bac6513bdc9.html" target="n" data-glyph="72,1" class="i method">PushRunspace</a>(<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r13 rd" class="r13 r">runspace</span>)
        {
            <b>if</b> (<a href="#535fb0958a8e066d" class="i field">_debugger</a> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ServerDriverRemoteHostNoDebuggerToPush</span>);
            }
 
            <b>if</b> (<a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a> != <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ServerDriverRemoteHostAlreadyPushed</span>);
            }
 
            <b>if</b> (!(<span class="r13 r">runspace</span> <b>is</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r14 rd" class="r14 r">remoteRunspace</span>))
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ServerDriverRemoteHostNotRemoteRunspace</span>);
            }
 
            <span class="c">// PSEdit support.  Existence of RemoteSessionOpenFileEvent event indicates host supports PSEdit</span>
            <a href="#5ce5c6eb1e844bfb" class="i field">_hostSupportsPSEdit</a> = <b>false</b>;
            <a href="../../EventManager.cs.html#0fd88f72d27f82bd" class="t t">PSEventManager</a> <span id="r15 rd" class="r15 r">localEventManager</span> = <a href="#a181afe04897bdb3" class="i property">Runspace</a>?.<a href="../../hostifaces/Connection.cs.html#76f15a0f04e941d7" class="i property">Events</a>;
            <a href="#5ce5c6eb1e844bfb" class="i field">_hostSupportsPSEdit</a> = <span class="r15 r">localEventManager</span> != <b>null</b> &amp;&amp; <span class="r15 r">localEventManager</span>.<a href="../../EventManager.cs.html#2e974e2b72c89066" class="i method">GetEventSubscribers</a>(<a href="../../hostifaces/HostUtilities.cs.html#38cb736539b5d994" class="t t">HostUtilities</a>.<a href="../../hostifaces/HostUtilities.cs.html#27696f8ebd73638c" class="i field">RemoteSessionOpenFileEvent</a>).<span class="i">GetEnumerator</span>().<span class="i">MoveNext</span>();
            <b>if</b> (<a href="#5ce5c6eb1e844bfb" class="i field">_hostSupportsPSEdit</a>)
            {
                <a href="#5d9e24ca2367a485" class="i method">AddPSEditForRunspace</a>(<span class="r14 r">remoteRunspace</span>);
            }
 
            <a href="#535fb0958a8e066d" class="i field">_debugger</a>.<a href="ServerRunspacePoolDriver.cs.html#c51125f0992faed4" class="i method">PushDebugger</a>(<span class="r13 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>);
            <a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a> = <span class="r14 r">remoteRunspace</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pop runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="4bfdbda58ed475b7" href="../../../R/4bfdbda58ed475b7.html" target="n" data-glyph="72,1" class="i method">PopRunspace</a>()
        {
            <b>if</b> (<a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#535fb0958a8e066d" class="i field">_debugger</a> != <b>null</b>)
                {
                    <a href="#535fb0958a8e066d" class="i field">_debugger</a>.<a href="ServerRunspacePoolDriver.cs.html#ddb094267d4f7041" class="i method">PopDebugger</a>();
                }
 
                <b>if</b> (<a href="#5ce5c6eb1e844bfb" class="i field">_hostSupportsPSEdit</a>)
                {
                    <a href="#2821e23159f7c03e" class="i method">RemovePSEditFromRunspace</a>(<a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a>);
                }
 
                <b>if</b> (<a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a>.<a href="../client/remoterunspace.cs.html#a7ae975f02f2273a" class="i property">ShouldCloseOnPop</a>)
                {
                    <a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a>.<a href="../client/remoterunspace.cs.html#93d0f66da676bbe4" class="i method">Close</a>();
                }
 
                <a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a> = <b>null</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Server Debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="47c9fb23cb0613c9" href="../../../R/47c9fb23cb0613c9.html" target="n" data-glyph="104,1" class="i property">ServerDebugger</a>
        {
            <b>get</b> { <b>return</b> <a href="#535fb0958a8e066d" class="i field">_debugger</a>; }
 
            <b>set</b> { <a href="#535fb0958a8e066d" class="i field">_debugger</a> = <b>value as</b> <a href="ServerRunspacePoolDriver.cs.html#659f74f76b5af7db" class="t t">ServerRemoteDebugger</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pushed runspace or null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="93e694613df6a4a0" href="../../../R/93e694613df6a4a0.html" target="n" data-glyph="104,1" class="i property">PushedRunspace</a>
        {
            <b>get</b> { <b>return</b> <a href="#f2b3bdd26bd5c779" class="i field">_pushedRunspace</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When true will propagate pop call to client after popping runspace from this</span>
        <span class="c">///</span><span class="c"> host.  Used for OutOfProc remote sessions in a restricted (pushed) remote runspace,</span>
        <span class="c">///</span><span class="c"> where a pop (exit session) should occur.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="854baaba2ef8914a" href="../../../R/854baaba2ef8914a.html" target="n" data-glyph="104,1" class="i property">PropagatePop</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSEdit Support for ISE Host
 
        <b>private void</b> <a id="5d9e24ca2367a485" href="../../../R/5d9e24ca2367a485.html" target="n" data-glyph="76,1" class="i method">AddPSEditForRunspace</a>(<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r16 rd" class="r16 r">remoteRunspace</span>)
        {
            <b>if</b> (<span class="r16 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a> == <b>null</b>) { <b>return</b>; }
 
            <span class="c">// Add event handler.</span>
            <span class="r16 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a>.<a href="../../EventManager.cs.html#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="../../EventManager.cs.html#bce564b5d84fdbcb" class="i">PSEventReceived</a> += <a href="#bde8b1eac768ffb1" class="i method">HandleRemoteSessionForwardedEvent</a>;
 
            <span class="c">// Add script function.</span>
            <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r17 rd" class="r17 r">powershell</span> = <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
            {
                <span class="r17 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> = <span class="r16 r">remoteRunspace</span>;
                <span class="r17 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#c97f8d15a2f93e31" class="i method">AddScript</a>(<a href="../../hostifaces/HostUtilities.cs.html#38cb736539b5d994" class="t t">HostUtilities</a>.<a href="../../hostifaces/HostUtilities.cs.html#1038f0c7f94fca20" class="i field">CreatePSEditFunction</a>).<a href="../../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;PSEditFunction&quot;</span>, <a href="../../hostifaces/HostUtilities.cs.html#38cb736539b5d994" class="t t">HostUtilities</a>.<a href="../../hostifaces/HostUtilities.cs.html#718076e6222bf1c3" class="i field">PSEditFunction</a>);
                <b>try</b>
                {
                    <span class="r17 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
                }
                <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a>) { }
            }
        }
 
        <b>private void</b> <a id="2821e23159f7c03e" href="../../../R/2821e23159f7c03e.html" target="n" data-glyph="76,1" class="i method">RemovePSEditFromRunspace</a>(<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r18 rd" class="r18 r">remoteRunspace</span>)
        {
            <b>if</b> (<span class="r18 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a> == <b>null</b>) { <b>return</b>; }
 
            <span class="c">// It is possible for the popped runspace to be in a bad state after an error.</span>
            <b>if</b> ((<span class="r18 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#a76d07f84f3f8c60" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>) || (<span class="r18 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#c9a8dc56926b5fdf" class="i property">RunspaceAvailability</a> != <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#64bc5c5290cfb16d" class="i field">Available</a>))
            {
                <b>return</b>;
            }
 
            <span class="c">// Remove event handler.</span>
            <span class="r18 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a>.<a href="../../EventManager.cs.html#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="../../EventManager.cs.html#bce564b5d84fdbcb" class="i">PSEventReceived</a> -= <a href="#bde8b1eac768ffb1" class="i method">HandleRemoteSessionForwardedEvent</a>;
 
            <span class="c">// Remove script function.</span>
            <b>using</b> (<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r19 rd" class="r19 r">powershell</span> = <a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
            {
                <span class="r19 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> = <span class="r18 r">remoteRunspace</span>;
                <span class="r19 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#c97f8d15a2f93e31" class="i method">AddScript</a>(<a href="../../hostifaces/HostUtilities.cs.html#38cb736539b5d994" class="t t">HostUtilities</a>.<a href="../../hostifaces/HostUtilities.cs.html#4fe793b10100c25c" class="i field">RemovePSEditFunction</a>);
                <b>try</b>
                {
                    <span class="r19 r">powershell</span>.<a href="../../hostifaces/PowerShell.cs.html#184e23c46120523e" class="i method">Invoke</a>();
                }
                <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a>) { }
            }
        }
 
        <b>private void</b> <a id="bde8b1eac768ffb1" href="../../../R/bde8b1eac768ffb1.html" target="n" data-glyph="76,1" class="i method">HandleRemoteSessionForwardedEvent</a>(<b>object</b> <span id="r20 rd" class="r20 r">sender</span>, <a href="../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r21 rd" class="r21 r">args</span>)
        {
            <b>if</b> ((<a href="#a181afe04897bdb3" class="i property">Runspace</a> == <b>null</b>) || (<a href="#a181afe04897bdb3" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#76f15a0f04e941d7" class="i property">Events</a> == <b>null</b>)) { <b>return</b>; }
 
            <span class="c">// Forward events from nested pushed session to parent session.</span>
            <b>try</b>
            {
                <a href="#a181afe04897bdb3" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#76f15a0f04e941d7" class="i property">Events</a>.<a href="../../EventManager.cs.html#dfff9a097c10a4e8" class="i method">GenerateEvent</a>(
                    <span class="r22 r">sourceIdentifier</span>: <span class="r21 r">args</span>.<a href="../../EventManager.cs.html#d8b1da7bcf77174b" class="i property">SourceIdentifier</a>,
                    <span class="r23 r">sender</span>: <b>null</b>,
                    <span class="r24 r">args</span>: <span class="r21 r">args</span>.<a href="../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>,
                    <span class="r25 r">extraData</span>: <b>null</b>);
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
