<!DOCTYPE html>
<html><head><title>PSPrincipal.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(395);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/fanin/PSPrincipal.cs" target="_top">engine\remoting\fanin\PSPrincipal.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="c">/*
 * Contains definition for PSSenderInfo, PSPrincipal, PSIdentity which are
 * used to provide remote user information to different plugin snapins
 * like Exchange.
 */</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Principal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class is used in the server side remoting scenarios. This class</span>
    <span class="c">///</span><span class="c"> holds information about the incoming connection like:</span>
    <span class="c">///</span><span class="c"> (a) Client&#39;s TimeZone</span>
    <span class="c">///</span><span class="c"> (b) Connecting User information</span>
    <span class="c">///</span><span class="c"> (c) Connection String used by the user to connect to the server.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Serializable</span>]
    <b>public sealed class</b> <a id="eeedcf9113508cb9" href="../../../R/eeedcf9113508cb9.html" target="n" data-glyph="0,0" class="t t">PSSenderInfo</a> : <span class="i">ISerializable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private</b> <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="825f90bb7de0579c" href="../../../R/825f90bb7de0579c.html" target="n" data-glyph="46,1" class="i field">_applicationArguments</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Serialization
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="43d75216158068dc" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetObjectData</a>(<span class="i">SerializationInfo</span> <span id="r0 rd" class="r0 r">info</span>, <span class="i">StreamingContext</span> <span id="r1 rd" class="r1 r">context</span>)
        {
            <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r2 rd" class="r2 r">psObject</span> = <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<a href="#eeedcf9113508cb9" class="k">this</a>);
            <span class="r2 r">psObject</span>.<a href="../../MshObject.cs.html#c365b93cc458b2fe" class="i method">GetObjectData</a>(<span class="r0 r">info</span>, <span class="r1 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deserialization constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a id="85c5dbd0d8365e6e" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">PSSenderInfo</a>(<span class="i">SerializationInfo</span> <span id="r3 rd" class="r3 r">info</span>, <span class="i">StreamingContext</span> <span id="r4 rd" class="r4 r">context</span>)
        {
            <b>if</b> (<span class="r3 r">info</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>string</b> <span id="r5 rd" class="r5 r">serializedData</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r5 r">serializedData</span> = <span class="r3 r">info</span>.<span class="i">GetValue</span>(<span class="s">&quot;CliXml&quot;</span>, <b>typeof</b>(<b>string</b>)) <b>as string</b>;
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// When a workflow is run locally, there won&#39;t be PSSenderInfo</span>
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r5 r">serializedData</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>try</b>
            {
                <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r6 rd" class="r6 r">result</span> = <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<a href="../../serialization.cs.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<a href="../../serialization.cs.html#d9210d35690d435f" class="i method">Deserialize</a>(<span class="r5 r">serializedData</span>));
                <a href="#eeedcf9113508cb9" class="t t">PSSenderInfo</a> <span id="r7 rd" class="r7 r">senderInfo</span> = <a href="../../serialization.cs.html#ddbcb5ecc947a806" class="t t">DeserializingTypeConverter</a>.<a href="../../serialization.cs.html#55391c9759698adf" class="i method">RehydratePSSenderInfo</a>(<span class="r6 r">result</span>);
 
                <a href="#ac3b737833cbe3e1" class="i property">UserInfo</a> = <span class="r7 r">senderInfo</span>.<a href="#ac3b737833cbe3e1" class="i property">UserInfo</a>;
                <a href="#2833f89afefa8821" class="i property">ConnectionString</a> = <span class="r7 r">senderInfo</span>.<a href="#2833f89afefa8821" class="i property">ConnectionString</a>;
                <a href="#825f90bb7de0579c" class="i field">_applicationArguments</a> = <span class="r7 r">senderInfo</span>.<a href="#825f90bb7de0579c" class="i field">_applicationArguments</a>;
 
                <a href="#c495b1f3e6e5123e" class="i property">ClientTimeZone</a> = <span class="r7 r">senderInfo</span>.<a href="#c495b1f3e6e5123e" class="i property">ClientTimeZone</a>;
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// Ignore conversion errors</span>
                <b>return</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs PSPrincipal using PSIdentity and a token (used to construct WindowsIdentity)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">userPrincipal</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connecting User Information</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">httpUrl</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> httpUrl element (from WSMAN_SENDER_DETAILS struct).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1054:UriParametersShouldNotBeStrings&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;1#&quot;</span>)]
        <b>public</b> <a id="041d397e8ed43c11" href="../../../R/041d397e8ed43c11.html" target="n" data-glyph="72,1" class="t constructor">PSSenderInfo</a>(<a href="#f38f79fd26abc753" class="t t">PSPrincipal</a> <span id="r8 rd" class="r8 r">userPrincipal</span>, <b>string</b> <span id="r9 rd" class="r9 r">httpUrl</span>)
        {
            <a href="#ac3b737833cbe3e1" class="i property">UserInfo</a> = <span class="r8 r">userPrincipal</span>;
            <a href="#2833f89afefa8821" class="i property">ConnectionString</a> = <span class="r9 r">httpUrl</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Contains information related to the user connecting to the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#f38f79fd26abc753" class="t t">PSPrincipal</a> <a id="ac3b737833cbe3e1" href="../../../R/ac3b737833cbe3e1.html" target="n" data-glyph="102,1" class="i property">UserInfo</a>
        {
            <b>get</b>;
            <span class="c">// No public set because PSSenderInfo/PSPrincipal is used by PSSessionConfiguration&#39;s</span>
            <span class="c">// and usually they dont cache this data internally..so did not want to give</span>
            <span class="c">// cmdlets/scripts a chance to modify these.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Contains the TimeZone information from the client machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeZoneInfo</span> <a id="c495b1f3e6e5123e" href="../../../R/c495b1f3e6e5123e.html" target="n" data-glyph="102,1" class="i property">ClientTimeZone</a>
        {
            <b>get</b>;
            <b>internal set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connection string used by the client to connect to the server. This is</span>
        <span class="c">///</span><span class="c"> directly taken from WSMAN_SENDER_DETAILS struct (from wsman.h)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="2833f89afefa8821" href="../../../R/2833f89afefa8821.html" target="n" data-glyph="102,1" class="i property">ConnectionString</a>
        {
            <b>get</b>;
            <span class="c">// No public set because PSSenderInfo/PSPrincipal is used by PSSessionConfiguration&#39;s</span>
            <span class="c">// and usually they dont cache this data internally..so did not want to give</span>
            <span class="c">// cmdlets/scripts a chance to modify these.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Application arguments (i.e. specified in New-PSSessionOptions -ApplicationArguments)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="fbb9c1201251c818" href="../../../R/fbb9c1201251c818.html" target="n" data-glyph="102,1" class="i property">ApplicationArguments</a>
        {
            <b>get</b> { <b>return</b> <a href="#825f90bb7de0579c" class="i field">_applicationArguments</a>; }
 
            <b>internal set</b> { <a href="#825f90bb7de0579c" class="i field">_applicationArguments</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> &quot;ConfigurationName&quot; from the sever remote session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="6eab5e435b27241d" href="../../../R/6eab5e435b27241d.html" target="n" data-glyph="102,1" class="i property">ConfigurationName</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the basic functionality of a PSPrincipal object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="f38f79fd26abc753" href="../../../R/f38f79fd26abc753.html" target="n" data-glyph="0,0" class="t t">PSPrincipal</a> : <span class="i">IPrincipal</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the identity of the current user principal.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#39528f52ff89f7c2" class="t t">PSIdentity</a> <a id="be3c94a41767a974" href="../../../R/be3c94a41767a974.html" target="n" data-glyph="102,1" class="i property">Identity</a>
        {
            <b>get</b>;
            <span class="c">// No public set because PSSenderInfo/PSPrincipal is used by PSSessionConfiguration&#39;s</span>
            <span class="c">// and usually they dont cache this data internally..so did not want to give</span>
            <span class="c">// cmdlets/scripts a chance to modify these.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the WindowsIdentity (if possible) representation of the current Identity.</span>
        <span class="c">///</span><span class="c"> PSPrincipal can represent any user for example a LiveID user, network user within</span>
        <span class="c">///</span><span class="c"> a domain etc. This property tries to convert the Identity to WindowsIdentity</span>
        <span class="c">///</span><span class="c"> using the user token supplied.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">WindowsIdentity</span> <a id="40a4d8ad922f211f" href="../../../R/40a4d8ad922f211f.html" target="n" data-glyph="102,1" class="i property">WindowsIdentity</a>
        {
            <b>get</b>;
            <span class="c">// No public set because PSSenderInfo/PSPrincipal is used by PSSessionConfiguration&#39;s</span>
            <span class="c">// and usually they dont cache this data internally..so did not want to give</span>
            <span class="c">// cmdlets/scripts a chance to modify these.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the identity of the current principal.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="i">IIdentity</span> <span class="i">IPrincipal</span>.<a id="cef93dff186ae4f3" href="../../../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Identity</a>
        {
            <b>get</b> { <b>return</b> <a href="#f38f79fd26abc753" class="k">this</a>.<a href="#be3c94a41767a974" class="i property">Identity</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the current principal belongs to a specified rule.</span>
        <span class="c">///</span><span class="c"> If we were able to get a WindowsIdentity then this will perform the</span>
        <span class="c">///</span><span class="c"> check using the WindowsIdentity otherwise this will return false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">role</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If we were able to get a WindowsIdentity then this will perform the</span>
        <span class="c">///</span><span class="c"> check using the WindowsIdentity otherwise this will return false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="5c9530630ce2e5ea" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">IsInRole</a>(<b>string</b> <span id="r10 rd" class="r10 r">role</span>)
        {
            <b>if</b> (<a href="#40a4d8ad922f211f" class="i property">WindowsIdentity</a> != <b>null</b>)
            {
                <span class="c">// Get Windows Principal for this identity</span>
                <span class="i">WindowsPrincipal</span> <span id="r11 rd" class="r11 r">windowsPrincipal</span> = <b>new</b> <span class="i">WindowsPrincipal</span>(<a href="#40a4d8ad922f211f" class="i property">WindowsIdentity</a>);
                <b>return</b> <span class="r11 r">windowsPrincipal</span>.<span class="i">IsInRole</span>(<span class="r10 r">role</span>);
            }
            <b>else</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal overload of IsInRole() taking a WindowsBuiltInRole enum value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="bd67468560ab3d67" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsInRole</a>(<span class="i">WindowsBuiltInRole</span> <span id="r12 rd" class="r12 r">role</span>)
        {
            <b>if</b> (<a href="#40a4d8ad922f211f" class="i property">WindowsIdentity</a> != <b>null</b>)
            {
                <span class="c">// Get Windows Principal for this identity</span>
                <span class="i">WindowsPrincipal</span> <span id="r13 rd" class="r13 r">windowsPrincipal</span> = <b>new</b> <span class="i">WindowsPrincipal</span>(<a href="#40a4d8ad922f211f" class="i property">WindowsIdentity</a>);
                <b>return</b> <span class="r13 r">windowsPrincipal</span>.<span class="i">IsInRole</span>(<span class="r12 r">role</span>);
            }
            <b>else</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs PSPrincipal using PSIdentity and a WindowsIdentity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">identity</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of PSIdentity</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">windowsIdentity</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of WindowsIdentity, if psIdentity represents a windows user. This can be</span>
        <span class="c">///</span><span class="c"> null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="9fa65de366a45f51" href="../../../R/9fa65de366a45f51.html" target="n" data-glyph="72,1" class="t constructor">PSPrincipal</a>(<a href="#39528f52ff89f7c2" class="t t">PSIdentity</a> <span id="r14 rd" class="r14 r">identity</span>, <span class="i">WindowsIdentity</span> <span id="r15 rd" class="r15 r">windowsIdentity</span>)
        {
            <a href="#be3c94a41767a974" class="i property">Identity</a> = <span class="r14 r">identity</span>;
            <a href="#40a4d8ad922f211f" class="i property">WindowsIdentity</a> = <span class="r15 r">windowsIdentity</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the basic functionality of a PSIdentity object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="39528f52ff89f7c2" href="../../../R/39528f52ff89f7c2.html" target="n" data-glyph="0,0" class="t t">PSIdentity</a> : <span class="i">IIdentity</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type of authentication used.</span>
        <span class="c">///</span><span class="c"> For a WSMan service authenticated user this will be one of the following:</span>
        <span class="c">///</span><span class="c">  WSMAN_DEFAULT_AUTHENTICATION</span>
        <span class="c">///</span><span class="c">  WSMAN_NO_AUTHENTICATION</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_DIGEST</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_NEGOTIATE</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_BASIC</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_KERBEROS</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_CLIENT_CERTIFICATE</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_LIVEID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="eec750d4ddf1c851" href="../../../R/eec750d4ddf1c851.html" target="n" data-glyph="102,1" class="i property">AuthenticationType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a value that indicates whether the user has been authenticated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="3c54bfaf9c2ed337" href="../../../R/3c54bfaf9c2ed337.html" target="n" data-glyph="102,1" class="i property">IsAuthenticated</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the name of the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="5ec5296e7ff7b744" href="../../../R/5ec5296e7ff7b744.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the certificate details of the user if supported, null otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#51c78fc6fd1d052d" class="t t">PSCertificateDetails</a> <a id="222fe2fd2b374a77" href="../../../R/222fe2fd2b374a77.html" target="n" data-glyph="102,1" class="i property">CertificateDetails</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used to construct a PSIdentity object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">authType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Type of authentication used to authenticate this user.</span>
        <span class="c">///</span><span class="c"> For a WSMan service authenticated user this will be one of the following:</span>
        <span class="c">///</span><span class="c">  WSMAN_DEFAULT_AUTHENTICATION</span>
        <span class="c">///</span><span class="c">  WSMAN_NO_AUTHENTICATION</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_DIGEST</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_NEGOTIATE</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_BASIC</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_KERBEROS</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_CLIENT_CERTIFICATE</span>
        <span class="c">///</span><span class="c">  WSMAN_AUTH_LIVEID</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">isAuthenticated</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if this user is authenticated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the user</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">cert</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Certificate details if Certificate authentication is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="3c9c1564875caeb1" href="../../../R/3c9c1564875caeb1.html" target="n" data-glyph="72,1" class="t constructor">PSIdentity</a>(<b>string</b> <span id="r16 rd" class="r16 r">authType</span>, <b>bool</b> <span id="r17 rd" class="r17 r">isAuthenticated</span>, <b>string</b> <span id="r18 rd" class="r18 r">userName</span>, <a href="#51c78fc6fd1d052d" class="t t">PSCertificateDetails</a> <span id="r19 rd" class="r19 r">cert</span>)
        {
            <a href="#eec750d4ddf1c851" class="i property">AuthenticationType</a> = <span class="r16 r">authType</span>;
            <a href="#3c54bfaf9c2ed337" class="i property">IsAuthenticated</a> = <span class="r17 r">isAuthenticated</span>;
            <a href="#5ec5296e7ff7b744" class="i property">Name</a> = <span class="r18 r">userName</span>;
            <a href="#222fe2fd2b374a77" class="i property">CertificateDetails</a> = <span class="r19 r">cert</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents the certificate of a user.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="51c78fc6fd1d052d" href="../../../R/51c78fc6fd1d052d.html" target="n" data-glyph="0,0" class="t t">PSCertificateDetails</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets Subject of the certificate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b626b68672f78e54" href="../../../R/b626b68672f78e54.html" target="n" data-glyph="102,1" class="i property">Subject</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the issuer name of the certificate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="f9d09569d57d222c" href="../../../R/f9d09569d57d222c.html" target="n" data-glyph="102,1" class="i property">IssuerName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the issuer thumb print.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="82d1bf4675e619cc" href="../../../R/82d1bf4675e619cc.html" target="n" data-glyph="102,1" class="i property">IssuerThumbprint</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used to construct a PSCertificateDetails object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">subject</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subject of the certificate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">issuerName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Issuer name of the certificate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">issuerThumbprint</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Issuer thumb print of the certificate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="14df078d42c823bc" href="../../../R/14df078d42c823bc.html" target="n" data-glyph="72,1" class="t constructor">PSCertificateDetails</a>(<b>string</b> <span id="r20 rd" class="r20 r">subject</span>, <b>string</b> <span id="r21 rd" class="r21 r">issuerName</span>, <b>string</b> <span id="r22 rd" class="r22 r">issuerThumbprint</span>)
        {
            <a href="#b626b68672f78e54" class="i property">Subject</a> = <span class="r20 r">subject</span>;
            <a href="#f9d09569d57d222c" class="i property">IssuerName</a> = <span class="r21 r">issuerName</span>;
            <a href="#82d1bf4675e619cc" class="i property">IssuerThumbprint</a> = <span class="r22 r">issuerThumbprint</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
