<!DOCTYPE html>
<html><head><title>WSManNativeAPI.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(3106);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/fanin/WSManNativeAPI.cs" target="_top">engine\remoting\fanin\WSManNativeAPI.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Debug</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>
{
    <b>internal static class</b> <a id="46dd878f72638b32" href="../../../R/46dd878f72638b32.html" target="n" data-glyph="2,0" class="t t">WSManNativeApi</a>
    {
        <b>internal const uint</b> <a id="160c8adc16fd3bfe" href="../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">INFINITE</a> = 0xFFFFFFFF;
        <b>internal const string</b> <a id="162d8410e5d5ba48" href="../../../R/162d8410e5d5ba48.html" target="n" data-glyph="8,1" class="i field">PS_CREATION_XML_TAG</a> = <span class="s">&quot;creationXml&quot;</span>;
        <b>internal const string</b> <a id="7e67862a7fd16f55" href="../../../R/7e67862a7fd16f55.html" target="n" data-glyph="8,1" class="i field">PS_CONNECT_XML_TAG</a> = <span class="s">&quot;connectXml&quot;</span>;
        <b>internal const string</b> <a id="bd71f1416f30f9a8" href="../../../R/bd71f1416f30f9a8.html" target="n" data-glyph="8,1" class="i field">PS_CONNECTRESPONSE_XML_TAG</a> = <span class="s">&quot;connectResponseXml&quot;</span>;
        <b>internal const string</b> <a id="bc04bbaff8dec383" href="../../../R/bc04bbaff8dec383.html" target="n" data-glyph="8,1" class="i field">PS_XML_NAMESPACE</a> = <span class="s">&quot;http://schemas.microsoft.com/powershell&quot;</span>;
        <b>internal const string</b> <a id="ab2f3becc1476649" href="../../../R/ab2f3becc1476649.html" target="n" data-glyph="8,1" class="i field">WSMAN_STREAM_ID_STDOUT</a> = <span class="s">&quot;stdout&quot;</span>;
        <b>internal const string</b> <a id="2dd82f73ca1e8381" href="../../../R/2dd82f73ca1e8381.html" target="n" data-glyph="8,1" class="i field">WSMAN_STREAM_ID_PROMPTRESPONSE</a> = <span class="s">&quot;pr&quot;</span>;
        <b>internal const string</b> <a id="dc257aa7beeaf400" href="../../../R/dc257aa7beeaf400.html" target="n" data-glyph="8,1" class="i field">WSMAN_STREAM_ID_STDIN</a> = <span class="s">&quot;stdin&quot;</span>;
        <b>internal const string</b> <a id="f383edcf61712f90" href="../../../R/f383edcf61712f90.html" target="n" data-glyph="8,1" class="i field">ResourceURIPrefix</a> = <span class="s">@&quot;http://schemas.microsoft.com/powershell/&quot;</span>;
        <b>internal const string</b> <a id="e60f4064626a99c8" href="../../../R/e60f4064626a99c8.html" target="n" data-glyph="8,1" class="i field">NoProfile</a> = <span class="s">&quot;WINRS_NOPROFILE&quot;</span>;
        <b>internal const string</b> <a id="2d6e7db04e74d7e6" href="../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">CodePage</a> = <span class="s">&quot;WINRS_CODEPAGE&quot;</span>;
 
        <b>internal static readonly</b> <span class="i">Version</span> <a id="539e8394d77a27ad" href="../../../R/539e8394d77a27ad.html" target="n" data-glyph="44,1" class="i field">WSMAN_STACK_VERSION</a> = <b>new</b> <span class="i">Version</span>(3, 0);
 
        <b>internal const int</b> <a id="08cd612f4eb2ae04" href="../../../R/08cd612f4eb2ae04.html" target="n" data-glyph="8,1" class="i field">WSMAN_FLAG_REQUESTED_API_VERSION_1_1</a> = 1;
        <span class="c">// WSMan&#39;s default max env size in V2</span>
        <b>internal const int</b> <a id="872d3665c32b226b" href="../../../R/872d3665c32b226b.html" target="n" data-glyph="8,1" class="i field">WSMAN_DEFAULT_MAX_ENVELOPE_SIZE_KB_V2</a> = 150;
        <span class="c">// WSMan&#39;s default max env size in V3</span>
        <b>internal const int</b> <a id="7d7f974cfffbad2e" href="../../../R/7d7f974cfffbad2e.html" target="n" data-glyph="8,1" class="i field">WSMAN_DEFAULT_MAX_ENVELOPE_SIZE_KB_V3</a> = 500;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WSMan errors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The WinRM service cannot process the request because the request needs to be sent</span>
        <span class="c">///</span><span class="c"> to a different machine.</span>
        <span class="c">///</span><span class="c"> Use the redirect information to send the request to a new machine.</span>
        <span class="c">///</span><span class="c"> 0x8033819B from sdk\inc\wsmerror.h.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="325ee0cf8be4313d" href="../../../R/325ee0cf8be4313d.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_REDIRECT_REQUESTED</a> = -2144108135;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The WS-Management service cannot process the request. The resource URI is missing or</span>
        <span class="c">///</span><span class="c">  it has an incorrect format. Check the documentation or use the following command for</span>
        <span class="c">///</span><span class="c"> information on how to construct a resource URI: &quot;winrm help uris&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="873f5440df59bf59" href="../../../R/873f5440df59bf59.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_INVALID_RESOURCE_URI</a> = -2144108485;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The WinRM service cannon re-connect the session because the session is no longer</span>
        <span class="c">///</span><span class="c"> associated with this transportmanager object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="728972c090c1c619" href="../../../R/728972c090c1c619.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_INUSE_CANNOT_RECONNECT</a> = -2144108083;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sending data to a remote command failed with the following error message: The client</span>
        <span class="c">///</span><span class="c"> cannot connect to the destination specified in the request. Verify that the service on</span>
        <span class="c">///</span><span class="c"> the destination is running and is accepting requests. Consult the logs and documentation</span>
        <span class="c">///</span><span class="c"> for the WS-Management service running on the destination, most commonly IIS or WinRM.</span>
        <span class="c">///</span><span class="c"> If the destination is the WinRM service, run the following command on the destination to</span>
        <span class="c">///</span><span class="c"> analyze and configure the WinRM service:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="42bce97949b29c7f" href="../../../R/42bce97949b29c7f.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_SENDDATA_CANNOT_CONNECT</a> = -2144108526;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sending data to a remote command failed with the following error message: The WinRM client</span>
        <span class="c">///</span><span class="c"> cannot complete the operation within the time specified. Check if the machine name is valid</span>
        <span class="c">///</span><span class="c"> and is reachable over the network and firewall exception for Windows Remote Management service</span>
        <span class="c">///</span><span class="c"> is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="555c2ee01109d2c5" href="../../../R/555c2ee01109d2c5.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_SENDDATA_CANNOT_COMPLETE</a> = -2144108250;
 
        <b>internal const int</b> <a id="82b57076eb584d3d" href="../../../R/82b57076eb584d3d.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_ACCESS_DENIED</a> = 5;
 
        <b>internal const int</b> <a id="d8e793acb18b5bea" href="../../../R/d8e793acb18b5bea.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_OUTOF_MEMORY</a> = 14;
 
        <b>internal const int</b> <a id="35b0bb23bcf533fa" href="../../../R/35b0bb23bcf533fa.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_NETWORKPATH_NOTFOUND</a> = 53;
 
        <b>internal const int</b> <a id="f5c48d5d91b05694" href="../../../R/f5c48d5d91b05694.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_OPERATION_ABORTED</a> = 995;
 
        <b>internal const int</b> <a id="45acf66e937fc0ef" href="../../../R/45acf66e937fc0ef.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_SHUTDOWN_INPROGRESS</a> = 1115;
 
        <b>internal const int</b> <a id="4d26a09cbdc7f012" href="../../../R/4d26a09cbdc7f012.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_AUTHENTICATION_FAILED</a> = 1311;
 
        <b>internal const int</b> <a id="a0ae5d6e4abc9c12" href="../../../R/a0ae5d6e4abc9c12.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_NO_LOGON_SESSION_EXIST</a> = 1312;
 
        <b>internal const int</b> <a id="a9b4040111b34a6a" href="../../../R/a9b4040111b34a6a.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_LOGON_FAILURE</a> = 1326;
 
        <b>internal const int</b> <a id="0132dca2b19bdd62" href="../../../R/0132dca2b19bdd62.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_IMPROPER_RESPONSE</a> = 1722;
 
        <b>internal const int</b> <a id="8c946e459d470e8a" href="../../../R/8c946e459d470e8a.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_INCORRECT_PROTOCOLVERSION</a> = -2141974624;
 
        <b>internal const int</b> <a id="2c82cad02e089372" href="../../../R/2c82cad02e089372.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_URL_NOTAVAILABLE</a> = -2144108269;
 
        <b>internal const int</b> <a id="eaef8781750617c5" href="../../../R/eaef8781750617c5.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_INVALID_AUTHENTICATION</a> = -2144108274;
 
        <b>internal const int</b> <a id="2a1ea5cefdac71dd" href="../../../R/2a1ea5cefdac71dd.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_CANNOT_CONNECT_INVALID</a> = -2144108080;
 
        <b>internal const int</b> <a id="45e3dd7a9e1dc0b1" href="../../../R/45e3dd7a9e1dc0b1.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_CANNOT_CONNECT_MISMATCH</a> = -2144108090;
 
        <b>internal const int</b> <a id="6f925c7f5d59136c" href="../../../R/6f925c7f5d59136c.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_CANNOT_CONNECT_RUNASFAILED</a> = -2144108065;
 
        <b>internal const int</b> <a id="6a3cd9a446731b73" href="../../../R/6a3cd9a446731b73.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_CREATEFAILED_INVALIDNAME</a> = -2144108094;
 
        <b>internal const int</b> <a id="1512da0c98e3c02b" href="../../../R/1512da0c98e3c02b.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_TARGETSESSION_DOESNOTEXIST</a> = -2144108453;
 
        <b>internal const int</b> <a id="196d3ce1cc2abbfb" href="../../../R/196d3ce1cc2abbfb.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_REMOTESESSION_DISALLOWED</a> = -2144108116;
 
        <b>internal const int</b> <a id="80b0dbc890333302" href="../../../R/80b0dbc890333302.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_REMOTECONNECTION_DISALLOWED</a> = -2144108061;
 
        <b>internal const int</b> <a id="2e5ed187321ea631" href="../../../R/2e5ed187321ea631.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_INVALID_RESOURCE_URI2</a> = -2144108542;
 
        <b>internal const int</b> <a id="d5c5dbbc9890fffa" href="../../../R/d5c5dbbc9890fffa.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_CORRUPTED_CONFIG</a> = -2144108539;
 
        <b>internal const int</b> <a id="07f57c582b7352a5" href="../../../R/07f57c582b7352a5.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_URI_LIMIT</a> = -2144108499;
 
        <b>internal const int</b> <a id="7fc0ec817cc483d5" href="../../../R/7fc0ec817cc483d5.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_CLIENT_KERBEROS_DISABLED</a> = -2144108318;
 
        <b>internal const int</b> <a id="e682f38cfa33c666" href="../../../R/e682f38cfa33c666.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_SERVER_NOTTRUSTED</a> = -2144108316;
 
        <b>internal const int</b> <a id="63c8fb55bc487132" href="../../../R/63c8fb55bc487132.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_WORKGROUP_NO_KERBEROS</a> = -2144108276;
 
        <b>internal const int</b> <a id="86098acc10c452c1" href="../../../R/86098acc10c452c1.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_EXPLICIT_CREDENTIALS_REQUIRED</a> = -2144108315;
 
        <b>internal const int</b> <a id="99934ed715345df2" href="../../../R/99934ed715345df2.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_REDIRECT_LOCATION_INVALID</a> = -2144108105;
 
        <b>internal const int</b> <a id="9ef6648eb121e23d" href="../../../R/9ef6648eb121e23d.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_BAD_METHOD</a> = -2144108428;
 
        <b>internal const int</b> <a id="d27141b364d9bc76" href="../../../R/d27141b364d9bc76.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_HTTP_SERVICE_UNAVAILABLE</a> = -2144108270;
 
        <b>internal const int</b> <a id="4ea7a2b87f034192" href="../../../R/4ea7a2b87f034192.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_HTTP_SERVICE_ERROR</a> = -2144108176;
 
        <b>internal const int</b> <a id="1c0864d326b8093c" href="../../../R/1c0864d326b8093c.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_COMPUTER_NOTFOUND</a> = -2144108103;
 
        <b>internal const int</b> <a id="7c2a80911e288063" href="../../../R/7c2a80911e288063.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_TARGET_UNKNOWN</a> = -2146893053;
 
        <b>internal const int</b> <a id="aa6c836ce5b7cf58" href="../../../R/aa6c836ce5b7cf58.html" target="n" data-glyph="8,1" class="i field">ERROR_WSMAN_CANNOTUSE_IP</a> = -2144108101;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> MarshalledObject
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A struct holding marshalled data (IntPtr). This is</span>
        <span class="c">///</span><span class="c"> created to supply IDisposable pattern to safely</span>
        <span class="c">///</span><span class="c"> release the unmanaged pointer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal struct</b> <a id="b1daf795a3f58778" href="../../../R/b1daf795a3f58778.html" target="n" data-glyph="110,1" class="t t"><span id="85a3699e78c81d14">MarshalledObject</span></a> : <span class="i">IDisposable</span>
        {
            <b>private</b> <span class="i">IntPtr</span> <a id="f50257079e8d99b6" href="../../../R/f50257079e8d99b6.html" target="n" data-glyph="46,2" class="i field">_dataPtr</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs a MarshalledObject with the supplied</span>
            <span class="c">///</span><span class="c"> ptr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">dataPtr</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="be6fb4fb6da35552" href="../../../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">MarshalledObject</a>(<span class="i">IntPtr</span> <span id="r0 rd" class="r0 r">dataPtr</span>)
            {
                <a href="#f50257079e8d99b6" class="i field">_dataPtr</a> = <span class="r0 r">dataPtr</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the unmanaged ptr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="bcf584319d6673a7" href="../../../R/bcf584319d6673a7.html" target="n" data-glyph="104,2" class="i property">DataPtr</a> { <b>get</b> { <b>return</b> <a href="#f50257079e8d99b6" class="i field">_dataPtr</a>; } }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Creates a MarshalledObject for the specified object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Must be a value type.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">MarshalledObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="1add673d540690ed" href="../../../R/1add673d540690ed.html" target="n" data-glyph="74,2" class="i method">Create</a>&lt;<span id="r1 rd t" class="r1 r t">T</span>&gt;(<span class="r1 r t">T</span> <span id="r2 rd" class="r2 r">obj</span>)
            {
                <span class="i">IntPtr</span> <span id="r3 rd" class="r3 r">ptr</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<span class="r1 r t">T</span>&gt;());
                <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r2 r">obj</span>, <span class="r3 r">ptr</span>, <b>false</b>);
 
                <span class="c">// Now create the MarshalledObject and return.</span>
                <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <span id="r4 rd" class="r4 r">result</span> = <b>new</b> <span class="t">MarshalledObject</span>();
                <span class="r4 r">result</span>.<a href="#f50257079e8d99b6" class="i field">_dataPtr</a> = <span class="r3 r">ptr</span>;
 
                <b>return</b> <span class="r4 r">result</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Dispose the unmanaged IntPtr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public void</b> <a id="c8215c839d2c27ef" href="../../../R/c8215c839d2c27ef.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <b>if</b> (<a href="#f50257079e8d99b6" class="i field">_dataPtr</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<a href="#f50257079e8d99b6" class="i field">_dataPtr</a>);
                    <a href="#f50257079e8d99b6" class="i field">_dataPtr</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit cast to IntPtr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <span id="r5 rd" class="r5 r">obj</span>)
            {
                <b>return</b> <span class="r5 r">obj</span>.<a href="#f50257079e8d99b6" class="i field">_dataPtr</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WSMan_Authentication_Credentials
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Different Authentication Mechanisms supported by WSMan.</span>
        <span class="c">///</span><span class="c"> TODO: By the look of it, this appears like a Flags enum.</span>
        <span class="c">///</span><span class="c"> Need to confirm the behavior with WSMan.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Please keep in sync with WSManAuthenticationMechanism</span>
        <span class="c">///</span><span class="c"> from C:\e\win7_powershell\admin\monad\nttargets\assemblies\logging\ETW\Manifests\Microsoft-Windows-PowerShell-Instrumentation.man</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Flags</span>]
        <b>internal enum</b> <a id="242d5549ef0e4dbd" href="../../../R/242d5549ef0e4dbd.html" target="n" data-glyph="20,1" class="t t"><span id="863bd5eeee0dcb2d">WSManAuthenticationMechanism</span></a> : <b>int</b>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use the default authentication.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="5125eb68ec11fa36" href="../../../R/5125eb68ec11fa36.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_DEFAULT_AUTHENTICATION</a> = 0x0,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use no authentication for a remote operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="735018909d1987a3" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_NO_AUTHENTICATION</a> = 0x1,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use digest authentication for a remote operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="10e08ad953e87fcb" href="../../../R/10e08ad953e87fcb.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_AUTH_DIGEST</a> = 0x2,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use negotiate authentication for a remote operation (may use kerberos or ntlm)</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="61cf55ffef78b4ea" href="../../../R/61cf55ffef78b4ea.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_AUTH_NEGOTIATE</a> = 0x4,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use basic authentication for a remote operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="6b8867a7b5d205f8" href="../../../R/6b8867a7b5d205f8.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_AUTH_BASIC</a> = 0x8,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use kerberos authentication for a remote operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="94e632795727ce62" href="../../../R/94e632795727ce62.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_AUTH_KERBEROS</a> = 0x10,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use client certificate authentication for a remote operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="e531f725fb9318d3" href="../../../R/e531f725fb9318d3.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_AUTH_CLIENT_CERTIFICATE</a> = 0x20,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use CredSSP authentication for a remote operation.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="8dec40fd9e94f6a6" href="../../../R/8dec40fd9e94f6a6.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_AUTH_CREDSSP</a> = 0x80,
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is used to represent _WSMAN_AUTHENTICATION_CREDENTIALS</span>
        <span class="c">///</span><span class="c"> native structure. _WSMAN_AUTHENTICATION_CREDENTIALS has a union</span>
        <span class="c">///</span><span class="c"> member which cannot be easily represented in managed code.</span>
        <span class="c">///</span><span class="c"> So created an interface and each union member is represented</span>
        <span class="c">///</span><span class="c"> with a different structure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal abstract class</b> <a id="18d6c69c7828f052" href="../../../R/18d6c69c7828f052.html" target="n" data-glyph="2,1" class="t t"><span id="2112cd9d8f0bc64c">BaseWSManAuthenticationCredentials</span></a> : <span class="i">IDisposable</span>
        {
            <span class="c">// used to get Marshalled data of the class.</span>
            <b>public abstract</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="19c31f0d2396c294" href="../../../R/19c31f0d2396c294.html" target="n" data-glyph="72,2" class="i method">GetMarshalledObject</a>();
 
            <b>public void</b> <a id="1189c74270c84e9b" href="../../../R/1189c74270c84e9b.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#d49a347ef43373ae" class="i method">Dispose</a>(<b>true</b>);
                <span class="i n">System</span>.<span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#18d6c69c7828f052" class="k">this</a>);
            }
 
            <b>protected virtual void</b> <a id="d49a347ef43373ae" href="../../../R/d49a347ef43373ae.html" target="n" data-glyph="75,2" class="i method">Dispose</a>(<b>bool</b> <span id="r6 rd" class="r6 r">isDisposing</span>)
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to supply _WSMAN_USERNAME_PASSWORD_CREDS type credentials for</span>
        <span class="c">///</span><span class="c"> WSManCreateSession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="ca42a41ca9a4cabc" href="../../../R/ca42a41ca9a4cabc.html" target="n" data-glyph="2,1" class="t t">WSManUserNameAuthenticationCredentials</a> : <a href="#18d6c69c7828f052" class="t t">BaseWSManAuthenticationCredentials</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>internal struct</b> <a id="756468af10a6211d" href="../../../R/756468af10a6211d.html" target="n" data-glyph="110,2" class="t t"><span id="3f21d4298d39cace">WSManUserNameCredentialStruct</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <a href="#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a> <a id="e04efa243fc5d61e" href="../../../R/e04efa243fc5d61e.html" target="n" data-glyph="44,3" class="i field">authenticationMechanism</a>;
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="85c0a8a31a8458f7" href="../../../R/85c0a8a31a8458f7.html" target="n" data-glyph="44,3" class="i field">userName</a>;
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Making password secure.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
                <b>internal</b> <span class="i">IntPtr</span> <a id="c01e086624d9e93d" href="../../../R/c01e086624d9e93d.html" target="n" data-glyph="44,3" class="i field">password</a>;
            }
 
            <b>private</b> <a href="#756468af10a6211d" class="t t">WSManUserNameCredentialStruct</a> <a id="257086e936b39cf7" href="../../../R/257086e936b39cf7.html" target="n" data-glyph="46,2" class="i field">_cred</a>;
            <b>private</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="c4217cceccdea493" href="../../../R/c4217cceccdea493.html" target="n" data-glyph="46,2" class="i field">_data</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Default constructor.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a id="b1d1060295c44e64" href="../../../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">WSManUserNameAuthenticationCredentials</a>()
            {
                <a href="#257086e936b39cf7" class="i field">_cred</a> = <b>new</b> <span class="t">WSManUserNameCredentialStruct</span>();
                <a href="#c4217cceccdea493" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#756468af10a6211d" class="t t">WSManUserNameCredentialStruct</a>&gt;(<a href="#257086e936b39cf7" class="i field">_cred</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs an WSManUserNameAuthenticationCredentials object.</span>
            <span class="c">///</span><span class="c"> It is upto the caller to verify if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span>
            <span class="c">///</span><span class="c"> and </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">pwd</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> are valid. This API wont complain</span>
            <span class="c">///</span><span class="c"> if they are Empty or Null.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> user name.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">pwd</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> password.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">authMechanism</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> can be 0 (the user did not specify an authentication mechanism,</span>
            <span class="c">///</span><span class="c"> WSMan client will choose between Kerberos and Negotiate only);</span>
            <span class="c">///</span><span class="c"> if it is not 0, it must be one of the values from</span>
            <span class="c">///</span><span class="c"> WSManAuthenticationMechanism enumeration.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="177e40f039b80130" href="../../../R/177e40f039b80130.html" target="n" data-glyph="74,2" class="t constructor">WSManUserNameAuthenticationCredentials</a>(<b>string</b> <span id="r7 rd" class="r7 r">name</span>,
                <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecureString</span> <span id="r8 rd" class="r8 r">pwd</span>, <a href="#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a> <span id="r9 rd" class="r9 r">authMechanism</span>)
            {
                <a href="#257086e936b39cf7" class="i field">_cred</a> = <b>new</b> <span class="t">WSManUserNameCredentialStruct</span>();
                <a href="#257086e936b39cf7" class="i field">_cred</a>.<a href="#e04efa243fc5d61e" class="i field">authenticationMechanism</a> = <span class="r9 r">authMechanism</span>;
                <a href="#257086e936b39cf7" class="i field">_cred</a>.<a href="#85c0a8a31a8458f7" class="i field">userName</a> = <span class="r7 r">name</span>;
                <b>if</b> (<span class="r8 r">pwd</span> != <b>null</b>)
                {
                    <a href="#257086e936b39cf7" class="i field">_cred</a>.<a href="#c01e086624d9e93d" class="i field">password</a> = <span class="i">Marshal</span>.<span class="i">SecureStringToCoTaskMemUnicode</span>(<span class="r8 r">pwd</span>);
                }
 
                <a href="#c4217cceccdea493" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#756468af10a6211d" class="t t">WSManUserNameCredentialStruct</a>&gt;(<a href="#257086e936b39cf7" class="i field">_cred</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets a structure representation (used for marshalling)</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a href="#756468af10a6211d" class="t t">WSManUserNameCredentialStruct</a> <a id="88657ec08757620f" href="../../../R/88657ec08757620f.html" target="n" data-glyph="104,2" class="i property">CredentialStruct</a>
            {
                <b>get</b> { <b>return</b> <a href="#257086e936b39cf7" class="i field">_cred</a>; }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Marshalled Data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public override</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="a996afaa0a9b5280" href="../../../R/a996afaa0a9b5280.html" target="n" data-glyph="72,2" class="i method">GetMarshalledObject</a>()
            {
                <b>return</b> <a href="#c4217cceccdea493" class="i field">_data</a>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Dispose of the resources.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">isDisposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>protected override void</b> <a id="7bd567d00c93f899" href="../../../R/7bd567d00c93f899.html" target="n" data-glyph="75,2" class="i method">Dispose</a>(<b>bool</b> <span id="r10 rd" class="r10 r">isDisposing</span>)
            {
                <b>if</b> (<a href="#257086e936b39cf7" class="i field">_cred</a>.<a href="#c01e086624d9e93d" class="i field">password</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="i">Marshal</span>.<span class="i">ZeroFreeCoTaskMemUnicode</span>(<a href="#257086e936b39cf7" class="i field">_cred</a>.<a href="#c01e086624d9e93d" class="i field">password</a>);
                    <a href="#257086e936b39cf7" class="i field">_cred</a>.<a href="#c01e086624d9e93d" class="i field">password</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
 
                <a href="#c4217cceccdea493" class="i field">_data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="6904db51ad25a2d6" href="../../../R/6904db51ad25a2d6.html" target="n" data-glyph="2,1" class="t t">WSManCertificateThumbprintCredentials</a> : <a href="#18d6c69c7828f052" class="t t">BaseWSManAuthenticationCredentials</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="623495ea44cc12cf" href="../../../R/623495ea44cc12cf.html" target="n" data-glyph="112,2" class="t t"><span id="d26af6577a2477cd">WSManThumbprintStruct</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <a href="#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a> <a id="f0689c68bd5f57e7" href="../../../R/f0689c68bd5f57e7.html" target="n" data-glyph="44,3" class="i field">authenticationMechanism</a>;
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="5d99b5826816bddf" href="../../../R/5d99b5826816bddf.html" target="n" data-glyph="44,3" class="i field">certificateThumbprint</a>;
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> This is provided for padding as underlying WSMan&#39;s implementation</span>
                <span class="c">///</span><span class="c"> uses a union, we need to pad up unused fields.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <span class="i">IntPtr</span> <a id="f30667ddd70ff80a" href="../../../R/f30667ddd70ff80a.html" target="n" data-glyph="44,3" class="i field">reserved</a>;
            }
 
            <b>private</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="03489e52839569d5" href="../../../R/03489e52839569d5.html" target="n" data-glyph="46,2" class="i field">_data</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs an WSManCertificateThumbprintCredentials object.</span>
            <span class="c">///</span><span class="c"> It is upto the caller to verify if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">thumbPrint</span><span class="c">&quot;</span><span class="c">/&gt;</span>
            <span class="c">///</span><span class="c"> is valid. This API wont complain if it is Empty or Null.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">thumbPrint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="a14cc31a651aa753" href="../../../R/a14cc31a651aa753.html" target="n" data-glyph="74,2" class="t constructor">WSManCertificateThumbprintCredentials</a>(<b>string</b> <span id="r11 rd" class="r11 r">thumbPrint</span>)
            {
                <a href="#623495ea44cc12cf" class="t t">WSManThumbprintStruct</a> <span id="r12 rd" class="r12 r">cred</span> = <b>new</b> <span class="t">WSManThumbprintStruct</span>();
                <span class="r12 r">cred</span>.<a href="#f0689c68bd5f57e7" class="i field">authenticationMechanism</a> = <a href="#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="#e531f725fb9318d3" class="i field">WSMAN_FLAG_AUTH_CLIENT_CERTIFICATE</a>;
                <span class="r12 r">cred</span>.<a href="#5d99b5826816bddf" class="i field">certificateThumbprint</a> = <span class="r11 r">thumbPrint</span>;
                <span class="r12 r">cred</span>.<a href="#f30667ddd70ff80a" class="i field">reserved</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
                <a href="#03489e52839569d5" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#623495ea44cc12cf" class="t t">WSManThumbprintStruct</a>&gt;(<span class="r12 r">cred</span>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Marshalled Data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public override</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="6d54716da235ae90" href="../../../R/6d54716da235ae90.html" target="n" data-glyph="72,2" class="i method">GetMarshalledObject</a>()
            {
                <b>return</b> <a href="#03489e52839569d5" class="i field">_data</a>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Dispose of the resources.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">isDisposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>protected override void</b> <a id="71aded06482237eb" href="../../../R/71aded06482237eb.html" target="n" data-glyph="75,2" class="i method">Dispose</a>(<b>bool</b> <span id="r13 rd" class="r13 r">isDisposing</span>)
            {
                <span class="c">// data is of struct type..so there is no need to set it to null..</span>
                <a href="#03489e52839569d5" class="i field">_data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WSMan Session Options
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enum representing native WSManSessionOption enum.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="f99c2939972a9aca" href="../../../R/f99c2939972a9aca.html" target="n" data-glyph="20,1" class="t t"><span id="2873871110953858">WSManSessionOption</span></a> : <b>int</b>
        {
            <span class="k preprocess">#</span><span class="k preprocess">region</span> TimeOuts
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - default timeout in ms that applies to all operations on the client side.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="492be0cc81133200" href="../../../R/492be0cc81133200.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_DEFAULT_OPERATION_TIMEOUTMS</a> = 1,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - Robust connection maximum retry time in minutes.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="45f9c56020c5e09e" href="../../../R/45f9c56020c5e09e.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_MAX_RETRY_TIME</a> = 11,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - timeout in ms for WSManCreateShellEx operations.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="3d5e40670c495e56" href="../../../R/3d5e40670c495e56.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_TIMEOUTMS_CREATE_SHELL</a> = 12,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - timeout in ms for WSManReceiveShellOutputEx operations.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="2cabe7c172f06d78" href="../../../R/2cabe7c172f06d78.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_TIMEOUTMS_RECEIVE_SHELL_OUTPUT</a> = 14,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - timeout in ms for WSManSendShellInputEx operations.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="78cf29445ec34e66" href="../../../R/78cf29445ec34e66.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_TIMEOUTMS_SEND_SHELL_INPUT</a> = 15,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - timeout in ms for WSManSignalShellEx operations.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="6dd1d3290294bc97" href="../../../R/6dd1d3290294bc97.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_TIMEOUTMS_SIGNAL_SHELL</a> = 16,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - timeout in ms for WSManCloseShellOperationEx operations.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="d852effe02fa00b5" href="../../../R/d852effe02fa00b5.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_TIMEOUTMS_CLOSE_SHELL_OPERATION</a> = 17,
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Connection Options
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - 1 to not validate the CA on the server certificate; 0 - default.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="9bb2c1422542a0b1" href="../../../R/9bb2c1422542a0b1.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_SKIP_CA_CHECK</a> = 18,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - 1 to not validate the CN on the server certificate; 0 - default.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="1842c57f2189449c" href="../../../R/1842c57f2189449c.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_SKIP_CN_CHECK</a> = 19,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - 1 to not encrypt the messages; 0 - default.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="682b5cda7c47ebc2" href="../../../R/682b5cda7c47ebc2.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_UNENCRYPTED_MESSAGES</a> = 20,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - 1 Send all network packets for remote operations in UTF16; 0 - default is UTF8.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="6b332062cfd1d39b" href="../../../R/6b332062cfd1d39b.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_UTF16</a> = 21,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - 1 When using negotiate, include port number in the connection SPN; 0 - default.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="cd747326c0c441a9" href="../../../R/cd747326c0c441a9.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_ENABLE_SPN_SERVER_PORT</a> = 22,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - Used when not talking to the main OS on a machine but, for instance, a BMC</span>
            <span class="c">///</span><span class="c"> 1 Identify this machine to the server by including the MachineID header; 0 - default.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="02189a23dac5b7eb" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_MACHINE_ID</a> = 23,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int -1 Enables host process to be created with interactive token.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="e758736b6303adc4" href="../../../R/e758736b6303adc4.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_USE_INTERACTIVE_TOKEN</a> = 34,
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Locale
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> String - RFC 3066 language code.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="9ca39a3c5ba172e0" href="../../../R/9ca39a3c5ba172e0.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_LOCALE</a> = 25,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> String - RFC 3066 language code.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="3b30ca6e4a23d15d" href="../../../R/3b30ca6e4a23d15d.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_UI_LANGUAGE</a> = 26,
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Other
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int - max SOAP envelope size (kb) - default 150kb from winrm config</span>
            <span class="c">///</span><span class="c"> (see &#39;winrm help config&#39; for more details); the client SOAP packet size cannot surpass</span>
            <span class="c">///</span><span class="c"> this value; this value will be also sent to the server in the SOAP request as a</span>
            <span class="c">///</span><span class="c"> MaxEnvelopeSize header; the server will use min(MaxEnvelopeSizeKb from server configuration,</span>
            <span class="c">///</span><span class="c"> MaxEnvelopeSize value from SOAP).</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="647b2be6813d80f2" href="../../../R/647b2be6813d80f2.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_MAX_ENVELOPE_SIZE_KB</a> = 28,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Int (read only) - max data size (kb) provided by the client, guaranteed by</span>
            <span class="c">///</span><span class="c"> the winrm client implementation to fit into one SOAP packet; this is an</span>
            <span class="c">///</span><span class="c"> approximate value calculated based on the WSMAN_OPTION_MAX_ENVELOPE_SIZE_KB (default 150kb),</span>
            <span class="c">///</span><span class="c"> the maximum possible size of the SOAP headers and the overhead of the base64</span>
            <span class="c">///</span><span class="c"> encoding which is specific to WSManSendShellInput API; this option can be used</span>
            <span class="c">///</span><span class="c"> with WSManGetSessionOptionAsDword API; it cannot be used with WSManSetSessionOption API.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="6b4f7c20bd03908e" href="../../../R/6b4f7c20bd03908e.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_SHELL_MAX_DATA_SIZE_PER_MESSAGE_KB</a> = 29,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> String -</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="485c49ad2544b4d7" href="../../../R/485c49ad2544b4d7.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_REDIRECT_LOCATION</a> = 30,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> DWORD  - 1 to not validate the revocation status on the server certificate; 0 - default.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="917997fc614eb38d" href="../../../R/917997fc614eb38d.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_SKIP_REVOCATION_CHECK</a> = 31,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> DWORD  - 1 to allow default credentials for Negotiate (this is for SSL only); 0 - default.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="c297eccf1cf6f818" href="../../../R/c297eccf1cf6f818.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_ALLOW_NEGOTIATE_IMPLICIT_CREDENTIALS</a> = 32,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> DWORD - When using just a machine name in the connection string use an SSL connection.</span>
            <span class="c">///</span><span class="c"> 0 means HTTP, 1 means HTTPS.  Default is 0.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="c747db8d211a9fff" href="../../../R/c747db8d211a9fff.html" target="n" data-glyph="24,2" class="i field">WSMAN_OPTION_USE_SSL</a> = 33
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enum representing WSMan Shell specific options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="98f13b30e065a9d0" href="../../../R/98f13b30e065a9d0.html" target="n" data-glyph="20,1" class="t t"><span id="5135833d309c1e32">WSManShellFlag</span></a> : <b>int</b>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Turn off compression for Send/Receive operations.  By default compression is</span>
            <span class="c">///</span><span class="c"> turned on, but if communicating with a down-level box it may be necessary to</span>
            <span class="c">///</span><span class="c"> do this.  Other reasons for turning it off is due to the extra memory consumption</span>
            <span class="c">///</span><span class="c"> and CPU utilization that is used as a result of compression.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="0c7c3687b1134ef9" href="../../../R/0c7c3687b1134ef9.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_NO_COMPRESSION</a> = 1,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Enable the service to drop operation output when running disconnected.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="c8402e04328c3ada" href="../../../R/c8402e04328c3ada.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_SERVER_BUFFERING_MODE_DROP</a> = 0x4,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Enable the service to block operation progress when output buffers are full.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="1b56d88e8fd4e4f2" href="../../../R/1b56d88e8fd4e4f2.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_SERVER_BUFFERING_MODE_BLOCK</a> = 0x8,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Enable receive call to not immediately retrieve results. Only applicable for Receive calls on commands.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="63c59446a96201e5" href="../../../R/63c59446a96201e5.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_RECEIVE_DELAY_OUTPUT_STREAM</a> = 0X10
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WSManData
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Types of supported WSMan data.</span>
        <span class="c">///</span><span class="c"> PowerShell uses only Text and DWORD (in some places).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="46ddd0c66b953490" href="../../../R/46ddd0c66b953490.html" target="n" data-glyph="20,1" class="t t"><span id="7e6870a249a694d9">WSManDataType</span></a> : <b>uint</b>
        {
            <a id="4a6e16adf18aa4ed" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WSMAN_DATA_NONE</a> = 0,
            <a id="1a9738dd5816811e" href="../../../R/1a9738dd5816811e.html" target="n" data-glyph="24,2" class="i field">WSMAN_DATA_TYPE_TEXT</a> = 1,
            <a id="a68a60c7335805ed" href="../../../R/a68a60c7335805ed.html" target="n" data-glyph="24,2" class="i field">WSMAN_DATA_TYPE_BINARY</a> = 2,
            <a id="8607480ba87a0ca1" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WSMAN_DATA_TYPE_WS_XML_READER</a> = 3,
            <a id="ed1bf44e45279f4a" href="../../../R/ed1bf44e45279f4a.html" target="n" data-glyph="24,2" class="i field">WSMAN_DATA_TYPE_DWORD</a> = 4
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal class</b> <a id="5c14c561aee60b63" href="../../../R/5c14c561aee60b63.html" target="n" data-glyph="2,1" class="t t"><span id="3efe25d48dbd506e">WSManDataStruct</span></a>
        {
            <b>internal uint</b> <a id="a93acd5406c237f5" href="../../../R/a93acd5406c237f5.html" target="n" data-glyph="44,2" class="i field">type</a>;
            <b>internal</b> <a href="#a9c8502c49e163fe" class="t t">WSManBinaryOrTextDataStruct</a> <a id="34e072ff69544bf9" href="../../../R/34e072ff69544bf9.html" target="n" data-glyph="44,2" class="i field">binaryOrTextData</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal class</b> <a id="a9c8502c49e163fe" href="../../../R/a9c8502c49e163fe.html" target="n" data-glyph="2,1" class="t t"><span id="1efb6380e3fb4f6f">WSManBinaryOrTextDataStruct</span></a>
        {
            <b>internal int</b> <a id="07c95733818ca99d" href="../../../R/07c95733818ca99d.html" target="n" data-glyph="44,2" class="i field">bufferLength</a>;
 
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
            <b>internal</b> <span class="i">IntPtr</span> <a id="eb5820681404d5e4" href="../../../R/eb5820681404d5e4.html" target="n" data-glyph="44,2" class="i field">data</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to supply WSMAN_DATA_BINARY/WSMAN_DATA_TEXT type in place of _WSMAN_DATA.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="c08fd7c84904da7c" href="../../../R/c08fd7c84904da7c.html" target="n" data-glyph="2,1" class="t t">WSManData_ManToUn</a> : <span class="i">IDisposable</span>
        {
            <b>private readonly</b> <a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a> <a id="2d1da18c5166bab9" href="../../../R/2d1da18c5166bab9.html" target="n" data-glyph="46,2" class="i field">_internalData</a>;
 
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
            <b>private</b> <span class="i">IntPtr</span> <a id="3330cdd3941629bd" href="../../../R/3330cdd3941629bd.html" target="n" data-glyph="46,2" class="i field">_marshalledObject</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
            <b>private</b> <span class="i">IntPtr</span> <a id="2520d3e208b7e9c2" href="../../../R/2520d3e208b7e9c2.html" target="n" data-glyph="46,2" class="i field">_marshalledBuffer</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs a WSMAN_DATA_BINARY object. This is used to send</span>
            <span class="c">///</span><span class="c"> data to remote end.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="53bab55b828c8016" href="../../../R/53bab55b828c8016.html" target="n" data-glyph="74,2" class="t constructor">WSManData_ManToUn</a>(<b>byte</b>[] <span id="r14 rd" class="r14 r">data</span>)
            {
                <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r14 r">data</span> != <b>null</b>, <span class="s">&quot;Data cannot be null&quot;</span>);
 
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a> = <b>new</b> <span class="t">WSManDataStruct</span>();
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a> = <b>new</b> <span class="t">WSManBinaryOrTextDataStruct</span>();
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a> = <span class="r14 r">data</span>.<span class="i">Length</span>;
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#a93acd5406c237f5" class="i field">type</a> = (<b>uint</b>)<a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#a68a60c7335805ed" class="i field">WSMAN_DATA_TYPE_BINARY</a>;
 
                <span class="i">IntPtr</span> <span id="r15 rd" class="r15 r">dataToSendPtr</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a>);
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#eb5820681404d5e4" class="i field">data</a> = <span class="r15 r">dataToSendPtr</span>;
                <a href="#2520d3e208b7e9c2" class="i field">_marshalledBuffer</a> = <span class="r15 r">dataToSendPtr</span>; <span class="c">// Stored directly to enable graceful clean up during finalizer scenarios</span>
 
                <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r14 r">data</span>, 0, <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#eb5820681404d5e4" class="i field">data</a>, <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a>);
                <a href="#3330cdd3941629bd" class="i field">_marshalledObject</a> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a>&gt;());
                <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<a href="#2d1da18c5166bab9" class="i field">_internalData</a>, <a href="#3330cdd3941629bd" class="i field">_marshalledObject</a>, <b>false</b>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs a WSMAN_DATA_TEXT object. This is used to send data</span>
            <span class="c">///</span><span class="c"> to remote end.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="52cf8f7c05242097" href="../../../R/52cf8f7c05242097.html" target="n" data-glyph="74,2" class="t constructor">WSManData_ManToUn</a>(<b>string</b> <span id="r16 rd" class="r16 r">data</span>)
            {
                <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r16 r">data</span> != <b>null</b>, <span class="s">&quot;Data cannot be null&quot;</span>);
 
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a> = <b>new</b> <span class="t">WSManDataStruct</span>();
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a> = <b>new</b> <span class="t">WSManBinaryOrTextDataStruct</span>();
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a> = <span class="r16 r">data</span>.<span class="i">Length</span>;
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#a93acd5406c237f5" class="i field">type</a> = (<b>uint</b>)<a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#1a9738dd5816811e" class="i field">WSMAN_DATA_TYPE_TEXT</a>;
 
                <span class="c">// marshal text data</span>
                <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#eb5820681404d5e4" class="i field">data</a> = <span class="i">Marshal</span>.<span class="i">StringToHGlobalUni</span>(<span class="r16 r">data</span>);
                <a href="#2520d3e208b7e9c2" class="i field">_marshalledBuffer</a> = <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#eb5820681404d5e4" class="i field">data</a>; <span class="c">// Stored directly to enable graceful clean up during finalizer scenarios</span>
                <a href="#3330cdd3941629bd" class="i field">_marshalledObject</a> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a>&gt;());
                <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<a href="#2d1da18c5166bab9" class="i field">_internalData</a>, <a href="#3330cdd3941629bd" class="i field">_marshalledObject</a>, <b>false</b>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the type of data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal uint</b> <a id="63b8f1ffd10282ad" href="../../../R/../../0000000000.html" target="n" data-glyph="104,2" class="i property">Type</a>
            {
                <b>get</b> { <b>return</b> <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#a93acd5406c237f5" class="i field">type</a>; }
 
                <b>set</b> { <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#a93acd5406c237f5" class="i field">type</a> = <b>value</b>; }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the buffer length of data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal int</b> <a id="47798822d606f221" href="../../../R/47798822d606f221.html" target="n" data-glyph="104,2" class="i property">BufferLength</a>
            {
                <b>get</b> { <b>return</b> <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a>; }
 
                <b>set</b> { <a href="#2d1da18c5166bab9" class="i field">_internalData</a>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a> = <b>value</b>; }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Free unmanaged resources. All users of this class should call Dispose rather than</span>
            <span class="c">///</span><span class="c"> depending on the finalizer to clean it up.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public void</b> <a id="a723a8d748579007" href="../../../R/a723a8d748579007.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#923ee29dd4acf540" class="i method">Dispose</a>(<b>true</b>);
                <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#c08fd7c84904da7c" class="k">this</a>);
            }
 
            <b>private void</b> <a id="923ee29dd4acf540" href="../../../R/923ee29dd4acf540.html" target="n" data-glyph="76,2" class="i method">Dispose</a>(<b>bool</b> <span id="r17 rd" class="r17 r">isDisposing</span>)
            {
                <span class="c">// Managed objects should not be deleted when this is called via the finalizer</span>
                <span class="c">// because they may have been collected already. To prevent leaking the marshalledBuffer</span>
                <span class="c">// pointer, we are storing its value as a private member of the class, just like marshalledObject.</span>
                <b>if</b> (<a href="#2520d3e208b7e9c2" class="i field">_marshalledBuffer</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<a href="#2520d3e208b7e9c2" class="i field">_marshalledBuffer</a>);
                    <a href="#2520d3e208b7e9c2" class="i field">_marshalledBuffer</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
 
                <b>if</b> (<a href="#3330cdd3941629bd" class="i field">_marshalledObject</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<a href="#3330cdd3941629bd" class="i field">_marshalledObject</a>);
                    <a href="#3330cdd3941629bd" class="i field">_marshalledObject</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Finalizes an instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c08fd7c84904da7c" class="t t">WSManData_ManToUn</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            ~<a id="1106dda13edfc2de" href="../../../R/../../0000000000.html" target="n" data-glyph="75,2" class="t method">WSManData_ManToUn</a>()
            {
                <a href="#923ee29dd4acf540" class="i method">Dispose</a>(<b>false</b>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit IntPtr conversion.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#c08fd7c84904da7c" class="t t">WSManData_ManToUn</a> <span id="r18 rd" class="r18 r">data</span>)
            {
                <b>if</b> (<span class="r18 r">data</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r18 r">data</span>.<a href="#3330cdd3941629bd" class="i field">_marshalledObject</a>;
                }
                <b>else</b>
                {
                    <b>return</b> <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
            }
        }
 
        <b>internal class</b> <a id="456a9677b88cb3ef" href="../../../R/456a9677b88cb3ef.html" target="n" data-glyph="2,1" class="t t"><span id="bb674f1ea9a7ab88">WSManData_UnToMan</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the type of data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private uint</b> <a id="ca85aaf70467ac53" href="../../../R/ca85aaf70467ac53.html" target="n" data-glyph="46,2" class="i field">_type</a>;
 
            <b>internal uint</b> <a id="1e7e9090a55ed442" href="../../../R/1e7e9090a55ed442.html" target="n" data-glyph="104,2" class="i property">Type</a>
            {
                <b>get</b> { <b>return</b> <a href="#ca85aaf70467ac53" class="i field">_type</a>; }
 
                <b>set</b> { <a href="#ca85aaf70467ac53" class="i field">_type</a> = <b>value</b>; }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the buffer length of data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private int</b> <a id="78c335f3bf9d0077" href="../../../R/78c335f3bf9d0077.html" target="n" data-glyph="46,2" class="i field">_bufferLength</a>;
 
            <b>internal int</b> <a id="7160ab05bbb23dad" href="../../../R/../../0000000000.html" target="n" data-glyph="104,2" class="i property">BufferLength</a>
            {
                <b>get</b> { <b>return</b> <a href="#78c335f3bf9d0077" class="i field">_bufferLength</a>; }
 
                <b>set</b> { <a href="#78c335f3bf9d0077" class="i field">_bufferLength</a> = <b>value</b>; }
            }
 
            <b>private string</b> <a id="a72049591fd65ed0" href="../../../R/a72049591fd65ed0.html" target="n" data-glyph="46,2" class="i field">_text</a>;
 
            <b>internal string</b> <a id="ed072da1616e6b8a" href="../../../R/ed072da1616e6b8a.html" target="n" data-glyph="104,2" class="i property">Text</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#456a9677b88cb3ef" class="k">this</a>.<a href="#1e7e9090a55ed442" class="i property">Type</a> == (<b>uint</b>)<a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#1a9738dd5816811e" class="i field">WSMAN_DATA_TYPE_TEXT</a>)
                        <b>return</b> <a href="#a72049591fd65ed0" class="i field">_text</a>;
                    <b>else</b>
                        <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
            }
 
            <b>private byte</b>[] <a id="669202444b7eaa53" href="../../../R/669202444b7eaa53.html" target="n" data-glyph="46,2" class="i field">_data</a>;
 
            <b>internal byte</b>[] <a id="8b7f031c5fed73f4" href="../../../R/8b7f031c5fed73f4.html" target="n" data-glyph="104,2" class="i property">Data</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#456a9677b88cb3ef" class="k">this</a>.<a href="#1e7e9090a55ed442" class="i property">Type</a> == (<b>uint</b>)<a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#a68a60c7335805ed" class="i field">WSMAN_DATA_TYPE_BINARY</a>)
                        <b>return</b> <a href="#669202444b7eaa53" class="i field">_data</a>;
                    <b>else</b>
                        <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>byte</b>&gt;();
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged structure to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">dataStruct</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#456a9677b88cb3ef" class="t t">WSManData_UnToMan</a> <a id="35b6d766c359db6f" href="../../../R/35b6d766c359db6f.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a> <span id="r19 rd" class="r19 r">dataStruct</span>)
            {
                <a href="#456a9677b88cb3ef" class="t t">WSManData_UnToMan</a> <span id="r20 rd" class="r20 r">newData</span> = <b>new</b> <span class="t">WSManData_UnToMan</span>();
 
                <span class="r20 r">newData</span>.<a href="#ca85aaf70467ac53" class="i field">_type</a> = <span class="r19 r">dataStruct</span>.<a href="#a93acd5406c237f5" class="i field">type</a>;
                <span class="r20 r">newData</span>.<a href="#78c335f3bf9d0077" class="i field">_bufferLength</a> = <span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a>;
 
                <b>switch</b> (<span class="r19 r">dataStruct</span>.<a href="#a93acd5406c237f5" class="i field">type</a>)
                {
                    <b>case</b> (<b>uint</b>)<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#1a9738dd5816811e" class="i field">WSMAN_DATA_TYPE_TEXT</a>:
                        <b>if</b> (<span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a> &gt; 0)
                        {
                            <b>string</b> <span id="r21 rd" class="r21 r">tempText</span> = <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#eb5820681404d5e4" class="i field">data</a>, <span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a>);
                            <span class="r20 r">newData</span>.<a href="#a72049591fd65ed0" class="i field">_text</a> = <span class="r21 r">tempText</span>;
                        }
 
                        <b>break</b>;
                    <b>case</b> (<b>uint</b>)<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#a68a60c7335805ed" class="i field">WSMAN_DATA_TYPE_BINARY</a>:
                        <b>if</b> (<span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a> &gt; 0)
                        {
                            <span class="c">// copy data from unmanaged heap to managed heap.</span>
                            <b>byte</b>[] <span id="r22 rd" class="r22 r">dataRecvd</span> = <b>new</b> <b>byte</b>[<span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a>];
                            <span class="i">Marshal</span>.<span class="i">Copy</span>(
                                <span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#eb5820681404d5e4" class="i field">data</a>,
                                <span class="r22 r">dataRecvd</span>,
                                0,
                                <span class="r19 r">dataStruct</span>.<a href="#34e072ff69544bf9" class="i field">binaryOrTextData</a>.<a href="#07c95733818ca99d" class="i field">bufferLength</a>);
                            <span class="r20 r">newData</span>.<a href="#669202444b7eaa53" class="i field">_data</a> = <span class="r22 r">dataRecvd</span>;
                        }
 
                        <b>break</b>;
                    <b>default</b>:
                        <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
                }
 
                <b>return</b> <span class="r20 r">newData</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#456a9677b88cb3ef" class="t t">WSManData_UnToMan</a> <a id="9a40a81d687a8c04" href="../../../R/9a40a81d687a8c04.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r23 rd" class="r23 r">unmanagedData</span>)
            {
                <a href="#456a9677b88cb3ef" class="t t">WSManData_UnToMan</a> <span id="r24 rd" class="r24 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r23 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a> <span id="r25 rd" class="r25 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a>&gt;(<span class="r23 r">unmanagedData</span>);
                    <span class="r24 r">result</span> = <a href="#456a9677b88cb3ef" class="t t">WSManData_UnToMan</a>.<a href="#35b6d766c359db6f" class="i method">UnMarshal</a>(<span class="r25 r">resultInternal</span>);
                }
 
                <b>return</b> <span class="r24 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to supply a DWORD data in place of _WSMAN_DATA.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="4d2faff0872b41ab" href="../../../R/4d2faff0872b41ab.html" target="n" data-glyph="110,1" class="t t"><span id="0542d0745fc65a58">WSManDataDWord</span></a>
        {
            <b>private readonly</b> <a href="#46ddd0c66b953490" class="t t">WSManDataType</a> <a id="4e55e0ffe42cd5be" href="../../../R/4e55e0ffe42cd5be.html" target="n" data-glyph="46,2" class="i field">_type</a>;
            <b>private</b> <a href="#1e79a4cc90ea475b" class="t t">WSManDWordDataInternal</a> <a id="0abf7d521977e75b" href="../../../R/0abf7d521977e75b.html" target="n" data-glyph="46,2" class="i field">_dwordData</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs a WSMAN_DATA_DWORD object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="3355ebe78b09feca" href="../../../R/3355ebe78b09feca.html" target="n" data-glyph="74,2" class="t constructor">WSManDataDWord</a>(<b>int</b> <span id="r26 rd" class="r26 r">data</span>)
            {
                <a href="#0abf7d521977e75b" class="i field">_dwordData</a> = <b>new</b> <span class="t">WSManDWordDataInternal</span>();
                <a href="#0abf7d521977e75b" class="i field">_dwordData</a>.<a href="#bc9d0a8be517b2f5" class="i field">number</a> = <span class="r26 r">data</span>;
                <a href="#4e55e0ffe42cd5be" class="i field">_type</a> = <a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#ed1bf44e45279f4a" class="i field">WSMAN_DATA_TYPE_DWORD</a>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Creates an unmanaged ptr which holds the class data.</span>
            <span class="c">///</span><span class="c"> This unmanaged ptr can be used with WSMan native API.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="12d2ee289a545e7b" href="../../../R/12d2ee289a545e7b.html" target="n" data-glyph="74,2" class="i method">Marshal</a>()
            {
                <b>return</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#4d2faff0872b41ab" class="t t">WSManDataDWord</a>&gt;(<a href="#4d2faff0872b41ab" class="k">this</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> This struct is created to honor struct boundaries between</span>
            <span class="c">///</span><span class="c"> x86,amd64 and ia64. WSMan defines a generic WSMAN_DATA</span>
            <span class="c">///</span><span class="c"> structure that addresses DWORD, binary, text data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="1e79a4cc90ea475b" href="../../../R/1e79a4cc90ea475b.html" target="n" data-glyph="112,2" class="t t"><span id="eb5df66524b5e57d">WSManDWordDataInternal</span></a>
            {
                <b>internal int</b> <a id="bc9d0a8be517b2f5" href="../../../R/bc9d0a8be517b2f5.html" target="n" data-glyph="44,3" class="i field">number</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="46749e542726ad76" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">reserved</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WSManShellStartupInfo / WSManOptionSet / WSManCommandArgSet / WSManProxyInfo
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WSMan allows multiple streams within a shell but powershell is</span>
        <span class="c">///</span><span class="c"> using only 1 stream for input and 1 stream for output to allow</span>
        <span class="c">///</span><span class="c"> sequencing of data. Because of this the following structure will</span>
        <span class="c">///</span><span class="c"> have only one string to hold stream information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="65dc307010d2b536" href="../../../R/65dc307010d2b536.html" target="n" data-glyph="110,1" class="t t"><span id="72cb74f51c5e9194">WSManStreamIDSetStruct</span></a>
        {
            <b>internal int</b> <a id="0771393d07315d51" href="../../../R/0771393d07315d51.html" target="n" data-glyph="44,2" class="i field">streamIDsCount</a>;
 
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
            <b>internal</b> <span class="i">IntPtr</span> <a id="9240ca70d0c7d09d" href="../../../R/9240ca70d0c7d09d.html" target="n" data-glyph="44,2" class="i field">streamIDs</a>;
        }
 
        <b>internal struct</b> <a id="69baba050509e5fa" href="../../../R/69baba050509e5fa.html" target="n" data-glyph="110,1" class="t t"><span id="6b7f7ec4a907d90c">WSManStreamIDSet_ManToUn</span></a>
        {
            <b>private</b> <a href="#65dc307010d2b536" class="t t">WSManStreamIDSetStruct</a> <a id="bac57e00ddb0e830" href="../../../R/bac57e00ddb0e830.html" target="n" data-glyph="46,2" class="i field">_streamSetInfo</a>;
            <b>private</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="2052d9da61655511" href="../../../R/2052d9da61655511.html" target="n" data-glyph="46,2" class="i field">_data</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructor.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">streamIds</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="93cfa4fd7fab6a22" href="../../../R/93cfa4fd7fab6a22.html" target="n" data-glyph="74,2" class="t constructor">WSManStreamIDSet_ManToUn</a>(<b>string</b>[] <span id="r27 rd" class="r27 r">streamIds</span>)
            {
                <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r27 r">streamIds</span> != <b>null</b>, <span class="s">&quot;stream ids cannot be null or empty&quot;</span>);
 
                <b>int</b> <span id="r28 rd" class="r28 r">sizeOfIntPtr</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<span class="i">IntPtr</span>&gt;();
                <a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a> = <b>new</b> <span class="t">WSManStreamIDSetStruct</span>();
                <a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a> = <span class="r27 r">streamIds</span>.<span class="i">Length</span>;
                <a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#9240ca70d0c7d09d" class="i field">streamIDs</a> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<span class="r28 r">sizeOfIntPtr</span> * <span class="r27 r">streamIds</span>.<span class="i">Length</span>);
                <b>for</b> (<b>int</b> <span id="r29 rd" class="r29 r">index</span> = 0; <span class="r29 r">index</span> &lt; <span class="r27 r">streamIds</span>.<span class="i">Length</span>; <span class="r29 r">index</span>++)
                {
                    <span class="i">IntPtr</span> <span id="r30 rd" class="r30 r">streamAddress</span> = <span class="i">Marshal</span>.<span class="i">StringToHGlobalUni</span>(<span class="r27 r">streamIds</span>[<span class="r29 r">index</span>]);
                    <span class="i">Marshal</span>.<span class="i">WriteIntPtr</span>(<a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#9240ca70d0c7d09d" class="i field">streamIDs</a>, <span class="r29 r">index</span> * <span class="r28 r">sizeOfIntPtr</span>, <span class="r30 r">streamAddress</span>);
                }
 
                <a href="#2052d9da61655511" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#65dc307010d2b536" class="t t">WSManStreamIDSetStruct</a>&gt;(<a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Free resources.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal void</b> <a id="ba6d3ce48ff3247e" href="../../../R/ba6d3ce48ff3247e.html" target="n" data-glyph="74,2" class="i method">Dispose</a>()
            {
                <b>if</b> (<a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#9240ca70d0c7d09d" class="i field">streamIDs</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <b>int</b> <span id="r31 rd" class="r31 r">sizeOfIntPtr</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<span class="i">IntPtr</span>&gt;();
                    <b>for</b> (<b>int</b> <span id="r32 rd" class="r32 r">index</span> = 0; <span class="r32 r">index</span> &lt; <a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a>; <span class="r32 r">index</span>++)
                    {
                        <span class="i">IntPtr</span> <span id="r33 rd" class="r33 r">streamAddress</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                        <span class="r33 r">streamAddress</span> = <span class="i">Marshal</span>.<span class="i">ReadIntPtr</span>(<a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#9240ca70d0c7d09d" class="i field">streamIDs</a>, <span class="r32 r">index</span> * <span class="r31 r">sizeOfIntPtr</span>);
 
                        <b>if</b> (<span class="r33 r">streamAddress</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                        {
                            <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r33 r">streamAddress</span>);
                            <span class="r33 r">streamAddress</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                        }
                    }
 
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#9240ca70d0c7d09d" class="i field">streamIDs</a>);
                    <a href="#bac57e00ddb0e830" class="i field">_streamSetInfo</a>.<a href="#9240ca70d0c7d09d" class="i field">streamIDs</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
 
                <a href="#2052d9da61655511" class="i field">_data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit cast to IntPtr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#69baba050509e5fa" class="t t">WSManStreamIDSet_ManToUn</a> <span id="r34 rd" class="r34 r">obj</span>)
            {
                <b>return</b> <span class="r34 r">obj</span>.<a href="#2052d9da61655511" class="i field">_data</a>.<a href="#bcf584319d6673a7" class="i property">DataPtr</a>;
            }
        }
 
        <b>internal class</b> <a id="7ff909a68a591c73" href="../../../R/7ff909a68a591c73.html" target="n" data-glyph="2,1" class="t t"><span id="129a84c10ab98620">WSManStreamIDSet_UnToMan</span></a>
        {
            <b>internal string</b>[] <a id="567f87cfe45c7e6d" href="../../../R/567f87cfe45c7e6d.html" target="n" data-glyph="44,2" class="i field">streamIDs</a>;
            <b>internal int</b> <a id="719c43558d5c69a0" href="../../../R/719c43558d5c69a0.html" target="n" data-glyph="44,2" class="i field">streamIDsCount</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#7ff909a68a591c73" class="t t">WSManStreamIDSet_UnToMan</a> <a id="8df5edd4ab8bdb9a" href="../../../R/8df5edd4ab8bdb9a.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r35 rd" class="r35 r">unmanagedData</span>)
            {
                <a href="#7ff909a68a591c73" class="t t">WSManStreamIDSet_UnToMan</a> <span id="r36 rd" class="r36 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r35 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#65dc307010d2b536" class="t t">WSManStreamIDSetStruct</a> <span id="r37 rd" class="r37 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#65dc307010d2b536" class="t t">WSManStreamIDSetStruct</a>&gt;(<span class="r35 r">unmanagedData</span>);
 
                    <span class="r36 r">result</span> = <b>new</b> <span class="t">WSManStreamIDSet_UnToMan</span>();
                    <b>string</b>[] <span id="r38 rd" class="r38 r">idsArray</span> = <b>null</b>;
                    <b>if</b> (<span class="r37 r">resultInternal</span>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a> &gt; 0)
                    {
                        <span class="r38 r">idsArray</span> = <b>new</b> <b>string</b>[<span class="r37 r">resultInternal</span>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a>];
                        <span class="i">IntPtr</span>[] <span id="r39 rd" class="r39 r">ptrs</span> = <b>new</b> <span class="i">IntPtr</span>[<span class="r37 r">resultInternal</span>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a>];
                        <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r37 r">resultInternal</span>.<a href="#9240ca70d0c7d09d" class="i field">streamIDs</a>, <span class="r39 r">ptrs</span>, 0, <span class="r37 r">resultInternal</span>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a>); <span class="c">// Marshal the array of string pointers</span>
                        <b>for</b> (<b>int</b> <span id="r40 rd" class="r40 r">i</span> = 0; <span class="r40 r">i</span> &lt; <span class="r37 r">resultInternal</span>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a>; <span class="r40 r">i</span>++)
                        {
                            <span class="r38 r">idsArray</span>[<span class="r40 r">i</span>] = <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r39 r">ptrs</span>[<span class="r40 r">i</span>]); <span class="c">// Marshal the string pointers into strings</span>
                        }
                        <span class="c">/*
                         * // TODO: Why didn&#39;t this work? It looks more efficient
                        idsArray = new string[resultInternal.streamIDsCount];
                        int sizeInBytes = Marshal.SizeOf&lt;IntPtr&gt;();
                        IntPtr perElementPtr = resultInternal.streamIDs;
 
                        for (int i = 0; i &lt; resultInternal.streamIDsCount; i++)
                        {
                            IntPtr p = IntPtr.Add(perElementPtr, (i * sizeInBytes));
                            idsArray[i] = Marshal.PtrToStringUni(p);
                        }
                         */</span>
                    }
 
                    <span class="r36 r">result</span>.<a href="#567f87cfe45c7e6d" class="i field">streamIDs</a> = <span class="r38 r">idsArray</span>;
                    <span class="r36 r">result</span>.<a href="#719c43558d5c69a0" class="i field">streamIDsCount</a> = <span class="r37 r">resultInternal</span>.<a href="#0771393d07315d51" class="i field">streamIDsCount</a>;
                }
 
                <b>return</b> <span class="r36 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Managed to Unmanaged: Option struct used to pass optional information with WSManCreateShellEx .</span>
        <span class="c">///</span><span class="c"> Unmanaged to Managed: Included in WSManPluginRequest.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="f3f2b67eaca5460e" href="../../../R/f3f2b67eaca5460e.html" target="n" data-glyph="110,1" class="t t"><span id="3b4c8b6520c38d8a">WSManOption</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Underlying type = PCWSTR.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="236eed2b4fe7a439" href="../../../R/236eed2b4fe7a439.html" target="n" data-glyph="44,2" class="i field">name</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Underlying type = PCWSTR.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="fc9f90499a03780b" href="../../../R/fc9f90499a03780b.html" target="n" data-glyph="44,2" class="i field">value</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Underlying type = BOOL.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal bool</b> <a id="e4277700dc2720ce" href="../../../R/e4277700dc2720ce.html" target="n" data-glyph="44,2" class="i field">mustComply</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unmanaged to Managed: WSMAN_OPERATION_INFO includes the struct directly, so this cannot be made internal to WsmanOptionSet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="7d016440574a58b3" href="../../../R/7d016440574a58b3.html" target="n" data-glyph="110,1" class="t t"><span id="3090bf434a478078">WSManOptionSetStruct</span></a>
        {
            <b>internal int</b> <a id="2dc407a1dd01a721" href="../../../R/2dc407a1dd01a721.html" target="n" data-glyph="44,2" class="i field">optionsCount</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Pointer to an array of WSManOption objects.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
            <b>internal</b> <span class="i">IntPtr</span> <a id="3925ab38f450125f" href="../../../R/3925ab38f450125f.html" target="n" data-glyph="44,2" class="i field">options</a>;
 
            <b>internal bool</b> <a id="475726ad97a0fc7b" href="../../../R/475726ad97a0fc7b.html" target="n" data-glyph="44,2" class="i field">optionsMustUnderstand</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Option set struct used to pass optional information</span>
        <span class="c">///</span><span class="c"> with WSManCreateShellEx.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal struct</b> <a id="04451905aba58b51" href="../../../R/04451905aba58b51.html" target="n" data-glyph="110,1" class="t t"><span id="c0849e84671d1715">WSManOptionSet</span></a> : <span class="i">IDisposable</span>
        {
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Managed to Unmanaged
 
            <b>private</b> <a href="#7d016440574a58b3" class="t t">WSManOptionSetStruct</a> <a id="5bd6a226aa2bfd9f" href="../../../R/5bd6a226aa2bfd9f.html" target="n" data-glyph="46,2" class="i field">_optionSet</a>;
            <b>private</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="2e9c199109738722" href="../../../R/2e9c199109738722.html" target="n" data-glyph="46,2" class="i field">_data</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Options to construct this OptionSet with.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="1328c832d6e747f3" href="../../../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">WSManOptionSet</a>(<a href="#f3f2b67eaca5460e" class="t t">WSManOption</a>[] <span id="r41 rd" class="r41 r">options</span>)
            {
                <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r41 r">options</span> != <b>null</b>, <span class="s">&quot;options cannot be null&quot;</span>);
 
                <b>int</b> <span id="r42 rd" class="r42 r">sizeOfOption</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#f3f2b67eaca5460e" class="t t">WSManOption</a>&gt;();
                <a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a> = <b>new</b> <span class="t">WSManOptionSetStruct</span>();
                <a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>.<a href="#2dc407a1dd01a721" class="i field">optionsCount</a> = <span class="r41 r">options</span>.<span class="i">Length</span>;
                <a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>.<a href="#475726ad97a0fc7b" class="i field">optionsMustUnderstand</a> = <b>true</b>;
                <a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>.<a href="#3925ab38f450125f" class="i field">options</a> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<span class="r42 r">sizeOfOption</span> * <span class="r41 r">options</span>.<span class="i">Length</span>);
 
                <b>for</b> (<b>int</b> <span id="r43 rd" class="r43 r">index</span> = 0; <span class="r43 r">index</span> &lt; <span class="r41 r">options</span>.<span class="i">Length</span>; <span class="r43 r">index</span>++)
                {
                    <span class="c">// Look at the structure of native WSManOptionSet.. Options is a pointer..</span>
                    <span class="c">// In C-Style array individual elements are continuous..so I am building</span>
                    <span class="c">// continuous array elements here.</span>
                    <span class="i">Marshal</span>.<span class="i">StructureToPtr</span>(<span class="r41 r">options</span>[<span class="r43 r">index</span>], (<span class="i">IntPtr</span>)(<a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>.<a href="#3925ab38f450125f" class="i field">options</a>.<span class="i">ToInt64</span>() + (<span class="r42 r">sizeOfOption</span> * <span class="r43 r">index</span>)), <b>false</b>);
                }
 
                <a href="#2e9c199109738722" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#7d016440574a58b3" class="t t">WSManOptionSetStruct</a>&gt;(<a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>);
 
                <span class="c">// For conformity:</span>
                <a href="#04451905aba58b51" class="k">this</a>.<a href="#098de4305688026d" class="i field">optionsCount</a> = 0;
                <a href="#04451905aba58b51" class="k">this</a>.<a href="#1f13e273ca621f1d" class="i field">options</a> = <b>null</b>;
                <a href="#04451905aba58b51" class="k">this</a>.<a href="#9c798eeb1ced114c" class="i field">optionsMustUnderstand</a> = <b>false</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public void</b> <a id="4b937aec8bbb33ed" href="../../../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <b>if</b> (<a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>.<a href="#3925ab38f450125f" class="i field">options</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>.<a href="#3925ab38f450125f" class="i field">options</a>);
                    <a href="#5bd6a226aa2bfd9f" class="i field">_optionSet</a>.<a href="#3925ab38f450125f" class="i field">options</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                }
                <span class="c">// dispose option set</span>
                <a href="#2e9c199109738722" class="i field">_data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit IntPtr cast.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">optionSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#04451905aba58b51" class="t t">WSManOptionSet</a> <span id="r44 rd" class="r44 r">optionSet</span>)
            {
                <b>return</b> <span class="r44 r">optionSet</span>.<a href="#2e9c199109738722" class="i field">_data</a>.<a href="#bcf584319d6673a7" class="i property">DataPtr</a>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Unmanaged to Managed
 
            <b>internal int</b> <a id="098de4305688026d" href="../../../R/098de4305688026d.html" target="n" data-glyph="44,2" class="i field">optionsCount</a>;
            <b>internal</b> <a href="#f3f2b67eaca5460e" class="t t">WSManOption</a>[] <a id="1f13e273ca621f1d" href="../../../R/1f13e273ca621f1d.html" target="n" data-glyph="44,2" class="i field">options</a>;
            <b>internal bool</b> <a id="9c798eeb1ced114c" href="../../../R/9c798eeb1ced114c.html" target="n" data-glyph="44,2" class="i field">optionsMustUnderstand</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#04451905aba58b51" class="t t">WSManOptionSet</a> <a id="ca18866684eb4711" href="../../../R/../../0000000000.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r45 rd" class="r45 r">unmanagedData</span>)
            {
                <b>if</b> (<span class="r45 r">unmanagedData</span> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <b>return</b> <b>new</b> <span class="t">WSManOptionSet</span>();
                }
                <b>else</b>
                {
                    <a href="#7d016440574a58b3" class="t t">WSManOptionSetStruct</a> <span id="r46 rd" class="r46 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#7d016440574a58b3" class="t t">WSManOptionSetStruct</a>&gt;(<span class="r45 r">unmanagedData</span>);
                    <b>return</b> <a href="#0ee1b70dcde48aa5" class="i method">UnMarshal</a>(<span class="r46 r">resultInternal</span>);
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged structure to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">resultInternal</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#04451905aba58b51" class="t t">WSManOptionSet</a> <a id="0ee1b70dcde48aa5" href="../../../R/0ee1b70dcde48aa5.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<a href="#7d016440574a58b3" class="t t">WSManOptionSetStruct</a> <span id="r47 rd" class="r47 r">resultInternal</span>)
            {
                <a href="#f3f2b67eaca5460e" class="t t">WSManOption</a>[] <span id="r48 rd" class="r48 r">tempOptions</span> = <b>null</b>;
                <b>if</b> (<span class="r47 r">resultInternal</span>.<a href="#2dc407a1dd01a721" class="i field">optionsCount</a> &gt; 0)
                {
                    <span class="r48 r">tempOptions</span> = <b>new</b> <a href="#f3f2b67eaca5460e" class="t t">WSManOption</a>[<span class="r47 r">resultInternal</span>.<a href="#2dc407a1dd01a721" class="i field">optionsCount</a>];
 
                    <b>int</b> <span id="r49 rd" class="r49 r">sizeInBytes</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#f3f2b67eaca5460e" class="t t">WSManOption</a>&gt;();
                    <span class="i">IntPtr</span> <span id="r50 rd" class="r50 r">perElementPtr</span> = <span class="r47 r">resultInternal</span>.<a href="#3925ab38f450125f" class="i field">options</a>;
 
                    <b>for</b> (<b>int</b> <span id="r51 rd" class="r51 r">i</span> = 0; <span class="r51 r">i</span> &lt; <span class="r47 r">resultInternal</span>.<a href="#2dc407a1dd01a721" class="i field">optionsCount</a>; <span class="r51 r">i</span>++)
                    {
                        <span class="i">IntPtr</span> <span id="r52 rd" class="r52 r">p</span> = <span class="i">IntPtr</span>.<span class="i">Add</span>(<span class="r50 r">perElementPtr</span>, (<span class="r51 r">i</span> * <span class="r49 r">sizeInBytes</span>));
                        <span class="r48 r">tempOptions</span>[<span class="r51 r">i</span>] = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#f3f2b67eaca5460e" class="t t">WSManOption</a>&gt;(<span class="r52 r">p</span>);
                    }
                }
 
                <a href="#04451905aba58b51" class="t t">WSManOptionSet</a> <span id="r53 rd" class="r53 r">result</span> = <b>new</b> <span class="t">WSManOptionSet</span>();
                <span class="r53 r">result</span>.<a href="#098de4305688026d" class="i field">optionsCount</a> = <span class="r47 r">resultInternal</span>.<a href="#2dc407a1dd01a721" class="i field">optionsCount</a>;
                <span class="r53 r">result</span>.<a href="#1f13e273ca621f1d" class="i field">options</a> = <span class="r48 r">tempOptions</span>;
                <span class="r53 r">result</span>.<a href="#9c798eeb1ced114c" class="i field">optionsMustUnderstand</a> = <span class="r47 r">resultInternal</span>.<a href="#475726ad97a0fc7b" class="i field">optionsMustUnderstand</a>;
 
                <b>return</b> <span class="r53 r">result</span>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal struct</b> <a id="65e6a5b9a30e36c9" href="../../../R/65e6a5b9a30e36c9.html" target="n" data-glyph="110,1" class="t t"><span id="32a03ca90e53c785">WSManCommandArgSet</span></a> : <span class="i">IDisposable</span>
        {
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>internal struct</b> <a id="df6a6946a3effded" href="../../../R/df6a6946a3effded.html" target="n" data-glyph="110,2" class="t t"><span id="5247b5cb9c1a2469">WSManCommandArgSetInternal</span></a>
            {
                <b>internal int</b> <a id="662e740192e07f55" href="../../../R/662e740192e07f55.html" target="n" data-glyph="44,3" class="i field">argsCount</a>;
 
                [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
                <b>internal</b> <span class="i">IntPtr</span> <a id="d8236a08d1cfe72c" href="../../../R/d8236a08d1cfe72c.html" target="n" data-glyph="44,3" class="i field">args</a>;
            }
 
            <b>private</b> <a href="#df6a6946a3effded" class="t t">WSManCommandArgSetInternal</a> <a id="ac7b340319c0e8b6" href="../../../R/ac7b340319c0e8b6.html" target="n" data-glyph="46,2" class="i field">_internalData</a>;
 
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
            <b>private</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="8f8591b045c1c62d" href="../../../R/8f8591b045c1c62d.html" target="n" data-glyph="46,2" class="i field">_data</a>;
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Managed to Unmanaged
 
            <b>internal</b> <a id="5e6d9f2730be4090" href="../../../R/5e6d9f2730be4090.html" target="n" data-glyph="74,2" class="t constructor">WSManCommandArgSet</a>(<b>byte</b>[] <span id="r54 rd" class="r54 r">firstArgument</span>)
            {
                <a href="#ac7b340319c0e8b6" class="i field">_internalData</a> = <b>new</b> <span class="t">WSManCommandArgSetInternal</span>();
                <a href="#ac7b340319c0e8b6" class="i field">_internalData</a>.<a href="#662e740192e07f55" class="i field">argsCount</a> = 1;
                <a href="#ac7b340319c0e8b6" class="i field">_internalData</a>.<a href="#d8236a08d1cfe72c" class="i field">args</a> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<span class="i">IntPtr</span>&gt;());
 
                <span class="c">// argument set takes only strings..but powershell&#39;s serialized pipeline might contain</span>
                <span class="c">// \0 (null characters) which are unacceptable in WSMan. So we are converting to Base64</span>
                <span class="c">// here. The server will convert this back to original string.</span>
                <b>string</b> <span id="r55 rd" class="r55 r">base64EncodedArgument</span> = <span class="i">Convert</span>.<span class="i">ToBase64String</span>(<span class="r54 r">firstArgument</span>);
                <span class="i">IntPtr</span> <span id="r56 rd" class="r56 r">firstArgAddress</span> = <span class="i">Marshal</span>.<span class="i">StringToHGlobalUni</span>(<span class="r55 r">base64EncodedArgument</span>);
                <span class="i">Marshal</span>.<span class="i">WriteIntPtr</span>(<a href="#ac7b340319c0e8b6" class="i field">_internalData</a>.<a href="#d8236a08d1cfe72c" class="i field">args</a>, <span class="r56 r">firstArgAddress</span>);
 
                <a href="#8f8591b045c1c62d" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#65e6a5b9a30e36c9" class="t t">WSManCommandArgSet</a>.<a href="#df6a6946a3effded" class="t t">WSManCommandArgSetInternal</a>&gt;(<a href="#ac7b340319c0e8b6" class="i field">_internalData</a>);
 
                <span class="c">// For conformity:</span>
                <a href="#65e6a5b9a30e36c9" class="k">this</a>.<a href="#fa25303a75a58317" class="i field">args</a> = <b>null</b>;
                <a href="#65e6a5b9a30e36c9" class="k">this</a>.<a href="#a220d716a9791494" class="i field">argsCount</a> = 0;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Free resources.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public void</b> <a id="35060b2c9f513feb" href="../../../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <span class="i">IntPtr</span> <span id="r57 rd" class="r57 r">firstArgAddress</span> = <span class="i">Marshal</span>.<span class="i">ReadIntPtr</span>(<a href="#ac7b340319c0e8b6" class="i field">_internalData</a>.<a href="#d8236a08d1cfe72c" class="i field">args</a>);
                <b>if</b> (<span class="r57 r">firstArgAddress</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r57 r">firstArgAddress</span>);
                }
 
                <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<a href="#ac7b340319c0e8b6" class="i field">_internalData</a>.<a href="#d8236a08d1cfe72c" class="i field">args</a>);
 
                <a href="#8f8591b045c1c62d" class="i field">_data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit cast to IntPtr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#65e6a5b9a30e36c9" class="t t">WSManCommandArgSet</a> <span id="r58 rd" class="r58 r">obj</span>)
            {
                <b>return</b> <span class="r58 r">obj</span>.<a href="#8f8591b045c1c62d" class="i field">_data</a>.<a href="#bcf584319d6673a7" class="i property">DataPtr</a>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Unmanaged to Managed
 
            <b>internal string</b>[] <a id="fa25303a75a58317" href="../../../R/fa25303a75a58317.html" target="n" data-glyph="44,2" class="i field">args</a>;
            <b>internal int</b> <a id="a220d716a9791494" href="../../../R/a220d716a9791494.html" target="n" data-glyph="44,2" class="i field">argsCount</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Since this is a structure, it must be non-null. This differs in behavior from all the other UnMarshals</span>
            <span class="c">///</span><span class="c"> that are classes since they can be null.</span>
            <span class="c">///</span><span class="c"> TODO: Do I need to worry about intermediate null characters in the arguments? The managed to unmanaged does!</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#65e6a5b9a30e36c9" class="t t">WSManCommandArgSet</a> <a id="e16a7d6258509453" href="../../../R/e16a7d6258509453.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r59 rd" class="r59 r">unmanagedData</span>)
            {
                <a href="#65e6a5b9a30e36c9" class="t t">WSManCommandArgSet</a> <span id="r60 rd" class="r60 r">result</span> = <b>new</b> <span class="t">WSManCommandArgSet</span>();
 
                <b>if</b> (<span class="r59 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#df6a6946a3effded" class="t t">WSManCommandArgSetInternal</a> <span id="r61 rd" class="r61 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#df6a6946a3effded" class="t t">WSManCommandArgSetInternal</a>&gt;(<span class="r59 r">unmanagedData</span>);
 
                    <b>string</b>[] <span id="r62 rd" class="r62 r">tempArgs</span> = <b>null</b>;
                    <b>if</b> (<span class="r61 r">resultInternal</span>.<a href="#662e740192e07f55" class="i field">argsCount</a> &gt; 0)
                    {
                        <span class="r62 r">tempArgs</span> = <b>new</b> <b>string</b>[<span class="r61 r">resultInternal</span>.<a href="#662e740192e07f55" class="i field">argsCount</a>];
                        <span class="i">IntPtr</span>[] <span id="r63 rd" class="r63 r">ptrs</span> = <b>new</b> <span class="i">IntPtr</span>[<span class="r61 r">resultInternal</span>.<a href="#662e740192e07f55" class="i field">argsCount</a>];
                        <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r61 r">resultInternal</span>.<a href="#d8236a08d1cfe72c" class="i field">args</a>, <span class="r63 r">ptrs</span>, 0, <span class="r61 r">resultInternal</span>.<a href="#662e740192e07f55" class="i field">argsCount</a>); <span class="c">// Marshal the array of string pointers</span>
                        <b>for</b> (<b>int</b> <span id="r64 rd" class="r64 r">i</span> = 0; <span class="r64 r">i</span> &lt; <span class="r61 r">resultInternal</span>.<a href="#662e740192e07f55" class="i field">argsCount</a>; <span class="r64 r">i</span>++)
                        {
                            <span class="r62 r">tempArgs</span>[<span class="r64 r">i</span>] = <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r63 r">ptrs</span>[<span class="r64 r">i</span>]); <span class="c">// Marshal the string pointers into strings</span>
                        }
                    }
 
                    <span class="r60 r">result</span>.<a href="#a220d716a9791494" class="i field">argsCount</a> = <span class="r61 r">resultInternal</span>.<a href="#662e740192e07f55" class="i field">argsCount</a>;
                    <span class="r60 r">result</span>.<a href="#fa25303a75a58317" class="i field">args</a> = <span class="r62 r">tempArgs</span>;
                }
 
                <b>return</b> <span class="r60 r">result</span>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        }
 
        <b>internal struct</b> <a id="f44ddcd3dc4aede8" href="../../../R/f44ddcd3dc4aede8.html" target="n" data-glyph="110,1" class="t t"><span id="2f78773c4d1ca888">WSManShellDisconnectInfo</span></a> : <span class="i">IDisposable</span>
        {
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>private struct</b> <a id="704fce8fe574ea4d" href="../../../R/704fce8fe574ea4d.html" target="n" data-glyph="112,2" class="t t"><span id="b17dda84a1465d9a">WSManShellDisconnectInfoInternal</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> New idletimeout for the server shell that overrides the original idletimeout specified in WSManCreateShell.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal uint</b> <a id="e02c35c61dc64b29" href="../../../R/e02c35c61dc64b29.html" target="n" data-glyph="44,3" class="i field">idleTimeoutMs</a>;
            }
 
            <b>private</b> <a href="#704fce8fe574ea4d" class="t t">WSManShellDisconnectInfoInternal</a> <a id="e67af67c6e3a32be" href="../../../R/e67af67c6e3a32be.html" target="n" data-glyph="46,2" class="i field">_internalInfo</a>;
            <b>internal</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="d24f2e52761e617e" href="../../../R/d24f2e52761e617e.html" target="n" data-glyph="44,2" class="i field">data</a>;
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor / Other methods
            <b>internal</b> <a id="552375df4829fe3a" href="../../../R/552375df4829fe3a.html" target="n" data-glyph="74,2" class="t constructor">WSManShellDisconnectInfo</a>(<b>uint</b> <span id="r65 rd" class="r65 r">serverIdleTimeOut</span>)
            {
                <a href="#e67af67c6e3a32be" class="i field">_internalInfo</a> = <b>new</b> <span class="t">WSManShellDisconnectInfoInternal</span>();
                <a href="#e67af67c6e3a32be" class="i field">_internalInfo</a>.<a href="#e02c35c61dc64b29" class="i field">idleTimeoutMs</a> = <span class="r65 r">serverIdleTimeOut</span>;
                <a href="#d24f2e52761e617e" class="i field">data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#704fce8fe574ea4d" class="t t">WSManShellDisconnectInfoInternal</a>&gt;(<a href="#e67af67c6e3a32be" class="i field">_internalInfo</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Disposes the object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public void</b> <a id="25f1e6f0c109b240" href="../../../R/25f1e6f0c109b240.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#d24f2e52761e617e" class="i field">data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit IntPtr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">disconnectInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#f44ddcd3dc4aede8" class="t t">WSManShellDisconnectInfo</a> <span id="r66 rd" class="r66 r">disconnectInfo</span>)
            {
                <b>return</b> <span class="r66 r">disconnectInfo</span>.<a href="#d24f2e52761e617e" class="i field">data</a>.<a href="#bcf584319d6673a7" class="i property">DataPtr</a>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="328e03a92772f390" href="../../../R/328e03a92772f390.html" target="n" data-glyph="110,1" class="t t"><span id="fa3ce88344b90f08">WSManShellStartupInfoStruct</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> PowerShell always uses one stream. So no need to expand this.</span>
            <span class="c">///</span><span class="c"> Maps to WSManStreamIDSet.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="ecf81b5afd48bad0" href="../../../R/ecf81b5afd48bad0.html" target="n" data-glyph="44,2" class="i field">inputStreamSet</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> PowerShell always uses one stream. So no need to expand this.</span>
            <span class="c">///</span><span class="c"> Maps to WSManStreamIDSet.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="00885aa031fc4865" href="../../../R/00885aa031fc4865.html" target="n" data-glyph="44,2" class="i field">outputStreamSet</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Idle timeout.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal uint</b> <a id="84cec79b92e60bb3" href="../../../R/84cec79b92e60bb3.html" target="n" data-glyph="44,2" class="i field">idleTimeoutMs</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Working directory of the shell.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="3cdb9d3567c87b45" href="../../../R/3cdb9d3567c87b45.html" target="n" data-glyph="44,2" class="i field">workingDirectory</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Environment variables available to the shell.</span>
            <span class="c">///</span><span class="c"> Maps to WSManEnvironmentVariableSet.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="522161c3b8c92e48" href="../../../R/522161c3b8c92e48.html" target="n" data-glyph="44,2" class="i field">environmentVariableSet</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Environment variables available to the shell.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>internal string</b> <a id="535831dc55a433fa" href="../../../R/535831dc55a433fa.html" target="n" data-glyph="44,2" class="i field">name</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Managed to unmanaged representation of WSMAN_SHELL_STARTUP_INFO.</span>
        <span class="c">///</span><span class="c"> It converts managed values into an unmanaged compatible WSManShellStartupInfoStruct that</span>
        <span class="c">///</span><span class="c"> is marshaled into unmanaged memory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal struct</b> <a id="a04acf0dae72dbd2" href="../../../R/a04acf0dae72dbd2.html" target="n" data-glyph="110,1" class="t t"><span id="8e7869324469e7fc">WSManShellStartupInfo_ManToUn</span></a> : <span class="i">IDisposable</span>
        {
            <b>private</b> <a href="#328e03a92772f390" class="t t">WSManShellStartupInfoStruct</a> <a id="562b4ae5b9a14d6b" href="../../../R/562b4ae5b9a14d6b.html" target="n" data-glyph="46,2" class="i field">_internalInfo</a>;
            <b>internal</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="e45ba5ebad14b5ce" href="../../../R/e45ba5ebad14b5ce.html" target="n" data-glyph="44,2" class="i field">data</a>;
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor / Other methods
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Creates a startup info with 1 startup option.</span>
            <span class="c">///</span><span class="c"> The startup option is intended to specify the version.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">inputStreamSet</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">outputStreamSet</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">serverIdleTimeOut</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="50260f68ca520319" href="../../../R/50260f68ca520319.html" target="n" data-glyph="74,2" class="t constructor">WSManShellStartupInfo_ManToUn</a>(<a href="#69baba050509e5fa" class="t t">WSManStreamIDSet_ManToUn</a> <span id="r67 rd" class="r67 r">inputStreamSet</span>, <a href="#69baba050509e5fa" class="t t">WSManStreamIDSet_ManToUn</a> <span id="r68 rd" class="r68 r">outputStreamSet</span>, <b>uint</b> <span id="r69 rd" class="r69 r">serverIdleTimeOut</span>, <b>string</b> <span id="r70 rd" class="r70 r">name</span>)
            {
                <a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a> = <b>new</b> <span class="t">WSManShellStartupInfoStruct</span>();
                <a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a>.<a href="#ecf81b5afd48bad0" class="i field">inputStreamSet</a> = <span class="r67 r">inputStreamSet</span>;
                <a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a>.<a href="#00885aa031fc4865" class="i field">outputStreamSet</a> = <span class="r68 r">outputStreamSet</span>;
                <a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a>.<a href="#84cec79b92e60bb3" class="i field">idleTimeoutMs</a> = <span class="r69 r">serverIdleTimeOut</span>;
                <span class="c">// WSMan uses %USER_PROFILE% as the default working directory.</span>
                <a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a>.<a href="#3cdb9d3567c87b45" class="i field">workingDirectory</a> = <b>null</b>;
                <a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a>.<a href="#522161c3b8c92e48" class="i field">environmentVariableSet</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a>.<a href="#535831dc55a433fa" class="i field">name</a> = <span class="r70 r">name</span>;
 
                <a href="#e45ba5ebad14b5ce" class="i field">data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#328e03a92772f390" class="t t">WSManShellStartupInfoStruct</a>&gt;(<a href="#562b4ae5b9a14d6b" class="i field">_internalInfo</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Disposes the object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public void</b> <a id="2a00d4506220f9b6" href="../../../R/2a00d4506220f9b6.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#e45ba5ebad14b5ce" class="i field">data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit IntPtr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">startupInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#a04acf0dae72dbd2" class="t t">WSManShellStartupInfo_ManToUn</a> <span id="r71 rd" class="r71 r">startupInfo</span>)
            {
                <b>return</b> <span class="r71 r">startupInfo</span>.<a href="#e45ba5ebad14b5ce" class="i field">data</a>.<a href="#bcf584319d6673a7" class="i property">DataPtr</a>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unmanaged to managed representation of WSMAN_SHELL_STARTUP_INFO.</span>
        <span class="c">///</span><span class="c"> It unmarshals the unmanaged struct into this object for use by managed code.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="19022ea5d98e6225" href="../../../R/19022ea5d98e6225.html" target="n" data-glyph="2,1" class="t t"><span id="3a185cc708a766f5">WSManShellStartupInfo_UnToMan</span></a>
        {
            <b>internal</b> <a href="#7ff909a68a591c73" class="t t">WSManStreamIDSet_UnToMan</a> <a id="ea47f38b3b5380a7" href="../../../R/ea47f38b3b5380a7.html" target="n" data-glyph="44,2" class="i field">inputStreamSet</a>;
            <b>internal</b> <a href="#7ff909a68a591c73" class="t t">WSManStreamIDSet_UnToMan</a> <a id="f076c27f80ed60be" href="../../../R/f076c27f80ed60be.html" target="n" data-glyph="44,2" class="i field">outputStreamSet</a>;
            <b>internal uint</b> <a id="496d3988b55dc09d" href="../../../R/496d3988b55dc09d.html" target="n" data-glyph="44,2" class="i field">idleTimeoutMS</a>;
            <b>internal string</b> <a id="39f5d34222572fab" href="../../../R/39f5d34222572fab.html" target="n" data-glyph="44,2" class="i field">workingDirectory</a>;
            <b>internal</b> <a href="#8903da75b2ddc690" class="t t">WSManEnvironmentVariableSet</a> <a id="d769982205ce750e" href="../../../R/d769982205ce750e.html" target="n" data-glyph="44,2" class="i field">environmentVariableSet</a>;
            <b>internal string</b> <a id="97892bc0dfa3af26" href="../../../R/97892bc0dfa3af26.html" target="n" data-glyph="44,2" class="i field">name</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#19022ea5d98e6225" class="t t">WSManShellStartupInfo_UnToMan</a> <a id="b887d5f93050daf4" href="../../../R/b887d5f93050daf4.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r72 rd" class="r72 r">unmanagedData</span>)
            {
                <a href="#19022ea5d98e6225" class="t t">WSManShellStartupInfo_UnToMan</a> <span id="r73 rd" class="r73 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r72 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#328e03a92772f390" class="t t">WSManShellStartupInfoStruct</a> <span id="r74 rd" class="r74 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#328e03a92772f390" class="t t">WSManShellStartupInfoStruct</a>&gt;(<span class="r72 r">unmanagedData</span>);
 
                    <span class="r73 r">result</span> = <b>new</b> <span class="t">WSManShellStartupInfo_UnToMan</span>();
                    <span class="r73 r">result</span>.<a href="#ea47f38b3b5380a7" class="i field">inputStreamSet</a> = <a href="#7ff909a68a591c73" class="t t">WSManStreamIDSet_UnToMan</a>.<a href="#8df5edd4ab8bdb9a" class="i method">UnMarshal</a>(<span class="r74 r">resultInternal</span>.<a href="#ecf81b5afd48bad0" class="i field">inputStreamSet</a>);
                    <span class="r73 r">result</span>.<a href="#f076c27f80ed60be" class="i field">outputStreamSet</a> = <a href="#7ff909a68a591c73" class="t t">WSManStreamIDSet_UnToMan</a>.<a href="#8df5edd4ab8bdb9a" class="i method">UnMarshal</a>(<span class="r74 r">resultInternal</span>.<a href="#00885aa031fc4865" class="i field">outputStreamSet</a>);
                    <span class="r73 r">result</span>.<a href="#496d3988b55dc09d" class="i field">idleTimeoutMS</a> = <span class="r74 r">resultInternal</span>.<a href="#84cec79b92e60bb3" class="i field">idleTimeoutMs</a>;
                    <span class="r73 r">result</span>.<a href="#39f5d34222572fab" class="i field">workingDirectory</a> = <span class="r74 r">resultInternal</span>.<a href="#3cdb9d3567c87b45" class="i field">workingDirectory</a>; <span class="c">// TODO: Special marshaling required here?</span>
                    <span class="r73 r">result</span>.<a href="#d769982205ce750e" class="i field">environmentVariableSet</a> = <a href="#8903da75b2ddc690" class="t t">WSManEnvironmentVariableSet</a>.<a href="#5a383be1a3c838c9" class="i method">UnMarshal</a>(<span class="r74 r">resultInternal</span>.<a href="#522161c3b8c92e48" class="i field">environmentVariableSet</a>);
                    <span class="r73 r">result</span>.<a href="#97892bc0dfa3af26" class="i field">name</a> = <span class="r74 r">resultInternal</span>.<a href="#535831dc55a433fa" class="i field">name</a>;
                }
 
                <b>return</b> <span class="r73 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Managed representation of WSMAN_ENVIRONMENT_VARIABLE_SET.</span>
        <span class="c">///</span><span class="c"> It wraps WSManEnvironmentVariableSetInternal and UnMarshals the unmanaged</span>
        <span class="c">///</span><span class="c"> data into the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="8903da75b2ddc690" href="../../../R/8903da75b2ddc690.html" target="n" data-glyph="2,1" class="t t"><span id="57c1b58e5c835207">WSManEnvironmentVariableSet</span></a>
        {
            <b>internal uint</b> <a id="3e2e1f2ed405865d" href="../../../R/3e2e1f2ed405865d.html" target="n" data-glyph="44,2" class="i field">varsCount</a>;
            <b>internal</b> <a href="#9ad23306376a7c5c" class="t t">WSManEnvironmentVariableInternal</a>[] <a id="59d7211f0645eb22" href="../../../R/59d7211f0645eb22.html" target="n" data-glyph="44,2" class="i field">vars</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#8903da75b2ddc690" class="t t">WSManEnvironmentVariableSet</a> <a id="5a383be1a3c838c9" href="../../../R/5a383be1a3c838c9.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r75 rd" class="r75 r">unmanagedData</span>)
            {
                <a href="#8903da75b2ddc690" class="t t">WSManEnvironmentVariableSet</a> <span id="r76 rd" class="r76 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r75 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#dfbc2b83c69f46a7" class="t t">WSManEnvironmentVariableSetInternal</a> <span id="r77 rd" class="r77 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#dfbc2b83c69f46a7" class="t t">WSManEnvironmentVariableSetInternal</a>&gt;(<span class="r75 r">unmanagedData</span>);
 
                    <span class="r76 r">result</span> = <b>new</b> <span class="t">WSManEnvironmentVariableSet</span>();
                    <a href="#9ad23306376a7c5c" class="t t">WSManEnvironmentVariableInternal</a>[] <span id="r78 rd" class="r78 r">varsArray</span> = <b>null</b>;
                    <b>if</b> (<span class="r77 r">resultInternal</span>.<a href="#392209d7e921b5e0" class="i field">varsCount</a> &gt; 0)
                    {
                        <span class="r78 r">varsArray</span> = <b>new</b> <a href="#9ad23306376a7c5c" class="t t">WSManEnvironmentVariableInternal</a>[<span class="r77 r">resultInternal</span>.<a href="#392209d7e921b5e0" class="i field">varsCount</a>];
                        <b>int</b> <span id="r79 rd" class="r79 r">sizeInBytes</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#9ad23306376a7c5c" class="t t">WSManEnvironmentVariableInternal</a>&gt;();
                        <span class="i">IntPtr</span> <span id="r80 rd" class="r80 r">perElementPtr</span> = <span class="r77 r">resultInternal</span>.<a href="#5f02d7618750a258" class="i field">vars</a>;
 
                        <b>for</b> (<b>int</b> <span id="r81 rd" class="r81 r">i</span> = 0; <span class="r81 r">i</span> &lt; <span class="r77 r">resultInternal</span>.<a href="#392209d7e921b5e0" class="i field">varsCount</a>; <span class="r81 r">i</span>++)
                        {
                            <span class="i">IntPtr</span> <span id="r82 rd" class="r82 r">p</span> = <span class="i">IntPtr</span>.<span class="i">Add</span>(<span class="r80 r">perElementPtr</span>, (<span class="r81 r">i</span> * <span class="r79 r">sizeInBytes</span>));
                            <span class="r78 r">varsArray</span>[<span class="r81 r">i</span>] = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#9ad23306376a7c5c" class="t t">WSManEnvironmentVariableInternal</a>&gt;(<span class="r82 r">p</span>);
                        }
                    }
 
                    <span class="r76 r">result</span>.<a href="#59d7211f0645eb22" class="i field">vars</a> = <span class="r78 r">varsArray</span>;
                    <span class="r76 r">result</span>.<a href="#3e2e1f2ed405865d" class="i field">varsCount</a> = <span class="r77 r">resultInternal</span>.<a href="#392209d7e921b5e0" class="i field">varsCount</a>;
                }
 
                <b>return</b> <span class="r76 r">result</span>;
            }
 
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>private struct</b> <a id="dfbc2b83c69f46a7" href="../../../R/dfbc2b83c69f46a7.html" target="n" data-glyph="112,2" class="t t"><span id="28da8e3341295cac">WSManEnvironmentVariableSetInternal</span></a>
            {
                <b>internal uint</b> <a id="392209d7e921b5e0" href="../../../R/392209d7e921b5e0.html" target="n" data-glyph="44,3" class="i field">varsCount</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="5f02d7618750a258" href="../../../R/5f02d7618750a258.html" target="n" data-glyph="44,3" class="i field">vars</a>; <span class="c">// Array of WSManEnvironmentVariableInternal structs</span>
            }
 
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>internal struct</b> <a id="9ad23306376a7c5c" href="../../../R/9ad23306376a7c5c.html" target="n" data-glyph="110,2" class="t t"><span id="f49479eb585bc441">WSManEnvironmentVariableInternal</span></a>
            {
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="60fef7ca18d9c363" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">name</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="f12e8d28c25a0de0" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">value</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Proxy Info used with WSManCreateSession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="4b0c4cdba66d06ba" href="../../../R/4b0c4cdba66d06ba.html" target="n" data-glyph="2,1" class="t t">WSManProxyInfo</a> : <span class="i">IDisposable</span>
        {
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>private struct</b> <a id="759966133ea3dc46" href="../../../R/759966133ea3dc46.html" target="n" data-glyph="112,2" class="t t"><span id="d6062b46a3b35194">WSManProxyInfoInternal</span></a>
            {
                <b>public int</b> <a id="117e121b112f0a09" href="../../../R/117e121b112f0a09.html" target="n" data-glyph="42,3" class="i field">proxyAccessType</a>;
                <b>public</b> <a href="#ca42a41ca9a4cabc" class="t t">WSManUserNameAuthenticationCredentials</a>.<a href="#756468af10a6211d" class="t t">WSManUserNameCredentialStruct</a> <a id="ef909ddc128a210b" href="../../../R/ef909ddc128a210b.html" target="n" data-glyph="42,3" class="i field">proxyAuthCredentialsStruct</a>;
            }
 
            <b>private</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="de8213c0102e9d80" href="../../../R/de8213c0102e9d80.html" target="n" data-glyph="46,2" class="i field">_data</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">proxyAccessType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">authCredentials</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="7ec280da491cf029" href="../../../R/7ec280da491cf029.html" target="n" data-glyph="74,2" class="t constructor">WSManProxyInfo</a>(<a href="../commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a> <span id="r83 rd" class="r83 r">proxyAccessType</span>,
                <a href="#ca42a41ca9a4cabc" class="t t">WSManUserNameAuthenticationCredentials</a> <span id="r84 rd" class="r84 r">authCredentials</span>)
            {
                <a href="#759966133ea3dc46" class="t t">WSManProxyInfoInternal</a> <span id="r85 rd" class="r85 r">internalInfo</span> = <b>new</b> <span class="t">WSManProxyInfoInternal</span>();
                <span class="r85 r">internalInfo</span>.<a href="#117e121b112f0a09" class="i field">proxyAccessType</a> = (<b>int</b>)<span class="r83 r">proxyAccessType</span>;
                <span class="r85 r">internalInfo</span>.<a href="#ef909ddc128a210b" class="i field">proxyAuthCredentialsStruct</a> = <b>new</b> <a href="#ca42a41ca9a4cabc" class="t t">WSManUserNameAuthenticationCredentials</a>.<span class="t">WSManUserNameCredentialStruct</span>();
                <span class="r85 r">internalInfo</span>.<a href="#ef909ddc128a210b" class="i field">proxyAuthCredentialsStruct</a>.<a href="#e04efa243fc5d61e" class="i field">authenticationMechanism</a> = <a href="#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="#5125eb68ec11fa36" class="i field">WSMAN_FLAG_DEFAULT_AUTHENTICATION</a>;
 
                <b>if</b> (<span class="r84 r">authCredentials</span> != <b>null</b>)
                {
                    <span class="r85 r">internalInfo</span>.<a href="#ef909ddc128a210b" class="i field">proxyAuthCredentialsStruct</a> = <span class="r84 r">authCredentials</span>.<a href="#88657ec08757620f" class="i property">CredentialStruct</a>;
                }
 
                <a href="#de8213c0102e9d80" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#759966133ea3dc46" class="t t">WSManProxyInfoInternal</a>&gt;(<span class="r85 r">internalInfo</span>);
            }
 
            <b>public void</b> <a id="84a682c4af6067af" href="../../../R/84a682c4af6067af.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <span class="c">// data is of struct type..so no need to set it to null.</span>
                <a href="#de8213c0102e9d80" class="i field">_data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
                <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#4b0c4cdba66d06ba" class="k">this</a>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Implicit IntPtr.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">proxyInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#4b0c4cdba66d06ba" class="t t">WSManProxyInfo</a> <span id="r86 rd" class="r86 r">proxyInfo</span>)
            {
                <b>return</b> <span class="r86 r">proxyInfo</span>.<a href="#de8213c0102e9d80" class="i field">_data</a>.<a href="#bcf584319d6673a7" class="i property">DataPtr</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WSMan Shell Async
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flags used by all callback functions: WSMAN_COMPLETION_FUNCTION,</span>
        <span class="c">///</span><span class="c"> WSMAN_SUBSCRIPTION_COMPLETION_FUNCTION and WSMAN_SHELL_COMPLETION_FUNCTION.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="4b939349c4d4b263" href="../../../R/4b939349c4d4b263.html" target="n" data-glyph="20,1" class="t t"><span id="6dbd40f0bfad1933">WSManCallbackFlags</span></a>
        {
            <span class="c">//</span>
            <span class="c">// Flag that marks the end of any single step of multistep operation</span>
            <span class="c">//</span>
            <a id="e14d6bd19f5d1f34" href="../../../R/e14d6bd19f5d1f34.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_END_OF_OPERATION</a> = 0x1,
 
            <span class="c">//</span>
            <span class="c">// WSMAN_SHELL_COMPLETION_FUNCTION API specific flags</span>
            <span class="c">//  end of a particular stream; it is used for optimization purposes if the shell</span>
            <span class="c">//  knows that no more output will occur for this stream; in some conditions this</span>
            <span class="c">//  cannot be determined.</span>
            <span class="c">//</span>
            <a id="1be8b96d2aea500e" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_END_OF_STREAM</a> = 0x8,
 
            <span class="c">//</span>
            <span class="c">// Flag that if present on CreateShell callback indicates that it supports disconnect</span>
            <span class="c">//</span>
            <a id="37220dfdda208a17" href="../../../R/37220dfdda208a17.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_SHELL_SUPPORTS_DISCONNECT</a> = 0x20,
 
            <span class="c">//</span>
            <span class="c">// Marks the end of an auto-disconnect operation.</span>
            <span class="c">//</span>
            <a id="b75dc830c3d4c2ad" href="../../../R/b75dc830c3d4c2ad.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_SHELL_AUTODISCONNECTED</a> = 0x40,
 
            <span class="c">//</span>
            <span class="c">// Network failure notification.</span>
            <span class="c">//</span>
            <a id="f545963b836576f8" href="../../../R/f545963b836576f8.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_NETWORK_FAILURE_DETECTED</a> = 0x100,
 
            <span class="c">//</span>
            <span class="c">// Network connection retry notification.</span>
            <span class="c">//</span>
            <a id="f87517a9a496651d" href="../../../R/f87517a9a496651d.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_RETRYING_AFTER_NETWORK_FAILURE</a> = 0x200,
 
            <span class="c">//</span>
            <span class="c">// Network retry succeeded, connection re-established notification.</span>
            <span class="c">//</span>
            <a id="61e65b7c046ca200" href="../../../R/61e65b7c046ca200.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_RECONNECTED_AFTER_NETWORK_FAILURE</a> = 0x400,
 
            <span class="c">//</span>
            <span class="c">// Retries failed, now auto-disconnecting.</span>
            <span class="c">//</span>
            <a id="23623b9d1c8a6329" href="../../../R/23623b9d1c8a6329.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_SHELL_AUTODISCONNECTING</a> = 0x800,
 
            <span class="c">//</span>
            <span class="c">// Internal error during retries.  Cannot auto-disconnect.  Shell failure.</span>
            <span class="c">//</span>
            <a id="7f4749e6e54e936d" href="../../../R/7f4749e6e54e936d.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_CALLBACK_RETRY_ABORTED_DUE_TO_INTERNAL_ERROR</a> = 0x1000,
 
            <span class="c">//</span>
            <span class="c">// Flag that indicates for a receive operation that a delay stream request has been processed</span>
            <span class="c">//</span>
            <a id="77f419f8dc9e11af" href="../../../R/77f419f8dc9e11af.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_RECEIVE_DELAY_STREAM_REQUEST_PROCESSED</a> = 0X2000
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Completion function used by all Shell functions. Returns error-&gt;code != 0 upon error;</span>
        <span class="c">///</span><span class="c"> use error-&gt;errorDetail structure for extended error informations; the callback is</span>
        <span class="c">///</span><span class="c"> called for each shell operation; after a WSManReceiveShellOutput operation is initiated,</span>
        <span class="c">///</span><span class="c"> the callback is called for each output stream element or if error; the underlying</span>
        <span class="c">///</span><span class="c"> implementation handles the polling of stream data from the command or shell.</span>
        <span class="c">///</span><span class="c"> If WSMAN_COMMAND_STATE_DONE state is received, no more streams will be received from the command,</span>
        <span class="c">///</span><span class="c"> so the command can be closed using WSManCloseShellOperationEx(command).</span>
        <span class="c">///</span><span class="c"> If error-&gt;code != 0, the result is guaranteed to be NULL. The error and result objects are</span>
        <span class="c">///</span><span class="c"> allocated and owned by the WSMan client stack; they are valid during the callback only; the user</span>
        <span class="c">///</span><span class="c"> has to synchronously copy the data in the callback. This callback function will use the current</span>
        <span class="c">///</span><span class="c"> access token, whether it is a process or impersonation token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">operationContext</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> user supplied operation context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> one or more flags from WSManCallbackFlags</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">error</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> error allocated and owned by the winrm stack; valid in the callback only;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">shellOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> shell handle associated with the user context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">commandOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command handle associated with the user context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">operationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> operation handle associated with the user context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> output data from command/shell; allocated internally and owned by the winrm stack.</span>
        <span class="c">///</span><span class="c"> valid only within this function.</span>
        <span class="c">///</span><span class="c"> See WSManReceiveDataResult.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal delegate void</b> <a id="e157acfccf186ce7" href="../../../R/e157acfccf186ce7.html" target="n" data-glyph="14,1" class="t t"><span id="d31c728954e5a46d">WSManShellCompletionFunction</span></a>(
            <span class="i">IntPtr</span> <span id="r87 rd" class="r87 r">operationContext</span>,
            <b>int</b> <span id="r88 rd" class="r88 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r89 rd" class="r89 r">error</span>,
            <span class="i">IntPtr</span> <span id="r90 rd" class="r90 r">shellOperationHandle</span>,
            <span class="i">IntPtr</span> <span id="r91 rd" class="r91 r">commandOperationHandle</span>,
            <span class="i">IntPtr</span> <span id="r92 rd" class="r92 r">operationHandle</span>,
            <span class="i">IntPtr</span> <span id="r93 rd" class="r93 r">data</span>
            );
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Struct which holds reference to the callback(delegate) passed to WSMan</span>
        <span class="c">///</span><span class="c"> API.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal struct</b> <a id="9855dfa19ee2dc9d" href="../../../R/9855dfa19ee2dc9d.html" target="n" data-glyph="110,1" class="t t"><span id="69b04ac365b0b919">WSManShellAsyncCallback</span></a>
        {
            <span class="c">// GC handle which prevents garbage collector from collecting this delegate.</span>
            <b>private</b> <span class="i">GCHandle</span> <a id="f37dfa0f9a29b6f2" href="../../../R/f37dfa0f9a29b6f2.html" target="n" data-glyph="46,2" class="i field">_gcHandle</a>;
 
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Reliability&quot;</span>, <span class="s">&quot;CA2006:UseSafeHandleToEncapsulateNativeResources&quot;</span>)]
            <b>private readonly</b> <span class="i">IntPtr</span> <a id="e6530dbc26500ab5" href="../../../R/e6530dbc26500ab5.html" target="n" data-glyph="46,2" class="i field">_asyncCallback</a>;
 
            <b>internal</b> <a id="2af3c7c6053b5898" href="../../../R/2af3c7c6053b5898.html" target="n" data-glyph="74,2" class="t constructor">WSManShellAsyncCallback</a>(<a href="#e157acfccf186ce7" class="t t">WSManShellCompletionFunction</a> <span id="r94 rd" class="r94 r">callback</span>)
            {
                <span class="c">// if a delegate is re-located by a garbage collection, it will not affect</span>
                <span class="c">// the underlaying managed callback, so Alloc is used to add a reference</span>
                <span class="c">// to the delegate, allowing relocation of the delegate, but preventing</span>
                <span class="c">// disposal. Using GCHandle without pinning reduces fragmentation potential</span>
                <span class="c">// of the managed heap.</span>
                <a href="#f37dfa0f9a29b6f2" class="i field">_gcHandle</a> = <span class="i">GCHandle</span>.<span class="i">Alloc</span>(<span class="r94 r">callback</span>);
                <a href="#e6530dbc26500ab5" class="i field">_asyncCallback</a> = <span class="i">Marshal</span>.<span class="i">GetFunctionPointerForDelegate</span>(<span class="r94 r">callback</span>);
            }
 
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#9855dfa19ee2dc9d" class="t t">WSManShellAsyncCallback</a> <span id="r95 rd" class="r95 r">callback</span>)
            {
                <b>return</b> <span class="r95 r">callback</span>.<a href="#e6530dbc26500ab5" class="i field">_asyncCallback</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used in different WSMan functions to supply async callback.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="5659ff525f41a5f1" href="../../../R/5659ff525f41a5f1.html" target="n" data-glyph="2,1" class="t t">WSManShellAsync</a>
        {
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>internal struct</b> <a id="ee672255526aafad" href="../../../R/ee672255526aafad.html" target="n" data-glyph="110,2" class="t t"><span id="cdb1e363ab303d5f">WSManShellAsyncInternal</span></a>
            {
                <b>internal</b> <span class="i">IntPtr</span> <a id="76fa70cdae100847" href="../../../R/76fa70cdae100847.html" target="n" data-glyph="44,3" class="i field">operationContext</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="d3e0ab23a9d38cdf" href="../../../R/d3e0ab23a9d38cdf.html" target="n" data-glyph="44,3" class="i field">asyncCallback</a>;
            }
 
            <b>private</b> <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <a id="9e1281ad5e73924a" href="../../../R/9e1281ad5e73924a.html" target="n" data-glyph="46,2" class="i field">_data</a>;
            <b>private</b> <a href="#ee672255526aafad" class="t t">WSManShellAsyncInternal</a> <a id="a35ea97831058531" href="../../../R/a35ea97831058531.html" target="n" data-glyph="46,2" class="i field">_internalData</a>;
 
            <b>internal</b> <a id="d3c47769c10efcdb" href="../../../R/d3c47769c10efcdb.html" target="n" data-glyph="74,2" class="t constructor">WSManShellAsync</a>(<span class="i">IntPtr</span> <span id="r96 rd" class="r96 r">context</span>, <a href="#9855dfa19ee2dc9d" class="t t">WSManShellAsyncCallback</a> <span id="r97 rd" class="r97 r">callback</span>)
            {
                <a href="#a35ea97831058531" class="i field">_internalData</a> = <b>new</b> <span class="t">WSManShellAsyncInternal</span>();
                <a href="#a35ea97831058531" class="i field">_internalData</a>.<a href="#76fa70cdae100847" class="i field">operationContext</a> = <span class="r96 r">context</span>;
 
                <a href="#a35ea97831058531" class="i field">_internalData</a>.<a href="#d3e0ab23a9d38cdf" class="i field">asyncCallback</a> = <span class="r97 r">callback</span>;
                <a href="#9e1281ad5e73924a" class="i field">_data</a> = <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a>.<a href="#1add673d540690ed" class="i method">Create</a>&lt;<a href="#ee672255526aafad" class="t t">WSManShellAsyncInternal</a>&gt;(<a href="#a35ea97831058531" class="i field">_internalData</a>);
            }
 
            <b>public void</b> <a id="c68800d727cb6a45" href="../../../R/c68800d727cb6a45.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#9e1281ad5e73924a" class="i field">_data</a>.<a href="#c8215c839d2c27ef" class="i method">Dispose</a>();
            }
 
            <b>public static implicit operator</b> <span class="i">IntPtr</span>(<a href="#5659ff525f41a5f1" class="t t">WSManShellAsync</a> <span id="r98 rd" class="r98 r">async</span>)
            {
                <b>return</b> <span class="r98 r">async</span>.<a href="#9e1281ad5e73924a" class="i field">_data</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used in the shell completion function delegate to refer to error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="587a4e1f26edb30b" href="../../../R/587a4e1f26edb30b.html" target="n" data-glyph="110,1" class="t t"><span id="8b1075ea50df0e68">WSManError</span></a>
        {
            <b>internal int</b> <a id="3bfbb0e97567321f" href="../../../R/3bfbb0e97567321f.html" target="n" data-glyph="44,2" class="i field">errorCode</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Extended error description from the fault;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal string</b> <a id="5497bacefa3538a3" href="../../../R/5497bacefa3538a3.html" target="n" data-glyph="44,2" class="i field">errorDetail</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Language for error description (RFC 3066 language code); it can be NULL.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal string</b> <a id="3a8ab9bfb763351c" href="../../../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">language</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Machine id; it can be NULL.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal string</b> <a id="ef09a5e116c25765" href="../../../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">machineName</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs a WSManError from the unmanaged pointer.</span>
            <span class="c">///</span><span class="c"> This involves copying data from unmanaged memory to managed heap.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Pointer to unmanaged data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#587a4e1f26edb30b" class="t t">WSManError</a> <a id="0577f3d9734092d0" href="../../../R/0577f3d9734092d0.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r99 rd" class="r99 r">unmanagedData</span>)
            {
                <b>return</b> <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#587a4e1f26edb30b" class="t t">WSManError</a>&gt;(<span class="r99 r">unmanagedData</span>);
            }
        }
 
        <b>internal class</b> <a id="d03b82b6a40c6238" href="../../../R/d03b82b6a40c6238.html" target="n" data-glyph="2,1" class="t t"><span id="dc2f1885ef2cdd51">WSManCreateShellDataResult</span></a>
        {
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="8ebf2bda861d350f" href="../../../R/8ebf2bda861d350f.html" target="n" data-glyph="112,2" class="t t"><span id="915cee8377cf9aa3">WSManCreateShellDataResultInternal</span></a>
            {
                <b>internal</b> <a href="#1cc36e5df9b12f8b" class="t t">WSManDataStruct</a> <a id="1b2f3cd907a0c7aa" href="../../../R/1b2f3cd907a0c7aa.html" target="n" data-glyph="44,3" class="i field">data</a>;
            }
 
            <b>internal string</b> <a id="3fe1643210e0fb7c" href="../../../R/3fe1643210e0fb7c.html" target="n" data-glyph="44,2" class="i field">data</a>;
 
            <b>internal static</b> <a href="#d03b82b6a40c6238" class="t t">WSManCreateShellDataResult</a> <a id="1362ad8d6d464ebe" href="../../../R/1362ad8d6d464ebe.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r100 rd" class="r100 r">unmanagedData</span>)
            {
                <a href="#d03b82b6a40c6238" class="t t">WSManCreateShellDataResult</a> <span id="r101 rd" class="r101 r">result</span> = <b>new</b> <span class="t">WSManCreateShellDataResult</span>();
 
                <b>if</b> (<span class="r100 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#8ebf2bda861d350f" class="t t">WSManCreateShellDataResultInternal</a> <span id="r102 rd" class="r102 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#8ebf2bda861d350f" class="t t">WSManCreateShellDataResultInternal</a>&gt;(<span class="r100 r">unmanagedData</span>);
 
                    <b>string</b> <span id="r103 rd" class="r103 r">connectData</span> = <b>null</b>;
                    <b>if</b> (<span class="r102 r">resultInternal</span>.<a href="#1b2f3cd907a0c7aa" class="i field">data</a>.<a href="#12a38eb371a4607a" class="i field">textData</a>.<a href="#6d400f2f4a388604" class="i field">textLength</a> &gt; 0)
                    {
                        <span class="r103 r">connectData</span> = <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r102 r">resultInternal</span>.<a href="#1b2f3cd907a0c7aa" class="i field">data</a>.<a href="#12a38eb371a4607a" class="i field">textData</a>.<a href="#7b4c1bfdf3c11ec5" class="i field">text</a>, <span class="r102 r">resultInternal</span>.<a href="#1b2f3cd907a0c7aa" class="i field">data</a>.<a href="#12a38eb371a4607a" class="i field">textData</a>.<a href="#6d400f2f4a388604" class="i field">textLength</a>);
                    }
 
                    <span class="r101 r">result</span>.<a href="#3fe1643210e0fb7c" class="i field">data</a> = <span class="r103 r">connectData</span>;
                }
 
                <b>return</b> <span class="r101 r">result</span>;
            }
 
            <span class="c">// The following structures are created to honor struct boundaries</span>
            <span class="c">// on x86,amd64 and ia64</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="1cc36e5df9b12f8b" href="../../../R/1cc36e5df9b12f8b.html" target="n" data-glyph="112,2" class="t t"><span id="ada4e0bd92ee8aaa">WSManDataStruct</span></a>
            {
                <b>internal uint</b> <a id="61f2a8f599c8bb34" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">type</a>;
                <b>internal</b> <a href="#93a0e6986b212186" class="t t">WSManTextDataInternal</a> <a id="12a38eb371a4607a" href="../../../R/12a38eb371a4607a.html" target="n" data-glyph="44,3" class="i field">textData</a>;
            }
 
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="93a0e6986b212186" href="../../../R/93a0e6986b212186.html" target="n" data-glyph="112,2" class="t t"><span id="c97da9d3fe0ac45c">WSManTextDataInternal</span></a>
            {
                <b>internal int</b> <a id="6d400f2f4a388604" href="../../../R/6d400f2f4a388604.html" target="n" data-glyph="44,3" class="i field">textLength</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="7b4c1bfdf3c11ec5" href="../../../R/7b4c1bfdf3c11ec5.html" target="n" data-glyph="44,3" class="i field">text</a>;
            }
        }
 
        <b>internal class</b> <a id="c0a7213e3beffad1" href="../../../R/c0a7213e3beffad1.html" target="n" data-glyph="2,1" class="t t"><span id="30af36c694830a71">WSManConnectDataResult</span></a>
        {
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="042c523f99c92d34" href="../../../R/042c523f99c92d34.html" target="n" data-glyph="112,2" class="t t"><span id="08184a7c9214ee4a">WSManConnectDataResultInternal</span></a>
            {
                <b>internal</b> <a href="#721020e0268e0b94" class="t t">WSManDataStruct</a> <a id="506a0fd306bc56d0" href="../../../R/506a0fd306bc56d0.html" target="n" data-glyph="44,3" class="i field">data</a>;
            }
 
            <b>internal string</b> <a id="14ae052e7a3f769e" href="../../../R/14ae052e7a3f769e.html" target="n" data-glyph="44,2" class="i field">data</a>;
 
            <b>internal static</b> <a href="#c0a7213e3beffad1" class="t t">WSManConnectDataResult</a> <a id="2cdf5280502c1cfc" href="../../../R/2cdf5280502c1cfc.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r104 rd" class="r104 r">unmanagedData</span>)
            {
                <a href="#042c523f99c92d34" class="t t">WSManConnectDataResultInternal</a> <span id="r105 rd" class="r105 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#042c523f99c92d34" class="t t">WSManConnectDataResultInternal</a>&gt;(<span class="r104 r">unmanagedData</span>);
 
                <b>string</b> <span id="r106 rd" class="r106 r">connectData</span> = <b>null</b>;
                <b>if</b> (<span class="r105 r">resultInternal</span>.<a href="#506a0fd306bc56d0" class="i field">data</a>.<a href="#65e9c9f2d2c05610" class="i field">textData</a>.<a href="#c261aed7ea0bb889" class="i field">textLength</a> &gt; 0)
                {
                    <span class="r106 r">connectData</span> = <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r105 r">resultInternal</span>.<a href="#506a0fd306bc56d0" class="i field">data</a>.<a href="#65e9c9f2d2c05610" class="i field">textData</a>.<a href="#db42c41bf9a81d48" class="i field">text</a>, <span class="r105 r">resultInternal</span>.<a href="#506a0fd306bc56d0" class="i field">data</a>.<a href="#65e9c9f2d2c05610" class="i field">textData</a>.<a href="#c261aed7ea0bb889" class="i field">textLength</a>);
                }
 
                <a href="#c0a7213e3beffad1" class="t t">WSManConnectDataResult</a> <span id="r107 rd" class="r107 r">result</span> = <b>new</b> <span class="t">WSManConnectDataResult</span>();
                <span class="r107 r">result</span>.<a href="#14ae052e7a3f769e" class="i field">data</a> = <span class="r106 r">connectData</span>;
 
                <b>return</b> <span class="r107 r">result</span>;
            }
 
            <span class="c">// The following structures are created to honor struct boundaries</span>
            <span class="c">// on x86,amd64 and ia64</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="721020e0268e0b94" href="../../../R/721020e0268e0b94.html" target="n" data-glyph="112,2" class="t t"><span id="04dcdb06eaf180ce">WSManDataStruct</span></a>
            {
                <b>internal uint</b> <a id="0d1fce16062f5102" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">type</a>;
                <b>internal</b> <a href="#d1f84497d12fb6ff" class="t t">WSManTextDataInternal</a> <a id="65e9c9f2d2c05610" href="../../../R/65e9c9f2d2c05610.html" target="n" data-glyph="44,3" class="i field">textData</a>;
            }
 
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="d1f84497d12fb6ff" href="../../../R/d1f84497d12fb6ff.html" target="n" data-glyph="112,2" class="t t"><span id="720535e6362abfb8">WSManTextDataInternal</span></a>
            {
                <b>internal int</b> <a id="c261aed7ea0bb889" href="../../../R/c261aed7ea0bb889.html" target="n" data-glyph="44,3" class="i field">textLength</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="db42c41bf9a81d48" href="../../../R/db42c41bf9a81d48.html" target="n" data-glyph="44,3" class="i field">text</a>;
            }
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used in the shell completion function delegate to refer to the data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="42e20c3ae6d2041e" href="../../../R/42e20c3ae6d2041e.html" target="n" data-glyph="2,1" class="t t"><span id="9aa9c639d6409434">WSManReceiveDataResult</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The actual data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal byte</b>[] <a id="46da8fe2d7e03572" href="../../../R/46da8fe2d7e03572.html" target="n" data-glyph="44,2" class="i field">data</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Stream the data belongs to.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal string</b> <a id="e270270622375fa7" href="../../../R/e270270622375fa7.html" target="n" data-glyph="44,2" class="i field">stream</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constructs a WSManReceiveDataResult from the unmanaged pointer.</span>
            <span class="c">///</span><span class="c"> This involves copying data from unmanaged memory to managed heap.</span>
            <span class="c">///</span><span class="c"> Currently PowerShell supports only binary data on the wire, so this</span>
            <span class="c">///</span><span class="c"> method asserts if the data is not binary.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Pointer to unmanaged data.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#42e20c3ae6d2041e" class="t t">WSManReceiveDataResult</a> <a id="ff8bae8b21e53a27" href="../../../R/ff8bae8b21e53a27.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r108 rd" class="r108 r">unmanagedData</span>)
            {
                <a href="#a69c0af2614d9e5f" class="t t">WSManReceiveDataResultInternal</a> <span id="r109 rd" class="r109 r">result1</span> =
                    <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#a69c0af2614d9e5f" class="t t">WSManReceiveDataResultInternal</a>&gt;(<span class="r108 r">unmanagedData</span>);
 
                <span class="c">// copy data from unmanaged heap to managed heap.</span>
                <b>byte</b>[] <span id="r110 rd" class="r110 r">dataRecvd</span> = <b>null</b>;
                <b>if</b> (<span class="r109 r">result1</span>.<a href="#1247a56b79b22d67" class="i field">data</a>.<a href="#d77aa03c0661ff3a" class="i field">binaryData</a>.<a href="#dd46ec8562a02b46" class="i field">bufferLength</a> &gt; 0)
                {
                    <span class="r110 r">dataRecvd</span> = <b>new</b> <b>byte</b>[<span class="r109 r">result1</span>.<a href="#1247a56b79b22d67" class="i field">data</a>.<a href="#d77aa03c0661ff3a" class="i field">binaryData</a>.<a href="#dd46ec8562a02b46" class="i field">bufferLength</a>];
                    <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r109 r">result1</span>.<a href="#1247a56b79b22d67" class="i field">data</a>.<a href="#d77aa03c0661ff3a" class="i field">binaryData</a>.<a href="#e2745455119bdc51" class="i field">buffer</a>,
                        <span class="r110 r">dataRecvd</span>,
                        0,
                        <span class="r109 r">result1</span>.<a href="#1247a56b79b22d67" class="i field">data</a>.<a href="#d77aa03c0661ff3a" class="i field">binaryData</a>.<a href="#dd46ec8562a02b46" class="i field">bufferLength</a>);
                }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r109 r">result1</span>.<a href="#1247a56b79b22d67" class="i field">data</a>.<a href="#5fa7f2b381d4c78b" class="i field">type</a> == (<b>uint</b>)<a href="#46ddd0c66b953490" class="t t">WSManDataType</a>.<a href="#a68a60c7335805ed" class="i field">WSMAN_DATA_TYPE_BINARY</a>,
                    <span class="s">&quot;ReceiveDataResult can receive only binary data&quot;</span>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
                <a href="#42e20c3ae6d2041e" class="t t">WSManReceiveDataResult</a> <span id="r111 rd" class="r111 r">result</span> = <b>new</b> <span class="t">WSManReceiveDataResult</span>();
                <span class="r111 r">result</span>.<a href="#46da8fe2d7e03572" class="i field">data</a> = <span class="r110 r">dataRecvd</span>;
                <span class="r111 r">result</span>.<a href="#e270270622375fa7" class="i field">stream</a> = <span class="r109 r">result1</span>.<a href="#cc602240f0826016" class="i field">streamId</a>;
 
                <b>return</b> <span class="r111 r">result</span>;
            }
 
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="a69c0af2614d9e5f" href="../../../R/a69c0af2614d9e5f.html" target="n" data-glyph="112,2" class="t t"><span id="029a01726d65f205">WSManReceiveDataResultInternal</span></a>
            {
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="cc602240f0826016" href="../../../R/cc602240f0826016.html" target="n" data-glyph="44,3" class="i field">streamId</a>;
 
                <b>internal</b> <a href="#6059ad957f88f762" class="t t">WSManDataStruct</a> <a id="1247a56b79b22d67" href="../../../R/1247a56b79b22d67.html" target="n" data-glyph="44,3" class="i field">data</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="0b7e28569143ba78" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">commandState</a>;
 
                <b>internal int</b> <a id="044f0a4eb79fa72f" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">exitCode</a>;
            }
 
            <span class="c">// The following structures are created to honor struct boundaries</span>
            <span class="c">// on x86,amd64 and ia64</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="6059ad957f88f762" href="../../../R/6059ad957f88f762.html" target="n" data-glyph="112,2" class="t t"><span id="1317ccb8f824ff43">WSManDataStruct</span></a>
            {
                <b>internal uint</b> <a id="5fa7f2b381d4c78b" href="../../../R/5fa7f2b381d4c78b.html" target="n" data-glyph="44,3" class="i field">type</a>;
                <b>internal</b> <a href="#c71e561a0d35dd32" class="t t">WSManBinaryDataInternal</a> <a id="d77aa03c0661ff3a" href="../../../R/d77aa03c0661ff3a.html" target="n" data-glyph="44,3" class="i field">binaryData</a>;
            }
 
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
            <b>private struct</b> <a id="c71e561a0d35dd32" href="../../../R/c71e561a0d35dd32.html" target="n" data-glyph="112,2" class="t t"><span id="e7605704cb192bd1">WSManBinaryDataInternal</span></a>
            {
                <b>internal int</b> <a id="dd46ec8562a02b46" href="../../../R/dd46ec8562a02b46.html" target="n" data-glyph="44,3" class="i field">bufferLength</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="e2745455119bdc51" href="../../../R/e2745455119bdc51.html" target="n" data-glyph="44,3" class="i field">buffer</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Plugin API Structure Definitions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the managed representation of the WSMAN_PLUGIN_REQUEST struct.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="07d21d2cee8c9d82" href="../../../R/07d21d2cee8c9d82.html" target="n" data-glyph="2,1" class="t t"><span id="9692e947fe42a8cd">WSManPluginRequest</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Unmarshaled WSMAN_SENDER_DETAILS struct.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a href="#8148734a21006dcf" class="t t">WSManSenderDetails</a> <a id="10ad3eda597bdf65" href="../../../R/10ad3eda597bdf65.html" target="n" data-glyph="44,2" class="i field">senderDetails</a>;
            <b>internal string</b> <a id="959aa72d58cb0071" href="../../../R/959aa72d58cb0071.html" target="n" data-glyph="44,2" class="i field">locale</a>;
            <b>internal string</b> <a id="b6c51fbca52e1bdd" href="../../../R/b6c51fbca52e1bdd.html" target="n" data-glyph="44,2" class="i field">resourceUri</a>;
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Unmarshaled WSMAN_OPERATION_INFO struct.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a href="#bee5cec99b904bab" class="t t">WSManOperationInfo</a> <a id="8fa7923067133d6f" href="../../../R/8fa7923067133d6f.html" target="n" data-glyph="44,2" class="i field">operationInfo</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Kept around to allow direct access to shutdownNotification and its handle.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private</b> <a href="#282cd2bcdfd16d5f" class="t t">WSManPluginRequestInternal</a> <a id="2e46c7cb09119a4d" href="../../../R/2e46c7cb09119a4d.html" target="n" data-glyph="46,2" class="i field">_internalDetails</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Volatile value that should be read directly from its unmanaged location.</span>
            <span class="c">///</span><span class="c"> TODO: Does &quot;volatile&quot; still apply when accessing it in managed code.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal bool</b> <a id="34109b5650eafe31" href="../../../R/../../0000000000.html" target="n" data-glyph="104,2" class="i property">shutdownNotification</a>
            {
                <b>get</b> { <b>return</b> <a href="#2e46c7cb09119a4d" class="i field">_internalDetails</a>.<a href="#88cfd5ae29ceffba" class="i field">shutdownNotification</a>; }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Left untouched in unmanaged memory because it is passed directly to</span>
            <span class="c">///</span><span class="c"> RegisterWaitForSingleObject().</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="0e238bf7e1d2305e" href="../../../R/0e238bf7e1d2305e.html" target="n" data-glyph="104,2" class="i property">shutdownNotificationHandle</a>
            {
                <b>get</b> { <b>return</b> <a href="#2e46c7cb09119a4d" class="i field">_internalDetails</a>.<a href="#244d7897e3a7cecc" class="i field">shutdownNotificationHandle</a>; }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Copy of the unmanagedData value used to create the structure.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <span class="i">IntPtr</span> <a id="0bd4e014382d2f95" href="../../../R/0bd4e014382d2f95.html" target="n" data-glyph="44,2" class="i field">unmanagedHandle</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#07d21d2cee8c9d82" class="t t">WSManPluginRequest</a> <a id="11fd0761e282b189" href="../../../R/11fd0761e282b189.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r112 rd" class="r112 r">unmanagedData</span>)
            {
                <span class="c">// Dbg.Assert(IntPtr.Zero != unmanagedData, &quot;unmanagedData must be non-null. This means WinRM sent a bad pointer.&quot;);</span>
                <a href="#07d21d2cee8c9d82" class="t t">WSManPluginRequest</a> <span id="r113 rd" class="r113 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r112 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#282cd2bcdfd16d5f" class="t t">WSManPluginRequestInternal</a> <span id="r114 rd" class="r114 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#282cd2bcdfd16d5f" class="t t">WSManPluginRequestInternal</a>&gt;(<span class="r112 r">unmanagedData</span>);
 
                    <span class="r113 r">result</span> = <b>new</b> <span class="t">WSManPluginRequest</span>();
                    <span class="r113 r">result</span>.<a href="#10ad3eda597bdf65" class="i field">senderDetails</a> = <a href="#8148734a21006dcf" class="t t">WSManSenderDetails</a>.<a href="#fd662106b351784b" class="i method">UnMarshal</a>(<span class="r114 r">resultInternal</span>.<a href="#74af338d01c488f7" class="i field">senderDetails</a>);
                    <span class="r113 r">result</span>.<a href="#959aa72d58cb0071" class="i field">locale</a> = <span class="r114 r">resultInternal</span>.<a href="#a3688d29a66b7f12" class="i field">locale</a>;
                    <span class="r113 r">result</span>.<a href="#b6c51fbca52e1bdd" class="i field">resourceUri</a> = <span class="r114 r">resultInternal</span>.<a href="#4a1a321c0f4f129f" class="i field">resourceUri</a>;
                    <span class="r113 r">result</span>.<a href="#8fa7923067133d6f" class="i field">operationInfo</a> = <a href="#bee5cec99b904bab" class="t t">WSManOperationInfo</a>.<a href="#2c6a3bf9ec0fa520" class="i method">UnMarshal</a>(<span class="r114 r">resultInternal</span>.<a href="#f91babcf7f1aec9b" class="i field">operationInfo</a>);
                    <span class="r113 r">result</span>.<a href="#2e46c7cb09119a4d" class="i field">_internalDetails</a> = <span class="r114 r">resultInternal</span>;
                    <span class="r113 r">result</span>.<a href="#0bd4e014382d2f95" class="i field">unmanagedHandle</a> = <span class="r112 r">unmanagedData</span>;
                }
 
                <b>return</b> <span class="r113 r">result</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Representation of WSMAN_PLUGIN_REQUEST.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>private struct</b> <a id="282cd2bcdfd16d5f" href="../../../R/282cd2bcdfd16d5f.html" target="n" data-glyph="112,2" class="t t"><span id="51dbddc49896b276">WSManPluginRequestInternal</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> WSManSenderDetails.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <span class="i">IntPtr</span> <a id="74af338d01c488f7" href="../../../R/74af338d01c488f7.html" target="n" data-glyph="44,3" class="i field">senderDetails</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="a3688d29a66b7f12" href="../../../R/a3688d29a66b7f12.html" target="n" data-glyph="44,3" class="i field">locale</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="4a1a321c0f4f129f" href="../../../R/4a1a321c0f4f129f.html" target="n" data-glyph="44,3" class="i field">resourceUri</a>;
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> WSManOperationInfo.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <span class="i">IntPtr</span> <a id="f91babcf7f1aec9b" href="../../../R/f91babcf7f1aec9b.html" target="n" data-glyph="44,3" class="i field">operationInfo</a>;
                <b>internal bool</b> <a id="88cfd5ae29ceffba" href="../../../R/88cfd5ae29ceffba.html" target="n" data-glyph="44,3" class="i field">shutdownNotification</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="244d7897e3a7cecc" href="../../../R/244d7897e3a7cecc.html" target="n" data-glyph="44,3" class="i field">shutdownNotificationHandle</a>;
            }
        }
 
        <b>internal class</b> <a id="8148734a21006dcf" href="../../../R/8148734a21006dcf.html" target="n" data-glyph="2,1" class="t t"><span id="410c4cc0258462ad">WSManSenderDetails</span></a>
        {
            <b>internal string</b> <a id="6220ec7bb9cff9b0" href="../../../R/6220ec7bb9cff9b0.html" target="n" data-glyph="44,2" class="i field">senderName</a>;
            <b>internal string</b> <a id="996d9e3e97a36880" href="../../../R/996d9e3e97a36880.html" target="n" data-glyph="44,2" class="i field">authenticationMechanism</a>;
            <b>internal</b> <a href="#c5c09a3fc157695d" class="t t">WSManCertificateDetails</a> <a id="a889db7b39ac6999" href="../../../R/a889db7b39ac6999.html" target="n" data-glyph="44,2" class="i field">certificateDetails</a>;
            <b>internal</b> <span class="i">IntPtr</span> <a id="61851d4bd57bd864" href="../../../R/61851d4bd57bd864.html" target="n" data-glyph="44,2" class="i field">clientToken</a>; <span class="c">// TODO: How should this be marshaled?????</span>
            <b>internal string</b> <a id="38231d1fc9effcef" href="../../../R/38231d1fc9effcef.html" target="n" data-glyph="44,2" class="i field">httpUrl</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#8148734a21006dcf" class="t t">WSManSenderDetails</a> <a id="fd662106b351784b" href="../../../R/fd662106b351784b.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r115 rd" class="r115 r">unmanagedData</span>)
            {
                <a href="#8148734a21006dcf" class="t t">WSManSenderDetails</a> <span id="r116 rd" class="r116 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r115 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#f27ed8084e794275" class="t t">WSManSenderDetailsInternal</a> <span id="r117 rd" class="r117 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#f27ed8084e794275" class="t t">WSManSenderDetailsInternal</a>&gt;(<span class="r115 r">unmanagedData</span>);
 
                    <span class="r116 r">result</span> = <b>new</b> <span class="t">WSManSenderDetails</span>();
                    <span class="r116 r">result</span>.<a href="#6220ec7bb9cff9b0" class="i field">senderName</a> = <span class="r117 r">resultInternal</span>.<a href="#cf340e7b84e2427c" class="i field">senderName</a>;
                    <span class="r116 r">result</span>.<a href="#996d9e3e97a36880" class="i field">authenticationMechanism</a> = <span class="r117 r">resultInternal</span>.<a href="#ae9626f2bf264f4f" class="i field">authenticationMechanism</a>;
                    <span class="r116 r">result</span>.<a href="#a889db7b39ac6999" class="i field">certificateDetails</a> = <a href="#c5c09a3fc157695d" class="t t">WSManCertificateDetails</a>.<a href="#10fcc8619bceb410" class="i method">UnMarshal</a>(<span class="r117 r">resultInternal</span>.<a href="#13f724ec177c42c5" class="i field">certificateDetails</a>);
                    <span class="r116 r">result</span>.<a href="#61851d4bd57bd864" class="i field">clientToken</a> = <span class="r117 r">resultInternal</span>.<a href="#7f1f254d474ac037" class="i field">clientToken</a>; <span class="c">// TODO: UnMarshaling needed here!!!!</span>
                    <span class="r116 r">result</span>.<a href="#38231d1fc9effcef" class="i field">httpUrl</a> = <span class="r117 r">resultInternal</span>.<a href="#ceb022ec4a353648" class="i field">httpUrl</a>;
                }
 
                <b>return</b> <span class="r116 r">result</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Managed representation of WSMAN_SENDER_DETAILS.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>private struct</b> <a id="f27ed8084e794275" href="../../../R/f27ed8084e794275.html" target="n" data-glyph="112,2" class="t t"><span id="e57742568c6b8f13">WSManSenderDetailsInternal</span></a>
            {
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="cf340e7b84e2427c" href="../../../R/cf340e7b84e2427c.html" target="n" data-glyph="44,3" class="i field">senderName</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="ae9626f2bf264f4f" href="../../../R/ae9626f2bf264f4f.html" target="n" data-glyph="44,3" class="i field">authenticationMechanism</a>;
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> WSManCertificateDetails.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <span class="i">IntPtr</span> <a id="13f724ec177c42c5" href="../../../R/13f724ec177c42c5.html" target="n" data-glyph="44,3" class="i field">certificateDetails</a>;
                <b>internal</b> <span class="i">IntPtr</span> <a id="7f1f254d474ac037" href="../../../R/7f1f254d474ac037.html" target="n" data-glyph="44,3" class="i field">clientToken</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="ceb022ec4a353648" href="../../../R/ceb022ec4a353648.html" target="n" data-glyph="44,3" class="i field">httpUrl</a>;
            }
        }
 
        <b>internal class</b> <a id="c5c09a3fc157695d" href="../../../R/c5c09a3fc157695d.html" target="n" data-glyph="2,1" class="t t"><span id="8b38241960fb4931">WSManCertificateDetails</span></a>
        {
            <b>internal string</b> <a id="e95fa434cdbc63d9" href="../../../R/e95fa434cdbc63d9.html" target="n" data-glyph="44,2" class="i field">subject</a>;
            <b>internal string</b> <a id="9dd858bdd1fe9391" href="../../../R/9dd858bdd1fe9391.html" target="n" data-glyph="44,2" class="i field">issuerName</a>;
            <b>internal string</b> <a id="6d4cc8d6f04fdfa4" href="../../../R/6d4cc8d6f04fdfa4.html" target="n" data-glyph="44,2" class="i field">issuerThumbprint</a>;
            <b>internal string</b> <a id="c59adf4593fe3187" href="../../../R/c59adf4593fe3187.html" target="n" data-glyph="44,2" class="i field">subjectName</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#c5c09a3fc157695d" class="t t">WSManCertificateDetails</a> <a id="10fcc8619bceb410" href="../../../R/10fcc8619bceb410.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r118 rd" class="r118 r">unmanagedData</span>)
            {
                <a href="#c5c09a3fc157695d" class="t t">WSManCertificateDetails</a> <span id="r119 rd" class="r119 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r118 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#615190e7b9cd78cc" class="t t">WSManCertificateDetailsInternal</a> <span id="r120 rd" class="r120 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#615190e7b9cd78cc" class="t t">WSManCertificateDetailsInternal</a>&gt;(<span class="r118 r">unmanagedData</span>);
 
                    <span class="r119 r">result</span> = <b>new</b> <span class="t">WSManCertificateDetails</span>();
                    <span class="r119 r">result</span>.<a href="#e95fa434cdbc63d9" class="i field">subject</a> = <span class="r120 r">resultInternal</span>.<a href="#3e2d83c1756e3380" class="i field">subject</a>;
                    <span class="r119 r">result</span>.<a href="#9dd858bdd1fe9391" class="i field">issuerName</a> = <span class="r120 r">resultInternal</span>.<a href="#f60f78f1e0f64592" class="i field">issuerName</a>;
                    <span class="r119 r">result</span>.<a href="#6d4cc8d6f04fdfa4" class="i field">issuerThumbprint</a> = <span class="r120 r">resultInternal</span>.<a href="#80a56ea9ea3fa405" class="i field">issuerThumbprint</a>;
                    <span class="r119 r">result</span>.<a href="#c59adf4593fe3187" class="i field">subjectName</a> = <span class="r120 r">resultInternal</span>.<a href="#f415a84bf668d240" class="i field">subjectName</a>;
                }
 
                <b>return</b> <span class="r119 r">result</span>;
            }
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Managed representation of WSMAN_CERTIFICATE_DETAILS.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>private struct</b> <a id="615190e7b9cd78cc" href="../../../R/615190e7b9cd78cc.html" target="n" data-glyph="112,2" class="t t"><span id="483c776fb63cb203">WSManCertificateDetailsInternal</span></a>
            {
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="3e2d83c1756e3380" href="../../../R/3e2d83c1756e3380.html" target="n" data-glyph="44,3" class="i field">subject</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="f60f78f1e0f64592" href="../../../R/f60f78f1e0f64592.html" target="n" data-glyph="44,3" class="i field">issuerName</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="80a56ea9ea3fa405" href="../../../R/80a56ea9ea3fa405.html" target="n" data-glyph="44,3" class="i field">issuerThumbprint</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="f415a84bf668d240" href="../../../R/f415a84bf668d240.html" target="n" data-glyph="44,3" class="i field">subjectName</a>;
            }
        }
 
        <b>internal class</b> <a id="bee5cec99b904bab" href="../../../R/bee5cec99b904bab.html" target="n" data-glyph="2,1" class="t t"><span id="ea45858a2f75eaf4">WSManOperationInfo</span></a>
        {
            <b>internal</b> <a href="#fab6600c2bfb531d" class="t t">WSManFragmentInternal</a> <a id="029b4b05efb11788" href="../../../R/029b4b05efb11788.html" target="n" data-glyph="44,2" class="i field">fragment</a>;
            <b>internal</b> <a href="#8ad3887c9a42167b" class="t t">WSManFilterInternal</a> <a id="110a7feb83f153af" href="../../../R/110a7feb83f153af.html" target="n" data-glyph="44,2" class="i field">filter</a>;
            <b>internal</b> <a href="#01e8e846a0d21fac" class="t t">WSManSelectorSet</a> <a id="5e5e0f480631f13f" href="../../../R/5e5e0f480631f13f.html" target="n" data-glyph="44,2" class="i field">selectorSet</a>;
            <b>internal</b> <a href="#04451905aba58b51" class="t t">WSManOptionSet</a> <a id="21f6aad990635900" href="../../../R/21f6aad990635900.html" target="n" data-glyph="44,2" class="i field">optionSet</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">unmanagedData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#bee5cec99b904bab" class="t t">WSManOperationInfo</a> <a id="2c6a3bf9ec0fa520" href="../../../R/2c6a3bf9ec0fa520.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<span class="i">IntPtr</span> <span id="r121 rd" class="r121 r">unmanagedData</span>)
            {
                <a href="#bee5cec99b904bab" class="t t">WSManOperationInfo</a> <span id="r122 rd" class="r122 r">result</span> = <b>null</b>;
 
                <b>if</b> (<span class="r121 r">unmanagedData</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <a href="#4cff985af9f24703" class="t t">WSManOperationInfoInternal</a> <span id="r123 rd" class="r123 r">resultInternal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#4cff985af9f24703" class="t t">WSManOperationInfoInternal</a>&gt;(<span class="r121 r">unmanagedData</span>);
 
                    <span class="r122 r">result</span> = <b>new</b> <span class="t">WSManOperationInfo</span>();
                    <span class="r122 r">result</span>.<a href="#029b4b05efb11788" class="i field">fragment</a> = <span class="r123 r">resultInternal</span>.<a href="#0fa3efdb03464df0" class="i field">fragment</a>;
                    <span class="r122 r">result</span>.<a href="#110a7feb83f153af" class="i field">filter</a> = <span class="r123 r">resultInternal</span>.<a href="#6bb8bd79ea80e26d" class="i field">filter</a>;
                    <span class="r122 r">result</span>.<a href="#5e5e0f480631f13f" class="i field">selectorSet</a> = <a href="#01e8e846a0d21fac" class="t t">WSManSelectorSet</a>.<a href="#2e16d08187d3db15" class="i method">UnMarshal</a>(<span class="r123 r">resultInternal</span>.<a href="#78a5460f507f135f" class="i field">selectorSet</a>);
                    <span class="r122 r">result</span>.<a href="#21f6aad990635900" class="i field">optionSet</a> = <a href="#04451905aba58b51" class="t t">WSManOptionSet</a>.<a href="#0ee1b70dcde48aa5" class="i method">UnMarshal</a>(<span class="r123 r">resultInternal</span>.<a href="#6b0fc3927c6cd87a" class="i field">optionSet</a>);
                }
 
                <b>return</b> <span class="r122 r">result</span>;
            }
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Managed representation of WSMAN_OPERATION_INFO.</span>
            <span class="c">///</span><span class="c"> selectorSet and optionSet are handled differently because they are structs that contain pointers to arrays of structs.</span>
            <span class="c">///</span><span class="c"> Most other data structures in the API point to structures using IntPtr rather than including the actual structure.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>private struct</b> <a id="4cff985af9f24703" href="../../../R/4cff985af9f24703.html" target="n" data-glyph="112,2" class="t t"><span id="4f4efa640d6adf23">WSManOperationInfoInternal</span></a>
            {
                <b>internal</b> <a href="#fab6600c2bfb531d" class="t t">WSManFragmentInternal</a> <a id="0fa3efdb03464df0" href="../../../R/0fa3efdb03464df0.html" target="n" data-glyph="44,3" class="i field">fragment</a>;
                <b>internal</b> <a href="#8ad3887c9a42167b" class="t t">WSManFilterInternal</a> <a id="6bb8bd79ea80e26d" href="../../../R/6bb8bd79ea80e26d.html" target="n" data-glyph="44,3" class="i field">filter</a>;
                <b>internal</b> <a href="#01e8e846a0d21fac" class="t t">WSManSelectorSet</a>.<a href="#5b55154ec2dd4390" class="t t">WSManSelectorSetStruct</a> <a id="78a5460f507f135f" href="../../../R/78a5460f507f135f.html" target="n" data-glyph="44,3" class="i field">selectorSet</a>;
                <b>internal</b> <a href="#7d016440574a58b3" class="t t">WSManOptionSetStruct</a> <a id="6b0fc3927c6cd87a" href="../../../R/6b0fc3927c6cd87a.html" target="n" data-glyph="44,3" class="i field">optionSet</a>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Managed representation of WSMAN_FRAGMENT.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>internal struct</b> <a id="fab6600c2bfb531d" href="../../../R/fab6600c2bfb531d.html" target="n" data-glyph="110,2" class="t t"><span id="be617cd53f635070">WSManFragmentInternal</span></a>
            {
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="7ead64b0dccf38e3" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">path</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="b4b9814596739023" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">dialect</a>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Managed representation of WSMAN_FILTER.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>internal struct</b> <a id="8ad3887c9a42167b" href="../../../R/8ad3887c9a42167b.html" target="n" data-glyph="110,2" class="t t"><span id="d81d1a095ca157e6">WSManFilterInternal</span></a>
            {
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="0ac59072bee17ad0" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">filter</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="e26df77a448d94c6" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">dialect</a>;
            }
        }
 
        <b>internal class</b> <a id="01e8e846a0d21fac" href="../../../R/01e8e846a0d21fac.html" target="n" data-glyph="2,1" class="t t"><span id="9ab710f538dc1f14">WSManSelectorSet</span></a>
        {
            <b>internal int</b> <a id="5cee423828a42b11" href="../../../R/5cee423828a42b11.html" target="n" data-glyph="44,2" class="i field">numberKeys</a>;
            <b>internal</b> <a href="#856e45d0ea1adaf3" class="t t">WSManKeyStruct</a>[] <a id="2f41592780d1dd06" href="../../../R/2f41592780d1dd06.html" target="n" data-glyph="44,2" class="i field">keys</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Converts the unmanaged pointer to a managed class object.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">resultInternal</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static</b> <a href="#01e8e846a0d21fac" class="t t">WSManSelectorSet</a> <a id="2e16d08187d3db15" href="../../../R/2e16d08187d3db15.html" target="n" data-glyph="74,2" class="i method">UnMarshal</a>(<a href="#5b55154ec2dd4390" class="t t">WSManSelectorSetStruct</a> <span id="r124 rd" class="r124 r">resultInternal</span>)
            {
                <a href="#856e45d0ea1adaf3" class="t t">WSManKeyStruct</a>[] <span id="r125 rd" class="r125 r">tempKeys</span> = <b>null</b>;
                <b>if</b> (<span class="r124 r">resultInternal</span>.<a href="#2a3f7e54294de5e2" class="i field">numberKeys</a> &gt; 0)
                {
                    <span class="r125 r">tempKeys</span> = <b>new</b> <a href="#856e45d0ea1adaf3" class="t t">WSManKeyStruct</a>[<span class="r124 r">resultInternal</span>.<a href="#2a3f7e54294de5e2" class="i field">numberKeys</a>];
                    <b>int</b> <span id="r126 rd" class="r126 r">sizeInBytes</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#856e45d0ea1adaf3" class="t t">WSManKeyStruct</a>&gt;();
                    <span class="i">IntPtr</span> <span id="r127 rd" class="r127 r">perElementPtr</span> = <span class="r124 r">resultInternal</span>.<a href="#aae4f9c8b065aebd" class="i field">keys</a>;
 
                    <b>for</b> (<b>int</b> <span id="r128 rd" class="r128 r">i</span> = 0; <span class="r128 r">i</span> &lt; <span class="r124 r">resultInternal</span>.<a href="#2a3f7e54294de5e2" class="i field">numberKeys</a>; <span class="r128 r">i</span>++)
                    {
                        <span class="i">IntPtr</span> <span id="r129 rd" class="r129 r">p</span> = <span class="i">IntPtr</span>.<span class="i">Add</span>(<span class="r127 r">perElementPtr</span>, (<span class="r128 r">i</span> * <span class="r126 r">sizeInBytes</span>));
                        <span class="r125 r">tempKeys</span>[<span class="r128 r">i</span>] = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#856e45d0ea1adaf3" class="t t">WSManKeyStruct</a>&gt;(<span class="r129 r">p</span>);
                    }
                }
 
                <a href="#01e8e846a0d21fac" class="t t">WSManSelectorSet</a> <span id="r130 rd" class="r130 r">result</span> = <b>new</b> <span class="t">WSManSelectorSet</span>();
                <span class="r130 r">result</span>.<a href="#5cee423828a42b11" class="i field">numberKeys</a> = <span class="r124 r">resultInternal</span>.<a href="#2a3f7e54294de5e2" class="i field">numberKeys</a>;
                <span class="r130 r">result</span>.<a href="#2f41592780d1dd06" class="i field">keys</a> = <span class="r125 r">tempKeys</span>;
 
                <b>return</b> <span class="r130 r">result</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Managed representation of WSMAN_SELECTOR_SET.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>internal struct</b> <a id="5b55154ec2dd4390" href="../../../R/5b55154ec2dd4390.html" target="n" data-glyph="110,2" class="t t"><span id="d180282f06cd5053">WSManSelectorSetStruct</span></a>
            {
                <b>internal int</b> <a id="2a3f7e54294de5e2" href="../../../R/2a3f7e54294de5e2.html" target="n" data-glyph="44,3" class="i field">numberKeys</a>;
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Array of WSManKeyStruct structures.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <span class="i">IntPtr</span> <a id="aae4f9c8b065aebd" href="../../../R/aae4f9c8b065aebd.html" target="n" data-glyph="44,3" class="i field">keys</a>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Managed representation of WSMAN_OPTION_SET.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>internal struct</b> <a id="856e45d0ea1adaf3" href="../../../R/856e45d0ea1adaf3.html" target="n" data-glyph="110,2" class="t t"><span id="1bcfb5e3aa10624a">WSManKeyStruct</span></a>
            {
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="840a922f7767aedf" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">key</a>;
 
                [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
                <b>internal string</b> <a id="a4501ee9f31d866b" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">value</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> DllImports ClientAPI
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
        <b>internal const string</b> <a id="fc4e08b7e3e2fcff" href="../../../R/fc4e08b7e3e2fcff.html" target="n" data-glyph="8,1" class="i field">WSManClientApiDll</a> = <span class="s">@&quot;WsmSvc.dll&quot;</span>;
        <b>internal const string</b> <a id="62fa2cb6f3055cba" href="../../../R/62fa2cb6f3055cba.html" target="n" data-glyph="8,1" class="i field">WSManProviderApiDll</a> = <span class="s">@&quot;WsmSvc.dll&quot;</span>;
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">        internal const string WSManClientApiDll = @&quot;libpsrpclient&quot;;
        internal const string WSManProviderApiDll = @&quot;libpsrpomiprov&quot;;
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This API is used to initialize the WinRM client;</span>
        <span class="c">///</span><span class="c"> It can be used by different clients on the same process, ie svchost.exe.</span>
        <span class="c">///</span><span class="c"> Returns a nonzero error code upon failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r132 r">wsManAPIHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="b08552b284baf3a8" href="../../../R/b08552b284baf3a8.html" target="n" data-glyph="74,1" class="i method">WSManInitialize</a>(<b>int</b> <span id="r131 rd" class="r131 r">flags</span>,
          [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">IntPtr</span> <span id="r132 rd" class="r132 r">wsManAPIHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This API deinitializes the Winrm client stack; all operations will</span>
        <span class="c">///</span><span class="c"> finish before this API will return; this is a sync call;</span>
        <span class="c">///</span><span class="c"> it is highly recommended that all operations are explicitly cancelled</span>
        <span class="c">///</span><span class="c"> and all sessions are closed before calling this API</span>
        <span class="c">///</span><span class="c"> Returns non zero error code upon failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">wsManAPIHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="890e76a5e680a7c1" href="../../../R/890e76a5e680a7c1.html" target="n" data-glyph="74,1" class="i method">WSManDeinitialize</a>(<span class="i">IntPtr</span> <span id="r133 rd" class="r133 r">wsManAPIHandle</span>, <b>int</b> <span id="r134 rd" class="r134 r">flags</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a session which can be used to perform subsequent operations</span>
        <span class="c">///</span><span class="c"> Returns a non zero error code upon failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">wsManAPIHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">connection</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if NULL, then connection will default to 127.0.0.1</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">authenticationCredentials</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> can be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">proxyInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="6de9aee5abd19720" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WSManCreateSession</a>(<span class="i">IntPtr</span> <span id="r135 rd" class="r135 r">wsManAPIHandle</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r136 rd" class="r136 r">connection</span>,
            <b>int</b> <span id="r137 rd" class="r137 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r138 rd" class="r138 r">authenticationCredentials</span>,
            <span class="i">IntPtr</span> <span id="r139 rd" class="r139 r">proxyInfo</span>,
            [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">IntPtr</span> <span id="r140 rd" class="r140 r">wsManSessionHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Frees memory of session and closes all related operations before returning;</span>
        <span class="c">///</span><span class="c"> this is sync call it is recommended that all pending operations are either</span>
        <span class="c">///</span><span class="c"> completed or cancelled before calling this API. Returns a non zero error</span>
        <span class="c">///</span><span class="c"> code upon failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="84cdff7876d8762a" href="../../../R/84cdff7876d8762a.html" target="n" data-glyph="74,1" class="i method">WSManCloseSession</a>(<span class="i">IntPtr</span> <span id="r141 rd" class="r141 r">wsManSessionHandle</span>,
            <b>int</b> <span id="r142 rd" class="r142 r">flags</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WSManSetSessionOption API - set session options</span>
        <span class="c">///</span><span class="c"> Returns a non zero error code upon failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r143 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">option</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An int (DWORD) data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static int</b> <a id="8657f3f36882e0cf" href="../../../R/8657f3f36882e0cf.html" target="n" data-glyph="74,1" class="i method">WSManSetSessionOption</a>(<span class="i">IntPtr</span> <span id="r143 rd" class="r143 r">wsManSessionHandle</span>,
            <a href="#f99c2939972a9aca" class="t t">WSManSessionOption</a> <span id="r144 rd" class="r144 r">option</span>,
            <a href="#4d2faff0872b41ab" class="t t">WSManDataDWord</a> <span id="r145 rd" class="r145 r">data</span>)
        {
            <a href="#b1daf795a3f58778" class="t t">MarshalledObject</a> <span id="r146 rd" class="r146 r">marshalObj</span> = <span class="r145 r">data</span>.<a href="#12d2ee289a545e7b" class="i method">Marshal</a>();
            <b>using</b> (<span class="r146 r">marshalObj</span>)
            {
                <b>return</b> <a href="#f90a5172f741cc29" class="i method">WSManSetSessionOption</a>(<span class="r143 r">wsManSessionHandle</span>, <span class="r144 r">option</span>, <span class="r146 r">marshalObj</span>.<a href="#bcf584319d6673a7" class="i property">DataPtr</a>);
            }
        }
 
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="f90a5172f741cc29" href="../../../R/f90a5172f741cc29.html" target="n" data-glyph="74,1" class="i method">WSManSetSessionOption</a>(<span class="i">IntPtr</span> <span id="r147 rd" class="r147 r">wsManSessionHandle</span>,
            <a href="#f99c2939972a9aca" class="t t">WSManSessionOption</a> <span id="r148 rd" class="r148 r">option</span>,
            <span class="i">IntPtr</span> <span id="r149 rd" class="r149 r">data</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WSManGetSessionOptionAsDword API - get a session option. Returns a non</span>
        <span class="c">///</span><span class="c"> zero error code upon failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">option</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An int (DWORD) data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Zero on success, otherwise the error code.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="fbfe20dc1839a3de" href="../../../R/fbfe20dc1839a3de.html" target="n" data-glyph="74,1" class="i method">WSManGetSessionOptionAsDword</a>(<span class="i">IntPtr</span> <span id="r150 rd" class="r150 r">wsManSessionHandle</span>,
            <a href="#f99c2939972a9aca" class="t t">WSManSessionOption</a> <span id="r151 rd" class="r151 r">option</span>,
            <b>out int</b> <span id="r152 rd" class="r152 r">value</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Function that retrieves a WSMan session option as string. Thread.CurrentUICulture</span>
        <span class="c">///</span><span class="c"> will be used as the language code to get the error message in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">wsManAPIHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">option</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Session option to get.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="33b73b64e5ac34f5" href="../../../R/33b73b64e5ac34f5.html" target="n" data-glyph="74,1" class="i method">WSManGetSessionOptionAsString</a>(<span class="i">IntPtr</span> <span id="r153 rd" class="r153 r">wsManAPIHandle</span>,
            <a href="#f99c2939972a9aca" class="t t">WSManSessionOption</a> <span id="r154 rd" class="r154 r">option</span>)
        {
            <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r153 r">wsManAPIHandle</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>, <span class="s">&quot;wsManAPIHandle cannot be null.&quot;</span>);
            <span class="c">// The error code taken from winerror.h used for getting buffer length.</span>
            <b>const int</b> <span id="r155 rd" class="r155 r">ERROR_INSUFFICIENT_BUFFER</span> = 122;
 
            <b>string</b> <span id="r156 rd" class="r156 r">returnval</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>int</b> <span id="r157 rd" class="r157 r">bufferSize</span> = 0;
            <span class="c">// calculate buffer size required</span>
            <b>if</b> (<a href="#d0f47885c2bac1f3" class="i method">WSManGetSessionOptionAsString</a>(<span class="r153 r">wsManAPIHandle</span>,
                <span class="r154 r">option</span>, 0, <b>null</b>, <b>out</b> <span class="r157 r">bufferSize</span>) != <span class="r155 r">ERROR_INSUFFICIENT_BUFFER</span>)
            {
                <b>return</b> <span class="r156 r">returnval</span>;
            }
            <span class="c">// calculate space required to store output.</span>
            <span class="c">// StringBuilder will not work for this case as CLR</span>
            <span class="c">// does not copy the entire string if there are delimiters (&#39;\0&#39;)</span>
            <span class="c">// in the middle of a string.</span>
            <b>int</b> <span id="r158 rd" class="r158 r">bufferSizeInBytes</span> = <span class="r157 r">bufferSize</span> * 2;
            <b>byte</b>[] <span id="r159 rd" class="r159 r">msgBufferPtr</span> = <b>new</b> <b>byte</b>[<span class="r158 r">bufferSizeInBytes</span>];
 
            <span class="c">// Now get the actual value</span>
            <b>int</b> <span id="r160 rd" class="r160 r">messageLength</span>;
            <b>if</b> (<a href="#d0f47885c2bac1f3" class="i method">WSManGetSessionOptionAsString</a>(<span class="r153 r">wsManAPIHandle</span>,
                    <span class="r154 r">option</span>, <span class="r158 r">bufferSizeInBytes</span>, <span class="r159 r">msgBufferPtr</span>, <b>out</b> <span class="r160 r">messageLength</span>) != 0)
            {
                <b>return</b> <span class="r156 r">returnval</span>;
            }
 
            <b>try</b>
            {
                <span class="r156 r">returnval</span> = <span class="i">Encoding</span>.<span class="i">Unicode</span>.<span class="i">GetString</span>(<span class="r159 r">msgBufferPtr</span>, 0, <span class="r158 r">bufferSizeInBytes</span>);
            }
            <b>catch</b> (<span class="i">ArgumentNullException</span>)
            {
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Text</span>.<span class="i">DecoderFallbackException</span>)
            {
            }
 
            <b>return</b> <span class="r156 r">returnval</span>;
        }
 
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>private static extern int</b> <a id="d0f47885c2bac1f3" href="../../../R/d0f47885c2bac1f3.html" target="n" data-glyph="76,1" class="i method">WSManGetSessionOptionAsString</a>(<span class="i">IntPtr</span> <span id="r161 rd" class="r161 r">wsManSessionHandle</span>,
            <a href="#f99c2939972a9aca" class="t t">WSManSessionOption</a> <span id="r162 rd" class="r162 r">option</span>,
            <b>int</b> <span id="r163 rd" class="r163 r">optionLength</span>,
            <b>byte</b>[] <span id="r164 rd" class="r164 r">optionAsString</span>,
            <b>out int</b> <span id="r165 rd" class="r165 r">optionLengthUsed</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a shell on the remote end.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r166 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session in which the shell is created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r167 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r168 r">resourceUri</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource Uri to use to create the shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">shellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r">startupInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> startup information to be passed to the shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">optionSet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Options to be passed with CreateShell</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r172 r">openContent</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> any content that is used by the remote shell to startup.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r173 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> callback to notify when the create operation completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r174 r">shellOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An out parameter referencing a WSMan shell operation handle</span>
        <span class="c">///</span><span class="c"> for this shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="1fbb254866e1febf" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WSManCreateShellEx</a>(<span class="i">IntPtr</span> <span id="r166 rd" class="r166 r">wsManSessionHandle</span>,
            <b>int</b> <span id="r167 rd" class="r167 r">flags</span>,
            <b>string</b> <span id="r168 rd" class="r168 r">resourceUri</span>,
            <b>string</b> <span id="r169 rd" class="r169 r">shellId</span>,
            <a href="#a04acf0dae72dbd2" class="t t">WSManShellStartupInfo_ManToUn</a> <span id="r170 rd" class="r170 r">startupInfo</span>,
            <a href="#04451905aba58b51" class="t t">WSManOptionSet</a> <span id="r171 rd" class="r171 r">optionSet</span>,
            <a href="#c08fd7c84904da7c" class="t t">WSManData_ManToUn</a> <span id="r172 rd" class="r172 r">openContent</span>,
            <span class="i">IntPtr</span> <span id="r173 rd" class="r173 r">asyncCallback</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r174 rd" class="r174 r">shellOperationHandle</span>)
        {
            <a href="#f1e21f8d4f6efad7" class="i method">WSManCreateShellExInternal</a>(<span class="r166 r">wsManSessionHandle</span>, <span class="r167 r">flags</span>, <span class="r168 r">resourceUri</span>, <span class="r169 r">shellId</span>, <span class="r170 r">startupInfo</span>, <span class="r171 r">optionSet</span>,
                    <span class="r172 r">openContent</span>, <span class="r173 r">asyncCallback</span>, <b>ref</b> <span class="r174 r">shellOperationHandle</span>);
        }
 
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManCreateShellEx&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>private static extern void</b> <a id="f1e21f8d4f6efad7" href="../../../R/f1e21f8d4f6efad7.html" target="n" data-glyph="76,1" class="i method">WSManCreateShellExInternal</a>(<span class="i">IntPtr</span> <span id="r175 rd" class="r175 r">wsManSessionHandle</span>,
            <b>int</b> <span id="r176 rd" class="r176 r">flags</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r177 rd" class="r177 r">resourceUri</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r178 rd" class="r178 r">shellId</span>,
            <span class="i">IntPtr</span> <span id="r179 rd" class="r179 r">startupInfo</span>,
            <span class="i">IntPtr</span> <span id="r180 rd" class="r180 r">optionSet</span>,
            <span class="i">IntPtr</span> <span id="r181 rd" class="r181 r">openContent</span>,
            <span class="i">IntPtr</span> <span id="r182 rd" class="r182 r">asyncCallback</span>,
            [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">IntPtr</span> <span id="r183 rd" class="r183 r">shellOperationHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r184 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r185 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r186 r">resourceUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r187 r">shellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">optionSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">connectXml</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r190 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r191 r">shellOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManConnectShell&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="90324244e13585f6" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WSManConnectShellEx</a>(<span class="i">IntPtr</span> <span id="r184 rd" class="r184 r">wsManSessionHandle</span>,
            <b>int</b> <span id="r185 rd" class="r185 r">flags</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r186 rd" class="r186 r">resourceUri</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r187 rd" class="r187 r">shellId</span>,
            <span class="i">IntPtr</span> <span id="r188 rd" class="r188 r">optionSet</span>,
            <span class="i">IntPtr</span> <span id="r189 rd" class="r189 r">connectXml</span>,
            <span class="i">IntPtr</span> <span id="r190 rd" class="r190 r">asyncCallback</span>,
            [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">IntPtr</span> <span id="r191 rd" class="r191 r">shellOperationHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r192 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r193 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">disconnectInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManDisconnectShell&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="0541285cff743c76" href="../../../R/0541285cff743c76.html" target="n" data-glyph="74,1" class="i method">WSManDisconnectShellEx</a>(<span class="i">IntPtr</span> <span id="r192 rd" class="r192 r">wsManSessionHandle</span>,
            <b>int</b> <span id="r193 rd" class="r193 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r194 rd" class="r194 r">disconnectInfo</span>,
            <span class="i">IntPtr</span> <span id="r195 rd" class="r195 r">asyncCallback</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">wsManSessionHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r197 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r198 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManReconnectShell&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="69550c4c3e22d1a0" href="../../../R/69550c4c3e22d1a0.html" target="n" data-glyph="74,1" class="i method">WSManReconnectShellEx</a>(<span class="i">IntPtr</span> <span id="r196 rd" class="r196 r">wsManSessionHandle</span>,
            <b>int</b> <span id="r197 rd" class="r197 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r198 rd" class="r198 r">asyncCallback</span>);
 
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManReconnectShellCommand&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="6225288ac5e2c374" href="../../../R/6225288ac5e2c374.html" target="n" data-glyph="74,1" class="i method">WSManReconnectShellCommandEx</a>(<span class="i">IntPtr</span> <span id="r199 rd" class="r199 r">wsManCommandHandle</span>,
            <b>int</b> <span id="r200 rd" class="r200 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r201 rd" class="r201 r">asyncCallback</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Starts a command on the remote end.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r202 r">shellOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shell handle in which the command is created and run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r203 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r204 r">commandId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r205 r">commandLine</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> command line for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r206 r">commandArgSet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> arguments for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">optionSet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r208 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> callback to notify when the operation completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">commandOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An out parameter referencing a WSMan shell operation handle</span>
        <span class="c">///</span><span class="c"> for this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManRunShellCommandEx&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="72b5281b8c8c4c74" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WSManRunShellCommandEx</a>(<span class="i">IntPtr</span> <span id="r202 rd" class="r202 r">shellOperationHandle</span>,
            <b>int</b> <span id="r203 rd" class="r203 r">flags</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>string</b> <span id="r204 rd" class="r204 r">commandId</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>string</b> <span id="r205 rd" class="r205 r">commandLine</span>,
            <span class="i">IntPtr</span> <span id="r206 rd" class="r206 r">commandArgSet</span>,
            <span class="i">IntPtr</span> <span id="r207 rd" class="r207 r">optionSet</span>,
            <span class="i">IntPtr</span> <span id="r208 rd" class="r208 r">asyncCallback</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r209 rd" class="r209 r">commandOperationHandle</span>);
 
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManConnectShellCommand&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="6f65d17ddc4ec578" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WSManConnectShellCommandEx</a>(<span class="i">IntPtr</span> <span id="r210 rd" class="r210 r">shellOperationHandle</span>,
            <b>int</b> <span id="r211 rd" class="r211 r">flags</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)]
            <b>string</b> <span id="r212 rd" class="r212 r">commandID</span>,
            <span class="i">IntPtr</span> <span id="r213 rd" class="r213 r">optionSet</span>,
            <span class="i">IntPtr</span> <span id="r214 rd" class="r214 r">connectXml</span>,
            <span class="i">IntPtr</span> <span id="r215 rd" class="r215 r">asyncCallback</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r216 rd" class="r216 r">commandOperationHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Registers a callback with WSMan to receive output from the remote end.</span>
        <span class="c">///</span><span class="c"> If commandOperationHandle is null, then the receive callback is registered</span>
        <span class="c">///</span><span class="c"> for shell. It is enough to register the callback only once. WSMan will</span>
        <span class="c">///</span><span class="c"> keep on calling this callback as and when it has data for a particular</span>
        <span class="c">///</span><span class="c"> command + shell. There will be only 1 callback active per command or per shell.</span>
        <span class="c">///</span><span class="c"> So if there are multiple commands active, then there can be 1 callback active</span>
        <span class="c">///</span><span class="c"> for each of them.</span>
        <span class="c">///</span><span class="c"> TODO: How to unregister the callback.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">shellOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shell Operation Handle.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r218 r">commandOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command Operation Handle. If null, the receive request corresponds</span>
        <span class="c">///</span><span class="c"> to the shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r219 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r220 r">desiredStreamSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r221 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> callback which receives the data asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r222 r">receiveOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> handle to use to cancel the operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManReceiveShellOutput&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="9f72cfa4b3088c36" href="../../../R/9f72cfa4b3088c36.html" target="n" data-glyph="74,1" class="i method">WSManReceiveShellOutputEx</a>(<span class="i">IntPtr</span> <span id="r217 rd" class="r217 r">shellOperationHandle</span>,
            <span class="i">IntPtr</span> <span id="r218 rd" class="r218 r">commandOperationHandle</span>,
            <b>int</b> <span id="r219 rd" class="r219 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r220 rd" class="r220 r">desiredStreamSet</span>,
            <span class="i">IntPtr</span> <span id="r221 rd" class="r221 r">asyncCallback</span>,
            [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">IntPtr</span> <span id="r222 rd" class="r222 r">receiveOperationHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Send data to the remote end.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r223 r">shellOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shell Operation Handle.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r224 r">commandOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command Operation Handle. If null, the send request corresponds</span>
        <span class="c">///</span><span class="c"> to the shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r225 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">streamId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">streamData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> callback to notify when the operation completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">sendOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> handle to use to cancel the operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="e388e7302395fdc4" href="../../../R/e388e7302395fdc4.html" target="n" data-glyph="74,1" class="i method">WSManSendShellInputEx</a>(<span class="i">IntPtr</span> <span id="r223 rd" class="r223 r">shellOperationHandle</span>,
            <span class="i">IntPtr</span> <span id="r224 rd" class="r224 r">commandOperationHandle</span>,
            <b>int</b> <span id="r225 rd" class="r225 r">flags</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r226 rd" class="r226 r">streamId</span>,
            <a href="#c08fd7c84904da7c" class="t t">WSManData_ManToUn</a> <span id="r227 rd" class="r227 r">streamData</span>,
            <span class="i">IntPtr</span> <span id="r228 rd" class="r228 r">asyncCallback</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r229 rd" class="r229 r">sendOperationHandle</span>)
        {
            <a href="#770d433999f38722" class="i method">WSManSendShellInputExInternal</a>(<span class="r223 r">shellOperationHandle</span>, <span class="r224 r">commandOperationHandle</span>, <span class="r225 r">flags</span>, <span class="r226 r">streamId</span>,
                    <span class="r227 r">streamData</span>, <b>false</b>, <span class="r228 r">asyncCallback</span>, <b>ref</b> <span class="r229 r">sendOperationHandle</span>);
        }
 
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManSendShellInput&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>private static extern void</b> <a id="770d433999f38722" href="../../../R/770d433999f38722.html" target="n" data-glyph="76,1" class="i method">WSManSendShellInputExInternal</a>(<span class="i">IntPtr</span> <span id="r230 rd" class="r230 r">shellOperationHandle</span>,
            <span class="i">IntPtr</span> <span id="r231 rd" class="r231 r">commandOperationHandle</span>,
            <b>int</b> <span id="r232 rd" class="r232 r">flags</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r233 rd" class="r233 r">streamId</span>,
            <span class="i">IntPtr</span> <span id="r234 rd" class="r234 r">streamData</span>,
            <b>bool</b> <span id="r235 rd" class="r235 r">endOfStream</span>,
            <span class="i">IntPtr</span> <span id="r236 rd" class="r236 r">asyncCallback</span>,
            [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">IntPtr</span> <span id="r237 rd" class="r237 r">sendOperationHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes a shell or a command; if the callback associated with the operation</span>
        <span class="c">///</span><span class="c"> is pending and have not completed when WSManCloseShellOperationEx is called,</span>
        <span class="c">///</span><span class="c"> the function waits for the callback to finish; If the operation was not finished,</span>
        <span class="c">///</span><span class="c"> the operation is cancelled and the operation callback is called with</span>
        <span class="c">///</span><span class="c"> WSMAN_ERROR_OPERATION_ABORTED error; then the WSManCloseShellOperationEx callback</span>
        <span class="c">///</span><span class="c"> is called with WSMAN_FLAG_CALLBACK_END_OF_OPERATION flag as result of this operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r238 r">shellHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shell handle to Close.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r239 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r240 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> callback to notify when the operation completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="cae66210aa59ea0f" href="../../../R/cae66210aa59ea0f.html" target="n" data-glyph="74,1" class="i method">WSManCloseShell</a>(<span class="i">IntPtr</span> <span id="r238 rd" class="r238 r">shellHandle</span>,
            <b>int</b> <span id="r239 rd" class="r239 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r240 rd" class="r240 r">asyncCallback</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes a command (signals the termination of a command); the WSManCloseCommand callback</span>
        <span class="c">///</span><span class="c"> is called with WSMAN_FLAG_CALLBACK_END_OF_OPERATION flag as result of this operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r241 r">cmdHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command handle to Close.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r242 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r243 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> callback to notify when the operation completes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="e17d44a476e64fa2" href="../../../R/e17d44a476e64fa2.html" target="n" data-glyph="74,1" class="i method">WSManCloseCommand</a>(<span class="i">IntPtr</span> <span id="r241 rd" class="r241 r">cmdHandle</span>,
            <b>int</b> <span id="r242 rd" class="r242 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r243 rd" class="r243 r">asyncCallback</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sends a signal. If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r244 r">cmdOperationHandle</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null, then the signal will</span>
        <span class="c">///</span><span class="c"> be sent to shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r245 r">shellOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r244 r">cmdOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r246 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r247 r">code</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r248 r">asyncCallback</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r249 r">signalOperationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">EntryPoint</span> = <span class="s">&quot;WSManSignalShell&quot;</span>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="1548b6cc07cef71b" href="../../../R/1548b6cc07cef71b.html" target="n" data-glyph="74,1" class="i method">WSManSignalShellEx</a>(<span class="i">IntPtr</span> <span id="r245 rd" class="r245 r">shellOperationHandle</span>,
            <span class="i">IntPtr</span> <span id="r244 rd" class="r244 r">cmdOperationHandle</span>,
            <b>int</b> <span id="r246 rd" class="r246 r">flags</span>,
            <b>string</b> <span id="r247 rd" class="r247 r">code</span>,
            <span class="i">IntPtr</span> <span id="r248 rd" class="r248 r">asyncCallback</span>,
            [<span class="i">In</span>, <span class="i">Out</span>] <b>ref</b> <span class="i">IntPtr</span> <span id="r249 rd" class="r249 r">signalOperationHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes an asynchronous operation; if the callback associated with the operation</span>
        <span class="c">///</span><span class="c"> is pending and have not completed when WSManCloseOperation is called, then</span>
        <span class="c">///</span><span class="c"> the function marks the operation for deletion and returns; If the callback was not called,</span>
        <span class="c">///</span><span class="c"> the operation is cancelled and the operation callback is called with</span>
        <span class="c">///</span><span class="c"> WSMAN_ERROR_OPERATION_ABORTED error; the operation handle is freed in all cases</span>
        <span class="c">///</span><span class="c"> after the callback returns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r250 r">operationHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r251 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern void</b> <a id="96b121ea122bb25a" href="../../../R/96b121ea122bb25a.html" target="n" data-glyph="74,1" class="i method">WSManCloseOperation</a>(<span class="i">IntPtr</span> <span id="r250 rd" class="r250 r">operationHandle</span>, <b>int</b> <span id="r251 rd" class="r251 r">flags</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Function that retrieves WSMan error messages with a particular error code. Thread.CurrentUICulture</span>
        <span class="c">///</span><span class="c"> will be used as the language code to get the error message in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r252 r">wsManAPIHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r253 r">errorCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="0daa89ea27b8128f" href="../../../R/0daa89ea27b8128f.html" target="n" data-glyph="74,1" class="i method">WSManGetErrorMessage</a>(<span class="i">IntPtr</span> <span id="r252 rd" class="r252 r">wsManAPIHandle</span>, <b>int</b> <span id="r253 rd" class="r253 r">errorCode</span>)
        {
            <span class="i">Dbg</span>.<span class="i">Assert</span>(<span class="r252 r">wsManAPIHandle</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>, <span class="s">&quot;wsManAPIHandle cannot be null.&quot;</span>);
 
            <span class="c">// The error code taken from winerror.h used for getting buffer length.</span>
            <b>const int</b> <span id="r254 rd" class="r254 r">ERROR_INSUFFICIENT_BUFFER</span> = 122;
 
            <span class="c">// get language code.</span>
            <b>string</b> <span id="r255 rd" class="r255 r">langCode</span> = <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>.<span class="i">Name</span>;
 
            <b>string</b> <span id="r256 rd" class="r256 r">returnval</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>int</b> <span id="r257 rd" class="r257 r">bufferSize</span> = 0;
            <span class="c">// calculate buffer size required</span>
            <b>if</b> (<a href="#71b03ec75b6fc582" class="i method">WSManGetErrorMessage</a>(<span class="r252 r">wsManAPIHandle</span>,
                    0, <span class="r255 r">langCode</span>, <span class="r253 r">errorCode</span>, 0, <b>null</b>, <b>out</b> <span class="r257 r">bufferSize</span>) != <span class="r254 r">ERROR_INSUFFICIENT_BUFFER</span>)
            {
                <b>return</b> <span class="r256 r">returnval</span>;
            }
            <span class="c">// calculate space required to store output.</span>
            <span class="c">// StringBuilder will not work for this case as CLR</span>
            <span class="c">// does not copy the entire string if there are delimiters (&#39;\0&#39;)</span>
            <span class="c">// in the middle of a string.</span>
            <b>int</b> <span id="r258 rd" class="r258 r">bufferSizeInBytes</span> = <span class="r257 r">bufferSize</span> * 2;
            <b>byte</b>[] <span id="r259 rd" class="r259 r">msgBufferPtr</span> = <b>new</b> <b>byte</b>[<span class="r258 r">bufferSizeInBytes</span>];
 
            <span class="c">// Now get the actual value</span>
            <b>int</b> <span id="r260 rd" class="r260 r">messageLength</span>;
            <b>if</b> (<a href="#71b03ec75b6fc582" class="i method">WSManGetErrorMessage</a>(<span class="r252 r">wsManAPIHandle</span>,
                    0, <span class="r255 r">langCode</span>, <span class="r253 r">errorCode</span>, <span class="r258 r">bufferSizeInBytes</span>, <span class="r259 r">msgBufferPtr</span>, <b>out</b> <span class="r260 r">messageLength</span>) != 0)
            {
                <b>return</b> <span class="r256 r">returnval</span>;
            }
 
            <b>try</b>
            {
                <span class="r256 r">returnval</span> = <span class="i">Encoding</span>.<span class="i">Unicode</span>.<span class="i">GetString</span>(<span class="r259 r">msgBufferPtr</span>, 0, <span class="r258 r">bufferSizeInBytes</span>);
            }
            <b>catch</b> (<span class="i">ArgumentNullException</span>)
            {
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Text</span>.<span class="i">DecoderFallbackException</span>)
            {
            }
            <b>catch</b> (<span class="i">ArgumentOutOfRangeException</span>)
            {
            }
 
            <b>return</b> <span class="r256 r">returnval</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Function that retrieves WSMan error messages with a particular error code and a language code.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">wsManAPIHandle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The handle returned by WSManInitialize API call. It cannot be NULL.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r262 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reserved for future use. It must be 0.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r263 r">languageCode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Defines the RFC 3066 language code name that should be used to localize the error. It can be NULL.</span>
        <span class="c">///</span><span class="c"> if not specified, the thread&#39;s UI language will be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r264 r">errorCode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents the error code for the requested error message. This error code can be a hexadecimal or</span>
        <span class="c">///</span><span class="c"> decimal component from WSManagement component, WinHttp component or other Windows operating system</span>
        <span class="c">///</span><span class="c"> components.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r265 r">messageLength</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents the size of the output message buffer in characters, including the NULL terminator.</span>
        <span class="c">///</span><span class="c"> If 0, then the &quot;message&quot; parameter must be NULL; in this case the function will return</span>
        <span class="c">///</span><span class="c"> ERROR_INSUFFICIENT_BUFFER error and the &quot;messageLengthUsed&quot; parameter will be set to the number</span>
        <span class="c">///</span><span class="c"> of characters needed, including NULL terminator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r266 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents the output buffer to store the message in. It must be allocated/deallocated by the client.</span>
        <span class="c">///</span><span class="c"> The buffer must be big enough to store the message plus the NULL terminator otherwise an</span>
        <span class="c">///</span><span class="c"> ERROR_INSUFFICIENT_BUFFER error will be returned and the &quot;messageLengthUsed&quot; parameter will be set</span>
        <span class="c">///</span><span class="c"> to the number of characters needed, including NULL terminator. If NULL, then the &quot;messageLength&quot; parameter</span>
        <span class="c">///</span><span class="c"> must be NULL; in this case the function will return ERROR_INSUFFICIENT_BUFFER error and the &quot;messageLengthUsed&quot;</span>
        <span class="c">///</span><span class="c"> parameter will be set to the number of characters needed, including NULL terminator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r267 r">messageLengthUsed</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Represents the effective number of characters written to the output buffer, including the NULL terminator.</span>
        <span class="c">///</span><span class="c"> It cannot be NULL. If both &quot;messageLength&quot; and &quot;message&quot; parameters are 0, the function will return ERROR_INSUFFICIENT_BUFFER</span>
        <span class="c">///</span><span class="c"> and &quot;messageLengthUsed&quot; parameter will be set to the number of characters needed, including NULL terminator</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#fc4e08b7e3e2fcff" class="i field">WSManClientApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="71b03ec75b6fc582" href="../../../R/71b03ec75b6fc582.html" target="n" data-glyph="74,1" class="i method">WSManGetErrorMessage</a>(<span class="i">IntPtr</span> <span id="r261 rd" class="r261 r">wsManAPIHandle</span>,
            <b>int</b> <span id="r262 rd" class="r262 r">flags</span>,
            <b>string</b> <span id="r263 rd" class="r263 r">languageCode</span>,
            <b>int</b> <span id="r264 rd" class="r264 r">errorCode</span>,
            <b>int</b> <span id="r265 rd" class="r265 r">messageLength</span>,
            <b>byte</b>[] <span id="r266 rd" class="r266 r">message</span>,
            <b>out int</b> <span id="r267 rd" class="r267 r">messageLengthUsed</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> DllImports PluginAPI
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets operational information for items such as time-outs and data restrictions that</span>
        <span class="c">///</span><span class="c"> are associated with the operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r268 r">requestDetails</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the resource URI, options, locale, shutdown flag, and handle for the request.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r269 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the options that are available for retrieval.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r270 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the result object (WSMAN_DATA).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#62fa2cb6f3055cba" class="i field">WSManProviderApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="1e7b385527b04d7d" href="../../../R/1e7b385527b04d7d.html" target="n" data-glyph="74,1" class="i method">WSManPluginGetOperationParameters</a>(
            <span class="i">IntPtr</span> <span id="r268 rd" class="r268 r">requestDetails</span>,
            <b>int</b> <span id="r269 rd" class="r269 r">flags</span>,
            [<span class="i">In</span>, <span class="i">Out</span>, <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPStruct</span>)] <a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a> <span id="r270 rd" class="r270 r">data</span>);
        <span class="c">// [In, Out] ref IntPtr data);</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reports the completion of an operation by all operation entry points except for the</span>
        <span class="c">///</span><span class="c"> WSManPluginStartup and WSManPluginShutdown methods.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r271 r">requestDetails</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the resource URI, options, locale, shutdown flag, and handle for the request.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r272 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r273 r">errorCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Reports any failure in the operation. Terminates on non-NO_ERROR status.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r274 r">extendedInformation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">XML document containing extra error information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#62fa2cb6f3055cba" class="i field">WSManProviderApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="8747ca042d4e1e72" href="../../../R/8747ca042d4e1e72.html" target="n" data-glyph="74,1" class="i method">WSManPluginOperationComplete</a>(
            <span class="i">IntPtr</span> <span id="r271 rd" class="r271 r">requestDetails</span>,
            <b>int</b> <span id="r272 rd" class="r272 r">flags</span>,
            <b>int</b> <span id="r273 rd" class="r273 r">errorCode</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r274 rd" class="r274 r">extendedInformation</span>);
 
        <b>internal enum</b> <a id="0914bb5568e06c25" href="../../../R/0914bb5568e06c25.html" target="n" data-glyph="20,1" class="t t"><span id="0d792e92346a2dbd">WSManFlagReceive</span></a> : <b>int</b>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> No more data on this stream.  Only valid when a stream is specified.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="db04fefbf7738165" href="../../../R/db04fefbf7738165.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_RECEIVE_RESULT_NO_MORE_DATA</a> = 1,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Send the data as soon as possible.  Normally data is held onto in</span>
            <span class="c">///</span><span class="c"> order to maximise the size of the response packet.  This should</span>
            <span class="c">///</span><span class="c"> only be used if a request/response style of data is needed between</span>
            <span class="c">///</span><span class="c"> the send and receive data streams.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="fd1cb36a6ea939f5" href="../../../R/fd1cb36a6ea939f5.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_RECEIVE_FLUSH</a> = 2,
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Data reported is at a boundary. Plugins usually serialize and fragment</span>
            <span class="c">///</span><span class="c"> output data objects and push them along the receive byte stream.</span>
            <span class="c">///</span><span class="c"> If the current data chunk being reported is an end fragment of the</span>
            <span class="c">///</span><span class="c"> data object current processed, plugins would set this flag.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="198520b5995e5ab1" href="../../../R/198520b5995e5ab1.html" target="n" data-glyph="24,2" class="i field">WSMAN_FLAG_RECEIVE_RESULT_DATA_BOUNDARY</a> = 4
        }
 
        <b>internal const string</b> <a id="ca30861ab6da38d4" href="../../../R/ca30861ab6da38d4.html" target="n" data-glyph="8,1" class="i field">WSMAN_SHELL_NAMESPACE</a> = <span class="s">&quot;http://schemas.microsoft.com/wbem/wsman/1/windows/shell&quot;</span>;
        <b>internal const string</b> <a id="ee0499f993694daf" href="../../../R/ee0499f993694daf.html" target="n" data-glyph="8,1" class="i field">WSMAN_COMMAND_STATE_DONE</a> = <a href="#ca30861ab6da38d4" class="i field">WSMAN_SHELL_NAMESPACE</a> + <span class="s">&quot;/CommandState/Done&quot;</span>;
        <b>internal const string</b> <a id="81b24dd2db284598" href="../../../R/81b24dd2db284598.html" target="n" data-glyph="8,1" class="i field">WSMAN_COMMAND_STATE_PENDING</a> = <a href="#ca30861ab6da38d4" class="i field">WSMAN_SHELL_NAMESPACE</a> + <span class="s">&quot;/CommandState/Pending&quot;</span>;
        <b>internal const string</b> <a id="7e5693823c5af2c4" href="../../../R/7e5693823c5af2c4.html" target="n" data-glyph="8,1" class="i field">WSMAN_COMMAND_STATE_RUNNING</a> = <a href="#ca30861ab6da38d4" class="i field">WSMAN_SHELL_NAMESPACE</a> + <span class="s">&quot;/CommandState/Running&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reports results for the WSMAN_PLUGIN_RECEIVE plug-in call and is used by most shell</span>
        <span class="c">///</span><span class="c"> plug-ins that return results. After all of the data is received, the</span>
        <span class="c">///</span><span class="c"> WSManPluginOperationComplete method must be called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r275 r">requestDetails</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the resource URI, options, locale, shutdown flag, and handle for the request.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r276 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r277 r">stream</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the stream that the data is associated with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r278 r">streamResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A pointer to a WSMAN_DATA structure that specifies the result object that is returned to the client.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r279 r">commandState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the state of the command. It must be set to a value specified by the plugin.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r280 r">exitCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Only set when the commandState is terminating.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#62fa2cb6f3055cba" class="i field">WSManProviderApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="29c9f0e64f6ea87d" href="../../../R/29c9f0e64f6ea87d.html" target="n" data-glyph="74,1" class="i method">WSManPluginReceiveResult</a>(
            <span class="i">IntPtr</span> <span id="r275 rd" class="r275 r">requestDetails</span>,
            <b>int</b> <span id="r276 rd" class="r276 r">flags</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r277 rd" class="r277 r">stream</span>,
            <span class="i">IntPtr</span> <span id="r278 rd" class="r278 r">streamResult</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r279 rd" class="r279 r">commandState</span>,
            <b>int</b> <span id="r280 rd" class="r280 r">exitCode</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reports shell and command context back to the Windows Remote Management (WinRM)</span>
        <span class="c">///</span><span class="c"> infrastructure so that further operations can be performed against the shell and/or</span>
        <span class="c">///</span><span class="c"> command. This method is called only for WSManPluginShell and WSManPluginCommand plug-in</span>
        <span class="c">///</span><span class="c"> entry points.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r281 r">requestDetails</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specifies the resource URI, options, locale, shutdown flag, and handle for the request.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r282 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r283 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Defines the value to pass into all future shell and command operations. Represents either the shell or the command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#62fa2cb6f3055cba" class="i field">WSManProviderApiDll</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern int</b> <a id="f072661ff307a120" href="../../../R/f072661ff307a120.html" target="n" data-glyph="74,1" class="i method">WSManPluginReportContext</a>(
            <span class="i">IntPtr</span> <span id="r281 rd" class="r281 r">requestDetails</span>,
            <b>int</b> <span id="r282 rd" class="r282 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r283 rd" class="r283 r">context</span>);
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">        /// &lt;summary&gt;
        /// Registers the shutdown callback.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;requestDetails&quot;&gt;Specifies the resource URI, options, locale, shutdown flag, and handle for the request.&lt;/param&gt;
        /// &lt;param name=&quot;shutdownCallback&quot;&gt;Callback to be executed on shutdown.&lt;/param&gt;
        /// &lt;param name=&quot;shutdownContext&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        [DllImport(WSManNativeApi.WSManProviderApiDll, SetLastError = false, CharSet = CharSet.Unicode)]
        internal static extern void WSManPluginRegisterShutdownCallback(
            IntPtr requestDetails,
            IntPtr shutdownCallback,
            IntPtr shutdownContext);
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Interface to enable stubbing of the WSManNativeApi PInvoke calls for</span>
    <span class="c">///</span><span class="c"> unit testing.</span>
    <span class="c">///</span><span class="c"> Note: It is implemented as a class to avoid exposing it outside the module.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>internal interface</b> <a id="28d2b5626ddfc6e5" href="../../../R/28d2b5626ddfc6e5.html" target="n" data-glyph="50,0" class="t t">IWSManNativeApiFacade</a>
    {
        <span class="c">// TODO: Expand this to cover the rest of the API once I prove that it works!</span>
 
        <b>int</b> <a id="ca3e0de4396c7f3c" href="../../../R/ca3e0de4396c7f3c.html" target="n" data-glyph="72,1" class="i method">WSManPluginGetOperationParameters</a>(
            <span class="i">IntPtr</span> <span id="r284 rd" class="r284 r">requestDetails</span>,
            <b>int</b> <span id="r285 rd" class="r285 r">flags</span>,
            <a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a> <span id="r286 rd" class="r286 r">data</span>);
 
        <b>int</b> <a id="cfb1e739f56c60d3" href="../../../R/cfb1e739f56c60d3.html" target="n" data-glyph="72,1" class="i method">WSManPluginOperationComplete</a>(
            <span class="i">IntPtr</span> <span id="r287 rd" class="r287 r">requestDetails</span>,
            <b>int</b> <span id="r288 rd" class="r288 r">flags</span>,
            <b>int</b> <span id="r289 rd" class="r289 r">errorCode</span>,
            <b>string</b> <span id="r290 rd" class="r290 r">extendedInformation</span>);
 
        <b>int</b> <a id="0034da88c3d2ed18" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WSManPluginReceiveResult</a>(
            <span class="i">IntPtr</span> <span id="r291 rd" class="r291 r">requestDetails</span>,
            <b>int</b> <span id="r292 rd" class="r292 r">flags</span>,
            <b>string</b>? <span id="r293 rd" class="r293 r">stream</span>,
            <span class="i">IntPtr</span> <span id="r294 rd" class="r294 r">streamResult</span>,
            <b>string</b> <span id="r295 rd" class="r295 r">commandState</span>,
            <b>int</b> <span id="r296 rd" class="r296 r">exitCode</span>);
 
        <b>int</b> <a id="a076db435a6d32bd" href="../../../R/a076db435a6d32bd.html" target="n" data-glyph="72,1" class="i method">WSManPluginReportContext</a>(
            <span class="i">IntPtr</span> <span id="r297 rd" class="r297 r">requestDetails</span>,
            <b>int</b> <span id="r298 rd" class="r298 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r299 rd" class="r299 r">context</span>);
 
        <b>void</b> <a id="1105e7684e34030a" href="../../../R/1105e7684e34030a.html" target="n" data-glyph="72,1" class="i method">WSManPluginRegisterShutdownCallback</a>(
            <span class="i">IntPtr</span> <span id="r300 rd" class="r300 r">requestDetails</span>,
            <span class="i">IntPtr</span> <span id="r301 rd" class="r301 r">shutdownCallback</span>,
            <span class="i">IntPtr</span> <span id="r302 rd" class="r302 r">shutdownContext</span>);
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Concrete implementation of the PInvoke facade for use in the production code.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="869059f7c6883592" href="../../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="20ead50b43274490">WSManNativeApiFacade</span></a> : <a href="#28d2b5626ddfc6e5" class="t t">IWSManNativeApiFacade</a>
    {
        <b>int</b> <a href="#28d2b5626ddfc6e5" class="t t">IWSManNativeApiFacade</a>.<a href="#ca3e0de4396c7f3c" class="i method">WSManPluginGetOperationParameters</a>(
            <span class="i">IntPtr</span> <span id="r303 rd" class="r303 r">requestDetails</span>,
            <b>int</b> <span id="r304 rd" class="r304 r">flags</span>,
            <a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#5c14c561aee60b63" class="t t">WSManDataStruct</a> <span id="r305 rd" class="r305 r">data</span>)
        {
            <b>return</b> <a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#1e7b385527b04d7d" class="i method">WSManPluginGetOperationParameters</a>(<span class="r303 r">requestDetails</span>, <span class="r304 r">flags</span>, <span class="r305 r">data</span>);
        }
 
        <b>int</b> <a href="#28d2b5626ddfc6e5" class="t t">IWSManNativeApiFacade</a>.<a href="#cfb1e739f56c60d3" class="i method">WSManPluginOperationComplete</a>(
            <span class="i">IntPtr</span> <span id="r306 rd" class="r306 r">requestDetails</span>,
            <b>int</b> <span id="r307 rd" class="r307 r">flags</span>,
            <b>int</b> <span id="r308 rd" class="r308 r">errorCode</span>,
            <b>string</b> <span id="r309 rd" class="r309 r">extendedInformation</span>)
        {
            <b>return</b> <a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#8747ca042d4e1e72" class="i method">WSManPluginOperationComplete</a>(<span class="r306 r">requestDetails</span>, <span class="r307 r">flags</span>, <span class="r308 r">errorCode</span>, <span class="r309 r">extendedInformation</span>);
        }
 
        <b>int</b> <a href="#28d2b5626ddfc6e5" class="t t">IWSManNativeApiFacade</a>.<a id="22fea0e1001fe05d" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">WSManPluginReceiveResult</a>(
            <span class="i">IntPtr</span> <span id="r310 rd" class="r310 r">requestDetails</span>,
            <b>int</b> <span id="r311 rd" class="r311 r">flags</span>,
            <b>string</b> <span id="r312 rd" class="r312 r">stream</span>,
            <span class="i">IntPtr</span> <span id="r313 rd" class="r313 r">streamResult</span>,
            <b>string</b> <span id="r314 rd" class="r314 r">commandState</span>,
            <b>int</b> <span id="r315 rd" class="r315 r">exitCode</span>)
        {
            <b>return</b> <a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#29c9f0e64f6ea87d" class="i method">WSManPluginReceiveResult</a>(<span class="r310 r">requestDetails</span>, <span class="r311 r">flags</span>, <span class="r312 r">stream</span>, <span class="r313 r">streamResult</span>, <span class="r314 r">commandState</span>, <span class="r315 r">exitCode</span>);
        }
 
        <b>int</b> <a href="#28d2b5626ddfc6e5" class="t t">IWSManNativeApiFacade</a>.<a href="#a076db435a6d32bd" class="i method">WSManPluginReportContext</a>(
            <span class="i">IntPtr</span> <span id="r316 rd" class="r316 r">requestDetails</span>,
            <b>int</b> <span id="r317 rd" class="r317 r">flags</span>,
            <span class="i">IntPtr</span> <span id="r318 rd" class="r318 r">context</span>)
        {
            <b>return</b> <a href="#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="#f072661ff307a120" class="i method">WSManPluginReportContext</a>(<span class="r316 r">requestDetails</span>, <span class="r317 r">flags</span>, <span class="r318 r">context</span>);
        }
 
        <b>void</b> <a href="#28d2b5626ddfc6e5" class="t t">IWSManNativeApiFacade</a>.<a href="#1105e7684e34030a" class="i method">WSManPluginRegisterShutdownCallback</a>(
            <span class="i">IntPtr</span> <span id="r319 rd" class="r319 r">requestDetails</span>,
            <span class="i">IntPtr</span> <span id="r320 rd" class="r320 r">shutdownCallback</span>,
            <span class="i">IntPtr</span> <span id="r321 rd" class="r321 r">shutdownContext</span>)
        {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">            WSManNativeApi.WSManPluginRegisterShutdownCallback(requestDetails, shutdownCallback, shutdownContext);
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
    }
}
</pre></td></tr></table></div></body></html>
