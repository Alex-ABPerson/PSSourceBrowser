<!DOCTYPE html>
<html><head><title>PSRemotingCmdlet.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(4536);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/commands/PSRemotingCmdlet.cs" target="_top">engine\remoting\commands\PSRemotingCmdlet.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class defines most of the common functionality used</span>
    <span class="c">///</span><span class="c"> across remoting cmdlets.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> It contains tons of utility functions which are used all</span>
    <span class="c">///</span><span class="c"> across the remoting cmdlets.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="c2668678751e1b82" href="../../../R/c2668678751e1b82.html" target="n" data-glyph="0,0" class="t t"><span id="d903cb4b88f585dd">PSRemotingCmdlet</span></a> : <a href="../../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies if remoting cmdlets can be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="3da6242f8109ce30" href="../../../R/3da6242f8109ce30.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> (!<a href="#980eaa0e0166af27" class="i property">SkipWinRMCheck</a>)
            {
                <a href="remotingcommandutil.cs.html#4c008a65630ba320" class="t t">RemotingCommandUtil</a>.<a href="remotingcommandutil.cs.html#668e049b2f134726" class="i method">CheckRemotingCmdletPrerequisites</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Utility functions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle the object obtained from an ObjectStream&#39;s reader</span>
        <span class="c">///</span><span class="c"> based on its type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="8c7d6343604dfd87" href="../../../R/8c7d6343604dfd87.html" target="n" data-glyph="74,1" class="i method">WriteStreamObject</a>(<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt; <span id="r0 rd" class="r0 r">action</span>)
        {
            <span class="r0 r">action</span>(<a href="#c2668678751e1b82" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolve all the machine names provided. Basically, if a machine</span>
        <span class="c">///</span><span class="c"> name is &#39;.&#39; assume localhost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">computerNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Array of computer names to resolve.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">resolvedComputerNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resolved array of machine names.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="cf8d963b1364b5ca" href="../../../R/cf8d963b1364b5ca.html" target="n" data-glyph="75,1" class="i method">ResolveComputerNames</a>(<b>string</b>[] <span id="r1 rd" class="r1 r">computerNames</span>, <b>out string</b>[] <span id="r2 rd" class="r2 r">resolvedComputerNames</span>)
        {
            <b>if</b> (<span class="r1 r">computerNames</span> == <b>null</b>)
            {
                <span class="r2 r">resolvedComputerNames</span> = <b>new</b> <b>string</b>[1];
 
                <span class="r2 r">resolvedComputerNames</span>[0] = <a href="#bd0c84ecceec9eb5" class="i method">ResolveComputerName</a>(<span class="s">&quot;.&quot;</span>);
            }
            <b>else</b> <b>if</b> (<span class="r1 r">computerNames</span>.<span class="i">Length</span> == 0)
            {
                <span class="r2 r">resolvedComputerNames</span> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
            }
            <b>else</b>
            {
                <span class="r2 r">resolvedComputerNames</span> = <b>new</b> <b>string</b>[<span class="r1 r">computerNames</span>.<span class="i">Length</span>];
 
                <b>for</b> (<b>int</b> <span id="r3 rd" class="r3 r">i</span> = 0; <span class="r3 r">i</span> &lt; <span class="r2 r">resolvedComputerNames</span>.<span class="i">Length</span>; <span class="r3 r">i</span>++)
                {
                    <span class="r2 r">resolvedComputerNames</span>[<span class="r3 r">i</span>] = <a href="#bd0c84ecceec9eb5" class="i method">ResolveComputerName</a>(<span class="r1 r">computerNames</span>[<span class="r3 r">i</span>]);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolves a computer name. If its null or empty</span>
        <span class="c">///</span><span class="c"> its assumed to be localhost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Computer name to resolve.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Resolved computer name.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected string</b> <a id="bd0c84ecceec9eb5" href="../../../R/bd0c84ecceec9eb5.html" target="n" data-glyph="75,1" class="i method">ResolveComputerName</a>(<b>string</b> <span id="r4 rd" class="r4 r">computerName</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r4 r">computerName</span> != <b>null</b>, <span class="s">&quot;Null ComputerName&quot;</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r4 r">computerName</span>, <span class="s">&quot;.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// tracer.WriteEvent(ref PSEventDescriptors.PS_EVENT_HOSTNAMERESOLVE);</span>
                <span class="c">// tracer.Dispose();</span>
                <span class="c">// tracer.OperationalChannel.WriteVerbose(PSEventId.HostNameResolve, PSOpcode.Method, PSTask.CreateRunspace);</span>
                <b>return</b> <a href="#3dfb1b13690ab526" class="i field">s_LOCALHOST</a>;
            }
            <b>else</b>
            {
                <b>return</b> <span class="r4 r">computerName</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Load the resource corresponding to the specified errorId and</span>
        <span class="c">///</span><span class="c"> return the message as a string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">resource String which holds the message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Error message loaded from appropriate resource cache.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="8b0f0037b0fd1c4c" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetMessage</a>(<b>string</b> <span id="r5 rd" class="r5 r">resourceString</span>)
        {
            <b>string</b> <span id="r6 rd" class="r6 r">message</span> = <a href="#ae4e30474662ef10" class="i method">GetMessage</a>(<span class="r5 r">resourceString</span>, <b>null</b>);
 
            <b>return</b> <span class="r6 r">message</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="ae4e30474662ef10" href="../../../R/ae4e30474662ef10.html" target="n" data-glyph="74,1" class="i method">GetMessage</a>(<b>string</b> <span id="r7 rd" class="r7 r">resourceString</span>, <b>params object</b>[] <span id="r8 rd" class="r8 r">args</span>)
        {
            <b>string</b> <span id="r9 rd" class="r9 r">message</span>;
 
            <b>if</b> (<span class="r8 r">args</span> != <b>null</b>)
            {
                <span class="r9 r">message</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../../utils/StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r7 r">resourceString</span>, <span class="r8 r">args</span>);
            }
            <b>else</b>
            {
                <span class="r9 r">message</span> = <span class="r7 r">resourceString</span>;
            }
 
            <b>return</b> <span class="r9 r">message</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Utility functions
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private static readonly string</b> <a id="3dfb1b13690ab526" href="../../../R/3dfb1b13690ab526.html" target="n" data-glyph="46,1" class="i field">s_LOCALHOST</a> = <span class="s">&quot;localhost&quot;</span>;
 
        <span class="c">// private PSETWTracer tracer = PSETWTracer.GetETWTracer(PSKeyword.Cmdlets);</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computername parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="03ac4b61d9472c2d" href="../../../R/03ac4b61d9472c2d.html" target="n" data-glyph="9,1" class="i field">ComputerNameParameterSet</a> = <span class="s">&quot;ComputerName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computername with session instance ID parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="24b73cdae20c212c" href="../../../R/24b73cdae20c212c.html" target="n" data-glyph="9,1" class="i field">ComputerInstanceIdParameterSet</a> = <span class="s">&quot;ComputerInstanceId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Container ID parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="572318a2191690f0" href="../../../R/572318a2191690f0.html" target="n" data-glyph="9,1" class="i field">ContainerIdParameterSet</a> = <span class="s">&quot;ContainerId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> VM guid parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="5d25e1e8da3ff53e" href="../../../R/5d25e1e8da3ff53e.html" target="n" data-glyph="9,1" class="i field">VMIdParameterSet</a> = <span class="s">&quot;VMId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> VM name parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="b2efa99b627d2719" href="../../../R/b2efa99b627d2719.html" target="n" data-glyph="9,1" class="i field">VMNameParameterSet</a> = <span class="s">&quot;VMName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SSH host parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="1d1f1661df97e61a" href="../../../R/1d1f1661df97e61a.html" target="n" data-glyph="9,1" class="i field">SSHHostParameterSet</a> = <span class="s">&quot;SSHHost&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SSH host parmeter set supporting hash connection parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="401e2bcb1c7fe903" href="../../../R/401e2bcb1c7fe903.html" target="n" data-glyph="9,1" class="i field">SSHHostHashParameterSet</a> = <span class="s">&quot;SSHHostHashParam&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="1e3c25790a1dc5ac" href="../../../R/1e3c25790a1dc5ac.html" target="n" data-glyph="9,1" class="i field">SessionParameterSet</a> = <span class="s">&quot;Session&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter set to use Windows PowerShell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="5a33bf7e6ce59ea5" href="../../../R/5a33bf7e6ce59ea5.html" target="n" data-glyph="9,1" class="i field">UseWindowsPowerShellParameterSet</a> = <span class="s">&quot;UseWindowsPowerShellParameterSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default shellname.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="20d852be22ba38cb" href="../../../R/20d852be22ba38cb.html" target="n" data-glyph="9,1" class="i field">DefaultPowerShellRemoteShellName</a> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#f383edcf61712f90" class="i field">ResourceURIPrefix</a> + <span class="s">&quot;Microsoft.PowerShell&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default application name for the connection uri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="c788a25e4fad43e1" href="../../../R/c788a25e4fad43e1.html" target="n" data-glyph="9,1" class="i field">DefaultPowerShellRemoteShellAppName</a> = <span class="s">&quot;WSMan&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Protected Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Skip checking for WinRM.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="980eaa0e0166af27" href="../../../R/980eaa0e0166af27.html" target="n" data-glyph="104,1" class="i property">SkipWinRMCheck</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines the shellname to use based on the following order:</span>
        <span class="c">///</span><span class="c">     1. ShellName parameter specified</span>
        <span class="c">///</span><span class="c">     2. DEFAULTREMOTESHELLNAME variable set</span>
        <span class="c">///</span><span class="c">     3. PowerShell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The shell to launch in the remote machine.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected string</b> <a id="f6b9edb5e4879089" href="../../../R/f6b9edb5e4879089.html" target="n" data-glyph="75,1" class="i method">ResolveShell</a>(<b>string</b> <span id="r10 rd" class="r10 r">shell</span>)
        {
            <b>string</b> <span id="r11 rd" class="r11 r">resolvedShell</span>;
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r10 r">shell</span>))
            {
                <span class="r11 r">resolvedShell</span> = <span class="r10 r">shell</span>;
            }
            <b>else</b>
            {
                <span class="r11 r">resolvedShell</span> = (<b>string</b>)<a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#9be0303086619111" class="i property">Internal</a>.<a href="../../SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="../../ExecutionContext.cs.html#a3916d7c99d7c52e" class="i method">GetVariableValue</a>(
                    <a href="../../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../../SpecialVariables.cs.html#fc51a33d698e3b63" class="i field">PSSessionConfigurationNameVarPath</a>, <a href="#20d852be22ba38cb" class="i field">DefaultPowerShellRemoteShellName</a>);
            }
 
            <b>return</b> <span class="r11 r">resolvedShell</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines the appname to be used based on the following order:</span>
        <span class="c">///</span><span class="c">     1. AppName parameter specified</span>
        <span class="c">///</span><span class="c">     2. DEFAULTREMOTEAPPNAME variable set</span>
        <span class="c">///</span><span class="c">     3. WSMan.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">appName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Application name to resolve.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Resolved appname.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected string</b> <a id="24d404384c59cac5" href="../../../R/24d404384c59cac5.html" target="n" data-glyph="75,1" class="i method">ResolveAppName</a>(<b>string</b> <span id="r12 rd" class="r12 r">appName</span>)
        {
            <b>string</b> <span id="r13 rd" class="r13 r">resolvedAppName</span>;
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r12 r">appName</span>))
            {
                <span class="r13 r">resolvedAppName</span> = <span class="r12 r">appName</span>;
            }
            <b>else</b>
            {
                <span class="r13 r">resolvedAppName</span> = (<b>string</b>)<a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#9be0303086619111" class="i property">Internal</a>.<a href="../../SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="../../ExecutionContext.cs.html#a3916d7c99d7c52e" class="i method">GetVariableValue</a>(
                    <a href="../../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../../SpecialVariables.cs.html#5fa12f342751c308" class="i field">PSSessionApplicationNameVarPath</a>,
                    <a href="#c788a25e4fad43e1" class="i field">DefaultPowerShellRemoteShellAppName</a>);
            }
 
            <b>return</b> <span class="r13 r">resolvedAppName</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Contains SSH connection information.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal struct</b> <a id="b533a42b795165f4" href="../../../R/b533a42b795165f4.html" target="n" data-glyph="110,0" class="t t"><span id="3506774fe188077a">SSHConnection</span></a>
    {
        <b>public string</b> <a id="df02876ca8e195fd" href="../../../R/df02876ca8e195fd.html" target="n" data-glyph="42,1" class="i field">ComputerName</a>;
        <b>public string</b> <a id="d582bd5d329d4325" href="../../../R/d582bd5d329d4325.html" target="n" data-glyph="42,1" class="i field">UserName</a>;
        <b>public string</b> <a id="b66df45ec2b338dd" href="../../../R/b66df45ec2b338dd.html" target="n" data-glyph="42,1" class="i field">KeyFilePath</a>;
        <b>public int</b> <a id="ccd070ed4731c66e" href="../../../R/ccd070ed4731c66e.html" target="n" data-glyph="42,1" class="i field">Port</a>;
        <b>public string</b> <a id="642bcebdcaa0fbc8" href="../../../R/642bcebdcaa0fbc8.html" target="n" data-glyph="42,1" class="i field">Subsystem</a>;
        <b>public int</b> <a id="8f4127a02c1c3ac3" href="../../../R/8f4127a02c1c3ac3.html" target="n" data-glyph="42,1" class="i field">ConnectingTimeout</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for any cmdlet which takes a -Session parameter</span>
    <span class="c">///</span><span class="c"> or a -ComputerName parameter (along with its other associated</span>
    <span class="c">///</span><span class="c"> parameters). The following cmdlets currently fall under this</span>
    <span class="c">///</span><span class="c"> category:</span>
    <span class="c">///</span><span class="c">     1. New-PSSession</span>
    <span class="c">///</span><span class="c">     2. Invoke-Expression</span>
    <span class="c">///</span><span class="c">     3. Start-PSJob.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="3b23821ea164740f" href="../../../R/3b23821ea164740f.html" target="n" data-glyph="0,0" class="t t"><span id="082a60f8fe11da6a">PSRemotingBaseCmdlet</span></a> : <a href="#c2668678751e1b82" class="t t">PSRemotingCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Enums
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> State of virtual machine. This is the same as VMState in</span>
        <span class="c">///</span><span class="c"> \vm\ux\powershell\objects\common\Types.cs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="9d724f5455a8e524" href="../../../R/9d724f5455a8e524.html" target="n" data-glyph="20,1" class="t t"><span id="b43e49922a42cac8">VMState</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Other. Corresponds to CIM_EnabledLogicalElement.EnabledState = Other.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="62a1cd814761dbe0" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Other</a> = 1,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Running. Corresponds to CIM_EnabledLogicalElement.EnabledState = Enabled.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="7ceef812f32c3eef" href="../../../R/7ceef812f32c3eef.html" target="n" data-glyph="24,2" class="i field">Running</a> = 2,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Off. Corresponds to CIM_EnabledLogicalElement.EnabledState = Disabled.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="d9d0c88750cc5301" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Off</a> = 3,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Stopping. Corresponds to CIM_EnabledLogicalElement.EnabledState = ShuttingDown.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="cde42a81a818c2d8" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Stopping</a> = 4,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Saved. Corresponds to CIM_EnabledLogicalElement.EnabledState = Enabled but offline.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="18ff2012368427e9" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Saved</a> = 6,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Paused. Corresponds to CIM_EnabledLogicalElement.EnabledState = Quiesce.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="d8b3edccb8c90423" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Paused</a> = 9,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Starting. EnabledStateStarting. State transition from PowerOff or Saved to Running.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="7e8dc9437c415609" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Starting</a> = 10,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Reset. Corresponds to CIM_EnabledLogicalElement.EnabledState = Reset.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="2185f78448963dc4" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Reset</a> = 11,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Saving. Corresponds to EnabledStateSaving.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="dfba684ea27dca9c" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Saving</a> = 32773,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Pausing. Corresponds to EnabledStatePausing.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="92120bd65561ec3a" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Pausing</a> = 32776,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Resuming. Corresponds to EnabledStateResuming.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="77c9a6884e0c8ca8" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Resuming</a> = 32777,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> FastSaved. EnabledStateFastSuspend.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="24639a7ee4b54c90" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">FastSaved</a> = 32779,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> FastSaving. EnabledStateFastSuspending.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="670efdf3b7c92862" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">FastSaving</a> = 32780,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> ForceShutdown. Used to force a graceful shutdown of the virtual machine.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="250da3c7703f7f0b" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">ForceShutdown</a> = 32781,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> ForceReboot. Used to force a graceful reboot of the virtual machine.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="fbd367fd0f3fb923" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">ForceReboot</a> = 32782,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> RunningCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="978c2a3afcc34b2f" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">RunningCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> OffCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="3e4f17bcd2e44754" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">OffCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> StoppingCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="61fd5e8a1e6fbe1b" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">StoppingCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> SavedCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="96c29e9bc05c39b9" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SavedCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> PausedCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="0eec0b4766d65579" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">PausedCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> StartingCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="72cea930f780ad4d" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">StartingCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> ResetCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="115ff00f2c2cc56b" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">ResetCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> SavingCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="bc6da50e6ae78fa7" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SavingCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> PausingCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="7cfd89e84979c15d" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">PausingCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> ResumingCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="2b5c95cca52d54ac" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">ResumingCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> FastSavedCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="a644f2b6f1a129c2" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">FastSavedCritical</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> FastSavingCritical. Critical states.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="156d7c4c85c491e9" href="../../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">FastSavingCritical</a>,
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Tracer
 
        <span class="c">// PSETWTracer tracer = PSETWTracer.GetETWTracer(PSKeyword.Runspace);</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Tracer
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSSession object describing the remote runspace</span>
        <span class="c">///</span><span class="c"> using which the specified cmdlet operation will be performed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public virtual</b> <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>[] <a id="4e882500927a59be" href="../../../R/4e882500927a59be.html" target="n" data-glyph="102,1" class="i property">Session</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter represents the address(es) of the remote</span>
        <span class="c">///</span><span class="c"> computer(s). The following formats are supported:</span>
        <span class="c">///</span><span class="c">      (a) Computer name</span>
        <span class="c">///</span><span class="c">      (b) IPv4 address : 132.3.4.5</span>
        <span class="c">///</span><span class="c">      (c) IPv6 address: 3ffe:8311:ffff:f70f:0:5efe:172.30.162.18.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Cn&quot;</span>)]
        <b>public virtual string</b>[] <a id="9b9cf8f6c6346191" href="../../../R/9b9cf8f6c6346191.html" target="n" data-glyph="102,1" class="i property">ComputerName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer names after they have been resolved</span>
        <span class="c">///</span><span class="c"> (null, empty string, &quot;.&quot; resolves to localhost)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">If Null or empty string is specified, then localhost is assumed.</span>
        <span class="c">///</span><span class="c"> The ResolveComputerNames will include this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected string</b>[] <a id="19ecf5d9796fa338" href="../../../R/19ecf5d9796fa338.html" target="n" data-glyph="105,1" class="i property">ResolvedComputerNames</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Guid of target virtual machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;VMGuid&quot;</span>)]
        <b>public virtual</b> <span class="i">Guid</span>[] <a id="2d68dc03991378f6" href="../../../R/2d68dc03991378f6.html" target="n" data-glyph="102,1" class="i property">VMId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of target virtual machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public virtual string</b>[] <a id="f5f8ee826288d38c" href="../../../R/f5f8ee826288d38c.html" target="n" data-glyph="102,1" class="i property">VMName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the credentials of the user to impersonate in the</span>
        <span class="c">///</span><span class="c"> remote machine. If this parameter is not specified then the</span>
        <span class="c">///</span><span class="c"> credentials of the current user process will be assumed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Credential</span>()]
        <b>public virtual</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="6bc302d77d480a65" href="../../../R/6bc302d77d480a65.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#124e41f7a5d32598" class="i field">_pscredential</a>;
            }
 
            <b>set</b>
            {
                <a href="#124e41f7a5d32598" class="i field">_pscredential</a> = <b>value</b>;
                <a href="#86dfd1331ac33e3d" class="i method">ValidateSpecifiedAuthentication</a>(<a href="#6bc302d77d480a65" class="i property">Credential</a>, <a href="#f78523e35a5c6bee" class="i property">CertificateThumbprint</a>, <a href="#3fdef7f4fed9b04a" class="i property">Authentication</a>);
            }
        }
 
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="124e41f7a5d32598" href="../../../R/124e41f7a5d32598.html" target="n" data-glyph="46,1" class="i field">_pscredential</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ID of target container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public virtual string</b>[] <a id="779c010e206fb064" href="../../../R/779c010e206fb064.html" target="n" data-glyph="102,1" class="i property">ContainerId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When set, PowerShell process inside container will be launched with</span>
        <span class="c">///</span><span class="c"> high privileged account.</span>
        <span class="c">///</span><span class="c"> Otherwise (default case), PowerShell process inside container will be launched</span>
        <span class="c">///</span><span class="c"> with low privileged account.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        <b>public virtual</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="cd880049454ad846" href="../../../R/cd880049454ad846.html" target="n" data-glyph="102,1" class="i property">RunAsAdministrator</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Port specifies the alternate port to be used in case the</span>
        <span class="c">///</span><span class="c"> default ports are not used for the transport mechanism</span>
        <span class="c">///</span><span class="c"> (port 80 for http and port 443 for useSSL)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently this is being accepted as a parameter. But in future</span>
        <span class="c">///</span><span class="c"> support will be added to make this a part of a policy setting.</span>
        <span class="c">///</span><span class="c"> When a policy setting is in place this parameter can be used</span>
        <span class="c">///</span><span class="c"> to override the policy setting</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">ValidateRange</span>((<b>int</b>)1, (<b>int</b>)<span class="i">UInt16</span>.<span class="i">MaxValue</span>)]
        <b>public virtual int</b> <a id="c7b9201c1ed0baf1" href="../../../R/c7b9201c1ed0baf1.html" target="n" data-glyph="102,1" class="i property">Port</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter suggests that the transport scheme to be used for</span>
        <span class="c">///</span><span class="c"> remote connections is useSSL instead of the default http.Since</span>
        <span class="c">///</span><span class="c"> there are only two possible transport schemes that are possible</span>
        <span class="c">///</span><span class="c"> at this point, a SwitchParameter is being used to switch between</span>
        <span class="c">///</span><span class="c"> the two.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        <b>public virtual</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="f7dc857c5bcbf5f9" href="../../../R/f7dc857c5bcbf5f9.html" target="n" data-glyph="102,1" class="i property">UseSSL</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameters specifies the appname which identifies the connection</span>
        <span class="c">///</span><span class="c"> end point on the remote machine. If this parameter is not specified</span>
        <span class="c">///</span><span class="c"> then the value specified in DEFAULTREMOTEAPPNAME will be used. If thats</span>
        <span class="c">///</span><span class="c"> not specified as well, then &quot;WSMAN&quot; will be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        <b>public virtual string</b> <a id="eb12660da611783d" href="../../../R/eb12660da611783d.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#80c33f1b60d98b7b" class="i field">_appName</a>;
            }
 
            <b>set</b>
            {
                <a href="#80c33f1b60d98b7b" class="i field">_appName</a> = <a href="#24d404384c59cac5" class="i method">ResolveAppName</a>(<b>value</b>);
            }
        }
 
        <b>private string</b> <a id="80c33f1b60d98b7b" href="../../../R/80c33f1b60d98b7b.html" target="n" data-glyph="46,1" class="i field">_appName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allows the user of the cmdlet to specify a throttling value</span>
        <span class="c">///</span><span class="c"> for throttling the number of remote operations that can</span>
        <span class="c">///</span><span class="c"> be executed simultaneously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        <b>public virtual int</b> <a id="6e50a53369096f1e" href="../../../R/6e50a53369096f1e.html" target="n" data-glyph="102,1" class="i property">ThrottleLimit</a> { <b>get</b>; <b>set</b>; } = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A complete URI(s) specified for the remote computer and shell to</span>
        <span class="c">///</span><span class="c"> connect to and create runspace for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;URI&quot;</span>, <span class="s">&quot;CU&quot;</span>)]
        <b>public virtual</b> <span class="i">Uri</span>[] <a id="1650af9038e01fe5" href="../../../R/1650af9038e01fe5.html" target="n" data-glyph="102,1" class="i property">ConnectionUri</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The AllowRedirection parameter enables the implicit redirection functionality.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        <b>public virtual</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="cdda163a30fbf95b" href="../../../R/cdda163a30fbf95b.html" target="n" data-glyph="102,1" class="i property">AllowRedirection</a>
        {
            <b>get</b> { <b>return</b> <a href="#29027bb3238477bd" class="i field">_allowRedirection</a>; }
 
            <b>set</b> { <a href="#29027bb3238477bd" class="i field">_allowRedirection</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="29027bb3238477bd" href="../../../R/29027bb3238477bd.html" target="n" data-glyph="46,1" class="i field">_allowRedirection</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extended Session Options for controlling the session creation. Use</span>
        <span class="c">///</span><span class="c"> &quot;New-WSManSessionOption&quot; cmdlet to supply value for this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">ValidateNotNull</span>]
        <b>public virtual</b> <a href="#8626ee928362b305" class="t t">PSSessionOption</a> <a id="c791712b37902fe7" href="../../../R/c791712b37902fe7.html" target="n" data-glyph="102,1" class="i property">SessionOption</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#39e8c323f8e7fdb8" class="i field">_sessionOption</a> == <b>null</b>)
                {
                    <b>object</b> <span id="r14 rd" class="r14 r">tmp</span> = <a href="#3b23821ea164740f" class="k">this</a>.<a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#0198da5eba13cb75" class="i property">PSVariable</a>.<a href="../../VariableInterfaces.cs.html#20b9dd22f81d2a1c" class="i method">GetValue</a>(<a href="#079ce7151f202fe2" class="i field">DEFAULT_SESSION_OPTION</a>);
                    <b>if</b> (<span class="r14 r">tmp</span> == <b>null</b> || !<a href="../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../../LanguagePrimitives.cs.html#0ba3f8cd03b35aee" class="i method">TryConvertTo</a>&lt;<a href="#8626ee928362b305" class="t t">PSSessionOption</a>&gt;(<span class="r14 r">tmp</span>, <b>out</b> <a href="#39e8c323f8e7fdb8" class="i field">_sessionOption</a>))
                    {
                        <a href="#39e8c323f8e7fdb8" class="i field">_sessionOption</a> = <b>new</b> <a href="#90c789cd47314cbe" class="t constructor">PSSessionOption</a>();
                    }
                }
 
                <b>return</b> <a href="#39e8c323f8e7fdb8" class="i field">_sessionOption</a>;
            }
 
            <b>set</b>
            {
                <a href="#39e8c323f8e7fdb8" class="i field">_sessionOption</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="#8626ee928362b305" class="t t">PSSessionOption</a> <a id="39e8c323f8e7fdb8" href="../../../R/39e8c323f8e7fdb8.html" target="n" data-glyph="46,1" class="i field">_sessionOption</a>;
 
        <b>internal const string</b> <a id="079ce7151f202fe2" href="../../../R/079ce7151f202fe2.html" target="n" data-glyph="8,1" class="i field">DEFAULT_SESSION_OPTION</a> = <span class="s">&quot;PSSessionOption&quot;</span>;
 
        <span class="c">// Quota related variables.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use basic authentication to authenticate the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        <b>public virtual</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="3fdef7f4fed9b04a" href="../../../R/3fdef7f4fed9b04a.html" target="n" data-glyph="102,1" class="i property">Authentication</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#74e7737af6ad8229" class="i field">_authMechanism</a>;
            }
 
            <b>set</b>
            {
                <a href="#74e7737af6ad8229" class="i field">_authMechanism</a> = <b>value</b>;
                <span class="c">// Validate if a user can specify this authentication.</span>
                <a href="#86dfd1331ac33e3d" class="i method">ValidateSpecifiedAuthentication</a>(<a href="#6bc302d77d480a65" class="i property">Credential</a>, <a href="#f78523e35a5c6bee" class="i property">CertificateThumbprint</a>, <a href="#3fdef7f4fed9b04a" class="i property">Authentication</a>);
            }
        }
 
        <b>private</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="74e7737af6ad8229" href="../../../R/74e7737af6ad8229.html" target="n" data-glyph="46,1" class="i field">_authMechanism</a> = <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#aa044b4cbb803265" class="i field">Default</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the certificate thumbprint to be used to impersonate the user on the</span>
        <span class="c">///</span><span class="c"> remote machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="newrunspacecommand.cs.html#04eb0ee815ea8d44" class="t t">NewPSSessionCommand</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="newrunspacecommand.cs.html#04eb0ee815ea8d44" class="t t">NewPSSessionCommand</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        <b>public virtual string</b> <a id="f78523e35a5c6bee" href="../../../R/f78523e35a5c6bee.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a1652e20ed144b5e" class="i field">_thumbPrint</a>;
            }
 
            <b>set</b>
            {
                <a href="#a1652e20ed144b5e" class="i field">_thumbPrint</a> = <b>value</b>;
                <a href="#86dfd1331ac33e3d" class="i method">ValidateSpecifiedAuthentication</a>(<a href="#6bc302d77d480a65" class="i property">Credential</a>, <a href="#f78523e35a5c6bee" class="i property">CertificateThumbprint</a>, <a href="#3fdef7f4fed9b04a" class="i property">Authentication</a>);
            }
        }
 
        <b>private string</b> <a id="a1652e20ed144b5e" href="../../../R/a1652e20ed144b5e.html" target="n" data-glyph="46,1" class="i field">_thumbPrint</a> = <b>null</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> SSHHostParameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Host name for an SSH remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
            <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public virtual string</b>[] <a id="6cee174e0c9a888f" href="../../../R/6cee174e0c9a888f.html" target="n" data-glyph="102,1" class="i property">HostName</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SSH User Name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public virtual string</b> <a id="0c3a802c5bf13c48" href="../../../R/0c3a802c5bf13c48.html" target="n" data-glyph="102,1" class="i property">UserName</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SSH Key File Path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        [<span class="i">Alias</span>(<span class="s">&quot;IdentityFilePath&quot;</span>)]
        <b>public virtual string</b> <a id="764f077eaac4f43a" href="../../../R/764f077eaac4f43a.html" target="n" data-glyph="102,1" class="i property">KeyFilePath</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value for the SSH subsystem to use for the remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        <b>public virtual string</b> <a id="74ae07cd214614c2" href="../../../R/74ae07cd214614c2.html" target="n" data-glyph="102,1" class="i property">Subsystem</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value in milliseconds that limits the time allowed for an SSH connection to be established.</span>
        <span class="c">///</span><span class="c"> Default timeout value is infinite.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        <b>public virtual int</b> <a id="b41fd1bfc38a6b12" href="../../../R/b41fd1bfc38a6b12.html" target="n" data-glyph="102,1" class="i property">ConnectingTimeout</a> { <b>get</b>; <b>set</b>; } = <span class="i">Timeout</span>.<span class="i">Infinite</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter specifies that SSH is used to establish the remote</span>
        <span class="c">///</span><span class="c"> connection and act as the remoting transport.  By default WinRM is used</span>
        <span class="c">///</span><span class="c"> as the remoting transport.  Using the SSH transport requires that SSH is</span>
        <span class="c">///</span><span class="c"> installed and PowerShell remoting is enabled on both client and remote machines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">ValidateSet</span>(<span class="s">&quot;true&quot;</span>)]
        <b>public virtual</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="dd4aff5b664bbabf" href="../../../R/dd4aff5b664bbabf.html" target="n" data-glyph="102,1" class="i property">SSHTransport</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable array containing SSH connection parameters for each remote target</span>
        <span class="c">///</span><span class="c">   ComputerName  (Alias: HostName)           (required)</span>
        <span class="c">///</span><span class="c">   UserName                                  (optional)</span>
        <span class="c">///</span><span class="c">   KeyFilePath   (Alias: IdentityFilePath)   (optional)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public virtual</b> <span class="i">Hashtable</span>[] <a id="d9b079616a62293f" href="../../../R/d9b079616a62293f.html" target="n" data-glyph="102,1" class="i property">SSHConnection</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Static Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to resolve authentication from the parameters chosen by the user.</span>
        <span class="c">///</span><span class="c"> User has the following options:</span>
        <span class="c">///</span><span class="c"> 1. AuthMechanism + Credential</span>
        <span class="c">///</span><span class="c"> 2. CertificateThumbPrint</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> All the above are mutually exclusive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there is ambiguity as specified above.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="86dfd1331ac33e3d" href="../../../R/86dfd1331ac33e3d.html" target="n" data-glyph="74,1" class="i method">ValidateSpecifiedAuthentication</a>(<a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r15 rd" class="r15 r">credential</span>, <b>string</b> <span id="r16 rd" class="r16 r">thumbprint</span>, <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <span id="r17 rd" class="r17 r">authentication</span>)
        {
            <b>if</b> ((<span class="r15 r">credential</span> != <b>null</b>) &amp;&amp; (<span class="r16 r">thumbprint</span> != <b>null</b>))
            {
                <b>string</b> <span id="r18 rd" class="r18 r">message</span> = <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">NewRunspaceAmbiguousAuthentication</span>,
                        <span class="s">&quot;CertificateThumbPrint&quot;</span>, <span class="s">&quot;Credential&quot;</span>);
 
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r18 r">message</span>);
            }
 
            <b>if</b> ((<span class="r17 r">authentication</span> != <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#aa044b4cbb803265" class="i field">Default</a>) &amp;&amp; (<span class="r16 r">thumbprint</span> != <b>null</b>))
            {
                <b>string</b> <span id="r19 rd" class="r19 r">message</span> = <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">NewRunspaceAmbiguousAuthentication</span>,
                        <span class="s">&quot;CertificateThumbPrint&quot;</span>, <span class="r17 r">authentication</span>.<span class="i">ToString</span>());
 
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r19 r">message</span>);
            }
 
            <b>if</b> ((<span class="r17 r">authentication</span> == <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#74bfa4513a99b381" class="i field">NegotiateWithImplicitCredential</a>) &amp;&amp;
                (<span class="r15 r">credential</span> != <b>null</b>))
            {
                <b>string</b> <span id="r20 rd" class="r20 r">message</span> = <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">NewRunspaceAmbiguousAuthentication</span>,
                    <span class="s">&quot;Credential&quot;</span>, <span class="r17 r">authentication</span>.<span class="i">ToString</span>());
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r20 r">message</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> SSH Connection Strings
 
        <b>private const string</b> <a id="cacf4d6955a104dd" href="../../../R/cacf4d6955a104dd.html" target="n" data-glyph="10,1" class="i field">ComputerNameParameter</a> = <span class="s">&quot;ComputerName&quot;</span>;
        <b>private const string</b> <a id="150bc25b195e098b" href="../../../R/150bc25b195e098b.html" target="n" data-glyph="10,1" class="i field">HostNameAlias</a> = <span class="s">&quot;HostName&quot;</span>;
        <b>private const string</b> <a id="87ac14dceecdaeeb" href="../../../R/87ac14dceecdaeeb.html" target="n" data-glyph="10,1" class="i field">UserNameParameter</a> = <span class="s">&quot;UserName&quot;</span>;
        <b>private const string</b> <a id="b0783bcb9519dbca" href="../../../R/b0783bcb9519dbca.html" target="n" data-glyph="10,1" class="i field">KeyFilePathParameter</a> = <span class="s">&quot;KeyFilePath&quot;</span>;
        <b>private const string</b> <a id="760a116b454e5888" href="../../../R/760a116b454e5888.html" target="n" data-glyph="10,1" class="i field">IdentityFilePathAlias</a> = <span class="s">&quot;IdentityFilePath&quot;</span>;
        <b>private const string</b> <a id="08d8b1324d687712" href="../../../R/08d8b1324d687712.html" target="n" data-glyph="10,1" class="i field">PortParameter</a> = <span class="s">&quot;Port&quot;</span>;
        <b>private const string</b> <a id="7c778f748f2b39d8" href="../../../R/7c778f748f2b39d8.html" target="n" data-glyph="10,1" class="i field">SubsystemParameter</a> = <span class="s">&quot;Subsystem&quot;</span>;
        <b>private const string</b> <a id="191ecb8f53496dac" href="../../../R/191ecb8f53496dac.html" target="n" data-glyph="10,1" class="i field">ConnectingTimeoutParameter</a> = <span class="s">&quot;ConnectingTimeout&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse a hostname used with SSH Transport to get embedded</span>
        <span class="c">///</span><span class="c"> username and/or port.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">hostname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host name to parse.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resolved target host.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resolved target user name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resolved target port.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="2e8a7c4b18259ed2" href="../../../R/2e8a7c4b18259ed2.html" target="n" data-glyph="75,1" class="i method">ParseSshHostName</a>(<b>string</b> <span id="r21 rd" class="r21 r">hostname</span>, <b>out string</b> <span id="r22 rd" class="r22 r">host</span>, <b>out string</b> <span id="r23 rd" class="r23 r">userName</span>, <b>out int</b> <span id="r24 rd" class="r24 r">port</span>)
        {
            <span class="r22 r">host</span> = <span class="r21 r">hostname</span>;
            <span class="r23 r">userName</span> = <a href="#3b23821ea164740f" class="k">this</a>.<a href="#0c3a802c5bf13c48" class="i property">UserName</a>;
            <span class="r24 r">port</span> = <a href="#3b23821ea164740f" class="k">this</a>.<a href="#c7b9201c1ed0baf1" class="i property">Port</a>;
            <b>try</b>
            {
                <span class="i">Uri</span> <span id="r25 rd" class="r25 r">uri</span> = <b>new</b> <span class="i n">System</span>.<span class="i">Uri</span>(<span class="s">&quot;ssh://&quot;</span> + <span class="r21 r">hostname</span>);
                <span class="r22 r">host</span> = <span class="i">ResolveComputerName</span>(<span class="r25 r">uri</span>.<span class="i">Host</span>);
                <a href="#388006a7020aa69a" class="i method">ValidateComputerName</a>(<b>new</b> <b>string</b>[] { <span class="r22 r">host</span> });
                <b>if</b> (<span class="r25 r">uri</span>.<span class="i">UserInfo</span> != <b>string</b>.<span class="i">Empty</span>)
                {
                    <span class="r23 r">userName</span> = <span class="r25 r">uri</span>.<span class="i">UserInfo</span>;
                }
 
                <b>if</b> (<span class="r25 r">uri</span>.<span class="i">Port</span> != -1)
                {
                    <span class="r24 r">port</span> = <span class="r25 r">uri</span>.<span class="i">Port</span>;
                }
            }
            <b>catch</b> (<span class="i">UriFormatException</span>)
            {
                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<b>new</b> <span class="t">ErrorRecord</span>(
                    <b>new</b> <span class="i">ArgumentException</span>(<a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                        <span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidComputerName</span>)), <span class="s">&quot;PSSessionInvalidComputerName&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="r21 r">hostname</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse the Connection parameter HashTable array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of SSHConnection objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#b533a42b795165f4" class="t t">SSHConnection</a>[] <a id="58102051caf5e367" href="../../../R/58102051caf5e367.html" target="n" data-glyph="74,1" class="i method">ParseSSHConnectionHashTable</a>()
        {
            <span class="i">List</span>&lt;<a href="#b533a42b795165f4" class="t t">SSHConnection</a>&gt; <span id="r26 rd" class="r26 r">connections</span> = <b>new</b>();
            <b>foreach</b> (<b>var</b> <span id="r27 rd" class="r27 r">item</span> <b>in</b> <a href="#3b23821ea164740f" class="k">this</a>.<a href="#d9b079616a62293f" class="i property">SSHConnection</a>)
            {
                <b>if</b> (<span class="r27 r">item</span>.<span class="i">ContainsKey</span>(<a href="#cacf4d6955a104dd" class="i field">ComputerNameParameter</a>) &amp;&amp; <span class="r27 r">item</span>.<span class="i">ContainsKey</span>(<a href="#150bc25b195e098b" class="i field">HostNameAlias</a>))
                {
                    <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">SSHConnectionDuplicateHostName</span>);
                }
 
                <b>if</b> (<span class="r27 r">item</span>.<span class="i">ContainsKey</span>(<a href="#b0783bcb9519dbca" class="i field">KeyFilePathParameter</a>) &amp;&amp; <span class="r27 r">item</span>.<span class="i">ContainsKey</span>(<a href="#760a116b454e5888" class="i field">IdentityFilePathAlias</a>))
                {
                    <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">SSHConnectionDuplicateKeyPath</span>);
                }
 
                <a href="#b533a42b795165f4" class="t t">SSHConnection</a> <span id="r28 rd" class="r28 r">connectionInfo</span> = <b>new</b>();
                <b>foreach</b> (<b>var</b> <span id="r29 rd" class="r29 r">key</span> <b>in</b> <span class="r27 r">item</span>.<span class="i">Keys</span>)
                {
                    <b>string</b> <span id="r30 rd" class="r30 r">paramName</span> = <span class="r29 r">key</span> <b>as string</b>;
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r30 r">paramName</span>))
                    {
                        <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidSSHConnectionParameter</span>);
                    }
 
                    <b>if</b> (<span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#cacf4d6955a104dd" class="i field">ComputerNameParameter</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#150bc25b195e098b" class="i field">HostNameAlias</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>var</b> <span id="r31 rd" class="r31 r">resolvedComputerName</span> = <a href="#bd0c84ecceec9eb5" class="i method">ResolveComputerName</a>(<span class="i">GetSSHConnectionStringParameter</span>(<span class="r27 r">item</span>[<span class="r30 r">paramName</span>]));
                        <a href="#2e8a7c4b18259ed2" class="i method">ParseSshHostName</a>(<span class="r31 r">resolvedComputerName</span>, <b>out string</b> <span id="r32 rd" class="r32 r">host</span>, <b>out string</b> <span id="r33 rd" class="r33 r">userName</span>, <b>out int</b> <span id="r34 rd" class="r34 r">port</span>);
                        <span class="r28 r">connectionInfo</span>.<a href="#df02876ca8e195fd" class="i field">ComputerName</a> = <span class="r32 r">host</span>;
                        <b>if</b> (<span class="r33 r">userName</span> != <b>string</b>.<span class="i">Empty</span>)
                        {
                            <span class="r28 r">connectionInfo</span>.<a href="#d582bd5d329d4325" class="i field">UserName</a> = <span class="r33 r">userName</span>;
                        }
 
                        <b>if</b> (<span class="r34 r">port</span> != -1)
                        {
                            <span class="r28 r">connectionInfo</span>.<a href="#ccd070ed4731c66e" class="i field">Port</a> = <span class="r34 r">port</span>;
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#87ac14dceecdaeeb" class="i field">UserNameParameter</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r28 r">connectionInfo</span>.<a href="#d582bd5d329d4325" class="i field">UserName</a> = <span class="i">GetSSHConnectionStringParameter</span>(<span class="r27 r">item</span>[<span class="r30 r">paramName</span>]);
                    }
                    <b>else</b> <b>if</b> (<span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#b0783bcb9519dbca" class="i field">KeyFilePathParameter</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#760a116b454e5888" class="i field">IdentityFilePathAlias</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r28 r">connectionInfo</span>.<a href="#b66df45ec2b338dd" class="i field">KeyFilePath</a> = <span class="i">GetSSHConnectionStringParameter</span>(<span class="r27 r">item</span>[<span class="r30 r">paramName</span>]);
                    }
                    <b>else</b> <b>if</b> (<span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#08d8b1324d687712" class="i field">PortParameter</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r28 r">connectionInfo</span>.<a href="#ccd070ed4731c66e" class="i field">Port</a> = <span class="i">GetSSHConnectionIntParameter</span>(<span class="r27 r">item</span>[<span class="r30 r">paramName</span>]);
                    }
                    <b>else</b> <b>if</b> (<span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#7c778f748f2b39d8" class="i field">SubsystemParameter</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r28 r">connectionInfo</span>.<a href="#642bcebdcaa0fbc8" class="i field">Subsystem</a> = <span class="i">GetSSHConnectionStringParameter</span>(<span class="r27 r">item</span>[<span class="r30 r">paramName</span>]);
                    }
                    <b>else</b> <b>if</b> (<span class="r30 r">paramName</span>.<span class="i">Equals</span>(<a href="#191ecb8f53496dac" class="i field">ConnectingTimeoutParameter</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r28 r">connectionInfo</span>.<a href="#8f4127a02c1c3ac3" class="i field">ConnectingTimeout</a> = <span class="i">GetSSHConnectionIntParameter</span>(<span class="r27 r">item</span>[<span class="r30 r">paramName</span>]);
                    }
                    <b>else</b>
                    {
                        <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(
                            <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">UnknownSSHConnectionParameter</span>, <span class="r30 r">paramName</span>));
                    }
                }
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r28 r">connectionInfo</span>.<a href="#df02876ca8e195fd" class="i field">ComputerName</a>))
                {
                    <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">MissingRequiredSSHParameter</span>);
                }
 
                <span class="r26 r">connections</span>.<span class="i">Add</span>(<span class="r28 r">connectionInfo</span>);
            }
 
            <b>return</b> <span class="r26 r">connections</span>.<span class="i">ToArray</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate the PSSession objects specified and write</span>
        <span class="c">///</span><span class="c"> appropriate error records.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This function will lead in terminating errors when any of</span>
        <span class="c">///</span><span class="c"> the validations fail</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="a495755f39f42d2e" href="../../../R/a495755f39f42d2e.html" target="n" data-glyph="75,1" class="i method">ValidateRemoteRunspacesSpecified</a>()
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#4e882500927a59be" class="i property">Session</a> != <b>null</b> &amp;&amp; <a href="#4e882500927a59be" class="i property">Session</a>.<span class="i">Length</span> != 0,
                    <span class="s">&quot;Remote Runspaces specified must not be null or empty&quot;</span>);
 
            <span class="c">// Check if there are duplicates in the specified PSSession objects</span>
            <b>if</b> (<a href="remotingcommandutil.cs.html#4c008a65630ba320" class="t t">RemotingCommandUtil</a>.<a href="remotingcommandutil.cs.html#0fd2e5f203307219" class="i method">HasRepeatingRunspaces</a>(<a href="#4e882500927a59be" class="i property">Session</a>))
            {
                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <span class="i">ArgumentException</span>(
                    <span class="i">GetMessage</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteRunspaceInfoHasDuplicates</span>)),
                        <b>nameof</b>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#9fb92d5b4903db07" class="i field">RemoteRunspaceInfoHasDuplicates</a>),
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#4e882500927a59be" class="i property">Session</a>));
            }
 
            <span class="c">// BUGBUG: The following is a bogus check</span>
            <span class="c">// Check if the number of PSSession objects specified is greater</span>
            <span class="c">// than the maximum allowable range</span>
            <b>if</b> (<a href="remotingcommandutil.cs.html#4c008a65630ba320" class="t t">RemotingCommandUtil</a>.<a href="remotingcommandutil.cs.html#1baadf7dd747256f" class="i method">ExceedMaximumAllowableRunspaces</a>(<a href="#4e882500927a59be" class="i property">Session</a>))
            {
                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <span class="i">ArgumentException</span>(
                    <span class="i">GetMessage</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteRunspaceInfoLimitExceeded</span>)),
                        <b>nameof</b>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#24a6fe50b56a28c3" class="i field">RemoteRunspaceInfoLimitExceeded</a>),
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#4e882500927a59be" class="i property">Session</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Updates connection info with the data read from cmdlet&#39;s parameters and</span>
        <span class="c">///</span><span class="c"> sessions variables.</span>
        <span class="c">///</span><span class="c"> The following data is updated:</span>
        <span class="c">///</span><span class="c"> 1. MaxURIRedirectionCount</span>
        <span class="c">///</span><span class="c"> 2. MaxRecvdDataSizePerSession</span>
        <span class="c">///</span><span class="c"> 3. MaxRecvdDataSizePerCommand</span>
        <span class="c">///</span><span class="c"> 4. MaxRecvdObjectSize.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="6bc5b72b4986cb8e" href="../../../R/6bc5b72b4986cb8e.html" target="n" data-glyph="74,1" class="i method">UpdateConnectionInfo</a>(<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r35 rd" class="r35 r">connectionInfo</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r35 r">connectionInfo</span> != <b>null</b>, <span class="s">&quot;connectionInfo cannot be null.&quot;</span>);
 
            <span class="r35 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#90a3b8c25397a311" class="i method">SetSessionOptions</a>(<a href="#3b23821ea164740f" class="k">this</a>.<a href="#c791712b37902fe7" class="i property">SessionOption</a>);
 
            <b>if</b> (!<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// uri redirection is supported only with URI parameter set</span>
                <span class="r35 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#21431be8484ed16e" class="i property">MaximumConnectionRedirectionCount</a> = 0;
            }
 
            <b>if</b> (!<a href="#29027bb3238477bd" class="i field">_allowRedirection</a>)
            {
                <span class="c">// uri redirection required explicit user consent</span>
                <span class="r35 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#21431be8484ed16e" class="i property">MaximumConnectionRedirectionCount</a> = 0;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Uri parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="00bdee282001266a" href="../../../R/00bdee282001266a.html" target="n" data-glyph="9,1" class="i field">UriParameterSet</a> = <span class="s">&quot;Uri&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validates computer names to check if none of them</span>
        <span class="c">///</span><span class="c"> happen to be a Uri. If so this throws an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">computerNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">collection of computer</span>
        <span class="c">///</span><span class="c"> names to validate</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="388006a7020aa69a" href="../../../R/388006a7020aa69a.html" target="n" data-glyph="75,1" class="i method">ValidateComputerName</a>(<b>string</b>[] <span id="r36 rd" class="r36 r">computerNames</span>)
        {
            <b>foreach</b> (<b>string</b> <span id="r37 rd" class="r37 r">computerName</span> <b>in</b> <span class="r36 r">computerNames</span>)
            {
                <span class="i">UriHostNameType</span> <span id="r38 rd" class="r38 r">nametype</span> = <span class="i">Uri</span>.<span class="i">CheckHostName</span>(<span class="r37 r">computerName</span>);
                <b>if</b> (!(<span class="r38 r">nametype</span> == <span class="i">UriHostNameType</span>.<span class="i">Dns</span> || <span class="r38 r">nametype</span> == <span class="i">UriHostNameType</span>.<span class="i">IPv4</span> ||
                    <span class="r38 r">nametype</span> == <span class="i">UriHostNameType</span>.<span class="i">IPv6</span>))
                {
                    <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<b>new</b> <span class="t">ErrorRecord</span>(
                        <b>new</b> <span class="i">ArgumentException</span>(<a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                            <span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidComputerName</span>)), <span class="s">&quot;PSSessionInvalidComputerName&quot;</span>,
                                <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="r36 r">computerNames</span>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validates parameter value and returns as string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">param</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parameter value to be validated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Parameter value as string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="d6cbd39269ae6e54" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetSSHConnectionStringParameter</a>(<b>object</b> <span id="r39 rd" class="r39 r">param</span>)
        {
            <b>string</b> <span id="r40 rd" class="r40 r">paramValue</span>;
            <b>try</b>
            {
                <span class="r40 r">paramValue</span> = <a href="../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<b>string</b>&gt;(<span class="r39 r">param</span>);
            }
            <b>catch</b> (<a href="../../ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a> <span id="r41 rd" class="r41 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="r41 r">e</span>.<span class="i">Message</span>, <span class="r41 r">e</span>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r40 r">paramValue</span>))
            {
                <b>return</b> <span class="r40 r">paramValue</span>;
            }
 
            <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidSSHConnectionParameter</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validates parameter value and returns as integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">param</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parameter value to be validated.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Parameter value as integer.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="469b5100a64d875c" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetSSHConnectionIntParameter</a>(<b>object</b> <span id="r42 rd" class="r42 r">param</span>)
        {
            <b>if</b> (<span class="r42 r">param</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidSSHConnectionParameter</span>);
            }
 
            <b>try</b>
            {
                <b>return</b> <a href="../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<b>int</b>&gt;(<span class="r42 r">param</span>);
            }
            <b>catch</b> (<a href="../../ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a> <span id="r43 rd" class="r43 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="r43 r">e</span>.<span class="i">Message</span>, <span class="r43 r">e</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolves shellname and appname.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="2b247ef886dca829" href="../../../R/2b247ef886dca829.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#c2668678751e1b82" class="k">base</a>.<a href="#3da6242f8109ce30" class="i method">BeginProcessing</a>();
 
            <span class="c">// Validate KeyFilePath parameter.</span>
            <b>if</b> ((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>) &amp;&amp;
                (<a href="#3b23821ea164740f" class="k">this</a>.<a href="#764f077eaac4f43a" class="i property">KeyFilePath</a> != <b>null</b>))
            {
                <span class="c">// Resolve the key file path when set.</span>
                <a href="#3b23821ea164740f" class="k">this</a>.<a href="#764f077eaac4f43a" class="i property">KeyFilePath</a> = <a href="#47b1cb4d55714c48" class="t t">PathResolver</a>.<span class="i">ResolveProviderAndPath</span>(<a href="#3b23821ea164740f" class="k">this</a>.<a href="#764f077eaac4f43a" class="i property">KeyFilePath</a>, <b>true</b>, <a href="#3b23821ea164740f" class="k">this</a>, <b>false</b>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">FilePathNotFromFileSystemProvider</span>);
            }
 
            <span class="c">// Validate IdleTimeout parameter.</span>
            <b>int</b> <span id="r44 rd" class="r44 r">idleTimeout</span> = (<b>int</b>)<a href="#c791712b37902fe7" class="i property">SessionOption</a>.<a href="#42111d69f31e90b0" class="i property">IdleTimeout</a>.<span class="i">TotalMilliseconds</span>;
            <b>if</b> (<span class="r44 r">idleTimeout</span> != <a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#1aeb21f2c249b1c1" class="i field">UseServerDefaultIdleTimeout</a> &amp;&amp;
                <span class="r44 r">idleTimeout</span> &lt; <a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#d8495a878f117cdd" class="i field">MinimumIdleTimeout</a>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(
                    <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidIdleTimeoutOption</span>,
                    <span class="r44 r">idleTimeout</span> / 1000, <a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#d8495a878f117cdd" class="i field">MinimumIdleTimeout</a> / 1000));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#80c33f1b60d98b7b" class="i field">_appName</a>))
            {
                <a href="#80c33f1b60d98b7b" class="i field">_appName</a> = <a href="#24d404384c59cac5" class="i method">ResolveAppName</a>(<b>null</b>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for any cmdlet which has to execute a pipeline. The</span>
    <span class="c">///</span><span class="c"> following cmdlets currently fall under this category:</span>
    <span class="c">///</span><span class="c">     1. Invoke-Expression</span>
    <span class="c">///</span><span class="c">     2. Start-PSJob.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="68974ce2a1fdd25f" href="../../../R/68974ce2a1fdd25f.html" target="n" data-glyph="0,0" class="t t"><span id="2b2fed4150527cfb">PSExecutionCmdlet</span></a> : <a href="#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Strings
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> VM guid file path parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="e59b1f1999df2408" href="../../../R/e59b1f1999df2408.html" target="n" data-glyph="9,1" class="i field">FilePathVMIdParameterSet</a> = <span class="s">&quot;FilePathVMId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> VM name file path parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="9e391128a2b68753" href="../../../R/9e391128a2b68753.html" target="n" data-glyph="9,1" class="i field">FilePathVMNameParameterSet</a> = <span class="s">&quot;FilePathVMName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Container ID file path parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="d48040d57685dd98" href="../../../R/d48040d57685dd98.html" target="n" data-glyph="9,1" class="i field">FilePathContainerIdParameterSet</a> = <span class="s">&quot;FilePathContainerId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SSH Host file path parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="8e168891c20d8ea5" href="../../../R/8e168891c20d8ea5.html" target="n" data-glyph="9,1" class="i field">FilePathSSHHostParameterSet</a> = <span class="s">&quot;FilePathSSHHost&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SSH Host file path parameter set with HashTable connection parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="2ccab294cfc81d07" href="../../../R/2ccab294cfc81d07.html" target="n" data-glyph="9,1" class="i field">FilePathSSHHostHashParameterSet</a> = <span class="s">&quot;FilePathSSHHostHash&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Input object which gets assigned to $input when executed</span>
        <span class="c">///</span><span class="c"> on the remote machine. This is the only parameter in</span>
        <span class="c">///</span><span class="c"> this cmdlet which will bind with a ValueFromPipeline=true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        <b>public virtual</b> <a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="1417cb6c28b88894" href="../../../R/1417cb6c28b88894.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; } = <a href="../../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command to execute specified as a string. This can be a single</span>
        <span class="c">///</span><span class="c"> cmdlet, an expression or anything that can be internally</span>
        <span class="c">///</span><span class="c"> converted into a ScriptBlock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="44467d43b32a25a3" href="../../../R/44467d43b32a25a3.html" target="n" data-glyph="102,1" class="i property">ScriptBlock</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8356ac2000259292" class="i field">_scriptBlock</a>;
            }
 
            <b>set</b>
            {
                <a href="#8356ac2000259292" class="i field">_scriptBlock</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="8356ac2000259292" href="../../../R/8356ac2000259292.html" target="n" data-glyph="46,1" class="i field">_scriptBlock</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The file containing the script that the user has specified in the</span>
        <span class="c">///</span><span class="c"> cmdlet. This will be converted to a powershell before</span>
        <span class="c">///</span><span class="c"> its actually sent to the remote end.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">ValidateNotNull</span>]
        <b>public virtual string</b> <a id="59f94d9038624bbe" href="../../../R/59f94d9038624bbe.html" target="n" data-glyph="102,1" class="i property">FilePath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#29be2fee46862a9d" class="i field">_filePath</a>;
            }
 
            <b>set</b>
            {
                <a href="#29be2fee46862a9d" class="i field">_filePath</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="29be2fee46862a9d" href="../../../R/29be2fee46862a9d.html" target="n" data-glyph="46,1" class="i field">_filePath</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if FilePath should be processed as a literal path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="10589b0c528680d3" href="../../../R/10589b0c528680d3.html" target="n" data-glyph="105,1" class="i property">IsLiteralPath</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Arguments that are passed to this scriptblock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">Alias</span>(<span class="s">&quot;Args&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public virtual object</b>[] <a id="94dbe7e5383302d6" href="../../../R/94dbe7e5383302d6.html" target="n" data-glyph="102,1" class="i property">ArgumentList</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e2065136db3bbc85" class="i field">_args</a>;
            }
 
            <b>set</b>
            {
                <a href="#e2065136db3bbc85" class="i field">_args</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="e2065136db3bbc85" href="../../../R/e2065136db3bbc85.html" target="n" data-glyph="46,1" class="i field">_args</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that if a job/command is invoked remotely the connection should be severed</span>
        <span class="c">///</span><span class="c"> right have invocation of job/command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="49d1b3d35637c09a" href="../../../R/49d1b3d35637c09a.html" target="n" data-glyph="105,1" class="i property">InvokeAndDisconnect</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session names optionally provided for Disconnected parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>protected string</b>[] <a id="220b9643edb5e66c" href="../../../R/220b9643edb5e66c.html" target="n" data-glyph="105,1" class="i property">DisconnectedSessionName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When set and in loopback scenario (localhost) this enables creation of WSMan</span>
        <span class="c">///</span><span class="c"> host process with the user interactive token, allowing PowerShell script network access,</span>
        <span class="c">///</span><span class="c"> i.e., allows going off box.  When this property is true and a PSSession is disconnected,</span>
        <span class="c">///</span><span class="c"> reconnection is allowed only if reconnecting from a PowerShell session on the same box.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="61f5e003fc29b048" href="../../../R/61f5e003fc29b048.html" target="n" data-glyph="102,1" class="i property">EnableNetworkAccess</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Guid of target virtual machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;VMGuid&quot;</span>)]
        <b>public override</b> <span class="i">Guid</span>[] <a id="d86ffccdd4245e63" href="../../../R/d86ffccdd4245e63.html" target="n" data-glyph="102,1" class="i property">VMId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of target virtual machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public override string</b>[] <a id="8fea1ee927fbe2c1" href="../../../R/8fea1ee927fbe2c1.html" target="n" data-glyph="102,1" class="i property">VMName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ID of target container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public override string</b>[] <a id="658a373e3fd32208" href="../../../R/658a373e3fd32208.html" target="n" data-glyph="102,1" class="i property">ContainerId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For WSMan session:</span>
        <span class="c">///</span><span class="c"> If this parameter is not specified then the value specified in</span>
        <span class="c">///</span><span class="c"> the environment variable DEFAULTREMOTESHELLNAME will be used. If</span>
        <span class="c">///</span><span class="c"> this is not set as well, then Microsoft.PowerShell is used.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For VM/Container sessions:</span>
        <span class="c">///</span><span class="c"> If this parameter is not specified then no configuration is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="InvokeCommandCommand.cs.html#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        <b>public virtual string</b> <a id="0345617b8b4f6213" href="../../../R/0345617b8b4f6213.html" target="n" data-glyph="102,1" class="i property">ConfigurationName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates helper objects with the command for the specified</span>
        <span class="c">///</span><span class="c"> remote computer names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="99dba4ab181c22e3" href="../../../R/99dba4ab181c22e3.html" target="n" data-glyph="75,1" class="i method">CreateHelpersForSpecifiedComputerNames</a>()
        {
            <a href="#388006a7020aa69a" class="i method">ValidateComputerName</a>(<a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>);
 
            <span class="c">// create helper objects for computer names</span>
            <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r45 rd" class="r45 r">remoteRunspace</span> = <b>null</b>;
            <b>string</b> <span id="r46 rd" class="r46 r">scheme</span> = <a href="#f7dc857c5bcbf5f9" class="i property">UseSSL</a>.<a href="../../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a> ? <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#e8cee89627b2168d" class="i field">HttpsScheme</a> : <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#46c932f319b767db" class="i field">HttpScheme</a>;
 
            <b>for</b> (<b>int</b> <span id="r47 rd" class="r47 r">i</span> = 0; <span class="r47 r">i</span> &lt; <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>.<span class="i">Length</span>; <span class="r47 r">i</span>++)
            {
                <b>try</b>
                {
                    <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r48 rd" class="r48 r">connectionInfo</span> = <b>new</b> <a href="../common/RunspaceConnectionInfo.cs.html#633c07f34544868e" class="t constructor">WSManConnectionInfo</a>();
                    <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#d29b8b073c4a8931" class="i property">Scheme</a> = <span class="r46 r">scheme</span>;
                    <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#74b71e9668d24a47" class="i property">ComputerName</a> = <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>[<span class="r47 r">i</span>];
                    <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#1aeb2cc802b3a879" class="i property">Port</a> = <a href="#c7b9201c1ed0baf1" class="i property">Port</a>;
                    <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#0757157b257825db" class="i property">AppName</a> = <a href="#eb12660da611783d" class="i property">ApplicationName</a>;
                    <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#a0ee4c890acec948" class="i property">ShellUri</a> = <a href="#0345617b8b4f6213" class="i property">ConfigurationName</a>;
                    <b>if</b> (<a href="#f78523e35a5c6bee" class="i property">CertificateThumbprint</a> != <b>null</b>)
                    {
                        <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#4589105955753e41" class="i property">CertificateThumbprint</a> = <a href="#f78523e35a5c6bee" class="i property">CertificateThumbprint</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#5a783a782d2a0c8e" class="i property">Credential</a> = <a href="#6bc302d77d480a65" class="i property">Credential</a>;
                    }
 
                    <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#e1a2e5b5a5d08c41" class="i property">AuthenticationMechanism</a> = <a href="#3fdef7f4fed9b04a" class="i property">Authentication</a>;
 
                    <a href="#6bc5b72b4986cb8e" class="i method">UpdateConnectionInfo</a>(<span class="r48 r">connectionInfo</span>);
 
                    <span class="r48 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#bccff2b013731c62" class="i property">EnableNetworkAccess</a> = <a href="#61f5e003fc29b048" class="i property">EnableNetworkAccess</a>;
 
                    <span class="c">// Use the provided session name or create one for this remote runspace so that</span>
                    <span class="c">// it can be easily identified if it becomes disconnected and is queried on the server.</span>
                    <b>int</b> <span id="r49 rd" class="r49 r">rsId</span> = <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>.<a href="../client/remoterunspaceinfo.cs.html#7d204da21ce6a607" class="i method">GenerateRunspaceId</a>();
                    <b>string</b> <span id="r50 rd" class="r50 r">rsName</span> = (<a href="#220b9643edb5e66c" class="i property">DisconnectedSessionName</a> != <b>null</b> &amp;&amp; <a href="#220b9643edb5e66c" class="i property">DisconnectedSessionName</a>.<span class="i">Length</span> &gt; <span class="r47 r">i</span>) ?
                        <a href="#220b9643edb5e66c" class="i property">DisconnectedSessionName</a>[<span class="r47 r">i</span>] : <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>.<a href="../client/remoterunspaceinfo.cs.html#62039237bb23d055" class="i method">GenerateRunspaceName</a>(<b>out</b> <span class="r49 r">rsId</span>);
 
                    <span class="r45 r">remoteRunspace</span> = <b>new</b> <a href="../client/remoterunspace.cs.html#926354f3385f000b" class="t constructor">RemoteRunspace</a>(<a href="../../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../Utils.cs.html#7c94e15c53ac5a07" class="i method">GetTypeTableFromExecutionContextTLS</a>(), <span class="r48 r">connectionInfo</span>,
                        <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#c791712b37902fe7" class="i property">SessionOption</a>.<a href="#e85ec0b1616d3e82" class="i property">ApplicationArguments</a>, <span class="r50 r">rsName</span>, <span class="r49 r">rsId</span>);
 
                    <span class="r45 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a>.<a href="../../EventManager.cs.html#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="../../EventManager.cs.html#bce564b5d84fdbcb" class="i">PSEventReceived</a> += <a href="#063a02019cd2df2e" class="i method">OnRunspacePSEventReceived</a>;
                }
                <b>catch</b> (<span class="i">UriFormatException</span> <span id="r51 rd" class="r51 r">uriException</span>)
                {
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r52 rd" class="r52 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r51 r">uriException</span>, <span class="s">&quot;CreateRemoteRunspaceFailed&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>[<span class="r47 r">i</span>]);
 
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r52 r">errorRecord</span>);
 
                    <b>continue</b>;
                }
 
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r53 rd" class="r53 r">pipeline</span> = <a href="#545a3845d553c263" class="i method">CreatePipeline</a>(<span class="r45 r">remoteRunspace</span>);
 
                <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r54 rd" class="r54 r">operation</span> =
                    <b>new</b> <a href="#3e49a87652361d8a" class="t constructor">ExecutionCmdletHelperComputerName</a>(<span class="r45 r">remoteRunspace</span>, <span class="r53 r">pipeline</span>, <a href="#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a>);
 
                <a href="#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Add</span>(<span class="r54 r">operation</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates helper objects for SSH remoting computer names</span>
        <span class="c">///</span><span class="c"> remoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="643a109c6ad8d678" href="../../../R/643a109c6ad8d678.html" target="n" data-glyph="75,1" class="i method">CreateHelpersForSpecifiedSSHComputerNames</a>()
        {
            <b>foreach</b> (<b>string</b> <span id="r55 rd" class="r55 r">computerName</span> <b>in</b> <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>)
            {
                <a href="#2e8a7c4b18259ed2" class="i method">ParseSshHostName</a>(<span class="r55 r">computerName</span>, <b>out string</b> <span id="r56 rd" class="r56 r">host</span>, <b>out string</b> <span id="r57 rd" class="r57 r">userName</span>, <b>out int</b> <span id="r58 rd" class="r58 r">port</span>);
 
                <a href="../common/RunspaceConnectionInfo.cs.html#c9fcf5b14ea1c33c" class="k">var</a> <span id="r59 rd" class="r59 r">sshConnectionInfo</span> = <b>new</b> <a href="../common/RunspaceConnectionInfo.cs.html#2db667929f670ab9" class="t constructor">SSHConnectionInfo</a>(<span class="r57 r">userName</span>, <span class="r56 r">host</span>, <a href="#764f077eaac4f43a" class="i property">KeyFilePath</a>, <span class="r58 r">port</span>, <a href="#74ae07cd214614c2" class="i property">Subsystem</a>, <a href="#b41fd1bfc38a6b12" class="i property">ConnectingTimeout</a>);
                <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="k">var</a> <span id="r60 rd" class="r60 r">typeTable</span> = <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="../../TypeTable.cs.html#c6d160f5d02296fa" class="i method">LoadDefaultTypeFiles</a>();
                <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="k">var</a> <span id="r61 rd" class="r61 r">remoteRunspace</span> = <a href="../../hostifaces/ConnectionFactory.cs.html#c5fbe142e4e21218" class="t t">RunspaceFactory</a>.<a href="../../hostifaces/ConnectionFactory.cs.html#7efc9e75cdb9fe67" class="i method">CreateRunspace</a>(<span class="r59 r">sshConnectionInfo</span>, <a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>, <span class="r60 r">typeTable</span>) <b>as</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="k">var</a> <span id="r62 rd" class="r62 r">pipeline</span> = <a href="#545a3845d553c263" class="i method">CreatePipeline</a>(<span class="r61 r">remoteRunspace</span>);
 
                <a href="#5ff009e2ef1552ca" class="k">var</a> <span id="r63 rd" class="r63 r">operation</span> = <b>new</b> <a href="#3e49a87652361d8a" class="t constructor">ExecutionCmdletHelperComputerName</a>(<span class="r61 r">remoteRunspace</span>, <span class="r62 r">pipeline</span>);
                <a href="#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Add</span>(<span class="r63 r">operation</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates helper objects for SSH remoting from HashTable parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="ae84d0d2a8d72a93" href="../../../R/ae84d0d2a8d72a93.html" target="n" data-glyph="75,1" class="i method">CreateHelpersForSpecifiedSSHHashComputerNames</a>()
        {
            <b>var</b> <span id="r64 rd" class="r64 r">sshConnections</span> = <a href="#58102051caf5e367" class="i method">ParseSSHConnectionHashTable</a>();
            <b>foreach</b> (<a href="#b533a42b795165f4" class="k">var</a> <span id="r65 rd" class="r65 r">sshConnection</span> <b>in</b> <span class="r64 r">sshConnections</span>)
            {
                <a href="../common/RunspaceConnectionInfo.cs.html#c9fcf5b14ea1c33c" class="k">var</a> <span id="r66 rd" class="r66 r">sshConnectionInfo</span> = <b>new</b> <a href="../common/RunspaceConnectionInfo.cs.html#2db667929f670ab9" class="t constructor">SSHConnectionInfo</a>(
                    <span class="r65 r">sshConnection</span>.<a href="#d582bd5d329d4325" class="i field">UserName</a>,
                    <span class="r65 r">sshConnection</span>.<a href="#df02876ca8e195fd" class="i field">ComputerName</a>,
                    <span class="r65 r">sshConnection</span>.<a href="#b66df45ec2b338dd" class="i field">KeyFilePath</a>,
                    <span class="r65 r">sshConnection</span>.<a href="#ccd070ed4731c66e" class="i field">Port</a>,
                    <span class="r65 r">sshConnection</span>.<a href="#642bcebdcaa0fbc8" class="i field">Subsystem</a>,
                    <span class="r65 r">sshConnection</span>.<a href="#8f4127a02c1c3ac3" class="i field">ConnectingTimeout</a>);
                <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="k">var</a> <span id="r67 rd" class="r67 r">typeTable</span> = <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="../../TypeTable.cs.html#c6d160f5d02296fa" class="i method">LoadDefaultTypeFiles</a>();
                <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="k">var</a> <span id="r68 rd" class="r68 r">remoteRunspace</span> = <a href="../../hostifaces/ConnectionFactory.cs.html#c5fbe142e4e21218" class="t t">RunspaceFactory</a>.<a href="../../hostifaces/ConnectionFactory.cs.html#7efc9e75cdb9fe67" class="i method">CreateRunspace</a>(<span class="r66 r">sshConnectionInfo</span>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>, <span class="r67 r">typeTable</span>) <b>as</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="k">var</a> <span id="r69 rd" class="r69 r">pipeline</span> = <a href="#545a3845d553c263" class="i method">CreatePipeline</a>(<span class="r68 r">remoteRunspace</span>);
 
                <a href="#5ff009e2ef1552ca" class="k">var</a> <span id="r70 rd" class="r70 r">operation</span> = <b>new</b> <a href="#3e49a87652361d8a" class="t constructor">ExecutionCmdletHelperComputerName</a>(<span class="r68 r">remoteRunspace</span>, <span class="r69 r">pipeline</span>);
                <a href="#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Add</span>(<span class="r70 r">operation</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates helper objects with the specified command for</span>
        <span class="c">///</span><span class="c"> the specified remote runspaceinfo objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>protected void</b> <a id="27f380230a8cc4b0" href="../../../R/27f380230a8cc4b0.html" target="n" data-glyph="75,1" class="i method">CreateHelpersForSpecifiedRunspaces</a>()
        {
            <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>[] <span id="r71 rd" class="r71 r">remoteRunspaces</span>;
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a>[] <span id="r72 rd" class="r72 r">pipelines</span>;
 
            <span class="c">// extract RemoteRunspace out of the PSSession objects</span>
            <b>int</b> <span id="r73 rd" class="r73 r">length</span> = <a href="#4e882500927a59be" class="i property">Session</a>.<span class="i">Length</span>;
            <span class="r71 r">remoteRunspaces</span> = <b>new</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>[<span class="r73 r">length</span>];
 
            <b>for</b> (<b>int</b> <span id="r74 rd" class="r74 r">i</span> = 0; <span class="r74 r">i</span> &lt; <span class="r73 r">length</span>; <span class="r74 r">i</span>++)
            {
                <span class="r71 r">remoteRunspaces</span>[<span class="r74 r">i</span>] = (<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>)<a href="#4e882500927a59be" class="i property">Session</a>[<span class="r74 r">i</span>].<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>;
            }
 
            <span class="c">// create the set of pipelines from the RemoteRunspace objects and</span>
            <span class="c">// create IREHelperRunspace helper class to create operations</span>
            <span class="r72 r">pipelines</span> = <b>new</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a>[<span class="r73 r">length</span>];
 
            <b>for</b> (<b>int</b> <span id="r75 rd" class="r75 r">i</span> = 0; <span class="r75 r">i</span> &lt; <span class="r73 r">length</span>; <span class="r75 r">i</span>++)
            {
                <span class="r72 r">pipelines</span>[<span class="r75 r">i</span>] = <a href="#545a3845d553c263" class="i method">CreatePipeline</a>(<span class="r71 r">remoteRunspaces</span>[<span class="r75 r">i</span>]);
 
                <span class="c">// create the operation object</span>
                <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r76 rd" class="r76 r">operation</span> = <b>new</b> <a href="#1e390b4c4aa82741" class="t constructor">ExecutionCmdletHelperRunspace</a>(<span class="r72 r">pipelines</span>[<span class="r75 r">i</span>]);
                <a href="#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Add</span>(<span class="r76 r">operation</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates helper objects with the command for the specified</span>
        <span class="c">///</span><span class="c"> remote connection uris.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="f5e046e362b33381" href="../../../R/f5e046e362b33381.html" target="n" data-glyph="75,1" class="i method">CreateHelpersForSpecifiedUris</a>()
        {
            <span class="c">// create helper objects for computer names</span>
            <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r77 rd" class="r77 r">remoteRunspace</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r78 rd" class="r78 r">i</span> = 0; <span class="r78 r">i</span> &lt; <a href="#1650af9038e01fe5" class="i property">ConnectionUri</a>.<span class="i">Length</span>; <span class="r78 r">i</span>++)
            {
                <b>try</b>
                {
                    <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r79 rd" class="r79 r">connectionInfo</span> = <b>new</b> <a href="../common/RunspaceConnectionInfo.cs.html#633c07f34544868e" class="t constructor">WSManConnectionInfo</a>();
 
                    <span class="r79 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#eb73ffdb9b586505" class="i property">ConnectionUri</a> = <a href="#1650af9038e01fe5" class="i property">ConnectionUri</a>[<span class="r78 r">i</span>];
                    <span class="r79 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#a0ee4c890acec948" class="i property">ShellUri</a> = <a href="#0345617b8b4f6213" class="i property">ConfigurationName</a>;
 
                    <b>if</b> (<a href="#f78523e35a5c6bee" class="i property">CertificateThumbprint</a> != <b>null</b>)
                    {
                        <span class="r79 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#4589105955753e41" class="i property">CertificateThumbprint</a> = <a href="#f78523e35a5c6bee" class="i property">CertificateThumbprint</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r79 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#5a783a782d2a0c8e" class="i property">Credential</a> = <a href="#6bc302d77d480a65" class="i property">Credential</a>;
                    }
 
                    <span class="r79 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#e1a2e5b5a5d08c41" class="i property">AuthenticationMechanism</a> = <a href="#3fdef7f4fed9b04a" class="i property">Authentication</a>;
 
                    <a href="#6bc5b72b4986cb8e" class="i method">UpdateConnectionInfo</a>(<span class="r79 r">connectionInfo</span>);
 
                    <span class="r79 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#bccff2b013731c62" class="i property">EnableNetworkAccess</a> = <a href="#61f5e003fc29b048" class="i property">EnableNetworkAccess</a>;
 
                    <span class="r77 r">remoteRunspace</span> = (<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>)<a href="../../hostifaces/ConnectionFactory.cs.html#c5fbe142e4e21218" class="t t">RunspaceFactory</a>.<a href="../../hostifaces/ConnectionFactory.cs.html#c3cf03d3549f6479" class="i method">CreateRunspace</a>(<span class="r79 r">connectionInfo</span>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>,
                        <a href="../../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../Utils.cs.html#7c94e15c53ac5a07" class="i method">GetTypeTableFromExecutionContextTLS</a>(),
                        <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#c791712b37902fe7" class="i property">SessionOption</a>.<a href="#e85ec0b1616d3e82" class="i property">ApplicationArguments</a>);
 
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r77 r">remoteRunspace</span> != <b>null</b>,
                            <span class="s">&quot;RemoteRunspace object created using URI is null&quot;</span>);
 
                    <span class="r77 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a>.<a href="../../EventManager.cs.html#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="../../EventManager.cs.html#bce564b5d84fdbcb" class="i">PSEventReceived</a> += <a href="#063a02019cd2df2e" class="i method">OnRunspacePSEventReceived</a>;
                }
                <b>catch</b> (<span class="i">UriFormatException</span> <span id="r80 rd" class="r80 r">e</span>)
                {
                    <span class="i">WriteErrorCreateRemoteRunspaceFailed</span>(<span class="r80 r">e</span>, <a href="#1650af9038e01fe5" class="i property">ConnectionUri</a>[<span class="r78 r">i</span>]);
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r81 rd" class="r81 r">e</span>)
                {
                    <span class="i">WriteErrorCreateRemoteRunspaceFailed</span>(<span class="r81 r">e</span>, <a href="#1650af9038e01fe5" class="i property">ConnectionUri</a>[<span class="r78 r">i</span>]);
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r82 rd" class="r82 r">e</span>)
                {
                    <span class="i">WriteErrorCreateRemoteRunspaceFailed</span>(<span class="r82 r">e</span>, <a href="#1650af9038e01fe5" class="i property">ConnectionUri</a>[<span class="r78 r">i</span>]);
                    <b>continue</b>;
                }
 
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r83 rd" class="r83 r">pipeline</span> = <a href="#545a3845d553c263" class="i method">CreatePipeline</a>(<span class="r77 r">remoteRunspace</span>);
 
                <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r84 rd" class="r84 r">operation</span> =
                    <b>new</b> <a href="#3e49a87652361d8a" class="t constructor">ExecutionCmdletHelperComputerName</a>(<span class="r77 r">remoteRunspace</span>, <span class="r83 r">pipeline</span>, <a href="#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a>);
 
                <a href="#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Add</span>(<span class="r84 r">operation</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates helper objects with the command for the specified</span>
        <span class="c">///</span><span class="c"> VM GUIDs or VM names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="6ce233a651721da6" href="../../../R/6ce233a651721da6.html" target="n" data-glyph="75,1" class="i method">CreateHelpersForSpecifiedVMSession</a>()
        {
            <b>int</b> <span id="r85 rd" class="r85 r">inputArraySize</span>;
            <b>int</b> <span id="r86 rd" class="r86 r">index</span>;
            <b>string</b> <span id="r87 rd" class="r87 r">command</span>;
            <b>bool</b>[] <span id="r88 rd" class="r88 r">vmIsRunning</span>;
            <span class="i">Collection</span>&lt;<a href="../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r89 rd" class="r89 r">results</span>;
 
            <b>if</b> ((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>) ||
                (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>))
            {
                <span class="r85 r">inputArraySize</span> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a>.<span class="i">Length</span>;
                <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a> = <b>new</b> <b>string</b>[<span class="r85 r">inputArraySize</span>];
                <span class="r88 r">vmIsRunning</span> = <b>new</b> <b>bool</b>[<span class="r85 r">inputArraySize</span>];
 
                <b>for</b> (<span class="r86 r">index</span> = 0; <span class="r86 r">index</span> &lt; <span class="r85 r">inputArraySize</span>; <span class="r86 r">index</span>++)
                {
                    <span class="r88 r">vmIsRunning</span>[<span class="r86 r">index</span>] = <b>false</b>;
 
                    <span class="r87 r">command</span> = <span class="s">&quot;Get-VM -Id $args[0]&quot;</span>;
 
                    <b>try</b>
                    {
                        <span class="r89 r">results</span> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../MshCmdlet.cs.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<span class="i">InvokeScript</span>(
                            <span class="r87 r">command</span>, <b>false</b>, <a href="../../hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="../../hostifaces/Command.cs.html#2176d4a38e55153d" class="i field">None</a>, <b>null</b>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a>[<span class="r86 r">index</span>]);
                    }
                    <b>catch</b> (<a href="../../../utils/CommandDiscoveryExceptions.cs.html#d61739861b769224" class="t t">CommandNotFoundException</a>)
                    {
                        <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                            <b>new</b> <span class="t">ErrorRecord</span>(
                                <b>new</b> <span class="i">ArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">HyperVModuleNotAvailable</span>),
                                <b>nameof</b>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#09e45f002736cd62" class="i field">HyperVModuleNotAvailable</a>),
                                <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#1b53f568895cb17a" class="i field">NotInstalled</a>,
                                <b>null</b>));
 
                        <b>return</b>;
                    }
 
                    <b>if</b> (<span class="r89 r">results</span>.<span class="i">Count</span> != 1)
                    {
                        <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>] = <b>string</b>.<span class="i">Empty</span>;
                    }
                    <b>else</b>
                    {
                        <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>] = (<b>string</b>)<span class="r89 r">results</span>[0].<span class="i">Properties</span>[<span class="s">&quot;VMName&quot;</span>].<span class="i">Value</span>;
 
                        <b>if</b> ((<a href="#9d724f5455a8e524" class="t t">VMState</a>)<span class="r89 r">results</span>[0].<span class="i">Properties</span>[<span class="s">&quot;State&quot;</span>].<span class="i">Value</span> == <a href="#9d724f5455a8e524" class="t t">VMState</a>.<a href="#7ceef812f32c3eef" class="i field">Running</a>)
                        {
                            <span class="r88 r">vmIsRunning</span>[<span class="r86 r">index</span>] = <b>true</b>;
                        }
                    }
                }
            }
            <b>else</b>
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>) ||
                           (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>),
                           <span class="s">&quot;Expected ParameterSetName == VMName or FilePathVMName&quot;</span>);
 
                <span class="r85 r">inputArraySize</span> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>.<span class="i">Length</span>;
                <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a> = <b>new</b> <span class="i">Guid</span>[<span class="r85 r">inputArraySize</span>];
                <span class="r88 r">vmIsRunning</span> = <b>new</b> <b>bool</b>[<span class="r85 r">inputArraySize</span>];
 
                <b>for</b> (<span class="r86 r">index</span> = 0; <span class="r86 r">index</span> &lt; <span class="r85 r">inputArraySize</span>; <span class="r86 r">index</span>++)
                {
                    <span class="r88 r">vmIsRunning</span>[<span class="r86 r">index</span>] = <b>false</b>;
 
                    <span class="r87 r">command</span> = <span class="s">&quot;Get-VM -Name $args&quot;</span>;
 
                    <b>try</b>
                    {
                        <span class="r89 r">results</span> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../MshCmdlet.cs.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<a href="../../MshCmdlet.cs.html#2564f48a57fd58ca" class="i method">InvokeScript</a>(
                            <span class="r87 r">command</span>, <b>false</b>, <a href="../../hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="../../hostifaces/Command.cs.html#2176d4a38e55153d" class="i field">None</a>, <b>null</b>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>]);
                    }
                    <b>catch</b> (<a href="../../../utils/CommandDiscoveryExceptions.cs.html#d61739861b769224" class="t t">CommandNotFoundException</a>)
                    {
                        <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                            <b>new</b> <span class="t">ErrorRecord</span>(
                                <b>new</b> <span class="i">ArgumentException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">HyperVModuleNotAvailable</span>),
                                <b>nameof</b>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#09e45f002736cd62" class="i field">HyperVModuleNotAvailable</a>),
                                <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#1b53f568895cb17a" class="i field">NotInstalled</a>,
                                <b>null</b>));
 
                        <b>return</b>;
                    }
 
                    <b>if</b> (<span class="r89 r">results</span>.<span class="i">Count</span> != 1)
                    {
                        <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a>[<span class="r86 r">index</span>] = <span class="i">Guid</span>.<span class="i">Empty</span>;
                    }
                    <b>else</b>
                    {
                        <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a>[<span class="r86 r">index</span>] = (<span class="i">Guid</span>)<span class="r89 r">results</span>[0].<span class="i">Properties</span>[<span class="s">&quot;VMId&quot;</span>].<span class="i">Value</span>;
                        <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>] = (<b>string</b>)<span class="r89 r">results</span>[0].<span class="i">Properties</span>[<span class="s">&quot;VMName&quot;</span>].<span class="i">Value</span>;
 
                        <b>if</b> ((<a href="#9d724f5455a8e524" class="t t">VMState</a>)<span class="r89 r">results</span>[0].<span class="i">Properties</span>[<span class="s">&quot;State&quot;</span>].<span class="i">Value</span> == <a href="#9d724f5455a8e524" class="t t">VMState</a>.<a href="#7ceef812f32c3eef" class="i field">Running</a>)
                        {
                            <span class="r88 r">vmIsRunning</span>[<span class="r86 r">index</span>] = <b>true</b>;
                        }
                    }
                }
            }
 
            <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>;
 
            <b>for</b> (<span class="r86 r">index</span> = 0; <span class="r86 r">index</span> &lt; <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>.<span class="i">Length</span>; <span class="r86 r">index</span>++)
            {
                <b>if</b> ((<a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a>[<span class="r86 r">index</span>] == <span class="i">Guid</span>.<span class="i">Empty</span>) &amp;&amp;
                    ((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>) ||
                     (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)))
                {
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(
                            <b>new</b> <span class="i">ArgumentException</span>(<span class="i">GetMessage</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidVMNameNotSingle</span>,
                                                             <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>])),
                            <b>nameof</b>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#dd198f7c549c663c" class="i field">InvalidVMNameNotSingle</a>),
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <b>null</b>));
 
                    <b>continue</b>;
                }
                <b>else</b> <b>if</b> ((<a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>] == <b>string</b>.<span class="i">Empty</span>) &amp;&amp;
                         ((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>) ||
                          (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)))
                {
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(
                            <b>new</b> <span class="i">ArgumentException</span>(<span class="i">GetMessage</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidVMIdNotSingle</span>,
                                                             <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a>[<span class="r86 r">index</span>].<span class="i">ToString</span>(<b>null</b>))),
                            <b>nameof</b>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#88d95a21d50e69f2" class="i field">InvalidVMIdNotSingle</a>),
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <b>null</b>));
 
                    <b>continue</b>;
                }
                <b>else</b> <b>if</b> (!<span class="r88 r">vmIsRunning</span>[<span class="r86 r">index</span>])
                {
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(
                            <b>new</b> <span class="i">ArgumentException</span>(<span class="i">GetMessage</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidVMState</span>,
                                                             <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>])),
                            <b>nameof</b>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#95e1f86f2941307a" class="i field">InvalidVMState</a>),
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <b>null</b>));
 
                    <b>continue</b>;
                }
 
                <span class="c">// create helper objects for VM GUIDs or names</span>
                <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r90 rd" class="r90 r">remoteRunspace</span> = <b>null</b>;
                <a href="../common/RunspaceConnectionInfo.cs.html#3906a420e89ab01e" class="t t">VMConnectionInfo</a> <span id="r91 rd" class="r91 r">connectionInfo</span>;
 
                <b>try</b>
                {
                    <span class="r91 r">connectionInfo</span> = <b>new</b> <a href="../common/RunspaceConnectionInfo.cs.html#14edb95257658f82" class="t constructor">VMConnectionInfo</a>(<a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#6bc302d77d480a65" class="i property">Credential</a>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#d86ffccdd4245e63" class="i property">VMId</a>[<span class="r86 r">index</span>], <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#8fea1ee927fbe2c1" class="i property">VMName</a>[<span class="r86 r">index</span>], <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#0345617b8b4f6213" class="i property">ConfigurationName</a>);
 
                    <span class="r90 r">remoteRunspace</span> = <b>new</b> <span class="t">RemoteRunspace</span>(<a href="../../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../Utils.cs.html#7c94e15c53ac5a07" class="i method">GetTypeTableFromExecutionContextTLS</a>(),
                        <span class="r91 r">connectionInfo</span>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>, <b>null</b>, <b>null</b>, -1);
 
                    <span class="r90 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a>.<a href="../../EventManager.cs.html#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="../../EventManager.cs.html#bce564b5d84fdbcb" class="i">PSEventReceived</a> += <a href="#063a02019cd2df2e" class="i method">OnRunspacePSEventReceived</a>;
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r92 rd" class="r92 r">e</span>)
                {
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r93 rd" class="r93 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r92 r">e</span>,
                        <span class="s">&quot;CreateRemoteRunspaceForVMFailed&quot;</span>,
                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                        <b>null</b>);
 
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r93 r">errorRecord</span>);
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r94 rd" class="r94 r">e</span>)
                {
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r95 rd" class="r95 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r94 r">e</span>,
                        <span class="s">&quot;CreateRemoteRunspaceForVMFailed&quot;</span>,
                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <b>null</b>);
 
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r95 r">errorRecord</span>);
                }
 
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r96 rd" class="r96 r">pipeline</span> = <a href="#545a3845d553c263" class="i method">CreatePipeline</a>(<span class="r90 r">remoteRunspace</span>);
 
                <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r97 rd" class="r97 r">operation</span> =
                    <b>new</b> <a href="#3e49a87652361d8a" class="t constructor">ExecutionCmdletHelperComputerName</a>(<span class="r90 r">remoteRunspace</span>, <span class="r96 r">pipeline</span>, <b>false</b>);
 
                <a href="#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Add</span>(<span class="r97 r">operation</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates helper objects with the command for the specified</span>
        <span class="c">///</span><span class="c"> container IDs or names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="0494fd711b6e150e" href="../../../R/0494fd711b6e150e.html" target="n" data-glyph="75,1" class="i method">CreateHelpersForSpecifiedContainerSession</a>()
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r98 rd" class="r98 r">resolvedNameList</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>) ||
                       (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>),
                       <span class="s">&quot;Expected ParameterSetName == ContainerId or FilePathContainerId&quot;</span>);
 
            <b>foreach</b> (<b>var</b> <span id="r99 rd" class="r99 r">input</span> <b>in</b> <a href="#658a373e3fd32208" class="i property">ContainerId</a>)
            {
                <span class="c">//</span>
                <span class="c">// Create helper objects for container ID or name.</span>
                <span class="c">//</span>
                <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r100 rd" class="r100 r">remoteRunspace</span> = <b>null</b>;
                <a href="../common/RunspaceConnectionInfo.cs.html#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a> <span id="r101 rd" class="r101 r">connectionInfo</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="c">//</span>
                    <span class="c">// Hyper-V container uses Hype-V socket as transport.</span>
                    <span class="c">// Windows Server container uses named pipe as transport.</span>
                    <span class="c">//</span>
                    <span class="r101 r">connectionInfo</span> = <a href="../common/RunspaceConnectionInfo.cs.html#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#ceceac64cec04a81" class="i method">CreateContainerConnectionInfo</a>(<span class="r99 r">input</span>, <a href="#cd880049454ad846" class="i property">RunAsAdministrator</a>.<a href="../../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="#0345617b8b4f6213" class="i property">ConfigurationName</a>);
 
                    <span class="r98 r">resolvedNameList</span>.<span class="i">Add</span>(<span class="r101 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#f801a4fbbda7199f" class="i property">ComputerName</a>);
 
                    <span class="r101 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#c98e542c0a68e45e" class="i method">CreateContainerProcess</a>();
 
                    <span class="r100 r">remoteRunspace</span> = <b>new</b> <span class="t">RemoteRunspace</span>(<a href="../../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../Utils.cs.html#7c94e15c53ac5a07" class="i method">GetTypeTableFromExecutionContextTLS</a>(),
                        <span class="r101 r">connectionInfo</span>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>, <b>null</b>, <b>null</b>, -1);
 
                    <span class="r100 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#5b35598bcb0cb4ef" class="i property">Events</a>.<a href="../../EventManager.cs.html#fc398910d6752597" class="i property">ReceivedEvents</a>.<a href="../../EventManager.cs.html#bce564b5d84fdbcb" class="i">PSEventReceived</a> += <a href="#063a02019cd2df2e" class="i method">OnRunspacePSEventReceived</a>;
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r102 rd" class="r102 r">e</span>)
                {
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r103 rd" class="r103 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r102 r">e</span>,
                        <span class="s">&quot;CreateRemoteRunspaceForContainerFailed&quot;</span>,
                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                        <b>null</b>);
 
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r103 r">errorRecord</span>);
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ArgumentException</span> <span id="r104 rd" class="r104 r">e</span>)
                {
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r105 rd" class="r105 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r104 r">e</span>,
                        <span class="s">&quot;CreateRemoteRunspaceForContainerFailed&quot;</span>,
                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <b>null</b>);
 
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r105 r">errorRecord</span>);
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r106 rd" class="r106 r">e</span>)
                {
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r107 rd" class="r107 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r106 r">e</span>,
                        <span class="s">&quot;CreateRemoteRunspaceForContainerFailed&quot;</span>,
                        <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                        <b>null</b>);
 
                    <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r107 r">errorRecord</span>);
                    <b>continue</b>;
                }
 
                <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r108 rd" class="r108 r">pipeline</span> = <a href="#545a3845d553c263" class="i method">CreatePipeline</a>(<span class="r100 r">remoteRunspace</span>);
 
                <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r109 rd" class="r109 r">operation</span> =
                    <b>new</b> <a href="#3e49a87652361d8a" class="t constructor">ExecutionCmdletHelperComputerName</a>(<span class="r100 r">remoteRunspace</span>, <span class="r108 r">pipeline</span>, <b>false</b>);
 
                <a href="#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Add</span>(<span class="r109 r">operation</span>);
            }
 
            <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a> = <span class="r98 r">resolvedNameList</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a pipeline from the powershell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">remoteRunspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace on which to create the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A pipeline.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="545a3845d553c263" href="../../../R/545a3845d553c263.html" target="n" data-glyph="74,1" class="i method">CreatePipeline</a>(<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r110 rd" class="r110 r">remoteRunspace</span>)
        {
            <span class="c">// The fix to WinBlue#475223 changed how UsingExpression is handled on the client/server sides, if the remote end is PSv5</span>
            <span class="c">// or later, we send the dictionary-form using values to the remote end. If the remote end is PSv3 or PSv4, then we send</span>
            <span class="c">// the array-form using values if all UsingExpressions are in the same scope, otherwise, we handle the UsingExpression as</span>
            <span class="c">// if the remote end is PSv2.</span>
            <b>string</b> <span id="r111 rd" class="r111 r">serverPsVersion</span> = <a href="#cb306d445b7b2dbc" class="i method">GetRemoteServerPsVersion</a>(<span class="r110 r">remoteRunspace</span>);
            <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r112 rd" class="r112 r">powershellToUse</span> = (<span class="r111 r">serverPsVersion</span> == <a href="#2eef10f9f7a524cf" class="i field">PSv2</a>)
                                                                          ? <a href="#46e0f31c5ed48e79" class="i method">GetPowerShellForPSv2</a>()
                                                                          : <a href="#4c0ab84249893209" class="i method">GetPowerShellForPSv3OrLater</a>(<span class="r111 r">serverPsVersion</span>);
            <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r113 rd" class="r113 r">pipeline</span> =
                <span class="r110 r">remoteRunspace</span>.<span class="i">CreatePipeline</span>(<span class="r112 r">powershellToUse</span>.<a href="../../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>, <b>true</b>);
 
            <span class="r113 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#55623b34b6a2a65a" class="i property">Commands</a>.<span class="i">Clear</span>();
 
            <b>foreach</b> (<a href="../../hostifaces/Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r114 rd" class="r114 r">command</span> <b>in</b> <span class="r112 r">powershellToUse</span>.<a href="../../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>)
            {
                <span class="r113 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#55623b34b6a2a65a" class="i property">Commands</a>.<span class="i">Add</span>(<span class="r114 r">command</span>);
            }
 
            <span class="r113 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#b2ec42030f1944f4" class="i property">RedirectShellErrorOutputPipe</a> = <b>true</b>;
 
            <b>return</b> <span class="r113 r">pipeline</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check the powershell version of the remote server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="cb306d445b7b2dbc" href="../../../R/cb306d445b7b2dbc.html" target="n" data-glyph="76,1" class="i method">GetRemoteServerPsVersion</a>(<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r115 rd" class="r115 r">remoteRunspace</span>)
        {
            <b>if</b> (<span class="r115 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#912a4002c4156bbf" class="i property">ConnectionInfo</a> <b>is</b> <a href="../common/RunspaceConnectionInfo.cs.html#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a>)
            {
                <span class="c">// This is for Start-Job. The remote end is actually a child local powershell process, so it must be PSv5 or later</span>
                <b>return</b> <a href="#100ee0b891362843" class="i field">PSv5OrLater</a>;
            }
 
            <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r116 rd" class="r116 r">psApplicationPrivateData</span> = <span class="r115 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#b6a31aec547092fc" class="i method">GetApplicationPrivateData</a>();
            <b>if</b> (<span class="r116 r">psApplicationPrivateData</span> == <b>null</b>)
            {
                <span class="c">// The remote runspace is not opened yet, or it&#39;s disconnected before the private data is retrieved.</span>
                <span class="c">// In this case we cannot validate if the remote server is running PSv5 or later, so for safety purpose,</span>
                <span class="c">// we will handle the $using expressions as if the remote server is PSv2.</span>
                <b>return</b> <a href="#2eef10f9f7a524cf" class="i field">PSv2</a>;
            }
 
            <span class="c">// Unfortunately, the PSVersion value in the private data from PSv3 and PSv4 server is always 2.0.</span>
            <span class="c">// This got fixed in PSv5, so a PSv5 server will return 5.0. That means we need other way to tell</span>
            <span class="c">// if the remote server is PSv2 or PSv3+. After PSv3, remote runspace supports connect/disconnect,</span>
            <span class="c">// so we can use it to differentiate PSv2 from PSv3+.</span>
            <b>if</b> (<span class="r115 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#0dd004643a4ef610" class="i property">CanDisconnect</a>)
            {
                <span class="i">Version</span> <span id="r117 rd" class="r117 r">serverPsVersion</span> = <b>null</b>;
                <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>.<span class="i">TryPathGet</span>(
                    <span class="r116 r">psApplicationPrivateData</span>,
                    <b>out</b> <span class="r117 r">serverPsVersion</span>,
                    <a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#6f3eb6d7f2bfc1d8" class="i field">PSVersionTableName</a>,
                    <a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#6452abbf2d72fad5" class="i field">PSVersionName</a>);
 
                <b>if</b> (<span class="r117 r">serverPsVersion</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r117 r">serverPsVersion</span>.<span class="i">Major</span> &gt;= 5 ? <a href="#100ee0b891362843" class="i field">PSv5OrLater</a> : <a href="#4cba785ac4ab46ca" class="i field">PSv3Orv4</a>;
                }
 
                <span class="c">// The private data is available but we failed to get the server powershell version.</span>
                <span class="c">// This should never happen, but in case it happens, handle the $using expressions</span>
                <span class="c">// as if the remote server is PSv2.</span>
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Application private data is available but we failed to get the server powershell version. This should never happen.&quot;</span>);
            }
 
            <b>return</b> <a href="#2eef10f9f7a524cf" class="i field">PSv2</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds forwarded events to the local queue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="063a02019cd2df2e" href="../../../R/063a02019cd2df2e.html" target="n" data-glyph="74,1" class="i method">OnRunspacePSEventReceived</a>(<b>object</b> <span id="r118 rd" class="r118 r">sender</span>, <a href="../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r119 rd" class="r119 r">e</span>)
        {
            <b>if</b> (<a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#851784a989d19bb6" class="i property">Events</a> != <b>null</b>)
                <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#851784a989d19bb6" class="i property">Events</a>.<a href="../../EventManager.cs.html#43c57e3b3c02ba83" class="i method">AddForwardedEvent</a>(<span class="r119 r">e</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Members / Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <a id="d9671a73b2071d0c" href="../../../R/d9671a73b2071d0c.html" target="n" data-glyph="104,1" class="i property">Operations</a> { <b>get</b>; } = <b>new</b> <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes the input streams on all the pipelines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="3ba177350a1210b8" href="../../../R/3ba177350a1210b8.html" target="n" data-glyph="75,1" class="i method">CloseAllInputStreams</a>()
        {
            <b>foreach</b> (<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r120 rd" class="r120 r">operation</span> <b>in</b> <a href="#d9671a73b2071d0c" class="i property">Operations</a>)
            {
                <a href="#b467310465a38398" class="t t">ExecutionCmdletHelper</a> <span id="r121 rd" class="r121 r">helper</span> = (<a href="#b467310465a38398" class="t t">ExecutionCmdletHelper</a>)<span class="r120 r">operation</span>;
                <span class="r121 r">helper</span>.<a href="#d53a69547f7e5e14" class="i property">Pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#fc605284c85d0dc9" class="i property">Input</a>.<a href="../../../utils/IObjectWriter.cs.html#2c9b22a04af963c5" class="i method">Close</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes an error record specifying that creation of remote runspace</span>
        <span class="c">///</span><span class="c"> failed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">exception which is causing this error record</span>
        <span class="c">///</span><span class="c"> to be written</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">uri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Uri which caused this exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="007ad81f08167033" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">WriteErrorCreateRemoteRunspaceFailed</a>(<span class="i">Exception</span> <span id="r122 rd" class="r122 r">e</span>, <span class="i">Uri</span> <span id="r123 rd" class="r123 r">uri</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r122 r">e</span> <b>is</b> <span class="i">UriFormatException</span> || <span class="r122 r">e</span> <b>is</b> <span class="i">InvalidOperationException</span> ||
                       <span class="r122 r">e</span> <b>is</b> <span class="i">ArgumentException</span>,
                       <span class="s">&quot;Exception has to be of type UriFormatException or InvalidOperationException or ArgumentException&quot;</span>);
 
            <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r124 rd" class="r124 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r122 r">e</span>, <span class="s">&quot;CreateRemoteRunspaceFailed&quot;</span>,
                <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="r123 r">uri</span>);
 
            <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r124 r">errorRecord</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> FilePathComputername parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="8e424bd9bb5d66d0" href="../../../R/8e424bd9bb5d66d0.html" target="n" data-glyph="9,1" class="i field">FilePathComputerNameParameterSet</a> = <span class="s">&quot;FilePathComputerName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> LiteralFilePathComputername parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="be55224d0209b197" href="../../../R/be55224d0209b197.html" target="n" data-glyph="9,1" class="i field">LiteralFilePathComputerNameParameterSet</a> = <span class="s">&quot;LiteralFilePathComputerName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> FilePathRunspace parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspace&quot;</span>)]
        <b>protected const string</b> <a id="3e0d58dc67e03506" href="../../../R/3e0d58dc67e03506.html" target="n" data-glyph="9,1" class="i field">FilePathSessionParameterSet</a> = <span class="s">&quot;FilePathRunspace&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> FilePathUri parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="1a8ea2890f34e3ce" href="../../../R/1a8ea2890f34e3ce.html" target="n" data-glyph="9,1" class="i field">FilePathUriParameterSet</a> = <span class="s">&quot;FilePathUri&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PS version of the remote server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="100ee0b891362843" href="../../../R/100ee0b891362843.html" target="n" data-glyph="10,1" class="i field">PSv5OrLater</a> = <span class="s">&quot;PSv5OrLater&quot;</span>;
        <b>private const string</b> <a id="4cba785ac4ab46ca" href="../../../R/4cba785ac4ab46ca.html" target="n" data-glyph="10,1" class="i field">PSv3Orv4</a> = <span class="s">&quot;PSv3Orv4&quot;</span>;
        <b>private const string</b> <a id="2eef10f9f7a524cf" href="../../../R/2eef10f9f7a524cf.html" target="n" data-glyph="10,1" class="i field">PSv2</a> = <span class="s">&quot;PSv2&quot;</span>;
 
        <b>private</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="c02112d9221baaf3" href="../../../R/c02112d9221baaf3.html" target="n" data-glyph="46,1" class="i field">_powershellV2</a>;
        <b>private</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="350fc491bf40500f" href="../../../R/350fc491bf40500f.html" target="n" data-glyph="46,1" class="i field">_powershellV3</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads content of file and converts it to a scriptblock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r125 r">filePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">isLiteralPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="d437242e89d9d6fe" href="../../../R/d437242e89d9d6fe.html" target="n" data-glyph="75,1" class="i method">GetScriptBlockFromFile</a>(<b>string</b> <span id="r125 rd" class="r125 r">filePath</span>, <b>bool</b> <span id="r126 rd" class="r126 r">isLiteralPath</span>)
        {
            <span class="c">// Make sure filepath doesn&#39;t contain wildcards</span>
            <b>if</b> ((!<span class="r126 r">isLiteralPath</span>) &amp;&amp; <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r125 r">filePath</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">WildCardErrorFilePathParameter</span>), <b>nameof</b>(<span class="r125 r">filePath</span>));
            }
 
            <b>if</b> (!<span class="r125 r">filePath</span>.<span class="i">EndsWith</span>(<span class="s">&quot;.ps1&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">FilePathShouldPS1Extension</span>), <b>nameof</b>(<span class="r125 r">filePath</span>));
            }
 
            <span class="c">// Resolve file path</span>
            <b>string</b> <span id="r127 rd" class="r127 r">resolvedPath</span> = <a href="#47b1cb4d55714c48" class="t t">PathResolver</a>.<span class="i">ResolveProviderAndPath</span>(<span class="r125 r">filePath</span>, <span class="r126 r">isLiteralPath</span>, <a href="#68974ce2a1fdd25f" class="k">this</a>, <b>false</b>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">FilePathNotFromFileSystemProvider</span>);
 
            <span class="c">// read content of file</span>
            <a href="../../ExternalScriptInfo.cs.html#7806ac40f903221c" class="t t">ExternalScriptInfo</a> <span id="r128 rd" class="r128 r">scriptInfo</span> = <b>new</b> <a href="../../ExternalScriptInfo.cs.html#0769c91ec3133070" class="t constructor">ExternalScriptInfo</a>(<span class="r125 r">filePath</span>, <span class="r127 r">resolvedPath</span>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>);
 
            <span class="c">// Skip ShouldRun check for .psd1 files.</span>
            <span class="c">// Use ValidateScriptInfo() for explicitly validating the checkpolicy for psd1 file.</span>
            <span class="c">//</span>
            <b>if</b> (!<span class="r125 r">filePath</span>.<span class="i">EndsWith</span>(<span class="s">&quot;.psd1&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#d04f29dfc80b1390" class="i property">AuthorizationManager</a>.<a href="../../SecurityManagerBase.cs.html#c0db5055d86375e7" class="i method">ShouldRunInternal</a>(<span class="r128 r">scriptInfo</span>, <a href="../../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../../SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>);
            }
 
            <b>return</b> <span class="r128 r">scriptInfo</span>.<a href="../../ExternalScriptInfo.cs.html#7795a39b7e78fc61" class="i property">ScriptBlock</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Protected Members / Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates the helper classes for the specified</span>
        <span class="c">///</span><span class="c"> parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="962a1a4dbb0408bf" href="../../../R/962a1a4dbb0408bf.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> ((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>) ||
                (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>) ||
                (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>) ||
                (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>) ||
                (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>) ||
                (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>))
            {
                <a href="#980eaa0e0166af27" class="i property">SkipWinRMCheck</a> = <b>true</b>;
            }
 
            <a href="#3b23821ea164740f" class="k">base</a>.<a href="#2b247ef886dca829" class="i method">BeginProcessing</a>();
 
            <b>if</b> (<a href="#29be2fee46862a9d" class="i field">_filePath</a> != <b>null</b>)
            {
                <a href="#8356ac2000259292" class="i field">_scriptBlock</a> = <a href="#d437242e89d9d6fe" class="i method">GetScriptBlockFromFile</a>(<a href="#29be2fee46862a9d" class="i field">_filePath</a>, <a href="#10589b0c528680d3" class="i property">IsLiteralPath</a>);
            }
 
            <b>switch</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>)
            {
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#be55224d0209b197" class="i field">LiteralFilePathComputerNameParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>:
                    {
                        <b>string</b>[] <span id="r129 rd" class="r129 r">resolvedComputerNames</span> = <b>null</b>;
                        <a href="#cf8d963b1364b5ca" class="i method">ResolveComputerNames</a>(<a href="#9b9cf8f6c6346191" class="i property">ComputerName</a>, <b>out</b> <span class="r129 r">resolvedComputerNames</span>);
                        <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a> = <span class="r129 r">resolvedComputerNames</span>;
 
                        <a href="#99dba4ab181c22e3" class="i method">CreateHelpersForSpecifiedComputerNames</a>();
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>:
                    {
                        <b>string</b>[] <span id="r130 rd" class="r130 r">resolvedComputerNames</span> = <b>null</b>;
                        <a href="#cf8d963b1364b5ca" class="i method">ResolveComputerNames</a>(<a href="#6cee174e0c9a888f" class="i property">HostName</a>, <b>out</b> <span class="r130 r">resolvedComputerNames</span>);
                        <a href="#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a> = <span class="r130 r">resolvedComputerNames</span>;
 
                        <a href="#643a109c6ad8d678" class="i method">CreateHelpersForSpecifiedSSHComputerNames</a>();
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#2ccab294cfc81d07" class="i field">FilePathSSHHostHashParameterSet</a>:
                    {
                        <a href="#ae84d0d2a8d72a93" class="i method">CreateHelpersForSpecifiedSSHHashComputerNames</a>();
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>:
                    {
                        <a href="#a495755f39f42d2e" class="i method">ValidateRemoteRunspacesSpecified</a>();
 
                        <a href="#27f380230a8cc4b0" class="i method">CreateHelpersForSpecifiedRunspaces</a>();
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#00bdee282001266a" class="i field">UriParameterSet</a>:
                    {
                        <a href="#f5e046e362b33381" class="i method">CreateHelpersForSpecifiedUris</a>();
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>:
                    {
                        <a href="#6ce233a651721da6" class="i method">CreateHelpersForSpecifiedVMSession</a>();
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>:
                <b>case</b> <a href="#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>.<a href="#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>:
                    {
                        <a href="#0494fd711b6e150e" class="i method">CreateHelpersForSpecifiedContainerSession</a>();
                    }
 
                    <b>break</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;Get PowerShell instance&quot;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the PowerShell instance for the PSv2 remote end</span>
        <span class="c">///</span><span class="c"> Generate the PowerShell instance by using the text of the scriptblock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSv2 doesn&#39;t understand the &#39;$using&#39; prefix. To make UsingExpression work on PSv2 remote end, we will have to</span>
        <span class="c">///</span><span class="c"> alter the script, and send the altered script to the remote end. Since the script is altered, when there is an</span>
        <span class="c">///</span><span class="c"> error, the error message will show the altered script, and that could be confusing to the user. So if the remote</span>
        <span class="c">///</span><span class="c"> server is PSv3 or later version, we will use a different approach to handle UsingExpression so that we can keep</span>
        <span class="c">///</span><span class="c"> the script unchanged.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> However, on PSv3 and PSv4 remote server, it&#39;s not well supported if UsingExpressions are used in different scopes (fixed in PSv5).</span>
        <span class="c">///</span><span class="c"> If the remote end is PSv3 or PSv4, and there are UsingExpressions in different scopes, then we have to revert back to the approach</span>
        <span class="c">///</span><span class="c"> used for PSv2 remote server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="46e0f31c5ed48e79" href="../../../R/46e0f31c5ed48e79.html" target="n" data-glyph="76,1" class="i method">GetPowerShellForPSv2</a>()
        {
            <b>if</b> (<a href="#c02112d9221baaf3" class="i field">_powershellV2</a> != <b>null</b>) { <b>return</b> <a href="#c02112d9221baaf3" class="i field">_powershellV2</a>; }
 
            <span class="c">// Try to convert the scriptblock to powershell commands.</span>
            <a href="#c02112d9221baaf3" class="i field">_powershellV2</a> = <a href="#a105db302fa1fadc" class="i method">ConvertToPowerShell</a>();
            <b>if</b> (<a href="#c02112d9221baaf3" class="i field">_powershellV2</a> != <b>null</b>)
            {
                <span class="c">// Look for EndOfStatement tokens.</span>
                <b>foreach</b> (<b>var</b> <span id="r131 rd" class="r131 r">command</span> <b>in</b> <a href="#c02112d9221baaf3" class="i field">_powershellV2</a>.<a href="../../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>)
                {
                    <b>if</b> (<span class="r131 r">command</span>.<span class="i">IsEndOfStatement</span>)
                    {
                        <span class="c">// PSv2 cannot process this.  Revert to sending script.</span>
                        <a href="#c02112d9221baaf3" class="i field">_powershellV2</a> = <b>null</b>;
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<a href="#c02112d9221baaf3" class="i field">_powershellV2</a> != <b>null</b>) { <b>return</b> <a href="#c02112d9221baaf3" class="i field">_powershellV2</a>; }
            }
 
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r132 rd" class="r132 r">newParameterNames</span>;
            <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r133 rd" class="r133 r">newParameterValues</span>;
 
            <b>string</b> <span id="r134 rd" class="r134 r">scriptTextAdaptedForPSv2</span> = <a href="#f22e770293510236" class="i method">GetConvertedScript</a>(<b>out</b> <span class="r132 r">newParameterNames</span>, <b>out</b> <span class="r133 r">newParameterValues</span>);
            <a href="#c02112d9221baaf3" class="i field">_powershellV2</a> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>().<a href="../../hostifaces/PowerShell.cs.html#c97f8d15a2f93e31" class="i method">AddScript</a>(<span class="r134 r">scriptTextAdaptedForPSv2</span>);
 
            <b>if</b> (<a href="#e2065136db3bbc85" class="i field">_args</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>object</b> <span id="r135 rd" class="r135 r">arg</span> <b>in</b> <a href="#e2065136db3bbc85" class="i field">_args</a>)
                {
                    <a href="#c02112d9221baaf3" class="i field">_powershellV2</a>.<a href="../../hostifaces/PowerShell.cs.html#b2931353596991a4" class="i method">AddArgument</a>(<span class="r135 r">arg</span>);
                }
            }
 
            <b>if</b> (<span class="r132 r">newParameterNames</span> != <b>null</b>)
            {
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r133 r">newParameterValues</span> != <b>null</b> &amp;&amp; <span class="r132 r">newParameterNames</span>.<span class="i">Count</span> == <span class="r133 r">newParameterValues</span>.<span class="i">Count</span>, <span class="s">&quot;We should get the value for each using variable&quot;</span>);
                <b>for</b> (<b>int</b> <span id="r136 rd" class="r136 r">i</span> = 0; <span class="r136 r">i</span> &lt; <span class="r132 r">newParameterNames</span>.<span class="i">Count</span>; <span class="r136 r">i</span>++)
                {
                    <a href="#c02112d9221baaf3" class="i field">_powershellV2</a>.<span class="i">AddParameter</span>(<span class="r132 r">newParameterNames</span>[<span class="r136 r">i</span>], <span class="r133 r">newParameterValues</span>[<span class="r136 r">i</span>]);
                }
            }
 
            <b>return</b> <a href="#c02112d9221baaf3" class="i field">_powershellV2</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the PowerShell instance for the PSv3 (or later) remote end</span>
        <span class="c">///</span><span class="c"> Generate the PowerShell instance by using the text of the scriptblock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In PSv3 and PSv4, if the remote server is PSv3 or later, we generate an object array that contains the value of each using expression in</span>
        <span class="c">///</span><span class="c"> the parsing order, and then pass the array to the remote end as a special argument. On the remote end, the using expressions will be indexed</span>
        <span class="c">///</span><span class="c"> in the same parsing order during the variable analysis process, and the index is used to get the value of the corresponding using expression</span>
        <span class="c">///</span><span class="c"> from the special array. There is a limitation in that approach -- $using cannot be used in different scopes with Invoke-Command/Start-Job</span>
        <span class="c">///</span><span class="c"> (see WinBlue#475223), because the variable analysis process can only index using expressions within the same scope (this is by design), and a</span>
        <span class="c">///</span><span class="c"> using expression from a different scope may be assigned with an index that conflicts with other using expressions.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> To fix the limitation described above, we changed to pass a dictionary with key/value pairs for the using expressions on the client side. The key</span>
        <span class="c">///</span><span class="c"> is an unique base64 encoded string generated based on the text of the using expression. On the remote end, it can always get the unique key of a</span>
        <span class="c">///</span><span class="c"> using expression because the text passed to the server side is the same, and thus the value of the using expression can be retrieved from the special</span>
        <span class="c">///</span><span class="c"> dictionary. With this approach, $using in different scopes can be supported for Invoke-Command/Start-Job.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This fix involved changes on the server side, so the fix will work only if the remote end is PSv5 or later. In order to avoid possible breaking</span>
        <span class="c">///</span><span class="c"> change in &#39;PSv5 client - PSv3 server&#39; and &#39;PSv5 client - PSv4 server&#39; scenarios, we should keep sending the array-form using values if the remote</span>
        <span class="c">///</span><span class="c"> end is PSv3 or PSv4 as long as no UsingExpression is in a different scope. If the remote end is PSv3 or PSv4 and we do have UsingExpressions</span>
        <span class="c">///</span><span class="c"> in different scopes, then we will revert back to the approach we use to handle UsingExpression for PSv2 remote server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="4c0ab84249893209" href="../../../R/4c0ab84249893209.html" target="n" data-glyph="76,1" class="i method">GetPowerShellForPSv3OrLater</a>(<b>string</b> <span id="r137 rd" class="r137 r">serverPsVersion</span>)
        {
            <b>if</b> (<a href="#350fc491bf40500f" class="i field">_powershellV3</a> != <b>null</b>) { <b>return</b> <a href="#350fc491bf40500f" class="i field">_powershellV3</a>; }
 
            <span class="c">// Try to convert the scriptblock to powershell commands.</span>
            <a href="#350fc491bf40500f" class="i field">_powershellV3</a> = <a href="#a105db302fa1fadc" class="i method">ConvertToPowerShell</a>();
 
            <b>if</b> (<a href="#350fc491bf40500f" class="i field">_powershellV3</a> != <b>null</b>) { <b>return</b> <a href="#350fc491bf40500f" class="i field">_powershellV3</a>; }
 
            <span class="c">// Using expressions can be a variable, as well as property and / or array references. E.g.</span>
            <span class="c">//</span>
            <span class="c">// icm { echo $using:a }</span>
            <span class="c">// icm { echo $using:a[3] }</span>
            <span class="c">// icm { echo $using:a.Length }</span>
            <span class="c">//</span>
            <span class="c">// Semantic checks on the using statement have already validated that there are no arbitrary expressions,</span>
            <span class="c">// so we&#39;ll allow these expressions in everything but NoLanguage mode.</span>
 
            <b>bool</b> <span id="r138 rd" class="r138 r">allowUsingExpressions</span> = (<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#f2800307140e1fec" class="i property">LanguageMode</a> != <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>);
            <b>object</b>[] <span id="r139 rd" class="r139 r">usingValuesInArray</span> = <b>null</b>;
            <span class="i">IDictionary</span> <span id="r140 rd" class="r140 r">usingValuesInDict</span> = <b>null</b>;
 
            <span class="c">// Value of &#39;serverPsVersion&#39; should be either &#39;PSv3Orv4&#39; or &#39;PSv5OrLater&#39;</span>
            <b>if</b> (<span class="r137 r">serverPsVersion</span> == <a href="#4cba785ac4ab46ca" class="i field">PSv3Orv4</a>)
            {
                <span class="r139 r">usingValuesInArray</span> = <a href="../../runtime/ScriptBlockToPowerShell.cs.html#a1edebc1e23d4bb8" class="t t">ScriptBlockToPowerShellConverter</a>.<a href="../../runtime/ScriptBlockToPowerShell.cs.html#5d4297a00367b048" class="i method">GetUsingValuesAsArray</a>(<a href="#8356ac2000259292" class="i field">_scriptBlock</a>, <span class="r138 r">allowUsingExpressions</span>, <a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>, <b>null</b>);
                <b>if</b> (<span class="r139 r">usingValuesInArray</span> == <b>null</b>)
                {
                    <span class="c">// &#39;usingValuesInArray&#39; will be null only if there are UsingExpressions used in different scopes.</span>
                    <span class="c">// PSv3 and PSv4 remote server cannot handle this, so we revert back to the approach we use for PSv2 remote end.</span>
                    <b>return</b> <a href="#46e0f31c5ed48e79" class="i method">GetPowerShellForPSv2</a>();
                }
            }
            <b>else</b>
            {
                <span class="c">// Remote server is PSv5 or later version</span>
                <span class="r140 r">usingValuesInDict</span> = <a href="../../runtime/ScriptBlockToPowerShell.cs.html#a1edebc1e23d4bb8" class="t t">ScriptBlockToPowerShellConverter</a>.<a href="../../runtime/ScriptBlockToPowerShell.cs.html#212ec55be82fe05b" class="i method">GetUsingValuesAsDictionary</a>(<a href="#8356ac2000259292" class="i field">_scriptBlock</a>, <span class="r138 r">allowUsingExpressions</span>, <a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>, <b>null</b>);
            }
 
            <b>string</b> <span id="r141 rd" class="r141 r">textOfScriptBlock</span> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#9a1646f37a942067" class="i property">ExpectingInput</a>
                ? <a href="#8356ac2000259292" class="i field">_scriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#4a1a7db17b43318d" class="i method">GetWithInputHandlingForInvokeCommand</a>()
                : <a href="#8356ac2000259292" class="i field">_scriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>();
 
            <a href="#350fc491bf40500f" class="i field">_powershellV3</a> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>().<a href="../../hostifaces/PowerShell.cs.html#c97f8d15a2f93e31" class="i method">AddScript</a>(<span class="r141 r">textOfScriptBlock</span>);
 
            <b>if</b> (<a href="#e2065136db3bbc85" class="i field">_args</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>object</b> <span id="r142 rd" class="r142 r">arg</span> <b>in</b> <a href="#e2065136db3bbc85" class="i field">_args</a>)
                {
                    <a href="#350fc491bf40500f" class="i field">_powershellV3</a>.<a href="../../hostifaces/PowerShell.cs.html#b2931353596991a4" class="i method">AddArgument</a>(<span class="r142 r">arg</span>);
                }
            }
 
            <b>if</b> (<span class="r140 r">usingValuesInDict</span> != <b>null</b> &amp;&amp; <span class="r140 r">usingValuesInDict</span>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#350fc491bf40500f" class="i field">_powershellV3</a>.<span class="i">AddParameter</span>(<a href="../../parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="../../parser/Parser.cs.html#d9090e2972c2cdfd" class="i field">VERBATIM_ARGUMENT</a>, <span class="r140 r">usingValuesInDict</span>);
            }
            <b>else</b> <b>if</b> (<span class="r139 r">usingValuesInArray</span> != <b>null</b> &amp;&amp; <span class="r139 r">usingValuesInArray</span>.<span class="i">Length</span> &gt; 0)
            {
                <a href="#350fc491bf40500f" class="i field">_powershellV3</a>.<a href="../../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<a href="../../parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="../../parser/Parser.cs.html#d9090e2972c2cdfd" class="i field">VERBATIM_ARGUMENT</a>, <span class="r139 r">usingValuesInArray</span>);
            }
 
            <b>return</b> <a href="#350fc491bf40500f" class="i field">_powershellV3</a>;
        }
 
        <b>private</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="a105db302fa1fadc" href="../../../R/a105db302fa1fadc.html" target="n" data-glyph="76,1" class="i method">ConvertToPowerShell</a>()
        {
            <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r143 rd" class="r143 r">powershell</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="c">// This is trusted input as long as we&#39;re in FullLanguage mode</span>
                <b>bool</b> <span id="r144 rd" class="r144 r">isTrustedInput</span> = (<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../../SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>);
                <span class="r143 r">powershell</span> = <a href="#8356ac2000259292" class="i field">_scriptBlock</a>.<a href="../../lang/scriptblock.cs.html#6f0e368497931950" class="i method">GetPowerShell</a>(<span class="r144 r">isTrustedInput</span>, <a href="#e2065136db3bbc85" class="i field">_args</a>);
            }
            <b>catch</b> (<a href="../../lang/scriptblock.cs.html#e3ec0b5ce28753ed" class="t t">ScriptBlockToPowerShellNotSupportedException</a>)
            {
                <span class="c">// conversion failed, we need to send the script to the remote end.</span>
                <span class="c">// since the PowerShell instance would be different according to the PSVersion of the remote end,</span>
                <span class="c">// we generate it when we know which version we are talking to.</span>
            }
 
            <b>return</b> <span class="r143 r">powershell</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;Get PowerShell instance&quot;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;UsingExpression Utilities&quot;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the converted script for a remote PSv2 end.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">newParameterNames</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new parameter names that we added to the param block</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">newParameterValues</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new parameter values that need to be added to the powershell instance</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="f22e770293510236" href="../../../R/f22e770293510236.html" target="n" data-glyph="76,1" class="i method">GetConvertedScript</a>(<b>out</b> <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r145 rd" class="r145 r">newParameterNames</span>, <b>out</b> <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r146 rd" class="r146 r">newParameterValues</span>)
        {
            <span class="r145 r">newParameterNames</span> = <b>null</b>; <span class="r146 r">newParameterValues</span> = <b>null</b>;
            <b>string</b> <span id="r147 rd" class="r147 r">textOfScriptBlock</span> = <b>null</b>;
 
            <span class="c">// Scan for the using variables</span>
            <span class="i">List</span>&lt;<a href="../../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt; <span id="r148 rd" class="r148 r">usingVariables</span> = <a href="#5407c59933e6df2d" class="i method">GetUsingVariables</a>(<a href="#8356ac2000259292" class="i field">_scriptBlock</a>);
 
            <b>if</b> (<span class="r148 r">usingVariables</span> == <b>null</b> || <span class="r148 r">usingVariables</span>.<span class="i">Count</span> == 0)
            {
                <span class="c">// No using variable is used, then we don&#39;t change the script</span>
                <span class="r147 r">textOfScriptBlock</span> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#9a1646f37a942067" class="i property">ExpectingInput</a>
                    ? <a href="#8356ac2000259292" class="i field">_scriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#4a1a7db17b43318d" class="i method">GetWithInputHandlingForInvokeCommand</a>()
                    : <a href="#8356ac2000259292" class="i field">_scriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>();
            }
            <b>else</b>
            {
                <span class="r145 r">newParameterNames</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>var</b> <span id="r149 rd" class="r149 r">paramNamesWithDollarSign</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <b>var</b> <span id="r150 rd" class="r150 r">paramUsingVars</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt;();
                <b>var</b> <span id="r151 rd" class="r151 r">nameHashSet</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                <b>foreach</b> (<b>var</b> <span id="r152 rd" class="r152 r">varAst</span> <b>in</b> <span class="r148 r">usingVariables</span>)
                {
                    <b>string</b> <span id="r153 rd" class="r153 r">varName</span> = <span class="r152 r">varAst</span>.<span class="i">VariablePath</span>.<span class="i">UserPath</span>;
                    <b>string</b> <span id="r154 rd" class="r154 r">paramName</span> = <a href="../../parser/ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a>.<a href="../../parser/ast.cs.html#3331acd12e22a1c8" class="i field">UsingPrefix</a> + <span class="r153 r">varName</span>;
                    <b>string</b> <span id="r155 rd" class="r155 r">paramNameWithDollar</span> = <span class="s">&quot;$&quot;</span> + <span class="r154 r">paramName</span>;
 
                    <b>if</b> (!<span class="r151 r">nameHashSet</span>.<span class="i">Contains</span>(<span class="r155 r">paramNameWithDollar</span>))
                    {
                        <span class="r145 r">newParameterNames</span>.<span class="i">Add</span>(<span class="r154 r">paramName</span>);
                        <span class="r149 r">paramNamesWithDollarSign</span>.<span class="i">Add</span>(<span class="r155 r">paramNameWithDollar</span>);
                        <span class="r150 r">paramUsingVars</span>.<span class="i">Add</span>(<span class="r152 r">varAst</span>);
                        <span class="r151 r">nameHashSet</span>.<span class="i">Add</span>(<span class="r155 r">paramNameWithDollar</span>);
                    }
                }
 
                <span class="c">// Retrieve the value for each using variable</span>
                <span class="r146 r">newParameterValues</span> = <a href="#d095efa8c81a314b" class="i method">GetUsingVariableValues</a>(<span class="r150 r">paramUsingVars</span>);
 
                <span class="c">// Generate the wrapped script</span>
                <b>string</b> <span id="r156 rd" class="r156 r">additionalNewParams</span> = <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;, &quot;</span>, <span class="r149 r">paramNamesWithDollarSign</span>);
                <span class="r147 r">textOfScriptBlock</span> = <a href="#68974ce2a1fdd25f" class="k">this</a>.<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#9a1646f37a942067" class="i property">ExpectingInput</a>
                    ? <a href="#8356ac2000259292" class="i field">_scriptBlock</a>.<span class="i">GetWithInputHandlingForInvokeCommandWithUsingExpression</span>(<span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r148 r">usingVariables</span>, <span class="r156 r">additionalNewParams</span>))
                    : <a href="#8356ac2000259292" class="i field">_scriptBlock</a>.<span class="i">ToStringWithDollarUsingHandling</span>(<span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r148 r">usingVariables</span>, <span class="r156 r">additionalNewParams</span>));
            }
 
            <b>return</b> <span class="r147 r">textOfScriptBlock</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the values for the using variables that are passed in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r157 r">paramUsingVars</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<b>object</b>&gt; <a id="d095efa8c81a314b" href="../../../R/d095efa8c81a314b.html" target="n" data-glyph="76,1" class="i method">GetUsingVariableValues</a>(<span class="i">List</span>&lt;<a href="../../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt; <span id="r157 rd" class="r157 r">paramUsingVars</span>)
        {
            <b>var</b> <span id="r158 rd" class="r158 r">values</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;(<span class="r157 r">paramUsingVars</span>.<span class="i">Count</span>);
            <a href="../../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r159 rd" class="r159 r">currentVarAst</span> = <b>null</b>;
            <span class="i">Version</span> <span id="r160 rd" class="r160 r">oldStrictVersion</span> = <a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../../SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>.<a href="../../SessionStateScope.cs.html#1a4f72ac80cc8c14" class="i property">StrictModeVersion</a>;
 
            <b>try</b>
            {
                <a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../../SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>.<a href="../../SessionStateScope.cs.html#1a4f72ac80cc8c14" class="i property">StrictModeVersion</a> = <a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#ad63365ac7690eeb" class="i property">PSVersion</a>;
 
                <span class="c">// GetExpressionValue ensures that it only does variable access when supplied a VariableExpressionAst.</span>
                <span class="c">// So, this is still safe to use in ConstrainedLanguage and will not result in arbitrary code</span>
                <span class="c">// execution.</span>
                <b>bool</b> <span id="r161 rd" class="r161 r">allowVariableAccess</span> = (<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#f2800307140e1fec" class="i property">LanguageMode</a> != <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>);
 
                <b>foreach</b> (<b>var</b> <span id="r162 rd" class="r162 r">varAst</span> <b>in</b> <span class="r157 r">paramUsingVars</span>)
                {
                    <span class="r159 r">currentVarAst</span> = <span class="r162 r">varAst</span>;
                    <b>object</b> <span id="r163 rd" class="r163 r">value</span> = <a href="../../parser/Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">GetExpressionValue</span>(<span class="r162 r">varAst</span>, <span class="r161 r">allowVariableAccess</span>, <a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>);
                    <span class="r158 r">values</span>.<span class="i">Add</span>(<span class="r163 r">value</span>);
                }
            }
            <b>catch</b> (<a href="../../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r164 rd" class="r164 r">rte</span>)
            {
                <b>if</b> (<span class="r164 r">rte</span>.<a href="../../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>.<span class="i">Equals</span>(<span class="s">&quot;VariableIsUndefined&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <b>throw</b> <a href="../../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(<b>null</b>, <b>typeof</b>(<a href="../../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r159 r">currentVarAst</span>.<a href="../../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="s">&quot;UsingVariableIsUndefined&quot;</span>, <span class="i">AutomationExceptions</span>.<span class="i">UsingVariableIsUndefined</span>, <span class="r164 r">rte</span>.<a href="../../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>.<a href="../../ErrorPackage.cs.html#61f8d29a1022ac67" class="i property">TargetObject</a>);
                }
            }
            <b>finally</b>
            {
                <a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../../SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>.<a href="../../SessionStateScope.cs.html#1a4f72ac80cc8c14" class="i property">StrictModeVersion</a> = <span class="r160 r">oldStrictVersion</span>;
            }
 
            <b>return</b> <span class="r158 r">values</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get all Using expressions that we care about.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r165 r">localScriptBlock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A list of UsingExpressionAsts ordered by the StartOffset.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">List</span>&lt;<a href="../../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>&gt; <a id="5407c59933e6df2d" href="../../../R/5407c59933e6df2d.html" target="n" data-glyph="76,1" class="i method">GetUsingVariables</a>(<a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r165 rd" class="r165 r">localScriptBlock</span>)
        {
            <b>if</b> (<span class="r165 r">localScriptBlock</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r165 r">localScriptBlock</span>), <span class="s">&quot;Caller needs to make sure the parameter value is not null&quot;</span>);
            }
 
            <b>var</b> <span id="r166 rd" class="r166 r">allUsingExprs</span> = <a href="../../runtime/ScriptBlockToPowerShell.cs.html#030d145e263b5f7c" class="t t">UsingExpressionAstSearcher</a>.<a href="../../runtime/ScriptBlockToPowerShell.cs.html#14c7aa004455341e" class="i method">FindAllUsingExpressions</a>(<span class="r165 r">localScriptBlock</span>.<a href="../../runtime/CompiledScriptBlock.cs.html#e028cdfe16daf552" class="i property">Ast</a>);
            <b>return</b> <span class="r166 r">allUsingExprs</span>.<span class="i">Select</span>(<b>static</b> <span id="r167 rd" class="r167 r">usingExpr</span> =&gt; <a href="../../parser/ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a>.<a href="../../parser/ast.cs.html#5f7670b30a24be4f" class="i method">ExtractUsingVariable</a>((<a href="../../parser/ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a>)<span class="r167 r">usingExpr</span>)).<span class="i">ToList</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;UsingExpression Utilities&quot;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for any cmdlet which operates on a runspace. The</span>
    <span class="c">///</span><span class="c"> following cmdlets currently fall under this category:</span>
    <span class="c">///</span><span class="c">     1. Get-PSSession</span>
    <span class="c">///</span><span class="c">     2. Remove-PSSession</span>
    <span class="c">///</span><span class="c">     3. Disconnect-PSSession</span>
    <span class="c">///</span><span class="c">     4. Connect-PSSession.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="9f3c8073162f1fd6" href="../../../R/9f3c8073162f1fd6.html" target="n" data-glyph="0,0" class="t t"><span id="d3c3bd14040c122e">PSRunspaceCmdlet</span></a> : <a href="#c2668678751e1b82" class="t t">PSRemotingCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ContainerIdInstanceId parameter set: container id + session instance id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="f0f4aba139526945" href="../../../R/f0f4aba139526945.html" target="n" data-glyph="9,1" class="i field">ContainerIdInstanceIdParameterSet</a> = <span class="s">&quot;ContainerIdInstanceId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> VMIdInstanceId parameter set: vm id + session instance id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="56d5932836a7f40e" href="../../../R/56d5932836a7f40e.html" target="n" data-glyph="9,1" class="i field">VMIdInstanceIdParameterSet</a> = <span class="s">&quot;VMIdInstanceId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> VMNameInstanceId parameter set: vm name + session instance id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="934205616de58072" href="../../../R/934205616de58072.html" target="n" data-glyph="9,1" class="i field">VMNameInstanceIdParameterSet</a> = <span class="s">&quot;VMNameInstanceId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RemoteRunspaceId to retrieve corresponding PSSession</span>
        <span class="c">///</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#bfd5cf9ba9156dcf" class="i field">InstanceIdParameterSet</a>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public virtual</b> <span class="i">Guid</span>[] <a id="a12ac27990ea4f30" href="../../../R/a12ac27990ea4f30.html" target="n" data-glyph="102,1" class="i property">InstanceId</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#6a04cfd142428ee6" class="i field">_remoteRunspaceIds</a>;
            }
 
            <b>set</b>
            {
                <a href="#6a04cfd142428ee6" class="i field">_remoteRunspaceIds</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Guid</span>[] <a id="6a04cfd142428ee6" href="../../../R/6a04cfd142428ee6.html" target="n" data-glyph="46,1" class="i field">_remoteRunspaceIds</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session Id of the remoterunspace info object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#2b4dfd6d547b0ef7" class="i field">IdParameterSet</a>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public int</b>[] <a id="9328913a1b284a76" href="../../../R/9328913a1b284a76.html" target="n" data-glyph="102,1" class="i property">Id</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the remote runspaceinfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#5ab4d540bcda3887" class="i field">NameParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public virtual string</b>[] <a id="246349607820455f" href="../../../R/246349607820455f.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#cfbb2f0dd414f1b7" class="i field">_names</a>;
            }
 
            <b>set</b>
            {
                <a href="#cfbb2f0dd414f1b7" class="i field">_names</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="cfbb2f0dd414f1b7" href="../../../R/cfbb2f0dd414f1b7.html" target="n" data-glyph="46,1" class="i field">_names</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the computer for which the runspace needs to be</span>
        <span class="c">///</span><span class="c"> returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;Cn&quot;</span>)]
        <b>public virtual string</b>[] <a id="0aba3ebb6c534b35" href="../../../R/0aba3ebb6c534b35.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#74b1114201f00401" class="i field">_computerNames</a>;
            }
 
            <b>set</b>
            {
                <a href="#74b1114201f00401" class="i field">_computerNames</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="74b1114201f00401" href="../../../R/74b1114201f00401.html" target="n" data-glyph="46,1" class="i field">_computerNames</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ID of target container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#f0f4aba139526945" class="i field">ContainerIdInstanceIdParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public virtual string</b>[] <a id="b88f21570d1bec67" href="../../../R/b88f21570d1bec67.html" target="n" data-glyph="102,1" class="i property">ContainerId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Guid of target virtual machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#56d5932836a7f40e" class="i field">VMIdInstanceIdParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;VMGuid&quot;</span>)]
        <b>public virtual</b> <span class="i">Guid</span>[] <a id="26adffb75662c4c0" href="../../../R/26adffb75662c4c0.html" target="n" data-glyph="102,1" class="i property">VMId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of target virtual machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>,
            <span class="i">Justification</span> = <span class="s">&quot;This is by spec.&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#934205616de58072" class="i field">VMNameInstanceIdParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public virtual string</b>[] <a id="e8be6d0c4c14f37f" href="../../../R/e8be6d0c4c14f37f.html" target="n" data-glyph="102,1" class="i property">VMName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private / Protected Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces based on the parameterset.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r168 r">writeErrorOnNoMatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">write an error record when</span>
        <span class="c">///</span><span class="c"> no matches are found</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if true write the object down</span>
        <span class="c">///</span><span class="c"> the pipeline</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>protected</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="38d17b882da28e38" href="../../../R/38d17b882da28e38.html" target="n" data-glyph="75,1" class="i method">GetMatchingRunspaces</a>(<b>bool</b> <span id="r169 rd" class="r169 r">writeobject</span>,
            <b>bool</b> <span id="r168 rd" class="r168 r">writeErrorOnNoMatch</span>)
        {
            <b>return</b> <a href="#18b6ffca15a17d21" class="i method">GetMatchingRunspaces</a>(<span class="r169 r">writeobject</span>, <span class="r168 r">writeErrorOnNoMatch</span>, <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="#3e09a716ae427cdf" class="i field">All</a>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces based on the parameterset.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r">writeErrorOnNoMatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">write an error record when</span>
        <span class="c">///</span><span class="c"> no matches are found</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if true write the object down</span>
        <span class="c">///</span><span class="c"> the pipeline</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r172 r">filterState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace state filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r173 r">configurationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace configuration name filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        <b>protected</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="18b6ffca15a17d21" href="../../../R/18b6ffca15a17d21.html" target="n" data-glyph="75,1" class="i method">GetMatchingRunspaces</a>(<b>bool</b> <span id="r171 rd" class="r171 r">writeobject</span>,
            <b>bool</b> <span id="r170 rd" class="r170 r">writeErrorOnNoMatch</span>,
            <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a> <span id="r172 rd" class="r172 r">filterState</span>,
            <b>string</b> <span id="r173 rd" class="r173 r">configurationName</span>)
        {
            <b>switch</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>)
            {
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>:
                    {
                        <b>return</b> <a href="#6969e9f491f94f05" class="i method">GetMatchingRunspacesByComputerName</a>(<span class="r171 r">writeobject</span>, <span class="r170 r">writeErrorOnNoMatch</span>);
                    }
 
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#bfd5cf9ba9156dcf" class="i field">InstanceIdParameterSet</a>:
                    {
                        <b>return</b> <a href="#a40d645bf31024ef" class="i method">GetMatchingRunspacesByRunspaceId</a>(<span class="r171 r">writeobject</span>, <span class="r170 r">writeErrorOnNoMatch</span>);
                    }
 
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#5ab4d540bcda3887" class="i field">NameParameterSet</a>:
                    {
                        <b>return</b> <a href="#62ccf8b82f283414" class="i method">GetMatchingRunspacesByName</a>(<span class="r171 r">writeobject</span>, <span class="r170 r">writeErrorOnNoMatch</span>);
                    }
 
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#2b4dfd6d547b0ef7" class="i field">IdParameterSet</a>:
                    {
                        <b>return</b> <a href="#4ea1224013cf5562" class="i method">GetMatchingRunspacesBySessionId</a>(<span class="r171 r">writeobject</span>, <span class="r170 r">writeErrorOnNoMatch</span>);
                    }
 
                <span class="c">//</span>
                <span class="c">// writeErrorOnNoMatch should always be false for container/vm id/name inputs</span>
                <span class="c">// in Get-PSSession/Remove-PSSession cmdlets</span>
                <span class="c">//</span>
 
                <span class="c">// container id + optional session name</span>
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#572318a2191690f0" class="i field">ContainerIdParameterSet</a>:
                    {
                        <b>return</b> <a href="#1b352f9a9cb4559c" class="i method">GetMatchingRunspacesByVMNameContainerId</a>(<span class="r171 r">writeobject</span>, <span class="r172 r">filterState</span>, <span class="r173 r">configurationName</span>, <b>true</b>);
                    }
 
                <span class="c">// container id + session instanceid</span>
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#f0f4aba139526945" class="i field">ContainerIdInstanceIdParameterSet</a>:
                    {
                        <b>return</b> <a href="#3c8bc1d84f109031" class="i method">GetMatchingRunspacesByVMNameContainerIdSessionInstanceId</a>(<span class="r171 r">writeobject</span>, <span class="r172 r">filterState</span>, <span class="r173 r">configurationName</span>, <b>true</b>);
                    }
 
                <span class="c">// vm Guid + optional session name</span>
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>:
                    {
                        <b>return</b> <a href="#0cf1cfb652b46523" class="i method">GetMatchingRunspacesByVMId</a>(<span class="r171 r">writeobject</span>, <span class="r172 r">filterState</span>, <span class="r173 r">configurationName</span>);
                    }
 
                <span class="c">// vm Guid + session instanceid</span>
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#56d5932836a7f40e" class="i field">VMIdInstanceIdParameterSet</a>:
                    {
                        <b>return</b> <a href="#68043a1780388448" class="i method">GetMatchingRunspacesByVMIdSessionInstanceId</a>(<span class="r171 r">writeobject</span>, <span class="r172 r">filterState</span>, <span class="r173 r">configurationName</span>);
                    }
 
                <span class="c">// vm name + optional session name</span>
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#b2efa99b627d2719" class="i field">VMNameParameterSet</a>:
                    {
                        <b>return</b> <a href="#1b352f9a9cb4559c" class="i method">GetMatchingRunspacesByVMNameContainerId</a>(<span class="r171 r">writeobject</span>, <span class="r172 r">filterState</span>, <span class="r173 r">configurationName</span>, <b>false</b>);
                    }
 
                <span class="c">// vm name + session instanceid</span>
                <b>case</b> <a href="#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>.<a href="#934205616de58072" class="i field">VMNameInstanceIdParameterSet</a>:
                    {
                        <b>return</b> <a href="#3c8bc1d84f109031" class="i method">GetMatchingRunspacesByVMNameContainerIdSessionInstanceId</a>(<span class="r171 r">writeobject</span>, <span class="r172 r">filterState</span>, <span class="r173 r">configurationName</span>, <b>false</b>);
                    }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="8f360329d55f6119" href="../../../R/8f360329d55f6119.html" target="n" data-glyph="74,1" class="i method">GetAllRunspaces</a>(<b>bool</b> <span id="r174 rd" class="r174 r">writeobject</span>,
            <b>bool</b> <span id="r175 rd" class="r175 r">writeErrorOnNoMatch</span>)
        {
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r176 rd" class="r176 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r177 rd" class="r177 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
            <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r178 rd" class="r178 r">remoteRunspaceInfo</span> <b>in</b> <span class="r177 r">remoteRunspaceInfos</span>)
            {
                <span class="c">// return all remote runspace info objects</span>
                <b>if</b> (<span class="r174 r">writeobject</span>)
                {
                    <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r178 r">remoteRunspaceInfo</span>);
                }
                <b>else</b>
                {
                    <span class="r176 r">matches</span>.<span class="i">Add</span>(<span class="r178 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r178 r">remoteRunspaceInfo</span>);
                }
            }
 
            <b>return</b> <span class="r176 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces by computernames.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r179 r">writeErrorOnNoMatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">write an error record when</span>
        <span class="c">///</span><span class="c"> no matches are found</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r180 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if true write the object down</span>
        <span class="c">///</span><span class="c"> the pipeline</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="6969e9f491f94f05" href="../../../R/6969e9f491f94f05.html" target="n" data-glyph="76,1" class="i method">GetMatchingRunspacesByComputerName</a>(<b>bool</b> <span id="r180 rd" class="r180 r">writeobject</span>,
            <b>bool</b> <span id="r179 rd" class="r179 r">writeErrorOnNoMatch</span>)
        {
            <b>if</b> (<a href="#74b1114201f00401" class="i field">_computerNames</a> == <b>null</b> || <a href="#74b1114201f00401" class="i field">_computerNames</a>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <a href="#8f360329d55f6119" class="i method">GetAllRunspaces</a>(<span class="r180 r">writeobject</span>, <span class="r179 r">writeErrorOnNoMatch</span>);
            }
 
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r181 rd" class="r181 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r182 rd" class="r182 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <span class="c">// Loop through all computer-name patterns and runspaces to find matches.</span>
            <b>foreach</b> (<b>string</b> <span id="r183 rd" class="r183 r">computerName</span> <b>in</b> <a href="#74b1114201f00401" class="i field">_computerNames</a>)
            {
                <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r184 rd" class="r184 r">computerNamePattern</span> = <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r183 r">computerName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                <span class="c">// Match the computer-name patterns against all the runspaces and remember the matches.</span>
                <b>bool</b> <span id="r185 rd" class="r185 r">found</span> = <b>false</b>;
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r186 rd" class="r186 r">remoteRunspaceInfo</span> <b>in</b> <span class="r182 r">remoteRunspaceInfos</span>)
                {
                    <b>if</b> (<span class="r184 r">computerNamePattern</span>.<a href="../../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r186 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>))
                    {
                        <span class="r185 r">found</span> = <b>true</b>;
 
                        <b>if</b> (<span class="r180 r">writeobject</span>)
                        {
                            <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r186 r">remoteRunspaceInfo</span>);
                        }
                        <b>else</b>
                        {
                            <b>try</b>
                            {
                                <span class="r181 r">matches</span>.<span class="i">Add</span>(<span class="r186 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r186 r">remoteRunspaceInfo</span>);
                            }
                            <b>catch</b> (<span class="i">ArgumentException</span>)
                            {
                                <span class="c">// if match already found ignore</span>
                            }
                        }
                    }
                }
 
                <span class="c">// If no match found write an error record.</span>
                <b>if</b> (!<span class="r185 r">found</span> &amp;&amp; <span class="r179 r">writeErrorOnNoMatch</span>)
                {
                    <span class="i">WriteInvalidArgumentError</span>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#4455b175558f0628" class="i field">RemoteRunspaceNotAvailableForSpecifiedComputer</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteRunspaceNotAvailableForSpecifiedComputer</span>,
                        <span class="r183 r">computerName</span>);
                }
            }
 
            <b>return</b> <span class="r181 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces based on name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r187 r">writeErrorOnNoMatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">write an error record when</span>
        <span class="c">///</span><span class="c"> no matches are found</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if true write the object down</span>
        <span class="c">///</span><span class="c"> the pipeline</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;writeobject&quot;</span>)]
        <b>protected</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="62ccf8b82f283414" href="../../../R/62ccf8b82f283414.html" target="n" data-glyph="75,1" class="i method">GetMatchingRunspacesByName</a>(<b>bool</b> <span id="r188 rd" class="r188 r">writeobject</span>,
            <b>bool</b> <span id="r187 rd" class="r187 r">writeErrorOnNoMatch</span>)
        {
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r189 rd" class="r189 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r190 rd" class="r190 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <span class="c">// Loop through all computer-name patterns and runspaces to find matches.</span>
            <b>foreach</b> (<b>string</b> <span id="r191 rd" class="r191 r">name</span> <b>in</b> <a href="#cfbb2f0dd414f1b7" class="i field">_names</a>)
            {
                <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r192 rd" class="r192 r">namePattern</span> = <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r191 r">name</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                <span class="c">// Match the computer-name patterns against all the runspaces and remember the matches.</span>
                <b>bool</b> <span id="r193 rd" class="r193 r">found</span> = <b>false</b>;
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r194 rd" class="r194 r">remoteRunspaceInfo</span> <b>in</b> <span class="r190 r">remoteRunspaceInfos</span>)
                {
                    <b>if</b> (<span class="r192 r">namePattern</span>.<a href="../../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r194 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>))
                    {
                        <span class="r193 r">found</span> = <b>true</b>;
 
                        <b>if</b> (<span class="r188 r">writeobject</span>)
                        {
                            <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r194 r">remoteRunspaceInfo</span>);
                        }
                        <b>else</b>
                        {
                            <b>try</b>
                            {
                                <span class="r189 r">matches</span>.<span class="i">Add</span>(<span class="r194 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r194 r">remoteRunspaceInfo</span>);
                            }
                            <b>catch</b> (<span class="i">ArgumentException</span>)
                            {
                                <span class="c">// if match already found ignore</span>
                            }
                        }
                    }
                }
 
                <span class="c">// If no match found write an error record.</span>
                <b>if</b> (!<span class="r193 r">found</span> &amp;&amp; <span class="r187 r">writeErrorOnNoMatch</span> &amp;&amp; !<a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r191 r">name</span>))
                {
                    <span class="i">WriteInvalidArgumentError</span>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#7770de82cbddcafd" class="i field">RemoteRunspaceNotAvailableForSpecifiedName</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteRunspaceNotAvailableForSpecifiedName</span>,
                        <span class="r191 r">name</span>);
                }
            }
 
            <b>return</b> <span class="r189 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces based on the runspaces instance id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">writeErrorOnNoMatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">write an error record when</span>
        <span class="c">///</span><span class="c"> no matches are found</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if true write the object down</span>
        <span class="c">///</span><span class="c"> the pipeline</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Runspaces&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;writeobject&quot;</span>)]
        <b>protected</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="a40d645bf31024ef" href="../../../R/a40d645bf31024ef.html" target="n" data-glyph="75,1" class="i method">GetMatchingRunspacesByRunspaceId</a>(<b>bool</b> <span id="r196 rd" class="r196 r">writeobject</span>,
            <b>bool</b> <span id="r195 rd" class="r195 r">writeErrorOnNoMatch</span>)
        {
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r197 rd" class="r197 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r198 rd" class="r198 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <span class="c">// Loop through all computer-name patterns and runspaces to find matches.</span>
            <b>foreach</b> (<span class="i">Guid</span> <span id="r199 rd" class="r199 r">remoteRunspaceId</span> <b>in</b> <a href="#6a04cfd142428ee6" class="i field">_remoteRunspaceIds</a>)
            {
                <span class="c">// Match the computer-name patterns against all the runspaces and remember the matches.</span>
                <b>bool</b> <span id="r200 rd" class="r200 r">found</span> = <b>false</b>;
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r201 rd" class="r201 r">remoteRunspaceInfo</span> <b>in</b> <span class="r198 r">remoteRunspaceInfos</span>)
                {
                    <b>if</b> (<span class="r199 r">remoteRunspaceId</span>.<span class="i">Equals</span>(<span class="r201 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>))
                    {
                        <span class="r200 r">found</span> = <b>true</b>;
 
                        <b>if</b> (<span class="r196 r">writeobject</span>)
                        {
                            <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r201 r">remoteRunspaceInfo</span>);
                        }
                        <b>else</b>
                        {
                            <b>try</b>
                            {
                                <span class="r197 r">matches</span>.<span class="i">Add</span>(<span class="r201 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r201 r">remoteRunspaceInfo</span>);
                            }
                            <b>catch</b> (<span class="i">ArgumentException</span>)
                            {
                                <span class="c">// if match already found ignore</span>
                            }
                        }
                    }
                }
 
                <span class="c">// If no match found write an error record.</span>
                <b>if</b> (!<span class="r200 r">found</span> &amp;&amp; <span class="r195 r">writeErrorOnNoMatch</span>)
                {
                    <span class="i">WriteInvalidArgumentError</span>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#b3c189f77d861124" class="i field">RemoteRunspaceNotAvailableForSpecifiedRunspaceId</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteRunspaceNotAvailableForSpecifiedRunspaceId</span>,
                        <span class="r199 r">remoteRunspaceId</span>);
                }
            }
 
            <b>return</b> <span class="r197 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces based on the session id (the</span>
        <span class="c">///</span><span class="c"> short integer id which is unique for a runspace)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r202 r">writeErrorOnNoMatch</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">write an error record when</span>
        <span class="c">///</span><span class="c"> no matches are found</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r203 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if true write the object down</span>
        <span class="c">///</span><span class="c"> the pipeline</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="4ea1224013cf5562" href="../../../R/4ea1224013cf5562.html" target="n" data-glyph="76,1" class="i method">GetMatchingRunspacesBySessionId</a>(<b>bool</b> <span id="r203 rd" class="r203 r">writeobject</span>,
            <b>bool</b> <span id="r202 rd" class="r202 r">writeErrorOnNoMatch</span>)
        {
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r204 rd" class="r204 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r205 rd" class="r205 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <span class="c">// Loop through all computer-name patterns and runspaces to find matches.</span>
            <b>foreach</b> (<b>int</b> <span id="r206 rd" class="r206 r">sessionId</span> <b>in</b> <a href="#9328913a1b284a76" class="i property">Id</a>)
            {
                <span class="c">// Match the computer-name patterns against all the runspaces and remember the matches.</span>
                <b>bool</b> <span id="r207 rd" class="r207 r">found</span> = <b>false</b>;
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r208 rd" class="r208 r">remoteRunspaceInfo</span> <b>in</b> <span class="r205 r">remoteRunspaceInfos</span>)
                {
                    <b>if</b> (<span class="r206 r">sessionId</span> == <span class="r208 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#cb363e99eb80f398" class="i property">Id</a>)
                    {
                        <span class="r207 r">found</span> = <b>true</b>;
 
                        <b>if</b> (<span class="r203 r">writeobject</span>)
                        {
                            <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r208 r">remoteRunspaceInfo</span>);
                        }
                        <b>else</b>
                        {
                            <b>try</b>
                            {
                                <span class="r204 r">matches</span>.<span class="i">Add</span>(<span class="r208 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r208 r">remoteRunspaceInfo</span>);
                            }
                            <b>catch</b> (<span class="i">ArgumentException</span>)
                            {
                                <span class="c">// if match already found ignore</span>
                            }
                        }
                    }
                }
 
                <span class="c">// If no match found write an error record.</span>
                <b>if</b> (!<span class="r207 r">found</span> &amp;&amp; <span class="r202 r">writeErrorOnNoMatch</span>)
                {
                    <span class="i">WriteInvalidArgumentError</span>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a>.<a href="../common/remotingexceptions.cs.html#a7348c014a062c1e" class="i field">RemoteRunspaceNotAvailableForSpecifiedSessionId</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">RemoteRunspaceNotAvailableForSpecifiedSessionId</span>,
                        <span class="r206 r">sessionId</span>);
                }
            }
 
            <b>return</b> <span class="r204 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces by vm name or container id with optional session name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true write the object down the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r210 r">filterState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace state filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r211 r">configurationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace configuration name filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">isContainer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true the target is a container instead of virtual machine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="1b352f9a9cb4559c" href="../../../R/1b352f9a9cb4559c.html" target="n" data-glyph="76,1" class="i method">GetMatchingRunspacesByVMNameContainerId</a>(<b>bool</b> <span id="r209 rd" class="r209 r">writeobject</span>,
            <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a> <span id="r210 rd" class="r210 r">filterState</span>,
            <b>string</b> <span id="r211 rd" class="r211 r">configurationName</span>,
            <b>bool</b> <span id="r212 rd" class="r212 r">isContainer</span>)
        {
            <b>string</b>[] <span id="r213 rd" class="r213 r">inputNames</span>;
            <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a> <span id="r214 rd" class="r214 r">computerType</span>;
            <b>bool</b> <span id="r215 rd" class="r215 r">supportWildChar</span>;
            <b>string</b>[] <span id="r216 rd" class="r216 r">sessionNames</span> = { <span class="s">&quot;*&quot;</span> };
            <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r217 rd" class="r217 r">configurationNamePattern</span> =
                <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r211 r">configurationName</span>) ? <b>null</b> : <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r211 r">configurationName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r218 rd" class="r218 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r219 rd" class="r219 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <span class="c">// vm name support wild characters, while container id does not.</span>
            <span class="c">// vm id does not apply in this method, which does not support wild characters either.</span>
            <b>if</b> (<span class="r212 r">isContainer</span>)
            {
                <span class="r213 r">inputNames</span> = <a href="#b88f21570d1bec67" class="i property">ContainerId</a>;
                <span class="r214 r">computerType</span> = <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a>.<a href="../client/remoterunspaceinfo.cs.html#ccf0bd9669b42737" class="i field">Container</a>;
                <span class="r215 r">supportWildChar</span> = <b>false</b>;
            }
            <b>else</b>
            {
                <span class="r213 r">inputNames</span> = <a href="#e8be6d0c4c14f37f" class="i property">VMName</a>;
                <span class="r214 r">computerType</span> = <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a>.<a href="../client/remoterunspaceinfo.cs.html#a9f5d1fc506038b7" class="i field">VirtualMachine</a>;
                <span class="r215 r">supportWildChar</span> = <b>true</b>;
            }
 
            <span class="c">// When &quot;-name&quot; is not set, we use &quot;*&quot; that means matching all.</span>
            <b>if</b> (<a href="#246349607820455f" class="i property">Name</a> != <b>null</b>)
            {
                <span class="r216 r">sessionNames</span> = <a href="#246349607820455f" class="i property">Name</a>;
            }
 
            <b>foreach</b> (<b>string</b> <span id="r220 rd" class="r220 r">inputName</span> <b>in</b> <span class="r213 r">inputNames</span>)
            {
                <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r221 rd" class="r221 r">inputNamePattern</span> = <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r220 r">inputName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                <b>foreach</b> (<b>string</b> <span id="r222 rd" class="r222 r">sessionName</span> <b>in</b> <span class="r216 r">sessionNames</span>)
                {
                    <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r223 rd" class="r223 r">sessionNamePattern</span> =
                        <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r222 r">sessionName</span>) ? <b>null</b> : <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r222 r">sessionName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                    <b>var</b> <span id="r224 rd" class="r224 r">matchingRunspaceInfos</span> = <span class="r219 r">remoteRunspaceInfos</span>
                        .<span class="i">Where</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;(<span id="r225 rd" class="r225 r">session</span> =&gt; (<span class="r215 r">supportWildChar</span> ? <span class="r221 r">inputNamePattern</span>.<span class="i">IsMatch</span>(<span class="r225 r">session</span>.<span class="i">VMName</span>)
                                                                      : <span class="r220 r">inputName</span>.<span class="i">Equals</span>(<span class="r225 r">session</span>.<span class="i">ContainerId</span>)) &amp;&amp;
                                                     (<span class="r223 r">sessionNamePattern</span> == <b>null</b> || <span class="r223 r">sessionNamePattern</span>.<span class="i">IsMatch</span>(<span class="r225 r">session</span>.<span class="i">Name</span>)) &amp;&amp;
                                                     <a href="#2069a7a39daa030c" class="t t">QueryRunspaces</a>.<span class="i">TestRunspaceState</span>(<span class="r225 r">session</span>.<span class="i">Runspace</span>, <span class="r210 r">filterState</span>) &amp;&amp;
                                                     (<span class="r217 r">configurationNamePattern</span> == <b>null</b> || <span class="r217 r">configurationNamePattern</span>.<span class="i">IsMatch</span>(<span class="r225 r">session</span>.<span class="i">ConfigurationName</span>)) &amp;&amp;
                                                     (<span class="r225 r">session</span>.<span class="i">ComputerType</span> == <span class="r214 r">computerType</span>))
                        .<span class="i">ToList</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
                    <span class="i">WriteOrAddMatches</span>(<span class="r224 r">matchingRunspaceInfos</span>, <span class="r209 r">writeobject</span>, <b>ref</b> <span class="r218 r">matches</span>);
                }
            }
 
            <b>return</b> <span class="r218 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces by vm name or container id with session instanceid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true write the object down the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">filterState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace state filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">configurationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace configuration name filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">isContainer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true the target is a container instead of virtual machine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="3c8bc1d84f109031" href="../../../R/3c8bc1d84f109031.html" target="n" data-glyph="76,1" class="i method">GetMatchingRunspacesByVMNameContainerIdSessionInstanceId</a>(<b>bool</b> <span id="r226 rd" class="r226 r">writeobject</span>,
            <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a> <span id="r227 rd" class="r227 r">filterState</span>,
            <b>string</b> <span id="r228 rd" class="r228 r">configurationName</span>,
            <b>bool</b> <span id="r229 rd" class="r229 r">isContainer</span>)
        {
            <b>string</b>[] <span id="r230 rd" class="r230 r">inputNames</span>;
            <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a> <span id="r231 rd" class="r231 r">computerType</span>;
            <b>bool</b> <span id="r232 rd" class="r232 r">supportWildChar</span>;
            <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r233 rd" class="r233 r">configurationNamePattern</span> =
                <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r228 r">configurationName</span>) ? <b>null</b> : <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r228 r">configurationName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r234 rd" class="r234 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r235 rd" class="r235 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <span class="c">// vm name support wild characters, while container id does not.</span>
            <span class="c">// vm id does not apply in this method, which does not support wild characters either.</span>
            <b>if</b> (<span class="r229 r">isContainer</span>)
            {
                <span class="r230 r">inputNames</span> = <a href="#b88f21570d1bec67" class="i property">ContainerId</a>;
                <span class="r231 r">computerType</span> = <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a>.<a href="../client/remoterunspaceinfo.cs.html#ccf0bd9669b42737" class="i field">Container</a>;
                <span class="r232 r">supportWildChar</span> = <b>false</b>;
            }
            <b>else</b>
            {
                <span class="r230 r">inputNames</span> = <a href="#e8be6d0c4c14f37f" class="i property">VMName</a>;
                <span class="r231 r">computerType</span> = <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a>.<a href="../client/remoterunspaceinfo.cs.html#a9f5d1fc506038b7" class="i field">VirtualMachine</a>;
                <span class="r232 r">supportWildChar</span> = <b>true</b>;
            }
 
            <b>foreach</b> (<b>string</b> <span id="r236 rd" class="r236 r">inputName</span> <b>in</b> <span class="r230 r">inputNames</span>)
            {
                <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r237 rd" class="r237 r">inputNamePattern</span> = <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r236 r">inputName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                <b>foreach</b> (<span class="i">Guid</span> <span id="r238 rd" class="r238 r">sessionInstanceId</span> <b>in</b> <a href="#a12ac27990ea4f30" class="i property">InstanceId</a>)
                {
                    <b>var</b> <span id="r239 rd" class="r239 r">matchingRunspaceInfos</span> = <span class="r235 r">remoteRunspaceInfos</span>
                        .<span class="i">Where</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;(<span id="r240 rd" class="r240 r">session</span> =&gt; (<span class="r232 r">supportWildChar</span> ? <span class="r237 r">inputNamePattern</span>.<span class="i">IsMatch</span>(<span class="r240 r">session</span>.<span class="i">VMName</span>)
                                                                      : <span class="r236 r">inputName</span>.<span class="i">Equals</span>(<span class="r240 r">session</span>.<span class="i">ContainerId</span>)) &amp;&amp;
                                                     <span class="r238 r">sessionInstanceId</span>.<span class="i">Equals</span>(<span class="r240 r">session</span>.<span class="i">InstanceId</span>) &amp;&amp;
                                                     <a href="#2069a7a39daa030c" class="t t">QueryRunspaces</a>.<span class="i">TestRunspaceState</span>(<span class="r240 r">session</span>.<span class="i">Runspace</span>, <span class="r227 r">filterState</span>) &amp;&amp;
                                                     (<span class="r233 r">configurationNamePattern</span> == <b>null</b> || <span class="r233 r">configurationNamePattern</span>.<span class="i">IsMatch</span>(<span class="r240 r">session</span>.<span class="i">ConfigurationName</span>)) &amp;&amp;
                                                     (<span class="r240 r">session</span>.<span class="i">ComputerType</span> == <span class="r231 r">computerType</span>))
                        .<span class="i">ToList</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
                    <span class="i">WriteOrAddMatches</span>(<span class="r239 r">matchingRunspaceInfos</span>, <span class="r226 r">writeobject</span>, <b>ref</b> <span class="r234 r">matches</span>);
                }
            }
 
            <b>return</b> <span class="r234 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces by vm guid and optional session name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r241 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true write the object down the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r242 r">filterState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace state filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r243 r">configurationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace configuration name filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="0cf1cfb652b46523" href="../../../R/0cf1cfb652b46523.html" target="n" data-glyph="76,1" class="i method">GetMatchingRunspacesByVMId</a>(<b>bool</b> <span id="r241 rd" class="r241 r">writeobject</span>,
            <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a> <span id="r242 rd" class="r242 r">filterState</span>,
            <b>string</b> <span id="r243 rd" class="r243 r">configurationName</span>)
        {
            <b>string</b>[] <span id="r244 rd" class="r244 r">sessionNames</span> = { <span class="s">&quot;*&quot;</span> };
            <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r245 rd" class="r245 r">configurationNamePattern</span> =
                <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r243 r">configurationName</span>) ? <b>null</b> : <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r243 r">configurationName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r246 rd" class="r246 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r247 rd" class="r247 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <span class="c">// When &quot;-name&quot; is not set, we use &quot;*&quot; that means matching all .</span>
            <b>if</b> (<a href="#246349607820455f" class="i property">Name</a> != <b>null</b>)
            {
                <span class="r244 r">sessionNames</span> = <a href="#246349607820455f" class="i property">Name</a>;
            }
 
            <b>foreach</b> (<span class="i">Guid</span> <span id="r248 rd" class="r248 r">vmId</span> <b>in</b> <a href="#26adffb75662c4c0" class="i property">VMId</a>)
            {
                <b>foreach</b> (<b>string</b> <span id="r249 rd" class="r249 r">sessionName</span> <b>in</b> <span class="r244 r">sessionNames</span>)
                {
                    <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r250 rd" class="r250 r">sessionNamePattern</span> =
                        <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r249 r">sessionName</span>) ? <b>null</b> : <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r249 r">sessionName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                    <b>var</b> <span id="r251 rd" class="r251 r">matchingRunspaceInfos</span> = <span class="r247 r">remoteRunspaceInfos</span>
                        .<span class="i">Where</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;(<span id="r252 rd" class="r252 r">session</span> =&gt; <span class="r248 r">vmId</span>.<span class="i">Equals</span>(<span class="r252 r">session</span>.<span class="i">VMId</span>) &amp;&amp;
                                                     (<span class="r250 r">sessionNamePattern</span> == <b>null</b> || <span class="r250 r">sessionNamePattern</span>.<span class="i">IsMatch</span>(<span class="r252 r">session</span>.<span class="i">Name</span>)) &amp;&amp;
                                                     <a href="#2069a7a39daa030c" class="t t">QueryRunspaces</a>.<span class="i">TestRunspaceState</span>(<span class="r252 r">session</span>.<span class="i">Runspace</span>, <span class="r242 r">filterState</span>) &amp;&amp;
                                                     (<span class="r245 r">configurationNamePattern</span> == <b>null</b> || <span class="r245 r">configurationNamePattern</span>.<span class="i">IsMatch</span>(<span class="r252 r">session</span>.<span class="i">ConfigurationName</span>)) &amp;&amp;
                                                     (<span class="r252 r">session</span>.<span class="i">ComputerType</span> == <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a>.<a href="../client/remoterunspaceinfo.cs.html#a9f5d1fc506038b7" class="i field">VirtualMachine</a>))
                        .<span class="i">ToList</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
                    <span class="i">WriteOrAddMatches</span>(<span class="r251 r">matchingRunspaceInfos</span>, <span class="r241 r">writeobject</span>, <b>ref</b> <span class="r246 r">matches</span>);
                }
            }
 
            <b>return</b> <span class="r246 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching runspaces by vm guid and session instanceid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r253 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true write the object down the pipeline.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r254 r">filterState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace state filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r255 r">configurationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace configuration name filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of matching runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="68043a1780388448" href="../../../R/68043a1780388448.html" target="n" data-glyph="76,1" class="i method">GetMatchingRunspacesByVMIdSessionInstanceId</a>(<b>bool</b> <span id="r253 rd" class="r253 r">writeobject</span>,
            <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a> <span id="r254 rd" class="r254 r">filterState</span>,
            <b>string</b> <span id="r255 rd" class="r255 r">configurationName</span>)
        {
            <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r256 rd" class="r256 r">configurationNamePattern</span> =
                <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r255 r">configurationName</span>) ? <b>null</b> : <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r255 r">configurationName</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r257 rd" class="r257 r">matches</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r258 rd" class="r258 r">remoteRunspaceInfos</span> = <a href="#9f3c8073162f1fd6" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#63a7ff9561dc2e86" class="i property">Runspaces</a>;
 
            <b>foreach</b> (<span class="i">Guid</span> <span id="r259 rd" class="r259 r">vmId</span> <b>in</b> <a href="#26adffb75662c4c0" class="i property">VMId</a>)
            {
                <b>foreach</b> (<span class="i">Guid</span> <span id="r260 rd" class="r260 r">sessionInstanceId</span> <b>in</b> <a href="#a12ac27990ea4f30" class="i property">InstanceId</a>)
                {
                    <b>var</b> <span id="r261 rd" class="r261 r">matchingRunspaceInfos</span> = <span class="r258 r">remoteRunspaceInfos</span>
                        .<span class="i">Where</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;(<span id="r262 rd" class="r262 r">session</span> =&gt; <span class="r259 r">vmId</span>.<span class="i">Equals</span>(<span class="r262 r">session</span>.<span class="i">VMId</span>) &amp;&amp;
                                                     <span class="r260 r">sessionInstanceId</span>.<span class="i">Equals</span>(<span class="r262 r">session</span>.<span class="i">InstanceId</span>) &amp;&amp;
                                                     <a href="#2069a7a39daa030c" class="t t">QueryRunspaces</a>.<span class="i">TestRunspaceState</span>(<span class="r262 r">session</span>.<span class="i">Runspace</span>, <span class="r254 r">filterState</span>) &amp;&amp;
                                                     (<span class="r256 r">configurationNamePattern</span> == <b>null</b> || <span class="r256 r">configurationNamePattern</span>.<span class="i">IsMatch</span>(<span class="r262 r">session</span>.<span class="i">ConfigurationName</span>)) &amp;&amp;
                                                     (<span class="r262 r">session</span>.<span class="i">ComputerType</span> == <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a>.<a href="../client/remoterunspaceinfo.cs.html#a9f5d1fc506038b7" class="i field">VirtualMachine</a>))
                        .<span class="i">ToList</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
                    <span class="i">WriteOrAddMatches</span>(<span class="r261 r">matchingRunspaceInfos</span>, <span class="r253 r">writeobject</span>, <b>ref</b> <span class="r257 r">matches</span>);
                }
            }
 
            <b>return</b> <span class="r257 r">matches</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write the matching runspace objects down the pipeline, or add to the list.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r263 r">matchingRunspaceInfos</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The matching runspaces.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r264 r">writeobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true write the object down the pipeline. Otherwise, add to the list.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r265 r">matches</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The list we add the matching runspaces to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="0ba960719aa47502" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">WriteOrAddMatches</a>(<span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r263 rd" class="r263 r">matchingRunspaceInfos</span>,
            <b>bool</b> <span id="r264 rd" class="r264 r">writeobject</span>,
            <b>ref</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r265 rd" class="r265 r">matches</span>)
        {
            <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r266 rd" class="r266 r">remoteRunspaceInfo</span> <b>in</b> <span class="r263 r">matchingRunspaceInfos</span>)
            {
                <b>if</b> (<span class="r264 r">writeobject</span>)
                {
                    <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r266 r">remoteRunspaceInfo</span>);
                }
                <b>else</b>
                {
                    <b>try</b>
                    {
                        <span class="r265 r">matches</span>.<span class="i">Add</span>(<span class="r266 r">remoteRunspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r266 r">remoteRunspaceInfo</span>);
                    }
                    <b>catch</b> (<span class="i">ArgumentException</span>)
                    {
                        <span class="c">// if match already found ignore</span>
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write invalid argument error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f7b74a0cfac0281b" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">WriteInvalidArgumentError</a>(<a href="../common/remotingexceptions.cs.html#a969589d7508bf05" class="t t">PSRemotingErrorId</a> <span id="r267 rd" class="r267 r">errorId</span>, <b>string</b> <span id="r268 rd" class="r268 r">resourceString</span>, <b>object</b> <span id="r269 rd" class="r269 r">errorArgument</span>)
        {
            <b>string</b> <span id="r270 rd" class="r270 r">message</span> = <a href="#ae4e30474662ef10" class="i method">GetMessage</a>(<span class="r268 r">resourceString</span>, <span class="r269 r">errorArgument</span>);
 
            <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <span class="i">ArgumentException</span>(<span class="r270 r">message</span>), <span class="r267 r">errorId</span>.<span class="i">ToString</span>(),
                <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="r269 r">errorArgument</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private / Protected Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace Id parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="bfd5cf9ba9156dcf" href="../../../R/bfd5cf9ba9156dcf.html" target="n" data-glyph="9,1" class="i field">InstanceIdParameterSet</a> = <span class="s">&quot;InstanceId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session id parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="2b4dfd6d547b0ef7" href="../../../R/2b4dfd6d547b0ef7.html" target="n" data-glyph="9,1" class="i field">IdParameterSet</a> = <span class="s">&quot;Id&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const string</b> <a id="5ab4d540bcda3887" href="../../../R/5ab4d540bcda3887.html" target="n" data-glyph="9,1" class="i field">NameParameterSet</a> = <span class="s">&quot;Name&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Protected Members
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Helper Classes
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for both the helpers. This is an abstract class</span>
    <span class="c">///</span><span class="c"> and the helpers need to derive from this.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="b467310465a38398" href="../../../R/b467310465a38398.html" target="n" data-glyph="2,0" class="t t"><span id="14aeb4c9366cc9e2">ExecutionCmdletHelper</span></a> : <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pipeline associated with this operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="d53a69547f7e5e14" href="../../../R/d53a69547f7e5e14.html" target="n" data-glyph="104,1" class="i property">Pipeline</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#858f6547d7a6190c" class="i field">pipeline</a>;
            }
        }
 
        <b>protected</b> <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <a id="858f6547d7a6190c" href="../../../R/858f6547d7a6190c.html" target="n" data-glyph="45,1" class="i field">pipeline</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Exception raised internally when any method of this class</span>
        <span class="c">///</span><span class="c"> is executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Exception</span> <a id="898693983c97b181" href="../../../R/898693983c97b181.html" target="n" data-glyph="104,1" class="i property">InternalException</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#abff7fa2939aa32a" class="i field">internalException</a>;
            }
        }
 
        <b>protected</b> <span class="i">Exception</span> <a id="abff7fa2939aa32a" href="../../../R/abff7fa2939aa32a.html" target="n" data-glyph="45,1" class="i field">internalException</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal access to Runspace and Computer helper runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="07b1b44d725ec8ba" href="../../../R/07b1b44d725ec8ba.html" target="n" data-glyph="104,1" class="i property">PipelineRunspace</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debug
 
        <b>internal void</b> <a id="42bb18dba6713cfa" href="../../../R/42bb18dba6713cfa.html" target="n" data-glyph="74,1" class="i method">ConfigureRunspaceDebugging</a>(<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r271 rd" class="r271 r">runspace</span>)
        {
            <b>if</b> (!<a href="../common/throttlemanager.cs.html#df9433bee909401f" class="i property">RunspaceDebuggingEnabled</a> || (<span class="r271 r">runspace</span> == <b>null</b>) || (<span class="r271 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> == <b>null</b>)) { <b>return</b>; }
 
            <span class="r271 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="../../debugger/debugger.cs.html#4cf8436684b1ce9c" class="i">DebuggerStop</a> += <span class="i">HandleDebuggerStop</span>;
 
            <span class="c">// Configure runspace debugger to preserve unhandled stops (wait for debugger attach)</span>
            <span class="r271 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="../../debugger/debugger.cs.html#dbd829c531cef2cb" class="i property">UnhandledBreakpointMode</a> = <a href="../../debugger/debugger.cs.html#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="../../debugger/debugger.cs.html#acf1bcf988b9a342" class="i field">Wait</a>;
 
            <b>if</b> (<a href="../common/throttlemanager.cs.html#f1d539c43b7c28a2" class="i property">RunspaceDebugStepInEnabled</a>)
            {
                <span class="c">// Configure runspace debugger to run script in step mode</span>
                <b>try</b>
                {
                    <span class="r271 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="../../debugger/debugger.cs.html#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<b>true</b>);
                }
                <b>catch</b> (<a href="../../../utils/MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a>) { }
            }
        }
 
        <b>internal void</b> <a id="403afaa06ee6320c" href="../../../R/403afaa06ee6320c.html" target="n" data-glyph="74,1" class="i method">CleanupRunspaceDebugging</a>(<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r272 rd" class="r272 r">runspace</span>)
        {
            <b>if</b> ((<span class="r272 r">runspace</span> == <b>null</b>) || (<span class="r272 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> == <b>null</b>)) { <b>return</b>; }
 
            <span class="r272 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="../../debugger/debugger.cs.html#4cf8436684b1ce9c" class="i">DebuggerStop</a> -= <span class="i">HandleDebuggerStop</span>;
        }
 
        <b>private void</b> <a id="01bee660b6074548" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleDebuggerStop</a>(<b>object</b> <span id="r273 rd" class="r273 r">sender</span>, <a href="../../debugger/debugger.cs.html#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r274 rd" class="r274 r">args</span>)
        {
            <a href="#07b1b44d725ec8ba" class="i property">PipelineRunspace</a>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="../../debugger/debugger.cs.html#4cf8436684b1ce9c" class="i">DebuggerStop</a> -= <span class="i">HandleDebuggerStop</span>;
 
            <span class="c">// Forward event</span>
            <a href="../common/throttlemanager.cs.html#014cb7d8604d4b95" class="i method">RaiseRunspaceDebugStopEvent</a>(<a href="#07b1b44d725ec8ba" class="i property">PipelineRunspace</a>);
 
            <span class="c">// Signal remote session to remain stopped in debuger</span>
            <span class="r274 r">args</span>.<a href="../../debugger/debugger.cs.html#9ff6d82303db72dc" class="i property">SuspendRemote</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Contains a pipeline and calls InvokeAsync on the pipeline</span>
    <span class="c">///</span><span class="c"> on StartOperation. On StopOperation it calls StopAsync.</span>
    <span class="c">///</span><span class="c"> The handler sends a StopComplete message in OperationComplete</span>
    <span class="c">///</span><span class="c"> for both the functions. This is because, there is only a</span>
    <span class="c">///</span><span class="c"> single state of the pipeline which raises an event on</span>
    <span class="c">///</span><span class="c"> a method call. There are no separate events raised as</span>
    <span class="c">///</span><span class="c"> part of method calls.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="921dba60b3314c0b" href="../../../R/921dba60b3314c0b.html" target="n" data-glyph="2,0" class="t t">ExecutionCmdletHelperRunspace</a> : <a href="#b467310465a38398" class="t t">ExecutionCmdletHelper</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether or not the server should be using the steppable pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="a357d96b1a949490" href="../../../R/a357d96b1a949490.html" target="n" data-glyph="44,1" class="i field">ShouldUseSteppablePipelineOnServer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r275 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pipeline object associated with this operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="1e390b4c4aa82741" href="../../../R/1e390b4c4aa82741.html" target="n" data-glyph="74,1" class="t constructor">ExecutionCmdletHelperRunspace</a>(<a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r275 rd" class="r275 r">pipeline</span>)
        {
            <a href="#921dba60b3314c0b" class="k">this</a>.<a href="#858f6547d7a6190c" class="i field">pipeline</a> = <span class="r275 r">pipeline</span>;
            <a href="#07b1b44d725ec8ba" class="i property">PipelineRunspace</a> = <span class="r275 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#cefa43f64a3ac790" class="i property">Runspace</a>;
            <a href="#921dba60b3314c0b" class="k">this</a>.<a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#c0baffefeaa75abd" class="i">StateChanged</a> += <span class="i">HandlePipelineStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invokes the pipeline asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="3d07534205ad897e" href="../../../R/3d07534205ad897e.html" target="n" data-glyph="74,1" class="i method">StartOperation</a>()
        {
            <a href="#42bb18dba6713cfa" class="i method">ConfigureRunspaceDebugging</a>(<a href="#07b1b44d725ec8ba" class="i property">PipelineRunspace</a>);
 
            <b>try</b>
            {
                <b>if</b> (<a href="#a357d96b1a949490" class="i field">ShouldUseSteppablePipelineOnServer</a> &amp;&amp; <a href="#858f6547d7a6190c" class="i field">pipeline</a> <b>is</b> <a href="../client/remotepipeline.cs.html#018b4ca446b0fea0" class="t t">RemotePipeline</a> <span id="r276 rd" class="r276 r">rPipeline</span>)
                {
                    <span class="r276 r">rPipeline</span>.<a href="../client/remotepipeline.cs.html#57f7aa4a90f59ea7" class="i method">SetIsNested</a>(<b>true</b>);
                    <span class="r276 r">rPipeline</span>.<a href="../client/remotepipeline.cs.html#9e63058fccaf88c7" class="i method">SetIsSteppable</a>(<b>true</b>);
                }
 
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#fc9df3c8ea46c0e9" class="i method">InvokeAsync</a>();
            }
            <b>catch</b> (<a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a> <span id="r277 rd" class="r277 r">e</span>)
            {
                <a href="#abff7fa2939aa32a" class="i field">internalException</a> = <span class="r277 r">e</span>;
                <a href="#65f6f0d306eefb28" class="i method">RaiseOperationCompleteEvent</a>();
            }
            <b>catch</b> (<a href="../../hostifaces/Pipeline.cs.html#37e03f100f9d822e" class="t t">InvalidPipelineStateException</a> <span id="r278 rd" class="r278 r">e</span>)
            {
                <a href="#abff7fa2939aa32a" class="i field">internalException</a> = <span class="r278 r">e</span>;
                <a href="#65f6f0d306eefb28" class="i method">RaiseOperationCompleteEvent</a>();
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r279 rd" class="r279 r">e</span>)
            {
                <a href="#abff7fa2939aa32a" class="i field">internalException</a> = <span class="r279 r">e</span>;
                <a href="#65f6f0d306eefb28" class="i method">RaiseOperationCompleteEvent</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes the pipeline asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="11c7905704633982" href="../../../R/11c7905704633982.html" target="n" data-glyph="74,1" class="i method">StopOperation</a>()
        {
            <b>if</b> (<a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a> ||
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a> ||
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>)
            {
                <span class="c">// If the pipeline state has reached Complete/Failed/Stopped</span>
                <span class="c">// by the time control reaches here, then this operation</span>
                <span class="c">// becomes a no-op. However, an OperationComplete would have</span>
                <span class="c">// already been raised from the handler</span>
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#112721a0ffd69637" class="i method">StopAsync</a>();
            }
            <b>else</b>
            {
                <span class="c">// will have to raise OperationComplete from here,</span>
                <span class="c">// else ThrottleManager will have</span>
                <a href="#65f6f0d306eefb28" class="i method">RaiseOperationCompleteEvent</a>();
            }
        }
 
        <b>internal override event</b> <span class="i">EventHandler</span>&lt;<a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a>&gt; <a id="0708228336b5cad5" href="../../../R/0708228336b5cad5.html" target="n" data-glyph="32,1" class="i">OperationComplete</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles the state changed events for the pipeline. This is registered in both</span>
        <span class="c">///</span><span class="c"> StartOperation and StopOperation. Here nothing more is done excepting raising</span>
        <span class="c">///</span><span class="c"> the OperationComplete event appropriately which will be handled by the cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r280 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Source of this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r281 r">stateEventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">object describing state information about the</span>
        <span class="c">///</span><span class="c"> pipeline</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b2f73a6ca6b35dc6" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandlePipelineStateChanged</a>(<b>object</b> <span id="r280 rd" class="r280 r">sender</span>, <a href="../../hostifaces/Pipeline.cs.html#f088a79047187694" class="t t">PipelineStateEventArgs</a> <span id="r281 rd" class="r281 r">stateEventArgs</span>)
        {
            <a href="../../hostifaces/Pipeline.cs.html#62fb09153673bbf3" class="t t">PipelineStateInfo</a> <span id="r282 rd" class="r282 r">stateInfo</span> = <span class="r281 r">stateEventArgs</span>.<a href="../../hostifaces/Pipeline.cs.html#90fde3748e993197" class="i property">PipelineStateInfo</a>;
 
            <b>switch</b> (<span class="r282 r">stateInfo</span>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a>)
            {
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#17a7706ccaf63f5c" class="i field">Stopping</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#401ea10f45569c67" class="i field">Disconnected</a>:
                    <b>return</b>;
            }
 
            <span class="i">RaiseOperationCompleteEvent</span>(<span class="r281 r">stateEventArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raise an OperationComplete Event. The base event will be</span>
        <span class="c">///</span><span class="c"> null in this case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="65f6f0d306eefb28" href="../../../R/65f6f0d306eefb28.html" target="n" data-glyph="76,1" class="i method">RaiseOperationCompleteEvent</a>()
        {
            <a href="#8c8a194182ff3128" class="i method">RaiseOperationCompleteEvent</a>(<b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raise an operation complete event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r283 r">baseEventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The event args which actually</span>
        <span class="c">///</span><span class="c"> raises this operation complete</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8c8a194182ff3128" href="../../../R/8c8a194182ff3128.html" target="n" data-glyph="76,1" class="i method">RaiseOperationCompleteEvent</a>(<span class="i">EventArgs</span> <span id="r283 rd" class="r283 r">baseEventArgs</span>)
        {
            <a href="#403afaa06ee6320c" class="i method">CleanupRunspaceDebugging</a>(<a href="#07b1b44d725ec8ba" class="i property">PipelineRunspace</a>);
 
            <b>if</b> (<a href="#858f6547d7a6190c" class="i field">pipeline</a> != <b>null</b>)
            {
                <span class="c">// Dispose the pipeline object and release data and remoting resources.</span>
                <span class="c">// Pipeline object remains to provide information on final state and any errors incurred.</span>
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#c0baffefeaa75abd" class="i">StateChanged</a> -= <span class="i">HandlePipelineStateChanged</span>;
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#78d9f1f80ba7c462" class="i method">Dispose</a>();
            }
 
            <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r284 rd" class="r284 r">operationStateEventArgs</span> =
                    <b>new</b> <span class="t">OperationStateEventArgs</span>();
            <span class="r284 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#8648129d937c33ce" class="i property">OperationState</a> =
                    <a href="../common/throttlemanager.cs.html#6cf95059c5d2ad6e" class="t t">OperationState</a>.<a href="../common/throttlemanager.cs.html#c2e1a69d3e84f187" class="i field">StopComplete</a>;
            <span class="r284 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#c68f18b126779ae0" class="i property">BaseEvent</a> = <span class="r283 r">baseEventArgs</span>;
 
            <b>if</b> (<a href="#0708228336b5cad5" class="i">OperationComplete</a> != <b>null</b>)
            {
                <a href="#0708228336b5cad5" class="i">OperationComplete</a>.<span class="i">SafeInvoke</span>(<a href="#921dba60b3314c0b" class="k">this</a>, <span class="r284 r">operationStateEventArgs</span>);
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This helper class contains a runspace and</span>
    <span class="c">///</span><span class="c"> an associated pipeline. On StartOperation it calls</span>
    <span class="c">///</span><span class="c"> OpenAsync on the runspace. In the handler for runspace,</span>
    <span class="c">///</span><span class="c"> when the runspace is successfully opened it calls</span>
    <span class="c">///</span><span class="c"> InvokeAsync on the pipeline. StartOperation</span>
    <span class="c">///</span><span class="c"> is assumed complete when both the operations complete.</span>
    <span class="c">///</span><span class="c"> StopOperation will call StopAsync first on the pipeline</span>
    <span class="c">///</span><span class="c"> and then close the associated runspace. StopOperation</span>
    <span class="c">///</span><span class="c"> is considered complete when both these operations</span>
    <span class="c">///</span><span class="c"> complete. The handler sends a StopComplete message in</span>
    <span class="c">///</span><span class="c"> OperationComplete for both the calls.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="5ff009e2ef1552ca" href="../../../R/5ff009e2ef1552ca.html" target="n" data-glyph="2,0" class="t t">ExecutionCmdletHelperComputerName</a> : <a href="#b467310465a38398" class="t t">ExecutionCmdletHelper</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the command should be invoked and then disconnect the</span>
        <span class="c">///</span><span class="c"> remote runspace from the client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly bool</b> <a id="8854d2383772bd06" href="../../../R/8854d2383772bd06.html" target="n" data-glyph="46,1" class="i field">_invokeAndDisconnect</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The remote runspace created using the computer name</span>
        <span class="c">///</span><span class="c"> parameter set details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <a id="9fbe1fd060e31457" href="../../../R/9fbe1fd060e31457.html" target="n" data-glyph="104,1" class="i property">RemoteRunspace</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r285 r">remoteRunspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RemoteRunspace that is associated</span>
        <span class="c">///</span><span class="c"> with this operation</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r286 r">pipeline</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pipeline created from the remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r287 r">invokeAndDisconnect</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates if pipeline should be disconnected after invoking command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="3e49a87652361d8a" href="../../../R/3e49a87652361d8a.html" target="n" data-glyph="74,1" class="t constructor">ExecutionCmdletHelperComputerName</a>(<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r285 rd" class="r285 r">remoteRunspace</span>, <a href="../../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r286 rd" class="r286 r">pipeline</span>, <b>bool</b> <span id="r287 rd" class="r287 r">invokeAndDisconnect</span> = <b>false</b>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r285 r">remoteRunspace</span> != <b>null</b>,
                    <span class="s">&quot;RemoteRunspace reference cannot be null&quot;</span>);
            <a href="#07b1b44d725ec8ba" class="i property">PipelineRunspace</a> = <span class="r285 r">remoteRunspace</span>;
 
            <a href="#8854d2383772bd06" class="i field">_invokeAndDisconnect</a> = <span class="r287 r">invokeAndDisconnect</span>;
 
            <a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a> = <span class="r285 r">remoteRunspace</span>;
            <span class="r285 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#a776d5953488773f" class="i">StateChanged</a> += <span class="i">HandleRunspaceStateChanged</span>;
 
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r286 r">pipeline</span> != <b>null</b>,
                    <span class="s">&quot;Pipeline cannot be null or empty&quot;</span>);
 
            <a href="#5ff009e2ef1552ca" class="k">this</a>.<a href="#858f6547d7a6190c" class="i field">pipeline</a> = <span class="r286 r">pipeline</span>;
            <span class="r286 r">pipeline</span>.<a href="../../hostifaces/Pipeline.cs.html#c0baffefeaa75abd" class="i">StateChanged</a> += <span class="i">HandlePipelineStateChanged</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call OpenAsync() on the RemoteRunspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="cf49b59de988746c" href="../../../R/cf49b59de988746c.html" target="n" data-glyph="74,1" class="i method">StartOperation</a>()
        {
            <b>try</b>
            {
                <a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a>.<a href="../client/remoterunspace.cs.html#5ee422637ef72aad" class="i method">OpenAsync</a>();
            }
            <b>catch</b> (<a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a> <span id="r288 rd" class="r288 r">e</span>)
            {
                <a href="#abff7fa2939aa32a" class="i field">internalException</a> = <span class="r288 r">e</span>;
                <a href="#4448218419ea6f0b" class="i method">RaiseOperationCompleteEvent</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopAsync on the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="e2bca653bf1c950f" href="../../../R/e2bca653bf1c950f.html" target="n" data-glyph="74,1" class="i method">StopOperation</a>()
        {
            <b>bool</b> <span id="r289 rd" class="r289 r">needToStop</span> = <b>false</b>; <span class="c">// indicates whether to call StopAsync</span>
 
            <b>if</b> (<a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a> ||
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#443fd1d03c8335df" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a> == <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>)
            {
                <span class="r289 r">needToStop</span> = <b>true</b>;
            }
 
            <b>if</b> (<span class="r289 r">needToStop</span>)
            {
                <span class="c">// If the pipeline state has reached Complete/Failed/Stopped</span>
                <span class="c">// by the time control reaches here, then this operation</span>
                <span class="c">// becomes a no-op. However, an OperationComplete would have</span>
                <span class="c">// already been raised from the handler</span>
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#112721a0ffd69637" class="i method">StopAsync</a>();
            }
            <b>else</b>
            {
                <span class="c">// raise an OperationComplete event here. Else the</span>
                <span class="c">// throttle manager will not respond as it will be waiting for</span>
                <span class="c">// this StopOperation to complete</span>
                <a href="#4448218419ea6f0b" class="i method">RaiseOperationCompleteEvent</a>();
            }
        }
 
        <b>internal override event</b> <span class="i">EventHandler</span>&lt;<a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a>&gt; <a id="7c0a52cc31ec3774" href="../../../R/7c0a52cc31ec3774.html" target="n" data-glyph="32,1" class="i">OperationComplete</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles the state changed event for runspace operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r290 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender of this information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r291 r">stateEventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object describing this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="51560cedc5bcd7c2" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleRunspaceStateChanged</a>(<b>object</b> <span id="r290 rd" class="r290 r">sender</span>,
                <a href="../../hostifaces/Connection.cs.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a> <span id="r291 rd" class="r291 r">stateEventArgs</span>)
        {
            <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r292 rd" class="r292 r">state</span> = <span class="r291 r">stateEventArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>;
 
            <b>switch</b> (<span class="r292 r">state</span>)
            {
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>:
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#3990ad8b3e3feec7" class="i field">Opening</a>:
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#fb276cb28f922b8e" class="i field">Closing</a>:
                    <b>return</b>;
 
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>:
                    {
                        <a href="#42bb18dba6713cfa" class="i method">ConfigureRunspaceDebugging</a>(<a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a>);
 
                        <span class="c">// if successfully opened</span>
                        <span class="c">// Call InvokeAsync() on the pipeline</span>
                        <b>try</b>
                        {
                            <b>if</b> (<a href="#8854d2383772bd06" class="i field">_invokeAndDisconnect</a>)
                            {
                                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#92c10b6e74b3869c" class="i method">InvokeAsyncAndDisconnect</a>();
                            }
                            <b>else</b>
                            {
                                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#fc9df3c8ea46c0e9" class="i method">InvokeAsync</a>();
                            }
                        }
                        <b>catch</b> (<a href="../../hostifaces/Pipeline.cs.html#37e03f100f9d822e" class="t t">InvalidPipelineStateException</a>)
                        {
                            <a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a>.<a href="../client/remoterunspace.cs.html#0bab9589a46f6bec" class="i method">CloseAsync</a>();
                        }
                        <b>catch</b> (<a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a> <span id="r293 rd" class="r293 r">e</span>)
                        {
                            <a href="#abff7fa2939aa32a" class="i field">internalException</a> = <span class="r293 r">e</span>;
                            <a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a>.<a href="../client/remoterunspace.cs.html#0bab9589a46f6bec" class="i method">CloseAsync</a>();
                        }
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a>:
                    {
                        <span class="i">RaiseOperationCompleteEvent</span>(<span class="r291 r">stateEventArgs</span>);
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#45de84b67ba18f3f" class="i field">Closed</a>:
                    {
                        <span class="c">// raise a OperationComplete event with</span>
                        <span class="c">// StopComplete message</span>
                        <b>if</b> (<span class="r291 r">stateEventArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#c342411ef74d93be" class="i property">Reason</a> != <b>null</b>)
                        {
                            <span class="i">RaiseOperationCompleteEvent</span>(<span class="r291 r">stateEventArgs</span>);
                        }
                        <b>else</b>
                        {
                            <a href="#4448218419ea6f0b" class="i method">RaiseOperationCompleteEvent</a>();
                        }
                    }
 
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles the state changed event for the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r294 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender of this information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r295 r">stateEventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object describing this event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="5d59bb344c9b2a47" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandlePipelineStateChanged</a>(<b>object</b> <span id="r294 rd" class="r294 r">sender</span>,
                        <a href="../../hostifaces/Pipeline.cs.html#f088a79047187694" class="t t">PipelineStateEventArgs</a> <span id="r295 rd" class="r295 r">stateEventArgs</span>)
        {
            <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a> <span id="r296 rd" class="r296 r">state</span> = <span class="r295 r">stateEventArgs</span>.<a href="../../hostifaces/Pipeline.cs.html#90fde3748e993197" class="i property">PipelineStateInfo</a>.<a href="../../hostifaces/Pipeline.cs.html#2589f8c7203969a0" class="i property">State</a>;
 
            <b>switch</b> (<span class="r296 r">state</span>)
            {
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#d0f3cf00cd5762f1" class="i field">Running</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#efb1d511bf65892d" class="i field">NotStarted</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#17a7706ccaf63f5c" class="i field">Stopping</a>:
                    <b>return</b>;
 
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#f5734941de01b098" class="i field">Completed</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#76cf7f3120e4f94d" class="i field">Stopped</a>:
                <b>case</b> <a href="../../hostifaces/Pipeline.cs.html#03704abc5975cfc4" class="t t">PipelineState</a>.<a href="../../hostifaces/Pipeline.cs.html#425f1d8027f15e68" class="i field">Failed</a>:
                    <b>if</b> (<a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a> != <b>null</b>)
                    {
                        <a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a>.<a href="../client/remoterunspace.cs.html#0bab9589a46f6bec" class="i method">CloseAsync</a>();
                    }
 
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raise an OperationComplete Event. The base event will be</span>
        <span class="c">///</span><span class="c"> null in this case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4448218419ea6f0b" href="../../../R/4448218419ea6f0b.html" target="n" data-glyph="76,1" class="i method">RaiseOperationCompleteEvent</a>()
        {
            <a href="#a505b06aecb55e0b" class="i method">RaiseOperationCompleteEvent</a>(<b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raise an operation complete event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r297 r">baseEventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The event args which actually</span>
        <span class="c">///</span><span class="c"> raises this operation complete</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a505b06aecb55e0b" href="../../../R/a505b06aecb55e0b.html" target="n" data-glyph="76,1" class="i method">RaiseOperationCompleteEvent</a>(<span class="i">EventArgs</span> <span id="r297 rd" class="r297 r">baseEventArgs</span>)
        {
            <b>if</b> (<a href="#858f6547d7a6190c" class="i field">pipeline</a> != <b>null</b>)
            {
                <span class="c">// Dispose the pipeline object and release data and remoting resources.</span>
                <span class="c">// Pipeline object remains to provide information on final state and any errors incurred.</span>
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#c0baffefeaa75abd" class="i">StateChanged</a> -= <span class="i">HandlePipelineStateChanged</span>;
                <a href="#858f6547d7a6190c" class="i field">pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#78d9f1f80ba7c462" class="i method">Dispose</a>();
            }
 
            <b>if</b> (<a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a> != <b>null</b>)
            {
                <span class="c">// Dispose of the runspace object.</span>
                <a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a>.<a href="../../hostifaces/Connection.cs.html#47cd985e55a9f99c" class="i method">Dispose</a>();
                <a href="#9fbe1fd060e31457" class="i property">RemoteRunspace</a> = <b>null</b>;
            }
 
            <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r298 rd" class="r298 r">operationStateEventArgs</span> =
                    <b>new</b> <span class="t">OperationStateEventArgs</span>();
            <span class="r298 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#8648129d937c33ce" class="i property">OperationState</a> =
                    <a href="../common/throttlemanager.cs.html#6cf95059c5d2ad6e" class="t t">OperationState</a>.<a href="../common/throttlemanager.cs.html#c2e1a69d3e84f187" class="i field">StopComplete</a>;
            <span class="r298 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#c68f18b126779ae0" class="i property">BaseEvent</a> = <span class="r297 r">baseEventArgs</span>;
            <a href="#7c0a52cc31ec3774" class="i">OperationComplete</a>.<span class="i">SafeInvoke</span>(<a href="#5ff009e2ef1552ca" class="k">this</a>, <span class="r298 r">operationStateEventArgs</span>);
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Path Resolver
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A helper class to resolve the path.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="47b1cb4d55714c48" href="../../../R/47b1cb4d55714c48.html" target="n" data-glyph="2,0" class="t t">PathResolver</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolves the specified path and verifies the path belongs to</span>
        <span class="c">///</span><span class="c"> FileSystemProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r299 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Path to resolve.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r300 r">isLiteralPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if wildcard expansion should be suppressed for this path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r301 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">reference to calling cmdlet. This will be used for</span>
        <span class="c">///</span><span class="c"> for writing errors</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r302 r">allowNonexistingPaths</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r303 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resource string for error when path is not from filesystem provider.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A fully qualified string representing filename.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="33ef191975483559" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ResolveProviderAndPath</a>(<b>string</b> <span id="r299 rd" class="r299 r">path</span>, <b>bool</b> <span id="r300 rd" class="r300 r">isLiteralPath</span>, <a href="../../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r301 rd" class="r301 r">cmdlet</span>, <b>bool</b> <span id="r302 rd" class="r302 r">allowNonexistingPaths</span>, <b>string</b> <span id="r303 rd" class="r303 r">resourceString</span>)
        {
            <span class="c">// First resolve path</span>
            <a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a> <span id="r304 rd" class="r304 r">resolvedPath</span> = <a href="#ea0f8fc472252a06" class="i method">ResolvePath</a>(<span class="r299 r">path</span>, <span class="r300 r">isLiteralPath</span>, <span class="r302 r">allowNonexistingPaths</span>, <span class="r301 r">cmdlet</span>);
 
            <b>if</b> (<span class="r304 r">resolvedPath</span>.<a href="../../../namespaces/PathInfo.cs.html#223c6ebf64760c0d" class="i property">Provider</a>.<a href="../../DataStoreAdapterProvider.cs.html#3801e8e136516894" class="i property">ImplementingType</a> == <b>typeof</b>(<a href="../../../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>))
            {
                <b>return</b> <span class="r304 r">resolvedPath</span>.<a href="../../../namespaces/PathInfo.cs.html#16e3fcd7f95c1bfc" class="i property">ProviderPath</a>;
            }
 
            <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#eafc61f0708da78f" class="i method">NewInvalidOperationException</a>(<span class="r303 r">resourceString</span>, <span class="r304 r">resolvedPath</span>.<a href="../../../namespaces/PathInfo.cs.html#223c6ebf64760c0d" class="i property">Provider</a>.<a href="../../DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolves the specified path to PathInfo objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r305 r">pathToResolve</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path to be resolved. Each path may contain glob characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r306 r">isLiteralPath</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if wildcard expansion should be suppressed for pathToResolve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r307 r">allowNonexistingPaths</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, resolves the path even if it doesn&#39;t exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r308 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calling cmdlet</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string representing the resolved path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a> <a id="ea0f8fc472252a06" href="../../../R/ea0f8fc472252a06.html" target="n" data-glyph="76,1" class="i method">ResolvePath</a>(
            <b>string</b> <span id="r305 rd" class="r305 r">pathToResolve</span>,
            <b>bool</b> <span id="r306 rd" class="r306 r">isLiteralPath</span>,
            <b>bool</b> <span id="r307 rd" class="r307 r">allowNonexistingPaths</span>,
            <a href="../../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r308 rd" class="r308 r">cmdlet</span>)
        {
            <span class="c">// Construct cmdletprovidercontext</span>
            <a href="../../../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r309 rd" class="r309 r">cmdContext</span> = <b>new</b> <a href="../../../namespaces/CoreCommandContext.cs.html#ce9b8f5a7a73244f" class="t constructor">CmdletProviderContext</a>(<span class="r308 r">cmdlet</span>);
            <span class="r309 r">cmdContext</span>.<a href="../../../namespaces/CoreCommandContext.cs.html#b9edf955d3776935" class="i property">SuppressWildcardExpansion</a> = <span class="r306 r">isLiteralPath</span>;
 
            <span class="i">Collection</span>&lt;<a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>&gt; <span id="r310 rd" class="r310 r">results</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>&gt;();
 
            <b>try</b>
            {
                <span class="c">// First resolve path</span>
                <span class="i">Collection</span>&lt;<a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>&gt; <span id="r311 rd" class="r311 r">pathInfos</span> =
                    <span class="r308 r">cmdlet</span>.<a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../../PathInterfaces.cs.html#8657980b0d09f10c" class="i method">GetResolvedPSPathFromPSPath</a>(
                        <span class="r305 r">pathToResolve</span>,
                        <span class="r309 r">cmdContext</span>);
 
                <b>foreach</b> (<a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a> <span id="r312 rd" class="r312 r">pathInfo</span> <b>in</b> <span class="r311 r">pathInfos</span>)
                {
                    <span class="r310 r">results</span>.<span class="i">Add</span>(<span class="r312 r">pathInfo</span>);
                }
            }
            <b>catch</b> (<a href="../../../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a> <span id="r313 rd" class="r313 r">notSupported</span>)
            {
                <span class="r308 r">cmdlet</span>.<a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                    <b>new</b> <span class="t">ErrorRecord</span>(
                        <span class="r313 r">notSupported</span>.<a href="../../../utils/MshNotSupportedException.cs.html#475b0d1e4c508bc9" class="i property">ErrorRecord</a>,
                        <span class="r313 r">notSupported</span>));
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/SessionStateExceptions.cs.html#09140e6dc875019b" class="t t">DriveNotFoundException</a> <span id="r314 rd" class="r314 r">driveNotFound</span>)
            {
                <span class="r308 r">cmdlet</span>.<a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                    <b>new</b> <span class="t">ErrorRecord</span>(
                        <span class="r314 r">driveNotFound</span>.<a href="../../../utils/SessionStateExceptions.cs.html#3efc34ad3d29e212" class="i property">ErrorRecord</a>,
                        <span class="r314 r">driveNotFound</span>));
            }
            <b>catch</b> (<a href="../../../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a> <span id="r315 rd" class="r315 r">providerNotFound</span>)
            {
                <span class="r308 r">cmdlet</span>.<a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                    <b>new</b> <span class="t">ErrorRecord</span>(
                        <span class="r315 r">providerNotFound</span>.<a href="../../../utils/SessionStateExceptions.cs.html#3efc34ad3d29e212" class="i property">ErrorRecord</a>,
                        <span class="r315 r">providerNotFound</span>));
            }
            <b>catch</b> (<a href="../../../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a> <span id="r316 rd" class="r316 r">pathNotFound</span>)
            {
                <b>if</b> (<span class="r307 r">allowNonexistingPaths</span>)
                {
                    <a href="../../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r317 rd" class="r317 r">provider</span> = <b>null</b>;
                    <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r318 rd" class="r318 r">drive</span> = <b>null</b>;
                    <b>string</b> <span id="r319 rd" class="r319 r">unresolvedPath</span> =
                        <span class="r308 r">cmdlet</span>.<a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../../PathInterfaces.cs.html#9c8992a5e414cb6d" class="i method">GetUnresolvedProviderPathFromPSPath</a>(
                            <span class="r305 r">pathToResolve</span>,
                            <span class="r309 r">cmdContext</span>,
                            <b>out</b> <span class="r317 r">provider</span>,
                            <b>out</b> <span class="r318 r">drive</span>);
 
                    <a href="../../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a> <span id="r320 rd" class="r320 r">pathInfo</span> =
                        <b>new</b> <a href="../../../namespaces/PathInfo.cs.html#6846c3b69ef77149" class="t constructor">PathInfo</a>(
                            <span class="r318 r">drive</span>,
                            <span class="r317 r">provider</span>,
                            <span class="r319 r">unresolvedPath</span>,
                            <span class="r308 r">cmdlet</span>.<a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>);
                    <span class="r310 r">results</span>.<span class="i">Add</span>(<span class="r320 r">pathInfo</span>);
                }
                <b>else</b>
                {
                    <span class="r308 r">cmdlet</span>.<a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(
                            <span class="r316 r">pathNotFound</span>.<a href="../../../utils/SessionStateExceptions.cs.html#3efc34ad3d29e212" class="i property">ErrorRecord</a>,
                            <span class="r316 r">pathNotFound</span>));
                }
            }
 
            <b>if</b> (<span class="r310 r">results</span>.<span class="i">Count</span> == 1)
            {
                <b>return</b> <span class="r310 r">results</span>[0];
            }
            <b>else</b> <span class="c">// if (results.Count &gt; 1)</span>
            {
                <span class="i">Exception</span> <span id="r321 rd" class="r321 r">e</span> = <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
                <span class="r308 r">cmdlet</span>.<a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(
                    <b>new</b> <span class="t">ErrorRecord</span>(<span class="r321 r">e</span>,
                    <span class="s">&quot;NotSupported&quot;</span>,
                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#8088845be39ec60c" class="i field">NotImplemented</a>,
                    <span class="r310 r">results</span>));
                <b>return</b> <b>null</b>;
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> QueryRunspaces
 
    <b>internal class</b> <a id="2069a7a39daa030c" href="../../../R/2069a7a39daa030c.html" target="n" data-glyph="2,0" class="t t">QueryRunspaces</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <b>internal</b> <a id="5992ed76877fce33" href="../../../R/5992ed76877fce33.html" target="n" data-glyph="74,1" class="t constructor">QueryRunspaces</a>()
        {
            <a href="#7a2df07f29359f47" class="i field">_stopProcessing</a> = <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Queries all remote computers specified in collection of WSManConnectionInfo objects</span>
        <span class="c">///</span><span class="c"> and returns disconnected PSSession objects ready for connection to server.</span>
        <span class="c">///</span><span class="c"> Returned sessions can be matched to Guids or Names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r322 r">connectionInfos</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Collection of WSManConnectionInfo objects.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r323 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host for PSSession objects.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r324 r">stream</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Out stream object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r325 r">runspaceRepository</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace repository.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r326 r">throttleLimit</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Throttle limit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r327 r">filterState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace state filter value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r328 r">matchIds</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Array of session Guids to match to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r329 r">matchNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Array of session Names to match to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r330 r">configurationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Configuration name to match to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Collection of disconnected PSSession objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="575b3e50dfacf4ff" href="../../../R/575b3e50dfacf4ff.html" target="n" data-glyph="74,1" class="i method">GetDisconnectedSessions</a>(<span class="i">Collection</span>&lt;<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>&gt; <span id="r322 rd" class="r322 r">connectionInfos</span>, <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r323 rd" class="r323 r">host</span>,
                                                               <a href="../../../utils/ObjectStream.cs.html#247cf7c4c5dec5a4" class="t t">ObjectStream</a> <span id="r324 rd" class="r324 r">stream</span>, <a href="runspacerepository.cs.html#28c9d25c1832bb0f" class="t t">RunspaceRepository</a> <span id="r325 rd" class="r325 r">runspaceRepository</span>,
                                                               <b>int</b> <span id="r326 rd" class="r326 r">throttleLimit</span>, <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a> <span id="r327 rd" class="r327 r">filterState</span>,
                                                               <span class="i">Guid</span>[] <span id="r328 rd" class="r328 r">matchIds</span>, <b>string</b>[] <span id="r329 rd" class="r329 r">matchNames</span>, <b>string</b> <span id="r330 rd" class="r330 r">configurationName</span>)
        {
            <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r331 rd" class="r331 r">filteredPSSessions</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
            <span class="c">// Create a query operation for each connection information object.</span>
            <b>foreach</b> (<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r332 rd" class="r332 r">connectionInfo</span> <b>in</b> <span class="r322 r">connectionInfos</span>)
            {
                <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>[] <span id="r333 rd" class="r333 r">runspaces</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="r333 r">runspaces</span> = <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#6cfa88f31c104ee1" class="i method">GetRunspaces</a>(<span class="r332 r">connectionInfo</span>, <span class="r323 r">host</span>, <a href="#55e83f382bc3d8b3" class="i property">BuiltInTypesTable</a>);
                }
                <b>catch</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r334 rd" class="r334 r">e</span>)
                {
                    <b>if</b> (<span class="r334 r">e</span>.<span class="i">InnerException</span> <b>is</b> <span class="i">InvalidOperationException</span>)
                    {
                        <span class="c">// The Get-WSManInstance cmdlet used to query remote computers for runspaces will throw</span>
                        <span class="c">// an Invalid Operation (inner) exception if the connectInfo object is invalid, including</span>
                        <span class="c">// invalid computer names.</span>
                        <span class="c">// We don&#39;t want to propagate the exception so just write error here.</span>
                        <b>if</b> (<span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a> != <b>null</b> &amp;&amp; <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<a href="../../../utils/IObjectWriter.cs.html#37eb9b5d6b3e954a" class="i property">IsOpen</a>)
                        {
                            <b>int</b> <span id="r335 rd" class="r335 r">errorCode</span>;
                            <b>string</b> <span id="r336 rd" class="r336 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">QueryForRunspacesFailed</span>, <span class="r332 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#74b71e9668d24a47" class="i property">ComputerName</a>, <span class="i">ExtractMessage</span>(<span class="r334 r">e</span>.<span class="i">InnerException</span>, <b>out</b> <span class="r335 r">errorCode</span>));
                            <b>string</b> <span id="r337 rd" class="r337 r">FQEID</span> = <a href="../fanin/WSManTransportManager.cs.html#b4291df75d9bc408" class="t t">WSManTransportManagerUtils</a>.<a href="../fanin/WSManTransportManager.cs.html#d3bf2dfca72ae399" class="i method">GetFQEIDFromTransportError</a>(<span class="r335 r">errorCode</span>, <span class="s">&quot;RemotePSSessionQueryFailed&quot;</span>);
                            <span class="i">Exception</span> <span id="r338 rd" class="r338 r">reason</span> = <b>new</b> <span class="t">RuntimeException</span>(<span class="r336 r">msg</span>, <span class="r334 r">e</span>.<span class="i">InnerException</span>);
                            <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r339 rd" class="r339 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r338 r">reason</span>, <span class="r337 r">FQEID</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r332 r">connectionInfo</span>);
                            <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<span class="i">Write</span>((<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt;)(<span id="r340 rd" class="r340 r">cmdlet</span> =&gt; <span class="r340 r">cmdlet</span>.<span class="i">WriteError</span>(<span class="r339 r">errorRecord</span>)));
                        }
                    }
                    <b>else</b>
                    {
                        <b>throw</b>;
                    }
                }
 
                <b>if</b> (<a href="#7a2df07f29359f47" class="i field">_stopProcessing</a>)
                {
                    <b>break</b>;
                }
 
                <span class="c">// Add all runspaces meeting filter criteria to collection.</span>
                <b>if</b> (<span class="r333 r">runspaces</span> != <b>null</b>)
                {
                    <span class="c">// Convert configuration name into shell Uri for comparison.</span>
                    <b>string</b> <span id="r341 rd" class="r341 r">shellUri</span> = <b>null</b>;
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r330 r">configurationName</span>))
                    {
                        <span class="r341 r">shellUri</span> = (<span class="r330 r">configurationName</span>.<span class="i">IndexOf</span>(
                                    <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#f383edcf61712f90" class="i field">ResourceURIPrefix</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) != -1) ?
                                    <span class="r330 r">configurationName</span> : <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#f383edcf61712f90" class="i field">ResourceURIPrefix</a> + <span class="r330 r">configurationName</span>;
                    }
 
                    <b>foreach</b> (<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r342 rd" class="r342 r">runspace</span> <b>in</b> <span class="r333 r">runspaces</span>)
                    {
                        <span class="c">// Filter returned runspaces by ConfigurationName if provided.</span>
                        <b>if</b> (<span class="r341 r">shellUri</span> != <b>null</b>)
                        {
                            <span class="c">// Compare with returned shell Uri in connection info.</span>
                            <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r343 rd" class="r343 r">wsmanConnectionInfo</span> = <span class="r342 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#7ff4c79fcb624bf1" class="i property">ConnectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>;
                            <b>if</b> (<span class="r343 r">wsmanConnectionInfo</span> != <b>null</b> &amp;&amp;
                                !<span class="r341 r">shellUri</span>.<span class="i">Equals</span>(<span class="r343 r">wsmanConnectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#a0ee4c890acec948" class="i property">ShellUri</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>continue</b>;
                            }
                        }
 
                        <span class="c">// Check the repository for an existing viable PSSession for</span>
                        <span class="c">// this runspace (based on instanceId).  Use the existing</span>
                        <span class="c">// local runspace instead of the one returned from the server</span>
                        <span class="c">// query.</span>
                        <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r344 rd" class="r344 r">existingPSSession</span> = <b>null</b>;
                        <b>if</b> (<span class="r325 r">runspaceRepository</span> != <b>null</b>)
                        {
                            <span class="r344 r">existingPSSession</span> = <span class="r325 r">runspaceRepository</span>.<a href="JobRepository.cs.html#bbddf9bb54db870b" class="i method">GetItem</a>(<span class="r342 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>);
                        }
 
                        <b>if</b> (<span class="r344 r">existingPSSession</span> != <b>null</b> &amp;&amp;
                            <a href="#14edc426c85bb0bb" class="i method">UseExistingRunspace</a>(<span class="r344 r">existingPSSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>, <span class="r342 r">runspace</span>))
                        {
                            <b>if</b> (<a href="#f1aa4510482d84b6" class="i method">TestRunspaceState</a>(<span class="r344 r">existingPSSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>, <span class="r327 r">filterState</span>))
                            {
                                <span class="r331 r">filteredPSSessions</span>.<span class="i">Add</span>(<span class="r344 r">existingPSSession</span>);
                            }
                        }
                        <b>else</b> <b>if</b> (<a href="#f1aa4510482d84b6" class="i method">TestRunspaceState</a>(<span class="r342 r">runspace</span>, <span class="r327 r">filterState</span>))
                        {
                            <span class="r331 r">filteredPSSessions</span>.<span class="i">Add</span>(<b>new</b> <a href="../client/remoterunspaceinfo.cs.html#5bda0c46d12cafb6" class="t constructor">PSSession</a>(<span class="r342 r">runspace</span> <b>as</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>));
                        }
                    }
                }
            }
 
            <span class="c">// Return only PSSessions that match provided Ids or Names.</span>
            <b>if</b> ((<span class="r328 r">matchIds</span> != <b>null</b>) &amp;&amp; (<span class="r331 r">filteredPSSessions</span>.<span class="i">Count</span> &gt; 0))
            {
                <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r345 rd" class="r345 r">matchIdsSessions</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
                <b>foreach</b> (<span class="i">Guid</span> <span id="r346 rd" class="r346 r">id</span> <b>in</b> <span class="r328 r">matchIds</span>)
                {
                    <b>bool</b> <span id="r347 rd" class="r347 r">matchFound</span> = <b>false</b>;
                    <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r348 rd" class="r348 r">psSession</span> <b>in</b> <span class="r331 r">filteredPSSessions</span>)
                    {
                        <b>if</b> (<a href="#7a2df07f29359f47" class="i field">_stopProcessing</a>)
                        {
                            <b>break</b>;
                        }
 
                        <b>if</b> (<span class="r348 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>.<span class="i">Equals</span>(<span class="r346 r">id</span>))
                        {
                            <span class="r347 r">matchFound</span> = <b>true</b>;
                            <span class="r345 r">matchIdsSessions</span>.<span class="i">Add</span>(<span class="r348 r">psSession</span>);
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (!<span class="r347 r">matchFound</span> &amp;&amp; <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a> != <b>null</b> &amp;&amp; <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<a href="../../../utils/IObjectWriter.cs.html#37eb9b5d6b3e954a" class="i property">IsOpen</a>)
                    {
                        <b>string</b> <span id="r349 rd" class="r349 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">SessionIdMatchFailed</span>, <span class="r346 r">id</span>);
                        <span class="i">Exception</span> <span id="r350 rd" class="r350 r">reason</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<span class="r349 r">msg</span>);
                        <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r351 rd" class="r351 r">errorRecord</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r350 r">reason</span>, <span class="s">&quot;PSSessionIdMatchFail&quot;</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r346 r">id</span>);
                        <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<span class="i">Write</span>((<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt;)(<span id="r352 rd" class="r352 r">cmdlet</span> =&gt; <span class="r352 r">cmdlet</span>.<span class="i">WriteError</span>(<span class="r351 r">errorRecord</span>)));
                    }
                }
 
                <span class="c">// Return all found sessions.</span>
                <b>return</b> <span class="r345 r">matchIdsSessions</span>;
            }
            <b>else</b> <b>if</b> ((<span class="r329 r">matchNames</span> != <b>null</b>) &amp;&amp; (<span class="r331 r">filteredPSSessions</span>.<span class="i">Count</span> &gt; 0))
            {
                <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r353 rd" class="r353 r">matchNamesSessions</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
                <b>foreach</b> (<b>string</b> <span id="r354 rd" class="r354 r">name</span> <b>in</b> <span class="r329 r">matchNames</span>)
                {
                    <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r355 rd" class="r355 r">namePattern</span> = <a href="../../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r354 r">name</span>, <a href="../../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>bool</b> <span id="r356 rd" class="r356 r">matchFound</span> = <b>false</b>;
                    <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r357 rd" class="r357 r">psSession</span> <b>in</b> <span class="r331 r">filteredPSSessions</span>)
                    {
                        <b>if</b> (<a href="#7a2df07f29359f47" class="i field">_stopProcessing</a>)
                        {
                            <b>break</b>;
                        }
 
                        <b>if</b> (<span class="r355 r">namePattern</span>.<a href="../../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(((<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>)<span class="r357 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>).<a href="../client/remoterunspace.cs.html#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../client/RemoteRunspacePoolInternal.cs.html#1a2dda11a58f900f" class="i property">Name</a>))
                        {
                            <span class="r356 r">matchFound</span> = <b>true</b>;
                            <span class="r353 r">matchNamesSessions</span>.<span class="i">Add</span>(<span class="r357 r">psSession</span>);
                        }
                    }
 
                    <b>if</b> (!<span class="r356 r">matchFound</span> &amp;&amp; <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a> != <b>null</b> &amp;&amp; <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<a href="../../../utils/IObjectWriter.cs.html#37eb9b5d6b3e954a" class="i property">IsOpen</a>)
                    {
                        <b>string</b> <span id="r358 rd" class="r358 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">SessionNameMatchFailed</span>, <span class="r354 r">name</span>);
                        <span class="i">Exception</span> <span id="r359 rd" class="r359 r">reason</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<span class="r358 r">msg</span>);
                        <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r360 rd" class="r360 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r359 r">reason</span>, <span class="s">&quot;PSSessionNameMatchFail&quot;</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r354 r">name</span>);
                        <span class="r324 r">stream</span>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<span class="i">Write</span>((<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt;)(<span id="r361 rd" class="r361 r">cmdlet</span> =&gt; <span class="r361 r">cmdlet</span>.<span class="i">WriteError</span>(<span class="r360 r">errorRecord</span>)));
                    }
                }
 
                <b>return</b> <span class="r353 r">matchNamesSessions</span>;
            }
            <b>else</b>
            {
                <span class="c">// Return all collected sessions.</span>
                <b>return</b> <span class="r331 r">filteredPSSessions</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the existing runspace should be returned to the user</span>
        <span class="c">///</span><span class="c"> a.  If the existing runspace is not broken</span>
        <span class="c">///</span><span class="c"> b.  If the queried runspace is not connected to a different user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r362 r">existingRunspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r363 r">queriedrunspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="14edc426c85bb0bb" href="../../../R/14edc426c85bb0bb.html" target="n" data-glyph="76,1" class="i method">UseExistingRunspace</a>(
            <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r362 rd" class="r362 r">existingRunspace</span>,
            <a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r363 rd" class="r363 r">queriedrunspace</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r362 r">existingRunspace</span> != <b>null</b>, <span class="s">&quot;Invalid parameter.&quot;</span>);
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r363 r">queriedrunspace</span> != <b>null</b>, <span class="s">&quot;Invalid parameter.&quot;</span>);
 
            <b>if</b> (<span class="r362 r">existingRunspace</span>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r362 r">existingRunspace</span>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a> &amp;&amp;
                <span class="r363 r">queriedrunspace</span>.<a href="../../hostifaces/Connection.cs.html#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#aed194b80737a544" class="i field">Busy</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Update existing runspace to have latest DisconnectedOn/ExpiresOn data.</span>
            <span class="r362 r">existingRunspace</span>.<a href="../../hostifaces/Connection.cs.html#6c141feecce4dc09" class="i property">DisconnectedOn</a> = <span class="r363 r">queriedrunspace</span>.<a href="../../hostifaces/Connection.cs.html#6c141feecce4dc09" class="i property">DisconnectedOn</a>;
            <span class="r362 r">existingRunspace</span>.<a href="../../hostifaces/Connection.cs.html#89b751705e0b934c" class="i property">ExpiresOn</a> = <span class="r363 r">queriedrunspace</span>.<a href="../../hostifaces/Connection.cs.html#89b751705e0b934c" class="i property">ExpiresOn</a>;
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns Exception message.  If message is WSMan Xml then</span>
        <span class="c">///</span><span class="c"> the WSMan message and error code is extracted and returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r364 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r365 r">errorCode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returned WSMan error code.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">WSMan message.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="d56f5ae6249a5149" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ExtractMessage</a>(
            <span class="i">Exception</span> <span id="r364 rd" class="r364 r">e</span>,
            <b>out int</b> <span id="r365 rd" class="r365 r">errorCode</span>)
        {
            <span class="r365 r">errorCode</span> = 0;
 
            <b>if</b> (<span class="r364 r">e</span> == <b>null</b> ||
                <span class="r364 r">e</span>.<span class="i">Message</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>string</b> <span id="r366 rd" class="r366 r">rtnMsg</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlReaderSettings</span> <span id="r367 rd" class="r367 r">xmlReaderSettings</span> = <a href="../../serialization.cs.html#758c46d6a86d6840" class="t t">InternalDeserializer</a>.<a href="../../serialization.cs.html#b7ced31d9e3d32cb" class="i property">XmlReaderSettingsForUntrustedXmlDocument</a>.<span class="i">Clone</span>();
                <span class="r367 r">xmlReaderSettings</span>.<span class="i">MaxCharactersInDocument</span> = 4096;
                <span class="r367 r">xmlReaderSettings</span>.<span class="i">MaxCharactersFromEntities</span> = 1024;
                <span class="r367 r">xmlReaderSettings</span>.<span class="i">DtdProcessing</span> = <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">DtdProcessing</span>.<span class="i">Prohibit</span>;
 
                <b>using</b> (<span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlReader</span> <span id="r368 rd" class="r368 r">reader</span> = <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlReader</span>.<span class="i">Create</span>(
                        <b>new</b> <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">StringReader</span>(<span class="r364 r">e</span>.<span class="i">Message</span>), <span class="r367 r">xmlReaderSettings</span>))
                {
                    <b>while</b> (<span class="r368 r">reader</span>.<span class="i">Read</span>())
                    {
                        <b>if</b> (<span class="r368 r">reader</span>.<span class="i">NodeType</span> == <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlNodeType</span>.<span class="i">Element</span>)
                        {
                            <b>if</b> (<span class="r368 r">reader</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;Message&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r366 r">rtnMsg</span> = <span class="r368 r">reader</span>.<span class="i">ReadElementContentAsString</span>();
                            }
                            <b>else</b> <b>if</b> (<span class="r368 r">reader</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;WSManFault&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>string</b> <span id="r369 rd" class="r369 r">errorCodeString</span> = <span class="r368 r">reader</span>.<span class="i">GetAttribute</span>(<span class="s">&quot;Code&quot;</span>);
                                <b>if</b> (<span class="r369 r">errorCodeString</span> != <b>null</b>)
                                {
                                    <b>try</b>
                                    {
                                        <span class="c">// WinRM returns both signed and unsigned 32 bit string values.  Convert to signed 32 bit integer.</span>
                                        <span class="i">Int64</span> <span id="r370 rd" class="r370 r">eCode</span> = <span class="i">Convert</span>.<span class="i">ToInt64</span>(<span class="r369 r">errorCodeString</span>, <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>);
                                        <b>unchecked</b>
                                        {
                                            <span class="r365 r">errorCode</span> = (<b>int</b>)<span class="r370 r">eCode</span>;
                                        }
                                    }
                                    <b>catch</b> (<span class="i">FormatException</span>)
                                    { }
                                    <b>catch</b> (<span class="i">OverflowException</span>)
                                    { }
                                }
                            }
                        }
                    }
                }
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlException</span>)
            { }
 
            <b>return</b> <span class="r366 r">rtnMsg</span> ?? <span class="r364 r">e</span>.<span class="i">Message</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Discontinue all remote server query operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="46bbc881ce2841f1" href="../../../R/46bbc881ce2841f1.html" target="n" data-glyph="74,1" class="i method">StopAllOperations</a>()
        {
            <a href="#7a2df07f29359f47" class="i field">_stopProcessing</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compares the runspace filter state with the runspace state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r371 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace object to test.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r372 r">filterState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Filter state to compare.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Result of test.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="f1aa4510482d84b6" href="../../../R/f1aa4510482d84b6.html" target="n" data-glyph="72,1" class="i method">TestRunspaceState</a>(<a href="../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r371 rd" class="r371 r">runspace</span>, <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a> <span id="r372 rd" class="r372 r">filterState</span>)
        {
            <b>bool</b> <span id="r373 rd" class="r373 r">result</span>;
 
            <b>switch</b> (<span class="r372 r">filterState</span>)
            {
                <b>case</b> <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="#3e09a716ae427cdf" class="i field">All</a>:
                    <span class="r373 r">result</span> = <b>true</b>;
                    <b>break</b>;
 
                <b>case</b> <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="#a9b84362497cb2d8" class="i field">Opened</a>:
                    <span class="r373 r">result</span> = (<span class="r371 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="#2f567993d42f14dd" class="i field">Closed</a>:
                    <span class="r373 r">result</span> = (<span class="r371 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#45de84b67ba18f3f" class="i field">Closed</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="#9c839bbb7cf37aff" class="i field">Disconnected</a>:
                    <span class="r373 r">result</span> = (<span class="r371 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="#722cc247477604dc" class="i field">Broken</a>:
                    <span class="r373 r">result</span> = (<span class="r371 r">runspace</span>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a>);
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Invalid SessionFilterState value.&quot;</span>);
                    <span class="r373 r">result</span> = <b>false</b>;
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r373 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the default type table for built-in PowerShell types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="55e83f382bc3d8b3" href="../../../R/55e83f382bc3d8b3.html" target="n" data-glyph="104,1" class="i property">BuiltInTypesTable</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#e5bf802e92ac92eb" class="i field">s_TypeTable</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#f0eb5280779b31c8" class="i field">s_SyncObject</a>)
                    {
                        <b>if</b> (<a href="#e5bf802e92ac92eb" class="i field">s_TypeTable</a> == <b>null</b>)
                        {
                            <a href="#e5bf802e92ac92eb" class="i field">s_TypeTable</a> = <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="../../TypeTable.cs.html#c6d160f5d02296fa" class="i method">LoadDefaultTypeFiles</a>();
                        }
                    }
                }
 
                <b>return</b> <a href="#e5bf802e92ac92eb" class="i field">s_TypeTable</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private bool</b> <a id="7a2df07f29359f47" href="../../../R/7a2df07f29359f47.html" target="n" data-glyph="46,1" class="i field">_stopProcessing</a>;
 
        <b>private static readonly object</b> <a id="f0eb5280779b31c8" href="../../../R/f0eb5280779b31c8.html" target="n" data-glyph="46,1" class="i field">s_SyncObject</a> = <b>new</b> <b>object</b>();
        <b>private static</b> <a href="../../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="e5bf802e92ac92eb" href="../../../R/e5bf802e92ac92eb.html" target="n" data-glyph="46,1" class="i field">s_TypeTable</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> SessionFilterState Enum
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Runspace states that can be used as filters for querying remote runspaces.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="5a1d06b9138c1065" href="../../../R/5a1d06b9138c1065.html" target="n" data-glyph="18,0" class="t t"><span id="7e06d6c74e548c15">SessionFilterState</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return runspaces in any state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="3e09a716ae427cdf" href="../../../R/3e09a716ae427cdf.html" target="n" data-glyph="24,1" class="i field">All</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return runspaces in Opened state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a9b84362497cb2d8" href="../../../R/a9b84362497cb2d8.html" target="n" data-glyph="24,1" class="i field">Opened</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return runspaces in Disconnected state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9c839bbb7cf37aff" href="../../../R/9c839bbb7cf37aff.html" target="n" data-glyph="24,1" class="i field">Disconnected</a> = 2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return runspaces in Closed state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2f567993d42f14dd" href="../../../R/2f567993d42f14dd.html" target="n" data-glyph="24,1" class="i field">Closed</a> = 3,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return runspaces in Broken state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="722cc247477604dc" href="../../../R/722cc247477604dc.html" target="n" data-glyph="24,1" class="i field">Broken</a> = 4
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Helper Classes
}
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> IMPORTANT: proxy configuration is supported for HTTPS only; for HTTP, the direct</span>
    <span class="c">///</span><span class="c"> connection to the server is used.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1027:MarkEnumsWithFlags&quot;</span>)]
    <b>public enum</b> <a id="859b8c6a1b0a04ef" href="../../../R/859b8c6a1b0a04ef.html" target="n" data-glyph="18,0" class="t t"><span id="031a5475f8a2c754">ProxyAccessType</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProxyAccessType is not specified. That means Proxy information (ProxyAccessType, ProxyAuthenticationMechanism</span>
        <span class="c">///</span><span class="c"> and ProxyCredential)is not passed to WSMan at all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b8abe0a20c41194e" href="../../../R/b8abe0a20c41194e.html" target="n" data-glyph="24,1" class="i field">None</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use the Internet Explorer proxy configuration for the current user.</span>
        <span class="c">///</span><span class="c">  Internet Explorer proxy settings for the current active network connection.</span>
        <span class="c">///</span><span class="c">  This option requires the user profile to be loaded, so the option can</span>
        <span class="c">///</span><span class="c">  be directly used when called within a process that is running under</span>
        <span class="c">///</span><span class="c">  an interactive user account identity; if the client application is running</span>
        <span class="c">///</span><span class="c">  under a user context different than the interactive user, the client</span>
        <span class="c">///</span><span class="c">  application has to explicitly load the user profile prior to using this option.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b81c471873f4441b" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">IEConfig</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Proxy settings configured for WinHTTP, using the ProxyCfg.exe utility.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c3dc7a027d376f89" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">WinHttpConfig</a> = 2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Force autodetection of proxy.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ebae736bc1918661" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">AutoDetect</a> = 4,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Do not use a proxy server - resolves all host names locally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="0e1accbe16061211" href="../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">NoProxyServer</a> = 8
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Options for a remote PSSession.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="8626ee928362b305" href="../../../R/8626ee928362b305.html" target="n" data-glyph="0,0" class="t t">PSSessionOption</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new instance of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#8626ee928362b305" class="t t">PSSessionOption</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="90c789cd47314cbe" href="../../../R/90c789cd47314cbe.html" target="n" data-glyph="72,1" class="t constructor">PSSessionOption</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The MaximumConnectionRedirectionCount parameter enables the implicit redirection functionality.</span>
        <span class="c">///</span><span class="c"> -1 = no limit</span>
        <span class="c">///</span><span class="c">  0 = no redirection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="28f392672e3eb863" href="../../../R/28f392672e3eb863.html" target="n" data-glyph="102,1" class="i property">MaximumConnectionRedirectionCount</a> { <b>get</b>; <b>set</b>; } = <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#b1d6f002297a7835" class="i field">defaultMaximumConnectionRedirectionCount</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If false, underlying WSMan infrastructure will compress data sent on the network.</span>
        <span class="c">///</span><span class="c"> If true, data will not be compressed. Compression improves performance by</span>
        <span class="c">///</span><span class="c"> reducing the amount of data sent on the network. Compression my require extra</span>
        <span class="c">///</span><span class="c"> memory consumption and CPU usage. In cases where available memory / CPU is less,</span>
        <span class="c">///</span><span class="c"> set this property to &quot;true&quot;.</span>
        <span class="c">///</span><span class="c"> By default the value of this property is &quot;false&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4da96a141e629777" href="../../../R/4da96a141e629777.html" target="n" data-glyph="102,1" class="i property">NoCompression</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> then Operating System won&#39;t load the user profile (i.e. registry keys under HKCU) on the remote server</span>
        <span class="c">///</span><span class="c"> which can result in a faster session creation time.  This option won&#39;t have any effect if the remote machine has</span>
        <span class="c">///</span><span class="c"> already loaded the profile (i.e. in another session).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="fc82bbd8845feda4" href="../../../R/fc82bbd8845feda4.html" target="n" data-glyph="102,1" class="i property">NoMachineProfile</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> By default, ProxyAccessType is None, that means Proxy information (ProxyAccessType,</span>
        <span class="c">///</span><span class="c"> ProxyAuthenticationMechanism and ProxyCredential)is not passed to WSMan at all.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a> <a id="bf46cf340b00816f" href="../../../R/bf46cf340b00816f.html" target="n" data-glyph="102,1" class="i property">ProxyAccessType</a> { <b>get</b>; <b>set</b>; } = <a href="#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a>.<a href="#b8abe0a20c41194e" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ProxyAuthentication&quot;.</span>
        <span class="c">///</span><span class="c"> This parameter takes a set of authentication methods the user can select</span>
        <span class="c">///</span><span class="c"> from.  The available options should be as follows:</span>
        <span class="c">///</span><span class="c"> - Negotiate: Use the default authentication (as defined by the underlying</span>
        <span class="c">///</span><span class="c"> protocol) for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> - Basic:  Use basic authentication for establishing a remote connection</span>
        <span class="c">///</span><span class="c"> - Digest: Use Digest authentication for establishing a remote connection</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Default is Negotiate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="fffb36093e5ccf4f" href="../../../R/fffb36093e5ccf4f.html" target="n" data-glyph="102,1" class="i property">ProxyAuthentication</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#27f578c2bb951278" class="i field">_proxyAuthentication</a>;
            }
 
            <b>set</b>
            {
                <b>switch</b> (<b>value</b>)
                {
                    <b>case</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#aa56bb950a6fa6df" class="i field">Basic</a>:
                    <b>case</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#e6aff575bfa34071" class="i field">Negotiate</a>:
                    <b>case</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#7094d14a65d8f900" class="i field">Digest</a>:
                        <a href="#27f578c2bb951278" class="i field">_proxyAuthentication</a> = <b>value</b>;
                        <b>break</b>;
                    <b>default</b>:
                        <b>string</b> <span id="r374 rd" class="r374 r">message</span> = <a href="../common/remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ProxyAmbiguousAuthentication</span>,
                            <b>value</b>,
                            <b>nameof</b>(<a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#aa56bb950a6fa6df" class="i field">Basic</a>),
                            <b>nameof</b>(<a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#e6aff575bfa34071" class="i field">Negotiate</a>),
                            <b>nameof</b>(<a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#7094d14a65d8f900" class="i field">Digest</a>));
                        <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r374 r">message</span>);
                }
            }
        }
 
        <b>private</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="27f578c2bb951278" href="../../../R/27f578c2bb951278.html" target="n" data-glyph="46,1" class="i field">_proxyAuthentication</a> = <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="../common/RunspaceConnectionInfo.cs.html#e6aff575bfa34071" class="i field">Negotiate</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ProxyCredential&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="7be1964b0ead807f" href="../../../R/7be1964b0ead807f.html" target="n" data-glyph="102,1" class="i property">ProxyCredential</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When connecting over HTTPS, the client does not validate that the server</span>
        <span class="c">///</span><span class="c"> certificate is signed by a trusted certificate authority (CA). Use only when</span>
        <span class="c">///</span><span class="c"> the remote computer is trusted by other means, for example, if the remote</span>
        <span class="c">///</span><span class="c"> computer is part of a network that is physically secure and isolated or the</span>
        <span class="c">///</span><span class="c"> remote computer is listed as a trusted host in WinRM configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="eb570bd42a230549" href="../../../R/eb570bd42a230549.html" target="n" data-glyph="102,1" class="i property">SkipCACheck</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that certificate common name (CN) of the server need not match the</span>
        <span class="c">///</span><span class="c"> hostname of the server. Used only in remote operations using https. This</span>
        <span class="c">///</span><span class="c"> option should only be used for trusted machines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="a8cc5d801c0dd2dd" href="../../../R/a8cc5d801c0dd2dd.html" target="n" data-glyph="102,1" class="i property">SkipCNCheck</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that certificate common name (CN) of the server need not match the</span>
        <span class="c">///</span><span class="c"> hostname of the server. Used only in remote operations using https. This</span>
        <span class="c">///</span><span class="c"> option should only be used for trusted machines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="9861329a549ae83a" href="../../../R/9861329a549ae83a.html" target="n" data-glyph="102,1" class="i property">SkipRevocationCheck</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration for which PowerShell remoting waits before timing out</span>
        <span class="c">///</span><span class="c"> for any operation. The user would like to tweak this timeout</span>
        <span class="c">///</span><span class="c"> depending on whether he/she is connecting to a machine in the data</span>
        <span class="c">///</span><span class="c"> center or across a slow WAN.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Default: 3*60*1000 == 3minutes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeSpan</span> <a id="1c7eb8442453b9b7" href="../../../R/1c7eb8442453b9b7.html" target="n" data-glyph="102,1" class="i property">OperationTimeout</a> { <b>get</b>; <b>set</b>; } = <span class="i">TimeSpan</span>.<span class="i">FromMilliseconds</span>(<a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#21a6ee26ace3693f" class="i field">ClientDefaultOperationTimeoutMs</a>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies that no encryption will be used when doing remote operations over</span>
        <span class="c">///</span><span class="c"> http. Unencrypted traffic is not allowed by default and must be enabled in</span>
        <span class="c">///</span><span class="c"> the local configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="a684dcf48d8b8d3a" href="../../../R/a684dcf48d8b8d3a.html" target="n" data-glyph="102,1" class="i property">NoEncryption</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates the request is encoded in UTF16 format rather than UTF8 format;</span>
        <span class="c">///</span><span class="c"> UTF8 is the default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;UTF&quot;</span>)]
        <b>public bool</b> <a id="b584449b5c4b13fb" href="../../../R/b584449b5c4b13fb.html" target="n" data-glyph="102,1" class="i property">UseUTF16</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Uses Service Principal Name (SPN) along with the Port number during authentication.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SPN&quot;</span>)]
        <b>public bool</b> <a id="21aa0b34dea85206" href="../../../R/21aa0b34dea85206.html" target="n" data-glyph="102,1" class="i property">IncludePortInSPN</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines how server in disconnected state deals with cached output</span>
        <span class="c">///</span><span class="c"> data when the cache becomes filled.</span>
        <span class="c">///</span><span class="c"> Default value is &#39;block mode&#39; where command execution is blocked after</span>
        <span class="c">///</span><span class="c"> the server side data cache becomes filled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../common/RunspaceConnectionInfo.cs.html#9cb40ac520a09a1d" class="t t">OutputBufferingMode</a> <a id="0a36421122250739" href="../../../R/0a36421122250739.html" target="n" data-glyph="102,1" class="i property">OutputBufferingMode</a> { <b>get</b>; <b>set</b>; } = <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#b7ca59070aaef7b2" class="i field">DefaultOutputBufferingMode</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Number of times a connection will be re-attempted when a connection fails due to network</span>
        <span class="c">///</span><span class="c"> issues.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="0da743e6d3ee732d" href="../../../R/0da743e6d3ee732d.html" target="n" data-glyph="102,1" class="i property">MaxConnectionRetryCount</a> { <b>get</b>; <b>set</b>; } = <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#a48dd5dc791ed867" class="i field">DefaultMaxConnectionRetryCount</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Culture that the remote session should use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CultureInfo</span> <a id="6c50153de319204f" href="../../../R/6c50153de319204f.html" target="n" data-glyph="102,1" class="i property">Culture</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> UI culture that the remote session should use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CultureInfo</span> <a id="17de5256f95a13f0" href="../../../R/17de5256f95a13f0.html" target="n" data-glyph="102,1" class="i property">UICulture</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Total data (in bytes) that can be received from a remote machine</span>
        <span class="c">///</span><span class="c"> targeted towards a command. If null, then the size is unlimited.</span>
        <span class="c">///</span><span class="c"> Default is unlimited data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b>? <a id="fad12c194ba02bac" href="../../../R/fad12c194ba02bac.html" target="n" data-glyph="102,1" class="i property">MaximumReceivedDataSizePerCommand</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum size (in bytes) of a deserialized object received from a remote machine.</span>
        <span class="c">///</span><span class="c"> If null, then the size is unlimited. Default is 200MB object size.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b>? <a id="0587b36e63bc9ed4" href="../../../R/0587b36e63bc9ed4.html" target="n" data-glyph="102,1" class="i property">MaximumReceivedObjectSize</a> { <b>get</b>; <b>set</b>; } = 200 &lt;&lt; 20;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Application arguments the server can see in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>.<a href="../fanin/PSPrincipal.cs.html#fbb9c1201251c818" class="i property">ApplicationArguments</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="e85ec0b1616d3e82" href="../../../R/e85ec0b1616d3e82.html" target="n" data-glyph="102,1" class="i property">ApplicationArguments</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration for which PowerShell remoting waits before timing out on a connection to a remote machine.</span>
        <span class="c">///</span><span class="c"> Simply put, the timeout for a remote runspace creation.</span>
        <span class="c">///</span><span class="c"> The user would like to tweak this timeout depending on whether</span>
        <span class="c">///</span><span class="c"> he/she is connecting to a machine in the data center or across a slow WAN.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Default: 3 * 60 * 1000 = 3 minutes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeSpan</span> <a id="9a175c6e14dd145c" href="../../../R/9a175c6e14dd145c.html" target="n" data-glyph="102,1" class="i property">OpenTimeout</a> { <b>get</b>; <b>set</b>; } = <span class="i">TimeSpan</span>.<span class="i">FromMilliseconds</span>(<a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#9e72edbf25d16225" class="i field">DefaultOpenTimeout</a>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration for which PowerShell should wait before it times out on cancel operations</span>
        <span class="c">///</span><span class="c"> (close runspace or stop powershell). For instance, when the user hits ctrl-C,</span>
        <span class="c">///</span><span class="c"> New-PSSession cmdlet tries to call a stop on all remote runspaces which are in the Opening state.</span>
        <span class="c">///</span><span class="c"> The user wouldn&#39;t mind waiting for 15 seconds, but this should be time bound and of a shorter duration.</span>
        <span class="c">///</span><span class="c"> A high timeout here like 3 minutes will give the user a feeling that the PowerShell client is not responding.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Default: 60 * 1000 = 1 minute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeSpan</span> <a id="b5da140f3b9891e8" href="../../../R/b5da140f3b9891e8.html" target="n" data-glyph="102,1" class="i property">CancelTimeout</a> { <b>get</b>; <b>set</b>; } = <span class="i">TimeSpan</span>.<span class="i">FromMilliseconds</span>(<a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#4d69c2aded3f6ac6" class="i field">defaultCancelTimeout</a>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration for which a Runspace on server needs to wait before it declares the client dead and closes itself down.</span>
        <span class="c">///</span><span class="c"> This is especially important as these values may have to be configured differently for enterprise administration</span>
        <span class="c">///</span><span class="c"> and exchange scenarios.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Default: -1 -&gt; Use current server value for IdleTimeout.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TimeSpan</span> <a id="42111d69f31e90b0" href="../../../R/42111d69f31e90b0.html" target="n" data-glyph="102,1" class="i property">IdleTimeout</a> { <b>get</b>; <b>set</b>; } = <span class="i">TimeSpan</span>.<span class="i">FromMilliseconds</span>(<a href="../common/RunspaceConnectionInfo.cs.html#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#ccd4b365c71a8e3a" class="i field">DefaultIdleTimeout</a>);
    }
}
</pre></td></tr></table></div></body></html>
