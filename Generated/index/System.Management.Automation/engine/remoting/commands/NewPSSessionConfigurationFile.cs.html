<!DOCTYPE html>
<html><head><title>NewPSSessionConfigurationFile.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(2143);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/commands/NewPSSessionConfigurationFile.cs" target="_top">engine\remoting\commands\NewPSSessionConfigurationFile.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> New-PSSessionConfigurationFile command implementation</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> See Declarative Initial Session State (DISC)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../../utils/Verbs.cs.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="../../../utils/Verbs.cs.html#275f319554270c33" class="i field">New</a>, <span class="s">&quot;PSSessionConfigurationFile&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096791&quot;</span>)]
    <b>public class</b> <a id="cfd4d2a25793fd1e" href="../../../R/cfd4d2a25793fd1e.html" target="n" data-glyph="0,0" class="t t"><span id="5dbc45bfb6ac2782">NewPSSessionConfigurationFileCommand</span></a> : <a href="../../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Destination path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="9284febadd8f0d81" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#892eb6ab954ec6c0" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#892eb6ab954ec6c0" class="i field">_path</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="892eb6ab954ec6c0" href="../../../R/892eb6ab954ec6c0.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Configuration file schema version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">ValidateNotNull</span>]
        <b>public</b> <span class="i">Version</span> <a id="c6e7aec0ae8ba986" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SchemaVersion</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#011cfbe2c6dc5efc" class="i field">_schemaVersion</a>;
            }
 
            <b>set</b>
            {
                <a href="#011cfbe2c6dc5efc" class="i field">_schemaVersion</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="011cfbe2c6dc5efc" href="../../../R/011cfbe2c6dc5efc.html" target="n" data-glyph="46,1" class="i field">_schemaVersion</a> = <b>new</b> <span class="i">Version</span>(<span class="s">&quot;2.0.0.0&quot;</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Configuration file GUID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <span class="i">Guid</span> <a id="82d632bacc555984" href="../../../R/82d632bacc555984.html" target="n" data-glyph="102,1" class="i property">Guid</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ca2a2ce94b9fa2f5" class="i field">_guid</a>;
            }
 
            <b>set</b>
            {
                <a href="#ca2a2ce94b9fa2f5" class="i field">_guid</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Guid</span> <a id="ca2a2ce94b9fa2f5" href="../../../R/ca2a2ce94b9fa2f5.html" target="n" data-glyph="46,1" class="i field">_guid</a> = <a href="#82d632bacc555984" class="i property">Guid</a>.<span class="i">NewGuid</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Author of the configuration file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="989035af610e4dcf" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Author</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ed72b50715e174c2" class="i field">_author</a>;
            }
 
            <b>set</b>
            {
                <a href="#ed72b50715e174c2" class="i field">_author</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="ed72b50715e174c2" href="../../../R/ed72b50715e174c2.html" target="n" data-glyph="46,1" class="i field">_author</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Description.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="af9837cf921bea4d" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Description</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#81efaffc49d3ad0d" class="i field">_description</a>;
            }
 
            <b>set</b>
            {
                <a href="#81efaffc49d3ad0d" class="i field">_description</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="81efaffc49d3ad0d" href="../../../R/81efaffc49d3ad0d.html" target="n" data-glyph="46,1" class="i field">_description</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Company name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="37bc99b18c2e0d71" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CompanyName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ec530335334c1a43" class="i field">_companyName</a>;
            }
 
            <b>set</b>
            {
                <a href="#ec530335334c1a43" class="i field">_companyName</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="ec530335334c1a43" href="../../../R/ec530335334c1a43.html" target="n" data-glyph="46,1" class="i field">_companyName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copyright information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="788526e60bb99823" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Copyright</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4acc06b18e7b5260" class="i field">_copyright</a>;
            }
 
            <b>set</b>
            {
                <a href="#4acc06b18e7b5260" class="i field">_copyright</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="4acc06b18e7b5260" href="../../../R/4acc06b18e7b5260.html" target="n" data-glyph="46,1" class="i field">_copyright</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies type of initial session state to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="../fanin/InitialSessionStateProvider.cs.html#193eb55ce6b6bb37" class="t t">SessionType</a> <a id="40bce109b0cf714b" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SessionType</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ef48627795565126" class="i field">_sessionType</a>;
            }
 
            <b>set</b>
            {
                <a href="#ef48627795565126" class="i field">_sessionType</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="../fanin/InitialSessionStateProvider.cs.html#193eb55ce6b6bb37" class="t t">SessionType</a> <a id="ef48627795565126" href="../../../R/ef48627795565126.html" target="n" data-glyph="46,1" class="i field">_sessionType</a> = <a href="../fanin/InitialSessionStateProvider.cs.html#193eb55ce6b6bb37" class="t t">SessionType</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#cf7ca89ea220b2f6" class="i field">Default</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the directory for transcripts to be placed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="aa54560fabd331ed" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">TranscriptDirectory</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#baa690e6924199c3" class="i field">_transcriptDirectory</a>;
            }
 
            <b>set</b>
            {
                <a href="#baa690e6924199c3" class="i field">_transcriptDirectory</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="baa690e6924199c3" href="../../../R/baa690e6924199c3.html" target="n" data-glyph="46,1" class="i field">_transcriptDirectory</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies whether to run this configuration under a virtual account.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="3ce455549bb28314" href="../../../R/3ce455549bb28314.html" target="n" data-glyph="102,1" class="i property">RunAsVirtualAccount</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies groups a virtual account is part of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="12df35ba0d0b3519" href="../../../R/12df35ba0d0b3519.html" target="n" data-glyph="102,1" class="i property">RunAsVirtualAccountGroups</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a User PSDrive in the session.</span>
        <span class="c">///</span><span class="c"> The User drive is used with Copy-Item for file transfer when the FileSystem provider is</span>
        <span class="c">///</span><span class="c"> not visible in the session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="8f107755e0293b49" href="../../../R/8f107755e0293b49.html" target="n" data-glyph="102,1" class="i property">MountUserDrive</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional parameter that specifies a maximum size in bytes for the User: drive created with the</span>
        <span class="c">///</span><span class="c"> MountUserDrive parameter.</span>
        <span class="c">///</span><span class="c"> If no maximum size is specified then the default drive maximum size is 50MB.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public long</b> <a id="5260dc64655daccb" href="../../../R/5260dc64655daccb.html" target="n" data-glyph="102,1" class="i property">UserDriveMaximumSize</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">// Temporarily removed until script input parameter validation is implemented.</span>
        <span class="c">/*
        /// &lt;summary&gt;
        /// Optional parameter that enforces script input parameter validation.  When specified all scripts
        /// run in the PSSession must have validation attributes to validate input data or an error is generated.
        /// If a MountUserDrive is specified for the PSSession then input parameter validation will be
        /// enabled automatically.
        /// &lt;/summary&gt;
        [Parameter()]
        public SwitchParameter EnforceInputParameterValidation { get; set; }
        */</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional parameter that specifies a Group Managed Service Account name in which the configuration</span>
        <span class="c">///</span><span class="c"> is run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="2a23476ede15533e" href="../../../R/2a23476ede15533e.html" target="n" data-glyph="102,1" class="i property">GroupManagedServiceAccount</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Scripts to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="36f145c935e1defc" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ScriptsToProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#abd6ab8a3bec433a" class="i field">_scriptsToProcess</a>;
            }
 
            <b>set</b>
            {
                <a href="#abd6ab8a3bec433a" class="i field">_scriptsToProcess</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="abd6ab8a3bec433a" href="../../../R/abd6ab8a3bec433a.html" target="n" data-glyph="46,1" class="i field">_scriptsToProcess</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Role definitions for this session configuration (Role name -&gt; Role capability)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span> <a id="107dd2afcf390706" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">RoleDefinitions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d765bf873e023bc5" class="i field">_roleDefinitions</a>;
            }
 
            <b>set</b>
            {
                <a href="#d765bf873e023bc5" class="i field">_roleDefinitions</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">IDictionary</span> <a id="d765bf873e023bc5" href="../../../R/d765bf873e023bc5.html" target="n" data-glyph="46,1" class="i field">_roleDefinitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies account groups that are membership requirements for this session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span> <a id="20fc5d59cdb8b8dc" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">RequiredGroups</a>
        {
            <b>get</b> { <b>return</b> <a href="#7f25c7df83354b3c" class="i field">_requiredGroups</a>; }
 
            <b>set</b> { <a href="#7f25c7df83354b3c" class="i field">_requiredGroups</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">IDictionary</span> <a id="7f25c7df83354b3c" href="../../../R/7f25c7df83354b3c.html" target="n" data-glyph="46,1" class="i field">_requiredGroups</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Language mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="27ba79bab0a697c7" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LanguageMode</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#44c9c4c0c0024653" class="i field">_languageMode</a>;
            }
 
            <b>set</b>
            {
                <a href="#44c9c4c0c0024653" class="i field">_languageMode</a> = <b>value</b>;
                <a href="#d59277d8dc880cc7" class="i field">_isLanguageModeSpecified</a> = <b>true</b>;
            }
        }
 
        <b>private</b> <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a> <a id="44c9c4c0c0024653" href="../../../R/44c9c4c0c0024653.html" target="n" data-glyph="46,1" class="i field">_languageMode</a> = <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../../SessionStatePublic.cs.html#a659f53717c16b4b" class="i field">NoLanguage</a>;
        <b>private bool</b> <a id="d59277d8dc880cc7" href="../../../R/d59277d8dc880cc7.html" target="n" data-glyph="46,1" class="i field">_isLanguageModeSpecified</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execution policy.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="../../../security/SecuritySupport.cs.html#73c2048fc177fabf" class="t t">ExecutionPolicy</a> <a id="3db57a4706c980d4" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ExecutionPolicy</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4b84baa349941a5d" class="i field">_executionPolicy</a>;
            }
 
            <b>set</b>
            {
                <a href="#4b84baa349941a5d" class="i field">_executionPolicy</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="../../../security/SecuritySupport.cs.html#73c2048fc177fabf" class="t t">ExecutionPolicy</a> <a id="4b84baa349941a5d" href="../../../R/4b84baa349941a5d.html" target="n" data-glyph="46,1" class="i field">_executionPolicy</a> = <a href="../../../security/SecuritySupport.cs.html#73c2048fc177fabf" class="t t">ExecutionPolicy</a>.<a href="../../../security/SecuritySupport.cs.html#650065d32fb5aa16" class="i field">Restricted</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <span class="i">Version</span> <a id="09a47ddbae1a7d26" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PowerShellVersion</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#713e6241cb00e4a5" class="i field">_powerShellVersion</a>;
            }
 
            <b>set</b>
            {
                <a href="#713e6241cb00e4a5" class="i field">_powerShellVersion</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Version</span> <a id="713e6241cb00e4a5" href="../../../R/713e6241cb00e4a5.html" target="n" data-glyph="46,1" class="i field">_powerShellVersion</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of modules to import.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="c71f04e8097ee744" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ModulesToImport</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#554d862fd799c921" class="i field">_modulesToImport</a>;
            }
 
            <b>set</b>
            {
                <a href="#554d862fd799c921" class="i field">_modulesToImport</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="554d862fd799c921" href="../../../R/554d862fd799c921.html" target="n" data-glyph="46,1" class="i field">_modulesToImport</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible aliases.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="8b15299828d17137" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleAliases</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ee80f5097f221b22" class="i field">_visibleAliases</a>;
            }
 
            <b>set</b>
            {
                <a href="#ee80f5097f221b22" class="i field">_visibleAliases</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="ee80f5097f221b22" href="../../../R/ee80f5097f221b22.html" target="n" data-glyph="46,1" class="i field">_visibleAliases</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="c82f3daf8b538f5a" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleCmdlets</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#544d671722da1984" class="i field">_visibleCmdlets</a>;
            }
 
            <b>set</b>
            {
                <a href="#544d671722da1984" class="i field">_visibleCmdlets</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="544d671722da1984" href="../../../R/544d671722da1984.html" target="n" data-glyph="46,1" class="i field">_visibleCmdlets</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible functions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="b3516d39e3b7e636" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleFunctions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e052e33adb8df879" class="i field">_visibleFunctions</a>;
            }
 
            <b>set</b>
            {
                <a href="#e052e33adb8df879" class="i field">_visibleFunctions</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="e052e33adb8df879" href="../../../R/e052e33adb8df879.html" target="n" data-glyph="46,1" class="i field">_visibleFunctions</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible external commands (scripts and applications)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="61f4e9546b679956" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleExternalCommands</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5686d4f05e1d1dbd" class="i field">_visibleExternalCommands</a>;
            }
 
            <b>set</b>
            {
                <a href="#5686d4f05e1d1dbd" class="i field">_visibleExternalCommands</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="5686d4f05e1d1dbd" href="../../../R/5686d4f05e1d1dbd.html" target="n" data-glyph="46,1" class="i field">_visibleExternalCommands</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="9bfc37beb1fee01f" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleProviders</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4746668e8319bb4f" class="i field">_visibleProviders</a>;
            }
 
            <b>set</b>
            {
                <a href="#4746668e8319bb4f" class="i field">_visibleProviders</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="4746668e8319bb4f" href="../../../R/4746668e8319bb4f.html" target="n" data-glyph="46,1" class="i field">_visibleProviders</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of aliases.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span>[] <a id="bd731405b5ac4844" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AliasDefinitions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4948f7121b111ab4" class="i field">_aliasDefinitions</a>;
            }
 
            <b>set</b>
            {
                <a href="#4948f7121b111ab4" class="i field">_aliasDefinitions</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">IDictionary</span>[] <a id="4948f7121b111ab4" href="../../../R/4948f7121b111ab4.html" target="n" data-glyph="46,1" class="i field">_aliasDefinitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of functions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span>[] <a id="c5baaeb3841dd11a" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FunctionDefinitions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8464ec6bdcd6baed" class="i field">_functionDefinitions</a>;
            }
 
            <b>set</b>
            {
                <a href="#8464ec6bdcd6baed" class="i field">_functionDefinitions</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">IDictionary</span>[] <a id="8464ec6bdcd6baed" href="../../../R/8464ec6bdcd6baed.html" target="n" data-glyph="46,1" class="i field">_functionDefinitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of variables.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b> <a id="7078923133cca495" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VariableDefinitions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5bb2c34a435f4522" class="i field">_variableDefinitions</a>;
            }
 
            <b>set</b>
            {
                <a href="#5bb2c34a435f4522" class="i field">_variableDefinitions</a> = <b>value</b>;
            }
        }
 
        <b>private object</b> <a id="5bb2c34a435f4522" href="../../../R/5bb2c34a435f4522.html" target="n" data-glyph="46,1" class="i field">_variableDefinitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of environment variables.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span> <a id="82855b066163055d" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">EnvironmentVariables</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#aae9245c1b1e5f63" class="i field">_environmentVariables</a>;
            }
 
            <b>set</b>
            {
                <a href="#aae9245c1b1e5f63" class="i field">_environmentVariables</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">IDictionary</span> <a id="aae9245c1b1e5f63" href="../../../R/aae9245c1b1e5f63.html" target="n" data-glyph="46,1" class="i field">_environmentVariables</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of types to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="155cdf18dce3b20a" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">TypesToProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a0dd634452fb5cf9" class="i field">_typesToProcess</a>;
            }
 
            <b>set</b>
            {
                <a href="#a0dd634452fb5cf9" class="i field">_typesToProcess</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="a0dd634452fb5cf9" href="../../../R/a0dd634452fb5cf9.html" target="n" data-glyph="46,1" class="i field">_typesToProcess</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of format data to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="beb0872de9a1cb14" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FormatsToProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f54ad5cad278462e" class="i field">_formatsToProcess</a>;
            }
 
            <b>set</b>
            {
                <a href="#f54ad5cad278462e" class="i field">_formatsToProcess</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="f54ad5cad278462e" href="../../../R/f54ad5cad278462e.html" target="n" data-glyph="46,1" class="i field">_formatsToProcess</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of assemblies to load.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="93a267c6f4743c29" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AssembliesToLoad</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5b0bf189fc9818e7" class="i field">_assembliesToLoad</a>;
            }
 
            <b>set</b>
            {
                <a href="#5b0bf189fc9818e7" class="i field">_assembliesToLoad</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="5b0bf189fc9818e7" href="../../../R/5b0bf189fc9818e7.html" target="n" data-glyph="46,1" class="i field">_assembliesToLoad</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether to include a full expansion of all possible session configuration</span>
        <span class="c">///</span><span class="c"> keys as comments when creating the session configuration file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="c5fae2e90d336b61" href="../../../R/c5fae2e90d336b61.html" target="n" data-glyph="102,1" class="i property">Full</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="80ebed0de6f3ba29" href="../../../R/80ebed0de6f3ba29.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#892eb6ab954ec6c0" class="i field">_path</a>));
 
            <a href="../../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r0 rd" class="r0 r">provider</span> = <b>null</b>;
            <a href="../../DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r1 rd" class="r1 r">drive</span>;
            <b>string</b> <span id="r2 rd" class="r2 r">filePath</span> = <a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../../PathInterfaces.cs.html#89444ef2b32a4408" class="i method">GetUnresolvedProviderPathFromPSPath</a>(<a href="#892eb6ab954ec6c0" class="i field">_path</a>, <b>out</b> <span class="r0 r">provider</span>, <b>out</b> <span class="r1 r">drive</span>);
 
            <b>if</b> (!<span class="r0 r">provider</span>.<a href="../../DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="../../ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>) || !<span class="r2 r">filePath</span>.<span class="i">EndsWith</span>(<a href="../../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../../SessionStateStrings.cs.html#f547328079c2f2df" class="i field">PowerShellDISCFileExtension</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>string</b> <span id="r3 rd" class="r3 r">message</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidPSSessionConfigurationFilePath</span>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>);
                <span class="i">InvalidOperationException</span> <span id="r4 rd" class="r4 r">ioe</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r3 r">message</span>);
                <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r5 rd" class="r5 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r4 r">ioe</span>, <span class="s">&quot;InvalidPSSessionConfigurationFilePath&quot;</span>,
                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>);
                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r5 r">er</span>);
            }
 
            <span class="i">FileStream</span> <span id="r6 rd" class="r6 r">fileStream</span>;
            <span class="i">StreamWriter</span> <span id="r7 rd" class="r7 r">streamWriter</span>;
            <span class="i">FileInfo</span> <span id="r8 rd" class="r8 r">readOnlyFileInfo</span>;
 
            <span class="c">// Now open the output file...</span>
            <a href="../../../utils/PathUtils.cs.html#fdaf75f786a21eb9" class="t t">PathUtils</a>.<a href="../../../utils/PathUtils.cs.html#87afbcf1303c2952" class="i method">MasterStreamOpen</a>(
                <a href="#cfd4d2a25793fd1e" class="k">this</a>,
                <span class="r2 r">filePath</span>,
                <a href="../../../utils/EncodingUtils.cs.html#60f6ffa4e5dbe760" class="t t">EncodingConversion</a>.<a href="../../../utils/EncodingUtils.cs.html#989ee95ae4eadcaa" class="i field">Unicode</a>,
                <span class="c">/* defaultEncoding */</span> <b>false</b>,
                <span class="c">/* Append */</span> <b>false</b>,
                <span class="c">/* Force */</span> <b>false</b>,
                <span class="c">/* NoClobber */</span> <b>false</b>,
                <b>out</b> <span class="r6 r">fileStream</span>,
                <b>out</b> <span class="r7 r">streamWriter</span>,
                <b>out</b> <span class="r8 r">readOnlyFileInfo</span>,
                <b>false</b>
            );
 
            <b>try</b>
            {
                <span class="i">StringBuilder</span> <span id="r9 rd" class="r9 r">result</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
                <span class="r9 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;@{&quot;</span>);
                <span class="r9 r">result</span>.<span class="i">Append</span>(<span class="r7 r">streamWriter</span>.<span class="i">NewLine</span>);
                <span class="r9 r">result</span>.<span class="i">Append</span>(<span class="r7 r">streamWriter</span>.<span class="i">NewLine</span>);
 
                <span class="c">// Schema version</span>
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#84e5760daabc0a94" class="i field">SchemaVersion</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCSchemaVersionComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">QuoteName</span>(<a href="#011cfbe2c6dc5efc" class="i field">_schemaVersion</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
 
                <span class="c">// Guid</span>
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#588d3101f5da21f7" class="i field">Guid</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCGUIDComment</span>, <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">QuoteName</span>(<a href="#ca2a2ce94b9fa2f5" class="i field">_guid</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
 
                <span class="c">// Author</span>
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#ed72b50715e174c2" class="i field">_author</a>))
                {
                    <a href="#ed72b50715e174c2" class="i field">_author</a> = <span class="i">Environment</span>.<span class="i">UserName</span>;
                }
 
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2033f34b09a6c367" class="i field">Author</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAuthorComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#ed72b50715e174c2" class="i field">_author</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
 
                <span class="c">// Description</span>
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#c88da021a0546383" class="i field">Description</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCDescriptionComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#81efaffc49d3ad0d" class="i field">_description</a>), <span class="r7 r">streamWriter</span>, <b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#81efaffc49d3ad0d" class="i field">_description</a>)));
 
                <span class="c">// Company name</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;CompanyName&quot;</span>))
                {
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#ec530335334c1a43" class="i field">_companyName</a>))
                    {
                        <a href="#ec530335334c1a43" class="i field">_companyName</a> = <span class="i">Modules</span>.<span class="i">DefaultCompanyName</span>;
                    }
 
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2b7e6f2a40dd7273" class="i field">CompanyName</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCCompanyNameComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#ec530335334c1a43" class="i field">_companyName</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Copyright</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;Copyright&quot;</span>))
                {
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#4acc06b18e7b5260" class="i field">_copyright</a>))
                    {
                        <a href="#4acc06b18e7b5260" class="i field">_copyright</a> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">DefaultCopyrightMessage</span>, <a href="#ed72b50715e174c2" class="i field">_author</a>);
                    }
 
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#3aca92d1fa3fdcbf" class="i field">Copyright</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCCopyrightComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#4acc06b18e7b5260" class="i field">_copyright</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Session type</span>
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#a5bcbefb030c8e02" class="i field">SessionType</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCInitialSessionStateComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">QuoteName</span>(<a href="#ef48627795565126" class="i field">_sessionType</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
 
                <b>string</b> <span id="r10 rd" class="r10 r">resultData</span> = <b>null</b>;
 
                <span class="c">// Transcript directory</span>
                <span class="r10 r">resultData</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#baa690e6924199c3" class="i field">_transcriptDirectory</a>) ? <span class="s">&quot;&#39;C:\\Transcripts\\&#39;&quot;</span> : <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#baa690e6924199c3" class="i field">_transcriptDirectory</a>);
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#19b003dcfa5ad4bf" class="i field">TranscriptDirectory</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTranscriptDirectoryComment</span>,
                    <span class="r10 r">resultData</span>, <span class="r7 r">streamWriter</span>, <b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#baa690e6924199c3" class="i field">_transcriptDirectory</a>)));
 
                <span class="c">// Run as virtual account</span>
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#6113c4097d4973ff" class="i field">RunAsVirtualAccount</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCRunAsVirtualAccountComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#3beec01214d46e94" class="i method">WriteBoolean</a>(<b>true</b>), <span class="r7 r">streamWriter</span>, <a href="#3ce455549bb28314" class="i property">RunAsVirtualAccount</a> == <b>false</b>));
 
                <span class="c">// Run as virtual account groups</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;RunAsVirtualAccountGroups&quot;</span>))
                {
                    <b>bool</b> <span id="r11 rd" class="r11 r">haveVirtualAccountGroups</span> = (<a href="#12df35ba0d0b3519" class="i property">RunAsVirtualAccountGroups</a> != <b>null</b>) &amp;&amp; (<a href="#12df35ba0d0b3519" class="i property">RunAsVirtualAccountGroups</a>.<span class="i">Length</span> &gt; 0);
                    <span class="r10 r">resultData</span> = (<span class="r11 r">haveVirtualAccountGroups</span>) ? <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#12df35ba0d0b3519" class="i property">RunAsVirtualAccountGroups</a>) : <span class="s">&quot;&#39;Remote Desktop Users&#39;, &#39;Remote Management Users&#39;&quot;</span>;
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e724519e3a7dcc96" class="i field">RunAsVirtualAccountGroups</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCRunAsVirtualAccountGroupsComment</span>,
                        <span class="r10 r">resultData</span>, <span class="r7 r">streamWriter</span>, !<span class="r11 r">haveVirtualAccountGroups</span>));
                }
 
                <span class="c">// Mount user drive</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;MountUserDrive&quot;</span>))
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#6004ce4c39182bad" class="i field">MountUserDrive</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCMountUserDriveComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#3beec01214d46e94" class="i method">WriteBoolean</a>(<b>true</b>), <span class="r7 r">streamWriter</span>, <a href="#8f107755e0293b49" class="i property">MountUserDrive</a> == <b>false</b>));
                }
 
                <span class="c">// User drive maximum size</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;UserDriveMaximumSize&quot;</span>))
                {
                    <b>long</b> <span id="r12 rd" class="r12 r">userDriveMaxSize</span> = (<a href="#5260dc64655daccb" class="i property">UserDriveMaximumSize</a> &gt; 0) ? <a href="#5260dc64655daccb" class="i property">UserDriveMaximumSize</a> : 50000000;
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#f44aa5ddaba24fbd" class="i field">UserDriveMaxSize</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCUserDriveMaxSizeComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#bddc10ef780a71df" class="i method">WriteLong</a>(<span class="r12 r">userDriveMaxSize</span>), <span class="r7 r">streamWriter</span>, (<a href="#5260dc64655daccb" class="i property">UserDriveMaximumSize</a> &lt;= 0)));
                }
 
                <span class="c">// Temporarily removed until script input parameter validation is implemented.</span>
                <span class="c">/*
                // Enforce input parameter validation
                result.Append(SessionConfigurationUtils.ConfigFragment(ConfigFileConstants.EnforceInputParameterValidation, RemotingErrorIdStrings.DISCEnforceInputParameterValidation,
                    SessionConfigurationUtils.WriteBoolean(true), streamWriter, EnforceInputParameterValidation == false));
                */</span>
 
                <span class="c">// Group Managed Service Account Name</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;GroupManagedServiceAccount&quot;</span>))
                {
                    <b>bool</b> <span id="r13 rd" class="r13 r">haveGMSAAccountName</span> = !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#2a23476ede15533e" class="i property">GroupManagedServiceAccount</a>);
                    <span class="r10 r">resultData</span> = (!<span class="r13 r">haveGMSAAccountName</span>) ? <span class="s">&quot;&#39;CONTOSO\\GroupManagedServiceAccount&#39;&quot;</span> : <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#2a23476ede15533e" class="i property">GroupManagedServiceAccount</a>);
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#8b4e61e9c62fdd9b" class="i field">GMSAAccount</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCGMSAComment</span>,
                        <span class="r10 r">resultData</span>, <span class="r7 r">streamWriter</span>, !<span class="r13 r">haveGMSAAccountName</span>));
                }
 
                <span class="c">// Scripts to process</span>
                <span class="r10 r">resultData</span> = (<a href="#abd6ab8a3bec433a" class="i field">_scriptsToProcess</a>.<span class="i">Length</span> &gt; 0) ? <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#abd6ab8a3bec433a" class="i field">_scriptsToProcess</a>) : <span class="s">&quot;&#39;C:\\ConfigData\\InitScript1.ps1&#39;, &#39;C:\\ConfigData\\InitScript2.ps1&#39;&quot;</span>;
                <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9a5653ee028fb1fc" class="i field">ScriptsToProcess</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCScriptsToProcessComment</span>,
                    <span class="r10 r">resultData</span>, <span class="r7 r">streamWriter</span>, (<a href="#abd6ab8a3bec433a" class="i field">_scriptsToProcess</a>.<span class="i">Length</span> == 0)));
 
                <span class="c">// Role definitions</span>
                <b>if</b> (<a href="#d765bf873e023bc5" class="i field">_roleDefinitions</a> == <b>null</b>)
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#046aa0715b0841ad" class="i field">RoleDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCRoleDefinitionsComment</span>,
                        <span class="s">&quot;@{ &#39;CONTOSO\\SqlAdmins&#39; = @{ RoleCapabilities = &#39;SqlAdministration&#39; }; &#39;CONTOSO\\SqlManaged&#39; = @{ RoleCapabilityFiles = &#39;C:\\RoleCapability\\SqlManaged.psrc&#39; }; &#39;CONTOSO\\ServerMonitors&#39; = @{ VisibleCmdlets = &#39;Get-Process&#39; } } &quot;</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <a href="../fanin/InitialSessionStateProvider.cs.html#78aacc47ea72f6a8" class="t t">DISCUtils</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#8cc5075d2c9e9c19" class="i method">ValidateRoleDefinitions</a>(<a href="#d765bf873e023bc5" class="i field">_roleDefinitions</a>);
 
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#046aa0715b0841ad" class="i field">RoleDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCRoleDefinitionsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#624dde663fd9a482" class="i method">CombineHashtable</a>(<a href="#d765bf873e023bc5" class="i field">_roleDefinitions</a>, <span class="r7 r">streamWriter</span>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Required groups</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;RequiredGroups&quot;</span>))
                {
                    <b>if</b> (<a href="#7f25c7df83354b3c" class="i field">_requiredGroups</a> == <b>null</b>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#791957e7bb634869" class="i field">RequiredGroups</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCRequiredGroupsComment</span>,
                            <span class="s">&quot;@{ And = @{ Or = &#39;CONTOSO\\SmartCard-Logon1&#39;, &#39;CONTOSO\\SmartCard-Logon2&#39; }, &#39;Administrators&#39; }&quot;</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                    <b>else</b>
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#791957e7bb634869" class="i field">RequiredGroups</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCRequiredGroupsComment</span>,
                            <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#1e908c79b79b4d39" class="i method">CombineRequiredGroupsHash</a>(<a href="#7f25c7df83354b3c" class="i field">_requiredGroups</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                    }
                }
 
                <span class="c">// PSLanguageMode languageMode</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;LanguageMode&quot;</span>))
                {
                    <b>if</b> (!<a href="#d59277d8dc880cc7" class="i field">_isLanguageModeSpecified</a>)
                    {
                        <b>if</b> (<a href="#ef48627795565126" class="i field">_sessionType</a> == <a href="../fanin/InitialSessionStateProvider.cs.html#193eb55ce6b6bb37" class="t t">SessionType</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#cf7ca89ea220b2f6" class="i field">Default</a>)
                        {
                            <a href="#44c9c4c0c0024653" class="i field">_languageMode</a> = <a href="../../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../../SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
                        }
                    }
 
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#cd52cc01a19f4a84" class="i field">LanguageMode</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCLanguageModeComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">QuoteName</span>(<a href="#44c9c4c0c0024653" class="i field">_languageMode</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// ExecutionPolicy executionPolicy</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;ExecutionPolicy&quot;</span>))
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#50f99a9a999d54d8" class="i field">ExecutionPolicy</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCExecutionPolicyComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">QuoteName</span>(<a href="#4b84baa349941a5d" class="i field">_executionPolicy</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// PowerShell version</span>
                <b>bool</b> <span id="r14 rd" class="r14 r">isExample</span> = <b>false</b>;
 
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;PowerShellVersion&quot;</span>))
                {
                    <b>if</b> (<a href="#713e6241cb00e4a5" class="i field">_powerShellVersion</a> == <b>null</b>)
                    {
                        <span class="r14 r">isExample</span> = <b>true</b>;
                        <a href="#713e6241cb00e4a5" class="i field">_powerShellVersion</a> = <a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#ad63365ac7690eeb" class="i property">PSVersion</a>;
                    }
 
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5b521e31e7f3529" class="i field">PowerShellVersion</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCPowerShellVersionComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">QuoteName</span>(<a href="#713e6241cb00e4a5" class="i field">_powerShellVersion</a>), <span class="r7 r">streamWriter</span>, <span class="r14 r">isExample</span>));
                }
 
                <span class="c">// Modules to import</span>
                <b>if</b> (<a href="#554d862fd799c921" class="i field">_modulesToImport</a> == <b>null</b>)
                {
                    <b>if</b> (<a href="#c5fae2e90d336b61" class="i property">Full</a>)
                    {
                        <b>const string</b> <span id="r15 rd" class="r15 r">exampleModulesToImport</span> = <span class="s">&quot;&#39;MyCustomModule&#39;, @{ ModuleName = &#39;MyCustomModule&#39;; ModuleVersion = &#39;1.0.0.0&#39;; GUID = &#39;4d30d5f0-cb16-4898-812d-f20a6c596bdf&#39; }&quot;</span>;
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#815af157370a682b" class="i field">ModulesToImport</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCModulesToImportComment</span>, <span class="r15 r">exampleModulesToImport</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                }
                <b>else</b>
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#815af157370a682b" class="i field">ModulesToImport</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCModulesToImportComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#8712474c70e1b5d1" class="i method">CombineHashTableOrStringArray</a>(<a href="#554d862fd799c921" class="i field">_modulesToImport</a>, <span class="r7 r">streamWriter</span>, <a href="#cfd4d2a25793fd1e" class="k">this</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Visible aliases</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;VisibleAliases&quot;</span>))
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#3ae92ee7773a9e6a" class="i field">VisibleAliases</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleAliasesComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">GetVisibilityDefault</span>(<a href="#ee80f5097f221b22" class="i field">_visibleAliases</a>, <span class="r7 r">streamWriter</span>, <a href="#cfd4d2a25793fd1e" class="k">this</a>), <span class="r7 r">streamWriter</span>, <a href="#ee80f5097f221b22" class="i field">_visibleAliases</a>.<span class="i">Length</span> == 0));
                }
 
                <span class="c">// Visible cmdlets</span>
                <b>if</b> ((<a href="#544d671722da1984" class="i field">_visibleCmdlets</a> == <b>null</b>) || (<a href="#544d671722da1984" class="i field">_visibleCmdlets</a>.<span class="i">Length</span> == 0))
                {
                    <b>if</b> (<a href="#c5fae2e90d336b61" class="i property">Full</a>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#f35a94fa18c56045" class="i field">VisibleCmdlets</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleCmdletsComment</span>,
                            <span class="s">&quot;&#39;Invoke-Cmdlet1&#39;, @{ Name = &#39;Invoke-Cmdlet2&#39;; Parameters = @{ Name = &#39;Parameter1&#39;; ValidateSet = &#39;Item1&#39;, &#39;Item2&#39; }, @{ Name = &#39;Parameter2&#39;; ValidatePattern = &#39;L*&#39; } }&quot;</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                }
                <b>else</b>
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#f35a94fa18c56045" class="i field">VisibleCmdlets</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleCmdletsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#89a631fd3b18ff65" class="i method">GetVisibilityDefault</a>(<a href="#544d671722da1984" class="i field">_visibleCmdlets</a>, <span class="r7 r">streamWriter</span>, <a href="#cfd4d2a25793fd1e" class="k">this</a>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Visible functions</span>
                <b>if</b> ((<a href="#e052e33adb8df879" class="i field">_visibleFunctions</a> == <b>null</b>) || (<a href="#e052e33adb8df879" class="i field">_visibleFunctions</a>.<span class="i">Length</span> == 0))
                {
                    <b>if</b> (<a href="#c5fae2e90d336b61" class="i property">Full</a>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#6a2144eb8017892d" class="i field">VisibleFunctions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleFunctionsComment</span>,
                            <span class="s">&quot;&#39;Invoke-Function1&#39;, @{ Name = &#39;Invoke-Function2&#39;; Parameters = @{ Name = &#39;Parameter1&#39;; ValidateSet = &#39;Item1&#39;, &#39;Item2&#39; }, @{ Name = &#39;Parameter2&#39;; ValidatePattern = &#39;L*&#39; } }&quot;</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                }
                <b>else</b>
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#6a2144eb8017892d" class="i field">VisibleFunctions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleFunctionsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#89a631fd3b18ff65" class="i method">GetVisibilityDefault</a>(<a href="#e052e33adb8df879" class="i field">_visibleFunctions</a>, <span class="r7 r">streamWriter</span>, <a href="#cfd4d2a25793fd1e" class="k">this</a>), <span class="r7 r">streamWriter</span>, <a href="#e052e33adb8df879" class="i field">_visibleFunctions</a>.<span class="i">Length</span> == 0));
                }
 
                <span class="c">// Visible external commands (scripts, executables)</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;VisibleExternalCommands&quot;</span>))
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#691bb9c10d14bdef" class="i field">VisibleExternalCommands</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleExternalCommandsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">GetVisibilityDefault</span>(<a href="#5686d4f05e1d1dbd" class="i field">_visibleExternalCommands</a>, <span class="r7 r">streamWriter</span>, <a href="#cfd4d2a25793fd1e" class="k">this</a>), <span class="r7 r">streamWriter</span>, <a href="#5686d4f05e1d1dbd" class="i field">_visibleExternalCommands</a>.<span class="i">Length</span> == 0));
                }
 
                <span class="c">// Visible providers</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;VisibleProviders&quot;</span>))
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#4187c2fa3d874c86" class="i field">VisibleProviders</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleProvidersComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">GetVisibilityDefault</span>(<a href="#4746668e8319bb4f" class="i field">_visibleProviders</a>, <span class="r7 r">streamWriter</span>, <a href="#cfd4d2a25793fd1e" class="k">this</a>), <span class="r7 r">streamWriter</span>, <a href="#4746668e8319bb4f" class="i field">_visibleProviders</a>.<span class="i">Length</span> == 0));
                }
 
                <span class="c">// Alias definitions</span>
                <b>if</b> ((<a href="#4948f7121b111ab4" class="i field">_aliasDefinitions</a> == <b>null</b>) || (<a href="#4948f7121b111ab4" class="i field">_aliasDefinitions</a>.<span class="i">Length</span> == 0))
                {
                    <b>if</b> (<a href="#c5fae2e90d336b61" class="i property">Full</a>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#c5bd5765181feeac" class="i field">AliasDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAliasDefinitionsComment</span>,
                           <span class="s">&quot;@{ Name = &#39;Alias1&#39;; Value = &#39;Invoke-Alias1&#39;}, @{ Name = &#39;Alias2&#39;; Value = &#39;Invoke-Alias2&#39;}&quot;</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                }
                <b>else</b>
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#c5bd5765181feeac" class="i field">AliasDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAliasDefinitionsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#6e8582d139dcb33d" class="i method">CombineHashtableArray</a>(<a href="#4948f7121b111ab4" class="i field">_aliasDefinitions</a>, <span class="r7 r">streamWriter</span>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Function definitions</span>
                <b>if</b> (<a href="#8464ec6bdcd6baed" class="i field">_functionDefinitions</a> == <b>null</b>)
                {
                    <b>if</b> (<a href="#c5fae2e90d336b61" class="i property">Full</a>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCFunctionDefinitionsComment</span>,
                            <span class="s">&quot;@{ Name = &#39;MyFunction&#39;; ScriptBlock = { param($MyInput) $MyInput } }&quot;</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                }
                <b>else</b>
                {
                    <span class="i">Hashtable</span>[] <span id="r16 rd" class="r16 r">funcHash</span> = <a href="../fanin/InitialSessionStateProvider.cs.html#fc3ecbf6d041a5ca" class="t t">DISCPowerShellConfiguration</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b24ebadf5f6d939f" class="i method">TryGetHashtableArray</a>(<a href="#8464ec6bdcd6baed" class="i field">_functionDefinitions</a>);
 
                    <b>if</b> (<span class="r16 r">funcHash</span> != <b>null</b>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCFunctionDefinitionsComment</span>,
                            <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">CombineHashtableArray</span>(<span class="r16 r">funcHash</span>, <span class="r7 r">streamWriter</span>), <span class="r7 r">streamWriter</span>, <b>false</b>));
 
                        <b>foreach</b> (<span class="i">Hashtable</span> <span id="r17 rd" class="r17 r">hashtable</span> <b>in</b> <span class="r16 r">funcHash</span>)
                        {
                            <b>if</b> (!<span class="r17 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#79c9e3e4f7f31db1" class="i field">FunctionNameToken</a>))
                            {
                                <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r18 rd" class="r18 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                    <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#79c9e3e4f7f31db1" class="i field">FunctionNameToken</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>));
                                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r18 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                            }
 
                            <b>if</b> (!<span class="r17 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>))
                            {
                                <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r19 rd" class="r19 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                    <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>));
                                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r19 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                            }
 
                            <b>if</b> (<span class="r17 r">hashtable</span>[<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>] <b>is not</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)
                            {
                                <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r20 rd" class="r20 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCKeyMustBeScriptBlock</span>,
                                    <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>));
                                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r20 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                            }
 
                            <b>foreach</b> (<b>string</b> <span id="r21 rd" class="r21 r">functionKey</span> <b>in</b> <span class="r17 r">hashtable</span>.<span class="i">Keys</span>)
                            {
                                <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r21 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#79c9e3e4f7f31db1" class="i field">FunctionNameToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                                    !<b>string</b>.<span class="i">Equals</span>(<span class="r21 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                                    !<b>string</b>.<span class="i">Equals</span>(<span class="r21 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#f3b742e57550f9ad" class="i field">FunctionOptionsToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r22 rd" class="r22 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeContainsInvalidKey</span>,
                                        <span class="r21 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>));
                                    <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r22 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                }
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r23 rd" class="r23 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustBeHashtableArray</span>,
                            <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <span class="r2 r">filePath</span>));
                        <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r23 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                    }
                }
 
                <span class="c">// Variable definitions</span>
                <b>if</b> (<a href="#5bb2c34a435f4522" class="i field">_variableDefinitions</a> == <b>null</b>)
                {
                    <b>if</b> (<a href="#c5fae2e90d336b61" class="i property">Full</a>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVariableDefinitionsComment</span>,
                            <span class="s">&quot;@{ Name = &#39;Variable1&#39;; Value = { &#39;Dynamic&#39; + &#39;InitialValue&#39; } }, @{ Name = &#39;Variable2&#39;; Value = &#39;StaticInitialValue&#39; }&quot;</span>, <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                }
                <b>else</b>
                {
                    <b>string</b> <span id="r24 rd" class="r24 r">varString</span> = <a href="#5bb2c34a435f4522" class="i field">_variableDefinitions</a> <b>as string</b>;
 
                    <b>if</b> (<span class="r24 r">varString</span> != <b>null</b>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVariableDefinitionsComment</span>,
                            <span class="r24 r">varString</span>, <span class="r7 r">streamWriter</span>, <b>false</b>));
                    }
                    <b>else</b>
                    {
                        <span class="i">Hashtable</span>[] <span id="r25 rd" class="r25 r">varHash</span> = <a href="../fanin/InitialSessionStateProvider.cs.html#fc3ecbf6d041a5ca" class="t t">DISCPowerShellConfiguration</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b24ebadf5f6d939f" class="i method">TryGetHashtableArray</a>(<a href="#5bb2c34a435f4522" class="i field">_variableDefinitions</a>);
 
                        <b>if</b> (<span class="r25 r">varHash</span> != <b>null</b>)
                        {
                            <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVariableDefinitionsComment</span>,
                                <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">CombineHashtableArray</span>(<span class="r25 r">varHash</span>, <span class="r7 r">streamWriter</span>), <span class="r7 r">streamWriter</span>, <b>false</b>));
 
                            <b>foreach</b> (<span class="i">Hashtable</span> <span id="r26 rd" class="r26 r">hashtable</span> <b>in</b> <span class="r25 r">varHash</span>)
                            {
                                <b>if</b> (!<span class="r26 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2de830f08f62b5e6" class="i field">VariableNameToken</a>))
                                {
                                    <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r27 rd" class="r27 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                        <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2de830f08f62b5e6" class="i field">VariableNameToken</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>));
                                    <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r27 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                }
 
                                <b>if</b> (!<span class="r26 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9bd2b3372dcf4d80" class="i field">VariableValueToken</a>))
                                {
                                    <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r28 rd" class="r28 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                        <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9bd2b3372dcf4d80" class="i field">VariableValueToken</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>));
                                    <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r28 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                }
 
                                <b>foreach</b> (<b>string</b> <span id="r29 rd" class="r29 r">variableKey</span> <b>in</b> <span class="r26 r">hashtable</span>.<span class="i">Keys</span>)
                                {
                                    <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r29 r">variableKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2de830f08f62b5e6" class="i field">VariableNameToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                                        !<b>string</b>.<span class="i">Equals</span>(<span class="r29 r">variableKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9bd2b3372dcf4d80" class="i field">VariableValueToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r30 rd" class="r30 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeContainsInvalidKey</span>,
                                            <span class="r29 r">variableKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <a href="#892eb6ab954ec6c0" class="i field">_path</a>));
                                        <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r30 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                    }
                                }
                            }
                        }
                        <b>else</b>
                        {
                            <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r31 rd" class="r31 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustBeHashtableArray</span>,
                                <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="r2 r">filePath</span>));
                            <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r31 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                        }
                    }
                }
 
                <span class="c">// Environment variables</span>
                <b>if</b> (<a href="#aae9245c1b1e5f63" class="i field">_environmentVariables</a> == <b>null</b>)
                {
                    <b>if</b> (<a href="#c5fae2e90d336b61" class="i property">Full</a>)
                    {
                        <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#bd6ddd7c2df83736" class="i field">EnvironmentVariables</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCEnvironmentVariablesComment</span>,
                            <span class="s">&quot;@{ Variable1 = &#39;Value1&#39;; Variable2 = &#39;Value2&#39; }&quot;</span>,
                            <span class="r7 r">streamWriter</span>, <b>true</b>));
                    }
                }
                <b>else</b>
                {
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#bd6ddd7c2df83736" class="i field">EnvironmentVariables</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCEnvironmentVariablesComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#624dde663fd9a482" class="i method">CombineHashtable</a>(<a href="#aae9245c1b1e5f63" class="i field">_environmentVariables</a>, <span class="r7 r">streamWriter</span>), <span class="r7 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Types to process</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;TypesToProcess&quot;</span>))
                {
                    <span class="r10 r">resultData</span> = (<a href="#a0dd634452fb5cf9" class="i field">_typesToProcess</a>.<span class="i">Length</span> &gt; 0) ? <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#a0dd634452fb5cf9" class="i field">_typesToProcess</a>) : <span class="s">&quot;&#39;C:\\ConfigData\\MyTypes.ps1xml&#39;, &#39;C:\\ConfigData\\OtherTypes.ps1xml&#39;&quot;</span>;
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#1a3b227af34ff440" class="i field">TypesToProcess</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypesToProcessComment</span>,
                        <span class="r10 r">resultData</span>, <span class="r7 r">streamWriter</span>, (<a href="#a0dd634452fb5cf9" class="i field">_typesToProcess</a>.<span class="i">Length</span> == 0)));
                }
 
                <span class="c">// Formats to process</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;FormatsToProcess&quot;</span>))
                {
                    <span class="r10 r">resultData</span> = (<a href="#f54ad5cad278462e" class="i field">_formatsToProcess</a>.<span class="i">Length</span> &gt; 0) ? <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#f54ad5cad278462e" class="i field">_formatsToProcess</a>) : <span class="s">&quot;&#39;C:\\ConfigData\\MyFormats.ps1xml&#39;, &#39;C:\\ConfigData\\OtherFormats.ps1xml&#39;&quot;</span>;
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#22f6487e5a94de7f" class="i field">FormatsToProcess</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCFormatsToProcessComment</span>,
                        <span class="r10 r">resultData</span>, <span class="r7 r">streamWriter</span>, (<a href="#f54ad5cad278462e" class="i field">_formatsToProcess</a>.<span class="i">Length</span> == 0)));
                }
 
                <span class="c">// Assemblies to load</span>
                <b>if</b> (<a href="#6b5bf585cba9de99" class="i method">ShouldGenerateConfigurationSnippet</a>(<span class="s">&quot;AssembliesToLoad&quot;</span>))
                {
                    <span class="r14 r">isExample</span> = <b>false</b>;
                    <b>if</b> ((<a href="#5b0bf189fc9818e7" class="i field">_assembliesToLoad</a> == <b>null</b>) || (<a href="#5b0bf189fc9818e7" class="i field">_assembliesToLoad</a>.<span class="i">Length</span> == 0))
                    {
                        <span class="r14 r">isExample</span> = <b>true</b>;
                        <a href="#5b0bf189fc9818e7" class="i field">_assembliesToLoad</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;System.Web&quot;</span>, <span class="s">&quot;System.OtherAssembly, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;</span> };
                    }
 
                    <span class="r9 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#681f01148717d80f" class="i field">AssembliesToLoad</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAssembliesToLoadComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#5b0bf189fc9818e7" class="i field">_assembliesToLoad</a>), <span class="r7 r">streamWriter</span>, <span class="r14 r">isExample</span>));
                }
 
                <span class="r9 r">result</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
 
                <span class="r7 r">streamWriter</span>.<span class="i">Write</span>(<span class="r9 r">result</span>.<span class="i">ToString</span>());
            }
            <b>finally</b>
            {
                <span class="r7 r">streamWriter</span>.<span class="i">Dispose</span>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private methods
 
        <b>private bool</b> <a id="6b5bf585cba9de99" href="../../../R/6b5bf585cba9de99.html" target="n" data-glyph="76,1" class="i method">ShouldGenerateConfigurationSnippet</a>(<b>string</b> <span id="r32 rd" class="r32 r">parameterName</span>)
        {
            <b>return</b> <a href="#c5fae2e90d336b61" class="i property">Full</a> || <a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<span class="r32 r">parameterName</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> New-PSRoleCapabilityFile command implementation</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Creates a role capability file suitable for use in a Role Capability (which can be referenced in a Session Configuration file)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../../utils/Verbs.cs.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="../../../utils/Verbs.cs.html#275f319554270c33" class="i field">New</a>, <span class="s">&quot;PSRoleCapabilityFile&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkId=623708&quot;</span>)]
    <b>public class</b> <a id="da112121e325c8ff" href="../../../R/da112121e325c8ff.html" target="n" data-glyph="0,0" class="t t"><span id="118ddf1672110d45">NewPSRoleCapabilityFileCommand</span></a> : <a href="../../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Destination path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="94cab0c331265201" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#287936bd2b81f470" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#287936bd2b81f470" class="i field">_path</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="287936bd2b81f470" href="../../../R/287936bd2b81f470.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Configuration file GUID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <span class="i">Guid</span> <a id="a162a613db2cceea" href="../../../R/a162a613db2cceea.html" target="n" data-glyph="102,1" class="i property">Guid</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3a5bdf1a161270bd" class="i field">_guid</a>;
            }
 
            <b>set</b>
            {
                <a href="#3a5bdf1a161270bd" class="i field">_guid</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Guid</span> <a id="3a5bdf1a161270bd" href="../../../R/3a5bdf1a161270bd.html" target="n" data-glyph="46,1" class="i field">_guid</a> = <a href="#a162a613db2cceea" class="i property">Guid</a>.<span class="i">NewGuid</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Author of the configuration file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="6c1bed79a39770dd" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Author</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#63a9f74ee531a722" class="i field">_author</a>;
            }
 
            <b>set</b>
            {
                <a href="#63a9f74ee531a722" class="i field">_author</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="63a9f74ee531a722" href="../../../R/63a9f74ee531a722.html" target="n" data-glyph="46,1" class="i field">_author</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Description.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="b26113631f0bbeee" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Description</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c0943153533b3e80" class="i field">_description</a>;
            }
 
            <b>set</b>
            {
                <a href="#c0943153533b3e80" class="i field">_description</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="c0943153533b3e80" href="../../../R/c0943153533b3e80.html" target="n" data-glyph="46,1" class="i field">_description</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Company name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="a7ef338ead9da261" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CompanyName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9df654a264b6e06e" class="i field">_companyName</a>;
            }
 
            <b>set</b>
            {
                <a href="#9df654a264b6e06e" class="i field">_companyName</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="9df654a264b6e06e" href="../../../R/9df654a264b6e06e.html" target="n" data-glyph="46,1" class="i field">_companyName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copyright information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public string</b> <a id="f9eb791848384ec3" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Copyright</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#686d335e2bb10e6b" class="i field">_copyright</a>;
            }
 
            <b>set</b>
            {
                <a href="#686d335e2bb10e6b" class="i field">_copyright</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="686d335e2bb10e6b" href="../../../R/686d335e2bb10e6b.html" target="n" data-glyph="46,1" class="i field">_copyright</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of modules to import.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="532ca79fe9d09928" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ModulesToImport</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#386d5686e09589a1" class="i field">_modulesToImport</a>;
            }
 
            <b>set</b>
            {
                <a href="#386d5686e09589a1" class="i field">_modulesToImport</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="386d5686e09589a1" href="../../../R/386d5686e09589a1.html" target="n" data-glyph="46,1" class="i field">_modulesToImport</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible aliases.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="71afbe400fd89640" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleAliases</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9b9ee94d96594d5e" class="i field">_visibleAliases</a>;
            }
 
            <b>set</b>
            {
                <a href="#9b9ee94d96594d5e" class="i field">_visibleAliases</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="9b9ee94d96594d5e" href="../../../R/9b9ee94d96594d5e.html" target="n" data-glyph="46,1" class="i field">_visibleAliases</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="a7e14f3d1b7dbed3" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleCmdlets</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#feda17c4b286cc20" class="i field">_visibleCmdlets</a>;
            }
 
            <b>set</b>
            {
                <a href="#feda17c4b286cc20" class="i field">_visibleCmdlets</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="feda17c4b286cc20" href="../../../R/feda17c4b286cc20.html" target="n" data-glyph="46,1" class="i field">_visibleCmdlets</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible functions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="7f7816782edbe543" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleFunctions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#b7171eaaabd9e519" class="i field">_visibleFunctions</a>;
            }
 
            <b>set</b>
            {
                <a href="#b7171eaaabd9e519" class="i field">_visibleFunctions</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="b7171eaaabd9e519" href="../../../R/b7171eaaabd9e519.html" target="n" data-glyph="46,1" class="i field">_visibleFunctions</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of visible external commands (scripts and applications)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="33fca012dc73cf52" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleExternalCommands</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f42cd74785f948c6" class="i field">_visibleExternalCommands</a>;
            }
 
            <b>set</b>
            {
                <a href="#f42cd74785f948c6" class="i field">_visibleExternalCommands</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="f42cd74785f948c6" href="../../../R/f42cd74785f948c6.html" target="n" data-glyph="46,1" class="i field">_visibleExternalCommands</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="742f8b544edb8852" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VisibleProviders</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5f37b1baa00784dd" class="i field">_visibleProviders</a>;
            }
 
            <b>set</b>
            {
                <a href="#5f37b1baa00784dd" class="i field">_visibleProviders</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="5f37b1baa00784dd" href="../../../R/5f37b1baa00784dd.html" target="n" data-glyph="46,1" class="i field">_visibleProviders</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Scripts to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="1c1e5c117b9b6d54" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ScriptsToProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d9420d84334317cf" class="i field">_scriptsToProcess</a>;
            }
 
            <b>set</b>
            {
                <a href="#d9420d84334317cf" class="i field">_scriptsToProcess</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="d9420d84334317cf" href="../../../R/d9420d84334317cf.html" target="n" data-glyph="46,1" class="i field">_scriptsToProcess</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of aliases.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span>[] <a id="962f29034b664c73" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AliasDefinitions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a811b87853723383" class="i field">_aliasDefinitions</a>;
            }
 
            <b>set</b>
            {
                <a href="#a811b87853723383" class="i field">_aliasDefinitions</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">IDictionary</span>[] <a id="a811b87853723383" href="../../../R/a811b87853723383.html" target="n" data-glyph="46,1" class="i field">_aliasDefinitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of functions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span>[] <a id="7eacf8da5693817d" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FunctionDefinitions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#483ccd476fd23df3" class="i field">_functionDefinitions</a>;
            }
 
            <b>set</b>
            {
                <a href="#483ccd476fd23df3" class="i field">_functionDefinitions</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">IDictionary</span>[] <a id="483ccd476fd23df3" href="../../../R/483ccd476fd23df3.html" target="n" data-glyph="46,1" class="i field">_functionDefinitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of variables.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b> <a id="d98532a503e67209" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VariableDefinitions</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a56e11c09d09cc80" class="i field">_variableDefinitions</a>;
            }
 
            <b>set</b>
            {
                <a href="#a56e11c09d09cc80" class="i field">_variableDefinitions</a> = <b>value</b>;
            }
        }
 
        <b>private object</b> <a id="a56e11c09d09cc80" href="../../../R/a56e11c09d09cc80.html" target="n" data-glyph="46,1" class="i field">_variableDefinitions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of environment variables.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">IDictionary</span> <a id="a91b534b753cd07d" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">EnvironmentVariables</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a06fe8eeec77f6aa" class="i field">_environmentVariables</a>;
            }
 
            <b>set</b>
            {
                <a href="#a06fe8eeec77f6aa" class="i field">_environmentVariables</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">IDictionary</span> <a id="a06fe8eeec77f6aa" href="../../../R/a06fe8eeec77f6aa.html" target="n" data-glyph="46,1" class="i field">_environmentVariables</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of types to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="9db1763dcc3bce8a" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">TypesToProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d29e41f88583483d" class="i field">_typesToProcess</a>;
            }
 
            <b>set</b>
            {
                <a href="#d29e41f88583483d" class="i field">_typesToProcess</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="d29e41f88583483d" href="../../../R/d29e41f88583483d.html" target="n" data-glyph="46,1" class="i field">_typesToProcess</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of format data to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="22e78ba441a5d895" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FormatsToProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fea9d7808018efbe" class="i field">_formatsToProcess</a>;
            }
 
            <b>set</b>
            {
                <a href="#fea9d7808018efbe" class="i field">_formatsToProcess</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="fea9d7808018efbe" href="../../../R/fea9d7808018efbe.html" target="n" data-glyph="46,1" class="i field">_formatsToProcess</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of assemblies to load.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="4e9067256a46ca2b" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AssembliesToLoad</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#85488b5cb0fdbd7e" class="i field">_assembliesToLoad</a>;
            }
 
            <b>set</b>
            {
                <a href="#85488b5cb0fdbd7e" class="i field">_assembliesToLoad</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="85488b5cb0fdbd7e" href="../../../R/85488b5cb0fdbd7e.html" target="n" data-glyph="46,1" class="i field">_assembliesToLoad</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="c22080c0c4264a2c" href="../../../R/c22080c0c4264a2c.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#287936bd2b81f470" class="i field">_path</a>));
 
            <a href="../../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r33 rd" class="r33 r">provider</span> = <b>null</b>;
            <a href="../../DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r34 rd" class="r34 r">drive</span>;
            <b>string</b> <span id="r35 rd" class="r35 r">filePath</span> = <a href="../../CommandBase.cs.html#5078d443148de142" class="i property">SessionState</a>.<a href="../../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../../PathInterfaces.cs.html#89444ef2b32a4408" class="i method">GetUnresolvedProviderPathFromPSPath</a>(<a href="#287936bd2b81f470" class="i field">_path</a>, <b>out</b> <span class="r33 r">provider</span>, <b>out</b> <span class="r34 r">drive</span>);
 
            <b>if</b> (!<span class="r33 r">provider</span>.<a href="../../DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="../../ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>) || !<span class="r35 r">filePath</span>.<span class="i">EndsWith</span>(<a href="../../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../../SessionStateStrings.cs.html#962464c163d631f1" class="i field">PowerShellRoleCapabilityFileExtension</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>string</b> <span id="r36 rd" class="r36 r">message</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidRoleCapabilityFilePath</span>, <a href="#287936bd2b81f470" class="i field">_path</a>);
                <span class="i">InvalidOperationException</span> <span id="r37 rd" class="r37 r">ioe</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r36 r">message</span>);
                <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r38 rd" class="r38 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r37 r">ioe</span>, <span class="s">&quot;InvalidRoleCapabilityFilePath&quot;</span>,
                    <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <a href="#287936bd2b81f470" class="i field">_path</a>);
                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r38 r">er</span>);
            }
 
            <span class="i">FileStream</span> <span id="r39 rd" class="r39 r">fileStream</span>;
            <span class="i">StreamWriter</span> <span id="r40 rd" class="r40 r">streamWriter</span>;
            <span class="i">FileInfo</span> <span id="r41 rd" class="r41 r">readOnlyFileInfo</span>;
 
            <span class="c">// Now open the output file...</span>
            <a href="../../../utils/PathUtils.cs.html#fdaf75f786a21eb9" class="t t">PathUtils</a>.<a href="../../../utils/PathUtils.cs.html#87afbcf1303c2952" class="i method">MasterStreamOpen</a>(
                <a href="#da112121e325c8ff" class="k">this</a>,
                <span class="r35 r">filePath</span>,
                <a href="../../../utils/EncodingUtils.cs.html#60f6ffa4e5dbe760" class="t t">EncodingConversion</a>.<a href="../../../utils/EncodingUtils.cs.html#989ee95ae4eadcaa" class="i field">Unicode</a>,
                <span class="c">/* defaultEncoding */</span> <b>false</b>,
                <span class="c">/* Append */</span> <b>false</b>,
                <span class="c">/* Force */</span> <b>false</b>,
                <span class="c">/* NoClobber */</span> <b>false</b>,
                <b>out</b> <span class="r39 r">fileStream</span>,
                <b>out</b> <span class="r40 r">streamWriter</span>,
                <b>out</b> <span class="r41 r">readOnlyFileInfo</span>,
                <b>false</b>
            );
 
            <b>try</b>
            {
                <span class="i">StringBuilder</span> <span id="r42 rd" class="r42 r">result</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
                <span class="r42 r">result</span>.<span class="i">Append</span>(<span class="s">&quot;@{&quot;</span>);
                <span class="r42 r">result</span>.<span class="i">Append</span>(<span class="r40 r">streamWriter</span>.<span class="i">NewLine</span>);
                <span class="r42 r">result</span>.<span class="i">Append</span>(<span class="r40 r">streamWriter</span>.<span class="i">NewLine</span>);
 
                <span class="c">// Guid</span>
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#588d3101f5da21f7" class="i field">Guid</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCGUIDComment</span>, <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">QuoteName</span>(<a href="#3a5bdf1a161270bd" class="i field">_guid</a>), <span class="r40 r">streamWriter</span>, <b>false</b>));
 
                <span class="c">// Author</span>
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#63a9f74ee531a722" class="i field">_author</a>))
                {
                    <a href="#63a9f74ee531a722" class="i field">_author</a> = <span class="i">Environment</span>.<span class="i">UserName</span>;
                }
 
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2033f34b09a6c367" class="i field">Author</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAuthorComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#63a9f74ee531a722" class="i field">_author</a>), <span class="r40 r">streamWriter</span>, <b>false</b>));
 
                <span class="c">// Description</span>
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#c88da021a0546383" class="i field">Description</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCDescriptionComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#c0943153533b3e80" class="i field">_description</a>), <span class="r40 r">streamWriter</span>, <b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#c0943153533b3e80" class="i field">_description</a>)));
 
                <span class="c">// Company name</span>
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#9df654a264b6e06e" class="i field">_companyName</a>))
                {
                    <a href="#9df654a264b6e06e" class="i field">_companyName</a> = <span class="i">Modules</span>.<span class="i">DefaultCompanyName</span>;
                }
 
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2b7e6f2a40dd7273" class="i field">CompanyName</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCCompanyNameComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#9df654a264b6e06e" class="i field">_companyName</a>), <span class="r40 r">streamWriter</span>, <b>false</b>));
 
                <span class="c">// Copyright</span>
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#686d335e2bb10e6b" class="i field">_copyright</a>))
                {
                    <a href="#686d335e2bb10e6b" class="i field">_copyright</a> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">Modules</span>.<span class="i">DefaultCopyrightMessage</span>, <a href="#63a9f74ee531a722" class="i field">_author</a>);
                }
 
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#3aca92d1fa3fdcbf" class="i field">Copyright</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCCopyrightComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<a href="#686d335e2bb10e6b" class="i field">_copyright</a>), <span class="r40 r">streamWriter</span>, <b>false</b>));
 
                <span class="c">// Modules to import</span>
                <b>if</b> (<a href="#386d5686e09589a1" class="i field">_modulesToImport</a> == <b>null</b>)
                {
                    <b>const string</b> <span id="r43 rd" class="r43 r">exampleModulesToImport</span> = <span class="s">&quot;&#39;MyCustomModule&#39;, @{ ModuleName = &#39;MyCustomModule&#39;; ModuleVersion = &#39;1.0.0.0&#39;; GUID = &#39;4d30d5f0-cb16-4898-812d-f20a6c596bdf&#39; }&quot;</span>;
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#815af157370a682b" class="i field">ModulesToImport</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCModulesToImportComment</span>, <span class="r43 r">exampleModulesToImport</span>, <span class="r40 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#815af157370a682b" class="i field">ModulesToImport</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCModulesToImportComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#8712474c70e1b5d1" class="i method">CombineHashTableOrStringArray</a>(<a href="#386d5686e09589a1" class="i field">_modulesToImport</a>, <span class="r40 r">streamWriter</span>, <a href="#da112121e325c8ff" class="k">this</a>), <span class="r40 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Visible aliases</span>
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#3ae92ee7773a9e6a" class="i field">VisibleAliases</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleAliasesComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">GetVisibilityDefault</span>(<a href="#9b9ee94d96594d5e" class="i field">_visibleAliases</a>, <span class="r40 r">streamWriter</span>, <a href="#da112121e325c8ff" class="k">this</a>), <span class="r40 r">streamWriter</span>, <a href="#9b9ee94d96594d5e" class="i field">_visibleAliases</a>.<span class="i">Length</span> == 0));
 
                <span class="c">// Visible cmdlets</span>
                <b>if</b> ((<a href="#feda17c4b286cc20" class="i field">_visibleCmdlets</a> == <b>null</b>) || (<a href="#feda17c4b286cc20" class="i field">_visibleCmdlets</a>.<span class="i">Length</span> == 0))
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#f35a94fa18c56045" class="i field">VisibleCmdlets</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleCmdletsComment</span>,
                        <span class="s">&quot;&#39;Invoke-Cmdlet1&#39;, @{ Name = &#39;Invoke-Cmdlet2&#39;; Parameters = @{ Name = &#39;Parameter1&#39;; ValidateSet = &#39;Item1&#39;, &#39;Item2&#39; }, @{ Name = &#39;Parameter2&#39;; ValidatePattern = &#39;L*&#39; } }&quot;</span>, <span class="r40 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#f35a94fa18c56045" class="i field">VisibleCmdlets</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleCmdletsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#89a631fd3b18ff65" class="i method">GetVisibilityDefault</a>(<a href="#feda17c4b286cc20" class="i field">_visibleCmdlets</a>, <span class="r40 r">streamWriter</span>, <a href="#da112121e325c8ff" class="k">this</a>), <span class="r40 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Visible functions</span>
                <b>if</b> ((<a href="#b7171eaaabd9e519" class="i field">_visibleFunctions</a> == <b>null</b>) || (<a href="#b7171eaaabd9e519" class="i field">_visibleFunctions</a>.<span class="i">Length</span> == 0))
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#6a2144eb8017892d" class="i field">VisibleFunctions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleFunctionsComment</span>,
                        <span class="s">&quot;&#39;Invoke-Function1&#39;, @{ Name = &#39;Invoke-Function2&#39;; Parameters = @{ Name = &#39;Parameter1&#39;; ValidateSet = &#39;Item1&#39;, &#39;Item2&#39; }, @{ Name = &#39;Parameter2&#39;; ValidatePattern = &#39;L*&#39; } }&quot;</span>, <span class="r40 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#6a2144eb8017892d" class="i field">VisibleFunctions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleFunctionsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#89a631fd3b18ff65" class="i method">GetVisibilityDefault</a>(<a href="#b7171eaaabd9e519" class="i field">_visibleFunctions</a>, <span class="r40 r">streamWriter</span>, <a href="#da112121e325c8ff" class="k">this</a>), <span class="r40 r">streamWriter</span>, <a href="#b7171eaaabd9e519" class="i field">_visibleFunctions</a>.<span class="i">Length</span> == 0));
                }
 
                <span class="c">// Visible external commands (scripts, executables)</span>
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#691bb9c10d14bdef" class="i field">VisibleExternalCommands</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleExternalCommandsComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">GetVisibilityDefault</span>(<a href="#f42cd74785f948c6" class="i field">_visibleExternalCommands</a>, <span class="r40 r">streamWriter</span>, <a href="#da112121e325c8ff" class="k">this</a>), <span class="r40 r">streamWriter</span>, <a href="#f42cd74785f948c6" class="i field">_visibleExternalCommands</a>.<span class="i">Length</span> == 0));
 
                <span class="c">// Visible providers</span>
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#4187c2fa3d874c86" class="i field">VisibleProviders</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVisibleProvidersComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">GetVisibilityDefault</span>(<a href="#5f37b1baa00784dd" class="i field">_visibleProviders</a>, <span class="r40 r">streamWriter</span>, <a href="#da112121e325c8ff" class="k">this</a>), <span class="r40 r">streamWriter</span>, <a href="#5f37b1baa00784dd" class="i field">_visibleProviders</a>.<span class="i">Length</span> == 0));
 
                <span class="c">// Scripts to process</span>
                <b>string</b> <span id="r44 rd" class="r44 r">resultData</span> = (<a href="#d9420d84334317cf" class="i field">_scriptsToProcess</a>.<span class="i">Length</span> &gt; 0) ? <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#d9420d84334317cf" class="i field">_scriptsToProcess</a>) : <span class="s">&quot;&#39;C:\\ConfigData\\InitScript1.ps1&#39;, &#39;C:\\ConfigData\\InitScript2.ps1&#39;&quot;</span>;
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9a5653ee028fb1fc" class="i field">ScriptsToProcess</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCScriptsToProcessComment</span>,
                    <span class="r44 r">resultData</span>, <span class="r40 r">streamWriter</span>, (<a href="#d9420d84334317cf" class="i field">_scriptsToProcess</a>.<span class="i">Length</span> == 0)));
 
                <span class="c">// Alias definitions</span>
                <b>if</b> ((<a href="#a811b87853723383" class="i field">_aliasDefinitions</a> == <b>null</b>) || (<a href="#a811b87853723383" class="i field">_aliasDefinitions</a>.<span class="i">Length</span> == 0))
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#c5bd5765181feeac" class="i field">AliasDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAliasDefinitionsComment</span>,
                       <span class="s">&quot;@{ Name = &#39;Alias1&#39;; Value = &#39;Invoke-Alias1&#39;}, @{ Name = &#39;Alias2&#39;; Value = &#39;Invoke-Alias2&#39;}&quot;</span>, <span class="r40 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#c5bd5765181feeac" class="i field">AliasDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAliasDefinitionsComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#6e8582d139dcb33d" class="i method">CombineHashtableArray</a>(<a href="#a811b87853723383" class="i field">_aliasDefinitions</a>, <span class="r40 r">streamWriter</span>), <span class="r40 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Function definitions</span>
                <b>if</b> (<a href="#483ccd476fd23df3" class="i field">_functionDefinitions</a> == <b>null</b>)
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCFunctionDefinitionsComment</span>,
                        <span class="s">&quot;@{ Name = &#39;MyFunction&#39;; ScriptBlock = { param($MyInput) $MyInput } }&quot;</span>, <span class="r40 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <span class="i">Hashtable</span>[] <span id="r45 rd" class="r45 r">funcHash</span> = <a href="../fanin/InitialSessionStateProvider.cs.html#fc3ecbf6d041a5ca" class="t t">DISCPowerShellConfiguration</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b24ebadf5f6d939f" class="i method">TryGetHashtableArray</a>(<a href="#483ccd476fd23df3" class="i field">_functionDefinitions</a>);
 
                    <b>if</b> (<span class="r45 r">funcHash</span> != <b>null</b>)
                    {
                        <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCFunctionDefinitionsComment</span>,
                            <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">CombineHashtableArray</span>(<span class="r45 r">funcHash</span>, <span class="r40 r">streamWriter</span>), <span class="r40 r">streamWriter</span>, <b>false</b>));
 
                        <b>foreach</b> (<span class="i">Hashtable</span> <span id="r46 rd" class="r46 r">hashtable</span> <b>in</b> <span class="r45 r">funcHash</span>)
                        {
                            <b>if</b> (!<span class="r46 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#79c9e3e4f7f31db1" class="i field">FunctionNameToken</a>))
                            {
                                <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r47 rd" class="r47 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                    <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#79c9e3e4f7f31db1" class="i field">FunctionNameToken</a>, <a href="#287936bd2b81f470" class="i field">_path</a>));
                                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r47 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                            }
 
                            <b>if</b> (!<span class="r46 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>))
                            {
                                <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r48 rd" class="r48 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                    <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>, <a href="#287936bd2b81f470" class="i field">_path</a>));
                                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r48 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                            }
 
                            <b>if</b> (<span class="r46 r">hashtable</span>[<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>] <b>is not</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)
                            {
                                <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r49 rd" class="r49 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCKeyMustBeScriptBlock</span>,
                                    <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="#287936bd2b81f470" class="i field">_path</a>));
                                <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r49 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                            }
 
                            <b>foreach</b> (<b>string</b> <span id="r50 rd" class="r50 r">functionKey</span> <b>in</b> <span class="r46 r">hashtable</span>.<span class="i">Keys</span>)
                            {
                                <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r50 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#79c9e3e4f7f31db1" class="i field">FunctionNameToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                                    !<b>string</b>.<span class="i">Equals</span>(<span class="r50 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b5c2efca914a6039" class="i field">FunctionValueToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                                    !<b>string</b>.<span class="i">Equals</span>(<span class="r50 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#f3b742e57550f9ad" class="i field">FunctionOptionsToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r51 rd" class="r51 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeContainsInvalidKey</span>,
                                        <span class="r50 r">functionKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <a href="#287936bd2b81f470" class="i field">_path</a>));
                                    <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r51 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                }
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r52 rd" class="r52 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustBeHashtableArray</span>,
                            <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#e68c4b55a4bdf33a" class="i field">FunctionDefinitions</a>, <span class="r35 r">filePath</span>));
                        <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r52 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                    }
                }
 
                <span class="c">// Variable definitions</span>
                <b>if</b> (<a href="#a56e11c09d09cc80" class="i field">_variableDefinitions</a> == <b>null</b>)
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVariableDefinitionsComment</span>,
                        <span class="s">&quot;@{ Name = &#39;Variable1&#39;; Value = { &#39;Dynamic&#39; + &#39;InitialValue&#39; } }, @{ Name = &#39;Variable2&#39;; Value = &#39;StaticInitialValue&#39; }&quot;</span>, <span class="r40 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <b>string</b> <span id="r53 rd" class="r53 r">varString</span> = <a href="#a56e11c09d09cc80" class="i field">_variableDefinitions</a> <b>as string</b>;
 
                    <b>if</b> (<span class="r53 r">varString</span> != <b>null</b>)
                    {
                        <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVariableDefinitionsComment</span>,
                            <span class="r53 r">varString</span>, <span class="r40 r">streamWriter</span>, <b>false</b>));
                    }
                    <b>else</b>
                    {
                        <span class="i">Hashtable</span>[] <span id="r54 rd" class="r54 r">varHash</span> = <a href="../fanin/InitialSessionStateProvider.cs.html#fc3ecbf6d041a5ca" class="t t">DISCPowerShellConfiguration</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#b24ebadf5f6d939f" class="i method">TryGetHashtableArray</a>(<a href="#a56e11c09d09cc80" class="i field">_variableDefinitions</a>);
 
                        <b>if</b> (<span class="r54 r">varHash</span> != <b>null</b>)
                        {
                            <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCVariableDefinitionsComment</span>,
                                <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">CombineHashtableArray</span>(<span class="r54 r">varHash</span>, <span class="r40 r">streamWriter</span>), <span class="r40 r">streamWriter</span>, <b>false</b>));
 
                            <b>foreach</b> (<span class="i">Hashtable</span> <span id="r55 rd" class="r55 r">hashtable</span> <b>in</b> <span class="r54 r">varHash</span>)
                            {
                                <b>if</b> (!<span class="r55 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2de830f08f62b5e6" class="i field">VariableNameToken</a>))
                                {
                                    <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r56 rd" class="r56 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                        <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2de830f08f62b5e6" class="i field">VariableNameToken</a>, <a href="#287936bd2b81f470" class="i field">_path</a>));
                                    <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r56 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                }
 
                                <b>if</b> (!<span class="r55 r">hashtable</span>.<span class="i">ContainsKey</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9bd2b3372dcf4d80" class="i field">VariableValueToken</a>))
                                {
                                    <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r57 rd" class="r57 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustContainKey</span>,
                                        <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9bd2b3372dcf4d80" class="i field">VariableValueToken</a>, <a href="#287936bd2b81f470" class="i field">_path</a>));
                                    <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r57 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                }
 
                                <b>foreach</b> (<b>string</b> <span id="r58 rd" class="r58 r">variableKey</span> <b>in</b> <span class="r55 r">hashtable</span>.<span class="i">Keys</span>)
                                {
                                    <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r58 r">variableKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#2de830f08f62b5e6" class="i field">VariableNameToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                                        !<b>string</b>.<span class="i">Equals</span>(<span class="r58 r">variableKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#9bd2b3372dcf4d80" class="i field">VariableValueToken</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r59 rd" class="r59 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeContainsInvalidKey</span>,
                                            <span class="r58 r">variableKey</span>, <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <a href="#287936bd2b81f470" class="i field">_path</a>));
                                        <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r59 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                                    }
                                }
                            }
                        }
                        <b>else</b>
                        {
                            <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r60 rd" class="r60 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustBeHashtableArray</span>,
                                <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#97f715e4ffecc7c5" class="i field">VariableDefinitions</a>, <span class="r35 r">filePath</span>));
                            <a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r60 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                        }
                    }
                }
 
                <span class="c">// Environment variables</span>
                <b>if</b> (<a href="#a06fe8eeec77f6aa" class="i field">_environmentVariables</a> == <b>null</b>)
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#bd6ddd7c2df83736" class="i field">EnvironmentVariables</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCEnvironmentVariablesComment</span>,
                        <span class="s">&quot;@{ Variable1 = &#39;Value1&#39;; Variable2 = &#39;Value2&#39; }&quot;</span>,
                        <span class="r40 r">streamWriter</span>, <b>true</b>));
                }
                <b>else</b>
                {
                    <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#bd6ddd7c2df83736" class="i field">EnvironmentVariables</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCEnvironmentVariablesComment</span>,
                        <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#624dde663fd9a482" class="i method">CombineHashtable</a>(<a href="#a06fe8eeec77f6aa" class="i field">_environmentVariables</a>, <span class="r40 r">streamWriter</span>), <span class="r40 r">streamWriter</span>, <b>false</b>));
                }
 
                <span class="c">// Types to process</span>
                <span class="r44 r">resultData</span> = (<a href="#d29e41f88583483d" class="i field">_typesToProcess</a>.<span class="i">Length</span> &gt; 0) ? <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#d29e41f88583483d" class="i field">_typesToProcess</a>) : <span class="s">&quot;&#39;C:\\ConfigData\\MyTypes.ps1xml&#39;, &#39;C:\\ConfigData\\OtherTypes.ps1xml&#39;&quot;</span>;
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#1a3b227af34ff440" class="i field">TypesToProcess</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypesToProcessComment</span>,
                    <span class="r44 r">resultData</span>, <span class="r40 r">streamWriter</span>, (<a href="#d29e41f88583483d" class="i field">_typesToProcess</a>.<span class="i">Length</span> == 0)));
 
                <span class="c">// Formats to process</span>
                <span class="r44 r">resultData</span> = (<a href="#fea9d7808018efbe" class="i field">_formatsToProcess</a>.<span class="i">Length</span> &gt; 0) ? <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#fea9d7808018efbe" class="i field">_formatsToProcess</a>) : <span class="s">&quot;&#39;C:\\ConfigData\\MyFormats.ps1xml&#39;, &#39;C:\\ConfigData\\OtherFormats.ps1xml&#39;&quot;</span>;
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#22f6487e5a94de7f" class="i field">FormatsToProcess</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCFormatsToProcessComment</span>,
                    <span class="r44 r">resultData</span>, <span class="r40 r">streamWriter</span>, (<a href="#fea9d7808018efbe" class="i field">_formatsToProcess</a>.<span class="i">Length</span> == 0)));
 
                <span class="c">// Assemblies to load</span>
                <b>bool</b> <span id="r61 rd" class="r61 r">isExample</span> = <b>false</b>;
                <b>if</b> ((<a href="#85488b5cb0fdbd7e" class="i field">_assembliesToLoad</a> == <b>null</b>) || (<a href="#85488b5cb0fdbd7e" class="i field">_assembliesToLoad</a>.<span class="i">Length</span> == 0))
                {
                    <span class="r61 r">isExample</span> = <b>true</b>;
                    <a href="#85488b5cb0fdbd7e" class="i field">_assembliesToLoad</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;System.Web&quot;</span>, <span class="s">&quot;System.OtherAssembly, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;</span> };
                }
 
                <span class="r42 r">result</span>.<span class="i">Append</span>(<a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<span class="i">ConfigFragment</span>(<a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#681f01148717d80f" class="i field">AssembliesToLoad</a>, <span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCAssembliesToLoadComment</span>,
                    <a href="#594ec7e5f2811363" class="t t">SessionConfigurationUtils</a>.<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<a href="#85488b5cb0fdbd7e" class="i field">_assembliesToLoad</a>), <span class="r40 r">streamWriter</span>, <span class="r61 r">isExample</span>));
 
                <span class="r42 r">result</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
 
                <span class="r40 r">streamWriter</span>.<span class="i">Write</span>(<span class="r42 r">result</span>.<span class="i">ToString</span>());
            }
            <b>finally</b>
            {
                <span class="r40 r">streamWriter</span>.<span class="i">Dispose</span>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> SessionConfigurationUtils
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Utility methods for configuration file commands.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="594ec7e5f2811363" href="../../../R/594ec7e5f2811363.html" target="n" data-glyph="2,0" class="t t">SessionConfigurationUtils</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This routine builds a fragment of the config file</span>
        <span class="c">///</span><span class="c"> for a particular key. It returns a formatted string that includes</span>
        <span class="c">///</span><span class="c"> a comment describing the key as well as the key and its value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="648346b764718f3f" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ConfigFragment</a>(<b>string</b> <span id="r62 rd" class="r62 r">key</span>, <b>string</b> <span id="r63 rd" class="r63 r">resourceString</span>, <b>string</b> <span id="r64 rd" class="r64 r">value</span>, <span class="i">StreamWriter</span> <span id="r65 rd" class="r65 r">streamWriter</span>, <b>bool</b> <span id="r66 rd" class="r66 r">isExample</span>)
        {
            <b>string</b> <span id="r67 rd" class="r67 r">nl</span> = <span class="r65 r">streamWriter</span>.<span class="i">NewLine</span>;
 
            <b>if</b> (<span class="r66 r">isExample</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;# {0}{1}# {2:19} = {3}{4}{5}&quot;</span>,
                    <span class="r63 r">resourceString</span>, <span class="r67 r">nl</span>, <span class="r62 r">key</span>, <span class="r64 r">value</span>, <span class="r67 r">nl</span>, <span class="r67 r">nl</span>);
            }
 
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;# {0}{1}{2:19} = {3}{4}{5}&quot;</span>,
                <span class="r63 r">resourceString</span>, <span class="r67 r">nl</span>, <span class="r62 r">key</span>, <span class="r64 r">value</span>, <span class="r67 r">nl</span>, <span class="r67 r">nl</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a single-quoted string. Any embedded single quotes will be doubled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The string to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The quoted string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="7868a3fc3074c814" href="../../../R/7868a3fc3074c814.html" target="n" data-glyph="74,1" class="i method">QuoteName</a>(<b>object</b> <span id="r68 rd" class="r68 r">name</span>)
        {
            <b>if</b> (<span class="r68 r">name</span> == <b>null</b>)
                <b>return</b> <span class="s">&quot;&#39;&#39;&quot;</span>;
            <b>return</b> <span class="s">&quot;&#39;&quot;</span> + <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="../../lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<span class="i">EscapeSingleQuotedStringContent</span>(<span class="r68 r">name</span>.<span class="i">ToString</span>()) + <span class="s">&quot;&#39;&quot;</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a script block string wrapped in curly braces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">sb</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The string to wrap.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The wrapped string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="534a5f7ed7a49c1c" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WrapScriptBlock</a>(<b>object</b> <span id="r69 rd" class="r69 r">sb</span>)
        {
            <b>if</b> (<span class="r69 r">sb</span> == <b>null</b>)
                <b>return</b> <span class="s">&quot;{}&quot;</span>;
            <b>return</b> <span class="s">&quot;{&quot;</span> + <span class="r69 r">sb</span>.<span class="i">ToString</span>() + <span class="s">&quot;}&quot;</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a script block string wrapped in curly braces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="3beec01214d46e94" href="../../../R/3beec01214d46e94.html" target="n" data-glyph="74,1" class="i method">WriteBoolean</a>(<b>bool</b> <span id="r70 rd" class="r70 r">booleanToEmit</span>)
        {
            <b>if</b> (<span class="r70 r">booleanToEmit</span>)
            {
                <b>return</b> <span class="s">&quot;$true&quot;</span>;
            }
            <b>else</b>
            {
                <b>return</b> <span class="s">&quot;$false&quot;</span>;
            }
        }
 
        <b>internal static string</b> <a id="bddc10ef780a71df" href="../../../R/bddc10ef780a71df.html" target="n" data-glyph="74,1" class="i method">WriteLong</a>(<b>long</b> <span id="r71 rd" class="r71 r">longToEmit</span>)
        {
            <b>return</b> <span class="r71 r">longToEmit</span>.<span class="i">ToString</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the visibility default value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="89a631fd3b18ff65" href="../../../R/89a631fd3b18ff65.html" target="n" data-glyph="74,1" class="i method">GetVisibilityDefault</a>(<b>object</b>[] <span id="r72 rd" class="r72 r">values</span>, <span class="i">StreamWriter</span> <span id="r73 rd" class="r73 r">writer</span>, <a href="../../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r74 rd" class="r74 r">caller</span>)
        {
            <b>if</b> ((<span class="r72 r">values</span> != <b>null</b>) &amp;&amp; (<span class="r72 r">values</span>.<span class="i">Length</span> &gt; 0))
            {
                <b>return</b> <a href="#8712474c70e1b5d1" class="i method">CombineHashTableOrStringArray</a>(<span class="r72 r">values</span>, <span class="r73 r">writer</span>, <span class="r74 r">caller</span>);
            }
 
            <span class="c">// Default Visibility is Empty which gets commented</span>
            <span class="c">// out in the session config file</span>
            <b>return</b> <span class="s">&quot;&#39;Item1&#39;, &#39;Item2&#39;&quot;</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Combines a hashtable into a single string block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="624dde663fd9a482" href="../../../R/624dde663fd9a482.html" target="n" data-glyph="74,1" class="i method">CombineHashtable</a>(<span class="i">IDictionary</span> <span id="r75 rd" class="r75 r">table</span>, <span class="i">StreamWriter</span> <span id="r76 rd" class="r76 r">writer</span>, <b>int</b>? <span id="r77 rd" class="r77 r">indent</span> = 0)
        {
            <span class="i">StringBuilder</span> <span id="r78 rd" class="r78 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;@{&quot;</span>);
 
            <b>var</b> <span id="r79 rd" class="r79 r">keys</span> = <span class="r75 r">table</span>.<span class="i">Keys</span>.<span class="i">Cast</span>&lt;<b>string</b>&gt;().<span class="i">OrderBy</span>(<b>static</b> <span id="r80 rd" class="r80 r">x</span> =&gt; <span class="r80 r">x</span>);
            <b>foreach</b> (<b>var</b> <span id="r81 rd" class="r81 r">key</span> <b>in</b> <span class="r79 r">keys</span>)
            {
                <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="r76 r">writer</span>.<span class="i">NewLine</span>);
                <span class="r78 r">sb</span>.<span class="i">AppendFormat</span>(<span class="s">&quot;{0,&quot;</span> + (4 * (<span class="r77 r">indent</span> + 1)) + <span class="s">&quot;}&quot;</span>, <b>string</b>.<span class="i">Empty</span>);
                <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="i">QuoteName</span>(<span class="r81 r">key</span>));
                <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot; = &quot;</span>);
                <b>if</b> (<span class="r75 r">table</span>[<span class="r81 r">key</span>] <b>is</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)
                {
                    <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="i">WrapScriptBlock</span>(<span class="r75 r">table</span>[<span class="r81 r">key</span>].<span class="i">ToString</span>()));
                    <b>continue</b>;
                }
 
                <span class="i">IDictionary</span> <span id="r82 rd" class="r82 r">tableValue</span> = <span class="r75 r">table</span>[<span class="r81 r">key</span>] <b>as</b> <span class="i">IDictionary</span>;
                <b>if</b> (<span class="r82 r">tableValue</span> != <b>null</b>)
                {
                    <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="i">CombineHashtable</span>(<span class="r82 r">tableValue</span>, <span class="r76 r">writer</span>, <span class="r77 r">indent</span> + 1));
                    <b>continue</b>;
                }
 
                <span class="i">IDictionary</span>[] <span id="r83 rd" class="r83 r">tableValues</span> = <a href="../fanin/InitialSessionStateProvider.cs.html#fc3ecbf6d041a5ca" class="t t">DISCPowerShellConfiguration</a>.<span class="i">TryGetHashtableArray</span>(<span class="r75 r">table</span>[<span class="r81 r">key</span>]);
                <b>if</b> (<span class="r83 r">tableValues</span> != <b>null</b>)
                {
                    <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="i">CombineHashtableArray</span>(<span class="r83 r">tableValues</span>, <span class="r76 r">writer</span>, <span class="r77 r">indent</span> + 1));
                    <b>continue</b>;
                }
 
                <b>string</b>[] <span id="r84 rd" class="r84 r">stringValues</span> = <a href="../fanin/InitialSessionStateProvider.cs.html#fc3ecbf6d041a5ca" class="t t">DISCPowerShellConfiguration</a>.<span class="i">TryGetStringArray</span>(<span class="r75 r">table</span>[<span class="r81 r">key</span>]);
                <b>if</b> (<span class="r84 r">stringValues</span> != <b>null</b>)
                {
                    <span class="r78 r">sb</span>.<span class="i">Append</span>(<a href="#f5b228ac20b0ceeb" class="i method">CombineStringArray</a>(<span class="r84 r">stringValues</span>));
                    <b>continue</b>;
                }
 
                <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="i">QuoteName</span>(<span class="r75 r">table</span>[<span class="r81 r">key</span>]));
            }
 
            <span class="r78 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot; }&quot;</span>);
 
            <b>return</b> <span class="r78 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Combines RequireGroups logic operator hash tables / lists</span>
        <span class="c">///</span><span class="c"> e.g.,</span>
        <span class="c">///</span><span class="c"> -RequiredGroups @{ Or = &#39;TrustedGroup1&#39;, &#39;MFAGroup2&#39; }</span>
        <span class="c">///</span><span class="c"> -RequiredGroups @{ And = &#39;Administrators&#39;, @{ Or = &#39;MFAGroup1&#39;, &#39;MFAGroup2&#39; } }</span>
        <span class="c">///</span><span class="c"> -RequiredGroups @{ Or = @{ And = &#39;Administrators&#39;, &#39;TrustedGroup1&#39; }, @{ And = &#39;Power Users&#39;, &#39;TrustedGroup1&#39; } }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">table</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="1e908c79b79b4d39" href="../../../R/1e908c79b79b4d39.html" target="n" data-glyph="74,1" class="i method">CombineRequiredGroupsHash</a>(<span class="i">IDictionary</span> <span id="r85 rd" class="r85 r">table</span>)
        {
            <b>if</b> (<span class="r85 r">table</span>.<span class="i">Count</span> != 1)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RequiredGroupsHashMultipleKeys</span>);
            }
 
            <span class="i">StringBuilder</span> <span id="r86 rd" class="r86 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>var</b> <span id="r87 rd" class="r87 r">keyEnumerator</span> = <span class="r85 r">table</span>.<span class="i">Keys</span>.<span class="i">GetEnumerator</span>();
            <span class="r87 r">keyEnumerator</span>.<span class="i">MoveNext</span>();
            <b>string</b> <span id="r88 rd" class="r88 r">key</span> = <span class="r87 r">keyEnumerator</span>.<span class="i">Current</span> <b>as string</b>;
            <b>object</b> <span id="r89 rd" class="r89 r">keyObject</span> = <span class="r85 r">table</span>[<span class="r88 r">key</span>];
            <span class="r86 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;@{ &quot;</span>);
            <span class="r86 r">sb</span>.<span class="i">Append</span>(<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<span class="r88 r">key</span>));
            <span class="r86 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot; = &quot;</span>);
 
            <b>object</b>[] <span id="r90 rd" class="r90 r">values</span> = <span class="r89 r">keyObject</span> <b>as object</b>[];
            <b>if</b> (<span class="r90 r">values</span> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r91 rd" class="r91 r">i</span> = 0; <span class="r91 r">i</span> &lt; <span class="r90 r">values</span>.<span class="i">Length</span>;)
                {
                    <a href="#92a04089bcc7daae" class="i method">WriteRequiredGroup</a>(<span class="r90 r">values</span>[<span class="r91 r">i</span>++], <span class="r86 r">sb</span>);
 
                    <b>if</b> (<span class="r91 r">i</span> &lt; <span class="r90 r">values</span>.<span class="i">Length</span>)
                    {
                        <span class="r86 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                    }
                }
            }
            <b>else</b>
            {
                <a href="#92a04089bcc7daae" class="i method">WriteRequiredGroup</a>(<span class="r89 r">keyObject</span>, <span class="r86 r">sb</span>);
            }
 
            <span class="r86 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot; }&quot;</span>);
 
            <b>return</b> <span class="r86 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <b>private static void</b> <a id="92a04089bcc7daae" href="../../../R/92a04089bcc7daae.html" target="n" data-glyph="76,1" class="i method">WriteRequiredGroup</a>(<b>object</b> <span id="r92 rd" class="r92 r">value</span>, <span class="i">StringBuilder</span> <span id="r93 rd" class="r93 r">sb</span>)
        {
            <b>string</b> <span id="r94 rd" class="r94 r">strValue</span> = <span class="r92 r">value</span> <b>as string</b>;
            <b>if</b> (<span class="r94 r">strValue</span> != <b>null</b>)
            {
                <span class="r93 r">sb</span>.<span class="i">Append</span>(<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<span class="r94 r">strValue</span>));
            }
            <b>else</b>
            {
                <span class="i">Hashtable</span> <span id="r95 rd" class="r95 r">subTable</span> = <span class="r92 r">value</span> <b>as</b> <span class="i">Hashtable</span>;
                <b>if</b> (<span class="r95 r">subTable</span> != <b>null</b>)
                {
                    <span class="r93 r">sb</span>.<span class="i">Append</span>(<span class="i">CombineRequiredGroupsHash</span>(<span class="r95 r">subTable</span>));
                }
                <b>else</b>
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">UnknownGroupMembershipValue</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Combines an array of hashtables into a single string block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="6e8582d139dcb33d" href="../../../R/6e8582d139dcb33d.html" target="n" data-glyph="74,1" class="i method">CombineHashtableArray</a>(<span class="i">IDictionary</span>[] <span id="r96 rd" class="r96 r">tables</span>, <span class="i">StreamWriter</span> <span id="r97 rd" class="r97 r">writer</span>, <b>int</b>? <span id="r98 rd" class="r98 r">indent</span> = 0)
        {
            <span class="i">StringBuilder</span> <span id="r99 rd" class="r99 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>for</b> (<b>int</b> <span id="r100 rd" class="r100 r">i</span> = 0; <span class="r100 r">i</span> &lt; <span class="r96 r">tables</span>.<span class="i">Length</span>; <span class="r100 r">i</span>++)
            {
                <span class="r99 r">sb</span>.<span class="i">Append</span>(<a href="#624dde663fd9a482" class="i method">CombineHashtable</a>(<span class="r96 r">tables</span>[<span class="r100 r">i</span>], <span class="r97 r">writer</span>, <span class="r98 r">indent</span>));
 
                <b>if</b> (<span class="r100 r">i</span> &lt; (<span class="r96 r">tables</span>.<span class="i">Length</span> - 1))
                {
                    <span class="r99 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                }
            }
 
            <b>return</b> <span class="r99 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Combines an array of strings into a single string block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">values</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String values.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">String block.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="f5b228ac20b0ceeb" href="../../../R/f5b228ac20b0ceeb.html" target="n" data-glyph="74,1" class="i method">CombineStringArray</a>(<b>string</b>[] <span id="r101 rd" class="r101 r">values</span>)
        {
            <span class="i">StringBuilder</span> <span id="r102 rd" class="r102 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>for</b> (<b>int</b> <span id="r103 rd" class="r103 r">i</span> = 0; <span class="r103 r">i</span> &lt; <span class="r101 r">values</span>.<span class="i">Length</span>; <span class="r103 r">i</span>++)
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r101 r">values</span>[<span class="r103 r">i</span>]))
                {
                    <span class="r102 r">sb</span>.<span class="i">Append</span>(<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<span class="r101 r">values</span>[<span class="r103 r">i</span>]));
 
                    <b>if</b> (<span class="r103 r">i</span> &lt; (<span class="r101 r">values</span>.<span class="i">Length</span> - 1))
                    {
                        <span class="r102 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r102 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Combines an array of strings or hashtables into a single string block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="8712474c70e1b5d1" href="../../../R/8712474c70e1b5d1.html" target="n" data-glyph="74,1" class="i method">CombineHashTableOrStringArray</a>(<b>object</b>[] <span id="r104 rd" class="r104 r">values</span>, <span class="i">StreamWriter</span> <span id="r105 rd" class="r105 r">writer</span>, <a href="../../../P/30543a6971fed1fc.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r106 rd" class="r106 r">caller</span>)
        {
            <span class="i">StringBuilder</span> <span id="r107 rd" class="r107 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>for</b> (<b>int</b> <span id="r108 rd" class="r108 r">i</span> = 0; <span class="r108 r">i</span> &lt; <span class="r104 r">values</span>.<span class="i">Length</span>; <span class="r108 r">i</span>++)
            {
                <b>string</b> <span id="r109 rd" class="r109 r">strVal</span> = <span class="r104 r">values</span>[<span class="r108 r">i</span>] <b>as string</b>;
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r109 r">strVal</span>))
                {
                    <span class="r107 r">sb</span>.<span class="i">Append</span>(<a href="#7868a3fc3074c814" class="i method">QuoteName</a>(<span class="r109 r">strVal</span>));
                }
                <b>else</b>
                {
                    <span class="i">Hashtable</span> <span id="r110 rd" class="r110 r">hashVal</span> = <span class="r104 r">values</span>[<span class="r108 r">i</span>] <b>as</b> <span class="i">Hashtable</span>;
                    <b>if</b> (<span class="r110 r">hashVal</span> == <b>null</b>)
                    {
                        <b>string</b> <span id="r111 rd" class="r111 r">message</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DISCTypeMustBeStringOrHashtableArray</span>,
                                                           <a href="../fanin/InitialSessionStateProvider.cs.html#b1e495f9b52fbd4a" class="t t">ConfigFileConstants</a>.<a href="../fanin/InitialSessionStateProvider.cs.html#815af157370a682b" class="i field">ModulesToImport</a>);
                        <a href="../../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r112 rd" class="r112 r">e</span> = <b>new</b> <a href="../../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<span class="r111 r">message</span>);
                        <span class="r106 r">caller</span>.<a href="../../cmdlet.cs.html#e3346d70990a1763" class="i method">ThrowTerminatingError</a>(<span class="r112 r">e</span>.<a href="../../../utils/MshArgumentException.cs.html#05a4ba247db046f2" class="i property">ErrorRecord</a>);
                    }
 
                    <span class="r107 r">sb</span>.<span class="i">Append</span>(<span class="i">CombineHashtable</span>(<span class="r110 r">hashVal</span>, <span class="r105 r">writer</span>));
                }
 
                <b>if</b> (<span class="r108 r">i</span> &lt; (<span class="r104 r">values</span>.<span class="i">Length</span> - 1))
                {
                    <span class="r107 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                }
            }
 
            <b>return</b> <span class="r107 r">sb</span>.<span class="i">ToString</span>();
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
