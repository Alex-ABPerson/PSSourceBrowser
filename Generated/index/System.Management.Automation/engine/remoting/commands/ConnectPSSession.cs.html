<!DOCTYPE html>
<html><head><title>ConnectPSSession.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(1118);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/commands/ConnectPSSession.cs" target="_top">engine\remoting\commands\ConnectPSSession.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This cmdlet connects PS sessions (RemoteRunspaces) that are in the Disconnected</span>
    <span class="c">///</span><span class="c"> state and returns those PS session objects in the Opened state.  One or more</span>
    <span class="c">///</span><span class="c"> session objects can be specified for connecting, or a remote computer name can</span>
    <span class="c">///</span><span class="c"> be specified and in this case all disconnected remote runspaces found on the</span>
    <span class="c">///</span><span class="c"> remote computer will be connected and PSSession objects created on the local</span>
    <span class="c">///</span><span class="c"> machine.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> The cmdlet can be used in the following ways:</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Connect a PS session object:</span>
    <span class="c">///</span><span class="c"> &gt; $session = New-PSSession serverName</span>
    <span class="c">///</span><span class="c"> &gt; Disconnect-PSSession $session</span>
    <span class="c">///</span><span class="c"> &gt; Connect-PSSession $session</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Connect a PS session by name:</span>
    <span class="c">///</span><span class="c"> &gt; Connect-PSSession $session.Name</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Connect a PS session by Id:</span>
    <span class="c">///</span><span class="c"> &gt; Connect-PSSession $session.Id</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Connect a collection of PS session:</span>
    <span class="c">///</span><span class="c"> &gt; Get-PSSession | Connect-PSSession</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Connect all disconnected PS sessions on a remote computer</span>
    <span class="c">///</span><span class="c"> &gt; Connect-PSSession serverName.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.PowerShell&quot;</span>, <span class="s">&quot;PS1012:CallShouldProcessOnlyIfDeclaringSupport&quot;</span>)]
    [<span class="i">Cmdlet</span>(<a href="../../../utils/Verbs.cs.html#4b3c39661547d6b5" class="t t">VerbsCommunications</a>.<a href="../../../utils/Verbs.cs.html#3e697c53a18c7f1f" class="i field">Connect</a>, <span class="s">&quot;PSSession&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#5ab4d540bcda3887" class="i field">NameParameterSet</a>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096694&quot;</span>, <span class="i">RemotingCapability</span> = <a href="../common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="../common/misc.cs.html#24fda4b6c5a6ee93" class="i field">OwnedByCommand</a>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>))]
    <b>public class</b> <a id="c8f514190276eaf4" href="../../../R/c8f514190276eaf4.html" target="n" data-glyph="0,0" class="t t"><span id="1260aec75b51f962">ConnectPSSessionCommand</span></a> : <a href="PSRemotingCmdlet.cs.html#9f3c8073162f1fd6" class="t t">PSRunspaceCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <b>private const string</b> <a id="6bfe75f87dadd3b1" href="../../../R/6bfe75f87dadd3b1.html" target="n" data-glyph="10,1" class="i field">ComputerNameGuidParameterSet</a> = <span class="s">&quot;ComputerNameGuid&quot;</span>;
        <b>private const string</b> <a id="ef8c8b4cee4c03d9" href="../../../R/ef8c8b4cee4c03d9.html" target="n" data-glyph="10,1" class="i field">ConnectionUriParameterSet</a> = <span class="s">&quot;ConnectionUri&quot;</span>;
        <b>private const string</b> <a id="a7dd6ed3f79a9da2" href="../../../R/a7dd6ed3f79a9da2.html" target="n" data-glyph="10,1" class="i field">ConnectionUriGuidParameterSet</a> = <span class="s">&quot;ConnectionUriGuid&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSSession object or objects to be connected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>[] <a id="1e2c0144a46a25b9" href="../../../R/1e2c0144a46a25b9.html" target="n" data-glyph="102,1" class="i property">Session</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer names to connect to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;Cn&quot;</span>)]
        <b>public override string</b>[] <a id="f3155e1132d38390" href="../../../R/f3155e1132d38390.html" target="n" data-glyph="102,1" class="i property">ComputerName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameters specifies the appname which identifies the connection</span>
        <span class="c">///</span><span class="c"> end point on the remote machine. If this parameter is not specified</span>
        <span class="c">///</span><span class="c"> then the value specified in DEFAULTREMOTEAPPNAME will be used. If thats</span>
        <span class="c">///</span><span class="c"> not specified as well, then &quot;WSMAN&quot; will be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        <b>public string</b> <a id="dbaaaed97222bd8c" href="../../../R/dbaaaed97222bd8c.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#72524d8ab3f4aacf" class="i field">_appName</a>;
            }
 
            <b>set</b>
            {
                <a href="#72524d8ab3f4aacf" class="i field">_appName</a> = <a href="PSRemotingCmdlet.cs.html#24d404384c59cac5" class="i method">ResolveAppName</a>(<b>value</b>);
            }
        }
 
        <b>private string</b> <a id="72524d8ab3f4aacf" href="../../../R/72524d8ab3f4aacf.html" target="n" data-glyph="46,1" class="i field">_appName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this parameter is not specified then the value specified in</span>
        <span class="c">///</span><span class="c"> the environment variable DEFAULTREMOTESHELLNAME will be used. If</span>
        <span class="c">///</span><span class="c"> this is not set as well, then Microsoft.PowerShell is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        <b>public string</b> <a id="eaa344830877829e" href="../../../R/eaa344830877829e.html" target="n" data-glyph="102,1" class="i property">ConfigurationName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7810b7ac618a9888" class="i field">_shell</a>;
            }
 
            <b>set</b>
            {
                <a href="#7810b7ac618a9888" class="i field">_shell</a> = <a href="PSRemotingCmdlet.cs.html#f6b9edb5e4879089" class="i method">ResolveShell</a>(<b>value</b>);
            }
        }
 
        <b>private string</b> <a id="7810b7ac618a9888" href="../../../R/7810b7ac618a9888.html" target="n" data-glyph="46,1" class="i field">_shell</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A complete URI(s) specified for the remote computer and shell to</span>
        <span class="c">///</span><span class="c"> connect to and create a runspace for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;URI&quot;</span>, <span class="s">&quot;CU&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <span class="i">Uri</span>[] <a id="beaf5bb73c1d2c08" href="../../../R/beaf5bb73c1d2c08.html" target="n" data-glyph="102,1" class="i property">ConnectionUri</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The AllowRedirection parameter enables the implicit redirection functionality.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="623a3622623b9166" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AllowRedirection</a>
        {
            <b>get</b> { <b>return</b> <a href="#24a12d63e82bb36b" class="i field">_allowRedirection</a>; }
 
            <b>set</b> { <a href="#24a12d63e82bb36b" class="i field">_allowRedirection</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="24a12d63e82bb36b" href="../../../R/24a12d63e82bb36b.html" target="n" data-glyph="46,1" class="i field">_allowRedirection</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RemoteRunspaceId to retrieve corresponding PSSession</span>
        <span class="c">///</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#bfd5cf9ba9156dcf" class="i field">InstanceIdParameterSet</a>,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public override</b> <span class="i">Guid</span>[] <a id="469c37f7b7f68f82" href="../../../R/469c37f7b7f68f82.html" target="n" data-glyph="102,1" class="i property">InstanceId</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#9f3c8073162f1fd6" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#a12ac27990ea4f30" class="i property">InstanceId</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#9f3c8073162f1fd6" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#a12ac27990ea4f30" class="i property">InstanceId</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the remote runspaceinfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#5ab4d540bcda3887" class="i field">NameParameterSet</a>,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public override string</b>[] <a id="88947c9439555727" href="../../../R/88947c9439555727.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#9f3c8073162f1fd6" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#246349607820455f" class="i property">Name</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#9f3c8073162f1fd6" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#246349607820455f" class="i property">Name</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the credentials of the user to impersonate in the</span>
        <span class="c">///</span><span class="c"> remote machine. If this parameter is not specified then the</span>
        <span class="c">///</span><span class="c"> credentials of the current user process will be assumed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        [<span class="i">Credential</span>()]
        <b>public</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="d9184f9b510c7a9f" href="../../../R/d9184f9b510c7a9f.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4fa56f976dc9d5e9" class="i field">_psCredential</a>;
            }
 
            <b>set</b>
            {
                <a href="#4fa56f976dc9d5e9" class="i field">_psCredential</a> = <b>value</b>;
 
                <a href="PSRemotingCmdlet.cs.html#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="PSRemotingCmdlet.cs.html#86dfd1331ac33e3d" class="i method">ValidateSpecifiedAuthentication</a>(<a href="#d9184f9b510c7a9f" class="i property">Credential</a>, <a href="#4c66ef845665dd06" class="i property">CertificateThumbprint</a>, <a href="#520b6487af5ff63b" class="i property">Authentication</a>);
            }
        }
 
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="4fa56f976dc9d5e9" href="../../../R/4fa56f976dc9d5e9.html" target="n" data-glyph="46,1" class="i field">_psCredential</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use basic authentication to authenticate the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        <b>public</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="520b6487af5ff63b" href="../../../R/520b6487af5ff63b.html" target="n" data-glyph="102,1" class="i property">Authentication</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2bbbd1f6d79720d8" class="i field">_authentication</a>;
            }
 
            <b>set</b>
            {
                <a href="#2bbbd1f6d79720d8" class="i field">_authentication</a> = <b>value</b>;
 
                <a href="PSRemotingCmdlet.cs.html#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="PSRemotingCmdlet.cs.html#86dfd1331ac33e3d" class="i method">ValidateSpecifiedAuthentication</a>(<a href="#d9184f9b510c7a9f" class="i property">Credential</a>, <a href="#4c66ef845665dd06" class="i property">CertificateThumbprint</a>, <a href="#520b6487af5ff63b" class="i property">Authentication</a>);
            }
        }
 
        <b>private</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="2bbbd1f6d79720d8" href="../../../R/2bbbd1f6d79720d8.html" target="n" data-glyph="46,1" class="i field">_authentication</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the certificate thumbprint to be used to impersonate the user on the</span>
        <span class="c">///</span><span class="c"> remote machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        <b>public string</b> <a id="4c66ef845665dd06" href="../../../R/4c66ef845665dd06.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9fa1c9ab1916a266" class="i field">_thumbprint</a>;
            }
 
            <b>set</b>
            {
                <a href="#9fa1c9ab1916a266" class="i field">_thumbprint</a> = <b>value</b>;
 
                <a href="PSRemotingCmdlet.cs.html#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="PSRemotingCmdlet.cs.html#86dfd1331ac33e3d" class="i method">ValidateSpecifiedAuthentication</a>(<a href="#d9184f9b510c7a9f" class="i property">Credential</a>, <a href="#4c66ef845665dd06" class="i property">CertificateThumbprint</a>, <a href="#520b6487af5ff63b" class="i property">Authentication</a>);
            }
        }
 
        <b>private string</b> <a id="9fa1c9ab1916a266" href="../../../R/9fa1c9ab1916a266.html" target="n" data-glyph="46,1" class="i field">_thumbprint</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Port specifies the alternate port to be used in case the</span>
        <span class="c">///</span><span class="c"> default ports are not used for the transport mechanism</span>
        <span class="c">///</span><span class="c"> (port 80 for http and port 443 for useSSL)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently this is being accepted as a parameter. But in future</span>
        <span class="c">///</span><span class="c"> support will be added to make this a part of a policy setting.</span>
        <span class="c">///</span><span class="c"> When a policy setting is in place this parameter can be used</span>
        <span class="c">///</span><span class="c"> to override the policy setting</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">ValidateRange</span>((<b>int</b>)1, (<b>int</b>)<span class="i">UInt16</span>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="0d7e28533f097586" href="../../../R/0d7e28533f097586.html" target="n" data-glyph="102,1" class="i property">Port</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter suggests that the transport scheme to be used for</span>
        <span class="c">///</span><span class="c"> remote connections is useSSL instead of the default http.Since</span>
        <span class="c">///</span><span class="c"> there are only two possible transport schemes that are possible</span>
        <span class="c">///</span><span class="c"> at this point, a SwitchParameter is being used to switch between</span>
        <span class="c">///</span><span class="c"> the two.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="457909fd8f4c52fa" href="../../../R/457909fd8f4c52fa.html" target="n" data-glyph="102,1" class="i property">UseSSL</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extended session options.  Used in this cmdlet to set server disconnect options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        <b>public</b> <a href="PSRemotingCmdlet.cs.html#8626ee928362b305" class="t t">PSSessionOption</a> <a id="8e3dd2444e430b71" href="../../../R/8e3dd2444e430b71.html" target="n" data-glyph="102,1" class="i property">SessionOption</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allows the user of the cmdlet to specify a throttling value</span>
        <span class="c">///</span><span class="c"> for throttling the number of remote operations that can</span>
        <span class="c">///</span><span class="c"> be executed simultaneously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#2b4dfd6d547b0ef7" class="i field">IdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#5ab4d540bcda3887" class="i field">NameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#bfd5cf9ba9156dcf" class="i field">InstanceIdParameterSet</a>)]
        <b>public int</b> <a id="fdd646a12e378259" href="../../../R/fdd646a12e378259.html" target="n" data-glyph="102,1" class="i property">ThrottleLimit</a> { <b>get</b>; <b>set</b>; } = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overriding to suppress this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b>[] <a id="b31711347dc4d80b" href="../../../R/b31711347dc4d80b.html" target="n" data-glyph="102,1" class="i property">ContainerId</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overriding to suppress this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">Guid</span>[] <a id="997bf738b7948c66" href="../../../R/997bf738b7948c66.html" target="n" data-glyph="102,1" class="i property">VMId</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overriding to suppress this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b>[] <a id="f74951ab8e649f8e" href="../../../R/f74951ab8e649f8e.html" target="n" data-glyph="102,1" class="i property">VMName</a>
        {
            <b>get</b>
            {
                <b>return</b> <b>null</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Cmdlet Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set up the ThrottleManager for runspace connect processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="56551079f868b865" href="../../../R/56551079f868b865.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="PSRemotingCmdlet.cs.html#9f3c8073162f1fd6" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#3da6242f8109ce30" class="i method">BeginProcessing</a>();
 
            <a href="#ffdf30c70f04c59d" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#c88c6759bac73d6d" class="i property">ThrottleLimit</a> = <a href="#fdd646a12e378259" class="i property">ThrottleLimit</a>;
            <a href="#ffdf30c70f04c59d" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> += <span class="i">HandleThrottleConnectComplete</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Perform runspace connect processing on all input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="b4038acfba3d0922" href="../../../R/b4038acfba3d0922.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r0 rd" class="r0 r">psSessions</span>;
 
            <b>try</b>
            {
                <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a> ||
                    <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a> ||
                    <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a> ||
                    <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)
                {
                    <span class="c">// Query remote computers for disconnected sessions.</span>
                    <span class="r0 r">psSessions</span> = <a href="#304309ad379b0606" class="i method">QueryForDisconnectedSessions</a>();
                }
                <b>else</b>
                {
                    <span class="c">// Collect provided disconnected sessions.</span>
                    <span class="r0 r">psSessions</span> = <a href="#72f1ee92bdd0ee94" class="i method">CollectDisconnectedSessions</a>();
                }
            }
            <b>catch</b> (<a href="../common/remotingexceptions.cs.html#553740d8dd522b58" class="t t">PSRemotingDataStructureException</a>)
            {
                <span class="c">// Allow cmdlet to end and then re-throw exception.</span>
                <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">Set</span>();
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a>)
            {
                <span class="c">// Allow cmdlet to end and then re-throw exception.</span>
                <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">Set</span>();
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../../NativeCommandProcessor.cs.html#d56edc1842249736" class="t t">RemoteException</a>)
            {
                <span class="c">// Allow cmdlet to end and then re-throw exception.</span>
                <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">Set</span>();
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a>)
            {
                <span class="c">// Allow cmdlet to end and then re-throw exception.</span>
                <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">Set</span>();
                <b>throw</b>;
            }
 
            <a href="#7568bec2d985b970" class="i method">ConnectSessions</a>(<span class="r0 r">psSessions</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> End processing clean up.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="97ec98e45933f5ef" href="../../../R/97ec98e45933f5ef.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <a href="#ffdf30c70f04c59d" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#75a1eec170a5d6bc" class="i method">EndSubmitOperations</a>();
 
            <span class="c">// Wait for all connect operations to complete.</span>
            <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">WaitOne</span>();
 
            <span class="c">// If there are failed connect operations due to stale</span>
            <span class="c">// session state then perform the query retry here.</span>
            <b>if</b> (<a href="#b7ceaf47c83d0f9a" class="i field">_failedSessions</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#e5eb49decb712e43" class="i method">RetryFailedSessions</a>();
            }
 
            <span class="c">// Read all objects in the stream pipeline.</span>
            <b>while</b> (<a href="#d25084f8ba5458bc" class="i field">_stream</a>.<a href="../../../utils/ObjectStream.cs.html#abc89c235e72527c" class="i property">ObjectReader</a>.<a href="../../../utils/IObjectReader.cs.html#fb103466fcdb6fb2" class="i property">Count</a> &gt; 0)
            {
                <b>object</b> <span id="r1 rd" class="r1 r">streamObject</span> = <a href="#d25084f8ba5458bc" class="i field">_stream</a>.<a href="../../../utils/ObjectStream.cs.html#abc89c235e72527c" class="i property">ObjectReader</a>.<a href="../../../utils/IObjectReader.cs.html#44674511beae23a4" class="i method">Read</a>();
                <a href="PSRemotingCmdlet.cs.html#8c7d6343604dfd87" class="i method">WriteStreamObject</a>((<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt;)<span class="r1 r">streamObject</span>);
            }
 
            <a href="#d25084f8ba5458bc" class="i field">_stream</a>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<a href="../../../utils/IObjectWriter.cs.html#2c9b22a04af963c5" class="i method">Close</a>();
 
            <span class="c">// Add all successfully connected sessions to local repository.</span>
            <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r2 rd" class="r2 r">psSession</span> <b>in</b> <a href="#6bebd7997c58bf9a" class="i field">_allSessions</a>)
            {
                <b>if</b> (<span class="r2 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
                {
                    <span class="c">// Make sure that this session is included in the PSSession repository.</span>
                    <span class="c">// If it already exists then replace it because we want the latest/connected session in the repository.</span>
                    <a href="#c8f514190276eaf4" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#a860d36943db1f52" class="i method">AddOrReplace</a>(<span class="r2 r">psSession</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User has signaled a stop for this cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="1e7496536e7b0561" href="../../../R/1e7496536e7b0561.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <span class="c">// Close the output stream for any further writes.</span>
            <a href="#d25084f8ba5458bc" class="i field">_stream</a>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<a href="../../../utils/IObjectWriter.cs.html#2c9b22a04af963c5" class="i method">Close</a>();
 
            <span class="c">// Stop any remote server queries that may be running.</span>
            <a href="#c9d7763c951e5cf9" class="i field">_queryRunspaces</a>.<a href="PSRemotingCmdlet.cs.html#46bbc881ce2841f1" class="i method">StopAllOperations</a>();
 
            <span class="c">// Signal the ThrottleManager to stop any further</span>
            <span class="c">// PSSession connect processing.</span>
            <a href="#ffdf30c70f04c59d" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#255a5e90af99543c" class="i method">StopAllOperations</a>();
 
            <span class="c">// Signal the Retry throttle manager in case it is running.</span>
            <a href="#be6ffe85fc03448b" class="i field">_retryThrottleManager</a>.<a href="../common/throttlemanager.cs.html#255a5e90af99543c" class="i method">StopAllOperations</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ConnectRunspaceOperation Class
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throttle class to perform a remoterunspace connect operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="a1fd8894bd0fce90" href="../../../R/a1fd8894bd0fce90.html" target="n" data-glyph="4,1" class="t t">ConnectRunspaceOperation</a> : <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>
        {
            <b>private</b> <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <a id="88fd1e3e059c7853" href="../../../R/88fd1e3e059c7853.html" target="n" data-glyph="46,2" class="i field">_session</a>;
            <b>private</b> <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <a id="997d59421980494a" href="../../../R/997d59421980494a.html" target="n" data-glyph="46,2" class="i field">_oldSession</a>;
            <b>private readonly</b> <a href="../../../utils/ObjectStream.cs.html#247cf7c4c5dec5a4" class="t t">ObjectStream</a> <a id="5151ac0f4894bfc6" href="../../../R/5151ac0f4894bfc6.html" target="n" data-glyph="46,2" class="i field">_writeStream</a>;
            <b>private readonly</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="e8e7a1958d8234ac" href="../../../R/e8e7a1958d8234ac.html" target="n" data-glyph="46,2" class="i field">_retryList</a>;
            <b>private readonly</b> <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <a id="2f87afaeb291903c" href="../../../R/2f87afaeb291903c.html" target="n" data-glyph="46,2" class="i field">_host</a>;
            <b>private readonly</b> <a href="PSRemotingCmdlet.cs.html#2069a7a39daa030c" class="t t">QueryRunspaces</a> <a id="d195dcdca2e3f6c3" href="../../../R/d195dcdca2e3f6c3.html" target="n" data-glyph="46,2" class="i field">_queryRunspaces</a>;
            <b>private static readonly object</b> <a id="2fc18dda36a97938" href="../../../R/2fc18dda36a97938.html" target="n" data-glyph="46,2" class="i field">s_LockObject</a> = <b>new</b> <b>object</b>();
 
            <b>internal</b> <a id="909047fbe09215de" href="../../../R/909047fbe09215de.html" target="n" data-glyph="74,2" class="t constructor">ConnectRunspaceOperation</a>(
                <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r3 rd" class="r3 r">session</span>,
                <a href="../../../utils/ObjectStream.cs.html#247cf7c4c5dec5a4" class="t t">ObjectStream</a> <span id="r4 rd" class="r4 r">stream</span>,
                <a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r5 rd" class="r5 r">host</span>,
                <a href="PSRemotingCmdlet.cs.html#2069a7a39daa030c" class="t t">QueryRunspaces</a> <span id="r6 rd" class="r6 r">queryRunspaces</span>,
                <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r7 rd" class="r7 r">retryList</span>)
            {
                <a href="#88fd1e3e059c7853" class="i field">_session</a> = <span class="r3 r">session</span>;
                <a href="#5151ac0f4894bfc6" class="i field">_writeStream</a> = <span class="r4 r">stream</span>;
                <a href="#2f87afaeb291903c" class="i field">_host</a> = <span class="r5 r">host</span>;
                <a href="#d195dcdca2e3f6c3" class="i field">_queryRunspaces</a> = <span class="r6 r">queryRunspaces</span>;
                <a href="#e8e7a1958d8234ac" class="i field">_retryList</a> = <span class="r7 r">retryList</span>;
                <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> += <span class="i">StateCallBackHandler</span>;
            }
 
            <b>internal override void</b> <a id="3a078851ae045165" href="../../../R/3a078851ae045165.html" target="n" data-glyph="74,2" class="i method">StartOperation</a>()
            {
                <b>bool</b> <span id="r8 rd" class="r8 r">startedSuccessfully</span> = <b>true</b>;
 
                <span class="i">Exception</span> <span id="r9 rd" class="r9 r">ex</span> = <b>null</b>;
                <b>try</b>
                {
                    <b>if</b> (<a href="#d195dcdca2e3f6c3" class="i field">_queryRunspaces</a> != <b>null</b>)
                    {
                        <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r10 rd" class="r10 r">newSession</span> = <a href="#7d7930382ce027b4" class="i method">QueryForSession</a>(<a href="#88fd1e3e059c7853" class="i field">_session</a>);
                        <b>if</b> (<span class="r10 r">newSession</span> != <b>null</b>)
                        {
                            <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">StateCallBackHandler</span>;
                            <a href="#997d59421980494a" class="i field">_oldSession</a> = <a href="#88fd1e3e059c7853" class="i field">_session</a>;
                            <a href="#88fd1e3e059c7853" class="i field">_session</a> = <span class="r10 r">newSession</span>;
                            <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> += <span class="i">StateCallBackHandler</span>;
                            <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#2628903b4c875458" class="i method">ConnectAsync</a>();
                        }
                        <b>else</b>
                        {
                            <span class="r8 r">startedSuccessfully</span> = <b>false</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#2628903b4c875458" class="i method">ConnectAsync</a>();
                    }
                }
                <b>catch</b> (<a href="../../../utils/MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a> <span id="r11 rd" class="r11 r">e</span>)
                {
                    <span class="r9 r">ex</span> = <span class="r11 r">e</span>;
                }
                <b>catch</b> (<a href="../../hostifaces/RunspacePool.cs.html#741ffc1755303d69" class="t t">InvalidRunspacePoolStateException</a> <span id="r12 rd" class="r12 r">e</span>)
                {
                    <span class="r9 r">ex</span> = <span class="r12 r">e</span>;
                }
                <b>catch</b> (<a href="../../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r13 rd" class="r13 r">e</span>)
                {
                    <span class="r9 r">ex</span> = <span class="r13 r">e</span>;
                }
 
                <b>if</b> (<span class="r9 r">ex</span> != <b>null</b>)
                {
                    <span class="r8 r">startedSuccessfully</span> = <b>false</b>;
                    <a href="#12ea93dc5562f186" class="i method">WriteConnectFailed</a>(<span class="r9 r">ex</span>, <a href="#88fd1e3e059c7853" class="i field">_session</a>);
                }
 
                <b>if</b> (!<span class="r8 r">startedSuccessfully</span>)
                {
                    <span class="c">// We are done at this point.  Notify throttle manager.</span>
                    <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">StateCallBackHandler</span>;
                    <a href="#519f3abe6d1d94b7" class="i method">SendStartComplete</a>();
                }
            }
 
            <b>internal override void</b> <a id="9d65c8de86d90819" href="../../../R/9d65c8de86d90819.html" target="n" data-glyph="74,2" class="i method">StopOperation</a>()
            {
                <b>if</b> (<a href="#d195dcdca2e3f6c3" class="i field">_queryRunspaces</a> != <b>null</b>)
                {
                    <a href="#d195dcdca2e3f6c3" class="i field">_queryRunspaces</a>.<a href="PSRemotingCmdlet.cs.html#46bbc881ce2841f1" class="i method">StopAllOperations</a>();
                }
 
                <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">StateCallBackHandler</span>;
                <a href="#b2eacd8f73112e50" class="i method">SendStopComplete</a>();
            }
 
            <b>internal override event</b> <span class="i">EventHandler</span>&lt;<a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a>&gt; <a id="248da1d20a47c21e" href="../../../R/248da1d20a47c21e.html" target="n" data-glyph="32,2" class="i">OperationComplete</a>;
 
            <b>internal</b> <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <a id="7d7930382ce027b4" href="../../../R/7d7930382ce027b4.html" target="n" data-glyph="74,2" class="i method">QueryForSession</a>(<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r14 rd" class="r14 r">session</span>)
            {
                <span class="i">Collection</span>&lt;<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>&gt; <span id="r15 rd" class="r15 r">wsManConnectionInfos</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>&gt;();
                <span class="r15 r">wsManConnectionInfos</span>.<span class="i">Add</span>(<span class="r14 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#7ff4c79fcb624bf1" class="i property">ConnectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>);
 
                <span class="i">Exception</span> <span id="r16 rd" class="r16 r">ex</span> = <b>null</b>;
                <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r17 rd" class="r17 r">sessions</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="r17 r">sessions</span> = <a href="#d195dcdca2e3f6c3" class="i field">_queryRunspaces</a>.<a href="PSRemotingCmdlet.cs.html#575b3e50dfacf4ff" class="i method">GetDisconnectedSessions</a>(<span class="r15 r">wsManConnectionInfos</span>, <a href="#2f87afaeb291903c" class="i field">_host</a>, <a href="#5151ac0f4894bfc6" class="i field">_writeStream</a>, <b>null</b>,
                        0, <a href="PSRemotingCmdlet.cs.html#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="PSRemotingCmdlet.cs.html#9c839bbb7cf37aff" class="i field">Disconnected</a>, <b>new</b> <span class="i">Guid</span>[] { <span class="r14 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a> }, <b>null</b>, <b>null</b>);
                }
                <b>catch</b> (<a href="../../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r18 rd" class="r18 r">e</span>)
                {
                    <span class="r16 r">ex</span> = <span class="r18 r">e</span>;
                }
 
                <b>if</b> (<span class="r16 r">ex</span> != <b>null</b>)
                {
                    <a href="#12ea93dc5562f186" class="i method">WriteConnectFailed</a>(<span class="r16 r">ex</span>, <span class="r14 r">session</span>);
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r17 r">sessions</span>.<span class="i">Count</span> != 1)
                {
                    <span class="r16 r">ex</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CannotFindSessionForConnect</span>,
                        <span class="r14 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r14 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>));
 
                    <a href="#12ea93dc5562f186" class="i method">WriteConnectFailed</a>(<span class="r16 r">ex</span>, <span class="r14 r">session</span>);
                    <b>return</b> <b>null</b>;
                }
 
                <b>return</b> <span class="r17 r">sessions</span>[0];
            }
 
            <b>private void</b> <a id="bca4fc78bd2bd8c0" href="../../../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">StateCallBackHandler</a>(<b>object</b> <span id="r19 rd" class="r19 r">sender</span>, <a href="../../hostifaces/Connection.cs.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a> <span id="r20 rd" class="r20 r">eArgs</span>)
            {
                <b>if</b> (<span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#1c027aab2310d438" class="i field">Connecting</a> ||
                    <span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#31c8fe83ad58dbdb" class="i field">Disconnecting</a> ||
                    <span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>)
                {
                    <b>return</b>;
                }
 
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>, <span class="s">&quot;Can&#39;t reconnect a session that hasn&#39;t been previously Opened&quot;</span>);
                <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#3990ad8b3e3feec7" class="i field">Opening</a>, <span class="s">&quot;Can&#39;t reconnect a session that hasn&#39;t been previously Opened&quot;</span>);
 
                <b>if</b> (<span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
                {
                    <span class="c">// Connect operation succeeded, write the PSSession object.</span>
                    <a href="#b8fa13221ec8e19e" class="i method">WriteConnectedPSSession</a>();
                }
                <b>else</b>
                {
                    <span class="c">// Check to see if failure is due to stale PSSession error and</span>
                    <span class="c">// add to retry list if this is the case.</span>
                    <b>bool</b> <span id="r21 rd" class="r21 r">writeError</span> = <b>true</b>;
                    <b>if</b> (<a href="#d195dcdca2e3f6c3" class="i field">_queryRunspaces</a> == <b>null</b>)
                    {
                        <a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a> <span id="r22 rd" class="r22 r">transportException</span> = <span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#c342411ef74d93be" class="i property">Reason</a> <b>as</b> <a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a>;
                        <b>if</b> (<span class="r22 r">transportException</span> != <b>null</b> &amp;&amp;
                            <span class="r22 r">transportException</span>.<a href="../common/remotingexceptions.cs.html#f96218464c4b7244" class="i property">ErrorCode</a> == <a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#728972c090c1c619" class="i field">ERROR_WSMAN_INUSE_CANNOT_RECONNECT</a>)
                        {
                            <b>lock</b> (<a href="#2fc18dda36a97938" class="i field">s_LockObject</a>)
                            {
                                <a href="#e8e7a1958d8234ac" class="i field">_retryList</a>.<span class="i">Add</span>(<a href="#88fd1e3e059c7853" class="i field">_session</a>);
                            }
 
                            <span class="r21 r">writeError</span> = <b>false</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r21 r">writeError</span>)
                    {
                        <span class="c">// Connect operation failed, write error.</span>
                        <a href="#12ea93dc5562f186" class="i method">WriteConnectFailed</a>(<span class="r20 r">eArgs</span>.<a href="../../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#c342411ef74d93be" class="i property">Reason</a>, <a href="#88fd1e3e059c7853" class="i field">_session</a>);
                    }
                }
 
                <a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">StateCallBackHandler</span>;
                <a href="#519f3abe6d1d94b7" class="i method">SendStartComplete</a>();
            }
 
            <b>private void</b> <a id="519f3abe6d1d94b7" href="../../../R/519f3abe6d1d94b7.html" target="n" data-glyph="76,2" class="i method">SendStartComplete</a>()
            {
                <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r23 rd" class="r23 r">operationStateEventArgs</span> = <b>new</b> <span class="t">OperationStateEventArgs</span>();
                <span class="r23 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#8648129d937c33ce" class="i property">OperationState</a> = <a href="../common/throttlemanager.cs.html#6cf95059c5d2ad6e" class="t t">OperationState</a>.<a href="../common/throttlemanager.cs.html#bad569808247de6a" class="i field">StartComplete</a>;
                <a href="#248da1d20a47c21e" class="i">OperationComplete</a>.<span class="i">SafeInvoke</span>(<a href="#a1fd8894bd0fce90" class="k">this</a>, <span class="r23 r">operationStateEventArgs</span>);
            }
 
            <b>private void</b> <a id="b2eacd8f73112e50" href="../../../R/b2eacd8f73112e50.html" target="n" data-glyph="76,2" class="i method">SendStopComplete</a>()
            {
                <a href="../common/throttlemanager.cs.html#ef7de7ace48bc7ae" class="t t">OperationStateEventArgs</a> <span id="r24 rd" class="r24 r">operationStateEventArgs</span> = <b>new</b> <span class="t">OperationStateEventArgs</span>();
                <span class="r24 r">operationStateEventArgs</span>.<a href="../common/throttlemanager.cs.html#8648129d937c33ce" class="i property">OperationState</a> = <a href="../common/throttlemanager.cs.html#6cf95059c5d2ad6e" class="t t">OperationState</a>.<a href="../common/throttlemanager.cs.html#c2e1a69d3e84f187" class="i field">StopComplete</a>;
                <a href="#248da1d20a47c21e" class="i">OperationComplete</a>.<span class="i">SafeInvoke</span>(<a href="#a1fd8894bd0fce90" class="k">this</a>, <span class="r24 r">operationStateEventArgs</span>);
            }
 
            <b>private void</b> <a id="b8fa13221ec8e19e" href="../../../R/b8fa13221ec8e19e.html" target="n" data-glyph="76,2" class="i method">WriteConnectedPSSession</a>()
            {
                <span class="c">// Use temporary variable because we need to preserve _session class variable</span>
                <span class="c">// for later clean up.</span>
                <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r25 rd" class="r25 r">outSession</span> = <a href="#88fd1e3e059c7853" class="i field">_session</a>;
                <b>if</b> (<a href="#d195dcdca2e3f6c3" class="i field">_queryRunspaces</a> != <b>null</b>)
                {
                    <b>lock</b> (<a href="#2fc18dda36a97938" class="i field">s_LockObject</a>)
                    {
                        <span class="c">// Pass back the original session if possible.</span>
                        <b>if</b> (<a href="#997d59421980494a" class="i field">_oldSession</a> != <b>null</b> &amp;&amp;
                            <a href="#997d59421980494a" class="i field">_oldSession</a>.<a href="../client/remoterunspaceinfo.cs.html#831c787a4af64120" class="i method">InsertRunspace</a>(<a href="#88fd1e3e059c7853" class="i field">_session</a>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a> <b>as</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>))
                        {
                            <span class="r25 r">outSession</span> = <a href="#997d59421980494a" class="i field">_oldSession</a>;
                            <a href="#e8e7a1958d8234ac" class="i field">_retryList</a>.<span class="i">Add</span>(<a href="#997d59421980494a" class="i field">_oldSession</a>);
                        }
                        <b>else</b>
                        {
                            <a href="#e8e7a1958d8234ac" class="i field">_retryList</a>.<span class="i">Add</span>(<a href="#88fd1e3e059c7853" class="i field">_session</a>);
                        }
                    }
                }
 
                <b>if</b> (<a href="#5151ac0f4894bfc6" class="i field">_writeStream</a>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<a href="../../../utils/IObjectWriter.cs.html#37eb9b5d6b3e954a" class="i property">IsOpen</a>)
                {
                    <span class="c">// This code is based on ThrottleManager infrastructure</span>
                    <span class="c">// and this particular method may be called on a thread that</span>
                    <span class="c">// is different from Pipeline Execution Thread. Hence using</span>
                    <span class="c">// a delegate to perform the WriteObject.</span>
                    <span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt; <span id="r26 rd" class="r26 r">outputWriter</span> = (<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r27 rd" class="r27 r">cmdlet</span>) =&gt; <span class="r27 r">cmdlet</span>.<a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r25 r">outSession</span>);
                    <a href="#5151ac0f4894bfc6" class="i field">_writeStream</a>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<span class="i">Write</span>(<span class="r26 r">outputWriter</span>);
                }
            }
 
            <b>private void</b> <a id="12ea93dc5562f186" href="../../../R/12ea93dc5562f186.html" target="n" data-glyph="76,2" class="i method">WriteConnectFailed</a>(
                <span class="i">Exception</span> <span id="r28 rd" class="r28 r">e</span>,
                <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r29 rd" class="r29 r">session</span>)
            {
                <b>if</b> (<a href="#5151ac0f4894bfc6" class="i field">_writeStream</a>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<a href="../../../utils/IObjectWriter.cs.html#37eb9b5d6b3e954a" class="i property">IsOpen</a>)
                {
                    <b>string</b> <span id="r30 rd" class="r30 r">FQEID</span> = <span class="s">&quot;PSSessionConnectFailed&quot;</span>;
                    <span class="i">Exception</span> <span id="r31 rd" class="r31 r">reason</span>;
                    <b>if</b> (<span class="r28 r">e</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r28 r">e</span>.<span class="i">Message</span>))
                    {
                        <span class="c">// Update fully qualified error Id if we have a transport error.</span>
                        <a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a> <span id="r32 rd" class="r32 r">transportException</span> = <span class="r28 r">e</span> <b>as</b> <a href="../common/remotingexceptions.cs.html#0bb8687f97d91059" class="t t">PSRemotingTransportException</a>;
                        <b>if</b> (<span class="r32 r">transportException</span> != <b>null</b>)
                        {
                            <span class="r30 r">FQEID</span> = <a href="../fanin/WSManTransportManager.cs.html#b4291df75d9bc408" class="t t">WSManTransportManagerUtils</a>.<a href="../fanin/WSManTransportManager.cs.html#d3bf2dfca72ae399" class="i method">GetFQEIDFromTransportError</a>(<span class="r32 r">transportException</span>.<a href="../common/remotingexceptions.cs.html#f96218464c4b7244" class="i property">ErrorCode</a>, <span class="r30 r">FQEID</span>);
                        }
 
                        <span class="r31 r">reason</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e550883d468d8c30" class="t constructor">RuntimeException</a>(
                            <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RunspaceConnectFailedWithMessage</span>, <span class="r29 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r28 r">e</span>.<span class="i">Message</span>),
                            <span class="r28 r">e</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r31 r">reason</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e550883d468d8c30" class="t constructor">RuntimeException</a>(
                            <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RunspaceConnectFailed</span>, <span class="r29 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>,
                                <span class="r29 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>.<span class="i">ToString</span>()), <b>null</b>);
                    }
 
                    <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r33 rd" class="r33 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r31 r">reason</span>, <span class="r30 r">FQEID</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                    <span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt; <span id="r34 rd" class="r34 r">errorWriter</span> = (<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r35 rd" class="r35 r">cmdlet</span>) =&gt; <span class="r35 r">cmdlet</span>.<a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r33 r">errorRecord</span>);
                    <a href="#5151ac0f4894bfc6" class="i field">_writeStream</a>.<a href="../../../utils/ObjectStream.cs.html#fc0d00ddb2d6ec0c" class="i property">ObjectWriter</a>.<span class="i">Write</span>(<span class="r34 r">errorWriter</span>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enum indicating an override on which parameter is used to filter</span>
        <span class="c">///</span><span class="c"> local sessions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private enum</b> <a id="43a8f548d9a6f10f" href="../../../R/43a8f548d9a6f10f.html" target="n" data-glyph="22,1" class="t t"><span id="aa01a50c82587dce">OverrideParameter</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> No override.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="15b24a4543e5ed18" href="../../../R/15b24a4543e5ed18.html" target="n" data-glyph="24,2" class="i field">None</a> = 0,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use the Name parameter as a filter.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="ffc2950cee83499f" href="../../../R/ffc2950cee83499f.html" target="n" data-glyph="24,2" class="i field">Name</a> = 1,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Use the InstanceId parameter as a filter.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="19938eb23f59ab69" href="../../../R/19938eb23f59ab69.html" target="n" data-glyph="24,2" class="i field">InstanceId</a> = 2
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves a collection of disconnected PSSession objects queried from</span>
        <span class="c">///</span><span class="c"> remote computers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Collection of disconnected PSSession objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="304309ad379b0606" href="../../../R/304309ad379b0606.html" target="n" data-glyph="76,1" class="i method">QueryForDisconnectedSessions</a>()
        {
            <span class="i">Collection</span>&lt;<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>&gt; <span id="r36 rd" class="r36 r">connectionInfos</span> = <a href="#1e5f605cb930aa06" class="i method">GetConnectionObjects</a>();
            <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r37 rd" class="r37 r">psSessions</span> = <a href="#c9d7763c951e5cf9" class="i field">_queryRunspaces</a>.<a href="PSRemotingCmdlet.cs.html#575b3e50dfacf4ff" class="i method">GetDisconnectedSessions</a>(<span class="r36 r">connectionInfos</span>, <a href="#c8f514190276eaf4" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>, <a href="#d25084f8ba5458bc" class="i field">_stream</a>,
                                                    <a href="#c8f514190276eaf4" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>, <a href="#fdd646a12e378259" class="i property">ThrottleLimit</a>,
                                                    <a href="PSRemotingCmdlet.cs.html#5a1d06b9138c1065" class="t t">SessionFilterState</a>.<a href="PSRemotingCmdlet.cs.html#9c839bbb7cf37aff" class="i field">Disconnected</a>, <a href="#c8f514190276eaf4" class="k">this</a>.<a href="#469c37f7b7f68f82" class="i property">InstanceId</a>, <a href="#c8f514190276eaf4" class="k">this</a>.<a href="#88947c9439555727" class="i property">Name</a>, <a href="#eaa344830877829e" class="i property">ConfigurationName</a>);
 
            <span class="c">// Write any error output from stream object.</span>
            <span class="i">Collection</span>&lt;<b>object</b>&gt; <span id="r38 rd" class="r38 r">streamObjects</span> = <a href="#d25084f8ba5458bc" class="i field">_stream</a>.<a href="../../../utils/ObjectStream.cs.html#abc89c235e72527c" class="i property">ObjectReader</a>.<a href="../../../utils/IObjectReader.cs.html#eb2b4dcc329feb84" class="i method">NonBlockingRead</a>();
            <b>foreach</b> (<b>object</b> <span id="r39 rd" class="r39 r">streamObject</span> <b>in</b> <span class="r38 r">streamObjects</span>)
            {
                <a href="PSRemotingCmdlet.cs.html#8c7d6343604dfd87" class="i method">WriteStreamObject</a>((<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt;)<span class="r39 r">streamObject</span>);
            }
 
            <b>return</b> <span class="r37 r">psSessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a collection of PSSession objects based on cmdlet parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">overrideParam</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">OverrideParameter.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Collection of PSSession objects in disconnected state.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="72f1ee92bdd0ee94" href="../../../R/72f1ee92bdd0ee94.html" target="n" data-glyph="76,1" class="i method">CollectDisconnectedSessions</a>(<a href="#43a8f548d9a6f10f" class="t t">OverrideParameter</a> <span id="r40 rd" class="r40 r">overrideParam</span> = <a href="#43a8f548d9a6f10f" class="t t">OverrideParameter</a>.<a href="#15b24a4543e5ed18" class="i field">None</a>)
        {
            <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r41 rd" class="r41 r">psSessions</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
            <span class="c">// Get all remote runspaces to disconnect.</span>
            <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="DisconnectPSSession.cs.html#ba1ee4b9df5c537f" class="t t">DisconnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)
            {
                <b>if</b> (<a href="#1e2c0144a46a25b9" class="i property">Session</a> != <b>null</b>)
                {
                    <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r42 rd" class="r42 r">psSession</span> <b>in</b> <a href="#1e2c0144a46a25b9" class="i property">Session</a>)
                    {
                        <span class="r41 r">psSessions</span>.<span class="i">Add</span>(<span class="r42 r">psSession</span>);
                    }
                }
            }
            <b>else</b>
            {
                <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r43 rd" class="r43 r">entries</span> = <b>null</b>;
 
                <b>switch</b> (<span class="r40 r">overrideParam</span>)
                {
                    <b>case</b> <a href="#43a8f548d9a6f10f" class="t t">OverrideParameter</a>.<a href="#15b24a4543e5ed18" class="i field">None</a>:
                        <span class="r43 r">entries</span> = <a href="PSRemotingCmdlet.cs.html#38d17b882da28e38" class="i method">GetMatchingRunspaces</a>(<b>false</b>, <b>true</b>);
                        <b>break</b>;
 
                    <b>case</b> <a href="#43a8f548d9a6f10f" class="t t">OverrideParameter</a>.<a href="#ffc2950cee83499f" class="i field">Name</a>:
                        <span class="r43 r">entries</span> = <a href="PSRemotingCmdlet.cs.html#62ccf8b82f283414" class="i method">GetMatchingRunspacesByName</a>(<b>false</b>, <b>true</b>);
                        <b>break</b>;
 
                    <b>case</b> <a href="#43a8f548d9a6f10f" class="t t">OverrideParameter</a>.<a href="#19938eb23f59ab69" class="i field">InstanceId</a>:
                        <span class="r43 r">entries</span> = <a href="PSRemotingCmdlet.cs.html#a40d645bf31024ef" class="i method">GetMatchingRunspacesByRunspaceId</a>(<b>false</b>, <b>true</b>);
                        <b>break</b>;
                }
 
                <b>if</b> (<span class="r43 r">entries</span> != <b>null</b>)
                {
                    <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r44 rd" class="r44 r">psSession</span> <b>in</b> <span class="r43 r">entries</span>.<span class="i">Values</span>)
                    {
                        <span class="r41 r">psSessions</span>.<span class="i">Add</span>(<span class="r44 r">psSession</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r41 r">psSessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Connect all disconnected sessions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="7568bec2d985b970" href="../../../R/7568bec2d985b970.html" target="n" data-glyph="76,1" class="i method">ConnectSessions</a>(<span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r45 rd" class="r45 r">psSessions</span>)
        {
            <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r46 rd" class="r46 r">connectOperations</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt;();
 
            <span class="c">// Create a disconnect operation for each runspace to disconnect.</span>
            <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r47 rd" class="r47 r">psSession</span> <b>in</b> <span class="r45 r">psSessions</span>)
            {
                <b>if</b> (<a href="../../cmdlet.cs.html#5f125d2ab6d0970d" class="i method">ShouldProcess</a>(<span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <a href="../../../utils/Verbs.cs.html#4b3c39661547d6b5" class="t t">VerbsCommunications</a>.<a href="../../../utils/Verbs.cs.html#3e697c53a18c7f1f" class="i field">Connect</a>))
                {
                    <b>if</b> (<span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#37303737eaf45092" class="i property">ComputerType</a> != <a href="../client/remoterunspaceinfo.cs.html#01e02e9170262f80" class="t t">TargetMachineType</a>.<a href="../client/remoterunspaceinfo.cs.html#5d3982d1dfc3da60" class="i field">RemoteMachine</a>)
                    {
                        <span class="c">// PS session disconnection is not supported for VM/Container sessions.</span>
                        <b>string</b> <span id="r48 rd" class="r48 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RunspaceCannotBeConnectedForVMContainerSession</span>,
                            <span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>, <span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#37303737eaf45092" class="i property">ComputerType</a>);
                        <span class="i">Exception</span> <span id="r49 rd" class="r49 r">reason</span> = <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#021b4370ebdc2266" class="t constructor">PSNotSupportedException</a>(<span class="r48 r">msg</span>);
                        <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r50 rd" class="r50 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r49 r">reason</span>, <span class="s">&quot;CannotConnectVMContainerSession&quot;</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r47 r">psSession</span>);
                        <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r50 r">errorRecord</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a> &amp;&amp;
                        <span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#a5172055c7a11352" class="i field">None</a>)
                    {
                        <span class="c">// Can only connect sessions that are in Disconnected state.</span>
                        <span class="c">// Update session connection information based on cmdlet parameters.</span>
                        <a href="#02d906c857e70834" class="i method">UpdateConnectionInfo</a>(<span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#7ff4c79fcb624bf1" class="i property">ConnectionInfo</a> <b>as</b> <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>);
 
                        <a href="#a1fd8894bd0fce90" class="t t">ConnectRunspaceOperation</a> <span id="r51 rd" class="r51 r">connectOperation</span> = <b>new</b> <a href="#909047fbe09215de" class="t constructor">ConnectRunspaceOperation</a>(
                            <span class="r47 r">psSession</span>,
                            <a href="#d25084f8ba5458bc" class="i field">_stream</a>,
                            <a href="#c8f514190276eaf4" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>,
                            <b>null</b>,
                            <a href="#b7ceaf47c83d0f9a" class="i field">_failedSessions</a>);
                        <span class="r46 r">connectOperations</span>.<span class="i">Add</span>(<span class="r51 r">connectOperation</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
                    {
                        <span class="c">// Write error record if runspace is not already in the Opened state.</span>
                        <b>string</b> <span id="r52 rd" class="r52 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RunspaceCannotBeConnected</span>, <span class="r47 r">psSession</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>);
                        <span class="i">Exception</span> <span id="r53 rd" class="r53 r">reason</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<span class="r52 r">msg</span>);
                        <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r54 rd" class="r54 r">errorRecord</span> = <b>new</b> <a href="../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r53 r">reason</span>, <span class="s">&quot;PSSessionConnectFailed&quot;</span>, <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r47 r">psSession</span>);
                        <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<span class="r54 r">errorRecord</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Session is already connected.  Write to output.</span>
                        <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r47 r">psSession</span>);
                    }
                }
 
                <a href="#6bebd7997c58bf9a" class="i field">_allSessions</a>.<span class="i">Add</span>(<span class="r47 r">psSession</span>);
            }
 
            <b>if</b> (<span class="r46 r">connectOperations</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Make sure operations are not set as complete while processing input.</span>
                <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">Reset</span>();
 
                <span class="c">// Submit list of connect operations.</span>
                <a href="#ffdf30c70f04c59d" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#ee8f2ac038103ebc" class="i method">SubmitOperations</a>(<span class="r46 r">connectOperations</span>);
 
                <span class="c">// Write any output now.</span>
                <span class="i">Collection</span>&lt;<b>object</b>&gt; <span id="r55 rd" class="r55 r">streamObjects</span> = <a href="#d25084f8ba5458bc" class="i field">_stream</a>.<a href="../../../utils/ObjectStream.cs.html#abc89c235e72527c" class="i property">ObjectReader</a>.<a href="../../../utils/IObjectReader.cs.html#eb2b4dcc329feb84" class="i method">NonBlockingRead</a>();
                <b>foreach</b> (<b>object</b> <span id="r56 rd" class="r56 r">streamObject</span> <b>in</b> <span class="r55 r">streamObjects</span>)
                {
                    <a href="PSRemotingCmdlet.cs.html#8c7d6343604dfd87" class="i method">WriteStreamObject</a>((<span class="i">Action</span>&lt;<a href="../../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>&gt;)<span class="r56 r">streamObject</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handles the connect throttling complete event from the ThrottleManager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sender.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">EventArgs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="c263344048058c50" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleThrottleConnectComplete</a>(<b>object</b> <span id="r57 rd" class="r57 r">sender</span>, <span class="i">EventArgs</span> <span id="r58 rd" class="r58 r">eventArgs</span>)
        {
            <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">Set</span>();
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>&gt; <a id="1e5f605cb930aa06" href="../../../R/1e5f605cb930aa06.html" target="n" data-glyph="76,1" class="i method">GetConnectionObjects</a>()
        {
            <span class="i">Collection</span>&lt;<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>&gt; <span id="r59 rd" class="r59 r">connectionInfos</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>&gt;();
 
            <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a> ||
                <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#6bfe75f87dadd3b1" class="i field">ComputerNameGuidParameterSet</a>)
            {
                <b>string</b> <span id="r60 rd" class="r60 r">scheme</span> = <a href="#457909fd8f4c52fa" class="i property">UseSSL</a>.<a href="../../MshCmdlet.cs.html#e9c777a85700d3da" class="i property">IsPresent</a> ? <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#e8cee89627b2168d" class="i field">HttpsScheme</a> : <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="../common/RunspaceConnectionInfo.cs.html#46c932f319b767db" class="i field">HttpScheme</a>;
 
                <b>foreach</b> (<b>string</b> <span id="r61 rd" class="r61 r">computerName</span> <b>in</b> <a href="#f3155e1132d38390" class="i property">ComputerName</a>)
                {
                    <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r62 rd" class="r62 r">connectionInfo</span> = <b>new</b> <a href="../common/RunspaceConnectionInfo.cs.html#633c07f34544868e" class="t constructor">WSManConnectionInfo</a>();
                    <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#d29b8b073c4a8931" class="i property">Scheme</a> = <span class="r60 r">scheme</span>;
                    <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#74b71e9668d24a47" class="i property">ComputerName</a> = <a href="PSRemotingCmdlet.cs.html#bd0c84ecceec9eb5" class="i method">ResolveComputerName</a>(<span class="r61 r">computerName</span>);
                    <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#0757157b257825db" class="i property">AppName</a> = <a href="#dbaaaed97222bd8c" class="i property">ApplicationName</a>;
                    <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#a0ee4c890acec948" class="i property">ShellUri</a> = <a href="#eaa344830877829e" class="i property">ConfigurationName</a>;
                    <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#1aeb2cc802b3a879" class="i property">Port</a> = <a href="#0d7e28533f097586" class="i property">Port</a>;
                    <b>if</b> (<a href="#4c66ef845665dd06" class="i property">CertificateThumbprint</a> != <b>null</b>)
                    {
                        <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#4589105955753e41" class="i property">CertificateThumbprint</a> = <a href="#4c66ef845665dd06" class="i property">CertificateThumbprint</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#5a783a782d2a0c8e" class="i property">Credential</a> = <a href="#d9184f9b510c7a9f" class="i property">Credential</a>;
                    }
 
                    <span class="r62 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#e1a2e5b5a5d08c41" class="i property">AuthenticationMechanism</a> = <a href="#520b6487af5ff63b" class="i property">Authentication</a>;
                    <a href="#02d906c857e70834" class="i method">UpdateConnectionInfo</a>(<span class="r62 r">connectionInfo</span>);
 
                    <span class="r59 r">connectionInfos</span>.<span class="i">Add</span>(<span class="r62 r">connectionInfo</span>);
                }
            }
            <b>else</b> <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a> ||
                     <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)
            {
                <b>foreach</b> (<b>var</b> <span id="r63 rd" class="r63 r">connectionUri</span> <b>in</b> <a href="#beaf5bb73c1d2c08" class="i property">ConnectionUri</a>)
                {
                    <a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r64 rd" class="r64 r">connectionInfo</span> = <b>new</b> <a href="../common/RunspaceConnectionInfo.cs.html#633c07f34544868e" class="t constructor">WSManConnectionInfo</a>();
                    <span class="r64 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#eb73ffdb9b586505" class="i property">ConnectionUri</a> = <span class="r63 r">connectionUri</span>;
                    <span class="r64 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#a0ee4c890acec948" class="i property">ShellUri</a> = <a href="#eaa344830877829e" class="i property">ConfigurationName</a>;
                    <b>if</b> (<a href="#4c66ef845665dd06" class="i property">CertificateThumbprint</a> != <b>null</b>)
                    {
                        <span class="r64 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#4589105955753e41" class="i property">CertificateThumbprint</a> = <a href="#4c66ef845665dd06" class="i property">CertificateThumbprint</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r64 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#5a783a782d2a0c8e" class="i property">Credential</a> = <a href="#d9184f9b510c7a9f" class="i property">Credential</a>;
                    }
 
                    <span class="r64 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#e1a2e5b5a5d08c41" class="i property">AuthenticationMechanism</a> = <a href="#520b6487af5ff63b" class="i property">Authentication</a>;
                    <a href="#02d906c857e70834" class="i method">UpdateConnectionInfo</a>(<span class="r64 r">connectionInfo</span>);
 
                    <span class="r59 r">connectionInfos</span>.<span class="i">Add</span>(<span class="r64 r">connectionInfo</span>);
                }
            }
 
            <b>return</b> <span class="r59 r">connectionInfos</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Updates connection info with the data read from cmdlet&#39;s parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">connectionInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="02d906c857e70834" href="../../../R/02d906c857e70834.html" target="n" data-glyph="76,1" class="i method">UpdateConnectionInfo</a>(<a href="../common/RunspaceConnectionInfo.cs.html#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r65 rd" class="r65 r">connectionInfo</span>)
        {
            <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> != <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#ef8c8b4cee4c03d9" class="i field">ConnectionUriParameterSet</a> &amp;&amp;
                <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> != <a href="#c8f514190276eaf4" class="t t">ConnectPSSessionCommand</a>.<a href="#a7dd6ed3f79a9da2" class="i field">ConnectionUriGuidParameterSet</a>)
            {
                <span class="c">// uri redirection is supported only with URI parameter set</span>
                <span class="r65 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#21431be8484ed16e" class="i property">MaximumConnectionRedirectionCount</a> = 0;
            }
 
            <b>if</b> (!<a href="#24a12d63e82bb36b" class="i field">_allowRedirection</a>)
            {
                <span class="c">// uri redirection required explicit user consent</span>
                <span class="r65 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#21431be8484ed16e" class="i property">MaximumConnectionRedirectionCount</a> = 0;
            }
 
            <span class="c">// Update the connectionInfo object with passed in session options.</span>
            <b>if</b> (<a href="#8e3dd2444e430b71" class="i property">SessionOption</a> != <b>null</b>)
            {
                <span class="r65 r">connectionInfo</span>.<a href="../common/RunspaceConnectionInfo.cs.html#90a3b8c25397a311" class="i method">SetSessionOptions</a>(<a href="#8e3dd2444e430b71" class="i property">SessionOption</a>);
            }
        }
 
        <b>private void</b> <a id="e5eb49decb712e43" href="../../../R/e5eb49decb712e43.html" target="n" data-glyph="76,1" class="i method">RetryFailedSessions</a>()
        {
            <b>using</b> (<span class="i">ManualResetEvent</span> <span id="r66 rd" class="r66 r">retrysComplete</span> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>false</b>))
            {
                <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r67 rd" class="r67 r">connectedSessions</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
                <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt; <span id="r68 rd" class="r68 r">retryConnectionOperations</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>&gt;();
                <a href="#be6ffe85fc03448b" class="i field">_retryThrottleManager</a>.<a href="../common/throttlemanager.cs.html#c88c6759bac73d6d" class="i property">ThrottleLimit</a> = <a href="#fdd646a12e378259" class="i property">ThrottleLimit</a>;
                <a href="#be6ffe85fc03448b" class="i field">_retryThrottleManager</a>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> += (<span id="r69 rd" class="r69 r">sender</span>, <span id="r70 rd" class="r70 r">eventArgs</span>) =&gt;
                    {
                        <b>try</b>
                        {
                            <span class="r66 r">retrysComplete</span>.<span class="i">Set</span>();
                        }
                        <b>catch</b> (<span class="i">ObjectDisposedException</span>) { }
                    };
 
                <b>foreach</b> (<b>var</b> <span id="r71 rd" class="r71 r">session</span> <b>in</b> <a href="#b7ceaf47c83d0f9a" class="i field">_failedSessions</a>)
                {
                    <span class="r68 r">retryConnectionOperations</span>.<span class="i">Add</span>(<b>new</b> <span class="t">ConnectRunspaceOperation</span>(
                        <span class="r71 r">session</span>,
                        <a href="#d25084f8ba5458bc" class="i field">_stream</a>,
                        <a href="#c8f514190276eaf4" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>,
                        <b>new</b> <a href="PSRemotingCmdlet.cs.html#5992ed76877fce33" class="t constructor">QueryRunspaces</a>(),
                        <span class="r67 r">connectedSessions</span>));
                }
 
                <a href="#be6ffe85fc03448b" class="i field">_retryThrottleManager</a>.<a href="../common/throttlemanager.cs.html#ee8f2ac038103ebc" class="i method">SubmitOperations</a>(<span class="r68 r">retryConnectionOperations</span>);
                <a href="#be6ffe85fc03448b" class="i field">_retryThrottleManager</a>.<a href="../common/throttlemanager.cs.html#75a1eec170a5d6bc" class="i method">EndSubmitOperations</a>();
 
                <span class="r66 r">retrysComplete</span>.<span class="i">WaitOne</span>();
 
                <span class="c">// Add or replace all successfully connected sessions to the local repository.</span>
                <b>foreach</b> (<b>var</b> <span id="r72 rd" class="r72 r">session</span> <b>in</b> <span class="r67 r">connectedSessions</span>)
                {
                    <a href="#c8f514190276eaf4" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<span class="i">AddOrReplace</span>(<span class="r72 r">session</span>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose method of IDisposable. Gets called in the following cases:</span>
        <span class="c">///</span><span class="c">     1. Pipeline explicitly calls dispose on cmdlets</span>
        <span class="c">///</span><span class="c">     2. Called by the garbage collector.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="af4cffb24332d7cd" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#61b8123f58fb6b7f" class="i method">Dispose</a>(<b>true</b>);
 
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#c8f514190276eaf4" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal dispose method which does the actual</span>
        <span class="c">///</span><span class="c"> dispose operations and finalize suppressions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Whether method is called</span>
        <span class="c">///</span><span class="c"> from Dispose or destructor</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="61b8123f58fb6b7f" href="../../../R/61b8123f58fb6b7f.html" target="n" data-glyph="76,1" class="i method">Dispose</a>(<b>bool</b> <span id="r73 rd" class="r73 r">disposing</span>)
        {
            <b>if</b> (<span class="r73 r">disposing</span>)
            {
                <a href="#ffdf30c70f04c59d" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd620168185a530e" class="i method">Dispose</a>();
 
                <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">WaitOne</span>();
                <a href="#18840efdea77da6b" class="i field">_operationsComplete</a>.<span class="i">Dispose</span>();
 
                <a href="#ffdf30c70f04c59d" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> -= <span class="i">HandleThrottleConnectComplete</span>;
                <a href="#be6ffe85fc03448b" class="i field">_retryThrottleManager</a>.<a href="../common/throttlemanager.cs.html#dd620168185a530e" class="i method">Dispose</a>();
 
                <a href="#d25084f8ba5458bc" class="i field">_stream</a>.<a href="../../../utils/ObjectStream.cs.html#e609f46566bbc0e2" class="i method">Dispose</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <span class="c">// Collection of PSSessions to be connected.</span>
        <b>private readonly</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="6bebd7997c58bf9a" href="../../../R/6bebd7997c58bf9a.html" target="n" data-glyph="46,1" class="i field">_allSessions</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
        <span class="c">// Object used to perform network disconnect operations in a limited manner.</span>
        <b>private readonly</b> <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <a id="ffdf30c70f04c59d" href="../../../R/ffdf30c70f04c59d.html" target="n" data-glyph="46,1" class="i field">_throttleManager</a> = <b>new</b> <a href="../common/throttlemanager.cs.html#21c77408b36939a4" class="t constructor">ThrottleManager</a>();
 
        <span class="c">// Event indicating that all disconnect operations through the ThrottleManager</span>
        <span class="c">// are complete.</span>
        <b>private readonly</b> <span class="i">ManualResetEvent</span> <a id="18840efdea77da6b" href="../../../R/18840efdea77da6b.html" target="n" data-glyph="46,1" class="i field">_operationsComplete</a> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>true</b>);
 
        <span class="c">// Object used for querying remote runspaces.</span>
        <b>private readonly</b> <a href="PSRemotingCmdlet.cs.html#2069a7a39daa030c" class="t t">QueryRunspaces</a> <a id="c9d7763c951e5cf9" href="../../../R/c9d7763c951e5cf9.html" target="n" data-glyph="46,1" class="i field">_queryRunspaces</a> = <b>new</b> <a href="PSRemotingCmdlet.cs.html#5992ed76877fce33" class="t constructor">QueryRunspaces</a>();
 
        <span class="c">// Object to collect output data from multiple threads.</span>
        <b>private readonly</b> <a href="../../../utils/ObjectStream.cs.html#247cf7c4c5dec5a4" class="t t">ObjectStream</a> <a id="d25084f8ba5458bc" href="../../../R/d25084f8ba5458bc.html" target="n" data-glyph="46,1" class="i field">_stream</a> = <b>new</b> <a href="../../../utils/ObjectStream.cs.html#9f848b3587e1f797" class="t constructor">ObjectStream</a>();
 
        <span class="c">// Support for connection retry on failure.</span>
        <b>private readonly</b> <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <a id="be6ffe85fc03448b" href="../../../R/be6ffe85fc03448b.html" target="n" data-glyph="46,1" class="i field">_retryThrottleManager</a> = <b>new</b> <a href="../common/throttlemanager.cs.html#21c77408b36939a4" class="t constructor">ThrottleManager</a>();
        <b>private readonly</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="b7ceaf47c83d0f9a" href="../../../R/b7ceaf47c83d0f9a.html" target="n" data-glyph="46,1" class="i field">_failedSessions</a> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
