<!DOCTYPE html>
<html><head><title>InvokeCommandCommand.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(2243);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/commands/InvokeCommandCommand.cs" target="_top">engine\remoting\commands\InvokeCommandCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This cmdlet executes a specified script block on one or more</span>
    <span class="c">///</span><span class="c"> remote machines. The expression or command, as they will be</span>
    <span class="c">///</span><span class="c"> interchangeably called, need to be contained in a script</span>
    <span class="c">///</span><span class="c"> block. This is to ensure two things:</span>
    <span class="c">///</span><span class="c">       1. The expression that the user has entered is</span>
    <span class="c">///</span><span class="c">          syntactically correct (its compiled)</span>
    <span class="c">///</span><span class="c">       2. The scriptblock can be converted to a powershell</span>
    <span class="c">///</span><span class="c">          object before transmitting it to the remote end</span>
    <span class="c">///</span><span class="c">          so that it can be run on constrained runspaces in</span>
    <span class="c">///</span><span class="c">          the no language mode</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> In general, the command script block is executed as if</span>
    <span class="c">///</span><span class="c"> the user had typed it at the command line. The output of the</span>
    <span class="c">///</span><span class="c"> command is the output of the cmdlet. However, since</span>
    <span class="c">///</span><span class="c"> invoke-command is a cmdlet, it will unravel its output:</span>
    <span class="c">///</span><span class="c">     - if the command outputs an empty array, invoke-command</span>
    <span class="c">///</span><span class="c">     will output $null</span>
    <span class="c">///</span><span class="c">     - if the command outputs a single-element array, invoke-command</span>
    <span class="c">///</span><span class="c">     will output that single element.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     Additionally, the command will be run on a remote system.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> This cmdlet can be called in the following different ways:</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Execute a command in a remote machine by specifying the command</span>
    <span class="c">///</span><span class="c"> and machine name</span>
    <span class="c">///</span><span class="c">     invoke-command -Command {get-process} -computername &quot;server1&quot;</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Execute a command in a set of remote machines by specifying the</span>
    <span class="c">///</span><span class="c"> command and the list of machines</span>
    <span class="c">///</span><span class="c">     $servers = 1..10 | ForEach-Object {&quot;Server${_}&quot;}</span>
    <span class="c">///</span><span class="c">     invoke-command -command {get-process} -computername $servers</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Create a new runspace and use it to execute a command on a remote machine</span>
    <span class="c">///</span><span class="c">     $runspace = New-PSSession -computername &quot;Server1&quot;</span>
    <span class="c">///</span><span class="c">     $credential = get-credential &quot;user01&quot;</span>
    <span class="c">///</span><span class="c">     invoke-command -command {get-process} -Session $runspace -credential $credential</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Execute a command in a set of remote machines by specifying the</span>
    <span class="c">///</span><span class="c"> complete uri for the machines</span>
    <span class="c">///</span><span class="c">     $uri = &quot;http://hostedservices.microsoft.com/someservice&quot;</span>
    <span class="c">///</span><span class="c">     invoke-command -command { get-mail } - uri $uri</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Create a collection of runspaces and use it to execute a command on a set</span>
    <span class="c">///</span><span class="c"> of remote machines</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     $serveruris = 1..8 | ForEach-Object {&quot;http://Server${_}/&quot;}</span>
    <span class="c">///</span><span class="c">     $runspaces = New-PSSession -URI $serveruris</span>
    <span class="c">///</span><span class="c">     invoke-command -command {get-process} -Session $runspaces</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> The cmdlet can also be invoked in the asynchronous mode.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c">     invoke-command -command {get-process} -computername $servers -asjob</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> When the -AsJob switch is used, the cmdlet will emit an PSJob Object.</span>
    <span class="c">///</span><span class="c"> The user can then use the other job cmdlets to work with this object</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Note there are two types of errors:</span>
    <span class="c">///</span><span class="c">     1. Remote invocation errors</span>
    <span class="c">///</span><span class="c">     2. Local errors.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Both types of errors will be available when the user invokes</span>
    <span class="c">///</span><span class="c"> a receive operation.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> The PSJob object has its own throttling mechanism.</span>
    <span class="c">///</span><span class="c"> The result object will be stored in a global cache. If a user wants to</span>
    <span class="c">///</span><span class="c"> retrieve data from the result object the user should be able to do so</span>
    <span class="c">///</span><span class="c"> using the Receive-PSJob cmdlet</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> The following needs to be noted about exception/error reporting in this</span>
    <span class="c">///</span><span class="c"> cmdlet:</span>
    <span class="c">///</span><span class="c">     The exception objects that are thrown by underlying layers will be</span>
    <span class="c">///</span><span class="c">     written as errors, to avoid stopping the entire cmdlet in case of</span>
    <span class="c">///</span><span class="c">     multi-computername or multi-Session usage (for consistency, this</span>
    <span class="c">///</span><span class="c">     is true even when done using one computername or runspace)</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Only one expression may be executed at a time in any single runspace.</span>
    <span class="c">///</span><span class="c"> Attempts to invoke an expression on a runspace that is already executing</span>
    <span class="c">///</span><span class="c"> an expression shall return an error with ErrorCategory ResourceNotAvailable</span>
    <span class="c">///</span><span class="c"> and notify the user that the runspace is currently busy.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> Some additional notes:</span>
    <span class="c">///</span><span class="c"> - invoke-command issues a single scriptblock to the computer or</span>
    <span class="c">///</span><span class="c"> runspace. If a runspace is specified and a command is already running</span>
    <span class="c">///</span><span class="c"> in that runspace, then the second command will fail</span>
    <span class="c">///</span><span class="c"> - The files necessary to execute the command (cmdlets, scripts, data</span>
    <span class="c">///</span><span class="c"> files, etc) must be present on the remote system; the cmdlet is not</span>
    <span class="c">///</span><span class="c"> responsible for copying them over</span>
    <span class="c">///</span><span class="c"> - The entire input stream is collected and sent to the remote system</span>
    <span class="c">///</span><span class="c"> before execution of the command begins (no input streaming)</span>
    <span class="c">///</span><span class="c"> - Input shall be available as $input.  Remote Runspaces must reference</span>
    <span class="c">///</span><span class="c"> $input explicitly (input will not automatically be available)</span>
    <span class="c">///</span><span class="c"> - Output from the command streams back to the client as it is</span>
    <span class="c">///</span><span class="c"> available</span>
    <span class="c">///</span><span class="c"> - Ctrl-C and pause/resume are supported; the client will send a</span>
    <span class="c">///</span><span class="c"> message to the remote powershell instance.</span>
    <span class="c">///</span><span class="c"> - By default if no -credential is specified, the host will impersonate</span>
    <span class="c">///</span><span class="c"> the current user on the client when executing the command</span>
    <span class="c">///</span><span class="c"> - The standard output of invoke-command is the output of the</span>
    <span class="c">///</span><span class="c"> last element of the remote pipeline, with some extra properties added</span>
    <span class="c">///</span><span class="c"> - If -Shell is not specified, then the value of the environment</span>
    <span class="c">///</span><span class="c"> variable DEFAULTREMOTESHELLNAME is used. If this is not set, then</span>
    <span class="c">///</span><span class="c"> &quot;Microsoft.PowerShell&quot; is used.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="../../../utils/Verbs.cs.html#1a8e85c66f6fff18" class="t t">VerbsLifecycle</a>.<a href="../../../utils/Verbs.cs.html#b5f3af3d6aa6e852" class="i field">Invoke</a>, <span class="s">&quot;Command&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096789&quot;</span>, <span class="i">RemotingCapability</span> = <a href="../common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="../common/misc.cs.html#24fda4b6c5a6ee93" class="i field">OwnedByCommand</a>)]
    <b>public class</b> <a id="681287c2a35349b5" href="../../../R/681287c2a35349b5.html" target="n" data-glyph="0,0" class="t t"><span id="a6082f8e5b15d318">InvokeCommandCommand</span></a> : <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="t t">PSExecutionCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSSession object describing the remote runspace</span>
        <span class="c">///</span><span class="c"> using which the specified cmdlet operation will be performed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public override</b> <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>[] <a id="b4c85db4df20f57a" href="../../../R/b4c85db4df20f57a.html" target="n" data-glyph="102,1" class="i property">Session</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#4e882500927a59be" class="i property">Session</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#4e882500927a59be" class="i property">Session</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter represents the address(es) of the remote</span>
        <span class="c">///</span><span class="c"> computer(s). The following formats are supported:</span>
        <span class="c">///</span><span class="c">      (a) Computer name</span>
        <span class="c">///</span><span class="c">      (b) IPv4 address : 132.3.4.5</span>
        <span class="c">///</span><span class="c">      (c) IPv6 address: 3ffe:8311:ffff:f70f:0:5efe:172.30.162.18.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Cn&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public override string</b>[] <a id="22e9229fe692c271" href="../../../R/22e9229fe692c271.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#9b9cf8f6c6346191" class="i property">ComputerName</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#9b9cf8f6c6346191" class="i property">ComputerName</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the credentials of the user to impersonate in the</span>
        <span class="c">///</span><span class="c"> remote machine. If this parameter is not specified then the</span>
        <span class="c">///</span><span class="c"> credentials of the current user process will be assumed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        [<span class="i">Credential</span>()]
        <b>public override</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="f80c00caded592c7" href="../../../R/f80c00caded592c7.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#6bc302d77d480a65" class="i property">Credential</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#6bc302d77d480a65" class="i property">Credential</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Port specifies the alternate port to be used in case the</span>
        <span class="c">///</span><span class="c"> default ports are not used for the transport mechanism</span>
        <span class="c">///</span><span class="c"> (port 80 for http and port 443 for useSSL)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Currently this is being accepted as a parameter. But in future</span>
        <span class="c">///</span><span class="c"> support will be added to make this a part of a policy setting.</span>
        <span class="c">///</span><span class="c"> When a policy setting is in place this parameter can be used</span>
        <span class="c">///</span><span class="c"> to override the policy setting</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">ValidateRange</span>((<b>int</b>)1, (<b>int</b>)<span class="i">UInt16</span>.<span class="i">MaxValue</span>)]
        <b>public override int</b> <a id="68760a62d33ee817" href="../../../R/68760a62d33ee817.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#c7b9201c1ed0baf1" class="i property">Port</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#c7b9201c1ed0baf1" class="i property">Port</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter suggests that the transport scheme to be used for</span>
        <span class="c">///</span><span class="c"> remote connections is useSSL instead of the default http.Since</span>
        <span class="c">///</span><span class="c"> there are only two possible transport schemes that are possible</span>
        <span class="c">///</span><span class="c"> at this point, a SwitchParameter is being used to switch between</span>
        <span class="c">///</span><span class="c"> the two.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        <b>public override</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="ba93d89d621610fa" href="../../../R/ba93d89d621610fa.html" target="n" data-glyph="102,1" class="i property">UseSSL</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#f7dc857c5bcbf5f9" class="i property">UseSSL</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#f7dc857c5bcbf5f9" class="i property">UseSSL</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For WSMan session:</span>
        <span class="c">///</span><span class="c"> If this parameter is not specified then the value specified in</span>
        <span class="c">///</span><span class="c"> the environment variable DEFAULTREMOTESHELLNAME will be used. If</span>
        <span class="c">///</span><span class="c"> this is not set as well, then Microsoft.PowerShell is used.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For VM/Container sessions:</span>
        <span class="c">///</span><span class="c"> If this parameter is not specified then no configuration is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        <b>public override string</b> <a id="9fcb55cbc1c1d40f" href="../../../R/9fcb55cbc1c1d40f.html" target="n" data-glyph="102,1" class="i property">ConfigurationName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#0345617b8b4f6213" class="i property">ConfigurationName</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#0345617b8b4f6213" class="i property">ConfigurationName</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameters specifies the appname which identifies the connection</span>
        <span class="c">///</span><span class="c"> end point on the remote machine. If this parameter is not specified</span>
        <span class="c">///</span><span class="c"> then the value specified in DEFAULTREMOTEAPPNAME will be used. If thats</span>
        <span class="c">///</span><span class="c"> not specified as well, then &quot;WSMAN&quot; will be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        <b>public override string</b> <a id="1f49782c08a97fd9" href="../../../R/1f49782c08a97fd9.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#eb12660da611783d" class="i property">ApplicationName</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#eb12660da611783d" class="i property">ApplicationName</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allows the user of the cmdlet to specify a throttling value</span>
        <span class="c">///</span><span class="c"> for throttling the number of remote operations that can</span>
        <span class="c">///</span><span class="c"> be executed simultaneously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        <b>public override int</b> <a id="c6ff8d1e7df820db" href="../../../R/c6ff8d1e7df820db.html" target="n" data-glyph="102,1" class="i property">ThrottleLimit</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#6e50a53369096f1e" class="i property">ThrottleLimit</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#6e50a53369096f1e" class="i property">ThrottleLimit</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A complete URI(s) specified for the remote computer and shell to</span>
        <span class="c">///</span><span class="c"> connect to and create runspace for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;URI&quot;</span>, <span class="s">&quot;CU&quot;</span>)]
        <b>public override</b> <span class="i">Uri</span>[] <a id="647cd3e26531f0c9" href="../../../R/647cd3e26531f0c9.html" target="n" data-glyph="102,1" class="i property">ConnectionUri</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#1650af9038e01fe5" class="i property">ConnectionUri</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#1650af9038e01fe5" class="i property">ConnectionUri</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies if the cmdlet needs to be run asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#2ccab294cfc81d07" class="i field">FilePathSSHHostHashParameterSet</a>)]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="00d0144bfc654d07" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AsJob</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5c111907db4cb309" class="i field">_asjob</a>;
            }
 
            <b>set</b>
            {
                <a href="#5c111907db4cb309" class="i field">_asjob</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="5c111907db4cb309" href="../../../R/5c111907db4cb309.html" target="n" data-glyph="46,1" class="i field">_asjob</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies that after the command is invoked on a remote computer the</span>
        <span class="c">///</span><span class="c"> remote session should be disconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Disconnected&quot;</span>)]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="901434a0445cf93d" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">InDisconnectedSession</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the name of the returned session when the InDisconnectedSession switch</span>
        <span class="c">///</span><span class="c"> is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="9b2df4f3e78cf021" href="../../../R/9b2df4f3e78cf021.html" target="n" data-glyph="102,1" class="i property">SessionName</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#220b9643edb5e66c" class="i property">DisconnectedSessionName</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#220b9643edb5e66c" class="i property">DisconnectedSessionName</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hide/Show computername of the remote objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#2ccab294cfc81d07" class="i field">FilePathSSHHostHashParameterSet</a>)]
        [<span class="i">Alias</span>(<span class="s">&quot;HCN&quot;</span>)]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="5590d2c6ee62220a" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">HideComputerName</a>
        {
            <b>get</b> { <b>return</b> <a href="#a60d40ddf6f9f175" class="i field">_hideComputerName</a>; }
 
            <b>set</b> { <a href="#a60d40ddf6f9f175" class="i field">_hideComputerName</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="a60d40ddf6f9f175" href="../../../R/a60d40ddf6f9f175.html" target="n" data-glyph="46,1" class="i field">_hideComputerName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Friendly name for the job object if AsJob is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        <b>public string</b> <a id="0eecaf8165ee76cf" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">JobName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fd49c9a696c67620" class="i field">_name</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<b>value</b>))
                {
                    <a href="#fd49c9a696c67620" class="i field">_name</a> = <b>value</b>;
                    <a href="#5c111907db4cb309" class="i field">_asjob</a> = <b>true</b>;
                }
            }
        }
 
        <b>private string</b> <a id="fd49c9a696c67620" href="../../../R/fd49c9a696c67620.html" target="n" data-glyph="46,1" class="i field">_name</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block that the user has specified in the</span>
        <span class="c">///</span><span class="c"> cmdlet. This will be converted to a powershell before</span>
        <span class="c">///</span><span class="c"> its actually sent to the remote end.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;Command&quot;</span>)]
        <b>public override</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="aa30e4439a540c06" href="../../../R/aa30e4439a540c06.html" target="n" data-glyph="102,1" class="i property">ScriptBlock</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#44467d43b32a25a3" class="i property">ScriptBlock</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#44467d43b32a25a3" class="i property">ScriptBlock</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When executing a scriptblock in the current session, tell the cmdlet not to create a new scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>)]
        <b>public</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="306028c4b9a96378" href="../../../R/306028c4b9a96378.html" target="n" data-glyph="102,1" class="i property">NoNewScope</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block that the user has specified in the</span>
        <span class="c">///</span><span class="c"> cmdlet. This will be converted to a powershell before</span>
        <span class="c">///</span><span class="c"> its actually sent to the remote end.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#2ccab294cfc81d07" class="i field">FilePathSSHHostHashParameterSet</a>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>)]
        <b>public override string</b> <a id="28d8a812f935058b" href="../../../R/28d8a812f935058b.html" target="n" data-glyph="102,1" class="i property">FilePath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#59f94d9038624bbe" class="i property">FilePath</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#59f94d9038624bbe" class="i property">FilePath</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The AllowRedirection parameter enables the implicit redirection functionality.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        <b>public override</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="ec30747966fddc6f" href="../../../R/ec30747966fddc6f.html" target="n" data-glyph="102,1" class="i property">AllowRedirection</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#cdda163a30fbf95b" class="i property">AllowRedirection</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#cdda163a30fbf95b" class="i property">AllowRedirection</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extended Session Options for controlling the session creation. Use</span>
        <span class="c">///</span><span class="c"> &quot;New-WSManSessionOption&quot; cmdlet to supply value for this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        <b>public override</b> <a href="PSRemotingCmdlet.cs.html#8626ee928362b305" class="t t">PSSessionOption</a> <a id="762739a35ad606a8" href="../../../R/762739a35ad606a8.html" target="n" data-glyph="102,1" class="i property">SessionOption</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#c791712b37902fe7" class="i property">SessionOption</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#c791712b37902fe7" class="i property">SessionOption</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication mechanism to authenticate the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        <b>public override</b> <a href="../common/RunspaceConnectionInfo.cs.html#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="ea24dcc98d6ccc35" href="../../../R/ea24dcc98d6ccc35.html" target="n" data-glyph="102,1" class="i property">Authentication</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#3fdef7f4fed9b04a" class="i property">Authentication</a>;
            }
 
            <b>set</b>
            {
                <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#3fdef7f4fed9b04a" class="i property">Authentication</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When set and in loopback scenario (localhost) this enables creation of WSMan</span>
        <span class="c">///</span><span class="c"> host process with the user interactive token, allowing PowerShell script network access,</span>
        <span class="c">///</span><span class="c"> i.e., allows going off box.  When this property is true and a PSSession is disconnected,</span>
        <span class="c">///</span><span class="c"> reconnection is allowed only if reconnecting from a PowerShell session on the same box.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        <b>public override</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="aec360fd7650f3f3" href="../../../R/aec360fd7650f3f3.html" target="n" data-glyph="102,1" class="i property">EnableNetworkAccess</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#61f5e003fc29b048" class="i property">EnableNetworkAccess</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#61f5e003fc29b048" class="i property">EnableNetworkAccess</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When set, PowerShell process inside container will be launched with</span>
        <span class="c">///</span><span class="c"> high privileged account.</span>
        <span class="c">///</span><span class="c"> Otherwise (default case), PowerShell process inside container will be launched</span>
        <span class="c">///</span><span class="c"> with low privileged account.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        <b>public override</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="69568c88ff4ae971" href="../../../R/69568c88ff4ae971.html" target="n" data-glyph="102,1" class="i property">RunAsAdministrator</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#cd880049454ad846" class="i property">RunAsAdministrator</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#cd880049454ad846" class="i property">RunAsAdministrator</a> = <b>value</b>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> SSH Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Host name for an SSH remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
            <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
            <a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public override string</b>[] <a id="07fb01052c58a404" href="../../../R/07fb01052c58a404.html" target="n" data-glyph="102,1" class="i property">HostName</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#6cee174e0c9a888f" class="i property">HostName</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#6cee174e0c9a888f" class="i property">HostName</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User Name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public override string</b> <a id="9f4d96d14b289063" href="../../../R/9f4d96d14b289063.html" target="n" data-glyph="102,1" class="i property">UserName</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#0c3a802c5bf13c48" class="i property">UserName</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#0c3a802c5bf13c48" class="i property">UserName</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Key Path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        [<span class="i">Alias</span>(<span class="s">&quot;IdentityFilePath&quot;</span>)]
        <b>public override string</b> <a id="f8932d2d78ad9270" href="../../../R/f8932d2d78ad9270.html" target="n" data-glyph="102,1" class="i property">KeyFilePath</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#764f077eaac4f43a" class="i property">KeyFilePath</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#764f077eaac4f43a" class="i property">KeyFilePath</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets a value for the SSH subsystem to use for the remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        <b>public override string</b> <a id="04a36c2a5de78056" href="../../../R/04a36c2a5de78056.html" target="n" data-glyph="102,1" class="i property">Subsystem</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#74ae07cd214614c2" class="i property">Subsystem</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#74ae07cd214614c2" class="i property">Subsystem</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets a value in milliseconds that limits the time allowed for an SSH connection to be established.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        <b>public override int</b> <a id="ccaccbfe87e3f045" href="../../../R/ccaccbfe87e3f045.html" target="n" data-glyph="102,1" class="i property">ConnectingTimeout</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#b41fd1bfc38a6b12" class="i property">ConnectingTimeout</a>; }
            
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#b41fd1bfc38a6b12" class="i property">ConnectingTimeout</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter specifies that SSH is used to establish the remote</span>
        <span class="c">///</span><span class="c"> connection and act as the remoting transport.  By default WinRM is used</span>
        <span class="c">///</span><span class="c"> as the remoting transport.  Using the SSH transport requires that SSH is</span>
        <span class="c">///</span><span class="c"> installed and PowerShell remoting is enabled on both client and remote machines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">ValidateSet</span>(<span class="s">&quot;true&quot;</span>)]
        <b>public override</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="bc3e21e16301a988" href="../../../R/bc3e21e16301a988.html" target="n" data-glyph="102,1" class="i property">SSHTransport</a>
        {
            <b>get</b> { <b>return</b> <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#dd4aff5b664bbabf" class="i property">SSHTransport</a>; }
 
            <b>set</b> { <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#dd4aff5b664bbabf" class="i property">SSHTransport</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Hashtable array containing SSH connection parameters for each remote target</span>
        <span class="c">///</span><span class="c">   ComputerName  (Alias: HostName)           (required)</span>
        <span class="c">///</span><span class="c">   UserName                                  (optional)</span>
        <span class="c">///</span><span class="c">   KeyFilePath   (Alias: IdentityFilePath)   (optional)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="PSRemotingCmdlet.cs.html#3b23821ea164740f" class="t t">PSRemotingBaseCmdlet</a>.<a href="PSRemotingCmdlet.cs.html#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#2ccab294cfc81d07" class="i field">FilePathSSHHostHashParameterSet</a>, <a href="../../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public override</b> <span class="i">Hashtable</span>[] <a id="f448c2c00d95e1f2" href="../../../R/f448c2c00d95e1f2.html" target="n" data-glyph="102,1" class="i property">SSHConnection</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Remote Debug Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When selected this parameter causes a debugger Step-Into action for each running remote session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="../../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#2ccab294cfc81d07" class="i field">FilePathSSHHostHashParameterSet</a>)]
        <b>public virtual</b> <a href="../../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="741f8e2c217e8669" href="../../../R/741f8e2c217e8669.html" target="n" data-glyph="102,1" class="i property">RemoteDebug</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates the helper classes for the specified</span>
        <span class="c">///</span><span class="c"> parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="10ec7c51dde65fa1" href="../../../R/10ec7c51dde65fa1.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> (<a href="#681287c2a35349b5" class="k">this</a>.<a href="PSRemotingCmdlet.cs.html#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a> &amp;&amp; <a href="#5c111907db4cb309" class="i field">_asjob</a>)
            {
                <span class="c">// The -AsJob and -InDisconnectedSession parameter switches are mutually exclusive.</span>
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">AsJobAndDisconnectedError</span>);
            }
 
            <b>if</b> (<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#9b2df4f3e78cf021" class="i property">SessionName</a>)) &amp;&amp; !<a href="#681287c2a35349b5" class="k">this</a>.<a href="PSRemotingCmdlet.cs.html#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a>)
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">SessionNameWithoutInvokeDisconnected</span>);
            }
 
            <span class="c">// Adjust RemoteDebug value based on current state</span>
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">var</a> <span id="r0 rd" class="r0 r">hostDebugger</span> = <a href="#358fb7daf3566d58" class="i method">GetHostDebugger</a>();
            <b>if</b> (<span class="r0 r">hostDebugger</span> == <b>null</b>)
            {
                <span class="c">// Do not allow RemoteDebug if there is no host debugger available.  Otherwise script will not respond indefinitely.</span>
                <a href="#741f8e2c217e8669" class="i property">RemoteDebug</a> = <b>false</b>;
            }
            <b>else</b> <b>if</b> (<span class="r0 r">hostDebugger</span>.<a href="../../debugger/debugger.cs.html#a7f5757d8dc86cd0" class="i property">IsDebuggerSteppingEnabled</a>)
            {
                <span class="c">// If host debugger is in step-in mode then always make RemoteDebug true</span>
                <a href="#741f8e2c217e8669" class="i property">RemoteDebug</a> = <b>true</b>;
            }
 
            <span class="c">// Checking session&#39;s availability and reporting errors in early stage, unless &#39;-AsJob&#39; is specified.</span>
            <span class="c">// When &#39;-AsJob&#39; is specified, Invoke-Command should return a job object without throwing error, even</span>
            <span class="c">// if the session is not in available state -- this is the PSv3 behavior and we should not break it.</span>
            <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a> &amp;&amp; (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>) ||
                <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)))
            {
                <b>long</b> <span id="r1 rd" class="r1 r">localPipelineId</span> =
                    ((<a href="../../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="../../hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>().<a href="../../hostifaces/Pipeline.cs.html#f221ca76d844add1" class="i property">InstanceId</a>;
 
                <span class="c">// Check for sessions in invalid state for running commands.</span>
                <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r2 rd" class="r2 r">availableSessions</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="k">var</a> <span id="r3 rd" class="r3 r">session</span> <b>in</b> <a href="#b4c85db4df20f57a" class="i property">Session</a>)
                {
                    <b>if</b> (<span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
                    {
                        <span class="c">// Session not in Opened state.</span>
                        <b>string</b> <span id="r4 rd" class="r4 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ICMInvalidSessionState</span>,
                            <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>, <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>);
 
                        <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(
                            <b>new</b> <a href="../../hostifaces/Connection.cs.html#15409056950584a1" class="t constructor">InvalidRunspaceStateException</a>(<span class="r4 r">msg</span>),
                            <span class="s">&quot;InvokeCommandCommandInvalidSessionState&quot;</span>,
                            <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                            <span class="r3 r">session</span>));
                    }
                    <b>else</b> <b>if</b> (<span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#c8bea13c75bd3198" class="i property">RunspaceAvailability</a> != <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#64bc5c5290cfb16d" class="i field">Available</a>)
                    {
                        <span class="c">// Check to see if this is a steppable pipeline case.</span>
                        <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r5 rd" class="r5 r">remoteRunspace</span> = <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a> <b>as</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                        <b>if</b> ((<span class="r5 r">remoteRunspace</span> != <b>null</b>) &amp;&amp;
                            (<span class="r5 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#c9a8dc56926b5fdf" class="i property">RunspaceAvailability</a> == <a href="../../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../../hostifaces/Connection.cs.html#aed194b80737a544" class="i field">Busy</a>) &amp;&amp;
                            (<span class="r5 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#6bf1c2d23ce75a91" class="i method">IsAnotherInvokeCommandExecuting</a>(<a href="#681287c2a35349b5" class="k">this</a>, <span class="r1 r">localPipelineId</span>)))
                        {
                            <span class="c">// Valid steppable pipeline session.</span>
                            <span class="r2 r">availableSessions</span>.<span class="i">Add</span>(<span class="r3 r">session</span>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// Session not Available.</span>
                            <b>string</b> <span id="r6 rd" class="r6 r">msg</span> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ICMInvalidSessionAvailability</span>,
                                <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>, <span class="r3 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>);
 
                            <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(
                                <b>new</b> <a href="../../hostifaces/Connection.cs.html#15409056950584a1" class="t constructor">InvalidRunspaceStateException</a>(<span class="r6 r">msg</span>),
                                <span class="s">&quot;InvokeCommandCommandInvalidSessionAvailability&quot;</span>,
                                <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                                <span class="r3 r">session</span>));
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r2 r">availableSessions</span>.<span class="i">Add</span>(<span class="r3 r">session</span>);
                    }
                }
 
                <b>if</b> (<span class="r2 r">availableSessions</span>.<span class="i">Count</span> == 0)
                {
                    <b>throw</b> <b>new</b> <a href="../../../utils/MshInvalidOperationException.cs.html#de5b942a57457045" class="t constructor">PSInvalidOperationException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ICMNoValidRunspaces</span>));
                }
 
                <b>if</b> (<span class="r2 r">availableSessions</span>.<span class="i">Count</span> &lt; <a href="#b4c85db4df20f57a" class="i property">Session</a>.<span class="i">Length</span>)
                {
                    <a href="#b4c85db4df20f57a" class="i property">Session</a> = <span class="r2 r">availableSessions</span>.<span class="i">ToArray</span>();
                }
            }
 
            <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>))
            {
                <b>if</b> (<a href="#28d8a812f935058b" class="i property">FilePath</a> != <b>null</b>)
                {
                    <a href="#aa30e4439a540c06" class="i property">ScriptBlock</a> = <a href="PSRemotingCmdlet.cs.html#d437242e89d9d6fe" class="i method">GetScriptBlockFromFile</a>(<a href="#28d8a812f935058b" class="i property">FilePath</a>, <b>false</b>);
                }
 
                <b>if</b> (<a href="#681287c2a35349b5" class="k">this</a>.<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#9a1646f37a942067" class="i property">ExpectingInput</a>)
                {
                    <b>if</b> (!<a href="#aa30e4439a540c06" class="i property">ScriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#92d6ae4085fe0c47" class="i method">IsUsingDollarInput</a>())
                    {
                        <b>try</b>
                        {
                            <a href="#3e65c4777b358f36" class="i field">_steppablePipeline</a> = <a href="#aa30e4439a540c06" class="i property">ScriptBlock</a>.<a href="../../lang/scriptblock.cs.html#e56cc71ed9995acd" class="i method">GetSteppablePipeline</a>(<a href="../../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../../SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <a href="PSRemotingCmdlet.cs.html#94dbe7e5383302d6" class="i property">ArgumentList</a>);
                            <a href="#3e65c4777b358f36" class="i field">_steppablePipeline</a>.<a href="../../lang/scriptblock.cs.html#69311be8ec79f799" class="i method">Begin</a>(<a href="#681287c2a35349b5" class="k">this</a>);
                        }
                        <b>catch</b> (<span class="i">InvalidOperationException</span>)
                        {
                            <span class="c">// ignore exception and don&#39;t do any streaming if can&#39;t convert to steppable pipeline</span>
                        }
                    }
                }
 
                <b>return</b>;
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#9fcb55cbc1c1d40f" class="i property">ConfigurationName</a>))
            {
                <b>if</b> ((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>) ||
                    (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>) ||
                    (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>) ||
                    (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>))
                {
                    <span class="c">// set to default value for WSMan session</span>
                    <a href="#9fcb55cbc1c1d40f" class="i property">ConfigurationName</a> = <a href="PSRemotingCmdlet.cs.html#f6b9edb5e4879089" class="i method">ResolveShell</a>(<b>null</b>);
                }
                <b>else</b>
                {
                    <span class="c">// convert null to string.Empty for VM/Container session</span>
                    <a href="#9fcb55cbc1c1d40f" class="i property">ConfigurationName</a> = <b>string</b>.<span class="i">Empty</span>;
                }
            }
 
            <a href="PSRemotingCmdlet.cs.html#68974ce2a1fdd25f" class="k">base</a>.<a href="PSRemotingCmdlet.cs.html#962a1a4dbb0408bf" class="i method">BeginProcessing</a>();
 
            <span class="c">// create collection of input writers here</span>
            <b>foreach</b> (<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r7 rd" class="r7 r">operation</span> <b>in</b> <a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>)
            {
                <a href="#b69e9b6b8af9d26e" class="i field">_inputWriters</a>.<span class="i">Add</span>(((<a href="PSRemotingCmdlet.cs.html#b467310465a38398" class="t t">ExecutionCmdletHelper</a>)<span class="r7 r">operation</span>).<a href="PSRemotingCmdlet.cs.html#d53a69547f7e5e14" class="i property">Pipeline</a>.<a href="../../hostifaces/Pipeline.cs.html#fc605284c85d0dc9" class="i property">Input</a>);
            }
 
            <span class="c">// we need to verify, if this Invoke-Command is the first</span>
            <span class="c">// instance within the current local pipeline. If not, then</span>
            <span class="c">// we need to collect all the data and run the invoke-command</span>
            <span class="c">// when the remote runspace is free</span>
 
            <span class="c">// We also need to worry about it only in the case of</span>
            <span class="c">// runspace parameter set - for all else we will never hit</span>
            <span class="c">// this scenario</span>
            <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>))
            {
                <b>long</b> <span id="r8 rd" class="r8 r">localPipelineId</span> =
                    ((<a href="../../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>)<a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>).<a href="../../hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>().<a href="../../hostifaces/Pipeline.cs.html#f221ca76d844add1" class="i property">InstanceId</a>;
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r9 rd" class="r9 r">runspaceInfo</span> <b>in</b> <a href="#b4c85db4df20f57a" class="i property">Session</a>)
                {
                    <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r10 rd" class="r10 r">remoteRunspace</span> = (<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>)<span class="r9 r">runspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>;
                    <b>if</b> (<span class="r10 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#6bf1c2d23ce75a91" class="i method">IsAnotherInvokeCommandExecuting</a>(<a href="#681287c2a35349b5" class="k">this</a>, <span class="r8 r">localPipelineId</span>))
                    {
                        <span class="c">// Use remote steppable pipeline only for non-input piping case.</span>
                        <span class="c">// Win8 Bug:898011 - We are restricting remote steppable pipeline because</span>
                        <span class="c">// of this bug in Win8 where not responding can occur during data piping.</span>
                        <span class="c">// We are reverting to Win7 behavior for {icm | icm} and {proxycommand | proxycommand}</span>
                        <span class="c">// cases. For ICM | % ICM case, we are using remote steppable pipeline.</span>
                        <b>if</b> ((<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a> != <b>null</b>) &amp;&amp; (<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#b9401843293d51d4" class="i property">PipelinePosition</a> == 1) &amp;&amp; !<a href="../../MshCmdlet.cs.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="../../InvocationInfo.cs.html#9a1646f37a942067" class="i property">ExpectingInput</a>)
                        {
                            <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r11 rd" class="r11 r">table</span> = (<b>object</b>)<span class="r9 r">runspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#fafd1c05537097a7" class="i property">ApplicationPrivateData</a><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#6f3eb6d7f2bfc1d8" class="i field">PSVersionTableName</a>] <b>as</b> <a href="../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>;
                            <b>if</b> (<span class="r11 r">table</span> != <b>null</b>)
                            {
                                <span class="i">Version</span> <span id="r12 rd" class="r12 r">version</span> = (<b>object</b>)<span class="r11 r">table</span><a href="../../serialization.cs.html#ef1aa37a4f65ba77">[</a><a href="../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../PSVersionInfo.cs.html#a1769a49a5895018" class="i field">PSRemotingProtocolVersionName</a>] <b>as</b> <span class="i">Version</span>;
 
                                <b>if</b> (<span class="r12 r">version</span> != <b>null</b>)
                                {
                                    <span class="c">// In order to support foreach remoting properly ( icm | % { icm } ), the server must</span>
                                    <span class="c">// be using protocol version 2.2. Otherwise, we skip this and assume the old behavior.</span>
                                    <b>if</b> (<span class="r12 r">version</span> &gt;= <a href="../common/WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="../common/WireDataFormat/EncodeAndDecode.cs.html#fd42c50dee2d8244" class="i field">ProtocolVersionWin8RTM</a>)
                                    {
                                        <span class="c">// Suppress collection behavior</span>
                                        <a href="#23615e3abf1a95a6" class="i field">_needToCollect</a> = <b>false</b>;
                                        <a href="#37af23dc42f39723" class="i field">_needToStartSteppablePipelineOnServer</a> = <b>true</b>;
                                        <b>break</b>;
                                    }
                                }
                            }
                        }
 
                        <span class="c">// Either version table is null or the server is not version 2.2 and beyond, we need to collect</span>
                        <a href="#23615e3abf1a95a6" class="i field">_needToCollect</a> = <b>true</b>;
                        <a href="#37af23dc42f39723" class="i field">_needToStartSteppablePipelineOnServer</a> = <b>false</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (<a href="#37af23dc42f39723" class="i field">_needToStartSteppablePipelineOnServer</a>)
            {
                <span class="c">// create collection of input writers here</span>
                <b>foreach</b> (<a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a> <span id="r13 rd" class="r13 r">operation</span> <b>in</b> <a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>)
                {
                    <b>if</b> (!(<span class="r13 r">operation</span> <b>is</b> <a href="PSRemotingCmdlet.cs.html#921dba60b3314c0b" class="t t">ExecutionCmdletHelperRunspace</a> <span id="r14 rd" class="r14 r">ecHelper</span>))
                    {
                        <span class="c">// either all the operations will be of type ExecutionCmdletHelperRunspace</span>
                        <span class="c">// or not...there is no mix.</span>
                        <b>break</b>;
                    }
 
                    <span class="r14 r">ecHelper</span>.<a href="PSRemotingCmdlet.cs.html#a357d96b1a949490" class="i field">ShouldUseSteppablePipelineOnServer</a> = <b>true</b>;
                }
            }
            <b>else</b>
            {
                <span class="c">// RemoteRunspace must be holding this InvokeCommand..So release</span>
                <span class="c">// this at dispose time</span>
                <a href="#3c53a353e91ab1d4" class="i field">_clearInvokeCommandOnRunspace</a> = <b>true</b>;
            }
 
            <span class="c">// check if we need to propagate terminating errors</span>
            <a href="#d8d183f1bc2cc825" class="i method">DetermineThrowStatementBehavior</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The expression will be executed in the remote computer if a</span>
        <span class="c">///</span><span class="c"> remote runspace parameter or computer name or uri is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1. Identify if the command belongs to the same pipeline</span>
        <span class="c">///</span><span class="c"> 2. If so, use the same GUID to create Pipeline/PowerShell</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="bc2a89c7d3b7c8e6" href="../../../R/bc2a89c7d3b7c8e6.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// we should create the pipeline on first instance</span>
            <span class="c">// and if there are no invoke-commands running</span>
            <span class="c">// ahead in the pipeline</span>
            <b>if</b> (!<a href="#466942bfef417a4a" class="i field">_pipelineinvoked</a> &amp;&amp; !<a href="#23615e3abf1a95a6" class="i field">_needToCollect</a>)
            {
                <a href="#466942bfef417a4a" class="i field">_pipelineinvoked</a> = <b>true</b>;
 
                <b>if</b> (<a href="PSRemotingCmdlet.cs.html#1417cb6c28b88894" class="i property">InputObject</a> == <a href="../../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                {
                    <a href="PSRemotingCmdlet.cs.html#3ba177350a1210b8" class="i method">CloseAllInputStreams</a>();
                    <a href="#3d83dda3a1a3ae11" class="i field">_inputStreamClosed</a> = <b>true</b>;
                }
 
                <b>if</b> (!<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>))
                {
                    <span class="c">// at this point there is nothing to do for</span>
                    <span class="c">// inproc case. The script block is executed</span>
                    <span class="c">// in EndProcessing</span>
                    <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
                    {
                        <a href="#77492376ffc3cff9" class="i method">CreateAndRunSyncJob</a>();
                    }
                    <b>else</b>
                    {
                        <b>switch</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>)
                        {
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#5d25e1e8da3ff53e" class="i field">VMIdParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#b2efa99b627d2719" class="i field">VMNameParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#572318a2191690f0" class="i field">ContainerIdParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#e59b1f1999df2408" class="i field">FilePathVMIdParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#9e391128a2b68753" class="i field">FilePathVMNameParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#d48040d57685dd98" class="i field">FilePathContainerIdParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1d1f1661df97e61a" class="i field">SSHHostParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e168891c20d8ea5" class="i field">FilePathSSHHostParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#401e2bcb1c7fe903" class="i field">SSHHostHashParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#2ccab294cfc81d07" class="i field">FilePathSSHHostHashParameterSet</a>:
                                {
                                    <b>if</b> (<a href="PSRemotingCmdlet.cs.html#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>.<span class="i">Length</span> != 0 &amp;&amp; <a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Count</span> &gt; 0)
                                    {
                                        <a href="../client/Job.cs.html#3e3a8a0a8fbfcb51" class="t t">PSRemotingJob</a> <span id="r15 rd" class="r15 r">job</span> = <b>new</b> <a href="../client/Job.cs.html#643b86a66b9973de" class="t constructor">PSRemotingJob</a>(<a href="PSRemotingCmdlet.cs.html#19ecf5d9796fa338" class="i property">ResolvedComputerNames</a>, <a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>,
                                                <a href="#aa30e4439a540c06" class="i property">ScriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>(), <a href="#c6ff8d1e7df820db" class="i property">ThrottleLimit</a>, <a href="#fd49c9a696c67620" class="i field">_name</a>);
                                        <span class="r15 r">job</span>.<a href="../client/Job.cs.html#48fbced17e8f44b3" class="i property">PSJobTypeName</a> = <a href="#ea95cff09d211ae0" class="i field">RemoteJobType</a>;
                                        <span class="r15 r">job</span>.<a href="../client/Job.cs.html#b0e94f782a20f2ee" class="i property">HideComputerName</a> = <a href="#a60d40ddf6f9f175" class="i field">_hideComputerName</a>;
                                        <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#025e5235224e3234" class="i property">JobRepository</a>.<a href="JobRepository.cs.html#d6dba21c2b5f0712" class="i method">Add</a>(<span class="r15 r">job</span>);
                                        <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r15 r">job</span>);
                                    }
                                }
 
                                <b>break</b>;
 
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>:
                                {
                                    <a href="../client/Job.cs.html#3e3a8a0a8fbfcb51" class="t t">PSRemotingJob</a> <span id="r16 rd" class="r16 r">job</span> = <b>new</b> <a href="../client/Job.cs.html#a8c71adaf8534f95" class="t constructor">PSRemotingJob</a>(<a href="#b4c85db4df20f57a" class="i property">Session</a>, <a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>,
                                            <a href="#aa30e4439a540c06" class="i property">ScriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>(), <a href="#c6ff8d1e7df820db" class="i property">ThrottleLimit</a>, <a href="#fd49c9a696c67620" class="i field">_name</a>);
                                    <span class="r16 r">job</span>.<a href="../client/Job.cs.html#48fbced17e8f44b3" class="i property">PSJobTypeName</a> = <a href="#ea95cff09d211ae0" class="i field">RemoteJobType</a>;
                                    <span class="r16 r">job</span>.<a href="../client/Job.cs.html#b0e94f782a20f2ee" class="i property">HideComputerName</a> = <a href="#a60d40ddf6f9f175" class="i field">_hideComputerName</a>;
                                    <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#025e5235224e3234" class="i property">JobRepository</a>.<a href="JobRepository.cs.html#d6dba21c2b5f0712" class="i method">Add</a>(<span class="r16 r">job</span>);
                                    <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r16 r">job</span>);
                                }
 
                                <b>break</b>;
 
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>:
                            <b>case</b> <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>:
                                {
                                    <b>if</b> (<a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>.<span class="i">Count</span> &gt; 0)
                                    {
                                        <b>string</b>[] <span id="r17 rd" class="r17 r">locations</span> = <b>new</b> <b>string</b>[<a href="#647cd3e26531f0c9" class="i property">ConnectionUri</a>.<span class="i">Length</span>];
                                        <b>for</b> (<b>int</b> <span id="r18 rd" class="r18 r">i</span> = 0; <span class="r18 r">i</span> &lt; <span class="r17 r">locations</span>.<span class="i">Length</span>; <span class="r18 r">i</span>++)
                                        {
                                            <span class="r17 r">locations</span>[<span class="r18 r">i</span>] = <a href="#647cd3e26531f0c9" class="i property">ConnectionUri</a>[<span class="r18 r">i</span>].<span class="i">ToString</span>();
                                        }
 
                                        <a href="../client/Job.cs.html#3e3a8a0a8fbfcb51" class="t t">PSRemotingJob</a> <span id="r19 rd" class="r19 r">job</span> = <b>new</b> <a href="../client/Job.cs.html#643b86a66b9973de" class="t constructor">PSRemotingJob</a>(<span class="r17 r">locations</span>, <a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>,
                                            <a href="#aa30e4439a540c06" class="i property">ScriptBlock</a>.<a href="../../runtime/CompiledScriptBlock.cs.html#89c5da438a36dbb2" class="i method">ToString</a>(), <a href="#c6ff8d1e7df820db" class="i property">ThrottleLimit</a>, <a href="#fd49c9a696c67620" class="i field">_name</a>);
                                        <span class="r19 r">job</span>.<a href="../client/Job.cs.html#48fbced17e8f44b3" class="i property">PSJobTypeName</a> = <a href="#ea95cff09d211ae0" class="i field">RemoteJobType</a>;
                                        <span class="r19 r">job</span>.<a href="../client/Job.cs.html#b0e94f782a20f2ee" class="i property">HideComputerName</a> = <a href="#a60d40ddf6f9f175" class="i field">_hideComputerName</a>;
                                        <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#025e5235224e3234" class="i property">JobRepository</a>.<a href="JobRepository.cs.html#d6dba21c2b5f0712" class="i method">Add</a>(<span class="r19 r">job</span>);
                                        <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r19 r">job</span>);
                                    }
                                }
 
                                <b>break</b>;
                        }
                    }
                }
            }
 
            <b>if</b> (<a href="PSRemotingCmdlet.cs.html#1417cb6c28b88894" class="i property">InputObject</a> != <a href="../../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a> &amp;&amp; !<a href="#3d83dda3a1a3ae11" class="i field">_inputStreamClosed</a>)
            {
                <b>if</b> ((<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>) &amp;&amp; (<a href="#3e65c4777b358f36" class="i field">_steppablePipeline</a> == <b>null</b>)) ||
                    <a href="#23615e3abf1a95a6" class="i field">_needToCollect</a>)
                {
                    <a href="#3012da8076340081" class="i field">_input</a>.<a href="../../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<a href="PSRemotingCmdlet.cs.html#1417cb6c28b88894" class="i property">InputObject</a>);
                }
                <b>else</b> <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>) &amp;&amp; (<a href="#3e65c4777b358f36" class="i field">_steppablePipeline</a> != <b>null</b>))
                {
                    <a href="#3e65c4777b358f36" class="i field">_steppablePipeline</a>.<a href="../../lang/scriptblock.cs.html#a6310532c61ba767" class="i method">Process</a>(<a href="PSRemotingCmdlet.cs.html#1417cb6c28b88894" class="i property">InputObject</a>);
                }
                <b>else</b>
                {
                    <a href="#03a644d46555bf3d" class="i method">WriteInput</a>(<a href="PSRemotingCmdlet.cs.html#1417cb6c28b88894" class="i property">InputObject</a>);
 
                    <span class="c">// if not a job write out the results available thus far</span>
                    <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
                    {
                        <a href="#3d00cc1fc8ecb030" class="i method">WriteJobResults</a>(<b>true</b>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InvokeAsync would have been called in ProcessRecord. Wait here</span>
        <span class="c">///</span><span class="c"> for all the results to become available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="66280e12e00c7f3d" href="../../../R/66280e12e00c7f3d.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <span class="c">// close the input stream on all the pipelines</span>
            <b>if</b> (!<a href="#23615e3abf1a95a6" class="i field">_needToCollect</a>)
            {
                <a href="PSRemotingCmdlet.cs.html#3ba177350a1210b8" class="i method">CloseAllInputStreams</a>();
            }
 
            <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
            {
                <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>))
                {
                    <b>if</b> (<a href="#3e65c4777b358f36" class="i field">_steppablePipeline</a> != <b>null</b>)
                    {
                        <a href="#3e65c4777b358f36" class="i field">_steppablePipeline</a>.<a href="../../lang/scriptblock.cs.html#acd4446c9db7bae3" class="i method">End</a>();
                    }
                    <b>else</b>
                    {
                        <a href="#aa30e4439a540c06" class="i property">ScriptBlock</a>.<a href="../../lang/scriptblock.cs.html#0b3de91b4076a6c3" class="i method">InvokeUsingCmdlet</a>(
                            <span class="r20 r">contextCmdlet</span>: <a href="#681287c2a35349b5" class="k">this</a>,
                            <span class="r21 r">useLocalScope</span>: !<a href="#306028c4b9a96378" class="i property">NoNewScope</a>,
                            <span class="r22 r">errorHandlingBehavior</span>: <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="../../lang/scriptblock.cs.html#10c045824f712272" class="t t">ErrorHandlingBehavior</a>.<a href="../../lang/scriptblock.cs.html#5e78734ffe1c6ed3" class="i field">WriteToCurrentErrorPipe</a>,
                            <span class="r23 r">dollarUnder</span>: <a href="../../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                            <span class="r24 r">input</span>: <a href="#3012da8076340081" class="i field">_input</a>,
                            <span class="r25 r">scriptThis</span>: <a href="../../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>,
                            <span class="r26 r">args</span>: <a href="PSRemotingCmdlet.cs.html#94dbe7e5383302d6" class="i property">ArgumentList</a>);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// runspace and computername parameter sets</span>
                    <b>if</b> (<a href="#c77e0142f1ed80b4" class="i field">_job</a> != <b>null</b>)
                    {
                        <span class="c">// The job/command is disconnected immediately after it is invoked.  The command</span>
                        <span class="c">// will continue to run on the server but we don&#39;t wait and return immediately.</span>
                        <b>if</b> (<a href="PSRemotingCmdlet.cs.html#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a>)
                        {
                            <span class="c">// Wait for the Job disconnect to complete.</span>
                            <a href="#3835b18e85eb9da8" class="i method">WaitForDisconnectAndDisposeJob</a>();
                            <b>return</b>;
                        }
 
                        <span class="c">// Wait for job results and for job to complete.</span>
                        <span class="c">// The Job may auto-disconnect in which case it may be</span>
                        <span class="c">// converted to &quot;asJob&quot; so that it isn&#39;t disposed and can</span>
                        <span class="c">// be connected to later.</span>
                        <a href="#3d00cc1fc8ecb030" class="i method">WriteJobResults</a>(<b>false</b>);
 
                        <span class="c">// Dispose job object if it is not returned to the user.</span>
                        <span class="c">// The _asjob field can change dynamically and needs to be checked before the job </span>
                        <span class="c">// object is disposed. For example, if remote sessions are disconnected abruptly</span>
                        <span class="c">// via WinRM, a disconnected job object is created to facilitate a reconnect.</span>
                        <span class="c">// If the job object is disposed here, then a session reconnect cannot happen.</span>
                        <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
                        {
                            <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#a1b7a0cd2d734ade" class="i method">Dispose</a>();
                        }
 
                        <span class="c">// We no longer need to call ClearInvokeCommandOnRunspaces() here because</span>
                        <span class="c">// this command might finish before the foreach block finishes. previously,</span>
                        <span class="c">// icm | icm was implemented so that the first icm always finishes before</span>
                        <span class="c">// the second icm runs, this is not the case with the new implementation</span>
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<a href="#23615e3abf1a95a6" class="i field">_needToCollect</a> &amp;&amp; <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>))
                        {
                            <span class="c">// if job was null, then its because the invoke-command</span>
                            <span class="c">// was collecting or ProcessRecord() was not called.</span>
                            <span class="c">// If we are collecting, then</span>
                            <span class="c">// we would have collected until this point</span>
                            <span class="c">// so now start the execution with the collected</span>
                            <span class="c">// input</span>
 
                            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#23615e3abf1a95a6" class="i field">_needToCollect</a>, <span class="s">&quot;InvokeCommand should have collected input before this&quot;</span>);
                            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>), <span class="s">&quot;Collecting and invoking should happen only in case of Runspace parameter set&quot;</span>);
 
                            <a href="#77492376ffc3cff9" class="i method">CreateAndRunSyncJob</a>();
 
                            <span class="c">// loop through and write all input</span>
                            <b>foreach</b> (<b>object</b> <span id="r27 rd" class="r27 r">inputValue</span> <b>in</b> <a href="#3012da8076340081" class="i field">_input</a>)
                            {
                                <a href="#03a644d46555bf3d" class="i method">WriteInput</a>(<span class="r27 r">inputValue</span>);
                            }
 
                            <a href="PSRemotingCmdlet.cs.html#3ba177350a1210b8" class="i method">CloseAllInputStreams</a>();
 
                            <span class="c">// The job/command is disconnected immediately after it is invoked.  The command</span>
                            <span class="c">// will continue to run on the server but we don&#39;t wait and return immediately.</span>
                            <b>if</b> (<a href="PSRemotingCmdlet.cs.html#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a>)
                            {
                                <span class="c">// Wait for the Job disconnect to complete.</span>
                                <a href="#3835b18e85eb9da8" class="i method">WaitForDisconnectAndDisposeJob</a>();
                                <b>return</b>;
                            }
 
                            <span class="c">// This calls waits for the job to return and then writes the results.</span>
                            <span class="c">// The Job may auto-disconnect in which case it may be</span>
                            <span class="c">// converted to &quot;asJob&quot; so that it isn&#39;t disposed and can</span>
                            <span class="c">// be connected to later.</span>
                            <a href="#3d00cc1fc8ecb030" class="i method">WriteJobResults</a>(<b>false</b>);
 
                            <span class="c">// Dispose job object if it is not returned to the user.</span>
                            <span class="c">// The _asjob field can change dynamically and needs to be checked before the job </span>
                            <span class="c">// object is disposed. For example, if remote sessions are disconnected abruptly</span>
                            <span class="c">// via WinRM, a disconnected job object is created to facilitate a reconnect.</span>
                            <span class="c">// If the job object is disposed here, then a session reconnect cannot happen.</span>
                            <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
                            {
                                <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#a1b7a0cd2d734ade" class="i method">Dispose</a>();
                            }
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is called when the user sends a stop signal to the</span>
        <span class="c">///</span><span class="c"> cmdlet. The cmdlet will not exit until it has completed</span>
        <span class="c">///</span><span class="c"> executing the command on all the runspaces. However, when a stop</span>
        <span class="c">///</span><span class="c"> signal is sent, execution needs to be stopped on the pipelines</span>
        <span class="c">///</span><span class="c"> corresponding to these runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This is called from a separate thread so need to worry</span>
        <span class="c">///</span><span class="c"> about concurrency issues</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="e80dee5e35e3e6d5" href="../../../R/e80dee5e35e3e6d5.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <span class="c">// Ensure that any runspace debug processing is ended</span>
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">var</a> <span id="r28 rd" class="r28 r">hostDebugger</span> = <a href="#358fb7daf3566d58" class="i method">GetHostDebugger</a>();
            <b>if</b> (<span class="r28 r">hostDebugger</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="r28 r">hostDebugger</span>.<a href="../../debugger/debugger.cs.html#feb2a06bee3eab9a" class="i method">CancelDebuggerProcessing</a>();
                }
                <b>catch</b> (<a href="../../../utils/MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a>) { }
            }
 
            <b>if</b> (!<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>))
            {
                <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
                {
                    <span class="c">// stop all operations in the job</span>
                    <span class="c">// we need to check is job is not null, since</span>
                    <span class="c">// StopProcessing() may be called even before the</span>
                    <span class="c">// job is created</span>
                    <b>bool</b> <span id="r29 rd" class="r29 r">stopjob</span> = <b>false</b>;
                    <b>lock</b> (<a href="#bbe07da3e35e4a77" class="i field">_jobSyncObject</a>)
                    {
                        <b>if</b> (<a href="#c77e0142f1ed80b4" class="i field">_job</a> != <b>null</b>)
                        {
                            <span class="r29 r">stopjob</span> = <b>true</b>;
                        }
                        <b>else</b>
                        {
                            <span class="c">// StopProcessing() has already been called</span>
                            <span class="c">// the job should not be created anymore</span>
                            <a href="#f937a77bde5bab56" class="i field">_nojob</a> = <b>true</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r29 r">stopjob</span>)
                    {
                        <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#fbaf22b3fa77846f" class="i method">StopJob</a>();
                    }
 
                    <span class="c">// clear the need to collect flag</span>
                    <a href="#23615e3abf1a95a6" class="i field">_needToCollect</a> = <b>false</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <b>private</b> <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <a id="358fb7daf3566d58" href="../../../R/358fb7daf3566d58.html" target="n" data-glyph="76,1" class="i method">GetHostDebugger</a>()
        {
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r30 rd" class="r30 r">hostDebugger</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<span class="i n">Host</span>.<a href="../../hostifaces/InternalHost.cs.html#83104f2ad59a19df" class="t t">InternalHost</a> <span id="r31 rd" class="r31 r">chost</span> =
                    <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a> <b>as</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<span class="i n">Host</span>.<a href="../../hostifaces/InternalHost.cs.html#83104f2ad59a19df" class="t t">InternalHost</a>;
                <span class="r30 r">hostDebugger</span> = <span class="r31 r">chost</span>.<a href="../../hostifaces/InternalHost.cs.html#8e7bab15e6b298bf" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>;
            }
            <b>catch</b> (<a href="../../../utils/MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a>) { }
 
            <b>return</b> <span class="r30 r">hostDebugger</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle event from the throttle manager indicating that all</span>
        <span class="c">///</span><span class="c"> operations are complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">eventArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a3329f615c539d3c" href="../../../R/a3329f615c539d3c.html" target="n" data-glyph="76,1" class="i method">HandleThrottleComplete</a>(<b>object</b> <span id="r32 rd" class="r32 r">sender</span>, <span class="i">EventArgs</span> <span id="r33 rd" class="r33 r">eventArgs</span>)
        {
            <a href="#a4b4b833ddbc07aa" class="i field">_operationsComplete</a>.<span class="i">Set</span>();
            <a href="#5f471de6ded7cc64" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> -= <span class="i">HandleThrottleComplete</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the internal invoke command instance on all</span>
        <span class="c">///</span><span class="c"> remote runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b1d0c777585dfbde" href="../../../R/b1d0c777585dfbde.html" target="n" data-glyph="76,1" class="i method">ClearInvokeCommandOnRunspaces</a>()
        {
            <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>))
            {
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r34 rd" class="r34 r">runspaceInfo</span> <b>in</b> <a href="#b4c85db4df20f57a" class="i property">Session</a>)
                {
                    <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r35 rd" class="r35 r">remoteRunspace</span> = (<a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>)<span class="r34 r">runspaceInfo</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>;
                    <span class="r35 r">remoteRunspace</span>.<a href="../client/remoterunspace.cs.html#b4c12673c79a851b" class="i method">ClearInvokeCommand</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the throttle limit, creates the invoke expression</span>
        <span class="c">///</span><span class="c"> sync job and executes the same.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="77492376ffc3cff9" href="../../../R/77492376ffc3cff9.html" target="n" data-glyph="76,1" class="i method">CreateAndRunSyncJob</a>()
        {
            <b>lock</b> (<a href="#bbe07da3e35e4a77" class="i field">_jobSyncObject</a>)
            {
                <b>if</b> (!<a href="#f937a77bde5bab56" class="i field">_nojob</a>)
                {
                    <a href="#5f471de6ded7cc64" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#c88c6759bac73d6d" class="i property">ThrottleLimit</a> = <a href="#c6ff8d1e7df820db" class="i property">ThrottleLimit</a>;
                    <a href="#5f471de6ded7cc64" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> += <span class="i">HandleThrottleComplete</span>;
 
                    <a href="#a4b4b833ddbc07aa" class="i field">_operationsComplete</a>.<span class="i">Reset</span>();
                    <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#f136f32673cd2281" class="i field">_disconnectComplete</a> == <b>null</b>, <span class="s">&quot;disconnectComplete event should only be used once.&quot;</span>);
                    <a href="#f136f32673cd2281" class="i field">_disconnectComplete</a> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>false</b>);
                    <a href="#c77e0142f1ed80b4" class="i field">_job</a> = <b>new</b> <a href="../client/Job.cs.html#0527d32134643ec0" class="t constructor">PSInvokeExpressionSyncJob</a>(<a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>, <a href="#5f471de6ded7cc64" class="i field">_throttleManager</a>);
                    <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#a9153cb43ef732da" class="i property">HideComputerName</a> = <a href="#a60d40ddf6f9f175" class="i field">_hideComputerName</a>;
                    <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleJobStateChanged</span>;
 
                    <span class="c">// Add robust connection retry notification handler.</span>
                    <a href="#8e12ed34ecba2875" class="i method">AddConnectionRetryHandler</a>(<a href="#c77e0142f1ed80b4" class="i field">_job</a>);
 
                    <span class="c">// Enable all Invoke-Command synchronous jobs for remote debugging (in case Wait-Debugger or</span>
                    <span class="c">// or line breakpoints are set in script).</span>
                    <b>foreach</b> (<b>var</b> <span id="r36 rd" class="r36 r">operation</span> <b>in</b> <a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>)
                    {
                        <span class="r36 r">operation</span>.<span class="i">RunspaceDebuggingEnabled</span> = <b>true</b>;
                        <span class="r36 r">operation</span>.<span class="i">RunspaceDebugStepInEnabled</span> = <a href="#741f8e2c217e8669" class="i property">RemoteDebug</a>;
                        <span class="r36 r">operation</span>.<span class="i">RunspaceDebugStop</span> += <span class="i">HandleRunspaceDebugStop</span>;
                    }
 
                    <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#f4313603389747ea" class="i method">StartOperations</a>(<a href="PSRemotingCmdlet.cs.html#d9671a73b2071d0c" class="i property">Operations</a>);
                }
            }
        }
 
        <b>private void</b> <a id="e3a5ed462792cd08" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleRunspaceDebugStop</a>(<b>object</b> <span id="r37 rd" class="r37 r">sender</span>, <a href="../../debugger/debugger.cs.html#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a> <span id="r38 rd" class="r38 r">args</span>)
        {
            <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="k">var</a> <span id="r39 rd" class="r39 r">operation</span> = <span class="r37 r">sender</span> <b>as</b> <a href="../common/throttlemanager.cs.html#1164666ea3964901" class="t t">IThrottleOperation</a>;
            <span class="r39 r">operation</span>.<a href="../common/throttlemanager.cs.html#fc79266b79f42512" class="i">RunspaceDebugStop</a> -= <span class="i">HandleRunspaceDebugStop</span>;
 
            <a href="../../debugger/debugger.cs.html#9e8f0b396592e65c" class="k">var</a> <span id="r40 rd" class="r40 r">hostDebugger</span> = <a href="#358fb7daf3566d58" class="i method">GetHostDebugger</a>();
            <b>if</b> (<span class="r40 r">hostDebugger</span> != <b>null</b>)
            {
                <span class="r40 r">hostDebugger</span>.<a href="../../debugger/debugger.cs.html#4b80155f8f31d5b0" class="i method">QueueRunspaceForDebug</a>(<span class="r38 r">args</span>.<a href="../../debugger/debugger.cs.html#f722155d3ec9219d" class="i property">Runspace</a>);
            }
        }
 
        <b>private void</b> <a id="d704196249d585e7" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleJobStateChanged</a>(<b>object</b> <span id="r41 rd" class="r41 r">sender</span>, <a href="../client/Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r42 rd" class="r42 r">e</span>)
        {
            <a href="../client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a> <span id="r43 rd" class="r43 r">state</span> = <span class="r42 r">e</span>.<a href="../client/Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="../client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a>;
            <b>if</b> (<span class="r43 r">state</span> == <a href="../client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../client/Job.cs.html#a6de52aa4733f7cb" class="i field">Disconnected</a> ||
                <span class="r43 r">state</span> == <a href="../client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../client/Job.cs.html#db36b340edc064ae" class="i field">Completed</a> ||
                <span class="r43 r">state</span> == <a href="../client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../client/Job.cs.html#223c91574b18631a" class="i field">Stopped</a> ||
                <span class="r43 r">state</span> == <a href="../client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../client/Job.cs.html#4d2acd22ba4f0da9" class="i field">Failed</a>)
            {
                <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> -= <span class="i">HandleJobStateChanged</span>;
                <a href="#425c2b68f6d55c26" class="i method">RemoveConnectionRetryHandler</a>(<span class="r41 r">sender</span> <b>as</b> <a href="../client/Job.cs.html#60022000292afa6c" class="t t">PSInvokeExpressionSyncJob</a>);
 
                <span class="c">// Signal that this job has been disconnected, or has ended.</span>
                <b>lock</b> (<a href="#bbe07da3e35e4a77" class="i field">_jobSyncObject</a>)
                {
                    <b>if</b> (<a href="#f136f32673cd2281" class="i field">_disconnectComplete</a> != <b>null</b>)
                    {
                        <a href="#f136f32673cd2281" class="i field">_disconnectComplete</a>.<span class="i">Set</span>();
                    }
                }
            }
        }
 
        <b>private void</b> <a id="8e12ed34ecba2875" href="../../../R/8e12ed34ecba2875.html" target="n" data-glyph="76,1" class="i method">AddConnectionRetryHandler</a>(<a href="../client/Job.cs.html#60022000292afa6c" class="t t">PSInvokeExpressionSyncJob</a> <span id="r44 rd" class="r44 r">job</span>)
        {
            <b>if</b> (<span class="r44 r">job</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="i">Collection</span>&lt;<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <span id="r45 rd" class="r45 r">powershells</span> = <span class="r44 r">job</span>.<a href="../client/Job.cs.html#990794abb8c5fc87" class="i method">GetPowerShells</a>();
            <b>foreach</b> (<b>var</b> <span id="r46 rd" class="r46 r">ps</span> <b>in</b> <span class="r45 r">powershells</span>)
            {
                <b>if</b> (<span class="r46 r">ps</span>.<span class="i">RemotePowerShell</span> != <b>null</b>)
                {
                    <span class="r46 r">ps</span>.<span class="i">RemotePowerShell</span>.<span class="i">RCConnectionNotification</span> += <span class="i">RCConnectionNotificationHandler</span>;
                }
            }
        }
 
        <b>private void</b> <a id="425c2b68f6d55c26" href="../../../R/425c2b68f6d55c26.html" target="n" data-glyph="76,1" class="i method">RemoveConnectionRetryHandler</a>(<a href="../client/Job.cs.html#60022000292afa6c" class="t t">PSInvokeExpressionSyncJob</a> <span id="r47 rd" class="r47 r">job</span>)
        {
            <span class="c">// Ensure progress bar is removed.</span>
            <a href="#837ad1e9054849da" class="i method">StopProgressBar</a>(0);
 
            <b>if</b> (<span class="r47 r">job</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="i">Collection</span>&lt;<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <span id="r48 rd" class="r48 r">powershells</span> = <span class="r47 r">job</span>.<a href="../client/Job.cs.html#990794abb8c5fc87" class="i method">GetPowerShells</a>();
            <b>foreach</b> (<b>var</b> <span id="r49 rd" class="r49 r">ps</span> <b>in</b> <span class="r48 r">powershells</span>)
            {
                <b>if</b> (<span class="r49 r">ps</span>.<span class="i">RemotePowerShell</span> != <b>null</b>)
                {
                    <span class="r49 r">ps</span>.<span class="i">RemotePowerShell</span>.<span class="i">RCConnectionNotification</span> -= <span class="i">RCConnectionNotificationHandler</span>;
                }
            }
        }
 
        <b>private void</b> <a id="7b5437501eed3686" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RCConnectionNotificationHandler</a>(<b>object</b> <span id="r50 rd" class="r50 r">sender</span>, <a href="../client/ClientRemotePowerShell.cs.html#e9fb8c6747e35270" class="t t">PSConnectionRetryStatusEventArgs</a> <span id="r51 rd" class="r51 r">e</span>)
        {
            <span class="c">// Update the progress bar.</span>
            <b>switch</b> (<span class="r51 r">e</span>.<a href="../client/ClientRemotePowerShell.cs.html#3515a0c0c4bbe57e" class="i property">Notification</a>)
            {
                <b>case</b> <a href="../client/ClientRemotePowerShell.cs.html#79de75994075e7b1" class="t t">PSConnectionRetryStatus</a>.<a href="../client/ClientRemotePowerShell.cs.html#fd62f226276704d4" class="i field">NetworkFailureDetected</a>:
                    <span class="i">StartProgressBar</span>(<span class="r50 r">sender</span>.<span class="i">GetHashCode</span>(), <span class="r51 r">e</span>.<a href="../client/ClientRemotePowerShell.cs.html#b0f7c354841ab1c5" class="i property">ComputerName</a>, (<span class="r51 r">e</span>.<a href="../client/ClientRemotePowerShell.cs.html#aba922b0c875714c" class="i property">MaxRetryConnectionTime</a> / 1000));
                    <b>break</b>;
 
                <b>case</b> <a href="../client/ClientRemotePowerShell.cs.html#79de75994075e7b1" class="t t">PSConnectionRetryStatus</a>.<a href="../client/ClientRemotePowerShell.cs.html#b10ca9abe40057c8" class="i field">ConnectionRetrySucceeded</a>:
                <b>case</b> <a href="../client/ClientRemotePowerShell.cs.html#79de75994075e7b1" class="t t">PSConnectionRetryStatus</a>.<a href="../client/ClientRemotePowerShell.cs.html#f8cbf12c6086459b" class="i field">AutoDisconnectStarting</a>:
                <b>case</b> <a href="../client/ClientRemotePowerShell.cs.html#79de75994075e7b1" class="t t">PSConnectionRetryStatus</a>.<a href="../client/ClientRemotePowerShell.cs.html#66a1d5afeef67425" class="i field">InternalErrorAbort</a>:
                    <span class="i">StopProgressBar</span>(<span class="r50 r">sender</span>.<span class="i">GetHashCode</span>());
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits for the disconnectComplete event and then disposes the job</span>
        <span class="c">///</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="3835b18e85eb9da8" href="../../../R/3835b18e85eb9da8.html" target="n" data-glyph="76,1" class="i method">WaitForDisconnectAndDisposeJob</a>()
        {
            <b>if</b> (<a href="#f136f32673cd2281" class="i field">_disconnectComplete</a> != <b>null</b>)
            {
                <a href="#f136f32673cd2281" class="i field">_disconnectComplete</a>.<span class="i">WaitOne</span>();
 
                <span class="c">// Create disconnected PSSession objects for each powershell and write to output.</span>
                <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r52 rd" class="r52 r">discSessions</span> = <a href="#1de9297d40f6f596" class="i method">GetDisconnectedSessions</a>(<a href="#c77e0142f1ed80b4" class="i field">_job</a>);
                <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r53 rd" class="r53 r">session</span> <b>in</b> <span class="r52 r">discSessions</span>)
                {
                    <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#a860d36943db1f52" class="i method">AddOrReplace</a>(<span class="r53 r">session</span>);
                    <a href="../../cmdlet.cs.html#d3cfb6f38afe5ee0" class="i method">WriteObject</a>(<span class="r53 r">session</span>);
                }
 
                <span class="c">// Check to see if the disconnect was successful.  If not write any errors there may be.</span>
                <b>if</b> (<a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#322c09d9eb167da1" class="i property">Error</a>.<a href="../../hostifaces/PSDataCollection.cs.html#e7cb43bbebbb4aca" class="i property">Count</a> &gt; 0)
                {
                    <span class="i">WriteStreamObjectsFromCollection</span>(<a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#8c95de2662ddb0c9" class="i method">ReadAll</a>());
                }
 
                <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#a1b7a0cd2d734ade" class="i method">Dispose</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a disconnected session for each disconnected PowerShell object in</span>
        <span class="c">///</span><span class="c"> PSInvokeExpressionSyncJob.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">job</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <a id="1de9297d40f6f596" href="../../../R/1de9297d40f6f596.html" target="n" data-glyph="76,1" class="i method">GetDisconnectedSessions</a>(<a href="../client/Job.cs.html#60022000292afa6c" class="t t">PSInvokeExpressionSyncJob</a> <span id="r54 rd" class="r54 r">job</span>)
        {
            <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r55 rd" class="r55 r">discSessions</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt;();
 
            <span class="i">Collection</span>&lt;<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <span id="r56 rd" class="r56 r">powershells</span> = <span class="r54 r">job</span>.<a href="../client/Job.cs.html#990794abb8c5fc87" class="i method">GetPowerShells</a>();
            <b>foreach</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r57 rd" class="r57 r">ps</span> <b>in</b> <span class="r56 r">powershells</span>)
            {
                <span class="c">// Get the command information from the PowerShell object.</span>
                <b>string</b> <span id="r58 rd" class="r58 r">commandText</span> = (<span class="r57 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a> != <b>null</b> &amp;&amp; <span class="r57 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>.<span class="i">Count</span> &gt; 0) ?
                    <span class="r57 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span> : <b>string</b>.<span class="i">Empty</span>;
                <a href="../client/RemoteRunspacePoolInternal.cs.html#b586ca980bfda5bc" class="t t">ConnectCommandInfo</a> <span id="r59 rd" class="r59 r">cmdInfo</span> = <b>new</b> <a href="../client/RemoteRunspacePoolInternal.cs.html#7661a91d2cae56e7" class="t constructor">ConnectCommandInfo</a>(<span class="r57 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#d8c9867186529e49" class="i property">InstanceId</a>, <span class="r58 r">commandText</span>);
 
                <span class="c">// Get the old RunspacePool object that the command was initially run on.</span>
                <a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r60 rd" class="r60 r">oldRunspacePool</span> = <b>null</b>;
                <b>if</b> (<span class="r57 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#04184898f9307df6" class="i property">RunspacePool</a> != <b>null</b>)
                {
                    <span class="r60 r">oldRunspacePool</span> = <span class="r57 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#04184898f9307df6" class="i property">RunspacePool</a>;
                }
                <b>else</b>
                {
                    <b>object</b> <span id="r61 rd" class="r61 r">rsConnection</span> = <span class="r57 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#503345e404ed0ddb" class="i method">GetRunspaceConnection</a>();
                    <a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r62 rd" class="r62 r">rsPool</span> = <span class="r61 r">rsConnection</span> <b>as</b> <a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a>;
                    <b>if</b> (<span class="r62 r">rsPool</span> != <b>null</b>)
                    {
                        <span class="r60 r">oldRunspacePool</span> = <span class="r62 r">rsPool</span>;
                    }
                    <b>else</b>
                    {
                        <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r63 rd" class="r63 r">remoteRs</span> = <span class="r61 r">rsConnection</span> <b>as</b> <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>;
                        <b>if</b> (<span class="r63 r">remoteRs</span> != <b>null</b>)
                        {
                            <span class="r60 r">oldRunspacePool</span> = <span class="r63 r">remoteRs</span>.<a href="../client/remoterunspace.cs.html#52e4a4fcfd3da6a7" class="i property">RunspacePool</a>;
                        }
                    }
                }
 
                <span class="c">// Create a new disconnected PSSession object and return to the user.</span>
                <span class="c">// The user can use this object to connect to the command on the server</span>
                <span class="c">// and retrieve data.</span>
                <b>if</b> (<span class="r60 r">oldRunspacePool</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r60 r">oldRunspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#a7f9e215f0cbb1ce" class="i property">RunspacePoolStateInfo</a>.<a href="../common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a> != <a href="../../hostifaces/RunspacePool.cs.html#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="../../hostifaces/RunspacePool.cs.html#fb0d368190577383" class="i field">Disconnected</a>)
                    {
                        <span class="c">// InvokeAndDisconnect starts the command and immediately disconnects the command,</span>
                        <span class="c">// but we need to disconnect the associated runspace/pool here.</span>
                        <b>if</b> (<a href="PSRemotingCmdlet.cs.html#49d1b3d35637c09a" class="i property">InvokeAndDisconnect</a> &amp;&amp; <span class="r60 r">oldRunspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#a7f9e215f0cbb1ce" class="i property">RunspacePoolStateInfo</a>.<a href="../common/RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a> == <a href="../../hostifaces/RunspacePool.cs.html#b51dd15975151fb4" class="t t">RunspacePoolState</a>.<a href="../../hostifaces/RunspacePool.cs.html#13cbf83371c004e0" class="i field">Opened</a>)
                        {
                            <span class="r60 r">oldRunspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#c941ba06f6efbbc1" class="i method">Disconnect</a>();
                        }
                        <b>else</b>
                        {
                            <span class="c">// Skip runspace pools that have not been disconnected.</span>
                            <b>continue</b>;
                        }
                    }
 
                    <span class="c">// Auto-generate a session name if one was not provided.</span>
                    <b>string</b> <span id="r64 rd" class="r64 r">sessionName</span> = <span class="r60 r">oldRunspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../client/RemoteRunspacePoolInternal.cs.html#1a2dda11a58f900f" class="i property">Name</a>;
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r64 r">sessionName</span>))
                    {
                        <b>int</b> <span id="r65 rd" class="r65 r">id</span>;
                        <span class="r64 r">sessionName</span> = <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>.<a href="../client/remoterunspaceinfo.cs.html#62039237bb23d055" class="i method">GenerateRunspaceName</a>(<b>out</b> <span class="r65 r">id</span>);
                    }
 
                    <a href="../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r66 rd" class="r66 r">runspacePool</span> = <b>new</b> <a href="../../hostifaces/RunspacePool.cs.html#8bafc0e0064abc11" class="t constructor">RunspacePool</a>(
                                                        <b>true</b>,
                                                        <span class="r60 r">oldRunspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../../hostifaces/RunspacePoolInternal.cs.html#76aedcc22e17e7e5" class="i property">InstanceId</a>,
                                                        <span class="r64 r">sessionName</span>,
                                                        <b>new</b> <a href="../client/RemoteRunspacePoolInternal.cs.html#b586ca980bfda5bc" class="t t">ConnectCommandInfo</a>[1] { <span class="r59 r">cmdInfo</span> },
                                                        <span class="r60 r">oldRunspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../client/RemoteRunspacePoolInternal.cs.html#adb799cd03979b7a" class="i property">ConnectionInfo</a>,
                                                        <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>,
                                                        <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>.<a href="../../ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>);
                    <span class="r66 r">runspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../client/RemoteRunspacePoolInternal.cs.html#f8874da4a5c43ab5" class="i property">IsRemoteDebugStop</a> = <span class="r60 r">oldRunspacePool</span>.<a href="../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../client/RemoteRunspacePoolInternal.cs.html#f8874da4a5c43ab5" class="i property">IsRemoteDebugStop</a>;
 
                    <a href="../client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r67 rd" class="r67 r">remoteRunspace</span> = <b>new</b> <a href="../client/remoterunspace.cs.html#e6404ee9cc04ab4d" class="t constructor">RemoteRunspace</a>(<span class="r66 r">runspacePool</span>);
                    <span class="r55 r">discSessions</span>.<span class="i">Add</span>(<b>new</b> <a href="../client/remoterunspaceinfo.cs.html#5bda0c46d12cafb6" class="t constructor">PSSession</a>(<span class="r67 r">remoteRunspace</span>));
                }
            }
 
            <b>return</b> <span class="r55 r">discSessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes an input value to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">inputValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Input value to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="03a644d46555bf3d" href="../../../R/03a644d46555bf3d.html" target="n" data-glyph="76,1" class="i method">WriteInput</a>(<b>object</b> <span id="r68 rd" class="r68 r">inputValue</span>)
        {
            <span class="c">// when there are no input writers, there is no</span>
            <span class="c">// point either accumulating or trying to write data</span>
            <span class="c">// so throw an exception in that case</span>
            <b>if</b> (<a href="#b69e9b6b8af9d26e" class="i field">_inputWriters</a>.<span class="i">Count</span> == 0)
            {
                <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
                {
                    <a href="#3d00cc1fc8ecb030" class="i method">WriteJobResults</a>(<b>false</b>);
                }
 
                <a href="#681287c2a35349b5" class="k">this</a>.<a href="#66280e12e00c7f3d" class="i method">EndProcessing</a>();
                <b>throw</b> <b>new</b> <a href="../../lang/parserutils.cs.html#53e5b0ae85924330" class="t constructor">StopUpstreamCommandsException</a>(<a href="#681287c2a35349b5" class="k">this</a>);
            }
 
            <span class="i">List</span>&lt;<a href="../../../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a>&gt; <span id="r69 rd" class="r69 r">removeCollection</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../../../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a>&gt;();
 
            <b>foreach</b> (<a href="../../../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a> <span id="r70 rd" class="r70 r">writer</span> <b>in</b> <a href="#b69e9b6b8af9d26e" class="i field">_inputWriters</a>)
            {
                <b>try</b>
                {
                    <span class="r70 r">writer</span>.<a href="../../../utils/IObjectWriter.cs.html#4cc65ae0546ff5fb" class="i method">Write</a>(<span class="r68 r">inputValue</span>);
                }
                <b>catch</b> (<a href="../../../utils/ExecutionExceptions.cs.html#1496d52396952a52" class="t t">PipelineClosedException</a>)
                {
                    <span class="r69 r">removeCollection</span>.<span class="i">Add</span>(<span class="r70 r">writer</span>);
                    <b>continue</b>;
                }
            }
 
            <b>foreach</b> (<a href="../../../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a> <span id="r71 rd" class="r71 r">writer</span> <b>in</b> <span class="r69 r">removeCollection</span>)
            {
                <a href="#b69e9b6b8af9d26e" class="i field">_inputWriters</a>.<span class="i">Remove</span>(<span class="r71 r">writer</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the results in the job object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">nonblocking</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Write in a non-blocking manner.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="3d00cc1fc8ecb030" href="../../../R/3d00cc1fc8ecb030.html" target="n" data-glyph="76,1" class="i method">WriteJobResults</a>(<b>bool</b> <span id="r72 rd" class="r72 r">nonblocking</span>)
        {
            <b>if</b> (<a href="#c77e0142f1ed80b4" class="i field">_job</a> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>try</b>
            {
                <a href="../../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a> <span id="r73 rd" class="r73 r">caughtPipelineStoppedException</span> = <b>null</b>;
                <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#e09e33b0daa549e5" class="i property">PropagateThrows</a> = <a href="#c3453840b4d4c0ec" class="i field">_propagateErrors</a>;
 
                <b>do</b>
                {
                    <b>if</b> (!<span class="r72 r">nonblocking</span>)
                    {
                        <span class="c">// we need to wait until results arrive</span>
                        <span class="c">// before we attempt to read. This will</span>
                        <span class="c">// ensure that the thread blocks. Else</span>
                        <span class="c">// the thread will spin leading to a CPU</span>
                        <span class="c">// usage spike</span>
                        <b>if</b> (<a href="#f136f32673cd2281" class="i field">_disconnectComplete</a> != <b>null</b>)
                        {
                            <span class="c">// An auto-disconnect can occur and we need to detect</span>
                            <span class="c">// this condition along with a job results signal.</span>
                            <span class="i">WaitHandle</span>.<span class="i">WaitAny</span>(<b>new</b> <span class="i">WaitHandle</span>[] {
                                                    <a href="#f136f32673cd2281" class="i field">_disconnectComplete</a>,
                                                    <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#2ab7ec209735b92b" class="i property">WaitHandle</a> });
                        }
                        <b>else</b>
                        {
                            <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#2f6fd0f4814916f6" class="i property">Results</a>.<a href="../../hostifaces/PSDataCollection.cs.html#2ab7ec209735b92b" class="i property">WaitHandle</a>.<span class="i">WaitOne</span>();
                        }
                    }
 
                    <b>try</b>
                    {
                        <span class="i">WriteStreamObjectsFromCollection</span>(<a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#8c95de2662ddb0c9" class="i method">ReadAll</a>());
                    }
                    <b>catch</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a> <span id="r74 rd" class="r74 r">pse</span>)
                    {
                        <span class="r73 r">caughtPipelineStoppedException</span> = <span class="r74 r">pse</span>;
                    }
 
                    <b>if</b> (<span class="r72 r">nonblocking</span>)
                    {
                        <b>break</b>;
                    }
                } <b>while</b> (!<a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#2d55e79ec67c0f48" class="i method">IsTerminalState</a>());
 
                <b>try</b>
                {
                    <span class="i">WriteStreamObjectsFromCollection</span>(<a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#8c95de2662ddb0c9" class="i method">ReadAll</a>());
                }
                <b>catch</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a> <span id="r75 rd" class="r75 r">pse</span>)
                {
                    <span class="r73 r">caughtPipelineStoppedException</span> = <span class="r75 r">pse</span>;
                }
 
                <b>if</b> (<span class="r73 r">caughtPipelineStoppedException</span> != <b>null</b>)
                {
                    <a href="#fb5925eb170a130e" class="i method">HandlePipelinesStopped</a>();
                    <b>throw</b> <span class="r73 r">caughtPipelineStoppedException</span>;
                }
 
                <b>if</b> (<a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="../client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="../client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../client/Job.cs.html#a6de52aa4733f7cb" class="i field">Disconnected</a>)
                {
                    <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a> ||
                        <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>)
                    {
                        <span class="c">// Create a PSRemoting job we can add to the job repository and that</span>
                        <span class="c">// a user can reconnect to (via Receive-PSSession).</span>
                        <a href="../client/Job.cs.html#3e3a8a0a8fbfcb51" class="t t">PSRemotingJob</a> <span id="r76 rd" class="r76 r">rtnJob</span> = <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#16403bfb2148ff19" class="i method">CreateDisconnectedRemotingJob</a>();
                        <b>if</b> (<span class="r76 r">rtnJob</span> != <b>null</b>)
                        {
                            <span class="r76 r">rtnJob</span>.<a href="../client/Job.cs.html#48fbced17e8f44b3" class="i property">PSJobTypeName</a> = <a href="#ea95cff09d211ae0" class="i field">RemoteJobType</a>;
 
                            <span class="c">// Don&#39;t let the job object be disposed or stopped since</span>
                            <span class="c">// we want to be able to reconnect to the disconnected</span>
                            <span class="c">// pipelines.</span>
                            <a href="#5c111907db4cb309" class="i field">_asjob</a> = <b>true</b>;
 
                            <span class="c">// Write warnings to user about each disconnect.</span>
                            <b>foreach</b> (<b>var</b> <span id="r77 rd" class="r77 r">cjob</span> <b>in</b> <span class="r76 r">rtnJob</span>.<a href="../client/Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
                            {
                                <a href="../client/Job.cs.html#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a> <span id="r78 rd" class="r78 r">childJob</span> = <span class="r77 r">cjob</span> <b>as</b> <a href="../client/Job.cs.html#d1388b6af9650b2e" class="t t">PSRemotingChildJob</a>;
                                <b>if</b> (<span class="r78 r">childJob</span> != <b>null</b>)
                                {
                                    <span class="c">// Get session for this job.</span>
                                    <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r79 rd" class="r79 r">session</span> = <a href="#8a2303aa863da001" class="i method">GetPSSession</a>(<span class="r78 r">childJob</span>.<a href="../client/Job.cs.html#08647015a50a05bd" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>);
                                    <b>if</b> (<span class="r79 r">session</span> != <b>null</b>)
                                    {
                                        <span class="c">// Write network failed, auto-disconnect error</span>
                                        <a href="#9636289bb140ccaa" class="i method">WriteNetworkFailedError</a>(<span class="r79 r">session</span>);
 
                                        <span class="c">// Session disconnected message.</span>
                                        <a href="../../cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(
                                            <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RCDisconnectSession</span>,
                                                <span class="r79 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r79 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r79 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>));
                                    }
                                }
                            }
 
                            <b>if</b> (<span class="r76 r">rtnJob</span>.<a href="../client/Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>.<span class="i">Count</span> &gt; 0)
                            {
                                <a href="../../CommandBase.cs.html#025e5235224e3234" class="i property">JobRepository</a>.<a href="JobRepository.cs.html#d6dba21c2b5f0712" class="i method">Add</a>(<span class="r76 r">rtnJob</span>);
 
                                <span class="c">// Inform the user that a new Job object was created and added to the repository</span>
                                <span class="c">// to support later reconnection.</span>
                                <a href="../../cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(
                                    <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RCDisconnectedJob</span>, <span class="r76 r">rtnJob</span>.<a href="../client/Job.cs.html#6332c7ef857bb146" class="i property">Name</a>));
                            }
                        }
                    }
                    <b>else</b> <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a> ||
                             <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>)
                    {
                        <span class="c">// Create disconnected sessions for each PowerShell in job that was disconnected,</span>
                        <span class="c">// and add them to the local repository.</span>
                        <span class="i">List</span>&lt;<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a>&gt; <span id="r80 rd" class="r80 r">discSessions</span> = <a href="#1de9297d40f6f596" class="i method">GetDisconnectedSessions</a>(<a href="#c77e0142f1ed80b4" class="i field">_job</a>);
                        <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r81 rd" class="r81 r">session</span> <b>in</b> <span class="r80 r">discSessions</span>)
                        {
                            <span class="c">// Add to session repository.</span>
                            <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#455bd8325dd03be4" class="i property">RunspaceRepository</a>.<a href="runspacerepository.cs.html#a860d36943db1f52" class="i method">AddOrReplace</a>(<span class="r81 r">session</span>);
 
                            <span class="c">// Write network failed, auto-disconnect error</span>
                            <a href="#9636289bb140ccaa" class="i method">WriteNetworkFailedError</a>(<span class="r81 r">session</span>);
 
                            <span class="c">// Session disconnected message.</span>
                            <a href="../../cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(
                                <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RCDisconnectSession</span>,
                                    <span class="r81 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r81 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>, <span class="r81 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>));
 
                            <span class="c">// Session created message.</span>
                            <a href="../../cmdlet.cs.html#dda5a07d1a8a6cba" class="i method">WriteWarning</a>(
                                <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RCDisconnectSessionCreated</span>,
                                    <span class="r81 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#dcc034e330dc7781" class="i property">Name</a>, <span class="r81 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#efd181c61ecd05ff" class="i property">InstanceId</a>));
                        }
                    }
                }
            }
            <b>finally</b>
            {
                <b>if</b> (<a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="../client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="../client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../client/Job.cs.html#a6de52aa4733f7cb" class="i field">Disconnected</a>)
                {
                    <span class="c">// Allow Invoke-Command to end even though not all remote pipelines</span>
                    <span class="c">// finished.</span>
                    <a href="#a3329f615c539d3c" class="i method">HandleThrottleComplete</a>(<b>null</b>, <b>null</b>);
                }
            }
        }
 
        <b>private void</b> <a id="9636289bb140ccaa" href="../../../R/9636289bb140ccaa.html" target="n" data-glyph="76,1" class="i method">WriteNetworkFailedError</a>(<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r82 rd" class="r82 r">session</span>)
        {
            <a href="../../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r83 rd" class="r83 r">reason</span> = <b>new</b> <a href="../../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(
                <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RCAutoDisconnectingError</span>, <span class="r82 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#4e8388b3861bf08b" class="i property">ComputerName</a>));
 
            <a href="../../cmdlet.cs.html#7746d1a8f41a36d5" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r83 r">reason</span>,
                <a href="../client/ClientRemotePowerShell.cs.html#e9fb8c6747e35270" class="t t">PSConnectionRetryStatusEventArgs</a>.<a href="../client/ClientRemotePowerShell.cs.html#9d4c4fa7427b411d" class="i field">FQIDAutoDisconnectStarting</a>,
                <a href="../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../ErrorPackage.cs.html#214d0e72bcab7ace" class="i field">OperationTimeout</a>, <span class="r82 r">session</span>));
        }
 
        <b>private</b> <a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <a id="8a2303aa863da001" href="../../../R/8a2303aa863da001.html" target="n" data-glyph="76,1" class="i method">GetPSSession</a>(<span class="i">Guid</span> <span id="r84 rd" class="r84 r">runspaceId</span>)
        {
            <b>foreach</b> (<a href="../client/remoterunspaceinfo.cs.html#84e3d9c13d0f2efc" class="t t">PSSession</a> <span id="r85 rd" class="r85 r">session</span> <b>in</b> <a href="#b4c85db4df20f57a" class="i property">Session</a>)
            {
                <b>if</b> (<span class="r85 r">session</span>.<a href="../client/remoterunspaceinfo.cs.html#9c20236793fb308a" class="i property">Runspace</a>.<a href="../../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a> == <span class="r84 r">runspaceId</span>)
                {
                    <b>return</b> <span class="r85 r">session</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private void</b> <a id="fb5925eb170a130e" href="../../../R/fb5925eb170a130e.html" target="n" data-glyph="76,1" class="i method">HandlePipelinesStopped</a>()
        {
            <span class="c">// Emit warning for cases where commands were stopped during connection retry attempts.</span>
            <b>bool</b> <span id="r86 rd" class="r86 r">retryCanceled</span> = <b>false</b>;
            <span class="i">Collection</span>&lt;<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>&gt; <span id="r87 rd" class="r87 r">powershells</span> = <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#990794abb8c5fc87" class="i method">GetPowerShells</a>();
            <b>foreach</b> (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r88 rd" class="r88 r">ps</span> <b>in</b> <span class="r87 r">powershells</span>)
            {
                <b>if</b> (<span class="r88 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#2f2a1f6f4e814646" class="i property">RemotePowerShell</a> != <b>null</b> &amp;&amp;
                    <span class="r88 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#2f2a1f6f4e814646" class="i property">RemotePowerShell</a>.<a href="../client/ClientRemotePowerShell.cs.html#f77c67364d15dbbd" class="i property">ConnectionRetryStatus</a> != <a href="../client/ClientRemotePowerShell.cs.html#79de75994075e7b1" class="t t">PSConnectionRetryStatus</a>.<a href="../client/ClientRemotePowerShell.cs.html#87b2c2caad361d9a" class="i field">None</a> &amp;&amp;
                    <span class="r88 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#2f2a1f6f4e814646" class="i property">RemotePowerShell</a>.<a href="../client/ClientRemotePowerShell.cs.html#f77c67364d15dbbd" class="i property">ConnectionRetryStatus</a> != <a href="../client/ClientRemotePowerShell.cs.html#79de75994075e7b1" class="t t">PSConnectionRetryStatus</a>.<a href="../client/ClientRemotePowerShell.cs.html#b10ca9abe40057c8" class="i field">ConnectionRetrySucceeded</a> &amp;&amp;
                    <span class="r88 r">ps</span>.<a href="../../hostifaces/PowerShell.cs.html#2f2a1f6f4e814646" class="i property">RemotePowerShell</a>.<a href="../client/ClientRemotePowerShell.cs.html#f77c67364d15dbbd" class="i property">ConnectionRetryStatus</a> != <a href="../client/ClientRemotePowerShell.cs.html#79de75994075e7b1" class="t t">PSConnectionRetryStatus</a>.<a href="../client/ClientRemotePowerShell.cs.html#0c117990dcafffe1" class="i field">AutoDisconnectSucceeded</a>)
                {
                    <span class="r86 r">retryCanceled</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r86 r">retryCanceled</span> &amp;&amp;
                <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a> != <b>null</b>)
            {
                <span class="c">// Write warning directly to host since pipeline has been stopped.</span>
                <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>.<a href="../../hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<span class="i">WriteWarningLine</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">StopCommandOnRetry</span>);
            }
        }
 
        <b>private void</b> <a id="b24b112e38dd8b63" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">StartProgressBar</a>(
            <b>long</b> <span id="r89 rd" class="r89 r">sourceId</span>,
            <b>string</b> <span id="r90 rd" class="r90 r">computerName</span>,
            <b>int</b> <span id="r91 rd" class="r91 r">totalSeconds</span>)
        {
            <a href="#818520ba64f5bc6b" class="i field">s_RCProgress</a>.<a href="#ff22cf6074e7d25c" class="i method">StartProgress</a>(
                <span class="r89 r">sourceId</span>,
                <span class="r90 r">computerName</span>,
                <span class="r91 r">totalSeconds</span>,
                <a href="#681287c2a35349b5" class="k">this</a>.<a href="../../CommandBase.cs.html#01105ebe2065fe1b" class="i property">Host</a>);
        }
 
        <b>private static void</b> <a id="837ad1e9054849da" href="../../../R/837ad1e9054849da.html" target="n" data-glyph="76,1" class="i method">StopProgressBar</a>(
            <b>long</b> <span id="r92 rd" class="r92 r">sourceId</span>)
        {
            <a href="#818520ba64f5bc6b" class="i field">s_RCProgress</a>.<a href="#ff9350d940a0d4b7" class="i method">StopProgress</a>(<span class="r92 r">sourceId</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the stream objects in the specified collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">results</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Collection to read from.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9f26fcdd1913580b" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">WriteStreamObjectsFromCollection</a>(<span class="i">IEnumerable</span>&lt;<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a>&gt; <span id="r93 rd" class="r93 r">results</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r94 rd" class="r94 r">result</span> <b>in</b> <span class="r93 r">results</span>)
            {
                <b>if</b> (<span class="r94 r">result</span> != <b>null</b>)
                {
                    <span class="i">PreProcessStreamObject</span>(<span class="r94 r">result</span>);
                    <span class="r94 r">result</span>.<span class="i">WriteStreamObject</span>(<a href="#681287c2a35349b5" class="k">this</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determine if we have to throw for a</span>
        <span class="c">///</span><span class="c"> &quot;throw&quot; statement from scripts</span>
        <span class="c">///</span><span class="c">  This means that the local pipeline will be terminated as well.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is valid when only one pipeline is</span>
        <span class="c">///</span><span class="c"> existing. Which means, there can be only one of the following:</span>
        <span class="c">///</span><span class="c">     1. A single computer name</span>
        <span class="c">///</span><span class="c">     2. A single session</span>
        <span class="c">///</span><span class="c">     3. A single uri</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> It can be used in conjunction with a filepath or a script block parameter</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> It doesn&#39;t take effect with the -AsJob parameter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private void</b> <a id="d8d183f1bc2cc825" href="../../../R/d8d183f1bc2cc825.html" target="n" data-glyph="76,1" class="i method">DetermineThrowStatementBehavior</a>()
        {
            <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="#46467fcec83f2fb3" class="i field">InProcParameterSet</a>))
            {
                <span class="c">// in proc parameter set - just return</span>
                <b>return</b>;
            }
 
            <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
            {
                <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#03ac4b61d9472c2d" class="i field">ComputerNameParameterSet</a>) ||
                    <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#8e424bd9bb5d66d0" class="i field">FilePathComputerNameParameterSet</a>))
                {
                    <b>if</b> (<a href="#22e9229fe692c271" class="i property">ComputerName</a>.<span class="i">Length</span> == 1)
                    {
                        <a href="#c3453840b4d4c0ec" class="i field">_propagateErrors</a> = <b>true</b>;
                    }
                }
                <b>else</b> <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1e3c25790a1dc5ac" class="i field">SessionParameterSet</a>) ||
                         <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#3e0d58dc67e03506" class="i field">FilePathSessionParameterSet</a>))
                {
                    <b>if</b> (<a href="#b4c85db4df20f57a" class="i property">Session</a>.<span class="i">Length</span> == 1)
                    {
                        <a href="#c3453840b4d4c0ec" class="i field">_propagateErrors</a> = <b>true</b>;
                    }
                }
                <b>else</b> <b>if</b> (<a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#00bdee282001266a" class="i field">UriParameterSet</a>) ||
                         <a href="../../MshCmdlet.cs.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#681287c2a35349b5" class="t t">InvokeCommandCommand</a>.<a href="PSRemotingCmdlet.cs.html#1a8ea2890f34e3ce" class="i field">FilePathUriParameterSet</a>))
                {
                    <b>if</b> (<a href="#647cd3e26531f0c9" class="i property">ConnectionUri</a>.<span class="i">Length</span> == 1)
                    {
                        <a href="#c3453840b4d4c0ec" class="i field">_propagateErrors</a> = <b>true</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process the stream object before writing it in the specified collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">streamObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Stream object to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="e81d0df2187231b4" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">PreProcessStreamObject</a>(<a href="../common/psstreamobject.cs.html#b7529596b91d1fc1" class="t t">PSStreamObject</a> <span id="r95 rd" class="r95 r">streamObject</span>)
        {
            <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r96 rd" class="r96 r">errorRecord</span> = <span class="r95 r">streamObject</span>.<a href="../common/psstreamobject.cs.html#2e16c93981f3ba22" class="i property">Value</a> <b>as</b> <a href="../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>;
 
            <span class="c">//</span>
            <span class="c">// In case of PSDirectException, we should output the precise error message</span>
            <span class="c">// in inner exception instead of the generic one in outer exception.</span>
            <span class="c">//</span>
            <b>if</b> ((<span class="r96 r">errorRecord</span> != <b>null</b>) &amp;&amp;
                (<span class="r96 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a> != <b>null</b>) &amp;&amp;
                (<span class="r96 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">InnerException</span> != <b>null</b>))
            {
                <a href="../common/remotingexceptions.cs.html#013d87579f687ee0" class="t t">PSDirectException</a> <span id="r97 rd" class="r97 r">ex</span> = <span class="r96 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">InnerException</span> <b>as</b> <a href="../common/remotingexceptions.cs.html#013d87579f687ee0" class="t t">PSDirectException</a>;
                <b>if</b> (<span class="r97 r">ex</span> != <b>null</b>)
                {
                    <span class="r95 r">streamObject</span>.<a href="../common/psstreamobject.cs.html#2e16c93981f3ba22" class="i property">Value</a> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r96 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">InnerException</span>,
                                                         <span class="r96 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>,
                                                         <span class="r96 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#ad21d23bc150cd3b" class="i property">CategoryInfo</a>.<a href="../../ErrorPackage.cs.html#f4073b5e554619ca" class="i property">Category</a>,
                                                         <span class="r96 r">errorRecord</span>.<a href="../../ErrorPackage.cs.html#61f8d29a1022ac67" class="i property">TargetObject</a>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private</b> <a href="../common/throttlemanager.cs.html#4aa32d51dd591ac8" class="t t">ThrottleManager</a> <a id="5f471de6ded7cc64" href="../../../R/5f471de6ded7cc64.html" target="n" data-glyph="46,1" class="i field">_throttleManager</a> = <b>new</b> <a href="../common/throttlemanager.cs.html#21c77408b36939a4" class="t constructor">ThrottleManager</a>();
        <span class="c">// throttle manager for handling all throttling operations</span>
        <b>private readonly</b> <span class="i">ManualResetEvent</span> <a id="a4b4b833ddbc07aa" href="../../../R/a4b4b833ddbc07aa.html" target="n" data-glyph="46,1" class="i field">_operationsComplete</a> = <b>new</b> <span class="i">ManualResetEvent</span>(<b>true</b>);
        <b>private</b> <span class="i">ManualResetEvent</span> <a id="f136f32673cd2281" href="../../../R/f136f32673cd2281.html" target="n" data-glyph="46,1" class="i field">_disconnectComplete</a>;
        <span class="c">// the initial state is true because when no</span>
        <span class="c">// operations actually take place as in case of a</span>
        <span class="c">// parameter binding exception, then Dispose is</span>
        <span class="c">// called. Since Dispose waits on this handler</span>
        <span class="c">// it is set to true initially and is Reset() in</span>
        <span class="c">// BeginProcessing()</span>
        <b>private</b> <a href="../client/Job.cs.html#60022000292afa6c" class="t t">PSInvokeExpressionSyncJob</a> <a id="c77e0142f1ed80b4" href="../../../R/c77e0142f1ed80b4.html" target="n" data-glyph="46,1" class="i field">_job</a>;
 
        <span class="c">// used for streaming behavior for local invocations</span>
        <b>private</b> <a href="../../lang/scriptblock.cs.html#5e20a8a88cfbe6cb" class="t t">SteppablePipeline</a> <a id="3e65c4777b358f36" href="../../../R/3e65c4777b358f36.html" target="n" data-glyph="46,1" class="i field">_steppablePipeline</a>;
 
        <b>private bool</b> <a id="466942bfef417a4a" href="../../../R/466942bfef417a4a.html" target="n" data-glyph="46,1" class="i field">_pipelineinvoked</a> = <b>false</b>;    <span class="c">// if pipeline has been invoked</span>
        <b>private bool</b> <a id="3d83dda3a1a3ae11" href="../../../R/3d83dda3a1a3ae11.html" target="n" data-glyph="46,1" class="i field">_inputStreamClosed</a> = <b>false</b>;
 
        <b>private const string</b> <a id="46467fcec83f2fb3" href="../../../R/46467fcec83f2fb3.html" target="n" data-glyph="10,1" class="i field">InProcParameterSet</a> = <span class="s">&quot;InProcess&quot;</span>;
 
        <b>private readonly</b> <a href="../../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<b>object</b>&gt; <a id="3012da8076340081" href="../../../R/3012da8076340081.html" target="n" data-glyph="46,1" class="i field">_input</a> = <b>new</b> <a href="../../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<b>object</b>&gt;();
        <b>private bool</b> <a id="23615e3abf1a95a6" href="../../../R/23615e3abf1a95a6.html" target="n" data-glyph="46,1" class="i field">_needToCollect</a> = <b>false</b>;
        <b>private bool</b> <a id="37af23dc42f39723" href="../../../R/37af23dc42f39723.html" target="n" data-glyph="46,1" class="i field">_needToStartSteppablePipelineOnServer</a> = <b>false</b>;
        <b>private bool</b> <a id="3c53a353e91ab1d4" href="../../../R/3c53a353e91ab1d4.html" target="n" data-glyph="46,1" class="i field">_clearInvokeCommandOnRunspace</a> = <b>false</b>;
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="../../../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a>&gt; <a id="b69e9b6b8af9d26e" href="../../../R/b69e9b6b8af9d26e.html" target="n" data-glyph="46,1" class="i field">_inputWriters</a> = <b>new</b> <span class="i">List</span>&lt;<a href="../../../utils/IObjectWriter.cs.html#37301df630b2ae9a" class="t t">PipelineWriter</a>&gt;();
        <b>private readonly object</b> <a id="bbe07da3e35e4a77" href="../../../R/bbe07da3e35e4a77.html" target="n" data-glyph="46,1" class="i field">_jobSyncObject</a> = <b>new</b> <b>object</b>();
        <b>private bool</b> <a id="f937a77bde5bab56" href="../../../R/f937a77bde5bab56.html" target="n" data-glyph="46,1" class="i field">_nojob</a> = <b>false</b>;
        <b>private readonly</b> <span class="i">Guid</span> <a id="b1561315dea6f55a" href="../../../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">_instanceId</a> = <span class="i">Guid</span>.<span class="i">NewGuid</span>();
        <b>private bool</b> <a id="c3453840b4d4c0ec" href="../../../R/c3453840b4d4c0ec.html" target="n" data-glyph="46,1" class="i field">_propagateErrors</a> = <b>false</b>;
 
        <b>private static readonly</b> <a href="#477d8c447d18a1e0" class="t t">RobustConnectionProgress</a> <a id="818520ba64f5bc6b" href="../../../R/818520ba64f5bc6b.html" target="n" data-glyph="46,1" class="i field">s_RCProgress</a> = <b>new</b> <a href="#2a335b145a11de2b" class="t constructor">RobustConnectionProgress</a>();
 
        <b>internal static readonly string</b> <a id="ea95cff09d211ae0" href="../../../R/ea95cff09d211ae0.html" target="n" data-glyph="44,1" class="i field">RemoteJobType</a> = <span class="s">&quot;RemoteJob&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose the cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="0ebe8cf1eb8467ec" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#0fd5ab4fcd43a387" class="i method">Dispose</a>(<b>true</b>);
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#681287c2a35349b5" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Internal dispose method which does the actual disposing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Whether called from dispose or finalize.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="0fd5ab4fcd43a387" href="../../../R/0fd5ab4fcd43a387.html" target="n" data-glyph="76,1" class="i method">Dispose</a>(<b>bool</b> <span id="r98 rd" class="r98 r">disposing</span>)
        {
            <b>if</b> (<span class="r98 r">disposing</span>)
            {
                <span class="c">// this call fixes bug Windows 7 #278836</span>
                <span class="c">// by making sure the server is stopped even if it is waiting</span>
                <span class="c">// for further input from this Invoke-Command cmdlet</span>
 
                <a href="#681287c2a35349b5" class="k">this</a>.<a href="#e80dee5e35e3e6d5" class="i method">StopProcessing</a>();
                <span class="c">// wait for all operations to complete</span>
                <a href="#a4b4b833ddbc07aa" class="i field">_operationsComplete</a>.<span class="i">WaitOne</span>();
                <a href="#a4b4b833ddbc07aa" class="i field">_operationsComplete</a>.<span class="i">Dispose</span>();
 
                <b>if</b> (!<a href="#5c111907db4cb309" class="i field">_asjob</a>)
                {
                    <b>if</b> (<a href="#c77e0142f1ed80b4" class="i field">_job</a> != <b>null</b>)
                    {
                        <span class="c">// job will be null in the &quot;InProcess&quot; case</span>
                        <a href="#c77e0142f1ed80b4" class="i field">_job</a>.<a href="../client/Job.cs.html#a1b7a0cd2d734ade" class="i method">Dispose</a>();
                    }
 
                    <a href="#5f471de6ded7cc64" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd885eab312c9a19" class="i">ThrottleComplete</a> -= <span class="i">HandleThrottleComplete</span>;
                    <a href="#5f471de6ded7cc64" class="i field">_throttleManager</a>.<a href="../common/throttlemanager.cs.html#dd620168185a530e" class="i method">Dispose</a>();
                    <a href="#5f471de6ded7cc64" class="i field">_throttleManager</a> = <b>null</b>;
                }
 
                <span class="c">// clear the invoke command references we have stored</span>
                <b>if</b> (<a href="#3c53a353e91ab1d4" class="i field">_clearInvokeCommandOnRunspace</a>)
                {
                    <a href="#b1d0c777585dfbde" class="i method">ClearInvokeCommandOnRunspaces</a>();
                }
 
                <a href="#3012da8076340081" class="i field">_input</a>.<a href="../../hostifaces/PSDataCollection.cs.html#17fb91187cc003fd" class="i method">Dispose</a>();
 
                <b>lock</b> (<a href="#bbe07da3e35e4a77" class="i field">_jobSyncObject</a>)
                {
                    <b>if</b> (<a href="#f136f32673cd2281" class="i field">_disconnectComplete</a> != <b>null</b>)
                    {
                        <a href="#f136f32673cd2281" class="i field">_disconnectComplete</a>.<span class="i">Dispose</span>();
                        <a href="#f136f32673cd2281" class="i field">_disconnectComplete</a> = <b>null</b>;
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Overrides
    }
}
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RobustConnectionProgress class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Encapsulates the Robust Connection retry progress bar.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="477d8c447d18a1e0" href="../../../R/477d8c447d18a1e0.html" target="n" data-glyph="2,0" class="t t">RobustConnectionProgress</a>
    {
        <b>private</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <a id="305099b3729863a2" href="../../../R/305099b3729863a2.html" target="n" data-glyph="46,1" class="i field">_psHost</a>;
        <b>private readonly string</b> <a id="d76c57f959de6b21" href="../../../R/d76c57f959de6b21.html" target="n" data-glyph="46,1" class="i field">_activity</a>;
        <b>private string</b> <a id="7507159c93c7fcd1" href="../../../R/7507159c93c7fcd1.html" target="n" data-glyph="46,1" class="i field">_status</a>;
        <b>private int</b> <a id="f3f715d8173c9d25" href="../../../R/f3f715d8173c9d25.html" target="n" data-glyph="46,1" class="i field">_secondsTotal</a>;
        <b>private int</b> <a id="f49e9f24fb32a23c" href="../../../R/f49e9f24fb32a23c.html" target="n" data-glyph="46,1" class="i field">_secondsRemaining</a>;
        <b>private</b> <a href="../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <a id="4c585b38d88ce69c" href="../../../R/4c585b38d88ce69c.html" target="n" data-glyph="46,1" class="i field">_progressRecord</a>;
        <b>private long</b> <a id="8f1b2ba8bc411db9" href="../../../R/8f1b2ba8bc411db9.html" target="n" data-glyph="46,1" class="i field">_sourceId</a>;
        <b>private bool</b> <a id="6c2cb3486380e98d" href="../../../R/6c2cb3486380e98d.html" target="n" data-glyph="46,1" class="i field">_progressIsRunning</a>;
        <b>private readonly object</b> <a id="1f555b4c9021c025" href="../../../R/1f555b4c9021c025.html" target="n" data-glyph="46,1" class="i field">_syncObject</a>;
        <b>private</b> <span class="i">Timer</span> <a id="f88ba642acd625f2" href="../../../R/f88ba642acd625f2.html" target="n" data-glyph="46,1" class="i field">_updateTimer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="2a335b145a11de2b" href="../../../R/2a335b145a11de2b.html" target="n" data-glyph="72,1" class="t constructor">RobustConnectionProgress</a>()
        {
            <a href="#1f555b4c9021c025" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();
            <a href="#d76c57f959de6b21" class="i field">_activity</a> = <span class="i">RemotingErrorIdStrings</span>.<span class="i">RCProgressActivity</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Starts progress bar.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">sourceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">secondsTotal</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">psHost</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ff22cf6074e7d25c" href="../../../R/ff22cf6074e7d25c.html" target="n" data-glyph="72,1" class="i method">StartProgress</a>(
            <b>long</b> <span id="r99 rd" class="r99 r">sourceId</span>,
            <b>string</b> <span id="r100 rd" class="r100 r">computerName</span>,
            <b>int</b> <span id="r101 rd" class="r101 r">secondsTotal</span>,
            <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>.<a href="../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r102 rd" class="r102 r">psHost</span>)
        {
            <b>if</b> (<span class="r102 r">psHost</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r101 r">secondsTotal</span> &lt; 1)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r100 r">computerName</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r100 r">computerName</span>));
            }
 
            <b>lock</b> (<a href="#1f555b4c9021c025" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#6c2cb3486380e98d" class="i field">_progressIsRunning</a>)
                {
                    <b>return</b>;
                }
 
                <a href="#6c2cb3486380e98d" class="i field">_progressIsRunning</a> = <b>true</b>;
                <a href="#8f1b2ba8bc411db9" class="i field">_sourceId</a> = <span class="r99 r">sourceId</span>;
                <a href="#f3f715d8173c9d25" class="i field">_secondsTotal</a> = <span class="r101 r">secondsTotal</span>;
                <a href="#f49e9f24fb32a23c" class="i field">_secondsRemaining</a> = <span class="r101 r">secondsTotal</span>;
                <a href="#305099b3729863a2" class="i field">_psHost</a> = <span class="r102 r">psHost</span>;
                <a href="#7507159c93c7fcd1" class="i field">_status</a> = <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">RCProgressStatus</span>, <span class="r100 r">computerName</span>);
                <a href="#4c585b38d88ce69c" class="i field">_progressRecord</a> = <b>new</b> <a href="../../ProgressRecord.cs.html#fc5a01f49984a3f9" class="t constructor">ProgressRecord</a>(0, <a href="#d76c57f959de6b21" class="i field">_activity</a>, <a href="#7507159c93c7fcd1" class="i field">_status</a>);
 
                <span class="c">// Create timer to fire every second to update progress bar.</span>
                <a href="#f88ba642acd625f2" class="i field">_updateTimer</a> = <b>new</b> <span class="i">Timer</span>(<b>new</b> <span class="i">TimerCallback</span>(<span class="i">UpdateCallback</span>), <b>null</b>, <span class="i">TimeSpan</span>.<span class="i">Zero</span>, <b>new</b> <span class="i">TimeSpan</span>(0, 0, 1));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops progress bar.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ff9350d940a0d4b7" href="../../../R/ff9350d940a0d4b7.html" target="n" data-glyph="72,1" class="i method">StopProgress</a>(
            <b>long</b> <span id="r103 rd" class="r103 r">sourceId</span>)
        {
            <b>lock</b> (<a href="#1f555b4c9021c025" class="i field">_syncObject</a>)
            {
                <b>if</b> ((<span class="r103 r">sourceId</span> == <a href="#8f1b2ba8bc411db9" class="i field">_sourceId</a> || <span class="r103 r">sourceId</span> == 0) &amp;&amp;
                    <a href="#6c2cb3486380e98d" class="i field">_progressIsRunning</a>)
                {
                    <a href="#1dc6c28aae7f9f81" class="i method">RemoveProgressBar</a>();
                }
            }
        }
 
        <b>private void</b> <a id="31a8eefe87fa8635" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">UpdateCallback</a>(<b>object</b> <span id="r104 rd" class="r104 r">state</span>)
        {
            <b>lock</b> (<a href="#1f555b4c9021c025" class="i field">_syncObject</a>)
            {
                <b>if</b> (!<a href="#6c2cb3486380e98d" class="i field">_progressIsRunning</a>)
                {
                    <b>return</b>;
                }
 
                <b>if</b> (<a href="#f49e9f24fb32a23c" class="i field">_secondsRemaining</a> &gt; 0)
                {
                    <span class="c">// Update progress bar.</span>
                    <a href="#4c585b38d88ce69c" class="i field">_progressRecord</a>.<a href="../../ProgressRecord.cs.html#7c559492a0012510" class="i property">PercentComplete</a> =
                        ((<a href="#f3f715d8173c9d25" class="i field">_secondsTotal</a> - <a href="#f49e9f24fb32a23c" class="i field">_secondsRemaining</a>) * 100) / <a href="#f3f715d8173c9d25" class="i field">_secondsTotal</a>;
                    <a href="#4c585b38d88ce69c" class="i field">_progressRecord</a>.<a href="../../ProgressRecord.cs.html#b36a767584bc86ea" class="i property">SecondsRemaining</a> = <a href="#f49e9f24fb32a23c" class="i field">_secondsRemaining</a>--;
                    <a href="#4c585b38d88ce69c" class="i field">_progressRecord</a>.<a href="../../ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a> = <a href="../../ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="../../ProgressRecord.cs.html#b02a1a2b864a452c" class="i field">Processing</a>;
                    <a href="#305099b3729863a2" class="i field">_psHost</a>.<a href="../../hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<span class="i">WriteProgress</span>(0, <a href="#4c585b38d88ce69c" class="i field">_progressRecord</a>);
                }
                <b>else</b>
                {
                    <span class="c">// Remove progress bar.</span>
                    <a href="#1dc6c28aae7f9f81" class="i method">RemoveProgressBar</a>();
                }
            }
        }
 
        <b>private void</b> <a id="1dc6c28aae7f9f81" href="../../../R/1dc6c28aae7f9f81.html" target="n" data-glyph="76,1" class="i method">RemoveProgressBar</a>()
        {
            <a href="#6c2cb3486380e98d" class="i field">_progressIsRunning</a> = <b>false</b>;
 
            <span class="c">// Remove progress bar.</span>
            <a href="#4c585b38d88ce69c" class="i field">_progressRecord</a>.<a href="../../ProgressRecord.cs.html#b83bd20609cddaf5" class="i property">RecordType</a> = <a href="../../ProgressRecord.cs.html#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="../../ProgressRecord.cs.html#be29e101fe03f5d0" class="i field">Completed</a>;
            <a href="#305099b3729863a2" class="i field">_psHost</a>.<a href="../../hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<span class="i">WriteProgress</span>(0, <a href="#4c585b38d88ce69c" class="i field">_progressRecord</a>);
 
            <span class="c">// Remove timer.</span>
            <a href="#f88ba642acd625f2" class="i field">_updateTimer</a>.<span class="i">Dispose</span>();
            <a href="#f88ba642acd625f2" class="i field">_updateTimer</a> = <b>null</b>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
