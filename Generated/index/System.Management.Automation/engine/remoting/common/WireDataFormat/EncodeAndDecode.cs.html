<!DOCTYPE html>
<html><head><title>EncodeAndDecode.cs</title><link rel="stylesheet" href="../../../../../styles.css"><script src="../../../../../scripts.js"></script></head>
<body class="cB" onload="i(2413);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/common/WireDataFormat/EncodeAndDecode.cs" target="_top">engine\remoting\common\WireDataFormat\EncodeAndDecode.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Tracing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">NOT_USED</span>
<span class="e">
    /// &lt;summary&gt;
    /// This represents that a remote data is incorrectly encoded.
    /// &lt;/summary&gt;
    public class RemotingEncodingException : RuntimeException
    {
</span>    <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
<span class="e">
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        public RemotingEncodingException()
            : base()
        {
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;message&quot;&gt;&lt;/param&gt;
        public RemotingEncodingException(string message)
            : base (message)
        {
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;message&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;innerException&quot;&gt;&lt;/param&gt;
        public RemotingEncodingException(string message, Exception innerException)
            : base(message, innerException)
        {
        }
 
        /// &lt;summary&gt;
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;message&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;innerException&quot;&gt;&lt;/param&gt;
        /// &lt;param name=&quot;errorRecord&quot;&gt;&lt;/param&gt;
        public RemotingEncodingException(string message, Exception innerException, ErrorRecord errorRecord)
            : base(message, innerException, errorRecord)
        {
        }
 
</span>    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
<span class="e">    }
 
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span> <span class="c">// NOT_USED</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Constants used by hosts in remoting.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="d19a1042a44001e8" href="../../../../R/d19a1042a44001e8.html" target="n" data-glyph="2,0" class="t t">RemotingConstants</a>
    {
        <b>internal static readonly</b> <span class="i">Version</span> <a id="7f28502b8f30d02e" href="../../../../R/7f28502b8f30d02e.html" target="n" data-glyph="44,1" class="i field">HostVersion</a> = <a href="../../../PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../../PSVersionInfo.cs.html#ad63365ac7690eeb" class="i property">PSVersion</a>;
 
        <b>internal static readonly</b> <span class="i">Version</span> <a id="752985e4c2adeccd" href="../../../../R/752985e4c2adeccd.html" target="n" data-glyph="44,1" class="i field">ProtocolVersionWin7RC</a> = <b>new</b> <span class="i">Version</span>(2, 0);
        <b>internal static readonly</b> <span class="i">Version</span> <a id="cdbd21e6ffe53584" href="../../../../R/cdbd21e6ffe53584.html" target="n" data-glyph="44,1" class="i field">ProtocolVersionWin7RTM</a> = <b>new</b> <span class="i">Version</span>(2, 1);
        <b>internal static readonly</b> <span class="i">Version</span> <a id="fd42c50dee2d8244" href="../../../../R/fd42c50dee2d8244.html" target="n" data-glyph="44,1" class="i field">ProtocolVersionWin8RTM</a> = <b>new</b> <span class="i">Version</span>(2, 2);
        <b>internal static readonly</b> <span class="i">Version</span> <a id="a52fd4a38c196083" href="../../../../R/a52fd4a38c196083.html" target="n" data-glyph="44,1" class="i field">ProtocolVersionWin10RTM</a> = <b>new</b> <span class="i">Version</span>(2, 3);
 
        <span class="c">// Minor will be incremented for each change in PSRP client/server stack and new versions will be</span>
        <span class="c">// forked on early major release/drop changes history.</span>
        <span class="c">//      2.101 to 2.102 - Disconnect support as of M2</span>
        <span class="c">//      2.102 to 2.103 - Key exchange protocol changes in M3</span>
        <span class="c">//      2.103 to 2.2   - Final ship protocol version value, no change to protocol</span>
        <span class="c">//      2.2 to 2.3     - Enabling informational stream</span>
        <b>internal static readonly</b> <span class="i">Version</span> <a id="827dc47eeb14723b" href="../../../../R/827dc47eeb14723b.html" target="n" data-glyph="44,1" class="i field">ProtocolVersionCurrent</a> = <b>new</b> <span class="i">Version</span>(2, 3);
        <b>internal static readonly</b> <span class="i">Version</span> <a id="c5be07ec763d4c13" href="../../../../R/c5be07ec763d4c13.html" target="n" data-glyph="44,1" class="i field">ProtocolVersion</a> = <a href="#827dc47eeb14723b" class="i field">ProtocolVersionCurrent</a>;
        <span class="c">// Used by remoting commands to add remoting specific note properties.</span>
        <b>internal static readonly string</b> <a id="b64ee1a165cf4e4d" href="../../../../R/b64ee1a165cf4e4d.html" target="n" data-glyph="44,1" class="i field">ComputerNameNoteProperty</a> = <span class="s">&quot;PSComputerName&quot;</span>;
        <b>internal static readonly string</b> <a id="283cde56f2755f0c" href="../../../../R/283cde56f2755f0c.html" target="n" data-glyph="44,1" class="i field">RunspaceIdNoteProperty</a> = <span class="s">&quot;RunspaceId&quot;</span>;
        <b>internal static readonly string</b> <a id="63fb661fa395e3a3" href="../../../../R/63fb661fa395e3a3.html" target="n" data-glyph="44,1" class="i field">ShowComputerNameNoteProperty</a> = <span class="s">&quot;PSShowComputerName&quot;</span>;
        <b>internal static readonly string</b> <a id="b6939c85b2591c0c" href="../../../../R/b6939c85b2591c0c.html" target="n" data-glyph="44,1" class="i field">SourceJobInstanceId</a> = <span class="s">&quot;PSSourceJobInstanceId&quot;</span>;
        <b>internal static readonly string</b> <a id="0a3616a388cc20be" href="../../../../R/0a3616a388cc20be.html" target="n" data-glyph="44,1" class="i field">EventObject</a> = <span class="s">&quot;PSEventObject&quot;</span>;
        <span class="c">// used by Custom Shell related cmdlets.</span>
        <b>internal const string</b> <a id="3188dd90ac4b908b" href="../../../../R/3188dd90ac4b908b.html" target="n" data-glyph="8,1" class="i field">PSSessionConfigurationNoun</a> = <span class="s">&quot;PSSessionConfiguration&quot;</span>;
        <b>internal const string</b> <a id="ed7ccaab0f1439c0" href="../../../../R/ed7ccaab0f1439c0.html" target="n" data-glyph="8,1" class="i field">PSRemotingNoun</a> = <span class="s">&quot;PSRemoting&quot;</span>;
        <b>internal const string</b> <a id="7cbb6da0d7ec5022" href="../../../../R/7cbb6da0d7ec5022.html" target="n" data-glyph="8,1" class="i field">PSPluginDLLName</a> = <span class="s">&quot;pwrshplugin.dll&quot;</span>;
        <b>internal const string</b> <a id="281bed97cc0ff841" href="../../../../R/281bed97cc0ff841.html" target="n" data-glyph="8,1" class="i field">DefaultShellName</a> = <span class="s">&quot;Microsoft.PowerShell&quot;</span>;
        <b>internal const string</b> <a id="2542701c66e03ff5" href="../../../../R/2542701c66e03ff5.html" target="n" data-glyph="8,1" class="i field">MaxIdleTimeoutMS</a> = <span class="s">&quot;2147483647&quot;</span>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> String constants used for names of properties that are for storing</span>
    <span class="c">///</span><span class="c"> remoting message fields in a PSObject property bag.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="7c9c1b0b95848ffd" href="../../../../R/7c9c1b0b95848ffd.html" target="n" data-glyph="2,0" class="t t">RemoteDataNameStrings</a>
    {
        <b>internal const string</b> <a id="d37609cd94a31377" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">Destination</a> = <span class="s">&quot;Destination&quot;</span>;
        <b>internal const string</b> <a id="c4bb7f09de8e6e8c" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">RemotingTargetInterface</a> = <span class="s">&quot;RemotingTargetInterface&quot;</span>;
        <b>internal const string</b> <a id="2cd079541e03998e" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">ClientRunspacePoolId</a> = <span class="s">&quot;ClientRunspacePoolId&quot;</span>;
        <b>internal const string</b> <a id="0893a71de902b3b7" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">ClientPowerShellId</a> = <span class="s">&quot;ClientPowerShellId&quot;</span>;
        <b>internal const string</b> <a id="b710be11d97faf74" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">Action</a> = <span class="s">&quot;Action&quot;</span>;
        <b>internal const string</b> <a id="04cf54a23398c542" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">DataType</a> = <span class="s">&quot;DataType&quot;</span>;
        <span class="c">// used by negotiation algorithm to figure out client&#39;s timezone.</span>
        <b>internal const string</b> <a id="f13438743b679ac0" href="../../../../R/f13438743b679ac0.html" target="n" data-glyph="8,1" class="i field">TimeZone</a> = <span class="s">&quot;TimeZone&quot;</span>;
        <b>internal const string</b> <a id="26dfe90bf75ed7ad" href="../../../../R/26dfe90bf75ed7ad.html" target="n" data-glyph="8,1" class="i field">SenderInfoPreferenceVariable</a> = <span class="s">&quot;PSSenderInfo&quot;</span>;
        <span class="c">// used by negotiation algorithm to figure out if the negotiation</span>
        <span class="c">// request (from client) must comply.</span>
        <b>internal const string</b> <a id="a6e4d49185b1abb5" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MustComply</a> = <span class="s">&quot;MustComply&quot;</span>;
        <span class="c">// used by negotiation algorithm. Server sends this information back</span>
        <span class="c">// to client to let client know if the negotiation succeeded.</span>
        <b>internal const string</b> <a id="5af6495309fef97e" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">IsNegotiationSucceeded</a> = <span class="s">&quot;IsNegotiationSucceeded&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;PSv2 Tab Expansion Function&quot;
 
        <b>internal const string</b> <a id="551ddfb6b265cbfc" href="../../../../R/551ddfb6b265cbfc.html" target="n" data-glyph="8,1" class="i field">PSv2TabExpansionFunction</a> = <span class="s">&quot;TabExpansion&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the PSv2 function for tab expansion. It&#39;s only for legacy purpose - used in</span>
        <span class="c">///</span><span class="c"> an interactive remote session from a win7 machine to a win8 machine (or later).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="689c3486f85e6159" href="../../../../R/689c3486f85e6159.html" target="n" data-glyph="8,1" class="i field">PSv2TabExpansionFunctionText</a> = <span class="s">@&quot;
            param($line, $lastWord)
            &amp; {
                function Write-Members ($sep=&#39;.&#39;)
                {
                    Invoke-Expression (&#39;$_val=&#39; + $_expression)
 
                    $_method = [Management.Automation.PSMemberTypes] `
                        &#39;Method,CodeMethod,ScriptMethod,ParameterizedProperty&#39;
                    if ($sep -eq &#39;.&#39;)
                    {
                        $params = @{view = &#39;extended&#39;,&#39;adapted&#39;,&#39;base&#39;}
                    }
                    else
                    {
                        $params = @{static=$true}
                    }
 
                    foreach ($_m in ,$_val | Get-Member @params $_pat |
                        Sort-Object membertype,name)
                    {
                        if ($_m.MemberType -band $_method)
                        {
                            # Return a method...
                            $_base + $_expression + $sep + $_m.name + &#39;(&#39;
                        }
                        else {
                            # Return a property...
                            $_base + $_expression + $sep + $_m.name
                        }
                    }
                }
 
                # If a command name contains any of these chars, it needs to be quoted
                $_charsRequiringQuotes = (&#39;`&amp;@&#39;&#39;#{}()$,;|&lt;&gt; &#39; + &quot;&quot;`t&quot;&quot;).ToCharArray()
 
                # If a variable name contains any of these characters it needs to be in braces
                $_varsRequiringQuotes = (&#39;-`&amp;@&#39;&#39;#{}()$,;|&lt;&gt; .\/&#39; + &quot;&quot;`t&quot;&quot;).ToCharArray()
 
                switch -regex ($lastWord)
                {
                    # Handle property and method expansion rooted at variables...
                    # e.g. $a.b.&lt;tab&gt;
                    &#39;(^.*)(\$(\w|:|\.)+)\.([*\w]*)$&#39; {
                        $_base = $matches[1]
                        $_expression = $matches[2]
                        $_pat = $matches[4] + &#39;*&#39;
                        Write-Members
                        break;
                    }
 
                    # Handle simple property and method expansion on static members...
                    # e.g. [datetime]::n&lt;tab&gt;
                    &#39;(^.*)(\[(\w|\.|\+)+\])(\:\:|\.){0,1}([*\w]*)$&#39; {
                        $_base = $matches[1]
                        $_expression = $matches[2]
                        $_pat = $matches[5] + &#39;*&#39;
                        Write-Members $(if (! $matches[4]) {&#39;::&#39;} else {$matches[4]})
                        break;
                    }
 
                    # Handle complex property and method expansion on static members
                    # where there are intermediate properties...
                    # e.g. [datetime]::now.d&lt;tab&gt;
                    &#39;(^.*)(\[(\w|\.|\+)+\](\:\:|\.)(\w+\.)+)([*\w]*)$&#39; {
                        $_base = $matches[1]  # everything before the expression
                        $_expression = $matches[2].TrimEnd(&#39;.&#39;) # expression less trailing &#39;.&#39;
                        $_pat = $matches[6] + &#39;*&#39;  # the member to look for...
                        Write-Members
                        break;
                    }
 
                    # Handle variable name expansion...
                    &#39;(^.*\$)([*\w:]+)$&#39; {
                        $_prefix = $matches[1]
                        $_varName = $matches[2]
                        $_colonPos = $_varname.IndexOf(&#39;:&#39;)
                        if ($_colonPos -eq -1)
                        {
                            $_varName = &#39;variable:&#39; + $_varName
                            $_provider = &#39;&#39;
                        }
                        else
                        {
                            $_provider = $_varname.Substring(0, $_colonPos+1)
                        }
 
                        foreach ($_v in Get-ChildItem ($_varName + &#39;*&#39;) | sort Name)
                        {
                            $_nameFound = $_v.name
                            $(if ($_nameFound.IndexOfAny($_varsRequiringQuotes) -eq -1) {&#39;{0}{1}{2}&#39;}
                            else {&#39;{0}{{{1}{2}}}&#39;}) -f $_prefix, $_provider, $_nameFound
                        }
 
                        break;
                    }
 
                    # Do completion on parameters...
                    &#39;^-([*\w0-9]*)&#39; {
                        $_pat = $matches[1] + &#39;*&#39;
 
                        # extract the command name from the string
                        # first split the string into statements and pipeline elements
                        # This doesn&#39;t handle strings however.
                        $_command = [regex]::Split($line, &#39;[|;=]&#39;)[-1]
 
                        #  Extract the trailing unclosed block e.g. ls | foreach { cp
                        if ($_command -match &#39;\{([^\{\}]*)$&#39;)
                        {
                            $_command = $matches[1]
                        }
 
                        # Extract the longest unclosed parenthetical expression...
                        if ($_command -match &#39;\(([^()]*)$&#39;)
                        {
                            $_command = $matches[1]
                        }
 
                        # take the first space separated token of the remaining string
                        # as the command to look up. Trim any leading or trailing spaces
                        # so you don&#39;t get leading empty elements.
                        $_command = $_command.TrimEnd(&#39;-&#39;)
                        $_command,$_arguments = $_command.Trim().Split()
 
                        # now get the info object for it, -ArgumentList will force aliases to be resolved
                        # it also retrieves dynamic parameters
                        try
                        {
                            $_command = @(Get-Command -type &#39;Alias,Cmdlet,Function,Filter,ExternalScript&#39; `
                                -Name $_command -ArgumentList $_arguments)[0]
                        }
                        catch
                        {
                            # see if the command is an alias. If so, resolve it to the real command
                            if(Test-Path alias:\$_command)
                            {
                                $_command = @(Get-Command -Type Alias $_command)[0].Definition
                            }
 
                            # If we were unsuccessful retrieving the command, try again without the parameters
                            $_command = @(Get-Command -type &#39;Cmdlet,Function,Filter,ExternalScript&#39; `
                                -Name $_command)[0]
                        }
 
                        # remove errors generated by the command not being found, and break
                        if(-not $_command) { $error.RemoveAt(0); break; }
 
                        # expand the parameter sets and emit the matching elements
                        # need to use psbase.Keys in case &#39;keys&#39; is one of the parameters
                        # to the cmdlet
                        foreach ($_n in $_command.Parameters.psbase.Keys)
                        {
                            if ($_n -like $_pat) { &#39;-&#39; + $_n }
                        }
 
                        break;
                    }
 
                    # Tab complete against history either #&lt;pattern&gt; or #&lt;id&gt;
                    &#39;^#(\w*)&#39; {
                        $_pattern = $matches[1]
                        if ($_pattern -match &#39;^[0-9]+$&#39;)
                        {
                            Get-History -ea SilentlyContinue -Id $_pattern | ForEach-Object { $_.CommandLine }
                        }
                        else
                        {
                            $_pattern = &#39;*&#39; + $_pattern + &#39;*&#39;
                            Get-History -Count 32767 | Sort-Object -Descending Id| ForEach-Object { $_.CommandLine } | where { $_ -like $_pattern }
                        }
 
                        break;
                    }
 
                    # try to find a matching command...
                    default {
                        # parse the script...
                        $_tokens = [System.Management.Automation.PSParser]::Tokenize($line,
                            [ref] $null)
 
                        if ($_tokens)
                        {
                            $_lastToken = $_tokens[$_tokens.count - 1]
                            if ($_lastToken.Type -eq &#39;Command&#39;)
                            {
                                $_cmd = $_lastToken.Content
 
                                # don&#39;t look for paths...
                                if ($_cmd.IndexOfAny(&#39;/\:&#39;) -eq -1)
                                {
                                    # handle parsing errors - the last token string should be the last
                                    # string in the line...
                                    if ($lastword.Length -ge $_cmd.Length -and
                                        $lastword.substring($lastword.length-$_cmd.length) -eq $_cmd)
                                    {
                                        $_pat = $_cmd + &#39;*&#39;
                                        $_base = $lastword.substring(0, $lastword.length-$_cmd.length)
 
                                        # get files in current directory first, then look for commands...
                                        $( try {Resolve-Path -ea SilentlyContinue -Relative $_pat } catch {} ;
                                           try { $ExecutionContext.InvokeCommand.GetCommandName($_pat, $true, $false) |
                                               Sort-Object -Unique } catch {} ) |
                                                   # If the command contains non-word characters (space, ) ] ; ) etc.)
                                                   # then it needs to be quoted and prefixed with &amp;
                                                   ForEach-Object {
                                                        if ($_.IndexOfAny($_charsRequiringQuotes) -eq -1) { $_ }
                                                        elseif ($_.IndexOf(&#39;&#39;&#39;&#39;) -ge 0) {&#39;&amp; &#39;&#39;{0}&#39;&#39;&#39; -f $_.Replace(&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;&#39;&#39;) }
                                                        else { &#39;&amp; &#39;&#39;{0}&#39;&#39;&#39; -f $_ }} |
                                                   ForEach-Object {&#39;{0}{1}&#39; -f $_base,$_ }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        &quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;PSv2 Tab Expansion Function&quot;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Host Related Strings
 
        <b>internal const string</b> <a id="9b48d21fcadf90c0" href="../../../../R/9b48d21fcadf90c0.html" target="n" data-glyph="8,1" class="i field">CallId</a> = <span class="s">&quot;ci&quot;</span>;
        <b>internal const string</b> <a id="870eec6850f45e8d" href="../../../../R/870eec6850f45e8d.html" target="n" data-glyph="8,1" class="i field">MethodId</a> = <span class="s">&quot;mi&quot;</span>;
        <b>internal const string</b> <a id="c7505e0840c4ff0c" href="../../../../R/c7505e0840c4ff0c.html" target="n" data-glyph="8,1" class="i field">MethodParameters</a> = <span class="s">&quot;mp&quot;</span>;
        <b>internal const string</b> <a id="19bea0fdda0f56ab" href="../../../../R/19bea0fdda0f56ab.html" target="n" data-glyph="8,1" class="i field">MethodReturnValue</a> = <span class="s">&quot;mr&quot;</span>;
        <b>internal const string</b> <a id="8dbf6f76e9557491" href="../../../../R/8dbf6f76e9557491.html" target="n" data-glyph="8,1" class="i field">MethodException</a> = <span class="s">&quot;me&quot;</span>;
 
        <b>internal const string</b> <a id="c416521156fef723" href="../../../../R/c416521156fef723.html" target="n" data-glyph="8,1" class="i field">PS_STARTUP_PROTOCOL_VERSION_NAME</a> = <span class="s">&quot;protocolversion&quot;</span>;
        <b>internal const string</b> <a id="2ce6b1d37d0d9ec4" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">PublicKeyAsXml</a> = <span class="s">&quot;PublicKeyAsXml&quot;</span>;
        <b>internal const string</b> <a id="09a93f00dbacc96b" href="../../../../R/09a93f00dbacc96b.html" target="n" data-glyph="8,1" class="i field">PSVersion</a> = <span class="s">&quot;PSVersion&quot;</span>;
        <b>internal const string</b> <a id="27d5b1b7d3362576" href="../../../../R/27d5b1b7d3362576.html" target="n" data-glyph="8,1" class="i field">SerializationVersion</a> = <span class="s">&quot;SerializationVersion&quot;</span>;
 
        <b>internal const string</b> <a id="06c9490f32a520c6" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MethodArrayElementType</a> = <span class="s">&quot;mat&quot;</span>;
        <b>internal const string</b> <a id="ec419064a02a01f3" href="../../../../R/ec419064a02a01f3.html" target="n" data-glyph="8,1" class="i field">MethodArrayLengths</a> = <span class="s">&quot;mal&quot;</span>;
        <b>internal const string</b> <a id="e2f0cad9f64af07e" href="../../../../R/e2f0cad9f64af07e.html" target="n" data-glyph="8,1" class="i field">MethodArrayElements</a> = <span class="s">&quot;mae&quot;</span>;
 
        <b>internal const string</b> <a id="861d4a33cee79bef" href="../../../../R/861d4a33cee79bef.html" target="n" data-glyph="8,1" class="i field">ObjectType</a> = <span class="s">&quot;T&quot;</span>;
        <b>internal const string</b> <a id="6fd9ede619784d4d" href="../../../../R/6fd9ede619784d4d.html" target="n" data-glyph="8,1" class="i field">ObjectValue</a> = <span class="s">&quot;V&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command discovery pipeline
 
        <b>internal const string</b> <a id="36b2f3ffac0efd11" href="../../../../R/36b2f3ffac0efd11.html" target="n" data-glyph="8,1" class="i field">DiscoveryName</a> = <span class="s">&quot;Name&quot;</span>;
        <b>internal const string</b> <a id="f6ab229ab600fda0" href="../../../../R/f6ab229ab600fda0.html" target="n" data-glyph="8,1" class="i field">DiscoveryType</a> = <span class="s">&quot;CommandType&quot;</span>;
        <b>internal const string</b> <a id="44111bad2d7454f2" href="../../../../R/44111bad2d7454f2.html" target="n" data-glyph="8,1" class="i field">DiscoveryModule</a> = <span class="s">&quot;Namespace&quot;</span>;
        <b>internal const string</b> <a id="f14acfc7c48771f8" href="../../../../R/f14acfc7c48771f8.html" target="n" data-glyph="8,1" class="i field">DiscoveryFullyQualifiedModule</a> = <span class="s">&quot;FullyQualifiedModule&quot;</span>;
        <b>internal const string</b> <a id="e08e84167c3c5e56" href="../../../../R/e08e84167c3c5e56.html" target="n" data-glyph="8,1" class="i field">DiscoveryArgumentList</a> = <span class="s">&quot;ArgumentList&quot;</span>;
        <b>internal const string</b> <a id="32ee3e4b56e09201" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">DiscoveryCount</a> = <span class="s">&quot;Count&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PowerShell
 
        <b>internal const string</b> <a id="d0a1f5d6e3418c94" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">PSInvocationSettings</a> = <span class="s">&quot;PSInvocationSettings&quot;</span>;
        <b>internal const string</b> <a id="3832dcae8100c879" href="../../../../R/3832dcae8100c879.html" target="n" data-glyph="8,1" class="i field">ApartmentState</a> = <span class="s">&quot;ApartmentState&quot;</span>;
        <b>internal const string</b> <a id="e97da4bcb97badb4" href="../../../../R/e97da4bcb97badb4.html" target="n" data-glyph="8,1" class="i field">RemoteStreamOptions</a> = <span class="s">&quot;RemoteStreamOptions&quot;</span>;
        <b>internal const string</b> <a id="7d7028055bbc2472" href="../../../../R/7d7028055bbc2472.html" target="n" data-glyph="8,1" class="i field">AddToHistory</a> = <span class="s">&quot;AddToHistory&quot;</span>;
 
        <b>internal const string</b> <a id="5a07681611f0c954" href="../../../../R/5a07681611f0c954.html" target="n" data-glyph="8,1" class="i field">PowerShell</a> = <span class="s">&quot;PowerShell&quot;</span>;
        <b>internal const string</b> <a id="7465424b6b7a2bc8" href="../../../../R/7465424b6b7a2bc8.html" target="n" data-glyph="8,1" class="i field">IsNested</a> = <span class="s">&quot;IsNested&quot;</span>;
        <b>internal const string</b> <a id="9d2b2a010a961be0" href="../../../../R/9d2b2a010a961be0.html" target="n" data-glyph="8,1" class="i field">HistoryString</a> = <span class="s">&quot;History&quot;</span>;
        <b>internal const string</b> <a id="9a65ef78f9fb246d" href="../../../../R/9a65ef78f9fb246d.html" target="n" data-glyph="8,1" class="i field">RedirectShellErrorOutputPipe</a> = <span class="s">&quot;RedirectShellErrorOutputPipe&quot;</span>;
        <b>internal const string</b> <a id="7cfc244e3694aa79" href="../../../../R/7cfc244e3694aa79.html" target="n" data-glyph="8,1" class="i field">Commands</a> = <span class="s">&quot;Cmds&quot;</span>;
        <b>internal const string</b> <a id="cff01c012c13ef7d" href="../../../../R/cff01c012c13ef7d.html" target="n" data-glyph="8,1" class="i field">ExtraCommands</a> = <span class="s">&quot;ExtraCmds&quot;</span>;
        <b>internal const string</b> <a id="2aa706c78c936e6a" href="../../../../R/2aa706c78c936e6a.html" target="n" data-glyph="8,1" class="i field">CommandText</a> = <span class="s">&quot;Cmd&quot;</span>;
        <b>internal const string</b> <a id="4b8420282e49d434" href="../../../../R/4b8420282e49d434.html" target="n" data-glyph="8,1" class="i field">IsScript</a> = <span class="s">&quot;IsScript&quot;</span>;
        <b>internal const string</b> <a id="35a31ef797f7538c" href="../../../../R/35a31ef797f7538c.html" target="n" data-glyph="8,1" class="i field">UseLocalScopeNullable</a> = <span class="s">&quot;UseLocalScope&quot;</span>;
        <b>internal const string</b> <a id="9253264d6ae4c3f1" href="../../../../R/9253264d6ae4c3f1.html" target="n" data-glyph="8,1" class="i field">MergeUnclaimedPreviousCommandResults</a> = <span class="s">&quot;MergePreviousResults&quot;</span>;
        <b>internal const string</b> <a id="2a0e3385b484c5a7" href="../../../../R/2a0e3385b484c5a7.html" target="n" data-glyph="8,1" class="i field">MergeMyResult</a> = <span class="s">&quot;MergeMyResult&quot;</span>;
        <b>internal const string</b> <a id="f187c550aefc9058" href="../../../../R/f187c550aefc9058.html" target="n" data-glyph="8,1" class="i field">MergeToResult</a> = <span class="s">&quot;MergeToResult&quot;</span>;
        <b>internal const string</b> <a id="811058afe6db1960" href="../../../../R/811058afe6db1960.html" target="n" data-glyph="8,1" class="i field">MergeError</a> = <span class="s">&quot;MergeError&quot;</span>;
        <b>internal const string</b> <a id="66c77aeb18296dde" href="../../../../R/66c77aeb18296dde.html" target="n" data-glyph="8,1" class="i field">MergeWarning</a> = <span class="s">&quot;MergeWarning&quot;</span>;
        <b>internal const string</b> <a id="3f7c8e7ee1977e7d" href="../../../../R/3f7c8e7ee1977e7d.html" target="n" data-glyph="8,1" class="i field">MergeVerbose</a> = <span class="s">&quot;MergeVerbose&quot;</span>;
        <b>internal const string</b> <a id="9b3b86a182021d86" href="../../../../R/9b3b86a182021d86.html" target="n" data-glyph="8,1" class="i field">MergeDebug</a> = <span class="s">&quot;MergeDebug&quot;</span>;
        <b>internal const string</b> <a id="d3d30fbb16602dfa" href="../../../../R/d3d30fbb16602dfa.html" target="n" data-glyph="8,1" class="i field">MergeInformation</a> = <span class="s">&quot;MergeInformation&quot;</span>;
        <b>internal const string</b> <a id="c3714fc05b2f27f5" href="../../../../R/c3714fc05b2f27f5.html" target="n" data-glyph="8,1" class="i field">Parameters</a> = <span class="s">&quot;Args&quot;</span>;
        <b>internal const string</b> <a id="c64fff9c5c902609" href="../../../../R/c64fff9c5c902609.html" target="n" data-glyph="8,1" class="i field">ParameterName</a> = <span class="s">&quot;N&quot;</span>;
        <b>internal const string</b> <a id="eb74d0035c4a941b" href="../../../../R/eb74d0035c4a941b.html" target="n" data-glyph="8,1" class="i field">ParameterValue</a> = <span class="s">&quot;V&quot;</span>;
 
        <b>internal const string</b> <a id="d78a7e4961153ea9" href="../../../../R/d78a7e4961153ea9.html" target="n" data-glyph="8,1" class="i field">NoInput</a> = <span class="s">&quot;NoInput&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PowerShell
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> StateInfo
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of property when Exception is serialized as error record.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="9fcec8691672ad13" href="../../../../R/9fcec8691672ad13.html" target="n" data-glyph="8,1" class="i field">ExceptionAsErrorRecord</a> = <span class="s">&quot;ExceptionAsErrorRecord&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property used for encoding state of pipeline when serializing PipelineStateInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="9eae22009e568676" href="../../../../R/9eae22009e568676.html" target="n" data-glyph="8,1" class="i field">PipelineState</a> = <span class="s">&quot;PipelineState&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property used for encoding state of runspace when serializing RunspaceStateInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="427500c3dc1a9805" href="../../../../R/427500c3dc1a9805.html" target="n" data-glyph="8,1" class="i field">RunspaceState</a> = <span class="s">&quot;RunspaceState&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> StateInfo
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSEventArgs
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Properties used for serialization of PSEventArgs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="c256bc3825ea2bda" href="../../../../R/c256bc3825ea2bda.html" target="n" data-glyph="8,1" class="i field">PSEventArgsComputerName</a> = <span class="s">&quot;PSEventArgs.ComputerName&quot;</span>;
        <b>internal const string</b> <a id="4b9c95e801a882c0" href="../../../../R/4b9c95e801a882c0.html" target="n" data-glyph="8,1" class="i field">PSEventArgsRunspaceId</a> = <span class="s">&quot;PSEventArgs.RunspaceId&quot;</span>;
        <b>internal const string</b> <a id="e71201769953c3d0" href="../../../../R/e71201769953c3d0.html" target="n" data-glyph="8,1" class="i field">PSEventArgsEventIdentifier</a> = <span class="s">&quot;PSEventArgs.EventIdentifier&quot;</span>;
        <b>internal const string</b> <a id="b3f2bdf090397c8c" href="../../../../R/b3f2bdf090397c8c.html" target="n" data-glyph="8,1" class="i field">PSEventArgsSourceIdentifier</a> = <span class="s">&quot;PSEventArgs.SourceIdentifier&quot;</span>;
        <b>internal const string</b> <a id="48f789d027deb5a7" href="../../../../R/48f789d027deb5a7.html" target="n" data-glyph="8,1" class="i field">PSEventArgsTimeGenerated</a> = <span class="s">&quot;PSEventArgs.TimeGenerated&quot;</span>;
        <b>internal const string</b> <a id="c0dd48862c8187e2" href="../../../../R/c0dd48862c8187e2.html" target="n" data-glyph="8,1" class="i field">PSEventArgsSender</a> = <span class="s">&quot;PSEventArgs.Sender&quot;</span>;
        <b>internal const string</b> <a id="d7f476bc17fce14d" href="../../../../R/d7f476bc17fce14d.html" target="n" data-glyph="8,1" class="i field">PSEventArgsSourceArgs</a> = <span class="s">&quot;PSEventArgs.SourceArgs&quot;</span>;
        <b>internal const string</b> <a id="457001693606af75" href="../../../../R/457001693606af75.html" target="n" data-glyph="8,1" class="i field">PSEventArgsMessageData</a> = <span class="s">&quot;PSEventArgs.MessageData&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSEventArgs
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> RunspacePool
 
        <b>internal const string</b> <a id="3a081a470ad31112" href="../../../../R/3a081a470ad31112.html" target="n" data-glyph="8,1" class="i field">MinRunspaces</a> = <span class="s">&quot;MinRunspaces&quot;</span>;
        <b>internal const string</b> <a id="07dae46e70021227" href="../../../../R/07dae46e70021227.html" target="n" data-glyph="8,1" class="i field">MaxRunspaces</a> = <span class="s">&quot;MaxRunspaces&quot;</span>;
        <b>internal const string</b> <a id="08e976e84728ae95" href="../../../../R/08e976e84728ae95.html" target="n" data-glyph="8,1" class="i field">ThreadOptions</a> = <span class="s">&quot;PSThreadOptions&quot;</span>;
        <b>internal const string</b> <a id="5d7660606cc62ee7" href="../../../../R/5d7660606cc62ee7.html" target="n" data-glyph="8,1" class="i field">HostInfo</a> = <span class="s">&quot;HostInfo&quot;</span>;
        <b>internal const string</b> <a id="1f17833c752fc385" href="../../../../R/1f17833c752fc385.html" target="n" data-glyph="8,1" class="i field">RunspacePoolOperationResponse</a> = <span class="s">&quot;SetMinMaxRunspacesResponse&quot;</span>;
        <b>internal const string</b> <a id="dccb6fcfd62bb59a" href="../../../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">AvailableRunspaces</a> = <span class="s">&quot;AvailableRunspaces&quot;</span>;
        <b>internal const string</b> <a id="74b7030f7291609b" href="../../../../R/74b7030f7291609b.html" target="n" data-glyph="8,1" class="i field">PublicKey</a> = <span class="s">&quot;PublicKey&quot;</span>;
        <b>internal const string</b> <a id="741a86f0378ef653" href="../../../../R/741a86f0378ef653.html" target="n" data-glyph="8,1" class="i field">EncryptedSessionKey</a> = <span class="s">&quot;EncryptedSessionKey&quot;</span>;
        <b>internal const string</b> <a id="a2756eaa18d38d76" href="../../../../R/a2756eaa18d38d76.html" target="n" data-glyph="8,1" class="i field">ApplicationArguments</a> = <span class="s">&quot;ApplicationArguments&quot;</span>;
        <b>internal const string</b> <a id="4a1fe4e592f526d0" href="../../../../R/4a1fe4e592f526d0.html" target="n" data-glyph="8,1" class="i field">ApplicationPrivateData</a> = <span class="s">&quot;ApplicationPrivateData&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RunspacePool
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ProgressRecord
 
        <b>internal const string</b> <a id="6e984ab018c222fd" href="../../../../R/6e984ab018c222fd.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_Activity</a> = <span class="s">&quot;Activity&quot;</span>;
        <b>internal const string</b> <a id="c383d52302afba97" href="../../../../R/c383d52302afba97.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_ActivityId</a> = <span class="s">&quot;ActivityId&quot;</span>;
        <b>internal const string</b> <a id="34497a498766de09" href="../../../../R/34497a498766de09.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_CurrentOperation</a> = <span class="s">&quot;CurrentOperation&quot;</span>;
        <b>internal const string</b> <a id="130ba7424e0fa115" href="../../../../R/130ba7424e0fa115.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_ParentActivityId</a> = <span class="s">&quot;ParentActivityId&quot;</span>;
        <b>internal const string</b> <a id="7e0cddd9bf804000" href="../../../../R/7e0cddd9bf804000.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_PercentComplete</a> = <span class="s">&quot;PercentComplete&quot;</span>;
        <b>internal const string</b> <a id="ba836e438434ac61" href="../../../../R/ba836e438434ac61.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_Type</a> = <span class="s">&quot;Type&quot;</span>;
        <b>internal const string</b> <a id="6d1706484e22479a" href="../../../../R/6d1706484e22479a.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_SecondsRemaining</a> = <span class="s">&quot;SecondsRemaining&quot;</span>;
        <b>internal const string</b> <a id="cd488263b3003d1e" href="../../../../R/cd488263b3003d1e.html" target="n" data-glyph="8,1" class="i field">ProgressRecord_StatusDescription</a> = <span class="s">&quot;StatusDescription&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The destination of the remote message.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>internal enum</b> <a id="45c72046001f69b8" href="../../../../R/45c72046001f69b8.html" target="n" data-glyph="20,0" class="t t"><span id="98705acb0d477c80">RemotingDestination</span></a> : <b>uint</b>
    {
        <a id="a5a39b4bf4f438ce" href="../../../../R/a5a39b4bf4f438ce.html" target="n" data-glyph="24,1" class="i field">InvalidDestination</a> = 0x0,
        <a id="5e2f9f14c9ab7c84" href="../../../../R/5e2f9f14c9ab7c84.html" target="n" data-glyph="24,1" class="i field">Client</a> = 0x1,
        <a id="061ac750e6d280da" href="../../../../R/061ac750e6d280da.html" target="n" data-glyph="24,1" class="i field">Server</a> = 0x2,
        <a id="ef107eb0b6dbb1d1" href="../../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Listener</a> = 0x4,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The layer the remoting message is being communicated between.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Please keep in sync with RemotingTargetInterface from</span>
    <span class="c">///</span><span class="c"> C:\e\win7_powershell\admin\monad\nttargets\assemblies\logging\ETW\Manifests\Microsoft-Windows-PowerShell-Instrumentation.man</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="1d73dff2a8d6a0bf" href="../../../../R/1d73dff2a8d6a0bf.html" target="n" data-glyph="20,0" class="t t"><span id="f4fe06f648fed453">RemotingTargetInterface</span></a> : <b>int</b>
    {
        <a id="59459e4e0f91a7b5" href="../../../../R/59459e4e0f91a7b5.html" target="n" data-glyph="24,1" class="i field">InvalidTargetInterface</a> = 0,
        <a id="8b83aadf9f585adb" href="../../../../R/8b83aadf9f585adb.html" target="n" data-glyph="24,1" class="i field">Session</a> = 1,
        <a id="405ccc8b1bd2a170" href="../../../../R/405ccc8b1bd2a170.html" target="n" data-glyph="24,1" class="i field">RunspacePool</a> = 2,
        <a id="f4078f88b2ce5495" href="../../../../R/f4078f88b2ce5495.html" target="n" data-glyph="24,1" class="i field">PowerShell</a> = 3,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The type of the remoting message.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Please keep in sync with RemotingDataType from</span>
    <span class="c">///</span><span class="c"> C:\e\win7_powershell\admin\monad\nttargets\assemblies\logging\ETW\Manifests\Microsoft-Windows-PowerShell-Instrumentation.man</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="296cbb5be87abd08" href="../../../../R/296cbb5be87abd08.html" target="n" data-glyph="20,0" class="t t"><span id="859fd7b3fd48cf4d">RemotingDataType</span></a> : <b>uint</b>
    {
        <a id="2b11ab2bb6f1d7aa" href="../../../../R/2b11ab2bb6f1d7aa.html" target="n" data-glyph="24,1" class="i field">InvalidDataType</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This data type is used when an Exception derived from IContainsErrorRecord</span>
        <span class="c">///</span><span class="c"> is caught on server and is sent to client. This exception gets</span>
        <span class="c">///</span><span class="c"> serialized as an error record. On the client this data type is deserialized in</span>
        <span class="c">///</span><span class="c"> to an ErrorRecord.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ErrorRecord on the client has an instance of RemoteException as exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d414684eb458836a" href="../../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ExceptionAsErrorRecord</a> = 1,
 
        <span class="c">// Session messages</span>
        <a id="6b685d32d77b181a" href="../../../../R/6b685d32d77b181a.html" target="n" data-glyph="24,1" class="i field">SessionCapability</a> = 0x00010002,
        <a id="cba3be6717291b3e" href="../../../../R/cba3be6717291b3e.html" target="n" data-glyph="24,1" class="i field">CloseSession</a> = 0x00010003,
        <a id="1c4da1106c7e03cd" href="../../../../R/1c4da1106c7e03cd.html" target="n" data-glyph="24,1" class="i field">CreateRunspacePool</a> = 0x00010004,
        <a id="44a91e5fd10c9b8c" href="../../../../R/44a91e5fd10c9b8c.html" target="n" data-glyph="24,1" class="i field">PublicKey</a> = 0x00010005,
        <a id="c0cf64f5fbe0969f" href="../../../../R/c0cf64f5fbe0969f.html" target="n" data-glyph="24,1" class="i field">EncryptedSessionKey</a> = 0x00010006,
        <a id="b069e4b681ec21a5" href="../../../../R/b069e4b681ec21a5.html" target="n" data-glyph="24,1" class="i field">PublicKeyRequest</a> = 0x00010007,
        <a id="1ed595ddb5cd0a96" href="../../../../R/1ed595ddb5cd0a96.html" target="n" data-glyph="24,1" class="i field">ConnectRunspacePool</a> = 0x00010008,
 
        <span class="c">// Runspace Pool messages</span>
        <a id="106fd8fc888670f5" href="../../../../R/106fd8fc888670f5.html" target="n" data-glyph="24,1" class="i field">SetMaxRunspaces</a> = 0x00021002,
        <a id="d9fbe248918ae2c4" href="../../../../R/d9fbe248918ae2c4.html" target="n" data-glyph="24,1" class="i field">SetMinRunspaces</a> = 0x00021003,
        <a id="3b51a682ea77ca94" href="../../../../R/3b51a682ea77ca94.html" target="n" data-glyph="24,1" class="i field">RunspacePoolOperationResponse</a> = 0x00021004,
        <a id="0aee2d3c8d9b0076" href="../../../../R/0aee2d3c8d9b0076.html" target="n" data-glyph="24,1" class="i field">RunspacePoolStateInfo</a> = 0x00021005,
        <a id="8941649eed4c5b4c" href="../../../../R/8941649eed4c5b4c.html" target="n" data-glyph="24,1" class="i field">CreatePowerShell</a> = 0x00021006,
        <a id="5457c2b97b9a6efb" href="../../../../R/5457c2b97b9a6efb.html" target="n" data-glyph="24,1" class="i field">AvailableRunspaces</a> = 0x00021007,
        <a id="0922a637409a0869" href="../../../../R/0922a637409a0869.html" target="n" data-glyph="24,1" class="i field">PSEventArgs</a> = 0x00021008,
        <a id="2d2c451c38d5530c" href="../../../../R/2d2c451c38d5530c.html" target="n" data-glyph="24,1" class="i field">ApplicationPrivateData</a> = 0x00021009,
        <a id="6b9c2480be4dabfb" href="../../../../R/6b9c2480be4dabfb.html" target="n" data-glyph="24,1" class="i field">GetCommandMetadata</a> = 0x0002100A,
        <a id="e41c5058f62206db" href="../../../../R/e41c5058f62206db.html" target="n" data-glyph="24,1" class="i field">RunspacePoolInitData</a> = 0x0002100B,
        <a id="395e49a743d4abcc" href="../../../../R/395e49a743d4abcc.html" target="n" data-glyph="24,1" class="i field">ResetRunspaceState</a> = 0x0002100C,
 
        <span class="c">// Runspace host messages</span>
        <a id="039fa54a21ae924c" href="../../../../R/039fa54a21ae924c.html" target="n" data-glyph="24,1" class="i field">RemoteHostCallUsingRunspaceHost</a> = 0x00021100,
        <a id="9796e4c77fc83e5c" href="../../../../R/9796e4c77fc83e5c.html" target="n" data-glyph="24,1" class="i field">RemoteRunspaceHostResponseData</a> = 0x00021101,
 
        <span class="c">// PowerShell messages</span>
        <a id="1c6bd042904ee46b" href="../../../../R/1c6bd042904ee46b.html" target="n" data-glyph="24,1" class="i field">PowerShellInput</a> = 0x00041002,
        <a id="313b6d1d71e0521b" href="../../../../R/313b6d1d71e0521b.html" target="n" data-glyph="24,1" class="i field">PowerShellInputEnd</a> = 0x00041003,
        <a id="f6941c9a7d9e0a2f" href="../../../../R/f6941c9a7d9e0a2f.html" target="n" data-glyph="24,1" class="i field">PowerShellOutput</a> = 0x00041004,
        <a id="2bfdbd03af00a40c" href="../../../../R/2bfdbd03af00a40c.html" target="n" data-glyph="24,1" class="i field">PowerShellErrorRecord</a> = 0x00041005,
        <a id="dfd57951d114980b" href="../../../../R/dfd57951d114980b.html" target="n" data-glyph="24,1" class="i field">PowerShellStateInfo</a> = 0x00041006,
        <a id="9305a742d83a6da8" href="../../../../R/9305a742d83a6da8.html" target="n" data-glyph="24,1" class="i field">PowerShellDebug</a> = 0x00041007,
        <a id="1036eaaa6058e728" href="../../../../R/1036eaaa6058e728.html" target="n" data-glyph="24,1" class="i field">PowerShellVerbose</a> = 0x00041008,
        <a id="df7036213bef9576" href="../../../../R/df7036213bef9576.html" target="n" data-glyph="24,1" class="i field">PowerShellWarning</a> = 0x00041009,
        <a id="b701f1d4d5503ca9" href="../../../../R/b701f1d4d5503ca9.html" target="n" data-glyph="24,1" class="i field">PowerShellProgress</a> = 0x00041010,
        <a id="752bf1e010416aa1" href="../../../../R/752bf1e010416aa1.html" target="n" data-glyph="24,1" class="i field">PowerShellInformationStream</a> = 0x00041011,
        <a id="0ad4d2a13292e39f" href="../../../../R/0ad4d2a13292e39f.html" target="n" data-glyph="24,1" class="i field">StopPowerShell</a> = 0x00041012,
 
        <span class="c">// PowerShell host messages</span>
        <a id="055d2ba11ad1263c" href="../../../../R/055d2ba11ad1263c.html" target="n" data-glyph="24,1" class="i field">RemoteHostCallUsingPowerShellHost</a> = 0x00041100,
        <a id="54fb34cf1704608e" href="../../../../R/54fb34cf1704608e.html" target="n" data-glyph="24,1" class="i field">RemotePowerShellHostResponseData</a> = 0x00041101,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Converts C# types to PSObject properties for embedding in PSObjects transported across the wire.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="88b19073d823ce05" href="../../../../R/88b19073d823ce05.html" target="n" data-glyph="2,0" class="t t">RemotingEncoder</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> NotePropertyHelpers
 
        <b>internal delegate</b> <span class="r0 r t">T</span> <a id="a6fce12882ad051a" href="../../../../R/a6fce12882ad051a.html" target="n" data-glyph="14,1" class="t t"><span id="20a58388fdf64acb">ValueGetterDelegate</span></a>&lt;<span id="r0 rd t" class="r0 r t">T</span>&gt;();
 
        <b>internal static void</b> <a id="751212fa1b208b35" href="../../../../R/751212fa1b208b35.html" target="n" data-glyph="74,1" class="i method">AddNoteProperty</a>&lt;<span id="r1 rd t" class="r1 r t">T</span>&gt;(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r2 rd" class="r2 r">pso</span>, <b>string</b> <span id="r3 rd" class="r3 r">propertyName</span>, <a href="#a6fce12882ad051a" class="t t">ValueGetterDelegate</a>&lt;<span class="r1 r t">T</span>&gt; <span id="r4 rd" class="r4 r">valueGetter</span>)
        {
            <span class="r1 r t">T</span> <span id="r5 rd" class="r5 r">value</span> = <b>default</b>(<span class="r1 r t">T</span>);
            <b>try</b>
            {
                <span class="r5 r">value</span> = <span class="r4 r">valueGetter</span>();
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r6 rd" class="r6 r">e</span>)
            {
                <a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Internal code shouldn&#39;t throw exceptions during serialization&quot;</span>);
 
                <a href="../../../../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<span class="i">LogAnalyticWarning</span>(
                    <a href="../PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="../PSETWTracer.cs.html#798159ef1722cae3" class="i field">Serializer_PropertyGetterFailed</a>, <a href="../PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="../PSETWTracer.cs.html#faf4fe68c87fb192" class="i field">Exception</a>, <a href="../PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="../PSETWTracer.cs.html#83ee257ff51390a9" class="i field">Serialization</a>,
                    <a href="../PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="../PSETWTracer.cs.html#3d40cf505df45536" class="i field">Serializer</a> | <a href="../PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="../PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                    <span class="r3 r">propertyName</span>,
                    <span class="r4 r">valueGetter</span>.<span class="i">Target</span> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <span class="r4 r">valueGetter</span>.<span class="i">Target</span>.<span class="i">GetType</span>().<span class="i">FullName</span>,
                    <span class="r6 r">e</span>.<span class="i">ToString</span>(),
                    <span class="r6 r">e</span>.<span class="i">InnerException</span> == <b>null</b> ? <b>string</b>.<span class="i">Empty</span> : <span class="r6 r">e</span>.<span class="i">InnerException</span>.<span class="i">ToString</span>());
            }
 
            <b>try</b>
            {
                <span class="r2 r">pso</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="r3 r">propertyName</span>, <span class="r5 r">value</span>));
            }
            <b>catch</b> (<a href="../../../ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>)
            {
                <span class="c">// Member already exists, just make sure the value is the same.</span>
                <b>var</b> <span id="r7 rd" class="r7 r">existingValue</span> = <span class="r2 r">pso</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r3 r">propertyName</span>].<a href="../../../MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
                <a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<b>object</b>.<span class="i">Equals</span>(<span class="r7 r">existingValue</span>, <span class="r5 r">value</span>),
                                    <span class="s">&quot;Property already exists but new value differs.&quot;</span>);
            }
        }
 
        <b>internal static</b> <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="22d9fb1506026254" href="../../../../R/22d9fb1506026254.html" target="n" data-glyph="74,1" class="i method">CreateEmptyPSObject</a>()
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r8 rd" class="r8 r">pso</span> = <b>new</b> <a href="../../../MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
            <span class="c">// we don&#39;t care about serializing/deserializing TypeNames in remoting objects/messages</span>
            <span class="c">// so we just omit TypeNames info to lower packet size and improve performance</span>
            <span class="r8 r">pso</span>.<a href="../../../MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a> = <a href="../../../TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>.<a href="../../../TypeTable.cs.html#a6ad0f52740814ac" class="i field">Empty</a>;
 
            <b>return</b> <span class="r8 r">pso</span>;
        }
 
        <b>private static</b> <a href="../../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <a id="7cd42e541f350042" href="../../../../R/7cd42e541f350042.html" target="n" data-glyph="76,1" class="i method">CreateHostInfoProperty</a>(<a href="RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a> <span id="r9 rd" class="r9 r">hostInfo</span>)
        {
            <b>return</b> <b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(
                <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#5d7660606cc62ee7" class="i field">HostInfo</a>,
                <a href="RemoteHostEncoder.cs.html#f99e89fafaac33f0" class="t t">RemoteHostEncoder</a>.<a href="RemoteHostEncoder.cs.html#7c8e1a4e8e4ec484" class="i method">EncodeObject</a>(<span class="r9 r">hostInfo</span>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> NotePropertyHelpers
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> RunspacePool related
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> creating a RunspacePool on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the clientRunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">minRunspaces for the RunspacePool</span>
        <span class="c">///</span><span class="c"> to be created at the server</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">maxRunspaces for the RunspacePool</span>
        <span class="c">///</span><span class="c"> to be created at the server</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">runspacePool</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Local runspace pool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">host for the runspacepool at the client end</span>
        <span class="c">///</span><span class="c"> from this host, information will be extracted and sent to</span>
        <span class="c">///</span><span class="c"> server</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">applicationArguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Application arguments the server can see in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../../fanin/PSPrincipal.cs.html#eeedcf9113508cb9" class="t t">PSSenderInfo</a>.<a href="../../fanin/PSPrincipal.cs.html#fbb9c1201251c818" class="i property">ApplicationArguments</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data      |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S |  Session  | CRPID  |    0    | CreateRuns | minRunspaces,  |   InvalidDataType   |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | pacePool   | maxRunspaces,  |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            | threadOptions, |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            | apartmentState,|                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            | hostInfo       |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            | appParameters  |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span>
        <span class="c">///</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="d8e79bbd9fb4f335" href="../../../../R/d8e79bbd9fb4f335.html" target="n" data-glyph="74,1" class="i method">GenerateCreateRunspacePool</a>(
            <span class="i">Guid</span> <span id="r10 rd" class="r10 r">clientRunspacePoolId</span>,
            <b>int</b> <span id="r11 rd" class="r11 r">minRunspaces</span>,
            <b>int</b> <span id="r12 rd" class="r12 r">maxRunspaces</span>,
            <a href="../../client/RemoteRunspacePoolInternal.cs.html#1aba79be5da56f57" class="t t">RemoteRunspacePoolInternal</a> <span id="r13 rd" class="r13 r">runspacePool</span>,
            <a href="../../../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r14 rd" class="r14 r">host</span>,
            <a href="../../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r15 rd" class="r15 r">applicationArguments</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r16 rd" class="r16 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r16 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3a081a470ad31112" class="i field">MinRunspaces</a>, <span class="r11 r">minRunspaces</span>));
            <span class="r16 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#07dae46e70021227" class="i field">MaxRunspaces</a>, <span class="r12 r">maxRunspaces</span>));
            <span class="r16 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#08e976e84728ae95" class="i field">ThreadOptions</a>, <span class="r13 r">runspacePool</span>.<a href="../../../hostifaces/RunspacePoolInternal.cs.html#3617244356b991d3" class="i property">ThreadOptions</a>));
            <span class="i">ApartmentState</span> <span id="r17 rd" class="r17 r">poolState</span> = <span class="r13 r">runspacePool</span>.<a href="../../../hostifaces/RunspacePoolInternal.cs.html#3f9f0d0f8dd1c807" class="i property">ApartmentState</a>;
            <span class="r16 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3832dcae8100c879" class="i field">ApartmentState</a>, <span class="r17 r">poolState</span>));
            <span class="r16 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#a2756eaa18d38d76" class="i field">ApplicationArguments</a>, <span class="r15 r">applicationArguments</span>));
 
            <span class="c">// a runspace&#39;s host info always needs to be cached. This is because</span>
            <span class="c">// at a later point in time, a powershell may choose to use the</span>
            <span class="c">// runspace&#39;s host and may require that it uses cached Raw UI properties</span>
            <span class="r16 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<a href="#7cd42e541f350042" class="i method">CreateHostInfoProperty</a>(<b>new</b> <a href="RemoteSessionCapability.cs.html#460b658813cb9516" class="t constructor">HostInfo</a>(<span class="r14 r">host</span>)));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                            <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#1c4da1106c7e03cd" class="i field">CreateRunspacePool</a>,
                                            <span class="r10 r">clientRunspacePoolId</span>,
                                            <span class="i">Guid</span>.<span class="i">Empty</span>,
                                            <span class="r16 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> creating a RunspacePool on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the clientRunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">minRunspaces for the RunspacePool</span>
        <span class="c">///</span><span class="c"> to be created at the server</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">maxRunspaces for the RunspacePool</span>
        <span class="c">///</span><span class="c"> to be created at the server</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data      |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S |  Runspace | CRPID  |    0    | ConnectRun | minRunspaces,  |   InvalidDataType   |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | spacePool  | maxRunspaces,  |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |                |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span>
        <span class="c">///</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="bc137df3af0e9851" href="../../../../R/bc137df3af0e9851.html" target="n" data-glyph="74,1" class="i method">GenerateConnectRunspacePool</a>(
            <span class="i">Guid</span> <span id="r18 rd" class="r18 r">clientRunspacePoolId</span>,
            <b>int</b> <span id="r19 rd" class="r19 r">minRunspaces</span>,
            <b>int</b> <span id="r20 rd" class="r20 r">maxRunspaces</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r21 rd" class="r21 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <b>int</b> <span id="r22 rd" class="r22 r">propertyCount</span> = 0;
            <b>if</b> (<span class="r19 r">minRunspaces</span> != -1)
            {
                <span class="r21 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3a081a470ad31112" class="i field">MinRunspaces</a>, <span class="r19 r">minRunspaces</span>));
                <span class="r22 r">propertyCount</span>++;
            }
 
            <b>if</b> (<span class="r20 r">maxRunspaces</span> != -1)
            {
                <span class="r21 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#07dae46e70021227" class="i field">MaxRunspaces</a>, <span class="r20 r">maxRunspaces</span>));
                <span class="r22 r">propertyCount</span>++;
            }
 
            <b>if</b> (<span class="r22 r">propertyCount</span> &gt; 0)
            {
                <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                            <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#1ed595ddb5cd0a96" class="i field">ConnectRunspacePool</a>,
                                            <span class="r18 r">clientRunspacePoolId</span>,
                                            <span class="i">Guid</span>.<span class="i">Empty</span>,
                                            <span class="r21 r">dataAsPSObject</span>);
            }
            <b>else</b>
            {
                <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                            <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#1ed595ddb5cd0a96" class="i field">ConnectRunspacePool</a>,
                                            <span class="r18 r">clientRunspacePoolId</span>,
                                            <span class="i">Guid</span>.<span class="i">Empty</span>,
                                            <b>string</b>.<span class="i">Empty</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates a response message to ConnectRunspace that includes</span>
        <span class="c">///</span><span class="c"> sufficient information to construction client RunspacePool state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">runspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the clientRunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">minRunspaces for the RunspacePool</span>
        <span class="c">///</span><span class="c"> to be created at the server</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">maxRunspaces for the RunspacePool</span>
        <span class="c">///</span><span class="c"> to be created at the server</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data      |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |  Runspace | CRPID  |    0    | RunspacePo | minRunspaces,  |   InvalidDataType   |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | olInitData | maxRunspaces,  |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |                |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span>
        <span class="c">///</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="23653f121b65e173" href="../../../../R/23653f121b65e173.html" target="n" data-glyph="74,1" class="i method">GenerateRunspacePoolInitData</a>(
            <span class="i">Guid</span> <span id="r23 rd" class="r23 r">runspacePoolId</span>,
            <b>int</b> <span id="r24 rd" class="r24 r">minRunspaces</span>,
            <b>int</b> <span id="r25 rd" class="r25 r">maxRunspaces</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r26 rd" class="r26 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r26 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3a081a470ad31112" class="i field">MinRunspaces</a>, <span class="r24 r">minRunspaces</span>));
            <span class="r26 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#07dae46e70021227" class="i field">MaxRunspaces</a>, <span class="r25 r">maxRunspaces</span>));
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                            <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#e41c5058f62206db" class="i field">RunspacePoolInitData</a>,
                                            <span class="r23 r">runspacePoolId</span>,
                                            <span class="i">Guid</span>.<span class="i">Empty</span>,
                                            <span class="r26 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> modifying the maxrunspaces of the specified runspace pool on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the clientRunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">maxRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">new value of maxRunspaces for the</span>
        <span class="c">///</span><span class="c"> specified RunspacePool  </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">callId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Call id of the call at client.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S | Runspace  | CRPID  |    0    |   SetMax   | maxRunspaces  |   InvalidDataType   |</span>
        <span class="c">///</span><span class="c"> |   |   Pool    |        |         |  Runspaces |               |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |               |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="1e0efb543e1c620b" href="../../../../R/1e0efb543e1c620b.html" target="n" data-glyph="74,1" class="i method">GenerateSetMaxRunspaces</a>(<span class="i">Guid</span> <span id="r27 rd" class="r27 r">clientRunspacePoolId</span>,
                                    <b>int</b> <span id="r28 rd" class="r28 r">maxRunspaces</span>, <b>long</b> <span id="r29 rd" class="r29 r">callId</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r30 rd" class="r30 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r30 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#07dae46e70021227" class="i field">MaxRunspaces</a>, <span class="r28 r">maxRunspaces</span>));
            <span class="r30 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9b48d21fcadf90c0" class="i field">CallId</a>, <span class="r29 r">callId</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#106fd8fc888670f5" class="i field">SetMaxRunspaces</a>,
                                               <span class="r27 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r30 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> modifying the maxrunspaces of the specified runspace pool on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the clientRunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">minRunspaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">new value of minRunspaces for the</span>
        <span class="c">///</span><span class="c"> specified RunspacePool  </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">callId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Call id of the call at client.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S | Runspace  | CRPID  |    0    |   SetMin   | minRunspaces  |   InvalidDataType   |</span>
        <span class="c">///</span><span class="c"> |   |   Pool    |        |         |  Runspaces |               |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |               |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="204bc8dc1d0b50d2" href="../../../../R/204bc8dc1d0b50d2.html" target="n" data-glyph="74,1" class="i method">GenerateSetMinRunspaces</a>(<span class="i">Guid</span> <span id="r31 rd" class="r31 r">clientRunspacePoolId</span>,
                                    <b>int</b> <span id="r32 rd" class="r32 r">minRunspaces</span>, <b>long</b> <span id="r33 rd" class="r33 r">callId</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r34 rd" class="r34 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r34 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3a081a470ad31112" class="i field">MinRunspaces</a>, <span class="r32 r">minRunspaces</span>));
            <span class="r34 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9b48d21fcadf90c0" class="i field">CallId</a>, <span class="r33 r">callId</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#d9fbe248918ae2c4" class="i field">SetMinRunspaces</a>,
                                               <span class="r31 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r34 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> that contains a response to SetMaxRunspaces or SetMinRunspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the clientRunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">callId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Call id of the call at client.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">response</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Response to the call.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S | Runspace  | CRPID  |    0    |   SetMax   | maxRunspaces  |   InvalidDataType   |</span>
        <span class="c">///</span><span class="c"> |   |   Pool    |        |         |  Runspaces |               |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |               |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="8a849da6d49471b1" href="../../../../R/8a849da6d49471b1.html" target="n" data-glyph="74,1" class="i method">GenerateRunspacePoolOperationResponse</a>(<span class="i">Guid</span> <span id="r35 rd" class="r35 r">clientRunspacePoolId</span>,
                                    <b>object</b> <span id="r37 rd" class="r37 r">response</span>, <b>long</b> <span id="r36 rd" class="r36 r">callId</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r38 rd" class="r38 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r38 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#1f17833c752fc385" class="i field">RunspacePoolOperationResponse</a>, <span class="r37 r">response</span>));
            <span class="r38 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9b48d21fcadf90c0" class="i field">CallId</a>, <span class="r36 r">callId</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#3b51a682ea77ca94" class="i field">RunspacePoolOperationResponse</a>,
                                               <span class="r35 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r38 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> getting the available runspaces on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">guid of the runspace pool on which</span>
        <span class="c">///</span><span class="c"> this needs to be queried</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">callId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Call id of the call at the client.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |      Data     |        Type          |</span>
        <span class="c">///</span><span class="c"> ---------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S | Runspace  | CRPID  |    0    |     null      |GetAvailableRunspaces |</span>
        <span class="c">///</span><span class="c"> |   |   Pool    |        |         |               |                      |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="5d247ae1ffab9a07" href="../../../../R/5d247ae1ffab9a07.html" target="n" data-glyph="74,1" class="i method">GenerateGetAvailableRunspaces</a>(<span class="i">Guid</span> <span id="r39 rd" class="r39 r">clientRunspacePoolId</span>,
                                    <b>long</b> <span id="r40 rd" class="r40 r">callId</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r41 rd" class="r41 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r41 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9b48d21fcadf90c0" class="i field">CallId</a>, <span class="r40 r">callId</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#5457c2b97b9a6efb" class="i field">AvailableRunspaces</a>,
                                               <span class="r39 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r41 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> transferring a roles public key to the other side.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">runspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace pool id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">publicKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Public key to send across.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">destination</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">destination that this message is</span>
        <span class="c">///</span><span class="c"> targeted to</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure message.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |      Data     |        Type          |</span>
        <span class="c">///</span><span class="c"> ---------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S | Runspace  | CRPID  |    0    |    public     |      PublicKey       |</span>
        <span class="c">///</span><span class="c"> |   |   Pool    |        |         |     key       |                      |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="049cdc8d34ce0666" href="../../../../R/049cdc8d34ce0666.html" target="n" data-glyph="74,1" class="i method">GenerateMyPublicKey</a>(<span class="i">Guid</span> <span id="r42 rd" class="r42 r">runspacePoolId</span>,
                                    <b>string</b> <span id="r43 rd" class="r43 r">publicKey</span>, <a href="#45c72046001f69b8" class="t t">RemotingDestination</a> <span id="r44 rd" class="r44 r">destination</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r45 rd" class="r45 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r45 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#74b7030f7291609b" class="i field">PublicKey</a>, <span class="r43 r">publicKey</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<span class="r44 r">destination</span>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#44a91e5fd10c9b8c" class="i field">PublicKey</a>,
                                               <span class="r42 r">runspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r45 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> requesting a public key from the client to the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">runspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace pool id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure message.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |      Data     |        Type          |</span>
        <span class="c">///</span><span class="c"> ---------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S | Runspace  | CRPID  |    0    |               |   PublicKeyRequest   |</span>
        <span class="c">///</span><span class="c"> |   |   Pool    |        |         |               |                      |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="2c20bac6b13ca4ae" href="../../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GeneratePublicKeyRequest</a>(<span class="i">Guid</span> <span id="r46 rd" class="r46 r">runspacePoolId</span>)
        {
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#b069e4b681ec21a5" class="i field">PublicKeyRequest</a>,
                                               <span class="r46 r">runspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <b>string</b>.<span class="i">Empty</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method generates a remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> sending an encrypted session key to the client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">runspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace pool id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">encryptedSessionKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Encrypted session key.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure message.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |      Data     |        Type          |</span>
        <span class="c">///</span><span class="c"> ---------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S | Runspace  | CRPID  |    0    |  encrypted    | EncryptedSessionKey  |</span>
        <span class="c">///</span><span class="c"> |   |   Pool    |        |         | session key   |                      |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="d8d62fb605ee13f4" href="../../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GenerateEncryptedSessionKeyResponse</a>(<span class="i">Guid</span> <span id="r47 rd" class="r47 r">runspacePoolId</span>,
            <b>string</b> <span id="r48 rd" class="r48 r">encryptedSessionKey</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r49 rd" class="r49 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r49 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#741a86f0378ef653" class="i field">EncryptedSessionKey</a>,
                                            <span class="r48 r">encryptedSessionKey</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#c0cf64f5fbe0969f" class="i field">EncryptedSessionKey</a>,
                                               <span class="r47 r">runspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r49 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This methods generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> creating a command discovery pipeline on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">shell</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The client remote powershell from which the</span>
        <span class="c">///</span><span class="c"> message needs to be generated.</span>
        <span class="c">///</span><span class="c"> The data is extracted from parameters of the first command named &quot;Get-Command&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> -------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |     Data      |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S |  Runspace | CRPID  |  CPID   | name,         | GetCommandMetadata  |</span>
        <span class="c">///</span><span class="c"> |   |  Pool     |        |         | commandType,  |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | module,FQM,   |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | argumentList  |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="a4b8c2db2a6b1ee3" href="../../../../R/a4b8c2db2a6b1ee3.html" target="n" data-glyph="74,1" class="i method">GenerateGetCommandMetadata</a>(<a href="../../client/ClientRemotePowerShell.cs.html#b4d2ac017883b31c" class="t t">ClientRemotePowerShell</a> <span id="r50 rd" class="r50 r">shell</span>)
        {
            <a href="../../../hostifaces/Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r51 rd" class="r51 r">getCommand</span> = <b>null</b>;
            <b>foreach</b> (<a href="../../../hostifaces/Command.cs.html#b55b68a3bf75e612" class="t t">Command</a> <span id="r52 rd" class="r52 r">c</span> <b>in</b> <span class="r50 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#c30957a9d4580098" class="i property">PowerShell</a>.<a href="../../../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../../../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>)
            {
                <b>if</b> (<span class="r52 r">c</span>.<a href="../../../hostifaces/Command.cs.html#e67df99c50711b7c" class="i property">CommandText</a>.<span class="i">Equals</span>(<span class="s">&quot;Get-Command&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r51 r">getCommand</span> = <span class="r52 r">c</span>;
                    <b>break</b>;
                }
            }
 
            <a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r51 r">getCommand</span> != <b>null</b>, <span class="s">&quot;Whoever sets PowerShell.IsGetCommandMetadataSpecialPipeline needs to make sure Get-Command is present&quot;</span>);
 
            <b>string</b>[] <span id="r53 rd" class="r53 r">name</span> = <b>null</b>;
            <a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r54 rd" class="r54 r">commandTypes</span> = <a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../../../CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a> | <a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../../../CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a> | <a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../../../CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a> | <a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../../../CommandInfo.cs.html#7837d2f5f0343c5e" class="i field">Filter</a> | <a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../../../CommandInfo.cs.html#2a673544a3a7e93f" class="i field">Configuration</a>;
            <b>string</b>[] <span id="r55 rd" class="r55 r">module</span> = <b>null</b>;
            <a href="../../../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[] <span id="r56 rd" class="r56 r">fullyQualifiedModule</span> = <b>null</b>;
 
            <b>object</b>[] <span id="r57 rd" class="r57 r">argumentList</span> = <b>null</b>;
            <b>foreach</b> (<a href="../../../hostifaces/Parameter.cs.html#4ce3ff8da8a0f8d9" class="t t">CommandParameter</a> <span id="r58 rd" class="r58 r">p</span> <b>in</b> <span class="r51 r">getCommand</span>.<a href="../../../hostifaces/Command.cs.html#ba1074ca05aadff5" class="i property">Parameters</a>)
            {
                <b>if</b> (<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#6ea3f296defa8bc7" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r53 r">name</span> = (<b>string</b>[])<a href="../../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#fcbaca5cbcc738ea" class="i property">Value</a>, <b>typeof</b>(<b>string</b>[]), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>else</b> <b>if</b> (<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#6ea3f296defa8bc7" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;CommandType&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r54 r">commandTypes</span> = (<a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>)<a href="../../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#fcbaca5cbcc738ea" class="i property">Value</a>, <b>typeof</b>(<a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>else</b> <b>if</b> (<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#6ea3f296defa8bc7" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r55 r">module</span> = (<b>string</b>[])<a href="../../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#fcbaca5cbcc738ea" class="i property">Value</a>, <b>typeof</b>(<b>string</b>[]), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>else</b> <b>if</b> (<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#6ea3f296defa8bc7" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;FullyQualifiedModule&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r56 r">fullyQualifiedModule</span> = (<a href="../../../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[])<a href="../../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#fcbaca5cbcc738ea" class="i property">Value</a>, <b>typeof</b>(<a href="../../../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[]), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>else</b> <b>if</b> (<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#6ea3f296defa8bc7" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;ArgumentList&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r57 r">argumentList</span> = (<b>object</b>[])<a href="../../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r58 r">p</span>.<a href="../../../hostifaces/Parameter.cs.html#fcbaca5cbcc738ea" class="i property">Value</a>, <b>typeof</b>(<b>object</b>[]), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
            }
 
            <a href="../../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r59 rd" class="r59 r">rsPool</span> = <span class="r50 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#c30957a9d4580098" class="i property">PowerShell</a>.<a href="../../../hostifaces/PowerShell.cs.html#503345e404ed0ddb" class="i method">GetRunspaceConnection</a>() <b>as</b> <a href="../../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a>;
            <a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r59 r">rsPool</span> != <b>null</b>, <span class="s">&quot;Runspacepool cannot be null for a CreatePowerShell request&quot;</span>);
            <span class="i">Guid</span> <span id="r60 rd" class="r60 r">clientRunspacePoolId</span> = <span class="r59 r">rsPool</span>.<a href="../../../hostifaces/RunspacePool.cs.html#d23018748ccb0099" class="i property">InstanceId</a>;
 
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r61 rd" class="r61 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r61 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#36b2f3ffac0efd11" class="i field">DiscoveryName</a>, <span class="r53 r">name</span>));
            <span class="r61 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#f6ab229ab600fda0" class="i field">DiscoveryType</a>, <span class="r54 r">commandTypes</span>));
            <span class="r61 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#44111bad2d7454f2" class="i field">DiscoveryModule</a>, <span class="r55 r">module</span>));
            <span class="r61 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#f14acfc7c48771f8" class="i field">DiscoveryFullyQualifiedModule</a>, <span class="r56 r">fullyQualifiedModule</span>));
            <span class="r61 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e08e84167c3c5e56" class="i field">DiscoveryArgumentList</a>, <span class="r57 r">argumentList</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#6b9c2480be4dabfb" class="i field">GetCommandMetadata</a>,
                                               <span class="r60 r">clientRunspacePoolId</span>,
                                               <span class="r50 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#71022daeee1769bc" class="i property">InstanceId</a>,
                                               <span class="r61 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This methods generates a Remoting data structure handler message for</span>
        <span class="c">///</span><span class="c"> creating a PowerShell on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">shell</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The client remote powershell from which the</span>
        <span class="c">///</span><span class="c"> create powershell message needs to be generated</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> -------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |     Data      |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S |  Runspace | CRPID  |  CPID   | serialized    | CreatePowerShell    |</span>
        <span class="c">///</span><span class="c"> |   |  Pool     |        |         | powershell,   |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | noInput,      |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | hostInfo,     |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | invocationset |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | tings, stream |                     |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         | options       |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------</span>
        <span class="c">///</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="4eb5eb99c2613315" href="../../../../R/4eb5eb99c2613315.html" target="n" data-glyph="74,1" class="i method">GenerateCreatePowerShell</a>(<a href="../../client/ClientRemotePowerShell.cs.html#b4d2ac017883b31c" class="t t">ClientRemotePowerShell</a> <span id="r62 rd" class="r62 r">shell</span>)
        {
            <a href="../../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r63 rd" class="r63 r">powerShell</span> = <span class="r62 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#c30957a9d4580098" class="i property">PowerShell</a>;
            <a href="../../../hostifaces/PowerShell.cs.html#ce65c0834aa6f0ea" class="t t">PSInvocationSettings</a> <span id="r64 rd" class="r64 r">settings</span> = <span class="r62 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#0a76510a18071d39" class="i property">Settings</a>;
 
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r65 rd" class="r65 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="i">Guid</span> <span id="r66 rd" class="r66 r">clientRunspacePoolId</span> = <span class="i">Guid</span>.<span class="i">Empty</span>;
            <a href="RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a> <span id="r67 rd" class="r67 r">hostInfo</span>;
            <a href="../../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r68 rd" class="r68 r">hostInfoProperty</span>;
 
            <a href="../../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r69 rd" class="r69 r">rsPool</span> = <span class="r63 r">powerShell</span>.<a href="../../../hostifaces/PowerShell.cs.html#503345e404ed0ddb" class="i method">GetRunspaceConnection</a>() <b>as</b> <a href="../../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a>;
 
            <a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r69 r">rsPool</span> != <b>null</b>, <span class="s">&quot;Runspacepool cannot be null for a CreatePowerShell request&quot;</span>);
 
            <span class="r66 r">clientRunspacePoolId</span> = <span class="r69 r">rsPool</span>.<a href="../../../hostifaces/RunspacePool.cs.html#d23018748ccb0099" class="i property">InstanceId</a>;
 
            <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#5a07681611f0c954" class="i field">PowerShell</a>, <span class="r63 r">powerShell</span>.<a href="../../../hostifaces/PowerShell.cs.html#6749aa2a4e365240" class="i method">ToPSObjectForRemoting</a>()));
            <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#d78a7e4961153ea9" class="i field">NoInput</a>, <span class="r62 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#c3bd35b8d6fe0404" class="i property">NoInput</a>));
 
            <b>if</b> (<span class="r64 r">settings</span> == <b>null</b>)
            {
                <span class="r67 r">hostInfo</span> = <b>new</b> <a href="RemoteSessionCapability.cs.html#460b658813cb9516" class="t constructor">HostInfo</a>(<b>null</b>);
                <span class="r67 r">hostInfo</span>.<a href="RemoteSessionCapability.cs.html#ccba904c55d54568" class="i property">UseRunspaceHost</a> = <b>true</b>;
 
                <span class="i">ApartmentState</span> <span id="r70 rd" class="r70 r">passedApartmentState</span> = <span class="r69 r">rsPool</span>.<a href="../../../hostifaces/RunspacePool.cs.html#e96b2efb9719a701" class="i property">ApartmentState</a>;
                <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3832dcae8100c879" class="i field">ApartmentState</a>, <span class="r70 r">passedApartmentState</span>));
                <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e97da4bcb97badb4" class="i field">RemoteStreamOptions</a>, <a href="../../../hostifaces/PowerShell.cs.html#3a466dc47c692c8e" class="t t">RemoteStreamOptions</a>.<a href="../../../hostifaces/PowerShell.cs.html#4d6d0ddb7d2d677d" class="i field">AddInvocationInfo</a>));
                <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#7d7028055bbc2472" class="i field">AddToHistory</a>, <b>false</b>));
            }
            <b>else</b>
            {
                <span class="r67 r">hostInfo</span> = <b>new</b> <a href="RemoteSessionCapability.cs.html#460b658813cb9516" class="t constructor">HostInfo</a>(<span class="r64 r">settings</span>.<a href="../../../hostifaces/PowerShell.cs.html#2088d9ba09399d1e" class="i property">Host</a>);
                <b>if</b> (<span class="r64 r">settings</span>.<a href="../../../hostifaces/PowerShell.cs.html#2088d9ba09399d1e" class="i property">Host</a> == <b>null</b>)
                {
                    <span class="r67 r">hostInfo</span>.<a href="RemoteSessionCapability.cs.html#ccba904c55d54568" class="i property">UseRunspaceHost</a> = <b>true</b>;
                }
 
                <span class="i">ApartmentState</span> <span id="r71 rd" class="r71 r">passedApartmentState</span> = <span class="r64 r">settings</span>.<a href="../../../hostifaces/PowerShell.cs.html#2b73a864082de936" class="i property">ApartmentState</a>;
                <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3832dcae8100c879" class="i field">ApartmentState</a>, <span class="r71 r">passedApartmentState</span>));
                <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e97da4bcb97badb4" class="i field">RemoteStreamOptions</a>, <span class="r64 r">settings</span>.<a href="../../../hostifaces/PowerShell.cs.html#87c2af0d02ef881f" class="i property">RemoteStreamOptions</a>));
                <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#7d7028055bbc2472" class="i field">AddToHistory</a>, <span class="r64 r">settings</span>.<a href="../../../hostifaces/PowerShell.cs.html#27a80b1485d6fbda" class="i property">AddToHistory</a>));
            }
 
            <span class="r68 r">hostInfoProperty</span> = <a href="#7cd42e541f350042" class="i method">CreateHostInfoProperty</a>(<span class="r67 r">hostInfo</span>);
            <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r68 r">hostInfoProperty</span>);
            <span class="r65 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#7465424b6b7a2bc8" class="i field">IsNested</a>, <span class="r62 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#c30957a9d4580098" class="i property">PowerShell</a>.<a href="../../../hostifaces/PowerShell.cs.html#32c156c0cba25702" class="i property">IsNested</a>));
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#8941649eed4c5b4c" class="i field">CreatePowerShell</a>,
                                               <span class="r66 r">clientRunspacePoolId</span>,
                                               <span class="r62 r">shell</span>.<a href="../../client/ClientRemotePowerShell.cs.html#71022daeee1769bc" class="i property">InstanceId</a>,
                                               <span class="r65 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting</span>
        <span class="c">///</span><span class="c"> application private data from server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the client RunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">applicationPrivateData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Application private data.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |  Runspace | CRPID  |   -1    |    Data    | appl. private | PSPrimitive         |</span>
        <span class="c">///</span><span class="c"> |   |    Pool   |        |         |            | data          |           Dictionary|</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="58d663bb675c65e9" href="../../../../R/58d663bb675c65e9.html" target="n" data-glyph="74,1" class="i method">GenerateApplicationPrivateData</a>(
                                    <span class="i">Guid</span> <span id="r72 rd" class="r72 r">clientRunspacePoolId</span>,
                                    <a href="../../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <span id="r73 rd" class="r73 r">applicationPrivateData</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r74 rd" class="r74 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
 
            <span class="r74 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#4a1fe4e592f526d0" class="i field">ApplicationPrivateData</a>, <span class="r73 r">applicationPrivateData</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#2d2c451c38d5530c" class="i field">ApplicationPrivateData</a>,
                                               <span class="r72 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r74 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a state</span>
        <span class="c">///</span><span class="c"> information from server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the client RunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">stateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">State information object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |  Runspace | CRPID  |   -1    |    Data    | RunspacePool  | RunspacePoolState   |</span>
        <span class="c">///</span><span class="c"> |   |    Pool   |        |         |            | StateInfo     | Info                |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="d63dc62e20c6faf1" href="../../../../R/d63dc62e20c6faf1.html" target="n" data-glyph="74,1" class="i method">GenerateRunspacePoolStateInfo</a>(
                                    <span class="i">Guid</span> <span id="r75 rd" class="r75 r">clientRunspacePoolId</span>,
                                    <a href="../RunspacePoolStateInfo.cs.html#8b9143609d7a0363" class="t t">RunspacePoolStateInfo</a> <span id="r76 rd" class="r76 r">stateInfo</span>)
        {
            <span class="c">// BUGBUG: This object creation needs to be relooked</span>
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r77 rd" class="r77 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
 
            <span class="c">// Add State Property</span>
            <a href="../../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r78 rd" class="r78 r">stateProperty</span> =
                        <b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#427500c3dc1a9805" class="i field">RunspaceState</a>,
                            (<b>int</b>)(<span class="r76 r">stateInfo</span>.<a href="../RunspacePoolStateInfo.cs.html#1260ebc06dcda58e" class="i property">State</a>));
            <span class="r77 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r78 r">stateProperty</span>);
 
            <span class="c">// Add Reason property</span>
            <b>if</b> (<span class="r76 r">stateInfo</span>.<a href="../RunspacePoolStateInfo.cs.html#dcad0aee1f0be83d" class="i property">Reason</a> != <b>null</b>)
            {
                <a href="../../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r79 rd" class="r79 r">exceptionProperty</span> = <a href="#92ad4436728a735c" class="i method">GetExceptionProperty</a>(
                    <span class="r80 r">exception</span>: <span class="r76 r">stateInfo</span>.<a href="../RunspacePoolStateInfo.cs.html#dcad0aee1f0be83d" class="i property">Reason</a>,
                    <span class="r81 r">errorId</span>: <span class="s">&quot;RemoteRunspaceStateInfoReason&quot;</span>,
                    <span class="r82 r">category</span>: <a href="../../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../../ErrorPackage.cs.html#707bbec7a1bb5ead" class="i field">NotSpecified</a>);
                <span class="r77 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r79 r">exceptionProperty</span>);
            }
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#0aee2d3c8d9b0076" class="i field">RunspacePoolStateInfo</a>,
                                               <span class="r75 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r77 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a PowerShell</span>
        <span class="c">///</span><span class="c"> event from server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the client RunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |  Runspace | CRPID  |   -1    |    Data    | RunspacePool  | PSEventArgs         |</span>
        <span class="c">///</span><span class="c"> |   |    Pool   |        |         |            | StateInfo     |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="705937a9166e71a4" href="../../../../R/705937a9166e71a4.html" target="n" data-glyph="74,1" class="i method">GeneratePSEventArgs</a>(<span class="i">Guid</span> <span id="r83 rd" class="r83 r">clientRunspacePoolId</span>, <a href="../../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r84 rd" class="r84 r">e</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r85 rd" class="r85 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
 
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e71201769953c3d0" class="i field">PSEventArgsEventIdentifier</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#192b62cb04cdc1cb" class="i property">EventIdentifier</a>));
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#b3f2bdf090397c8c" class="i field">PSEventArgsSourceIdentifier</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#d8b1da7bcf77174b" class="i property">SourceIdentifier</a>));
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#48f789d027deb5a7" class="i field">PSEventArgsTimeGenerated</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#b07e8d2c1ab99698" class="i property">TimeGenerated</a>));
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#c0dd48862c8187e2" class="i field">PSEventArgsSender</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#1b4e059cf3c8cdad" class="i property">Sender</a>));
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#d7f476bc17fce14d" class="i field">PSEventArgsSourceArgs</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#f366c1fd1503a327" class="i property">SourceArgs</a>));
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#457001693606af75" class="i field">PSEventArgsMessageData</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#341469e4b16d1b02" class="i property">MessageData</a>));
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#c256bc3825ea2bda" class="i field">PSEventArgsComputerName</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#2e9010bc7ef36273" class="i property">ComputerName</a>));
            <span class="r85 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#4b9c95e801a882c0" class="i field">PSEventArgsRunspaceId</a>, <span class="r84 r">e</span>.<a href="../../../EventManager.cs.html#796c1be2287edf21" class="i property">RunspaceId</a>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#0922a637409a0869" class="i field">PSEventArgs</a>,
                                               <span class="r83 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r85 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message to instruct the server to reset</span>
        <span class="c">///</span><span class="c"> the single runspace on the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">callId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Caller Id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action          |      Data     |        Type        |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S |  Runspace | CRPID  |   -1    |  Reset server     |     None      | ResetRunspaceState |</span>
        <span class="c">///</span><span class="c"> |   |    Pool   |        |         |  runspace state   |               |                    |</span>
        <span class="c">///</span><span class="c"> ---------------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="77ca4d1b1bd3fadf" href="../../../../R/77ca4d1b1bd3fadf.html" target="n" data-glyph="74,1" class="i method">GenerateResetRunspaceState</a>(<span class="i">Guid</span> <span id="r86 rd" class="r86 r">clientRunspacePoolId</span>, <b>long</b> <span id="r87 rd" class="r87 r">callId</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r88 rd" class="r88 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r88 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9b48d21fcadf90c0" class="i field">CallId</a>, <span class="r87 r">callId</span>));
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#395e49a743d4abcc" class="i field">ResetRunspaceState</a>,
                                               <span class="r86 r">clientRunspacePoolId</span>,
                                               <span class="i">Guid</span>.<span class="i">Empty</span>,
                                               <span class="r88 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the PS remoting protocol version associated with the provided.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">rsPool</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RunspacePool.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PS remoting protocol version.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Version</span> <a id="19381496af8119df" href="../../../../R/19381496af8119df.html" target="n" data-glyph="74,1" class="i method">GetPSRemotingProtocolVersion</a>(<a href="../../../hostifaces/RunspacePool.cs.html#c1948c2f22e6b527" class="t t">RunspacePool</a> <span id="r89 rd" class="r89 r">rsPool</span>)
        {
            <b>return</b> (<span class="r89 r">rsPool</span> != <b>null</b> &amp;&amp; <span class="r89 r">rsPool</span>.<a href="../../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a> != <b>null</b>) ?
                <span class="r89 r">rsPool</span>.<a href="../../../hostifaces/RunspacePool.cs.html#ae1c1c4ae8a5c648" class="i property">RemoteRunspacePoolInternal</a>.<a href="../../client/RemoteRunspacePoolInternal.cs.html#d44f4f1c4f3907db" class="i property">PSRemotingProtocolVersion</a> : <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RunspacePool related
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PowerShell related
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for sending a powershell</span>
        <span class="c">///</span><span class="c"> input data from the client to the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Input data to send.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">clientRemoteRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client runspace pool id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client powershell id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S |PowerShell | CRPID  |   CPID  |    Data    |  input data   |   PowerShellInput   |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |               |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="306edcedbcf31dae" href="../../../../R/306edcedbcf31dae.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellInput</a>(<b>object</b> <span id="r90 rd" class="r90 r">data</span>, <span class="i">Guid</span> <span id="r91 rd" class="r91 r">clientRemoteRunspacePoolId</span>,
            <span class="i">Guid</span> <span id="r92 rd" class="r92 r">clientPowerShellId</span>)
        {
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#1c6bd042904ee46b" class="i field">PowerShellInput</a>,
                                               <span class="r91 r">clientRemoteRunspacePoolId</span>,
                                               <span class="r92 r">clientPowerShellId</span>,
                                               <span class="r90 r">data</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for signalling</span>
        <span class="c">///</span><span class="c"> end of input data for powershell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">clientRemoteRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client runspace pool id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Client powershell id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | S |PowerShell | CRPID  |   CPID  |    Data    | bool.         | PowerShellInputEnd  |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            | TrueString    |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="25682c1fc5df530f" href="../../../../R/25682c1fc5df530f.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellInputEnd</a>(<span class="i">Guid</span> <span id="r93 rd" class="r93 r">clientRemoteRunspacePoolId</span>,
            <span class="i">Guid</span> <span id="r94 rd" class="r94 r">clientPowerShellId</span>)
        {
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#061ac750e6d280da" class="i field">Server</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#313b6d1d71e0521b" class="i field">PowerShellInputEnd</a>,
                                               <span class="r93 r">clientRemoteRunspacePoolId</span>,
                                               <span class="r94 r">clientPowerShellId</span>,
                                               <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a</span>
        <span class="c">///</span><span class="c"> powershell output data from server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to be sent.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client powershell</span>
        <span class="c">///</span><span class="c"> to which this information need to be delivered</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client runspacepool</span>
        <span class="c">///</span><span class="c"> associated with this powershell</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |PowerShell |  CRPID |  CPID   |    Data    | data to send  |  PowerShellOutput   |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |               |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="b2103be7ea06d0f5" href="../../../../R/b2103be7ea06d0f5.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellOutput</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r95 rd" class="r95 r">data</span>, <span class="i">Guid</span> <span id="r96 rd" class="r96 r">clientPowerShellId</span>,
            <span class="i">Guid</span> <span id="r97 rd" class="r97 r">clientRunspacePoolId</span>)
        {
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#f6941c9a7d9e0a2f" class="i field">PowerShellOutput</a>,
                                               <span class="r97 r">clientRunspacePoolId</span>,
                                               <span class="r96 r">clientPowerShellId</span>,
                                               <span class="r95 r">data</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a</span>
        <span class="c">///</span><span class="c"> powershell informational message (debug/verbose/warning/progress)from</span>
        <span class="c">///</span><span class="c"> server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to be sent.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client powershell</span>
        <span class="c">///</span><span class="c"> to which this information need to be delivered</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client runspacepool</span>
        <span class="c">///</span><span class="c"> associated with this powershell</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">dataType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">data type of this informational</span>
        <span class="c">///</span><span class="c"> message</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |PowerShell |  CRPID |  CPID   |    Data    | data to send  | DataType - debug,   |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |               | verbose, warning    |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="e2974ac650b955ff" href="../../../../R/e2974ac650b955ff.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellInformational</a>(<b>object</b> <span id="r98 rd" class="r98 r">data</span>,
            <span class="i">Guid</span> <span id="r100 rd" class="r100 r">clientRunspacePoolId</span>, <span class="i">Guid</span> <span id="r99 rd" class="r99 r">clientPowerShellId</span>, <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a> <span id="r101 rd" class="r101 r">dataType</span>)
        {
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <span class="r101 r">dataType</span>,
                                               <span class="r100 r">clientRunspacePoolId</span>,
                                               <span class="r99 r">clientPowerShellId</span>,
                                               <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r98 r">data</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a</span>
        <span class="c">///</span><span class="c"> powershell progress message from</span>
        <span class="c">///</span><span class="c"> server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">progressRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Progress record to send.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client powershell</span>
        <span class="c">///</span><span class="c"> to which this information need to be delivered</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client runspacepool</span>
        <span class="c">///</span><span class="c"> associated with this powershell</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |PowerShell |  CRPID |  CPID   |    Data    | progress      | PowerShellProgress  |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |   message     |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="5b4db63f3e48d17e" href="../../../../R/5b4db63f3e48d17e.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellInformational</a>(<a href="../../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r102 rd" class="r102 r">progressRecord</span>,
            <span class="i">Guid</span> <span id="r104 rd" class="r104 r">clientRunspacePoolId</span>, <span class="i">Guid</span> <span id="r103 rd" class="r103 r">clientPowerShellId</span>)
        {
            <b>if</b> (<span class="r102 r">progressRecord</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r102 r">progressRecord</span>));
            }
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#b701f1d4d5503ca9" class="i field">PowerShellProgress</a>,
                                               <span class="r104 r">clientRunspacePoolId</span>,
                                               <span class="r103 r">clientPowerShellId</span>,
                                               <span class="r102 r">progressRecord</span>.<a href="../../../ProgressRecord.cs.html#b278995941ed5af9" class="i method">ToPSObjectForRemoting</a>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a</span>
        <span class="c">///</span><span class="c"> powershell information stream message from</span>
        <span class="c">///</span><span class="c"> server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">informationRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Information record to send.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client powershell</span>
        <span class="c">///</span><span class="c"> to which this information need to be delivered</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client runspacepool</span>
        <span class="c">///</span><span class="c"> associated with this powershell</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> -----------------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type                 |</span>
        <span class="c">///</span><span class="c"> -----------------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |PowerShell |  CRPID |  CPID   |    Data    | information   | PowerShellInformationStream |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |   message     |                             |</span>
        <span class="c">///</span><span class="c"> -----------------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="2d621139116d4b5d" href="../../../../R/2d621139116d4b5d.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellInformational</a>(<a href="../../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <span id="r105 rd" class="r105 r">informationRecord</span>,
            <span class="i">Guid</span> <span id="r107 rd" class="r107 r">clientRunspacePoolId</span>, <span class="i">Guid</span> <span id="r106 rd" class="r106 r">clientPowerShellId</span>)
        {
            <b>if</b> (<span class="r105 r">informationRecord</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r105 r">informationRecord</span>));
            }
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#752bf1e010416aa1" class="i field">PowerShellInformationStream</a>,
                                               <span class="r107 r">clientRunspacePoolId</span>,
                                               <span class="r106 r">clientPowerShellId</span>,
                                               <span class="r105 r">informationRecord</span>.<a href="../../../InformationRecord.cs.html#b7c2f744061989a4" class="i method">ToPSObjectForRemoting</a>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a</span>
        <span class="c">///</span><span class="c"> powershell error record from server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">errorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Error record to be sent.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client powershell</span>
        <span class="c">///</span><span class="c"> to which this information need to be delivered</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client runspacepool</span>
        <span class="c">///</span><span class="c"> associated with this powershell</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |PowerShell |  CRPID |  CPID   |    Data    | error record  |   PowerShellError   |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            |    to send    |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="a5be10c18434836f" href="../../../../R/a5be10c18434836f.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellError</a>(<b>object</b> <span id="r108 rd" class="r108 r">errorRecord</span>,
            <span class="i">Guid</span> <span id="r110 rd" class="r110 r">clientRunspacePoolId</span>, <span class="i">Guid</span> <span id="r109 rd" class="r109 r">clientPowerShellId</span>)
        {
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#2bfdbd03af00a40c" class="i field">PowerShellErrorRecord</a>,
                                               <span class="r110 r">clientRunspacePoolId</span>,
                                               <span class="r109 r">clientPowerShellId</span>,
                                               <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r108 r">errorRecord</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a</span>
        <span class="c">///</span><span class="c"> powershell state information from server to client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">stateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">State information object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">clientPowerShellId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client powershell</span>
        <span class="c">///</span><span class="c"> to which this information need to be delivered</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">clientRunspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">id of client runspacepool</span>
        <span class="c">///</span><span class="c"> associated with this powershell</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |PowerShell |  CRPID |  CPID   |    Data    | PSInvocation  | PowerShellStateInfo |</span>
        <span class="c">///</span><span class="c"> |   |           |        |         |            | StateInfo     |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="fa3bc030b5f82cf1" href="../../../../R/fa3bc030b5f82cf1.html" target="n" data-glyph="74,1" class="i method">GeneratePowerShellStateInfo</a>(<a href="../../../hostifaces/PowerShell.cs.html#42e325836d1ae967" class="t t">PSInvocationStateInfo</a> <span id="r111 rd" class="r111 r">stateInfo</span>,
            <span class="i">Guid</span> <span id="r112 rd" class="r112 r">clientPowerShellId</span>, <span class="i">Guid</span> <span id="r113 rd" class="r113 r">clientRunspacePoolId</span>)
        {
            <span class="c">// Encode Pipeline StateInfo as PSObject</span>
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r114 rd" class="r114 r">dataAsPSObject</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
 
            <span class="c">// Convert the state to int and add as property</span>
            <a href="../../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r115 rd" class="r115 r">stateProperty</span> = <b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(
                <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9eae22009e568676" class="i field">PipelineState</a>, (<b>int</b>)(<span class="r111 r">stateInfo</span>.<a href="../../../hostifaces/PowerShell.cs.html#7a70ff5163d0f044" class="i property">State</a>));
            <span class="r114 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r115 r">stateProperty</span>);
 
            <span class="c">// Add exception property</span>
            <b>if</b> (<span class="r111 r">stateInfo</span>.<a href="../../../hostifaces/PowerShell.cs.html#5e4f678af21908e8" class="i property">Reason</a> != <b>null</b>)
            {
                <a href="../../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r116 rd" class="r116 r">exceptionProperty</span> = <a href="#92ad4436728a735c" class="i method">GetExceptionProperty</a>(
                    <span class="r80 r">exception</span>: <span class="r111 r">stateInfo</span>.<a href="../../../hostifaces/PowerShell.cs.html#5e4f678af21908e8" class="i property">Reason</a>,
                    <span class="r81 r">errorId</span>: <span class="s">&quot;RemotePSInvocationStateInfoReason&quot;</span>,
                    <span class="r82 r">category</span>: <a href="../../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../../../ErrorPackage.cs.html#707bbec7a1bb5ead" class="i field">NotSpecified</a>);
                <span class="r114 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r116 r">exceptionProperty</span>);
            }
 
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<a href="RemotingDataObject.cs.html#6904bbcea2ac418a" class="i method">CreateFrom</a>(<a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#5e2f9f14c9ab7c84" class="i field">Client</a>,
                                               <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#dfd57951d114980b" class="i field">PowerShellStateInfo</a>,
                                               <span class="r113 r">clientRunspacePoolId</span>,
                                               <span class="r112 r">clientPowerShellId</span>,
                                               <span class="r114 r">dataAsPSObject</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PowerShell related
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Exception
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the error record from exception of type IContainsErrorRecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">exception</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ErrorRecord if exception is of type IContainsErrorRecord</span>
        <span class="c">///</span><span class="c"> Null if exception is not of type IContainsErrorRecord</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="da9f0df2fba87f42" href="../../../../R/da9f0df2fba87f42.html" target="n" data-glyph="74,1" class="i method">GetErrorRecordFromException</a>(<span class="i">Exception</span> <span id="r117 rd" class="r117 r">exception</span>)
        {
            <a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r117 r">exception</span> != <b>null</b>, <span class="s">&quot;Caller should validate the data&quot;</span>);
 
            <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r118 rd" class="r118 r">er</span> = <b>null</b>;
            <a href="../../../ErrorPackage.cs.html#2d342e12f9600886" class="t t">IContainsErrorRecord</a> <span id="r119 rd" class="r119 r">cer</span> = <span class="r117 r">exception</span> <b>as</b> <a href="../../../ErrorPackage.cs.html#2d342e12f9600886" class="t t">IContainsErrorRecord</a>;
            <b>if</b> (<span class="r119 r">cer</span> != <b>null</b>)
            {
                <span class="r118 r">er</span> = <span class="r119 r">cer</span>.<a href="../../../ErrorPackage.cs.html#cef340f272a30c6b" class="i property">ErrorRecord</a>;
                <span class="c">// Exception inside the error record is ParentContainsErrorRecordException which</span>
                <span class="c">// doesn&#39;t have stack trace. Replace it with top level exception.</span>
                <span class="r118 r">er</span> = <b>new</b> <a href="../../../ErrorPackage.cs.html#9d778b0f7802757e" class="t constructor">ErrorRecord</a>(<span class="r118 r">er</span>, <span class="r117 r">exception</span>);
            }
 
            <b>return</b> <span class="r118 r">er</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a Note Property for the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">exception</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is of not type IContainsErrorRecord, a new ErrorRecord is created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">exception</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ErrorId to use if exception is not of type IContainsErrorRecord.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">category</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ErrorCategory to use if exception is not of type IContainsErrorRecord.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../../../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <a id="92ad4436728a735c" href="../../../../R/92ad4436728a735c.html" target="n" data-glyph="76,1" class="i method">GetExceptionProperty</a>(<span class="i">Exception</span> <span id="r80 rd" class="r80 r">exception</span>, <b>string</b> <span id="r81 rd" class="r81 r">errorId</span>, <a href="../../../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a> <span id="r82 rd" class="r82 r">category</span>)
        {
            <a href="../../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r80 r">exception</span> != <b>null</b>, <span class="s">&quot;Caller should validate the data&quot;</span>);
 
            <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r120 rd" class="r120 r">er</span> = <a href="#da9f0df2fba87f42" class="i method">GetErrorRecordFromException</a>(<span class="r80 r">exception</span>) ??
                             <b>new</b> <a href="../../../ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(<span class="r80 r">exception</span>, <span class="r81 r">errorId</span>, <span class="r82 r">category</span>, <b>null</b>);
            <b>return</b> <b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9fcec8691672ad13" class="i field">ExceptionAsErrorRecord</a>, <span class="r120 r">er</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Exception
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Session related
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a remoting data structure handler message for transporting a session</span>
        <span class="c">///</span><span class="c"> capability message. Should be used by client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">capability</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">RemoteSession capability object to encode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">runspacePoolId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Data structure handler message encoded as RemoteDataObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The message format is as under for this message</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | D |    TI     |  RPID  |   PID   |   Action   |      Data     |        Type         |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <span class="c">///</span><span class="c"> | C |  Session  |  RPID  |  Empty  |    Data    |    session    | SessionCapability   |</span>
        <span class="c">///</span><span class="c"> | / |           |        |         |            |   capability  |                     |</span>
        <span class="c">///</span><span class="c"> | S |           |        |         |            |               |                     |</span>
        <span class="c">///</span><span class="c"> --------------------------------------------------------------------------------------</span>
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="9d8299131960d30e" href="../../../../R/9d8299131960d30e.html" target="n" data-glyph="74,1" class="i method">GenerateClientSessionCapability</a>(<a href="RemoteSessionCapability.cs.html#410d0e97ea446fd9" class="t t">RemoteSessionCapability</a> <span id="r121 rd" class="r121 r">capability</span>,
                <span class="i">Guid</span> <span id="r122 rd" class="r122 r">runspacePoolId</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r123 rd" class="r123 r">temp</span> = <a href="#576399c869367b4f" class="i method">GenerateSessionCapability</a>(<span class="r121 r">capability</span>);
            <span class="r123 r">temp</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(
                <b>new</b> <a href="../../../MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#f13438743b679ac0" class="i field">TimeZone</a>, <a href="RemoteSessionCapability.cs.html#410d0e97ea446fd9" class="t t">RemoteSessionCapability</a>.<a href="RemoteSessionCapability.cs.html#58143058f7ce58ab" class="i method">GetCurrentTimeZoneInByteFormat</a>()));
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<span class="r121 r">capability</span>.<a href="RemoteSessionCapability.cs.html#52b37865634e104b" class="i property">RemotingDestination</a>,
                <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#6b685d32d77b181a" class="i field">SessionCapability</a>, <span class="r122 r">runspacePoolId</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r123 r">temp</span>);
        }
 
        <b>internal static</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a> <a id="067db8a222272e8b" href="../../../../R/067db8a222272e8b.html" target="n" data-glyph="74,1" class="i method">GenerateServerSessionCapability</a>(<a href="RemoteSessionCapability.cs.html#410d0e97ea446fd9" class="t t">RemoteSessionCapability</a> <span id="r124 rd" class="r124 r">capability</span>,
            <span class="i">Guid</span> <span id="r125 rd" class="r125 r">runspacePoolId</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r126 rd" class="r126 r">temp</span> = <a href="#576399c869367b4f" class="i method">GenerateSessionCapability</a>(<span class="r124 r">capability</span>);
            <b>return</b> <a href="RemotingDataObject.cs.html#3856dcbea775cab8" class="t t">RemoteDataObject</a>.<span class="i">CreateFrom</span>(<span class="r124 r">capability</span>.<a href="RemoteSessionCapability.cs.html#52b37865634e104b" class="i property">RemotingDestination</a>,
                <a href="#296cbb5be87abd08" class="t t">RemotingDataType</a>.<a href="#6b685d32d77b181a" class="i field">SessionCapability</a>, <span class="r125 r">runspacePoolId</span>, <span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r126 r">temp</span>);
        }
 
        <b>private static</b> <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="576399c869367b4f" href="../../../../R/576399c869367b4f.html" target="n" data-glyph="76,1" class="i method">GenerateSessionCapability</a>(<a href="RemoteSessionCapability.cs.html#410d0e97ea446fd9" class="t t">RemoteSessionCapability</a> <span id="r127 rd" class="r127 r">capability</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r128 rd" class="r128 r">temp</span> = <a href="#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
            <span class="r128 r">temp</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(
                <b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#c416521156fef723" class="i field">PS_STARTUP_PROTOCOL_VERSION_NAME</a>, <span class="r127 r">capability</span>.<a href="RemoteSessionCapability.cs.html#e0172342f9aadac0" class="i property">ProtocolVersion</a>));
            <span class="r128 r">temp</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(
                <b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#09a93f00dbacc96b" class="i field">PSVersion</a>, <span class="r127 r">capability</span>.<a href="RemoteSessionCapability.cs.html#51f8c62899f19f35" class="i property">PSVersion</a>));
            <span class="r128 r">temp</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="../../../MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(
                <b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#27d5b1b7d3362576" class="i field">SerializationVersion</a>, <span class="r127 r">capability</span>.<a href="RemoteSessionCapability.cs.html#4cbbb234181ff56e" class="i property">SerializationVersion</a>));
            <b>return</b> <span class="r128 r">temp</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Session related
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Converts fields of PSObjects containing remoting messages to C# types.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="6f71f8c4cc2ac041" href="../../../../R/6f71f8c4cc2ac041.html" target="n" data-glyph="2,0" class="t t">RemotingDecoder</a>
    {
        <b>private static</b> <span class="r129 r t">T</span> <a id="f44eff1929471f7d" href="../../../../R/f44eff1929471f7d.html" target="n" data-glyph="76,1" class="i method">ConvertPropertyValueTo</a>&lt;<span id="r129 rd t" class="r129 r t">T</span>&gt;(<b>string</b> <span id="r130 rd" class="r130 r">propertyName</span>, <b>object</b> <span id="r131 rd" class="r131 r">propertyValue</span>)
        {
            <b>if</b> (<span class="r130 r">propertyName</span> == <b>null</b>) <span class="c">// comes from internal caller</span>
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r130 r">propertyName</span>));
            }
 
            <b>if</b> (<b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">IsEnum</span>)
            {
                <b>if</b> (<span class="r131 r">propertyValue</span> <b>is string</b>)
                {
                    <b>try</b>
                    {
                        <b>string</b> <span id="r132 rd" class="r132 r">stringValue</span> = (<b>string</b>)<span class="r131 r">propertyValue</span>;
                        <span class="r129 r t">T</span> <span id="r133 rd" class="r133 r">value</span> = (<span class="r129 r t">T</span>)<span class="i">Enum</span>.<span class="i">Parse</span>(<b>typeof</b>(<span class="r129 r t">T</span>), <span class="r132 r">stringValue</span>, <b>true</b>);
                        <b>return</b> <span class="r133 r">value</span>;
                    }
                    <b>catch</b> (<span class="i">ArgumentException</span>)
                    {
                        <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(
                            <span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastPropertyToExpectedType</span>,
                            <span class="r130 r">propertyName</span>,
                            <b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">FullName</span>,
                            <span class="r131 r">propertyValue</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
                    }
                }
 
                <b>try</b>
                {
                    <span class="i">Type</span> <span id="r134 rd" class="r134 r">underlyingType</span> = <span class="i">Enum</span>.<span class="i">GetUnderlyingType</span>(<b>typeof</b>(<span class="r129 r t">T</span>));
                    <b>object</b> <span id="r135 rd" class="r135 r">underlyingValue</span> = <a href="../../../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r131 r">propertyValue</span>, <span class="r134 r">underlyingType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    <span class="r129 r t">T</span> <span id="r136 rd" class="r136 r">value</span> = (<span class="r129 r t">T</span>)<span class="r135 r">underlyingValue</span>;
                    <b>return</b> <span class="r136 r">value</span>;
                }
                <b>catch</b> (<span class="i">InvalidCastException</span>)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(
                        <span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastPropertyToExpectedType</span>,
                        <span class="r130 r">propertyName</span>,
                        <b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">FullName</span>,
                        <span class="r131 r">propertyValue</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
                }
            }
            <b>else</b> <b>if</b> (<b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">Equals</span>(<b>typeof</b>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)))
            {
                <b>if</b> (<span class="r131 r">propertyValue</span> == <b>null</b>)
                {
                    <b>return</b> <b>default</b>(<span class="r129 r t">T</span>); <span class="c">// =&gt; &quot;return null&quot; for PSObject</span>
                }
                <b>else</b>
                {
                    <b>return</b> (<span class="r129 r t">T</span>)(<b>object</b>)<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r131 r">propertyValue</span>);
                }
            }
            <b>else</b> <b>if</b> (<span class="r131 r">propertyValue</span> == <b>null</b>)
            {
                <b>if</b> (!<b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">IsValueType</span>)
                {
                    <b>return</b> <b>default</b>(<span class="r129 r t">T</span>);
                }
 
                <b>if</b> (<b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">IsGenericType</span> &amp;&amp; <b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">GetGenericTypeDefinition</span>().<span class="i">Equals</span>(<b>typeof</b>(<span class="i">Nullable</span>&lt;&gt;)))
                {
                    <b>return</b> <b>default</b>(<span class="r129 r t">T</span>);
                }
 
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastPropertyToExpectedType</span>,
                    <span class="r130 r">propertyName</span>,
                    <b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">FullName</span>,
                    <span class="r131 r">propertyValue</span> != <b>null</b> ? <span class="r131 r">propertyValue</span>.<span class="i">GetType</span>().<span class="i">FullName</span> : <span class="s">&quot;null&quot;</span>);
            }
            <b>else</b> <b>if</b> (<span class="r131 r">propertyValue</span> <b>is</b> <span class="r129 r t">T</span>)
            {
                <b>return</b> (<span class="r129 r t">T</span>)(<span class="r131 r">propertyValue</span>);
            }
            <b>else</b> <b>if</b> (<span class="r131 r">propertyValue</span> <b>is</b> <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r137 rd" class="r137 r">psObject</span> = (<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r131 r">propertyValue</span>;
                <b>return</b> <a href="#f44eff1929471f7d" class="i method">ConvertPropertyValueTo</a>&lt;<span class="r129 r t">T</span>&gt;(<span class="r130 r">propertyName</span>, <span class="r137 r">psObject</span>.<a href="../../../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>);
            }
            <b>else</b> <b>if</b> ((<span class="r131 r">propertyValue</span> <b>is</b> <span class="i">Hashtable</span>) &amp;&amp; (<b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">Equals</span>(<b>typeof</b>(<a href="../../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>))))
            {
                <span class="c">// rehydration of PSPrimitiveDictionary might not work when CreateRunspacePool message is received</span>
                <span class="c">// (there is no runspace and so no type table at this point) so try converting manually</span>
                <b>try</b>
                {
                    <b>return</b> (<span class="r129 r t">T</span>)(<b>object</b>)(<b>new</b> <a href="../../../serialization.cs.html#728e9bd88978fac9" class="t constructor">PSPrimitiveDictionary</a>((<span class="i">Hashtable</span>)<span class="r131 r">propertyValue</span>));
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(
                        <span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastPropertyToExpectedType</span>,
                        <span class="r130 r">propertyName</span>,
                        <b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">FullName</span>,
                        <span class="r131 r">propertyValue</span> != <b>null</b> ? <span class="r131 r">propertyValue</span>.<span class="i">GetType</span>().<span class="i">FullName</span> : <span class="s">&quot;null&quot;</span>);
                }
            }
            <b>else</b>
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastPropertyToExpectedType</span>,
                    <span class="r130 r">propertyName</span>,
                    <b>typeof</b>(<span class="r129 r t">T</span>).<span class="i">FullName</span>,
                    <span class="r131 r">propertyValue</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
        }
 
        <b>private static</b> <a href="../../../MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <a id="742054a0f81e31d0" href="../../../../R/742054a0f81e31d0.html" target="n" data-glyph="76,1" class="i method">GetProperty</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r138 rd" class="r138 r">psObject</span>, <b>string</b> <span id="r139 rd" class="r139 r">propertyName</span>)
        {
            <b>if</b> (<span class="r138 r">psObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r138 r">psObject</span>));
            }
 
            <b>if</b> (<span class="r139 r">propertyName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r139 r">propertyName</span>));
            }
 
            <a href="../../../MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r140 rd" class="r140 r">property</span> = <span class="r138 r">psObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r139 r">propertyName</span>];
 
            <b>if</b> (<span class="r140 r">property</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">MissingProperty</span>, <span class="r139 r">propertyName</span>);
            }
 
            <b>return</b> <span class="r140 r">property</span>;
        }
 
        <b>internal static</b> <span class="r141 r t">T</span> <a id="d3fee447c77dfb3b" href="../../../../R/d3fee447c77dfb3b.html" target="n" data-glyph="74,1" class="i method">GetPropertyValue</a>&lt;<span id="r141 rd t" class="r141 r t">T</span>&gt;(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r142 rd" class="r142 r">psObject</span>, <b>string</b> <span id="r143 rd" class="r143 r">propertyName</span>)
        {
            <b>if</b> (<span class="r142 r">psObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r142 r">psObject</span>));
            }
 
            <b>if</b> (<span class="r143 r">propertyName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r143 r">propertyName</span>));
            }
 
            <a href="../../../MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r144 rd" class="r144 r">property</span> = <a href="#742054a0f81e31d0" class="i method">GetProperty</a>(<span class="r142 r">psObject</span>, <span class="r143 r">propertyName</span>);
            <b>object</b> <span id="r145 rd" class="r145 r">propertyValue</span> = <span class="r144 r">property</span>.<a href="../../../MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
            <b>return</b> <a href="#f44eff1929471f7d" class="i method">ConvertPropertyValueTo</a>&lt;<span class="r141 r t">T</span>&gt;(<span class="r143 r">propertyName</span>, <span class="r145 r">propertyValue</span>);
        }
 
        <b>internal static</b> <span class="i">IEnumerable</span>&lt;<span class="r146 r t">T</span>&gt; <a id="2942ab29289f1398" href="../../../../R/2942ab29289f1398.html" target="n" data-glyph="74,1" class="i method">EnumerateListProperty</a>&lt;<span id="r146 rd t" class="r146 r t">T</span>&gt;(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r147 rd" class="r147 r">psObject</span>, <b>string</b> <span id="r148 rd" class="r148 r">propertyName</span>)
        {
            <b>if</b> (<span class="r147 r">psObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r147 r">psObject</span>));
            }
 
            <b>if</b> (<span class="r148 r">propertyName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r148 r">propertyName</span>));
            }
 
            <span class="i">IEnumerable</span> <span id="r149 rd" class="r149 r">e</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">IEnumerable</span>&gt;(<span class="r147 r">psObject</span>, <span class="r148 r">propertyName</span>);
            <b>if</b> (<span class="r149 r">e</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>object</b> <span id="r150 rd" class="r150 r">o</span> <b>in</b> <span class="r149 r">e</span>)
                {
                    <b>yield</b> <b>return</b> <a href="#f44eff1929471f7d" class="i method">ConvertPropertyValueTo</a>&lt;<span class="r146 r t">T</span>&gt;(<span class="r148 r">propertyName</span>, <span class="r150 r">o</span>);
                }
            }
        }
 
        <b>internal static</b> <span class="i">IEnumerable</span>&lt;<span class="i">KeyValuePair</span>&lt;<span class="r151 r t">TKey</span>, <span class="r152 r t">TValue</span>&gt;&gt; <a id="24e7c7e702ae82fe" href="../../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">EnumerateHashtableProperty</a>&lt;<span id="r151 rd t" class="r151 r t">TKey</span>, <span id="r152 rd t" class="r152 r t">TValue</span>&gt;(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r153 rd" class="r153 r">psObject</span>, <b>string</b> <span id="r154 rd" class="r154 r">propertyName</span>)
        {
            <b>if</b> (<span class="r153 r">psObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r153 r">psObject</span>));
            }
 
            <b>if</b> (<span class="r154 r">propertyName</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r154 r">propertyName</span>));
            }
 
            <span class="i">Hashtable</span> <span id="r155 rd" class="r155 r">h</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">Hashtable</span>&gt;(<span class="r153 r">psObject</span>, <span class="r154 r">propertyName</span>);
            <b>if</b> (<span class="r155 r">h</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r156 rd" class="r156 r">e</span> <b>in</b> <span class="r155 r">h</span>)
                {
                    <span class="r151 r t">TKey</span> <span id="r157 rd" class="r157 r">key</span> = <span class="i">ConvertPropertyValueTo</span>&lt;<span class="r151 r t">TKey</span>&gt;(<span class="r154 r">propertyName</span>, <span class="r156 r">e</span>.<span class="i">Key</span>);
                    <span class="r152 r t">TValue</span> <span id="r158 rd" class="r158 r">value</span> = <span class="i">ConvertPropertyValueTo</span>&lt;<span class="r152 r t">TValue</span>&gt;(<span class="r154 r">propertyName</span>, <span class="r156 r">e</span>.<span class="i">Value</span>);
                    <b>yield</b> <b>return</b> <b>new</b> <span class="i">KeyValuePair</span>&lt;<span class="r151 r t">TKey</span>, <span class="r152 r t">TValue</span>&gt;(<span class="r157 r">key</span>, <span class="r158 r">value</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the RunspacePool state info from the</span>
        <span class="c">///</span><span class="c"> data object specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r159 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RunspacePoolStateInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../RunspacePoolStateInfo.cs.html#8b9143609d7a0363" class="t t">RunspacePoolStateInfo</a> <a id="44cac9843d77a5ba" href="../../../../R/44cac9843d77a5ba.html" target="n" data-glyph="74,1" class="i method">GetRunspacePoolStateInfo</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r159 rd" class="r159 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r159 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r159 r">dataAsPSObject</span>));
            }
 
            <a href="../../../hostifaces/RunspacePool.cs.html#b51dd15975151fb4" class="t t">RunspacePoolState</a> <span id="r160 rd" class="r160 r">state</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../hostifaces/RunspacePool.cs.html#b51dd15975151fb4" class="t t">RunspacePoolState</a>&gt;(<span class="r159 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#427500c3dc1a9805" class="i field">RunspaceState</a>);
            <span class="i">Exception</span> <span id="r161 rd" class="r161 r">reason</span> = <a href="#9bbe68307f7e3e04" class="i method">GetExceptionFromStateInfoObject</a>(<span class="r159 r">dataAsPSObject</span>);
 
            <b>return</b> <b>new</b> <a href="../RunspacePoolStateInfo.cs.html#c7dae263df1aded0" class="t constructor">RunspacePoolStateInfo</a>(<span class="r160 r">state</span>, <span class="r161 r">reason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the application private data from the</span>
        <span class="c">///</span><span class="c"> data object specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r162 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Application private data.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="216ee960fdab1445" href="../../../../R/216ee960fdab1445.html" target="n" data-glyph="74,1" class="i method">GetApplicationPrivateData</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r162 rd" class="r162 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r162 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r162 r">dataAsPSObject</span>));
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>&gt;(<span class="r162 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#4a1fe4e592f526d0" class="i field">ApplicationPrivateData</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the public key from the encoded message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r163 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Public key as string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="0412e18c63ebcde8" href="../../../../R/0412e18c63ebcde8.html" target="n" data-glyph="74,1" class="i method">GetPublicKey</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r163 rd" class="r163 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r163 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r163 r">dataAsPSObject</span>));
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r163 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#74b7030f7291609b" class="i field">PublicKey</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the encrypted session key from the encoded message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r164 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Encrypted session key as string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="2d0ab3510e62f5af" href="../../../../R/2d0ab3510e62f5af.html" target="n" data-glyph="74,1" class="i method">GetEncryptedSessionKey</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r164 rd" class="r164 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r164 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r164 r">dataAsPSObject</span>));
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r164 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#741a86f0378ef653" class="i field">EncryptedSessionKey</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the RunspacePool state info from the</span>
        <span class="c">///</span><span class="c"> data object specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r165 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RunspacePoolStateInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <a id="377d82ad8589858d" href="../../../../R/377d82ad8589858d.html" target="n" data-glyph="74,1" class="i method">GetPSEventArgs</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r165 rd" class="r165 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r165 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r165 r">dataAsPSObject</span>));
            }
 
            <b>int</b> <span id="r166 rd" class="r166 r">eventIdentifier</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e71201769953c3d0" class="i field">PSEventArgsEventIdentifier</a>);
            <b>string</b> <span id="r167 rd" class="r167 r">sourceIdentifier</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#b3f2bdf090397c8c" class="i field">PSEventArgsSourceIdentifier</a>);
            <b>object</b> <span id="r168 rd" class="r168 r">sender</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>object</b>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#c0dd48862c8187e2" class="i field">PSEventArgsSender</a>);
            <b>object</b> <span id="r169 rd" class="r169 r">messageData</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>object</b>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#457001693606af75" class="i field">PSEventArgsMessageData</a>);
            <b>string</b> <span id="r170 rd" class="r170 r">computerName</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#c256bc3825ea2bda" class="i field">PSEventArgsComputerName</a>);
            <span class="i">Guid</span> <span id="r171 rd" class="r171 r">runspaceId</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">Guid</span>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#4b9c95e801a882c0" class="i field">PSEventArgsRunspaceId</a>);
 
            <b>var</b> <span id="r172 rd" class="r172 r">sourceArgs</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
            <b>foreach</b> (<b>object</b> <span id="r173 rd" class="r173 r">argument</span> <b>in</b> <a href="#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="#2942ab29289f1398" class="i method">EnumerateListProperty</a>&lt;<b>object</b>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#d7f476bc17fce14d" class="i field">PSEventArgsSourceArgs</a>))
            {
                <span class="r172 r">sourceArgs</span>.<span class="i">Add</span>(<span class="r173 r">argument</span>);
            }
 
            <a href="../../../EventManager.cs.html#7210411b2f4a8407" class="t t">PSEventArgs</a> <span id="r174 rd" class="r174 r">eventArgs</span> = <b>new</b> <span class="t">PSEventArgs</span>(
                <span class="r170 r">computerName</span>,
                <span class="r171 r">runspaceId</span>,
                <span class="r166 r">eventIdentifier</span>,
                <span class="r167 r">sourceIdentifier</span>,
                <span class="r168 r">sender</span>,
                <span class="r172 r">sourceArgs</span>.<span class="i">ToArray</span>(),
                <span class="r169 r">messageData</span> == <b>null</b> ? <b>null</b> : <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r169 r">messageData</span>));
 
            <span class="r174 r">eventArgs</span>.<a href="../../../EventManager.cs.html#b07e8d2c1ab99698" class="i property">TimeGenerated</a> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">DateTime</span>&gt;(<span class="r165 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#48f789d027deb5a7" class="i field">PSEventArgsTimeGenerated</a>);
 
            <b>return</b> <span class="r174 r">eventArgs</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the minimum runspaces to create in the</span>
        <span class="c">///</span><span class="c"> runspace pool from the data object specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r175 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Minimum runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static int</b> <a id="d4b54f4a150af9f4" href="../../../../R/d4b54f4a150af9f4.html" target="n" data-glyph="74,1" class="i method">GetMinRunspaces</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r175 rd" class="r175 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r175 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r175 r">dataAsPSObject</span>));
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r175 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3a081a470ad31112" class="i field">MinRunspaces</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the maximum runspaces to create in the</span>
        <span class="c">///</span><span class="c"> runspace pool from the data object specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r176 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Maximum runspaces.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static int</b> <a id="46661bd99bcc98ca" href="../../../../R/46661bd99bcc98ca.html" target="n" data-glyph="74,1" class="i method">GetMaxRunspaces</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r176 rd" class="r176 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r176 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r176 r">dataAsPSObject</span>));
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r176 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#07dae46e70021227" class="i field">MaxRunspaces</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the thread options for the runspaces in the</span>
        <span class="c">///</span><span class="c"> runspace pool from the data object specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r177 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Thread options.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a> <a id="f773dc8c88277cb3" href="../../../../R/f773dc8c88277cb3.html" target="n" data-glyph="74,1" class="i method">GetApplicationArguments</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r177 rd" class="r177 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r177 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r177 r">dataAsPSObject</span>));
            }
 
            <span class="c">// rehydration might not work yet (there is no type table before a runspace is created)</span>
            <span class="c">// so try to cast ApplicationArguments to PSPrimitiveDictionary manually</span>
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../serialization.cs.html#04756020c00714fe" class="t t">PSPrimitiveDictionary</a>&gt;(<span class="r177 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#a2756eaa18d38d76" class="i field">ApplicationArguments</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates RunspacePoolInitInfo object from a received PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r178 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RunspacePoolInitInfo generated.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../RunspaceInitInfo.cs.html#3c3057f316390745" class="t t">RunspacePoolInitInfo</a> <a id="807ab5db183a009e" href="../../../../R/807ab5db183a009e.html" target="n" data-glyph="74,1" class="i method">GetRunspacePoolInitInfo</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r178 rd" class="r178 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r178 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r178 r">dataAsPSObject</span>));
            }
 
            <b>int</b> <span id="r179 rd" class="r179 r">maxRS</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r178 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#07dae46e70021227" class="i field">MaxRunspaces</a>);
            <b>int</b> <span id="r180 rd" class="r180 r">minRS</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r178 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3a081a470ad31112" class="i field">MinRunspaces</a>);
 
            <b>return</b> <b>new</b> <a href="../RunspaceInitInfo.cs.html#d52708feebd61cb7" class="t constructor">RunspacePoolInitInfo</a>(<span class="r180 r">minRS</span>, <span class="r179 r">maxRS</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the thread options for the runspaces in the</span>
        <span class="c">///</span><span class="c"> runspace pool from the data object specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r181 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Thread options.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a> <a id="1be58c2a39fecfcf" href="../../../../R/1be58c2a39fecfcf.html" target="n" data-glyph="74,1" class="i method">GetThreadOptions</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r181 rd" class="r181 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r181 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r181 r">dataAsPSObject</span>));
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a>&gt;(<span class="r181 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#08e976e84728ae95" class="i field">ThreadOptions</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decode and obtain the host info for the host</span>
        <span class="c">///</span><span class="c"> associated with the runspace pool.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r182 r">dataAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DataAsPSObject object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Host information.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a> <a id="930a3e874da40152" href="../../../../R/930a3e874da40152.html" target="n" data-glyph="74,1" class="i method">GetHostInfo</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r182 rd" class="r182 r">dataAsPSObject</span>)
        {
            <b>if</b> (<span class="r182 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r182 r">dataAsPSObject</span>));
            }
 
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r183 rd" class="r183 r">propertyValue</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r182 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#5d7660606cc62ee7" class="i field">HostInfo</a>);
            <b>return</b> <a href="RemoteHostEncoder.cs.html#f99e89fafaac33f0" class="t t">RemoteHostEncoder</a>.<span class="i">DecodeObject</span>(<span class="r183 r">propertyValue</span>, <b>typeof</b>(<a href="RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a>)) <b>as</b> <a href="RemoteSessionCapability.cs.html#4fc7c4b336de518c" class="t t">HostInfo</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the exception if any from the serialized state info object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r184 r">stateInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Exception</span> <a id="9bbe68307f7e3e04" href="../../../../R/9bbe68307f7e3e04.html" target="n" data-glyph="76,1" class="i method">GetExceptionFromStateInfoObject</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r184 rd" class="r184 r">stateInfo</span>)
        {
            <span class="c">// Check if exception is encoded as errorrecord</span>
            <a href="../../../MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r185 rd" class="r185 r">property</span> = <span class="r184 r">stateInfo</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9fcec8691672ad13" class="i field">ExceptionAsErrorRecord</a>];
            <b>if</b> (<span class="r185 r">property</span> != <b>null</b> &amp;&amp; <span class="r185 r">property</span>.<a href="../../../MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> != <b>null</b>)
            {
                <b>return</b> <a href="#7ac8cd4e70558c15" class="i method">GetExceptionFromSerializedErrorRecord</a>(<span class="r185 r">property</span>.<a href="../../../MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>);
            }
            <span class="c">// Exception is not present and return null.</span>
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the exception from serialized error record.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r186 r">serializedErrorRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Exception</span> <a id="7ac8cd4e70558c15" href="../../../../R/7ac8cd4e70558c15.html" target="n" data-glyph="74,1" class="i method">GetExceptionFromSerializedErrorRecord</a>(<b>object</b> <span id="r186 rd" class="r186 r">serializedErrorRecord</span>)
        {
            <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r187 rd" class="r187 r">er</span> = <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="../../../ErrorPackage.cs.html#1232603351a94344" class="i method">FromPSObjectForRemoting</a>(<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r186 r">serializedErrorRecord</span>));
 
            <b>if</b> (<span class="r187 r">er</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">DecodingErrorForErrorRecord</span>);
            }
            <b>else</b>
            {
                <b>return</b> <span class="r187 r">er</span>.<a href="../../../ErrorPackage.cs.html#2c2498db91e737eb" class="i property">Exception</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the output from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Output object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">the current implementation does nothing,</span>
        <span class="c">///</span><span class="c"> however this method is there in place as the</span>
        <span class="c">///</span><span class="c"> packaging of output data may change in the future</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="b97939d32ca1b1bd" href="../../../../R/b97939d32ca1b1bd.html" target="n" data-glyph="74,1" class="i method">GetPowerShellOutput</a>(<b>object</b> <span id="r188 rd" class="r188 r">data</span>)
        {
            <b>return</b> <span class="r188 r">data</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the PSInvocationStateInfo from the data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PSInvocationInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/PowerShell.cs.html#42e325836d1ae967" class="t t">PSInvocationStateInfo</a> <a id="00f6cb797709ad8f" href="../../../../R/00f6cb797709ad8f.html" target="n" data-glyph="74,1" class="i method">GetPowerShellStateInfo</a>(<b>object</b> <span id="r189 rd" class="r189 r">data</span>)
        {
            <b>if</b> (!(<span class="r189 r">data</span> <b>is</b> <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r190 rd" class="r190 r">dataAsPSObject</span>))
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">DecodingErrorForPowerShellStateInfo</span>);
            }
 
            <a href="../../../hostifaces/PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a> <span id="r191 rd" class="r191 r">state</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../hostifaces/PowerShell.cs.html#24cc37ccdc118b7a" class="t t">PSInvocationState</a>&gt;(<span class="r190 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#9eae22009e568676" class="i field">PipelineState</a>);
            <span class="i">Exception</span> <span id="r192 rd" class="r192 r">reason</span> = <a href="#9bbe68307f7e3e04" class="i method">GetExceptionFromStateInfoObject</a>(<span class="r190 r">dataAsPSObject</span>);
            <b>return</b> <b>new</b> <a href="../../../hostifaces/PowerShell.cs.html#db44bd87590c83f5" class="t constructor">PSInvocationStateInfo</a>(<span class="r191 r">state</span>, <span class="r192 r">reason</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ErrorRecord from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r193 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Error record.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="bb281af0bee4a742" href="../../../../R/bb281af0bee4a742.html" target="n" data-glyph="74,1" class="i method">GetPowerShellError</a>(<b>object</b> <span id="r193 rd" class="r193 r">data</span>)
        {
            <b>if</b> (<span class="r193 r">data</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r193 r">data</span>));
            }
 
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r194 rd" class="r194 r">dataAsPSObject</span> = <span class="r193 r">data</span> <b>as</b> <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
 
            <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r195 rd" class="r195 r">errorRecord</span> = <a href="../../../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>.<a href="../../../ErrorPackage.cs.html#1232603351a94344" class="i method">FromPSObjectForRemoting</a>(<span class="r194 r">dataAsPSObject</span>);
 
            <b>return</b> <span class="r195 r">errorRecord</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the WarningRecord from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a> <a id="d40bf90dfc2be117" href="../../../../R/d40bf90dfc2be117.html" target="n" data-glyph="74,1" class="i method">GetPowerShellWarning</a>(<b>object</b> <span id="r196 rd" class="r196 r">data</span>)
        {
            <b>if</b> (<span class="r196 r">data</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r196 r">data</span>));
            }
 
            <b>return</b> <b>new</b> <a href="../../../hostifaces/InformationalRecord.cs.html#171e6c8e4bb009d9" class="t constructor">WarningRecord</a>((<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r196 r">data</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the VerboseRecord from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/InformationalRecord.cs.html#5d56339940b0040b" class="t t">VerboseRecord</a> <a id="7d01a3a943851c87" href="../../../../R/7d01a3a943851c87.html" target="n" data-glyph="74,1" class="i method">GetPowerShellVerbose</a>(<b>object</b> <span id="r197 rd" class="r197 r">data</span>)
        {
            <b>if</b> (<span class="r197 r">data</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r197 r">data</span>));
            }
 
            <b>return</b> <b>new</b> <a href="../../../hostifaces/InformationalRecord.cs.html#96a2576c9d0495c4" class="t constructor">VerboseRecord</a>((<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r197 r">data</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the DebugRecord from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/InformationalRecord.cs.html#8954d4e40287d3de" class="t t">DebugRecord</a> <a id="d8145ef4fe7bbb59" href="../../../../R/d8145ef4fe7bbb59.html" target="n" data-glyph="74,1" class="i method">GetPowerShellDebug</a>(<b>object</b> <span id="r198 rd" class="r198 r">data</span>)
        {
            <b>if</b> (<span class="r198 r">data</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r198 r">data</span>));
            }
 
            <b>return</b> <b>new</b> <a href="../../../hostifaces/InformationalRecord.cs.html#93c80c2f74e8816e" class="t constructor">DebugRecord</a>((<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r198 r">data</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ProgressRecord from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <a id="75e34edda9100a51" href="../../../../R/75e34edda9100a51.html" target="n" data-glyph="74,1" class="i method">GetPowerShellProgress</a>(<b>object</b> <span id="r199 rd" class="r199 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r200 rd" class="r200 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r199 r">data</span>);
            <b>if</b> (<span class="r200 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r199 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <b>return</b> <a href="../../../ProgressRecord.cs.html#d79b27687c6ed8c8" class="t t">ProgressRecord</a>.<a href="../../../ProgressRecord.cs.html#b59ff0d76f410fc2" class="i method">FromPSObjectForRemoting</a>(<span class="r200 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the InformationRecord from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a> <a id="462d4e1e3f0f05bc" href="../../../../R/462d4e1e3f0f05bc.html" target="n" data-glyph="74,1" class="i method">GetPowerShellInformation</a>(<b>object</b> <span id="r201 rd" class="r201 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r202 rd" class="r202 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r201 r">data</span>);
            <b>if</b> (<span class="r202 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r201 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <b>return</b> <a href="../../../InformationRecord.cs.html#508a9dbac37ec093" class="t t">InformationRecord</a>.<a href="../../../InformationRecord.cs.html#b5ca2556774d0119" class="i method">FromPSObjectForRemoting</a>(<span class="r202 r">dataAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the PowerShell object from the specified data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r203 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Deserialized PowerShell object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="16573ea7d7071ccb" href="../../../../R/16573ea7d7071ccb.html" target="n" data-glyph="74,1" class="i method">GetPowerShell</a>(<b>object</b> <span id="r203 rd" class="r203 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r204 rd" class="r204 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r203 r">data</span>);
            <b>if</b> (<span class="r204 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r203 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r205 rd" class="r205 r">powerShellAsPSObject</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r204 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#5a07681611f0c954" class="i field">PowerShell</a>);
            <b>return</b> <a href="../../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../../../hostifaces/PowerShell.cs.html#448b8dfbccdf0e83" class="i method">FromPSObjectForRemoting</a>(<span class="r205 r">powerShellAsPSObject</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the PowerShell object from the specified data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r206 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Deserialized PowerShell object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="bb3df76869c2da7a" href="../../../../R/bb3df76869c2da7a.html" target="n" data-glyph="74,1" class="i method">GetCommandDiscoveryPipeline</a>(<b>object</b> <span id="r206 rd" class="r206 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r207 rd" class="r207 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r206 r">data</span>);
            <b>if</b> (<span class="r207 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r206 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r208 rd" class="r208 r">commandType</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#f6ab229ab600fda0" class="i field">DiscoveryType</a>);
 
            <b>string</b>[] <span id="r209 rd" class="r209 r">name</span>;
            <b>if</b> (<a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#36b2f3ffac0efd11" class="i field">DiscoveryName</a>) != <b>null</b>)
            {
                <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r210 rd" class="r210 r">tmp</span> = <a href="#2942ab29289f1398" class="i method">EnumerateListProperty</a>&lt;<b>string</b>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#36b2f3ffac0efd11" class="i field">DiscoveryName</a>);
                <span class="r209 r">name</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r210 r">tmp</span>).<span class="i">ToArray</span>();
            }
            <b>else</b>
            {
                <span class="r209 r">name</span> = <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
            }
 
            <b>string</b>[] <span id="r211 rd" class="r211 r">module</span>;
            <b>if</b> (<a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#44111bad2d7454f2" class="i field">DiscoveryModule</a>) != <b>null</b>)
            {
                <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r212 rd" class="r212 r">tmp</span> = <a href="#2942ab29289f1398" class="i method">EnumerateListProperty</a>&lt;<b>string</b>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#44111bad2d7454f2" class="i field">DiscoveryModule</a>);
                <span class="r211 r">module</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r212 r">tmp</span>).<span class="i">ToArray</span>();
            }
            <b>else</b>
            {
                <span class="r211 r">module</span> = <b>new</b> <b>string</b>[] { <b>string</b>.<span class="i">Empty</span> };
            }
 
            <a href="../../../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>[] <span id="r213 rd" class="r213 r">fullyQualifiedName</span> = <b>null</b>;
            <b>if</b> (<a href="../../../serialization.cs.html#ddbcb5ecc947a806" class="t t">DeserializingTypeConverter</a>.<a href="../../../serialization.cs.html#4e995a3c8b04ebcc" class="i method">GetPropertyValue</a>&lt;<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r207 r">dataAsPSObject</span>,
                                                                      <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#f14acfc7c48771f8" class="i field">DiscoveryFullyQualifiedModule</a>,
                                                                      <a href="../../../serialization.cs.html#ddbcb5ecc947a806" class="t t">DeserializingTypeConverter</a>.<a href="../../../serialization.cs.html#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="../../../serialization.cs.html#57368bb545aac544" class="i field">NullValueOk</a> | <a href="../../../serialization.cs.html#ddbcb5ecc947a806" class="t t">DeserializingTypeConverter</a>.<a href="../../../serialization.cs.html#1056e690af85447d" class="t t">RehydrationFlags</a>.<a href="../../../serialization.cs.html#7004b900d60ba66b" class="i field">MissingPropertyOk</a>) != <b>null</b>)
            {
                <span class="i">IEnumerable</span>&lt;<a href="../../../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <span id="r214 rd" class="r214 r">tmp</span> = <a href="#2942ab29289f1398" class="i method">EnumerateListProperty</a>&lt;<a href="../../../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#f14acfc7c48771f8" class="i field">DiscoveryFullyQualifiedModule</a>);
                <span class="r213 r">fullyQualifiedName</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../../../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;(<span class="r214 r">tmp</span>).<span class="i">ToArray</span>();
            }
 
            <b>object</b>[] <span id="r215 rd" class="r215 r">argumentList</span>;
            <b>if</b> (<a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e08e84167c3c5e56" class="i field">DiscoveryArgumentList</a>) != <b>null</b>)
            {
                <span class="i">IEnumerable</span>&lt;<b>object</b>&gt; <span id="r216 rd" class="r216 r">tmp</span> = <a href="#2942ab29289f1398" class="i method">EnumerateListProperty</a>&lt;<b>object</b>&gt;(<span class="r207 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e08e84167c3c5e56" class="i field">DiscoveryArgumentList</a>);
                <span class="r215 r">argumentList</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;(<span class="r216 r">tmp</span>).<span class="i">ToArray</span>();
            }
            <b>else</b>
            {
                <span class="r215 r">argumentList</span> = <b>null</b>;
            }
 
            <a href="../../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r217 rd" class="r217 r">powerShell</span> = <a href="../../../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../../../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>();
            <span class="r217 r">powerShell</span>.<a href="../../../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<span class="s">&quot;Get-Command&quot;</span>);
            <span class="r217 r">powerShell</span>.<a href="../../../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Name&quot;</span>, <span class="r209 r">name</span>);
            <span class="r217 r">powerShell</span>.<span class="i">AddParameter</span>(<span class="s">&quot;CommandType&quot;</span>, <span class="r208 r">commandType</span>);
            <b>if</b> (<span class="r213 r">fullyQualifiedName</span> != <b>null</b>)
            {
                <span class="r217 r">powerShell</span>.<a href="../../../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;FullyQualifiedModule&quot;</span>, <span class="r213 r">fullyQualifiedName</span>);
            }
            <b>else</b>
            {
                <span class="r217 r">powerShell</span>.<a href="../../../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Module&quot;</span>, <span class="r211 r">module</span>);
            }
 
            <span class="r217 r">powerShell</span>.<a href="../../../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;ArgumentList&quot;</span>, <span class="r215 r">argumentList</span>);
            <b>return</b> <span class="r217 r">powerShell</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the NoInput setting from the specified data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r218 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if there is no pipeline input; </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">false</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="de44bed8c407ba2a" href="../../../../R/de44bed8c407ba2a.html" target="n" data-glyph="74,1" class="i method">GetNoInput</a>(<b>object</b> <span id="r218 rd" class="r218 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r219 rd" class="r219 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r218 r">data</span>);
 
            <b>if</b> (<span class="r219 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r218 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r219 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#d78a7e4961153ea9" class="i field">NoInput</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the AddToHistory setting from the specified data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r220 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if there is addToHistory data; </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">false</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="f943310df99606a9" href="../../../../R/f943310df99606a9.html" target="n" data-glyph="74,1" class="i method">GetAddToHistory</a>(<b>object</b> <span id="r220 rd" class="r220 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r221 rd" class="r221 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r220 r">data</span>);
 
            <b>if</b> (<span class="r221 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r220 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r221 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#7d7028055bbc2472" class="i field">AddToHistory</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the IsNested setting from the specified data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r222 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if there is IsNested data; </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">false</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="67c6c2848047f6cb" href="../../../../R/67c6c2848047f6cb.html" target="n" data-glyph="74,1" class="i method">GetIsNested</a>(<b>object</b> <span id="r222 rd" class="r222 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r223 rd" class="r223 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r222 r">data</span>);
 
            <b>if</b> (<span class="r223 r">dataAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r222 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>bool</b>&gt;(<span class="r223 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#7465424b6b7a2bc8" class="i field">IsNested</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the invocation settings information from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r224 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">ApartmentState</span> <a id="c6e3f1b322a08163" href="../../../../R/c6e3f1b322a08163.html" target="n" data-glyph="74,1" class="i method">GetApartmentState</a>(<b>object</b> <span id="r224 rd" class="r224 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r225 rd" class="r225 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r224 r">data</span>);
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">ApartmentState</span>&gt;(<span class="r225 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#3832dcae8100c879" class="i field">ApartmentState</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the stream options from the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../../../hostifaces/PowerShell.cs.html#3a466dc47c692c8e" class="t t">RemoteStreamOptions</a> <a id="15573fad77d72377" href="../../../../R/15573fad77d72377.html" target="n" data-glyph="74,1" class="i method">GetRemoteStreamOptions</a>(<b>object</b> <span id="r226 rd" class="r226 r">data</span>)
        {
            <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r227 rd" class="r227 r">dataAsPSObject</span> = <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../../../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r226 r">data</span>);
            <b>return</b> <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="../../../hostifaces/PowerShell.cs.html#3a466dc47c692c8e" class="t t">RemoteStreamOptions</a>&gt;(<span class="r227 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#e97da4bcb97badb4" class="i field">RemoteStreamOptions</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decodes a RemoteSessionCapability object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">data</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Data to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RemoteSessionCapability object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="RemoteSessionCapability.cs.html#410d0e97ea446fd9" class="t t">RemoteSessionCapability</a> <a id="3c9069d4f153d7e0" href="../../../../R/3c9069d4f153d7e0.html" target="n" data-glyph="74,1" class="i method">GetSessionCapability</a>(<b>object</b> <span id="r228 rd" class="r228 r">data</span>)
        {
            <b>if</b> (!(<span class="r228 r">data</span> <b>is</b> <a href="../../../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r229 rd" class="r229 r">dataAsPSObject</span>))
            {
                <b>throw</b> <b>new</b> <span class="t">PSRemotingDataStructureException</span>(
                    <span class="i">RemotingErrorIdStrings</span>.<span class="i">CantCastRemotingDataToPSObject</span>, <span class="r228 r">data</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <span class="i">Version</span> <span id="r230 rd" class="r230 r">protocolVersion</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">Version</span>&gt;(<span class="r229 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#c416521156fef723" class="i field">PS_STARTUP_PROTOCOL_VERSION_NAME</a>);
            <span class="i">Version</span> <span id="r231 rd" class="r231 r">psVersion</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">Version</span>&gt;(<span class="r229 r">dataAsPSObject</span>, <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#09a93f00dbacc96b" class="i field">PSVersion</a>);
            <span class="i">Version</span> <span id="r232 rd" class="r232 r">serializationVersion</span> = <a href="#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<span class="i">Version</span>&gt;(<span class="r229 r">dataAsPSObject</span>,
                <a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#27d5b1b7d3362576" class="i field">SerializationVersion</a>);
 
            <a href="RemoteSessionCapability.cs.html#410d0e97ea446fd9" class="t t">RemoteSessionCapability</a> <span id="r233 rd" class="r233 r">result</span> = <b>new</b> <a href="RemoteSessionCapability.cs.html#bd631ced49af9931" class="t constructor">RemoteSessionCapability</a>(
                <a href="#45c72046001f69b8" class="t t">RemotingDestination</a>.<a href="#a5a39b4bf4f438ce" class="i field">InvalidDestination</a>,
                <span class="r230 r">protocolVersion</span>, <span class="r231 r">psVersion</span>, <span class="r232 r">serializationVersion</span>);
 
            <b>if</b> (<span class="r229 r">dataAsPSObject</span>.<a href="../../../MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="../../../MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><a href="#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="#f13438743b679ac0" class="i field">TimeZone</a>] != <b>null</b>)
            {
                <span class="c">// Binary deserialization of timezone info via BinaryFormatter is unsafe,</span>
                <span class="c">// so don&#39;t deserialize any untrusted client data using this API.</span>
                <span class="c">//</span>
                <span class="c">// In addition, the binary data being sent by the client doesn&#39;t represent</span>
                <span class="c">// the client&#39;s current TimeZone unless they somehow accessed the</span>
                <span class="c">// StandardName and DaylightName. These properties are initialized lazily</span>
                <span class="c">// by the .NET Framework, and would be populated by the server with local</span>
                <span class="c">// values anyways.</span>
                <span class="c">//</span>
                <span class="c">// So just return the CurrentTimeZone.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span> <span class="c">// TimeZone Not In CoreCLR</span>
<span class="e">                result.TimeZone = TimeZone.CurrentTimeZone;
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
 
            <b>return</b> <span class="r233 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks if the server supports batch invocation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r234 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if batch invocation is supported, false if not.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="3381c4820a7968c7" href="../../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ServerSupportsBatchInvocation</a>(<a href="../../../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r234 rd" class="r234 r">runspace</span>)
        {
            <b>if</b> (<span class="r234 r">runspace</span> == <b>null</b> || <span class="r234 r">runspace</span>.<a href="../../../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../../../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> == <a href="../../../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../../../hostifaces/Connection.cs.html#4e82723df10b13f6" class="i field">BeforeOpen</a>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> (<span class="r234 r">runspace</span>.<a href="../../../hostifaces/Connection.cs.html#4a6e6e16fd38fa86" class="i method">GetRemoteProtocolVersion</a>() &gt;= <a href="#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="#fd42c50dee2d8244" class="i field">ProtocolVersionWin8RTM</a>);
        }
    }
}
</pre></td></tr></table></div></body></html>
