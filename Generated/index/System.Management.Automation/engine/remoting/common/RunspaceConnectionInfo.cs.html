<!DOCTYPE html>
<html><head><title>RunspaceConnectionInfo.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(3642);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/remoting/common/RunspaceConnectionInfo.cs" target="_top">engine\remoting\common\RunspaceConnectionInfo.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>; <span class="c">// Win32Exception</span>
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Pipes</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Tracing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Net</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">Sockets</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">AccessControl</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>.<span class="i">SafeHandles</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
<b>using</b> <span class="t">WSManAuthenticationMechanism</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<span class="i n">Client</span>.<a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>;
 
<span class="c">// ReSharper disable CheckNamespace</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>
<span class="c">// ReSharper restore CheckNamespace</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Different Authentication Mechanisms supported by New-Runspace command to connect</span>
    <span class="c">///</span><span class="c"> to remote server.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1027:MarkEnumsWithFlags&quot;</span>)]
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1724:TypeNamesShouldNotMatchNamespaces&quot;</span>)]
    <b>public enum</b> <a id="f2f89adf00d05f44" href="../../../R/f2f89adf00d05f44.html" target="n" data-glyph="18,0" class="t t"><span id="efe3da89d6eb79f5">AuthenticationMechanism</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use the default authentication (as defined by the underlying protocol)</span>
        <span class="c">///</span><span class="c"> for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="aa044b4cbb803265" href="../../../R/aa044b4cbb803265.html" target="n" data-glyph="24,1" class="i field">Default</a> = 0x0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use Basic authentication for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="aa56bb950a6fa6df" href="../../../R/aa56bb950a6fa6df.html" target="n" data-glyph="24,1" class="i field">Basic</a> = 0x1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use Negotiate authentication for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e6aff575bfa34071" href="../../../R/e6aff575bfa34071.html" target="n" data-glyph="24,1" class="i field">Negotiate</a> = 0x2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use Negotiate authentication for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> Allow implicit credentials for Negotiate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="74bfa4513a99b381" href="../../../R/74bfa4513a99b381.html" target="n" data-glyph="24,1" class="i field">NegotiateWithImplicitCredential</a> = 0x3,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use CredSSP authentication for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Credssp&quot;</span>)]
        <a id="c657d2680f8f48a8" href="../../../R/c657d2680f8f48a8.html" target="n" data-glyph="24,1" class="i field">Credssp</a> = 0x4,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use Digest authentication mechanism. Digest authentication operates much</span>
        <span class="c">///</span><span class="c"> like Basic authentication. However, unlike Basic authentication, Digest authentication</span>
        <span class="c">///</span><span class="c"> transmits credentials across the network as a hash value, also known as a message digest.</span>
        <span class="c">///</span><span class="c"> The user name and password cannot be deciphered from the hash value. Conversely, Basic</span>
        <span class="c">///</span><span class="c"> authentication sends a Base 64 encoded password, essentially in clear text, across the</span>
        <span class="c">///</span><span class="c"> network.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7094d14a65d8f900" href="../../../R/7094d14a65d8f900.html" target="n" data-glyph="24,1" class="i field">Digest</a> = 0x5,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use Kerberos authentication for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b2d61e2011af528f" href="../../../R/b2d61e2011af528f.html" target="n" data-glyph="24,1" class="i field">Kerberos</a> = 0x6,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Specify the type of access mode that should be</span>
    <span class="c">///</span><span class="c"> used when creating a session configuration.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="10edf62c3f6a89b0" href="../../../R/10edf62c3f6a89b0.html" target="n" data-glyph="18,0" class="t t"><span id="deaade7ffe9a4085">PSSessionConfigurationAccessMode</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disable the configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="43e3b9106e6c81f0" href="../../../R/43e3b9106e6c81f0.html" target="n" data-glyph="24,1" class="i field">Disabled</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allow local access.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e493a77e156a2d8d" href="../../../R/e493a77e156a2d8d.html" target="n" data-glyph="24,1" class="i field">Local</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default allow remote access.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f9938a92bb1a8e5f" href="../../../R/f9938a92bb1a8e5f.html" target="n" data-glyph="24,1" class="i field">Remote</a> = 2,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> WSManTransportManager supports disconnected PowerShell sessions.</span>
    <span class="c">///</span><span class="c"> When a remote PS session server is in disconnected state, output</span>
    <span class="c">///</span><span class="c"> from the running command pipeline is cached on the server.  This</span>
    <span class="c">///</span><span class="c"> enum determines what the server does when the cache is full.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="9cb40ac520a09a1d" href="../../../R/9cb40ac520a09a1d.html" target="n" data-glyph="18,0" class="t t"><span id="41932f70f853cfed">OutputBufferingMode</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No output buffering mode specified.  Output buffering mode on server will</span>
        <span class="c">///</span><span class="c"> default to Block if a new session is created, or will retain its current</span>
        <span class="c">///</span><span class="c"> mode for non-creation scenarios (e.g., disconnect/connect operations).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="bc0e18b29515f03e" href="../../../R/bc0e18b29515f03e.html" target="n" data-glyph="24,1" class="i field">None</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command pipeline execution continues, excess output is dropped in FIFO manner.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ffb9892e18d7c551" href="../../../R/ffb9892e18d7c551.html" target="n" data-glyph="24,1" class="i field">Drop</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Command pipeline execution on server is blocked until session is reconnected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1973173f1a07408a" href="../../../R/1973173f1a07408a.html" target="n" data-glyph="24,1" class="i field">Block</a> = 2
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class which defines connection path to a remote runspace</span>
    <span class="c">///</span><span class="c"> that needs to be created. Transport specific connection</span>
    <span class="c">///</span><span class="c"> paths will be derived from this.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="e07ed56a8a1da829" href="../../../R/e07ed56a8a1da829.html" target="n" data-glyph="0,0" class="t t"><span id="0c07fbc539b07219">RunspaceConnectionInfo</span></a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the computer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract string</b> <a id="64143b41c05cd7ea" href="../../../R/64143b41c05cd7ea.html" target="n" data-glyph="102,1" class="i property">ComputerName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential used for the connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="a6344cc76011848b" href="../../../R/a6344cc76011848b.html" target="n" data-glyph="102,1" class="i property">Credential</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication mechanism to use while connecting to the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="e3478dfa8d79dd94" href="../../../R/e3478dfa8d79dd94.html" target="n" data-glyph="102,1" class="i property">AuthenticationMechanism</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ThumbPrint of a certificate used for connecting to a remote machine.</span>
        <span class="c">///</span><span class="c"> When this is specified, you dont need to supply credential and authentication</span>
        <span class="c">///</span><span class="c"> mechanism.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract string</b> <a id="849442bb4db4c66e" href="../../../R/849442bb4db4c66e.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Culture that the remote session should use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CultureInfo</span> <a id="237e4765cd52489b" href="../../../R/237e4765cd52489b.html" target="n" data-glyph="102,1" class="i property">Culture</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#0bc7a81c0c01424f" class="i field">_culture</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<span class="s">&quot;value&quot;</span>);
                }
 
                <a href="#0bc7a81c0c01424f" class="i field">_culture</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">CultureInfo</span> <a id="0bc7a81c0c01424f" href="../../../R/0bc7a81c0c01424f.html" target="n" data-glyph="46,1" class="i field">_culture</a> = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> UI culture that the remote session should use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CultureInfo</span> <a id="27251d0ea7ef6aba" href="../../../R/27251d0ea7ef6aba.html" target="n" data-glyph="102,1" class="i property">UICulture</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5311de082184bfb0" class="i field">_uiCulture</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<span class="s">&quot;value&quot;</span>);
                }
 
                <a href="#5311de082184bfb0" class="i field">_uiCulture</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">CultureInfo</span> <a id="5311de082184bfb0" href="../../../R/5311de082184bfb0.html" target="n" data-glyph="46,1" class="i field">_uiCulture</a> = <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration (in ms) for which PowerShell remoting waits before timing out on a connection to a remote machine.</span>
        <span class="c">///</span><span class="c"> Simply put, the timeout for a remote runspace creation.</span>
        <span class="c">///</span><span class="c"> The administrator would like to tweak this timeout depending on whether</span>
        <span class="c">///</span><span class="c"> he/she is connecting to a machine in the data center or across a slow WAN.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="a0a3c947f4d2fe9e" href="../../../R/a0a3c947f4d2fe9e.html" target="n" data-glyph="102,1" class="i property">OpenTimeout</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#1112894651000e58" class="i field">_openTimeout</a>;
            }
 
            <b>set</b>
            {
                <a href="#1112894651000e58" class="i field">_openTimeout</a> = <b>value</b>;
 
                <b>if</b> (<a href="#e07ed56a8a1da829" class="k">this</a> <b>is</b> <a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> &amp;&amp; <a href="#1112894651000e58" class="i field">_openTimeout</a> == <a href="#578ade315f39c1e2" class="i field">DefaultTimeout</a>)
                {
                    <a href="#1112894651000e58" class="i field">_openTimeout</a> = <a href="#9e72edbf25d16225" class="i field">DefaultOpenTimeout</a>;
                }
                <b>else</b> <b>if</b> (<a href="#e07ed56a8a1da829" class="k">this</a> <b>is</b> <a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> &amp;&amp; <a href="#1112894651000e58" class="i field">_openTimeout</a> == <a href="#601432ff72364293" class="i field">InfiniteTimeout</a>)
                {
                    <span class="c">// this timeout value gets passed to a</span>
                    <span class="c">// timer associated with the session</span>
                    <span class="c">// data structure handler state machine.</span>
                    <span class="c">// The timer constructor will throw an exception</span>
                    <span class="c">// for any value greater than Int32.MaxValue</span>
                    <span class="c">// hence this is the maximum possible limit</span>
                    <a href="#1112894651000e58" class="i field">_openTimeout</a> = <span class="i">Int32</span>.<span class="i">MaxValue</span>;
                }
            }
        }
 
        <b>private int</b> <a id="1112894651000e58" href="../../../R/1112894651000e58.html" target="n" data-glyph="46,1" class="i field">_openTimeout</a> = <a href="#9e72edbf25d16225" class="i field">DefaultOpenTimeout</a>;
 
        <b>internal const int</b> <a id="9e72edbf25d16225" href="../../../R/9e72edbf25d16225.html" target="n" data-glyph="8,1" class="i field">DefaultOpenTimeout</a> = 3 * 60 * 1000; <span class="c">// 3 minutes</span>
        <b>internal const int</b> <a id="578ade315f39c1e2" href="../../../R/578ade315f39c1e2.html" target="n" data-glyph="8,1" class="i field">DefaultTimeout</a> = -1;
        <b>internal const int</b> <a id="601432ff72364293" href="../../../R/601432ff72364293.html" target="n" data-glyph="8,1" class="i field">InfiniteTimeout</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration (in ms) for which PowerShell should wait before it times out on cancel operations</span>
        <span class="c">///</span><span class="c"> (close runspace or stop powershell). For instance, when the user hits ctrl-C,</span>
        <span class="c">///</span><span class="c"> New-PSSession cmdlet tries to call a stop on all remote runspaces which are in the Opening state.</span>
        <span class="c">///</span><span class="c"> The administrator wouldn&#39;t mind waiting for 15 seconds, but this should be time bound and of a shorter duration.</span>
        <span class="c">///</span><span class="c"> A high timeout here like 3 minutes will give the administrator a feeling that the PowerShell client is not responding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="b136d8269dabb6c4" href="../../../R/b136d8269dabb6c4.html" target="n" data-glyph="102,1" class="i property">CancelTimeout</a> { <b>get</b>; <b>set</b>; } = <a href="#4d69c2aded3f6ac6" class="i field">defaultCancelTimeout</a>;
 
        <b>internal const int</b> <a id="4d69c2aded3f6ac6" href="../../../R/4d69c2aded3f6ac6.html" target="n" data-glyph="8,1" class="i field">defaultCancelTimeout</a> = <a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#15e8994ab378fbdd" class="i field">ClientCloseTimeoutMs</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration for which PowerShell remoting waits before timing out</span>
        <span class="c">///</span><span class="c"> for any operation. The user would like to tweak this timeout</span>
        <span class="c">///</span><span class="c"> depending on whether he/she is connecting to a machine in the data</span>
        <span class="c">///</span><span class="c"> center or across a slow WAN.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Default: 3*60*1000 == 3minutes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="53cee291a23086f5" href="../../../R/53cee291a23086f5.html" target="n" data-glyph="102,1" class="i property">OperationTimeout</a> { <b>get</b>; <b>set</b>; } = <a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#21a6ee26ace3693f" class="i field">ClientDefaultOperationTimeoutMs</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The duration (in ms) for which a Runspace on server needs to wait before it declares the client dead and closes itself down.</span>
        <span class="c">///</span><span class="c"> This is especially important as these values may have to be configured differently for enterprise administration</span>
        <span class="c">///</span><span class="c"> and exchange scenarios.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="0c117c8cb5b1de8b" href="../../../R/0c117c8cb5b1de8b.html" target="n" data-glyph="102,1" class="i property">IdleTimeout</a> { <b>get</b>; <b>set</b>; } = <a href="#ccd4b365c71a8e3a" class="i field">DefaultIdleTimeout</a>;
 
        <b>internal const int</b> <a id="ccd4b365c71a8e3a" href="../../../R/ccd4b365c71a8e3a.html" target="n" data-glyph="8,1" class="i field">DefaultIdleTimeout</a> = <a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#1aeb21f2c249b1c1" class="i field">UseServerDefaultIdleTimeout</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The maximum allowed idle timeout duration (in ms) that can be set on a Runspace.  This is a read-only property</span>
        <span class="c">///</span><span class="c"> that is set once the Runspace is successfully created and opened.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="8f5fff031b021f8b" href="../../../R/8f5fff031b021f8b.html" target="n" data-glyph="102,1" class="i property">MaxIdleTimeout</a> { <b>get</b>; <b>internal set</b>; } = <span class="i">Int32</span>.<span class="i">MaxValue</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Populates session options from a PSSessionOption instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="3dbde5e0af345257" href="../../../R/3dbde5e0af345257.html" target="n" data-glyph="72,1" class="i method">SetSessionOptions</a>(<a href="../commands/PSRemotingCmdlet.cs.html#8626ee928362b305" class="t t">PSSessionOption</a> <span id="r0 rd" class="r0 r">options</span>)
        {
            <b>if</b> (<span class="r0 r">options</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r0 r">options</span>));
            }
 
            <b>if</b> (<span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#6c50153de319204f" class="i property">Culture</a> != <b>null</b>)
            {
                <a href="#e07ed56a8a1da829" class="k">this</a>.<a href="#237e4765cd52489b" class="i property">Culture</a> = <span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#6c50153de319204f" class="i property">Culture</a>;
            }
 
            <b>if</b> (<span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#17de5256f95a13f0" class="i property">UICulture</a> != <b>null</b>)
            {
                <a href="#e07ed56a8a1da829" class="k">this</a>.<a href="#27251d0ea7ef6aba" class="i property">UICulture</a> = <span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#17de5256f95a13f0" class="i property">UICulture</a>;
            }
 
            <a href="#1112894651000e58" class="i field">_openTimeout</a> = <a href="#8610c3ac650d1d18" class="i method">TimeSpanToTimeOutMs</a>(<span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#9a175c6e14dd145c" class="i property">OpenTimeout</a>);
            <a href="#b136d8269dabb6c4" class="i property">CancelTimeout</a> = <a href="#8610c3ac650d1d18" class="i method">TimeSpanToTimeOutMs</a>(<span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#b5da140f3b9891e8" class="i property">CancelTimeout</a>);
            <a href="#53cee291a23086f5" class="i property">OperationTimeout</a> = <a href="#8610c3ac650d1d18" class="i method">TimeSpanToTimeOutMs</a>(<span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#1c7eb8442453b9b7" class="i property">OperationTimeout</a>);
 
            <span class="c">// Special case for idle timeout.  A value of milliseconds == -1</span>
            <span class="c">// (BaseTransportManager.UseServerDefaultIdleTimeout) is allowed for</span>
            <span class="c">// specifying the default value on the server.</span>
            <a href="#0c117c8cb5b1de8b" class="i property">IdleTimeout</a> = (<span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#42111d69f31e90b0" class="i property">IdleTimeout</a>.<span class="i">TotalMilliseconds</span> &gt;= <a href="../fanin/BaseTransportManager.cs.html#9ccd7ea4a824f9d8" class="t t">BaseTransportManager</a>.<a href="../fanin/BaseTransportManager.cs.html#1aeb21f2c249b1c1" class="i field">UseServerDefaultIdleTimeout</a> &amp;&amp;
                                <span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#42111d69f31e90b0" class="i property">IdleTimeout</a>.<span class="i">TotalMilliseconds</span> &lt; <b>int</b>.<span class="i">MaxValue</span>)
                                ? (<b>int</b>)(<span class="r0 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#42111d69f31e90b0" class="i property">IdleTimeout</a>.<span class="i">TotalMilliseconds</span>) : <b>int</b>.<span class="i">MaxValue</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <b>internal int</b> <a id="8610c3ac650d1d18" href="../../../R/8610c3ac650d1d18.html" target="n" data-glyph="74,1" class="i method">TimeSpanToTimeOutMs</a>(<span class="i">TimeSpan</span> <span id="r1 rd" class="r1 r">t</span>)
        {
            <b>if</b> ((<span class="r1 r">t</span>.<span class="i">TotalMilliseconds</span> &gt; <b>int</b>.<span class="i">MaxValue</span>) || (<span class="r1 r">t</span> == <span class="i">TimeSpan</span>.<span class="i">MaxValue</span>) || (<span class="r1 r">t</span>.<span class="i">TotalMilliseconds</span> &lt; 0))
            {
                <b>return</b> <b>int</b>.<span class="i">MaxValue</span>;
            }
            <b>else</b>
            {
                <b>return</b> (<b>int</b>)(<span class="r1 r">t</span>.<span class="i">TotalMilliseconds</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates the appropriate client session transportmanager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace/Pool instance Id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">sessionName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Session name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">cryptoHelper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSRemotingCryptoHelper.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="../fanin/BaseTransportManager.cs.html#19883ec4df424177" class="t t">BaseClientSessionTransportManager</a> <a id="77794e475b9232e2" href="../../../R/77794e475b9232e2.html" target="n" data-glyph="74,1" class="i method">CreateClientSessionTransportManager</a>(
            <span class="i">Guid</span> <span id="r2 rd" class="r2 r">instanceId</span>,
            <b>string</b> <span id="r3 rd" class="r3 r">sessionName</span>,
            <a href="../../../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r4 rd" class="r4 r">cryptoHelper</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a copy of the connection info object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Copy of the connection info object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="54d6b570b04d9a9d" href="../../../R/54d6b570b04d9a9d.html" target="n" data-glyph="74,1" class="i method">InternalCopy</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validates port number is in range.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Port number to validate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="eacd5680e184efc2" href="../../../R/eacd5680e184efc2.html" target="n" data-glyph="74,1" class="i method">ValidatePortInRange</a>(<b>int</b> <span id="r5 rd" class="r5 r">port</span>)
        {
            <b>if</b> ((<span class="r5 r">port</span> &lt; <a href="#baa11715043b24e2" class="i field">MinPort</a> || <span class="r5 r">port</span> &gt; <a href="#417645d490dc8be9" class="i field">MaxPort</a>))
            {
                <b>string</b> <span id="r6 rd" class="r6 r">message</span> =
                    <a href="remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                        <span class="i">RemotingErrorIdStrings</span>.<span class="i">PortIsOutOfRange</span>, <span class="r5 r">port</span>);
                <span class="i">ArgumentException</span> <span id="r7 rd" class="r7 r">e</span> = <b>new</b> <span class="i">ArgumentException</span>(<span class="r6 r">message</span>);
                <b>throw</b> <span class="r7 r">e</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constants
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum value for port.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const int</b> <a id="417645d490dc8be9" href="../../../R/417645d490dc8be9.html" target="n" data-glyph="9,1" class="i field">MaxPort</a> = 0xFFFF;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Minimum value for port.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected const int</b> <a id="baa11715043b24e2" href="../../../R/baa11715043b24e2.html" target="n" data-glyph="9,1" class="i field">MinPort</a> = 0;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class which defines path to a remote runspace that</span>
    <span class="c">///</span><span class="c"> need to be created.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="2d9d176ef419be5a" href="../../../R/2d9d176ef419be5a.html" target="n" data-glyph="0,0" class="t t">WSManConnectionInfo</a> : <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Uri associated with this connection path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Uri</span> <a id="eb73ffdb9b586505" href="../../../R/eb73ffdb9b586505.html" target="n" data-glyph="102,1" class="i property">ConnectionUri</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#545b11518663a4f5" class="i field">_connectionUri</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;value&quot;</span>);
                }
 
                <a href="#a6a68cb51e881ba8" class="i method">UpdateUri</a>(<b>value</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the computer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="74b71e9668d24a47" href="../../../R/74b71e9668d24a47.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// null or empty value allowed</span>
                <a href="#e5fa321e4a1d7018" class="i method">ConstructUri</a>(<a href="#0c84c8b49a6e655a" class="i field">_scheme</a>, <b>value</b>, <b>null</b>, <a href="#2cadd1529bfb67f5" class="i field">_appName</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Scheme used for connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="d29b8b073c4a8931" href="../../../R/d29b8b073c4a8931.html" target="n" data-glyph="102,1" class="i property">Scheme</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#0c84c8b49a6e655a" class="i field">_scheme</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// null or empty value allowed</span>
                <a href="#e5fa321e4a1d7018" class="i method">ConstructUri</a>(<b>value</b>, <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>, <b>null</b>, <a href="#2cadd1529bfb67f5" class="i field">_appName</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Port in which to connect.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="1aeb2cc802b3a879" href="../../../R/1aeb2cc802b3a879.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#eb73ffdb9b586505" class="i property">ConnectionUri</a>.<span class="i">Port</span>;
            }
 
            <b>set</b>
            {
                <a href="#e5fa321e4a1d7018" class="i method">ConstructUri</a>(<a href="#0c84c8b49a6e655a" class="i field">_scheme</a>, <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>, <b>value</b>, <a href="#2cadd1529bfb67f5" class="i field">_appName</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> AppName which identifies the connection</span>
        <span class="c">///</span><span class="c"> end point in the machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="0757157b257825db" href="../../../R/0757157b257825db.html" target="n" data-glyph="102,1" class="i property">AppName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2cadd1529bfb67f5" class="i field">_appName</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// null or empty value allowed</span>
                <a href="#e5fa321e4a1d7018" class="i method">ConstructUri</a>(<a href="#0c84c8b49a6e655a" class="i field">_scheme</a>, <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>, <b>null</b>, <b>value</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential used for the connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="5a783a782d2a0c8e" href="../../../R/5a783a782d2a0c8e.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#19e61e61912964b7" class="i field">_credential</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// null or empty value allowed</span>
                <a href="#19e61e61912964b7" class="i field">_credential</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1056:UriPropertiesShouldNotBeStrings&quot;</span>, <span class="i">Scope</span> = <span class="s">&quot;member&quot;</span>, <span class="i">Target</span> = <span class="s">&quot;System.Management.Automation.Runspaces.WSManConnectionInfo.#ShellUri&quot;</span>)]
        <b>public string</b> <a id="a0ee4c890acec948" href="../../../R/a0ee4c890acec948.html" target="n" data-glyph="102,1" class="i property">ShellUri</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8b63f4e1bf406a50" class="i field">_shellUri</a>;
            }
 
            <b>set</b>
            {
                <a href="#8b63f4e1bf406a50" class="i field">_shellUri</a> = <a href="#74e756df103ff3dd" class="i method">ResolveShellUri</a>(<b>value</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication mechanism to use while connecting to the server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="e1a2e5b5a5d08c41" href="../../../R/e1a2e5b5a5d08c41.html" target="n" data-glyph="102,1" class="i property">AuthenticationMechanism</a>
        {
            <b>get</b>
            {
                <b>switch</b> (<a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a>)
                {
                    <b>case</b> <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#5125eb68ec11fa36" class="i field">WSMAN_FLAG_DEFAULT_AUTHENTICATION</a>:
                        <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
                    <b>case</b> <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#6b8867a7b5d205f8" class="i field">WSMAN_FLAG_AUTH_BASIC</a>:
                        <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa56bb950a6fa6df" class="i field">Basic</a>;
                    <b>case</b> <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#8dec40fd9e94f6a6" class="i field">WSMAN_FLAG_AUTH_CREDSSP</a>:
                        <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#c657d2680f8f48a8" class="i field">Credssp</a>;
                    <b>case</b> <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#61cf55ffef78b4ea" class="i field">WSMAN_FLAG_AUTH_NEGOTIATE</a>:
                        <b>if</b> (<a href="#1e6f82bf70a3e647" class="i property">AllowImplicitCredentialForNegotiate</a>)
                        {
                            <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#74bfa4513a99b381" class="i field">NegotiateWithImplicitCredential</a>;
                        }
 
                        <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#e6aff575bfa34071" class="i field">Negotiate</a>;
                    <b>case</b> <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#10e08ad953e87fcb" class="i field">WSMAN_FLAG_AUTH_DIGEST</a>:
                        <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#7094d14a65d8f900" class="i field">Digest</a>;
                    <b>case</b> <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#94e632795727ce62" class="i field">WSMAN_FLAG_AUTH_KERBEROS</a>:
                        <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#b2d61e2011af528f" class="i field">Kerberos</a>;
                    <b>default</b>:
                        <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Invalid authentication mechanism detected.&quot;</span>);
                        <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
                }
            }
 
            <b>set</b>
            {
                <b>switch</b> (<b>value</b>)
                {
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>:
                        <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#5125eb68ec11fa36" class="i field">WSMAN_FLAG_DEFAULT_AUTHENTICATION</a>;
                        <b>break</b>;
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa56bb950a6fa6df" class="i field">Basic</a>:
                        <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#6b8867a7b5d205f8" class="i field">WSMAN_FLAG_AUTH_BASIC</a>;
                        <b>break</b>;
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#e6aff575bfa34071" class="i field">Negotiate</a>:
                        <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#61cf55ffef78b4ea" class="i field">WSMAN_FLAG_AUTH_NEGOTIATE</a>;
                        <b>break</b>;
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#74bfa4513a99b381" class="i field">NegotiateWithImplicitCredential</a>:
                        <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#61cf55ffef78b4ea" class="i field">WSMAN_FLAG_AUTH_NEGOTIATE</a>;
                        <a href="#1e6f82bf70a3e647" class="i property">AllowImplicitCredentialForNegotiate</a> = <b>true</b>;
                        <b>break</b>;
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#c657d2680f8f48a8" class="i field">Credssp</a>:
                        <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#8dec40fd9e94f6a6" class="i field">WSMAN_FLAG_AUTH_CREDSSP</a>;
                        <b>break</b>;
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#7094d14a65d8f900" class="i field">Digest</a>:
                        <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#10e08ad953e87fcb" class="i field">WSMAN_FLAG_AUTH_DIGEST</a>;
                        <b>break</b>;
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#b2d61e2011af528f" class="i field">Kerberos</a>:
                        <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#94e632795727ce62" class="i field">WSMAN_FLAG_AUTH_KERBEROS</a>;
                        <b>break</b>;
                    <b>default</b>:
                        <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
                }
 
                <a href="#8003c8854b1dfb31" class="i method">ValidateSpecifiedAuthentication</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> AuthenticationMechanism converted to WSManAuthenticationMechanism type.</span>
        <span class="c">///</span><span class="c"> This is internal.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a> <a id="fb303a9867ec0b83" href="../../../R/fb303a9867ec0b83.html" target="n" data-glyph="104,1" class="i property">WSManAuthenticationMechanism</a> { <b>get</b>; <b>private set</b>; } = <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#5125eb68ec11fa36" class="i field">WSMAN_FLAG_DEFAULT_AUTHENTICATION</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allow default credentials for Negotiate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="1e6f82bf70a3e647" href="../../../R/1e6f82bf70a3e647.html" target="n" data-glyph="104,1" class="i property">AllowImplicitCredentialForNegotiate</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the actual port property value and not the ConnectionUri port.</span>
        <span class="c">///</span><span class="c"> Internal only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="bf1ee40cfa31bba1" href="../../../R/bf1ee40cfa31bba1.html" target="n" data-glyph="104,1" class="i property">PortSetting</a> { <b>get</b>; <b>private set</b>; } = -1;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ThumbPrint of a certificate used for connecting to a remote machine.</span>
        <span class="c">///</span><span class="c"> When this is specified, you dont need to supply credential and authentication</span>
        <span class="c">///</span><span class="c"> mechanism.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="4589105955753e41" href="../../../R/4589105955753e41.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#963949f28fbc1ed8" class="i field">_thumbPrint</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <b>null</b>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;value&quot;</span>);
                }
 
                <a href="#963949f28fbc1ed8" class="i field">_thumbPrint</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum uri redirection count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="21431be8484ed16e" href="../../../R/21431be8484ed16e.html" target="n" data-glyph="102,1" class="i property">MaximumConnectionRedirectionCount</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal const int</b> <a id="b1d6f002297a7835" href="../../../R/b1d6f002297a7835.html" target="n" data-glyph="8,1" class="i field">defaultMaximumConnectionRedirectionCount</a> = 5;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Total data (in bytes) that can be received from a remote machine</span>
        <span class="c">///</span><span class="c"> targeted towards a command. If null, then the size is unlimited.</span>
        <span class="c">///</span><span class="c"> Default is unlimited data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b>? <a id="acb325002c1b0d2a" href="../../../R/acb325002c1b0d2a.html" target="n" data-glyph="102,1" class="i property">MaximumReceivedDataSizePerCommand</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum size (in bytes) of a deserialized object received from a remote machine.</span>
        <span class="c">///</span><span class="c"> If null, then the size is unlimited. Default is unlimited object size.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b>? <a id="72cfe9a0c294ec04" href="../../../R/72cfe9a0c294ec04.html" target="n" data-glyph="102,1" class="i property">MaximumReceivedObjectSize</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, underlying WSMan infrastructure will compress data sent on the network.</span>
        <span class="c">///</span><span class="c"> If false, data will not be compressed. Compression improves performance by</span>
        <span class="c">///</span><span class="c"> reducing the amount of data sent on the network. Compression my require extra</span>
        <span class="c">///</span><span class="c"> memory consumption and CPU usage. In cases where available memory / CPU is less,</span>
        <span class="c">///</span><span class="c"> set this property to false.</span>
        <span class="c">///</span><span class="c"> By default the value of this property is &quot;true&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="1ec52b9b453e24eb" href="../../../R/1ec52b9b453e24eb.html" target="n" data-glyph="102,1" class="i property">UseCompression</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> then Operating System won&#39;t load the user profile (i.e. registry keys under HKCU) on the remote server</span>
        <span class="c">///</span><span class="c"> which can result in a faster session creation time.  This option won&#39;t have any effect if the remote machine has</span>
        <span class="c">///</span><span class="c"> already loaded the profile (i.e. in another session).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="c6c54cb9078f2a4c" href="../../../R/c6c54cb9078f2a4c.html" target="n" data-glyph="102,1" class="i property">NoMachineProfile</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">// BEGIN: Session Options</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> By default, wsman uses IEConfig - the current user</span>
        <span class="c">///</span><span class="c">  Internet Explorer proxy settings for the current active network connection.</span>
        <span class="c">///</span><span class="c">  This option requires the user profile to be loaded, so the option can</span>
        <span class="c">///</span><span class="c">  be directly used when called within a process that is running under</span>
        <span class="c">///</span><span class="c">  an interactive user account identity; if the client application is running</span>
        <span class="c">///</span><span class="c">  under a user context different then the interactive user, the client</span>
        <span class="c">///</span><span class="c">  application has to explicitly load the user profile prior to using this option.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> IMPORTANT: proxy configuration is supported for HTTPS only; for HTTP, the direct</span>
        <span class="c">///</span><span class="c"> connection to the server is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a> <a id="9845f779385f9669" href="../../../R/9845f779385f9669.html" target="n" data-glyph="102,1" class="i property">ProxyAccessType</a> { <b>get</b>; <b>set</b>; } = <a href="../commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a>.<a href="../commands/PSRemotingCmdlet.cs.html#b8abe0a20c41194e" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ProxyAuthentication&quot;.</span>
        <span class="c">///</span><span class="c"> This parameter takes a set of authentication methods the user can select</span>
        <span class="c">///</span><span class="c"> from.  The available options should be as follows:</span>
        <span class="c">///</span><span class="c"> - Negotiate: Use the default authentication (ad defined by the underlying</span>
        <span class="c">///</span><span class="c"> protocol) for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> - Basic:  Use basic authentication for establishing a remote connection</span>
        <span class="c">///</span><span class="c"> - Digest: Use Digest authentication for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="d95258451cb68b3b" href="../../../R/d95258451cb68b3b.html" target="n" data-glyph="102,1" class="i property">ProxyAuthentication</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#cae4dfdb4fcbfb26" class="i field">_proxyAuthentication</a>;
            }
 
            <b>set</b>
            {
                <b>switch</b> (<b>value</b>)
                {
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa56bb950a6fa6df" class="i field">Basic</a>:
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#e6aff575bfa34071" class="i field">Negotiate</a>:
                    <b>case</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#7094d14a65d8f900" class="i field">Digest</a>:
                        <a href="#cae4dfdb4fcbfb26" class="i field">_proxyAuthentication</a> = <b>value</b>;
                        <b>break</b>;
                    <b>default</b>:
                        <b>string</b> <span id="r8 rd" class="r8 r">message</span> = <a href="remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ProxyAmbiguousAuthentication</span>,
                            <b>value</b>,
                            <b>nameof</b>(<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa56bb950a6fa6df" class="i field">Basic</a>),
                            <b>nameof</b>(<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#e6aff575bfa34071" class="i field">Negotiate</a>),
                            <b>nameof</b>(<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#7094d14a65d8f900" class="i field">Digest</a>));
                        <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r8 r">message</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ProxyCredential&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="b90c1ed41e87c2ea" href="../../../R/b90c1ed41e87c2ea.html" target="n" data-glyph="102,1" class="i property">ProxyCredential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#17e2532f89ede78c" class="i field">_proxyCredential</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<a href="#9845f779385f9669" class="i property">ProxyAccessType</a> == <a href="../commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a>.<a href="../commands/PSRemotingCmdlet.cs.html#b8abe0a20c41194e" class="i field">None</a>)
                {
                    <b>string</b> <span id="r9 rd" class="r9 r">message</span> = <a href="remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ProxyCredentialWithoutAccess</span>,
                                <a href="../commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a>.<a href="../commands/PSRemotingCmdlet.cs.html#b8abe0a20c41194e" class="i field">None</a>);
                    <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r9 r">message</span>);
                }
 
                <a href="#17e2532f89ede78c" class="i field">_proxyCredential</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When connecting over HTTPS, the client does not validate that the server</span>
        <span class="c">///</span><span class="c"> certificate is signed by a trusted certificate authority (CA). Use only when</span>
        <span class="c">///</span><span class="c"> the remote computer is trusted by other means, for example, if the remote</span>
        <span class="c">///</span><span class="c"> computer is part of a network that is physically secure and isolated or the</span>
        <span class="c">///</span><span class="c"> remote computer is listed as a trusted host in WinRM configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="1a6db05682add6a0" href="../../../R/1a6db05682add6a0.html" target="n" data-glyph="102,1" class="i property">SkipCACheck</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that certificate common name (CN) of the server need not match the</span>
        <span class="c">///</span><span class="c"> hostname of the server. Used only in remote operations using https. This</span>
        <span class="c">///</span><span class="c"> option should only be used for trusted machines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="62a5656f8055cfb5" href="../../../R/62a5656f8055cfb5.html" target="n" data-glyph="102,1" class="i property">SkipCNCheck</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that certificate common name (CN) of the server need not match the</span>
        <span class="c">///</span><span class="c"> hostname of the server. Used only in remote operations using https. This</span>
        <span class="c">///</span><span class="c"> option should only be used for trusted machines.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="db5f31fe8eaa8600" href="../../../R/db5f31fe8eaa8600.html" target="n" data-glyph="102,1" class="i property">SkipRevocationCheck</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies that no encryption will be used when doing remote operations over</span>
        <span class="c">///</span><span class="c"> http. Unencrypted traffic is not allowed by default and must be enabled in</span>
        <span class="c">///</span><span class="c"> the local configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="14ce6561582cbf9c" href="../../../R/14ce6561582cbf9c.html" target="n" data-glyph="102,1" class="i property">NoEncryption</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates the request is encoded in UTF16 format rather than UTF8 format;</span>
        <span class="c">///</span><span class="c"> UTF8 is the default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;UTF&quot;</span>)]
        <b>public bool</b> <a id="9b6f0e89a27da3f2" href="../../../R/9b6f0e89a27da3f2.html" target="n" data-glyph="102,1" class="i property">UseUTF16</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">// END: Session Options</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines how server in disconnected state deals with cached output</span>
        <span class="c">///</span><span class="c"> data when the cache becomes filled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#9cb40ac520a09a1d" class="t t">OutputBufferingMode</a> <a id="10ef35a810ea13c2" href="../../../R/10ef35a810ea13c2.html" target="n" data-glyph="102,1" class="i property">OutputBufferingMode</a> { <b>get</b>; <b>set</b>; } = <a href="#b7ca59070aaef7b2" class="i field">DefaultOutputBufferingMode</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Uses Service Principal Name (SPN) along with the Port number during authentication.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SPN&quot;</span>)]
        <b>public bool</b> <a id="7c39032b57cd7818" href="../../../R/7c39032b57cd7818.html" target="n" data-glyph="102,1" class="i property">IncludePortInSPN</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When true and in loopback scenario (localhost) this enables creation of WSMan</span>
        <span class="c">///</span><span class="c"> host process with the user interactive token, allowing PowerShell script network access,</span>
        <span class="c">///</span><span class="c"> i.e., allows going off box.  When this property is true and a PSSession is disconnected,</span>
        <span class="c">///</span><span class="c"> reconnection is allowed only if reconnecting from a PowerShell session on the same box.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="bccff2b013731c62" href="../../../R/bccff2b013731c62.html" target="n" data-glyph="102,1" class="i property">EnableNetworkAccess</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the maximum number of connection retries if previous connection attempts fail</span>
        <span class="c">///</span><span class="c"> due to network issues.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="bab09f8d743ff058" href="../../../R/bab09f8d743ff058.html" target="n" data-glyph="102,1" class="i property">MaxConnectionRetryCount</a> { <b>get</b>; <b>set</b>; } = <a href="#a48dd5dc791ed867" class="i field">DefaultMaxConnectionRetryCount</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used to create a WSManConnectionInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Computer to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">scheme</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Scheme to be used for connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Port to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">appName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Application end point to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">shellUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">remote shell to launch</span>
        <span class="c">///</span><span class="c"> on connection</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">credential to be used</span>
        <span class="c">///</span><span class="c"> for connection</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">openTimeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Timeout in milliseconds for open</span>
        <span class="c">///</span><span class="c"> call on Runspace to finish</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invalid</span>
        <span class="c">///</span><span class="c"> scheme or invalid port is specified</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1054:UriParametersShouldNotBeStrings&quot;</span>, <span class="i">Scope</span> = <span class="s">&quot;member&quot;</span>, <span class="i">Target</span> = <span class="s">&quot;System.Management.Automation.Runspaces.WSManConnectionInfo.#.ctor(System.String,System.String,System.Int32,System.String,System.String,System.Management.Automation.PSCredential,System.Int64,System.Int64)&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;4#&quot;</span>)]
        <b>public</b> <a id="d218b07809ae9dd5" href="../../../R/d218b07809ae9dd5.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>(<b>string</b> <span id="r11 rd" class="r11 r">scheme</span>, <b>string</b> <span id="r10 rd" class="r10 r">computerName</span>, <b>int</b> <span id="r12 rd" class="r12 r">port</span>, <b>string</b> <span id="r13 rd" class="r13 r">appName</span>, <b>string</b> <span id="r14 rd" class="r14 r">shellUri</span>, <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r15 rd" class="r15 r">credential</span>, <b>int</b> <span id="r16 rd" class="r16 r">openTimeout</span>)
        {
            <a href="#d29b8b073c4a8931" class="i property">Scheme</a> = <span class="r11 r">scheme</span>;
            <a href="#74b71e9668d24a47" class="i property">ComputerName</a> = <span class="r10 r">computerName</span>;
            <a href="#1aeb2cc802b3a879" class="i property">Port</a> = <span class="r12 r">port</span>;
            <a href="#0757157b257825db" class="i property">AppName</a> = <span class="r13 r">appName</span>;
            <a href="#a0ee4c890acec948" class="i property">ShellUri</a> = <span class="r14 r">shellUri</span>;
            <a href="#5a783a782d2a0c8e" class="i property">Credential</a> = <span class="r15 r">credential</span>;
            <a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <span class="r16 r">openTimeout</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used to create a WSManConnectionInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Computer to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">scheme</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Scheme to be used for connection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Port to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">appName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Application end point to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">shellUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">remote shell to launch</span>
        <span class="c">///</span><span class="c"> on connection</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">credential to be used</span>
        <span class="c">///</span><span class="c"> for connection</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invalid</span>
        <span class="c">///</span><span class="c"> scheme or invalid port is specified</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">max server life timeout and open timeout are</span>
        <span class="c">///</span><span class="c"> default in this case</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1054:UriParametersShouldNotBeStrings&quot;</span>, <span class="i">Scope</span> = <span class="s">&quot;member&quot;</span>, <span class="i">Target</span> = <span class="s">&quot;System.Management.Automation.Runspaces.WSManConnectionInfo.#.ctor(System.String,System.String,System.Int32,System.String,System.String,System.Management.Automation.PSCredential)&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;4#&quot;</span>)]
        <b>public</b> <a id="d45465fec0de9b55" href="../../../R/d45465fec0de9b55.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>(
            <b>string</b> <span id="r18 rd" class="r18 r">scheme</span>,
            <b>string</b> <span id="r17 rd" class="r17 r">computerName</span>,
            <b>int</b> <span id="r19 rd" class="r19 r">port</span>,
            <b>string</b> <span id="r20 rd" class="r20 r">appName</span>,
            <b>string</b> <span id="r21 rd" class="r21 r">shellUri</span>,
            <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r22 rd" class="r22 r">credential</span>)
            : <a href="#d218b07809ae9dd5" class="k">this</a>(
                <span class="r18 r">scheme</span>,
                <span class="r17 r">computerName</span>,
                <span class="r19 r">port</span>,
                <span class="r20 r">appName</span>,
                <span class="r21 r">shellUri</span>,
                <span class="r22 r">credential</span>,
                <a href="#9e72edbf25d16225" class="i field">DefaultOpenTimeout</a>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used to create a WSManConnectionInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">useSsl</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">appName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">shellUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1054:UriParametersShouldNotBeStrings&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;4#&quot;</span>)]
        <b>public</b> <a id="f9e9b5d0d2080936" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>(
            <b>bool</b> <span id="r23 rd" class="r23 r">useSsl</span>,
            <b>string</b> <span id="r24 rd" class="r24 r">computerName</span>,
            <b>int</b> <span id="r25 rd" class="r25 r">port</span>,
            <b>string</b> <span id="r26 rd" class="r26 r">appName</span>,
            <b>string</b> <span id="r27 rd" class="r27 r">shellUri</span>,
            <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r28 rd" class="r28 r">credential</span>)
            : <a href="#d45465fec0de9b55" class="k">this</a>(
                  <span class="r23 r">useSsl</span> ? <a href="#e678dcdcb4cc498e" class="i field">DefaultSslScheme</a> : <a href="#2f3e0aa624f51fce" class="i field">DefaultScheme</a>,
                  <span class="r24 r">computerName</span>,
                  <span class="r25 r">port</span>,
                  <span class="r26 r">appName</span>,
                  <span class="r27 r">shellUri</span>,
                  <span class="r28 r">credential</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">useSsl</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">appName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">shellUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">openTimeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1054:UriParametersShouldNotBeStrings&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;4#&quot;</span>)]
        <b>public</b> <a id="fa7a0041edca11ee" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>(
            <b>bool</b> <span id="r29 rd" class="r29 r">useSsl</span>,
            <b>string</b> <span id="r30 rd" class="r30 r">computerName</span>,
            <b>int</b> <span id="r31 rd" class="r31 r">port</span>,
            <b>string</b> <span id="r32 rd" class="r32 r">appName</span>,
            <b>string</b> <span id="r33 rd" class="r33 r">shellUri</span>,
            <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r34 rd" class="r34 r">credential</span>,
            <b>int</b> <span id="r35 rd" class="r35 r">openTimeout</span>)
            : <a href="#d218b07809ae9dd5" class="k">this</a>(
                  <span class="r29 r">useSsl</span> ? <a href="#e678dcdcb4cc498e" class="i field">DefaultSslScheme</a> : <a href="#2f3e0aa624f51fce" class="i field">DefaultScheme</a>,
                  <span class="r30 r">computerName</span>,
                  <span class="r31 r">port</span>,
                  <span class="r32 r">appName</span>,
                  <span class="r33 r">shellUri</span>,
                  <span class="r34 r">credential</span>,
                  <span class="r35 r">openTimeout</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a WSManConnectionInfo for the following URI</span>
        <span class="c">///</span><span class="c"> and with the default credentials, default server</span>
        <span class="c">///</span><span class="c"> life time and default open timeout</span>
        <span class="c">///</span><span class="c">        http://localhost/</span>
        <span class="c">///</span><span class="c"> The default shellname Microsoft.PowerShell will be</span>
        <span class="c">///</span><span class="c"> used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="633c07f34544868e" href="../../../R/633c07f34544868e.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>()
        {
            <span class="c">// ConstructUri(DefaultScheme, DefaultComputerName, DefaultPort, DefaultAppName);</span>
            <a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor to create a WSManConnectionInfo with a uri</span>
        <span class="c">///</span><span class="c"> and explicit credentials - server life time is</span>
        <span class="c">///</span><span class="c"> default and open timeout is default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">uri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Uri of remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">shellUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">credentials to use to</span>
        <span class="c">///</span><span class="c"> connect to the remote runspace</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">When an</span>
        <span class="c">///</span><span class="c"> uri representing an invalid path is specified</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1054:UriParametersShouldNotBeStrings&quot;</span>, <span class="i">Scope</span> = <span class="s">&quot;member&quot;</span>, <span class="i">Target</span> = <span class="s">&quot;System.Management.Automation.Runspaces.WSManConnectionInfo.#.ctor(System.Uri,System.String,System.Management.Automation.PSCredential)&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;1#&quot;</span>)]
        <b>public</b> <a id="50801b2526291054" href="../../../R/50801b2526291054.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>(<span class="i">Uri</span> <span id="r36 rd" class="r36 r">uri</span>, <b>string</b> <span id="r37 rd" class="r37 r">shellUri</span>, <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r38 rd" class="r38 r">credential</span>)
        {
            <b>if</b> (<span class="r36 r">uri</span> == <b>null</b>)
            {
                <span class="c">// if the uri is null..apply wsman default logic for port</span>
                <span class="c">// resolution..BUG 542726</span>
                <a href="#a0ee4c890acec948" class="i property">ShellUri</a> = <span class="r37 r">shellUri</span>;
                <a href="#5a783a782d2a0c8e" class="i property">Credential</a> = <span class="r38 r">credential</span>;
                <a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <b>true</b>;
                <b>return</b>;
            }
 
            <b>if</b> (!<span class="r36 r">uri</span>.<span class="i">IsAbsoluteUri</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<a href="remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>
                                                    (<span class="i">RemotingErrorIdStrings</span>.<span class="i">RelativeUriForRunspacePathNotSupported</span>));
            }
 
            <span class="c">// This check is needed to make sure we connect to WSMan app in the</span>
            <span class="c">// default case (when user did not specify any appname) like</span>
            <span class="c">// http://localhost , http://127.0.0.1 etc.</span>
            <b>if</b> (<span class="r36 r">uri</span>.<span class="i">AbsolutePath</span>.<span class="i">Equals</span>(<span class="s">&quot;/&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r36 r">uri</span>.<span class="i">Query</span>) &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r36 r">uri</span>.<span class="i">Fragment</span>))
            {
                <span class="i">ConstructUri</span>(<span class="r36 r">uri</span>.<span class="i">Scheme</span>,
                             <span class="r36 r">uri</span>.<span class="i">Host</span>,
                             <span class="r36 r">uri</span>.<span class="i">Port</span>,
                             <a href="#0dabec367caf9eb4" class="i field">s_defaultAppName</a>);
            }
            <b>else</b>
            {
                <a href="#eb73ffdb9b586505" class="i property">ConnectionUri</a> = <span class="r36 r">uri</span>;
            }
 
            <a href="#a0ee4c890acec948" class="i property">ShellUri</a> = <span class="r37 r">shellUri</span>;
            <a href="#5a783a782d2a0c8e" class="i property">Credential</a> = <span class="r38 r">credential</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used to create a WSManConnectionInfo. This constructor supports a certificate thumbprint to</span>
        <span class="c">///</span><span class="c"> be used while connecting to a remote machine instead of credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">uri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Uri of remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">shellUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">certificateThumbprint</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A thumb print of the certificate to use while connecting to the remote machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1054:UriParametersShouldNotBeStrings&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;1#&quot;</span>)]
        <b>public</b> <a id="10f47c7a0821b950" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>(<span class="i">Uri</span> <span id="r39 rd" class="r39 r">uri</span>, <b>string</b> <span id="r40 rd" class="r40 r">shellUri</span>, <b>string</b> <span id="r41 rd" class="r41 r">certificateThumbprint</span>)
            : <a href="#50801b2526291054" class="k">this</a>(<span class="r39 r">uri</span>, <span class="r40 r">shellUri</span>, (<a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a>)<b>null</b>)
        {
            <a href="#963949f28fbc1ed8" class="i field">_thumbPrint</a> = <span class="r41 r">certificateThumbprint</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor to create a WSManConnectionInfo with a</span>
        <span class="c">///</span><span class="c"> uri specified and the default credentials,</span>
        <span class="c">///</span><span class="c"> default server life time and default open</span>
        <span class="c">///</span><span class="c"> timeout.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">uri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Uri of remote runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">When an</span>
        <span class="c">///</span><span class="c"> uri representing an invalid path is specified</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="00aef733dff43758" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">WSManConnectionInfo</a>(<span class="i">Uri</span> <span id="r42 rd" class="r42 r">uri</span>)
            : <a href="#50801b2526291054" class="k">this</a>(<span class="r42 r">uri</span>, <a href="#642efa492b762bcf" class="i field">DefaultShellUri</a>, <a href="#fab24896135d71ac" class="i field">DefaultCredential</a>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Populates session options from a PSSessionOption instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1. Proxy credential cannot be specified when proxy accesstype is None.</span>
        <span class="c">///</span><span class="c"> Either specify a valid proxy accesstype other than None or do not specify proxy credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="90a3b8c25397a311" href="../../../R/90a3b8c25397a311.html" target="n" data-glyph="72,1" class="i method">SetSessionOptions</a>(<a href="../commands/PSRemotingCmdlet.cs.html#8626ee928362b305" class="t t">PSSessionOption</a> <span id="r43 rd" class="r43 r">options</span>)
        {
            <b>if</b> (<span class="r43 r">options</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r43 r">options</span>));
            }
 
            <b>if</b> ((<span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#bf46cf340b00816f" class="i property">ProxyAccessType</a> == <a href="../commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a>.<a href="../commands/PSRemotingCmdlet.cs.html#b8abe0a20c41194e" class="i field">None</a>) &amp;&amp; (<span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#7be1964b0ead807f" class="i property">ProxyCredential</a> != <b>null</b>))
            {
                <b>string</b> <span id="r44 rd" class="r44 r">message</span> = <a href="remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ProxyCredentialWithoutAccess</span>,
                            <a href="../commands/PSRemotingCmdlet.cs.html#859b8c6a1b0a04ef" class="t t">ProxyAccessType</a>.<a href="../commands/PSRemotingCmdlet.cs.html#b8abe0a20c41194e" class="i field">None</a>);
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r44 r">message</span>);
            }
 
            <a href="#e07ed56a8a1da829" class="k">base</a>.<a href="#3dbde5e0af345257" class="i method">SetSessionOptions</a>(<span class="r43 r">options</span>);
 
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#21431be8484ed16e" class="i property">MaximumConnectionRedirectionCount</a> =
                <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#28f392672e3eb863" class="i property">MaximumConnectionRedirectionCount</a> &gt;= 0
                        ? <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#28f392672e3eb863" class="i property">MaximumConnectionRedirectionCount</a> : <b>int</b>.<span class="i">MaxValue</span>;
 
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#acb325002c1b0d2a" class="i property">MaximumReceivedDataSizePerCommand</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#fad12c194ba02bac" class="i property">MaximumReceivedDataSizePerCommand</a>;
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#72cfe9a0c294ec04" class="i property">MaximumReceivedObjectSize</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#0587b36e63bc9ed4" class="i property">MaximumReceivedObjectSize</a>;
 
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#1ec52b9b453e24eb" class="i property">UseCompression</a> = !(<span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#4da96a141e629777" class="i property">NoCompression</a>);
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#c6c54cb9078f2a4c" class="i property">NoMachineProfile</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#fc82bbd8845feda4" class="i property">NoMachineProfile</a>;
 
            <a href="#9845f779385f9669" class="i property">ProxyAccessType</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#bf46cf340b00816f" class="i property">ProxyAccessType</a>;
            <a href="#cae4dfdb4fcbfb26" class="i field">_proxyAuthentication</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#fffb36093e5ccf4f" class="i property">ProxyAuthentication</a>;
            <a href="#17e2532f89ede78c" class="i field">_proxyCredential</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#7be1964b0ead807f" class="i property">ProxyCredential</a>;
            <a href="#1a6db05682add6a0" class="i property">SkipCACheck</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#eb570bd42a230549" class="i property">SkipCACheck</a>;
            <a href="#62a5656f8055cfb5" class="i property">SkipCNCheck</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#a8cc5d801c0dd2dd" class="i property">SkipCNCheck</a>;
            <a href="#db5f31fe8eaa8600" class="i property">SkipRevocationCheck</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#9861329a549ae83a" class="i property">SkipRevocationCheck</a>;
            <a href="#14ce6561582cbf9c" class="i property">NoEncryption</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#a684dcf48d8b8d3a" class="i property">NoEncryption</a>;
            <a href="#9b6f0e89a27da3f2" class="i property">UseUTF16</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#b584449b5c4b13fb" class="i property">UseUTF16</a>;
            <a href="#7c39032b57cd7818" class="i property">IncludePortInSPN</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#21aa0b34dea85206" class="i property">IncludePortInSPN</a>;
 
            <a href="#10ef35a810ea13c2" class="i property">OutputBufferingMode</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#0a36421122250739" class="i property">OutputBufferingMode</a>;
            <a href="#bab09f8d743ff058" class="i property">MaxConnectionRetryCount</a> = <span class="r43 r">options</span>.<a href="../commands/PSRemotingCmdlet.cs.html#0da743e6d3ee732d" class="i property">MaxConnectionRetryCount</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow copy of the current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RunspaceConnectionInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="0cd24489f6ef9cd9" href="../../../R/0cd24489f6ef9cd9.html" target="n" data-glyph="74,1" class="i method">InternalCopy</a>()
        {
            <b>return</b> <a href="#34f8c1aa90e3af78" class="i method">Copy</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Does a shallow copy of the current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <a id="34f8c1aa90e3af78" href="../../../R/34f8c1aa90e3af78.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r45 rd" class="r45 r">result</span> = <b>new</b> <a href="#633c07f34544868e" class="t constructor">WSManConnectionInfo</a>();
            <span class="r45 r">result</span>.<a href="#545b11518663a4f5" class="i field">_connectionUri</a> = <a href="#545b11518663a4f5" class="i field">_connectionUri</a>;
            <span class="r45 r">result</span>.<a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a> = <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>;
            <span class="r45 r">result</span>.<a href="#0c84c8b49a6e655a" class="i field">_scheme</a> = <a href="#0c84c8b49a6e655a" class="i field">_scheme</a>;
            <span class="r45 r">result</span>.<a href="#bf1ee40cfa31bba1" class="i property">PortSetting</a> = <a href="#bf1ee40cfa31bba1" class="i property">PortSetting</a>;
            <span class="r45 r">result</span>.<a href="#2cadd1529bfb67f5" class="i field">_appName</a> = <a href="#2cadd1529bfb67f5" class="i field">_appName</a>;
            <span class="r45 r">result</span>.<a href="#8b63f4e1bf406a50" class="i field">_shellUri</a> = <a href="#8b63f4e1bf406a50" class="i field">_shellUri</a>;
            <span class="r45 r">result</span>.<a href="#19e61e61912964b7" class="i field">_credential</a> = <a href="#19e61e61912964b7" class="i field">_credential</a>;
            <span class="r45 r">result</span>.<a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a>;
            <span class="r45 r">result</span>.<a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> = <a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a>;
            <span class="r45 r">result</span>.<a href="#21431be8484ed16e" class="i property">MaximumConnectionRedirectionCount</a> = <a href="#21431be8484ed16e" class="i property">MaximumConnectionRedirectionCount</a>;
            <span class="r45 r">result</span>.<a href="#acb325002c1b0d2a" class="i property">MaximumReceivedDataSizePerCommand</a> = <a href="#acb325002c1b0d2a" class="i property">MaximumReceivedDataSizePerCommand</a>;
            <span class="r45 r">result</span>.<a href="#72cfe9a0c294ec04" class="i property">MaximumReceivedObjectSize</a> = <a href="#72cfe9a0c294ec04" class="i property">MaximumReceivedObjectSize</a>;
            <span class="r45 r">result</span>.<a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a>;
            <span class="r45 r">result</span>.<a href="#0c117c8cb5b1de8b" class="i property">IdleTimeout</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#0c117c8cb5b1de8b" class="i property">IdleTimeout</a>;
            <span class="r45 r">result</span>.<a href="#8f5fff031b021f8b" class="i property">MaxIdleTimeout</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#8f5fff031b021f8b" class="i property">MaxIdleTimeout</a>;
            <span class="r45 r">result</span>.<a href="#b136d8269dabb6c4" class="i property">CancelTimeout</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#b136d8269dabb6c4" class="i property">CancelTimeout</a>;
            <span class="r45 r">result</span>.<a href="#53cee291a23086f5" class="i property">OperationTimeout</a> = <a href="#e07ed56a8a1da829" class="k">base</a>.<a href="#53cee291a23086f5" class="i property">OperationTimeout</a>;
            <span class="r45 r">result</span>.<a href="#237e4765cd52489b" class="i property">Culture</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#237e4765cd52489b" class="i property">Culture</a>;
            <span class="r45 r">result</span>.<a href="#27251d0ea7ef6aba" class="i property">UICulture</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#27251d0ea7ef6aba" class="i property">UICulture</a>;
            <span class="r45 r">result</span>.<a href="#963949f28fbc1ed8" class="i field">_thumbPrint</a> = <a href="#963949f28fbc1ed8" class="i field">_thumbPrint</a>;
            <span class="r45 r">result</span>.<a href="#1e6f82bf70a3e647" class="i property">AllowImplicitCredentialForNegotiate</a> = <a href="#1e6f82bf70a3e647" class="i property">AllowImplicitCredentialForNegotiate</a>;
            <span class="r45 r">result</span>.<a href="#1ec52b9b453e24eb" class="i property">UseCompression</a> = <a href="#1ec52b9b453e24eb" class="i property">UseCompression</a>;
            <span class="r45 r">result</span>.<a href="#c6c54cb9078f2a4c" class="i property">NoMachineProfile</a> = <a href="#c6c54cb9078f2a4c" class="i property">NoMachineProfile</a>;
            <span class="r45 r">result</span>.<a href="#9845f779385f9669" class="i property">ProxyAccessType</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#9845f779385f9669" class="i property">ProxyAccessType</a>;
            <span class="r45 r">result</span>.<a href="#cae4dfdb4fcbfb26" class="i field">_proxyAuthentication</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#d95258451cb68b3b" class="i property">ProxyAuthentication</a>;
            <span class="r45 r">result</span>.<a href="#17e2532f89ede78c" class="i field">_proxyCredential</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#b90c1ed41e87c2ea" class="i property">ProxyCredential</a>;
            <span class="r45 r">result</span>.<a href="#1a6db05682add6a0" class="i property">SkipCACheck</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#1a6db05682add6a0" class="i property">SkipCACheck</a>;
            <span class="r45 r">result</span>.<a href="#62a5656f8055cfb5" class="i property">SkipCNCheck</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#62a5656f8055cfb5" class="i property">SkipCNCheck</a>;
            <span class="r45 r">result</span>.<a href="#db5f31fe8eaa8600" class="i property">SkipRevocationCheck</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#db5f31fe8eaa8600" class="i property">SkipRevocationCheck</a>;
            <span class="r45 r">result</span>.<a href="#14ce6561582cbf9c" class="i property">NoEncryption</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#14ce6561582cbf9c" class="i property">NoEncryption</a>;
            <span class="r45 r">result</span>.<a href="#9b6f0e89a27da3f2" class="i property">UseUTF16</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#9b6f0e89a27da3f2" class="i property">UseUTF16</a>;
            <span class="r45 r">result</span>.<a href="#7c39032b57cd7818" class="i property">IncludePortInSPN</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#7c39032b57cd7818" class="i property">IncludePortInSPN</a>;
            <span class="r45 r">result</span>.<a href="#bccff2b013731c62" class="i property">EnableNetworkAccess</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#bccff2b013731c62" class="i property">EnableNetworkAccess</a>;
            <span class="r45 r">result</span>.<a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a>;
            <span class="r45 r">result</span>.<a href="#10ef35a810ea13c2" class="i property">OutputBufferingMode</a> = <a href="#10ef35a810ea13c2" class="i property">OutputBufferingMode</a>;
            <span class="r45 r">result</span>.<a href="#f332a5875710beac" class="i property">DisconnectedOn</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#f332a5875710beac" class="i property">DisconnectedOn</a>;
            <span class="r45 r">result</span>.<a href="#98dcfd36463927fb" class="i property">ExpiresOn</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#98dcfd36463927fb" class="i property">ExpiresOn</a>;
            <span class="r45 r">result</span>.<a href="#bab09f8d743ff058" class="i property">MaxConnectionRetryCount</a> = <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#bab09f8d743ff058" class="i property">MaxConnectionRetryCount</a>;
 
            <b>return</b> <span class="r45 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> String for http scheme.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="46c932f319b767db" href="../../../R/46c932f319b767db.html" target="n" data-glyph="6,1" class="i field">HttpScheme</a> = <span class="s">&quot;http&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> String for https scheme.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="e8cee89627b2168d" href="../../../R/e8cee89627b2168d.html" target="n" data-glyph="6,1" class="i field">HttpsScheme</a> = <span class="s">&quot;https&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <b>internal override</b> <a href="../fanin/BaseTransportManager.cs.html#19883ec4df424177" class="t t">BaseClientSessionTransportManager</a> <a id="51927c60ee711f12" href="../../../R/51927c60ee711f12.html" target="n" data-glyph="74,1" class="i method">CreateClientSessionTransportManager</a>(<span class="i">Guid</span> <span id="r46 rd" class="r46 r">instanceId</span>, <b>string</b> <span id="r47 rd" class="r47 r">sessionName</span>, <a href="../../../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r48 rd" class="r48 r">cryptoHelper</span>)
        {
            <b>return</b> <b>new</b> <a href="../fanin/WSManTransportManager.cs.html#9ceba7a90627fbde" class="t constructor">WSManClientSessionTransportManager</a>(
                <span class="r46 r">instanceId</span>,
                <a href="#2d9d176ef419be5a" class="k">this</a>,
                <span class="r48 r">cryptoHelper</span>,
                <span class="r47 r">sessionName</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <b>private static string</b> <a id="74e756df103ff3dd" href="../../../R/74e756df103ff3dd.html" target="n" data-glyph="76,1" class="i method">ResolveShellUri</a>(<b>string</b> <span id="r49 rd" class="r49 r">shell</span>)
        {
            <b>string</b> <span id="r50 rd" class="r50 r">resolvedShellUri</span> = <span class="r49 r">shell</span>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r50 r">resolvedShellUri</span>))
            {
                <span class="r50 r">resolvedShellUri</span> = <a href="#642efa492b762bcf" class="i field">DefaultShellUri</a>;
            }
 
            <b>if</b> (!<span class="r50 r">resolvedShellUri</span>.<span class="i">Contains</span>(<a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#f383edcf61712f90" class="i field">ResourceURIPrefix</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r50 r">resolvedShellUri</span> = <a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#f383edcf61712f90" class="i field">ResourceURIPrefix</a> + <span class="r50 r">resolvedShellUri</span>;
            }
 
            <b>return</b> <span class="r50 r">resolvedShellUri</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">rsCI</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to a WSManConnectionInfo. If conversion succeeds extracts</span>
        <span class="c">///</span><span class="c"> the property..otherwise returns default value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">rsCI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">defaultValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="r54 r t">T</span> <a id="a61f38fd6f4f6c7a" href="../../../R/a61f38fd6f4f6c7a.html" target="n" data-glyph="74,1" class="i method">ExtractPropertyAsWsManConnectionInfo</a>&lt;<span id="r54 rd t" class="r54 r t">T</span>&gt;(<a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <span id="r51 rd" class="r51 r">rsCI</span>,
            <b>string</b> <span id="r52 rd" class="r52 r">property</span>, <span class="r54 r t">T</span> <span id="r53 rd" class="r53 r">defaultValue</span>)
        {
            <b>if</b> (!(<span class="r51 r">rsCI</span> <b>is</b> <a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a> <span id="r55 rd" class="r55 r">wsCI</span>))
            {
                <b>return</b> <span class="r53 r">defaultValue</span>;
            }
 
            <b>return</b> (<span class="r54 r t">T</span>)<b>typeof</b>(<a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>).<span class="i">GetProperty</span>(<span class="r52 r">property</span>, <b>typeof</b>(<span class="r54 r t">T</span>)).<span class="i">GetValue</span>(<span class="r55 r">wsCI</span>, <b>null</b>);
        }
 
        <b>internal void</b> <a id="72517bf23b792dae" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetConnectionUri</a>(<span class="i">Uri</span> <span id="r56 rd" class="r56 r">newUri</span>)
        {
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r56 r">newUri</span> != <b>null</b>, <span class="s">&quot;newUri cannot be null.&quot;</span>);
            <a href="#545b11518663a4f5" class="i field">_connectionUri</a> = <span class="r56 r">newUri</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a Uri from the supplied parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">scheme</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Making the port nullable to make sure the UseDefaultWSManPort variable is protected and updated</span>
        <span class="c">///</span><span class="c"> only when Port is updated. Usages that dont update port, should use null for this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">appName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e5fa321e4a1d7018" href="../../../R/e5fa321e4a1d7018.html" target="n" data-glyph="74,1" class="i method">ConstructUri</a>(<b>string</b> <span id="r57 rd" class="r57 r">scheme</span>, <b>string</b> <span id="r58 rd" class="r58 r">computerName</span>, <b>int</b>? <span id="r59 rd" class="r59 r">port</span>, <b>string</b> <span id="r60 rd" class="r60 r">appName</span>)
        {
            <span class="c">// Default scheme is http</span>
            <a href="#0c84c8b49a6e655a" class="i field">_scheme</a> = <span class="r57 r">scheme</span>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#0c84c8b49a6e655a" class="i field">_scheme</a>))
            {
                <a href="#0c84c8b49a6e655a" class="i field">_scheme</a> = <a href="#2f3e0aa624f51fce" class="i field">DefaultScheme</a>;
            }
 
            <span class="c">// Valid values for scheme are &quot;http&quot; and &quot;https&quot;</span>
            <b>if</b> (!(<a href="#0c84c8b49a6e655a" class="i field">_scheme</a>.<span class="i">Equals</span>(<a href="#46c932f319b767db" class="i field">HttpScheme</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                || <a href="#0c84c8b49a6e655a" class="i field">_scheme</a>.<span class="i">Equals</span>(<a href="#e8cee89627b2168d" class="i field">HttpsScheme</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                || <a href="#0c84c8b49a6e655a" class="i field">_scheme</a>.<span class="i">Equals</span>(<a href="#2f3e0aa624f51fce" class="i field">DefaultScheme</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
            {
                <b>string</b> <span id="r61 rd" class="r61 r">message</span> =
                    <a href="remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>(
                        <span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidSchemeValue</span>, <a href="#0c84c8b49a6e655a" class="i field">_scheme</a>);
                <span class="i">ArgumentException</span> <span id="r62 rd" class="r62 r">e</span> = <b>new</b> <span class="i">ArgumentException</span>(<span class="r61 r">message</span>);
                <b>throw</b> <span class="r62 r">e</span>;
            }
 
            <span class="c">// default host is localhost</span>
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r58 r">computerName</span>) || <b>string</b>.<span class="i">Equals</span>(<span class="r58 r">computerName</span>, <span class="s">&quot;.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a> = <a href="#3139826d47c34b83" class="i field">DefaultComputerName</a>;
            }
            <b>else</b>
            {
                <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a> = <span class="r58 r">computerName</span>.<span class="i">Trim</span>();
 
                <span class="c">// According to RFC3513, an Ipv6 address in URI needs to be bracketed.</span>
                <span class="i">IPAddress</span> <span id="r63 rd" class="r63 r">ipAddress</span> = <b>null</b>;
 
                <b>bool</b> <span id="r64 rd" class="r64 r">isIPAddress</span> = <span class="i">IPAddress</span>.<span class="i">TryParse</span>(<a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>, <b>out</b> <span class="r63 r">ipAddress</span>);
                <b>if</b> (<span class="r64 r">isIPAddress</span> &amp;&amp; <span class="r63 r">ipAddress</span>.<span class="i">AddressFamily</span> == <span class="i">AddressFamily</span>.<span class="i">InterNetworkV6</span>)
                {
                    <b>if</b> ((<a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>.<span class="i">Length</span> == 0) || (<a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>[0] != <span class="s">&#39;[&#39;</span>))
                    {
                        <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a> = <span class="s">@&quot;[&quot;</span> + <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a> + <span class="s">@&quot;]&quot;</span>;
                    }
                }
            }
 
            <a href="../../../utils/tracing/PSEtwLog.cs.html#749e795b3c087a72" class="t t">PSEtwLog</a>.<a href="../../../utils/tracing/PSEtwLog.cs.html#daafe1d1950e6098" class="i method">LogAnalyticVerbose</a>(<a href="PSETWTracer.cs.html#609c10dc18364c6e" class="t t">PSEventId</a>.<a href="PSETWTracer.cs.html#896e30aafa55d8c4" class="i field">ComputerName</a>, <a href="PSETWTracer.cs.html#2dd3393d77ef2dd0" class="t t">PSOpcode</a>.<a href="PSETWTracer.cs.html#f813a47543bfe7c7" class="i field">Method</a>,
                <a href="PSETWTracer.cs.html#6bc0e8b902470481" class="t t">PSTask</a>.<a href="PSETWTracer.cs.html#752e56066810e4f0" class="i field">CreateRunspace</a>, <a href="PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="PSETWTracer.cs.html#193d289333be8934" class="i field">Runspace</a> | <a href="PSETWTracer.cs.html#d4b75692e500e678" class="t t">PSKeyword</a>.<a href="PSETWTracer.cs.html#a3de02676385c3a4" class="i field">UseAlwaysAnalytic</a>,
                <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>);
 
            <b>if</b> (<span class="r59 r">port</span>.<span class="i">HasValue</span>)
            {
                <span class="i">ValidatePortInRange</span>(<span class="r59 r">port</span>.<span class="i">Value</span>);
                <span class="c">// resolve to default ports if required</span>
                <b>if</b> (<span class="r59 r">port</span>.<span class="i">Value</span> == <a href="#eb5075a087ebb878" class="i field">DefaultPort</a>)
                {
                    <span class="c">// this is needed so that the OriginalString on</span>
                    <span class="c">// connection uri is fine</span>
                    <a href="#bf1ee40cfa31bba1" class="i property">PortSetting</a> = -1;
                    <a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <b>true</b>;
                }
                <b>else</b>
                {
                    <a href="#bf1ee40cfa31bba1" class="i property">PortSetting</a> = <span class="r59 r">port</span>.<span class="i">Value</span>;
                    <a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <b>false</b>;
                }
            }
 
            <span class="c">// default appname is WSMan</span>
            <a href="#2cadd1529bfb67f5" class="i field">_appName</a> = <span class="r60 r">appName</span>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#2cadd1529bfb67f5" class="i field">_appName</a>))
            {
                <a href="#2cadd1529bfb67f5" class="i field">_appName</a> = <a href="#0dabec367caf9eb4" class="i field">s_defaultAppName</a>;
            }
 
            <span class="c">// construct Uri</span>
            <span class="i">UriBuilder</span> <span id="r65 rd" class="r65 r">uriBuilder</span> = <b>new</b> <span class="i">UriBuilder</span>(<a href="#0c84c8b49a6e655a" class="i field">_scheme</a>, <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a>,
                                <a href="#bf1ee40cfa31bba1" class="i property">PortSetting</a>, <a href="#2cadd1529bfb67f5" class="i field">_appName</a>);
 
            <a href="#545b11518663a4f5" class="i field">_connectionUri</a> = <span class="r65 r">uriBuilder</span>.<span class="i">Uri</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns connection string without the scheme portion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">connectionUri</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The uri from which the string will be extracted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">isSSLSpecified</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> returns true if https scheme is specified</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> returns connection string without the scheme portion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="3c2c874e25fea78a" href="../../../R/3c2c874e25fea78a.html" target="n" data-glyph="74,1" class="i method">GetConnectionString</a>(<span class="i">Uri</span> <span id="r66 rd" class="r66 r">connectionUri</span>,
            <b>out bool</b> <span id="r67 rd" class="r67 r">isSSLSpecified</span>)
        {
            <span class="r67 r">isSSLSpecified</span> =
                <span class="r66 r">connectionUri</span>.<span class="i">Scheme</span>.<span class="i">Equals</span>(<a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="#e8cee89627b2168d" class="i field">HttpsScheme</a>);
            <b>string</b> <span id="r68 rd" class="r68 r">result</span> = <span class="r66 r">connectionUri</span>.<span class="i">OriginalString</span>.<span class="i">TrimStart</span>();
            <b>if</b> (<span class="r67 r">isSSLSpecified</span>)
            {
                <b>return</b> <span class="r68 r">result</span>.<span class="i">Substring</span>(<a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="#e8cee89627b2168d" class="i field">HttpsScheme</a>.<span class="i">Length</span> + 3);
            }
            <b>else</b>
            {
                <b>return</b> <span class="r68 r">result</span>.<span class="i">Substring</span>(<a href="#2d9d176ef419be5a" class="t t">WSManConnectionInfo</a>.<a href="#46c932f319b767db" class="i field">HttpScheme</a>.<span class="i">Length</span> + 3);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to resolve authentication from the parameters chosen by the user.</span>
        <span class="c">///</span><span class="c"> User has the following options:</span>
        <span class="c">///</span><span class="c"> 1. AuthMechanism + Credential</span>
        <span class="c">///</span><span class="c"> 2. CertificateThumbPrint</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> All the above are mutually exclusive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there is ambiguity as specified above.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8003c8854b1dfb31" href="../../../R/8003c8854b1dfb31.html" target="n" data-glyph="76,1" class="i method">ValidateSpecifiedAuthentication</a>()
        {
            <b>if</b> ((<a href="#fb303a9867ec0b83" class="i property">WSManAuthenticationMechanism</a> != <a href="../fanin/WSManNativeAPI.cs.html#242d5549ef0e4dbd" class="t t">WSManAuthenticationMechanism</a>.<a href="../fanin/WSManNativeAPI.cs.html#5125eb68ec11fa36" class="i field">WSMAN_FLAG_DEFAULT_AUTHENTICATION</a>)
                &amp;&amp; (<a href="#963949f28fbc1ed8" class="i field">_thumbPrint</a> != <b>null</b>))
            {
                <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">NewRunspaceAmbiguousAuthentication</span>,
                      <span class="s">&quot;CertificateThumbPrint&quot;</span>, <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#e1a2e5b5a5d08c41" class="i property">AuthenticationMechanism</a>.<span class="i">ToString</span>());
            }
        }
 
        <b>private void</b> <a id="a6a68cb51e881ba8" href="../../../R/a6a68cb51e881ba8.html" target="n" data-glyph="76,1" class="i method">UpdateUri</a>(<span class="i">Uri</span> <span id="r69 rd" class="r69 r">uri</span>)
        {
            <b>if</b> (!<span class="r69 r">uri</span>.<span class="i">IsAbsoluteUri</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>(<a href="remotingexceptions.cs.html#53047fc052e9b445" class="t t">PSRemotingErrorInvariants</a>.<span class="i">FormatResourceString</span>
                                                    (<span class="i">RemotingErrorIdStrings</span>.<span class="i">RelativeUriForRunspacePathNotSupported</span>));
            }
 
            <b>if</b> (<span class="r69 r">uri</span>.<span class="i">OriginalString</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;:&#39;</span>) &gt;
                <span class="r69 r">uri</span>.<span class="i">AbsoluteUri</span>.<span class="i">IndexOf</span>(<span class="s">&quot;//&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
            {
                <a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <b>false</b>;
            }
 
            <span class="c">// This check is needed to make sure we connect to WSMan app in the</span>
            <span class="c">// default case (when user did not specify any appname) like</span>
            <span class="c">// http://localhost , http://127.0.0.1 etc.</span>
            <b>string</b> <span id="r70 rd" class="r70 r">appname</span>;
 
            <b>if</b> (<span class="r69 r">uri</span>.<span class="i">AbsolutePath</span>.<span class="i">Equals</span>(<span class="s">&quot;/&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>) &amp;&amp;
                <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r69 r">uri</span>.<span class="i">Query</span>) &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r69 r">uri</span>.<span class="i">Fragment</span>))
            {
                <span class="r70 r">appname</span> = <a href="#0dabec367caf9eb4" class="i field">s_defaultAppName</a>;
                <span class="i">ConstructUri</span>(<span class="r69 r">uri</span>.<span class="i">Scheme</span>,
                                <span class="r69 r">uri</span>.<span class="i">Host</span>,
                                <span class="r69 r">uri</span>.<span class="i">Port</span>,
                                <span class="r70 r">appname</span>);
            }
            <b>else</b>
            {
                <a href="#545b11518663a4f5" class="i field">_connectionUri</a> = <span class="r69 r">uri</span>;
                <a href="#0c84c8b49a6e655a" class="i field">_scheme</a> = <span class="r69 r">uri</span>.<span class="i">Scheme</span>;
                <a href="#2cadd1529bfb67f5" class="i field">_appName</a> = <span class="r69 r">uri</span>.<span class="i">AbsolutePath</span>;
                <a href="#bf1ee40cfa31bba1" class="i property">PortSetting</a> = <span class="r69 r">uri</span>.<span class="i">Port</span>;
                <a href="#f7ec1f8b2acf87d3" class="i field">_computerName</a> = <span class="r69 r">uri</span>.<span class="i">Host</span>;
                <a href="#89e557efc35dc45d" class="i property">UseDefaultWSManPort</a> = <b>false</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Members
 
        <b>private string</b> <a id="0c84c8b49a6e655a" href="../../../R/0c84c8b49a6e655a.html" target="n" data-glyph="46,1" class="i field">_scheme</a> = <a href="#46c932f319b767db" class="i field">HttpScheme</a>;
        <b>private string</b> <a id="f7ec1f8b2acf87d3" href="../../../R/f7ec1f8b2acf87d3.html" target="n" data-glyph="46,1" class="i field">_computerName</a> = <a href="#3139826d47c34b83" class="i field">DefaultComputerName</a>;
        <b>private string</b> <a id="2cadd1529bfb67f5" href="../../../R/2cadd1529bfb67f5.html" target="n" data-glyph="46,1" class="i field">_appName</a> = <a href="#0dabec367caf9eb4" class="i field">s_defaultAppName</a>;
        <b>private</b> <span class="i">Uri</span> <a id="545b11518663a4f5" href="../../../R/545b11518663a4f5.html" target="n" data-glyph="46,1" class="i field">_connectionUri</a> = <b>new</b> <span class="i">Uri</span>(<a href="#7dfa62c021ef09b0" class="i field">LocalHostUriString</a>);          <span class="c">// uri of this connection</span>
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="19e61e61912964b7" href="../../../R/19e61e61912964b7.html" target="n" data-glyph="46,1" class="i field">_credential</a>;    <span class="c">// credentials to be used for this connection</span>
        <b>private string</b> <a id="8b63f4e1bf406a50" href="../../../R/8b63f4e1bf406a50.html" target="n" data-glyph="46,1" class="i field">_shellUri</a> = <a href="#642efa492b762bcf" class="i field">DefaultShellUri</a>;            <span class="c">// shell thats specified by the user</span>
        <b>private string</b> <a id="963949f28fbc1ed8" href="../../../R/963949f28fbc1ed8.html" target="n" data-glyph="46,1" class="i field">_thumbPrint</a>;
        <b>private</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="cae4dfdb4fcbfb26" href="../../../R/cae4dfdb4fcbfb26.html" target="n" data-glyph="46,1" class="i field">_proxyAuthentication</a>;
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="17e2532f89ede78c" href="../../../R/17e2532f89ede78c.html" target="n" data-glyph="46,1" class="i field">_proxyCredential</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constants
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default disconnected server output mode is set to None.  This mode allows the</span>
        <span class="c">///</span><span class="c"> server to set the buffering mode to Block for new sessions and retain its</span>
        <span class="c">///</span><span class="c"> current mode during disconnect/connect operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const</b> <a href="#9cb40ac520a09a1d" class="t t">OutputBufferingMode</a> <a id="b7ca59070aaef7b2" href="../../../R/b7ca59070aaef7b2.html" target="n" data-glyph="8,1" class="i field">DefaultOutputBufferingMode</a> = <a href="#9cb40ac520a09a1d" class="t t">OutputBufferingMode</a>.<a href="#bc0e18b29515f03e" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default maximum connection retry count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="a48dd5dc791ed867" href="../../../R/a48dd5dc791ed867.html" target="n" data-glyph="8,1" class="i field">DefaultMaxConnectionRetryCount</a> = 5;
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">NOT_APPLY_PORT_DCR</span>
<span class="e">        private static string DEFAULT_SCHEME = HTTP_SCHEME;
        internal static readonly string DEFAULT_SSL_SCHEME = HTTPS_SCHEME;
        private static string DEFAULT_APP_NAME = &quot;wsman&quot;;
        /// &lt;summary&gt;
        /// See below for explanation.
        /// &lt;/summary&gt;
        internal bool UseDefaultWSManPort
        {
            get { return false; }
 
            set { }
        }
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
        <b>private const string</b> <a id="2f3e0aa624f51fce" href="../../../R/2f3e0aa624f51fce.html" target="n" data-glyph="10,1" class="i field">DefaultScheme</a> = <a href="#46c932f319b767db" class="i field">HttpScheme</a>;
        <b>private const string</b> <a id="e678dcdcb4cc498e" href="../../../R/e678dcdcb4cc498e.html" target="n" data-glyph="10,1" class="i field">DefaultSslScheme</a> = <a href="#e8cee89627b2168d" class="i field">HttpsScheme</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default appname. This is empty as WSMan configuration has support</span>
        <span class="c">///</span><span class="c"> for this. Look at</span>
        <span class="c">///</span><span class="c"> get-item WSMan:\localhost\Client\URLPrefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly string</b> <a id="0dabec367caf9eb4" href="../../../R/0dabec367caf9eb4.html" target="n" data-glyph="46,1" class="i field">s_defaultAppName</a> = <span class="s">&quot;/wsman&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default scheme.</span>
        <span class="c">///</span><span class="c"> As part of port DCR, WSMan changed the default ports</span>
        <span class="c">///</span><span class="c"> from 80,443 to 5985,5986 respectively no-SSL,SSL</span>
        <span class="c">///</span><span class="c"> connections. Since the standards say http,https use</span>
        <span class="c">///</span><span class="c"> 80,443 as defaults..we came up with new mechanism</span>
        <span class="c">///</span><span class="c"> to specify scheme as empty. For SSL, WSMan introduced</span>
        <span class="c">///</span><span class="c"> a new SessionOption. In order to make scheme empty</span>
        <span class="c">///</span><span class="c"> in the connection string passed to WSMan, we use</span>
        <span class="c">///</span><span class="c"> this internal boolean.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="89e557efc35dc45d" href="../../../R/89e557efc35dc45d.html" target="n" data-glyph="104,1" class="i property">UseDefaultWSManPort</a> { <b>get</b>; <b>set</b>; }
 
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default port for http scheme.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const int</b> <a id="f2c4728ced273cd1" href="../../../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">DefaultPortHttp</a> = 80;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default port for https scheme.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const int</b> <a id="c2558928425387a8" href="../../../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">DefaultPortHttps</a> = 443;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the default port value which when specified</span>
        <span class="c">///</span><span class="c"> results in the default port for the scheme to be</span>
        <span class="c">///</span><span class="c"> assumed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const int</b> <a id="eb5075a087ebb878" href="../../../R/eb5075a087ebb878.html" target="n" data-glyph="10,1" class="i field">DefaultPort</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default remote host name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="3139826d47c34b83" href="../../../R/3139826d47c34b83.html" target="n" data-glyph="10,1" class="i field">DefaultComputerName</a> = <span class="s">&quot;localhost&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> String that represents the local host Uri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="7dfa62c021ef09b0" href="../../../R/7dfa62c021ef09b0.html" target="n" data-glyph="10,1" class="i field">LocalHostUriString</a> = <span class="s">&quot;http://localhost/wsman&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default value for shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="642efa492b762bcf" href="../../../R/642efa492b762bcf.html" target="n" data-glyph="10,1" class="i field">DefaultShellUri</a> = <a href="../fanin/WSManNativeAPI.cs.html#46dd878f72638b32" class="t t">WSManNativeApi</a>.<a href="../fanin/WSManNativeAPI.cs.html#f383edcf61712f90" class="i field">ResourceURIPrefix</a> + <a href="WireDataFormat/EncodeAndDecode.cs.html#d19a1042a44001e8" class="t t">RemotingConstants</a>.<a href="WireDataFormat/EncodeAndDecode.cs.html#281bed97cc0ff841" class="i field">DefaultShellName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default credentials - null indicates credentials of</span>
        <span class="c">///</span><span class="c"> current user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="fab24896135d71ac" href="../../../R/fab24896135d71ac.html" target="n" data-glyph="10,1" class="i field">DefaultCredential</a> = <b>null</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constants
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper property that returns true when the connection has EnableNetworkAccess set</span>
        <span class="c">///</span><span class="c"> and the connection is localhost (loopback), i.e., not a network connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="4c971f0cb668c792" href="../../../R/4c971f0cb668c792.html" target="n" data-glyph="104,1" class="i property">IsLocalhostAndNetworkAccess</a>
        {
            <b>get</b>
            {
                <b>return</b> (<a href="#bccff2b013731c62" class="i property">EnableNetworkAccess</a> &amp;&amp;                                                              <span class="c">// Interactive token requested</span>
                        (<a href="#5a783a782d2a0c8e" class="i property">Credential</a> == <b>null</b> &amp;&amp;                                                              <span class="c">// No credential provided</span>
                         (<a href="#74b71e9668d24a47" class="i property">ComputerName</a>.<span class="i">Equals</span>(<a href="#3139826d47c34b83" class="i field">DefaultComputerName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||   <span class="c">// Localhost computer name</span>
                          !<a href="#74b71e9668d24a47" class="i property">ComputerName</a>.<span class="i">Contains</span>(<span class="s">&#39;.&#39;</span>))));                                                    <span class="c">// Not FQDN computer name</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> DisconnectedOn property applies to disconnnected runspaces.</span>
        <span class="c">///</span><span class="c"> This property is publicly exposed only through Runspace class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">DateTime</span>? <a id="f332a5875710beac" href="../../../R/f332a5875710beac.html" target="n" data-glyph="104,1" class="i property">DisconnectedOn</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ExpiresOn property applies to disconnnected runspaces.</span>
        <span class="c">///</span><span class="c"> This property is publicly exposed only through Runspace class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">DateTime</span>? <a id="98dcfd36463927fb" href="../../../R/98dcfd36463927fb.html" target="n" data-glyph="104,1" class="i property">ExpiresOn</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method to reset DisconnectedOn/ExpiresOn properties to null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="bd03a6571a38d3e3" href="../../../R/bd03a6571a38d3e3.html" target="n" data-glyph="74,1" class="i method">NullDisconnectedExpiresOn</a>()
        {
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#f332a5875710beac" class="i property">DisconnectedOn</a> = <b>null</b>;
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#98dcfd36463927fb" class="i property">ExpiresOn</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method to set the DisconnectedOn/ExpiresOn properties based</span>
        <span class="c">///</span><span class="c"> on current date/time and session idletimeout value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="231c10e07e4ebcfb" href="../../../R/231c10e07e4ebcfb.html" target="n" data-glyph="74,1" class="i method">SetDisconnectedExpiresOnToNow</a>()
        {
            <span class="i">TimeSpan</span> <span id="r71 rd" class="r71 r">idleTimeoutTime</span> = <span class="i">TimeSpan</span>.<span class="i">FromSeconds</span>(<a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#0c117c8cb5b1de8b" class="i property">IdleTimeout</a> / 1000);
            <span class="i">DateTime</span> <span id="r72 rd" class="r72 r">now</span> = <span class="i">DateTime</span>.<span class="i">Now</span>;
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#f332a5875710beac" class="i property">DisconnectedOn</a> = <span class="r72 r">now</span>;
            <a href="#2d9d176ef419be5a" class="k">this</a>.<a href="#98dcfd36463927fb" class="i property">ExpiresOn</a> = <span class="r72 r">now</span>.<span class="i">Add</span>(<span class="r71 r">idleTimeoutTime</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal members
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class which is used to create an Out-Of-Process Runspace/RunspacePool.</span>
    <span class="c">///</span><span class="c"> This does not have a dependency on WSMan. *-Job cmdlets use Out-Of-Proc</span>
    <span class="c">///</span><span class="c"> Runspaces to support background jobs.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="93baa7a23006c771" href="../../../R/93baa7a23006c771.html" target="n" data-glyph="2,0" class="t t">NewProcessConnectionInfo</a> : <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="2da4ca9ee2933d22" href="../../../R/2da4ca9ee2933d22.html" target="n" data-glyph="46,1" class="i field">_credential</a>;
        <b>private</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="2c3c496b8bd41313" href="../../../R/2c3c496b8bd41313.html" target="n" data-glyph="46,1" class="i field">_authMechanism</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Script to run while starting the background process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="5b610004bf5ded30" href="../../../R/5b610004bf5ded30.html" target="n" data-glyph="102,1" class="i property">InitializationScript</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> On a 64bit machine, specifying true for this will launch a 32 bit process</span>
        <span class="c">///</span><span class="c"> for the background process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="68cce0ea2c8c3180" href="../../../R/68cce0ea2c8c3180.html" target="n" data-glyph="102,1" class="i property">RunAs32</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets an initial working directory for the powershell background process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4e1f955258f4d4c1" href="../../../R/4e1f955258f4d4c1.html" target="n" data-glyph="102,1" class="i property">WorkingDirectory</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Powershell version to execute the job in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Version</span> <a id="80441a03729049e6" href="../../../R/80441a03729049e6.html" target="n" data-glyph="102,1" class="i property">PSVersion</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="../../hostifaces/PowerShellProcessInstance.cs.html#85e1d8f342ae7442" class="t t">PowerShellProcessInstance</a> <a id="3700438a1679dca4" href="../../../R/3700438a1679dca4.html" target="n" data-glyph="104,1" class="i property">Process</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the computer. Will always be &quot;localhost&quot; to signify local machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="e52e159b15459a9c" href="../../../R/e52e159b15459a9c.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b> { <b>return</b> <span class="s">&quot;localhost&quot;</span>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential used for the connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="10a16b560836ad1b" href="../../../R/10a16b560836ad1b.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2da4ca9ee2933d22" class="i field">_credential</a>;
            }
 
            <b>set</b>
            {
                <a href="#2da4ca9ee2933d22" class="i field">_credential</a> = <b>value</b>;
                <a href="#2c3c496b8bd41313" class="i field">_authMechanism</a> = <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication mechanism to use while connecting to the server.</span>
        <span class="c">///</span><span class="c"> Only Default is supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="34d191c72e2c4a3e" href="../../../R/34d191c72e2c4a3e.html" target="n" data-glyph="102,1" class="i property">AuthenticationMechanism</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2c3c496b8bd41313" class="i field">_authMechanism</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> != <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">IPCSupportsOnlyDefaultAuth</span>,
                        <b>value</b>.<span class="i">ToString</span>(), <b>nameof</b>(<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>));
                }
 
                <a href="#2c3c496b8bd41313" class="i field">_authMechanism</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ThumbPrint of a certificate used for connecting to a remote machine.</span>
        <span class="c">///</span><span class="c"> When this is specified, you dont need to supply credential and authentication</span>
        <span class="c">///</span><span class="c"> mechanism.</span>
        <span class="c">///</span><span class="c"> Will always be empty to signify that this is not supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="4833f15acb468215" href="../../../R/4833f15acb468215.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b> { <b>return</b> <b>string</b>.<span class="i">Empty</span>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <b>public</b> <a href="#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a> <a id="7f9f9e3b804d2190" href="../../../R/7f9f9e3b804d2190.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#93baa7a23006c771" class="t t">NewProcessConnectionInfo</a> <span id="r73 rd" class="r73 r">result</span> = <b>new</b> <a href="#b4be2ca19f774eb8" class="t constructor">NewProcessConnectionInfo</a>(<a href="#2da4ca9ee2933d22" class="i field">_credential</a>);
            <span class="r73 r">result</span>.<a href="#34d191c72e2c4a3e" class="i property">AuthenticationMechanism</a> = <a href="#93baa7a23006c771" class="k">this</a>.<a href="#34d191c72e2c4a3e" class="i property">AuthenticationMechanism</a>;
            <span class="r73 r">result</span>.<a href="#5b610004bf5ded30" class="i property">InitializationScript</a> = <a href="#93baa7a23006c771" class="k">this</a>.<a href="#5b610004bf5ded30" class="i property">InitializationScript</a>;
            <span class="r73 r">result</span>.<a href="#4e1f955258f4d4c1" class="i property">WorkingDirectory</a> = <a href="#93baa7a23006c771" class="k">this</a>.<a href="#4e1f955258f4d4c1" class="i property">WorkingDirectory</a>;
            <span class="r73 r">result</span>.<a href="#68cce0ea2c8c3180" class="i property">RunAs32</a> = <a href="#93baa7a23006c771" class="k">this</a>.<a href="#68cce0ea2c8c3180" class="i property">RunAs32</a>;
            <span class="r73 r">result</span>.<a href="#80441a03729049e6" class="i property">PSVersion</a> = <a href="#93baa7a23006c771" class="k">this</a>.<a href="#80441a03729049e6" class="i property">PSVersion</a>;
            <span class="r73 r">result</span>.<a href="#3700438a1679dca4" class="i property">Process</a> = <a href="#3700438a1679dca4" class="i property">Process</a>;
            <b>return</b> <span class="r73 r">result</span>;
        }
 
        <b>internal override</b> <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="372320bcbc5c943c" href="../../../R/372320bcbc5c943c.html" target="n" data-glyph="74,1" class="i method">InternalCopy</a>()
        {
            <b>return</b> <a href="#7f9f9e3b804d2190" class="i method">Copy</a>();
        }
 
        <b>internal override</b> <a href="../fanin/BaseTransportManager.cs.html#19883ec4df424177" class="t t">BaseClientSessionTransportManager</a> <a id="f743089dbc777658" href="../../../R/f743089dbc777658.html" target="n" data-glyph="74,1" class="i method">CreateClientSessionTransportManager</a>(<span class="i">Guid</span> <span id="r74 rd" class="r74 r">instanceId</span>, <b>string</b> <span id="r75 rd" class="r75 r">sessionName</span>, <a href="../../../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r76 rd" class="r76 r">cryptoHelper</span>)
        {
            <b>return</b> <b>new</b> <a href="../fanin/OutOfProcTransportManager.cs.html#f233cd258df13531" class="t constructor">OutOfProcessClientSessionTransportManager</a>(
                <span class="r74 r">instanceId</span>,
                <a href="#93baa7a23006c771" class="k">this</a>,
                <span class="r76 r">cryptoHelper</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a connection info instance used to create a runspace on a different</span>
        <span class="c">///</span><span class="c"> process on the local machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="b4be2ca19f774eb8" href="../../../R/b4be2ca19f774eb8.html" target="n" data-glyph="74,1" class="t constructor">NewProcessConnectionInfo</a>(<a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r77 rd" class="r77 r">credential</span>)
        {
            <a href="#2da4ca9ee2933d22" class="i field">_credential</a> = <span class="r77 r">credential</span>;
            <a href="#2c3c496b8bd41313" class="i field">_authMechanism</a> = <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class used to create an Out-Of-Process Runspace/RunspacePool between</span>
    <span class="c">///</span><span class="c"> two local processes using a named pipe for IPC.</span>
    <span class="c">///</span><span class="c"> This class does not have a dependency on WSMan and is used to implement</span>
    <span class="c">///</span><span class="c"> the PowerShell attach-to-process feature.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="b59a21e6663c2451" href="../../../R/b59a21e6663c2451.html" target="n" data-glyph="0,0" class="t t">NamedPipeConnectionInfo</a> : <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="76645c4ff4e58643" href="../../../R/76645c4ff4e58643.html" target="n" data-glyph="46,1" class="i field">_credential</a>;
        <b>private</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="08740f8ec4917d45" href="../../../R/08740f8ec4917d45.html" target="n" data-glyph="46,1" class="i field">_authMechanism</a>;
        <b>private string</b> <a id="c3cafdd7b7676085" href="../../../R/c3cafdd7b7676085.html" target="n" data-glyph="46,1" class="i field">_appDomainName</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <b>private const int</b> <a id="d00dacea99c43059" href="../../../R/d00dacea99c43059.html" target="n" data-glyph="10,1" class="i field">_defaultOpenTimeout</a> = 60000;      <span class="c">/* 60 seconds. */</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process Id of process to attach to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="92a696b39d4c2017" href="../../../R/92a696b39d4c2017.html" target="n" data-glyph="102,1" class="i property">ProcessId</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optional application domain name.  If not specified then the</span>
        <span class="c">///</span><span class="c"> default application domain is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4074545a85fe2e8f" href="../../../R/4074545a85fe2e8f.html" target="n" data-glyph="102,1" class="i property">AppDomainName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c3cafdd7b7676085" class="i field">_appDomainName</a>;
            }
 
            <b>set</b>
            {
                <a href="#c3cafdd7b7676085" class="i field">_appDomainName</a> = <b>value</b> ?? <b>string</b>.<span class="i">Empty</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the custom named pipe name to connect to. This is usually used in conjunction with pwsh -CustomPipeName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ae19a20d35691fa8" href="../../../R/ae19a20d35691fa8.html" target="n" data-glyph="102,1" class="i property">CustomPipeName</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="0939d13d7a846ec6" href="../../../R/0939d13d7a846ec6.html" target="n" data-glyph="72,1" class="t constructor">NamedPipeConnectionInfo</a>()
        {
            <a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <a href="#d00dacea99c43059" class="i field">_defaultOpenTimeout</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">processId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Process Id to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="ba36c1eb8870c163" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">NamedPipeConnectionInfo</a>(<b>int</b> <span id="r78 rd" class="r78 r">processId</span>)
            : <b>this</b>(<span class="r78 r">processId</span>, <b>string</b>.<span class="i">Empty</span>, <a href="#d00dacea99c43059" class="i field">_defaultOpenTimeout</a>)
        { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">processId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Process Id to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">appDomainName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Application domain name to connect to, or default AppDomain if blank.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="00b1e42db3659b60" href="../../../R/00b1e42db3659b60.html" target="n" data-glyph="72,1" class="t constructor">NamedPipeConnectionInfo</a>(<b>int</b> <span id="r79 rd" class="r79 r">processId</span>, <b>string</b> <span id="r80 rd" class="r80 r">appDomainName</span>)
            : <a href="#f284dc0623e140ad" class="k">this</a>(<span class="r79 r">processId</span>, <span class="r80 r">appDomainName</span>, <a href="#d00dacea99c43059" class="i field">_defaultOpenTimeout</a>)
        { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">processId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Process Id to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">appDomainName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of application domain to connect to.  Connection is to default application domain if blank.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">openTimeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Open time out in Milliseconds.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="f284dc0623e140ad" href="../../../R/f284dc0623e140ad.html" target="n" data-glyph="72,1" class="t constructor">NamedPipeConnectionInfo</a>(
            <b>int</b> <span id="r81 rd" class="r81 r">processId</span>,
            <b>string</b> <span id="r82 rd" class="r82 r">appDomainName</span>,
            <b>int</b> <span id="r83 rd" class="r83 r">openTimeout</span>)
        {
            <a href="#92a696b39d4c2017" class="i property">ProcessId</a> = <span class="r81 r">processId</span>;
            <a href="#4074545a85fe2e8f" class="i property">AppDomainName</a> = <span class="r82 r">appDomainName</span>;
            <a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <span class="r83 r">openTimeout</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">customPipeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pipe name to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="ac89d34b25b9e5a3" href="../../../R/ac89d34b25b9e5a3.html" target="n" data-glyph="72,1" class="t constructor">NamedPipeConnectionInfo</a>(<b>string</b> <span id="r84 rd" class="r84 r">customPipeName</span>)
            : <a href="#14132d7308e9f6c8" class="k">this</a>(<span class="r84 r">customPipeName</span>, <a href="#d00dacea99c43059" class="i field">_defaultOpenTimeout</a>)
        { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">customPipeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Pipe name to connect to.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">openTimeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Open time out in Milliseconds.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="14132d7308e9f6c8" href="../../../R/14132d7308e9f6c8.html" target="n" data-glyph="72,1" class="t constructor">NamedPipeConnectionInfo</a>(
            <b>string</b> <span id="r85 rd" class="r85 r">customPipeName</span>,
            <b>int</b> <span id="r86 rd" class="r86 r">openTimeout</span>)
        {
            <b>if</b> (<span class="r85 r">customPipeName</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r85 r">customPipeName</span>));
            }
 
            <a href="#ae19a20d35691fa8" class="i property">CustomPipeName</a> = <span class="r85 r">customPipeName</span>;
            <a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <span class="r86 r">openTimeout</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer is always localhost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="6b43495f1c7bb48e" href="../../../R/6b43495f1c7bb48e.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b> { <b>return</b> <span class="s">&quot;localhost&quot;</span>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="5c09515a7c2252fa" href="../../../R/5c09515a7c2252fa.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#76645c4ff4e58643" class="i field">_credential</a>;
            }
 
            <b>set</b>
            {
                <a href="#76645c4ff4e58643" class="i field">_credential</a> = <b>value</b>;
                <a href="#08740f8ec4917d45" class="i field">_authMechanism</a> = <span class="i n">Runspaces</span>.<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="5d9626bdb960031b" href="../../../R/5d9626bdb960031b.html" target="n" data-glyph="102,1" class="i property">AuthenticationMechanism</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#08740f8ec4917d45" class="i field">_authMechanism</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> != <span class="i n">Runspaces</span>.<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">IPCSupportsOnlyDefaultAuth</span>,
                        <b>value</b>.<span class="i">ToString</span>(), <b>nameof</b>(<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>));
                }
 
                <a href="#08740f8ec4917d45" class="i field">_authMechanism</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CertificateThumbprint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="b580715b5f1a6666" href="../../../R/b580715b5f1a6666.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b> { <b>return</b> <b>string</b>.<span class="i">Empty</span>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow copy of current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">NamedPipeConnectionInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="e3958d00b933e7f0" href="../../../R/e3958d00b933e7f0.html" target="n" data-glyph="74,1" class="i method">InternalCopy</a>()
        {
            <a href="#b59a21e6663c2451" class="t t">NamedPipeConnectionInfo</a> <span id="r87 rd" class="r87 r">newCopy</span> = <b>new</b> <a href="#0939d13d7a846ec6" class="t constructor">NamedPipeConnectionInfo</a>();
            <span class="r87 r">newCopy</span>.<a href="#08740f8ec4917d45" class="i field">_authMechanism</a> = <a href="#b59a21e6663c2451" class="k">this</a>.<a href="#5d9626bdb960031b" class="i property">AuthenticationMechanism</a>;
            <span class="r87 r">newCopy</span>.<a href="#76645c4ff4e58643" class="i field">_credential</a> = <a href="#b59a21e6663c2451" class="k">this</a>.<a href="#5c09515a7c2252fa" class="i property">Credential</a>;
            <span class="r87 r">newCopy</span>.<a href="#92a696b39d4c2017" class="i property">ProcessId</a> = <a href="#b59a21e6663c2451" class="k">this</a>.<a href="#92a696b39d4c2017" class="i property">ProcessId</a>;
            <span class="r87 r">newCopy</span>.<a href="#c3cafdd7b7676085" class="i field">_appDomainName</a> = <a href="#c3cafdd7b7676085" class="i field">_appDomainName</a>;
            <span class="r87 r">newCopy</span>.<a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <a href="#b59a21e6663c2451" class="k">this</a>.<a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a>;
            <span class="r87 r">newCopy</span>.<a href="#ae19a20d35691fa8" class="i property">CustomPipeName</a> = <a href="#b59a21e6663c2451" class="k">this</a>.<a href="#ae19a20d35691fa8" class="i property">CustomPipeName</a>;
 
            <b>return</b> <span class="r87 r">newCopy</span>;
        }
 
        <b>internal override</b> <a href="../fanin/BaseTransportManager.cs.html#19883ec4df424177" class="t t">BaseClientSessionTransportManager</a> <a id="13db8ee9d90bf9a2" href="../../../R/13db8ee9d90bf9a2.html" target="n" data-glyph="74,1" class="i method">CreateClientSessionTransportManager</a>(<span class="i">Guid</span> <span id="r88 rd" class="r88 r">instanceId</span>, <b>string</b> <span id="r89 rd" class="r89 r">sessionName</span>, <a href="../../../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r90 rd" class="r90 r">cryptoHelper</span>)
        {
            <b>return</b> <b>new</b> <a href="../fanin/OutOfProcTransportManager.cs.html#12abdfc07a48dbc4" class="t constructor">NamedPipeClientSessionTransportManager</a>(
                <a href="#b59a21e6663c2451" class="k">this</a>,
                <span class="r88 r">instanceId</span>,
                <span class="r90 r">cryptoHelper</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class used to create a connection through an SSH.exe client to a remote host machine.</span>
    <span class="c">///</span><span class="c"> Connection information includes SSH target (user name and host machine) along with</span>
    <span class="c">///</span><span class="c"> client key used for key based user authorization.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="c9fcf5b14ea1c33c" href="../../../R/c9fcf5b14ea1c33c.html" target="n" data-glyph="0,0" class="t t">SSHConnectionInfo</a> : <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constants
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default value for subsystem.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="31795708b11d6e2c" href="../../../R/31795708b11d6e2c.html" target="n" data-glyph="10,1" class="i field">DefaultSubsystem</a> = <span class="s">&quot;powershell&quot;</span>;
        
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default value is infinite timeout.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const int</b> <a id="5b95c7972adc1f4e" href="../../../R/5b95c7972adc1f4e.html" target="n" data-glyph="10,1" class="i field">DefaultConnectingTimeoutTime</a> = <span class="i">Timeout</span>.<span class="i">Infinite</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User Name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4b3097733da1ce80" href="../../../R/4b3097733da1ce80.html" target="n" data-glyph="102,1" class="i property">UserName</a>
        {
            <b>get</b>;
            <b>private set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Key File Path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="e7ad66dd7b6bd687" href="../../../R/e7ad66dd7b6bd687.html" target="n" data-glyph="106,1" class="i property">KeyFilePath</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Port for connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="c25be48258669449" href="../../../R/c25be48258669449.html" target="n" data-glyph="106,1" class="i property">Port</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subsystem to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="0df97185dcb0520f" href="../../../R/0df97185dcb0520f.html" target="n" data-glyph="106,1" class="i property">Subsystem</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a time in milliseconds after which a connection attempt is terminated.</span>
        <span class="c">///</span><span class="c"> Default value (-1) never times out and a connection attempt waits indefinitely.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="86fc228db952144a" href="../../../R/86fc228db952144a.html" target="n" data-glyph="102,1" class="i property">ConnectingTimeout</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a id="12f2d94a5220ba18" href="../../../R/12f2d94a5220ba18.html" target="n" data-glyph="76,1" class="t constructor">SSHConnectionInfo</a>()
        { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">User Name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Computer Name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">keyFilePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Key File Path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="2dbb0ce11c6c5f2a" href="../../../R/2dbb0ce11c6c5f2a.html" target="n" data-glyph="72,1" class="t constructor">SSHConnectionInfo</a>(
            <b>string</b> <span id="r91 rd" class="r91 r">userName</span>,
            <b>string</b> <span id="r92 rd" class="r92 r">computerName</span>,
            <b>string</b> <span id="r93 rd" class="r93 r">keyFilePath</span>)
        {
            <b>if</b> (<span class="r92 r">computerName</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r92 r">computerName</span>)); }
 
            <a href="#4b3097733da1ce80" class="i property">UserName</a> = <span class="r91 r">userName</span>;
            <a href="#1d2c97fcabce8639" class="i property">ComputerName</a> = <span class="r92 r">computerName</span>;
            <a href="#e7ad66dd7b6bd687" class="i property">KeyFilePath</a> = <span class="r93 r">keyFilePath</span>;
            <a href="#c25be48258669449" class="i property">Port</a> = 0;
            <a href="#0df97185dcb0520f" class="i property">Subsystem</a> = <a href="#31795708b11d6e2c" class="i field">DefaultSubsystem</a>;
            <a href="#86fc228db952144a" class="i property">ConnectingTimeout</a> = <a href="#5b95c7972adc1f4e" class="i field">DefaultConnectingTimeoutTime</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">User Name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Computer Name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">keyFilePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Key File Path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Port number for connection (default 22).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="b3b727f46ebc2d9c" href="../../../R/b3b727f46ebc2d9c.html" target="n" data-glyph="72,1" class="t constructor">SSHConnectionInfo</a>(
            <b>string</b> <span id="r94 rd" class="r94 r">userName</span>,
            <b>string</b> <span id="r95 rd" class="r95 r">computerName</span>,
            <b>string</b> <span id="r96 rd" class="r96 r">keyFilePath</span>,
            <b>int</b> <span id="r97 rd" class="r97 r">port</span>) : <a href="#2dbb0ce11c6c5f2a" class="k">this</a>(<span class="r94 r">userName</span>, <span class="r95 r">computerName</span>, <span class="r96 r">keyFilePath</span>)
        {
            <a href="#eacd5680e184efc2" class="i method">ValidatePortInRange</a>(<span class="r97 r">port</span>);
            <a href="#c25be48258669449" class="i property">Port</a> = <span class="r97 r">port</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">User Name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Computer Name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">keyFilePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Key File Path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Port number for connection (default 22).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">subsystem</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Subsystem to use (default &#39;powershell&#39;).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="3bfae9b540f384ec" href="../../../R/3bfae9b540f384ec.html" target="n" data-glyph="72,1" class="t constructor">SSHConnectionInfo</a>(
            <b>string</b> <span id="r98 rd" class="r98 r">userName</span>,
            <b>string</b> <span id="r99 rd" class="r99 r">computerName</span>,
            <b>string</b> <span id="r100 rd" class="r100 r">keyFilePath</span>,
            <b>int</b> <span id="r101 rd" class="r101 r">port</span>,
            <b>string</b> <span id="r102 rd" class="r102 r">subsystem</span>) : <a href="#b3b727f46ebc2d9c" class="k">this</a>(<span class="r98 r">userName</span>, <span class="r99 r">computerName</span>, <span class="r100 r">keyFilePath</span>, <span class="r101 r">port</span>)
        {
            <a href="#0df97185dcb0520f" class="i property">Subsystem</a> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r102 r">subsystem</span>) ? <a href="#31795708b11d6e2c" class="i field">DefaultSubsystem</a> : <span class="r102 r">subsystem</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of SSHConnectionInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">userName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of user.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of computer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">keyFilePath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Path of key file.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">port</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Port number for connection (default 22).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">subsystem</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Subsystem to use (default &#39;powershell&#39;).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">connectingTimeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Timeout time for terminating connection attempt.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="2db667929f670ab9" href="../../../R/2db667929f670ab9.html" target="n" data-glyph="72,1" class="t constructor">SSHConnectionInfo</a>(
            <b>string</b> <span id="r103 rd" class="r103 r">userName</span>,
            <b>string</b> <span id="r104 rd" class="r104 r">computerName</span>,
            <b>string</b> <span id="r105 rd" class="r105 r">keyFilePath</span>,
            <b>int</b> <span id="r106 rd" class="r106 r">port</span>,
            <b>string</b> <span id="r107 rd" class="r107 r">subsystem</span>,
            <b>int</b> <span id="r108 rd" class="r108 r">connectingTimeout</span>) : <a href="#3bfae9b540f384ec" class="k">this</a>(<span class="r103 r">userName</span>, <span class="r104 r">computerName</span>, <span class="r105 r">keyFilePath</span>, <span class="r106 r">port</span>, <span class="r107 r">subsystem</span>)
        {
            <a href="#86fc228db952144a" class="i property">ConnectingTimeout</a> = <span class="r108 r">connectingTimeout</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer is always localhost.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="1d2c97fcabce8639" href="../../../R/1d2c97fcabce8639.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="1dc502701784e942" href="../../../R/1dc502701784e942.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b> { <b>return</b> <b>null</b>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="aedc4429886489fa" href="../../../R/aedc4429886489fa.html" target="n" data-glyph="102,1" class="i property">AuthenticationMechanism</a>
        {
            <b>get</b> { <b>return</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CertificateThumbprint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="36e13631cb12a206" href="../../../R/36e13631cb12a206.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b> { <b>return</b> <b>string</b>.<span class="i">Empty</span>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shallow copy of current instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">NamedPipeConnectionInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="4f24d94698aff6a3" href="../../../R/4f24d94698aff6a3.html" target="n" data-glyph="74,1" class="i method">InternalCopy</a>()
        {
            <a href="#c9fcf5b14ea1c33c" class="t t">SSHConnectionInfo</a> <span id="r109 rd" class="r109 r">newCopy</span> = <b>new</b> <a href="#12f2d94a5220ba18" class="t constructor">SSHConnectionInfo</a>();
            <span class="r109 r">newCopy</span>.<a href="#1d2c97fcabce8639" class="i property">ComputerName</a> = <a href="#1d2c97fcabce8639" class="i property">ComputerName</a>;
            <span class="r109 r">newCopy</span>.<a href="#4b3097733da1ce80" class="i property">UserName</a> = <a href="#4b3097733da1ce80" class="i property">UserName</a>;
            <span class="r109 r">newCopy</span>.<a href="#e7ad66dd7b6bd687" class="i property">KeyFilePath</a> = <a href="#e7ad66dd7b6bd687" class="i property">KeyFilePath</a>;
            <span class="r109 r">newCopy</span>.<a href="#c25be48258669449" class="i property">Port</a> = <a href="#c25be48258669449" class="i property">Port</a>;
            <span class="r109 r">newCopy</span>.<a href="#0df97185dcb0520f" class="i property">Subsystem</a> = <a href="#0df97185dcb0520f" class="i property">Subsystem</a>;
            <span class="r109 r">newCopy</span>.<a href="#86fc228db952144a" class="i property">ConnectingTimeout</a> = <a href="#86fc228db952144a" class="i property">ConnectingTimeout</a>;
 
            <b>return</b> <span class="r109 r">newCopy</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CreateClientSessionTransportManager.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">sessionName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">cryptoHelper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../fanin/BaseTransportManager.cs.html#19883ec4df424177" class="t t">BaseClientSessionTransportManager</a> <a id="cfa5d6e1db7ea474" href="../../../R/cfa5d6e1db7ea474.html" target="n" data-glyph="74,1" class="i method">CreateClientSessionTransportManager</a>(<span class="i">Guid</span> <span id="r110 rd" class="r110 r">instanceId</span>, <b>string</b> <span id="r111 rd" class="r111 r">sessionName</span>, <a href="../../../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r112 rd" class="r112 r">cryptoHelper</span>)
        {
            <b>return</b> <b>new</b> <a href="../fanin/OutOfProcTransportManager.cs.html#c46030bf3f459363" class="t constructor">SSHClientSessionTransportManager</a>(
                <a href="#c9fcf5b14ea1c33c" class="k">this</a>,
                <span class="r110 r">instanceId</span>,
                <span class="r112 r">cryptoHelper</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StartSSHProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="b59200dab1d45d5b" href="../../../R/b59200dab1d45d5b.html" target="n" data-glyph="74,1" class="i method">StartSSHProcess</a>(
            <b>out</b> <span class="i">StreamWriter</span> <span id="r113 rd" class="r113 r">stdInWriterVar</span>,
            <b>out</b> <span class="i">StreamReader</span> <span id="r114 rd" class="r114 r">stdOutReaderVar</span>,
            <b>out</b> <span class="i">StreamReader</span> <span id="r115 rd" class="r115 r">stdErrReaderVar</span>)
        {
            <b>string</b> <span id="r116 rd" class="r116 r">filePath</span> = <b>string</b>.<span class="i">Empty</span>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">            const string sshCommand = &quot;ssh&quot;;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
            <b>const string</b> <span id="r117 rd" class="r117 r">sshCommand</span> = <span class="s">&quot;ssh.exe&quot;</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            <a href="../../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r118 rd" class="r118 r">context</span> = <span class="i n">Runspaces</span>.<a href="../../hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../../hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>if</b> (<span class="r118 r">context</span> != <b>null</b>)
            {
                <a href="../../ApplicationInfo.cs.html#3fe5acebae74c595" class="k">var</a> <span id="r119 rd" class="r119 r">cmdInfo</span> = <span class="r118 r">context</span>.<a href="../../ExecutionContext.cs.html#586b706a65389941" class="i property">CommandDiscovery</a>.<a href="../../CommandDiscovery.cs.html#11f70d945389a48b" class="i method">LookupCommandInfo</a>(<span class="r117 r">sshCommand</span>, <a href="../../SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="../../SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>) <b>as</b> <a href="../../ApplicationInfo.cs.html#3fe5acebae74c595" class="t t">ApplicationInfo</a>;
                <b>if</b> (<span class="r119 r">cmdInfo</span> != <b>null</b>)
                {
                    <span class="r116 r">filePath</span> = <span class="r119 r">cmdInfo</span>.<a href="../../ApplicationInfo.cs.html#fc56d6471804cff1" class="i property">Path</a>;
                }
            }
 
            <span class="c">// Create a local ssh process (client) that conects to a remote sshd process (server) using a &#39;powershell&#39; subsystem.</span>
            <span class="c">//</span>
            <span class="c">// Local ssh invoked as:</span>
            <span class="c">//   windows:</span>
            <span class="c">//     ssh.exe [-i identity_file] [-l login_name] [-p port] -s &lt;destination&gt; &lt;command&gt;</span>
            <span class="c">//   linux|macos:</span>
            <span class="c">//     ssh [-i identity_file] [-l login_name] [-p port] -s &lt;destination&gt; &lt;command&gt;</span>
            <span class="c">// where &lt;command&gt; is interpreted as the subsystem due to the -s flag.</span>
            <span class="c">//</span>
            <span class="c">// Remote sshd configured for PowerShell Remoting Protocol (PSRP) over Secure Shell Protocol (SSH)</span>
            <span class="c">// by adding one of the following Subsystem directives to sshd_config on the remote machine:</span>
            <span class="c">//   windows:</span>
            <span class="c">//     Subsystem powershell C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -SSHServerMode -NoLogo -NoProfile</span>
            <span class="c">//     Subsystem powershell C:\Program Files\PowerShell\6\pwsh.exe -SSHServerMode -NoLogo -NoProfile</span>
            <span class="c">//   linux|macos:</span>
            <span class="c">//     Subsystem powershell /usr/local/bin/pwsh -SSHServerMode -NoLogo -NoProfile</span>
 
            <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">ProcessStartInfo</span> <span id="r120 rd" class="r120 r">startInfo</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">ProcessStartInfo</span>(<span class="r116 r">filePath</span>);
 
            <span class="c">// pass &quot;-i identity_file&quot; command line argument to ssh if KeyFilePath is set</span>
            <span class="c">// if KeyFilePath is not set, then ssh will use IdentityFile / IdentityAgent from ssh_config if defined else none by default</span>
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#e7ad66dd7b6bd687" class="i property">KeyFilePath</a>))
            {
                <b>if</b> (!<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">File</span>.<span class="i">Exists</span>(<a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#e7ad66dd7b6bd687" class="i property">KeyFilePath</a>))
                {
                    <b>throw</b> <b>new</b> <span class="i">FileNotFoundException</span>(
                        <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">KeyFileNotFound</span>, <a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#e7ad66dd7b6bd687" class="i property">KeyFilePath</a>));
                }
 
                <span class="r120 r">startInfo</span>.<span class="i">ArgumentList</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;-i &quot;&quot;{0}&quot;&quot;&quot;</span>, <a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#e7ad66dd7b6bd687" class="i property">KeyFilePath</a>));
            }
 
            <span class="c">// pass &quot;-l login_name&quot; command line argument to ssh if UserName is set</span>
            <span class="c">// if UserName is not set, then ssh will use User from ssh_config if defined else the environment user by default</span>
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#4b3097733da1ce80" class="i property">UserName</a>))
            {
                <b>var</b> <span id="r121 rd" class="r121 r">parts</span> = <a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#4b3097733da1ce80" class="i property">UserName</a>.<span class="i">Split</span>(<a href="../../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../../Utils.cs.html#247bb446a0dd1494" class="i field">Backslash</a>);
                <b>if</b> (<span class="r121 r">parts</span>.<span class="i">Length</span> == 2)
                {
                    <span class="c">// convert DOMAIN\user to user@DOMAIN</span>
                    <b>var</b> <span id="r122 rd" class="r122 r">domainName</span> = <span class="r121 r">parts</span>[0];
                    <b>var</b> <span id="r123 rd" class="r123 r">userName</span> = <span class="r121 r">parts</span>[1];
                    <span class="r120 r">startInfo</span>.<span class="i">ArgumentList</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;-l {0}@{1}&quot;</span>, <span class="r123 r">userName</span>, <span class="r122 r">domainName</span>));
                }
                <b>else</b>
                {
                    <span class="r120 r">startInfo</span>.<span class="i">ArgumentList</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;-l {0}&quot;</span>, <a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#4b3097733da1ce80" class="i property">UserName</a>));
                }
            }
 
            <span class="c">// pass &quot;-p port&quot; command line argument to ssh if Port is set</span>
            <span class="c">// if Port is not set, then ssh will use Port from ssh_config if defined else 22 by default</span>
            <b>if</b> (<a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#c25be48258669449" class="i property">Port</a> != 0)
            {
                <span class="r120 r">startInfo</span>.<span class="i">ArgumentList</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;-p {0}&quot;</span>, <a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#c25be48258669449" class="i property">Port</a>));
            }
 
            <span class="c">// pass &quot;-s destination command&quot; command line arguments to ssh where command is the subsystem to invoke on the destination</span>
            <span class="c">// note that ssh expects IPv6 addresses to not be enclosed in square brackets so trim them if present</span>
            <span class="r120 r">startInfo</span>.<span class="i">ArgumentList</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;-s {0} {1}&quot;</span>, <a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#1d2c97fcabce8639" class="i property">ComputerName</a>.<span class="i">TrimStart</span>(<span class="s">&#39;[&#39;</span>).<span class="i">TrimEnd</span>(<span class="s">&#39;]&#39;</span>), <a href="#c9fcf5b14ea1c33c" class="k">this</a>.<a href="#0df97185dcb0520f" class="i property">Subsystem</a>));
 
            <span class="r120 r">startInfo</span>.<span class="i">WorkingDirectory</span> = <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="r116 r">filePath</span>);
            <span class="r120 r">startInfo</span>.<span class="i">CreateNoWindow</span> = <b>true</b>;
            <span class="r120 r">startInfo</span>.<span class="i">UseShellExecute</span> = <b>false</b>;
 
            <b>return</b> <a href="#ccee023aad82f34f" class="i method">StartSSHProcessImpl</a>(<span class="r120 r">startInfo</span>, <b>out</b> <span class="r113 r">stdInWriterVar</span>, <b>out</b> <span class="r114 r">stdOutReaderVar</span>, <b>out</b> <span class="r115 r">stdErrReaderVar</span>);
        }
 
        <b>internal void</b> <a id="27122d45d622dae3" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">KillSSHProcess</a>(<b>int</b> <span id="r124 rd" class="r124 r">pid</span>)
        {
            <a href="#cae6c92cd606e562" class="i method">KillSSHProcessImpl</a>(<span class="r124 r">pid</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> SSH Process Creation
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">
        /// &lt;summary&gt;
        /// Create a process through managed APIs and returns StdIn, StdOut, StdError reader/writers.
        /// This works for Linux platforms and creates the SSH process in its own session which means
        /// Ctrl+C signals will not propagate from parent (PowerShell) process to SSH process so that
        /// PSRP handles them correctly.
        /// &lt;/summary&gt;
        private static int StartSSHProcessImpl(
            System.Diagnostics.ProcessStartInfo startInfo,
            out StreamWriter stdInWriterVar,
            out StreamReader stdOutReaderVar,
            out StreamReader stdErrReaderVar)
        {
            startInfo.RedirectStandardInput = true;
            startInfo.RedirectStandardOutput = true;
            startInfo.RedirectStandardError = true;
 
            StreamWriter stdInWriter = null;
            StreamReader stdOutReader = null;
            StreamReader stdErrReader = null;
            int pid = StartSSHProcess(
                startInfo,
                ref stdInWriter,
                ref stdOutReader,
                ref stdErrReader);
 
            stdInWriterVar = stdInWriter;
            stdOutReaderVar = stdOutReader;
            stdErrReaderVar = stdErrReader;
 
            return pid;
        }
 
        private static void KillSSHProcessImpl(int pid)
        {
            // killing a zombie might or might not return ESRCH, so we ignore kill&#39;s return value
            Platform.NonWindowsKillProcess(pid);
 
            // block while waiting for process to die
            // shouldn&#39;t take long after SIGKILL
            Platform.NonWindowsWaitPid(pid, false);
        }
 
</span>        <span class="k preprocess">#</span><span class="k preprocess">region</span> UNIX Create Process
<span class="e">
        //
        // This code is based on GitHub DotNet CoreFx
        // It is specific to launching the SSH process for use in
        // SSH based remoting, and is not intended to be general
        // process creation code.
        //
 
        private const int StreamBufferSize = 4096;
        private const int SUPPRESS_PROCESS_SIGINT = 0x00000001;
 
        internal static int StartSSHProcess(
            ProcessStartInfo startInfo,
            ref StreamWriter standardInput,
            ref StreamReader standardOutput,
            ref StreamReader standardError)
        {
            if (startInfo.UseShellExecute)
            {
                throw new PSNotSupportedException();
            }
 
            string filename = startInfo.FileName;
            string[] argv = ParseArgv(startInfo);
            string[] envp = CopyEnvVariables(startInfo);
            string cwd = !string.IsNullOrWhiteSpace(startInfo.WorkingDirectory) ? startInfo.WorkingDirectory : null;
 
            // Invoke the shim fork/execve routine.  It will create pipes for all requested
            // redirects, fork a child process, map the pipe ends onto the appropriate stdin/stdout/stderr
            // descriptors, and execve to execute the requested process.  The shim implementation
            // is used to fork/execve as executing managed code in a forked process is not safe (only
            // the calling thread will transfer, thread IDs aren&#39;t stable across the fork, etc.)
            int childPid, stdinFd, stdoutFd, stderrFd;
            CreateProcess(
                filename, argv, envp, cwd,
                startInfo.RedirectStandardInput, startInfo.RedirectStandardOutput, startInfo.RedirectStandardError,
                SUPPRESS_PROCESS_SIGINT,    // Create SSH process to ignore SIGINT signals
                out childPid,
                out stdinFd, out stdoutFd, out stderrFd);
 
            Debug.Assert(childPid &gt;= 0, &quot;Invalid process id&quot;);
 
            // Configure the parent&#39;s ends of the redirection streams.
            // We use UTF8 encoding without BOM by-default(instead of Console encoding as on Windows)
            // as there is no good way to get this information from the native layer
            // and we do not want to take dependency on Console contract.
            if (startInfo.RedirectStandardInput)
            {
                Debug.Assert(stdinFd &gt;= 0, &quot;Invalid Fd&quot;);
                standardInput = new StreamWriter(OpenStream(stdinFd, FileAccess.Write),
                    Utils.utf8NoBom, StreamBufferSize)
                { AutoFlush = true };
            }
 
            if (startInfo.RedirectStandardOutput)
            {
                Debug.Assert(stdoutFd &gt;= 0, &quot;Invalid Fd&quot;);
                standardOutput = new StreamReader(OpenStream(stdoutFd, FileAccess.Read),
                    startInfo.StandardOutputEncoding ?? Utils.utf8NoBom, true, StreamBufferSize);
            }
 
            if (startInfo.RedirectStandardError)
            {
                Debug.Assert(stderrFd &gt;= 0, &quot;Invalid Fd&quot;);
                standardError = new StreamReader(OpenStream(stderrFd, FileAccess.Read),
                    startInfo.StandardErrorEncoding ?? Utils.utf8NoBom, true, StreamBufferSize);
            }
 
            return childPid;
        }
 
        /// &lt;summary&gt;Opens a stream around the specified file descriptor and with the specified access.&lt;/summary&gt;
        /// &lt;param name=&quot;fd&quot;&gt;The file descriptor.&lt;/param&gt;
        /// &lt;param name=&quot;access&quot;&gt;The access mode.&lt;/param&gt;
        /// &lt;returns&gt;The opened stream.&lt;/returns&gt;
        private static FileStream OpenStream(int fd, FileAccess access)
        {
            Debug.Assert(fd &gt;= 0, &quot;Invalid Fd&quot;);
            return new FileStream(
                new SafeFileHandle((IntPtr)fd, ownsHandle: true),
                access, StreamBufferSize, isAsync: false);
        }
 
        /// &lt;summary&gt;Copies environment variables from ProcessStartInfo &lt;/summary&gt;
        /// &lt;param name=&quot;psi&quot;&gt;ProcessStartInfo.&lt;/param&gt;
        /// &lt;returns&gt;String array of environment key/value pairs.&lt;/returns&gt;
        private static string[] CopyEnvVariables(ProcessStartInfo psi)
        {
            var envp = new string[psi.Environment.Count];
            int index = 0;
            foreach (var pair in psi.Environment)
            {
                envp[index++] = pair.Key + &quot;=&quot; + pair.Value;
            }
 
            return envp;
        }
 
        /// &lt;summary&gt;Converts the filename and arguments information from a ProcessStartInfo into an argv array.&lt;/summary&gt;
        /// &lt;param name=&quot;psi&quot;&gt;The ProcessStartInfo.&lt;/param&gt;
        /// &lt;returns&gt;The argv array.&lt;/returns&gt;
        private static string[] ParseArgv(ProcessStartInfo psi)
        {
            var argvList = new List&lt;string&gt;();
            argvList.Add(psi.FileName);
 
            var argsToParse = String.Join(&quot; &quot;, psi.ArgumentList).Trim();
            var argsLength = argsToParse.Length;
            for (int i = 0; i &lt; argsLength; )
            {
                var iStart = i;
 
                switch (argsToParse[i])
                {
                    case &#39;&quot;&#39;:
                        // Special case for arguments within quotes
                        // Just return argument value within the quotes
                        while ((++i &lt; argsLength) &amp;&amp; argsToParse[i] != &#39;&quot;&#39;) { }
                        if (iStart &lt; argsLength - 1)
                        {
                            iStart++;
                        }
 
                        break;
 
                    default:
                        // Common case for parsing arguments with space character delimiter
                        while ((++i &lt; argsLength) &amp;&amp; argsToParse[i] != &#39; &#39;) { }
                        break;
                }
 
                argvList.Add(argsToParse.Substring(iStart, (i - iStart)));
                while ((++i &lt; argsLength) &amp;&amp; argsToParse[i] == &#39; &#39;) { }
            }
 
            return argvList.ToArray();
        }
 
        internal static unsafe void CreateProcess(
            string filename, string[] argv, string[] envp, string cwd,
            bool redirectStdin, bool redirectStdout, bool redirectStderr, int creationFlags,
            out int lpChildPid, out int stdinFd, out int stdoutFd, out int stderrFd)
        {
            byte** argvPtr = null, envpPtr = null;
            try
            {
                AllocNullTerminatedArray(argv, ref argvPtr);
                AllocNullTerminatedArray(envp, ref envpPtr);
                int result = ForkAndExecProcess(
                    filename, argvPtr, envpPtr, cwd,
                    redirectStdin ? 1 : 0, redirectStdout ? 1 : 0, redirectStderr ? 1 : 0, creationFlags,
                    out lpChildPid, out stdinFd, out stdoutFd, out stderrFd);
                if (result != 0)
                {
                    // Normally we&#39;d simply make this method return the result of the native
                    // call and allow the caller to use GetLastWin32Error.  However, we need
                    // to free the native arrays after calling the function, and doing so
                    // stomps on the runtime&#39;s captured last error.  So we need to access the
                    // error here, and without SetLastWin32Error available, we can&#39;t propagate
                    // the error to the caller via the normal GetLastWin32Error mechanism.  We could
                    // return 0 on success or the GetLastWin32Error value on failure, but that&#39;s
                    // technically ambiguous, in the case of a failure with a 0 errno.  Simplest
                    // solution then is just to throw here the same exception the Process caller
                    // would have.  This can be revisited if we ever have another call site.
                    throw new Win32Exception();
                }
            }
            finally
            {
                FreeArray(envpPtr, envp.Length);
                FreeArray(argvPtr, argv.Length);
            }
        }
 
        private static unsafe void AllocNullTerminatedArray(string[] arr, ref byte** arrPtr)
        {
            int arrLength = arr.Length + 1; // +1 is for null termination
 
            // Allocate the unmanaged array to hold each string pointer.
            // It needs to have an extra element to null terminate the array.
            arrPtr = (byte**)Marshal.AllocHGlobal(sizeof(IntPtr) * arrLength);
            System.Diagnostics.Debug.Assert(arrPtr != null, &quot;Invalid array ptr&quot;);
 
            // Zero the memory so that if any of the individual string allocations fails,
            // we can loop through the array to free any that succeeded.
            // The last element will remain null.
            for (int i = 0; i &lt; arrLength; i++)
            {
                arrPtr[i] = null;
            }
 
            // Now copy each string to unmanaged memory referenced from the array.
            // We need the data to be an unmanaged, null-terminated array of UTF8-encoded bytes.
            for (int i = 0; i &lt; arr.Length; i++)
            {
                byte[] byteArr = System.Text.Encoding.UTF8.GetBytes(arr[i]);
 
                arrPtr[i] = (byte*)Marshal.AllocHGlobal(byteArr.Length + 1); // +1 for null termination
                System.Diagnostics.Debug.Assert(arrPtr[i] != null, &quot;Invalid array ptr&quot;);
 
                Marshal.Copy(byteArr, 0, (IntPtr)arrPtr[i], byteArr.Length); // copy over the data from the managed byte array
                arrPtr[i][byteArr.Length] = (byte)&#39;\0&#39;; // null terminate
            }
        }
 
        private static unsafe void FreeArray(byte** arr, int length)
        {
            if (arr != null)
            {
                // Free each element of the array
                for (int i = 0; i &lt; length; i++)
                {
                    if (arr[i] != null)
                    {
                        Marshal.FreeHGlobal((IntPtr)arr[i]);
                        arr[i] = null;
                    }
                }
 
                // And then the array itself
                Marshal.FreeHGlobal((IntPtr)arr);
            }
        }
 
        [DllImport(&quot;libpsl-native&quot;, CharSet = CharSet.Ansi, SetLastError = true)]
        internal static extern unsafe int ForkAndExecProcess(
            string filename, byte** argv, byte** envp, string cwd,
            int redirectStdin, int redirectStdout, int redirectStderr, int creationFlags,
            out int lpChildPid, out int stdinFd, out int stdoutFd, out int stderrFd);
 
</span>        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
<span class="e">
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a process through native Win32 APIs and return StdIn, StdOut, StdError reader/writers</span>
        <span class="c">///</span><span class="c"> This needs to be done via Win32 APIs because managed code creates anonymous synchronous pipes</span>
        <span class="c">///</span><span class="c"> for redirected StdIn/Out and SSH (and PSRP) require asynchronous (overlapped) pipes, which must</span>
        <span class="c">///</span><span class="c"> be through named pipes.  Managed code for named pipes is unreliable and so this is done via</span>
        <span class="c">///</span><span class="c"> P-Invoking native APIs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="ccee023aad82f34f" href="../../../R/ccee023aad82f34f.html" target="n" data-glyph="76,1" class="i method">StartSSHProcessImpl</a>(
            <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">ProcessStartInfo</span> <span id="r125 rd" class="r125 r">startInfo</span>,
            <b>out</b> <span class="i">StreamWriter</span> <span id="r126 rd" class="r126 r">stdInWriterVar</span>,
            <b>out</b> <span class="i">StreamReader</span> <span id="r127 rd" class="r127 r">stdOutReaderVar</span>,
            <b>out</b> <span class="i">StreamReader</span> <span id="r128 rd" class="r128 r">stdErrReaderVar</span>)
        {
            <span class="i">Exception</span> <span id="r129 rd" class="r129 r">ex</span> = <b>null</b>;
            <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Process</span> <span id="r130 rd" class="r130 r">sshProcess</span> = <b>null</b>;
            <span class="c">//</span>
            <span class="c">// These std pipe handles are bound to managed Reader/Writer objects and returned to the transport</span>
            <span class="c">// manager object, which uses them for PSRP communication.  The lifetime of these handles are then</span>
            <span class="c">// tied to the reader/writer objects which the transport is responsible for disposing (see</span>
            <span class="c">// SSHClientSessionTransportManger and the CloseConnection() method.</span>
            <span class="c">//</span>
            <span class="i">SafePipeHandle</span> <span id="r131 rd" class="r131 r">stdInPipeServer</span> = <b>null</b>;
            <span class="i">SafePipeHandle</span> <span id="r132 rd" class="r132 r">stdOutPipeServer</span> = <b>null</b>;
            <span class="i">SafePipeHandle</span> <span id="r133 rd" class="r133 r">stdErrPipeServer</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r130 r">sshProcess</span> = <span class="i">CreateProcessWithRedirectedStd</span>(
                    <span class="r125 r">startInfo</span>,
                    <b>out</b> <span class="r131 r">stdInPipeServer</span>,
                    <b>out</b> <span class="r132 r">stdOutPipeServer</span>,
                    <b>out</b> <span class="r133 r">stdErrPipeServer</span>);
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r134 rd" class="r134 r">e</span>) { <span class="r129 r">ex</span> = <span class="r134 r">e</span>; }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r135 rd" class="r135 r">e</span>) { <span class="r129 r">ex</span> = <span class="r135 r">e</span>; }
            <b>catch</b> (<span class="i">FileNotFoundException</span> <span id="r136 rd" class="r136 r">e</span>) { <span class="r129 r">ex</span> = <span class="r136 r">e</span>; }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">ComponentModel</span>.<span class="i">Win32Exception</span> <span id="r137 rd" class="r137 r">e</span>) { <span class="r129 r">ex</span> = <span class="r137 r">e</span>; }
 
            <b>if</b> ((<span class="r129 r">ex</span> != <b>null</b>) ||
                (<span class="r130 r">sshProcess</span> == <b>null</b>) ||
                (<span class="r130 r">sshProcess</span>.<span class="i">HasExited</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(
                    <a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CannotStartSSHClient</span>, (<span class="r129 r">ex</span> != <b>null</b>) ? <span class="r129 r">ex</span>.<span class="i">Message</span> : <b>string</b>.<span class="i">Empty</span>),
                    <span class="r129 r">ex</span>);
            }
 
            <span class="c">// Create the std in writer/readers needed for communication with ssh.exe.</span>
            <span class="r126 r">stdInWriterVar</span> = <b>null</b>;
            <span class="r127 r">stdOutReaderVar</span> = <b>null</b>;
            <span class="r128 r">stdErrReaderVar</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r126 r">stdInWriterVar</span> = <b>new</b> <span class="i">StreamWriter</span>(<b>new</b> <span class="i">NamedPipeServerStream</span>(<span class="i">PipeDirection</span>.<span class="i">Out</span>, <b>true</b>, <b>true</b>, <span class="r131 r">stdInPipeServer</span>));
                <span class="r127 r">stdOutReaderVar</span> = <b>new</b> <span class="i">StreamReader</span>(<b>new</b> <span class="i">NamedPipeServerStream</span>(<span class="i">PipeDirection</span>.<span class="i">In</span>, <b>true</b>, <b>true</b>, <span class="r132 r">stdOutPipeServer</span>));
                <span class="r128 r">stdErrReaderVar</span> = <b>new</b> <span class="i">StreamReader</span>(<b>new</b> <span class="i">NamedPipeServerStream</span>(<span class="i">PipeDirection</span>.<span class="i">In</span>, <b>true</b>, <b>true</b>, <span class="r133 r">stdErrPipeServer</span>));
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <b>if</b> (<span class="r126 r">stdInWriterVar</span> != <b>null</b>) { <span class="r126 r">stdInWriterVar</span>.<span class="i">Dispose</span>(); } <b>else</b> { <span class="r131 r">stdInPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r127 r">stdOutReaderVar</span> != <b>null</b>) { <span class="r126 r">stdInWriterVar</span>.<span class="i">Dispose</span>(); } <b>else</b> { <span class="r132 r">stdOutPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r128 r">stdErrReaderVar</span> != <b>null</b>) { <span class="r126 r">stdInWriterVar</span>.<span class="i">Dispose</span>(); } <b>else</b> { <span class="r133 r">stdErrPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>throw</b>;
            }
 
            <b>return</b> <span class="r130 r">sshProcess</span>.<span class="i">Id</span>;
        }
 
        <b>private static void</b> <a id="cae6c92cd606e562" href="../../../R/cae6c92cd606e562.html" target="n" data-glyph="76,1" class="i method">KillSSHProcessImpl</a>(<b>int</b> <span id="r138 rd" class="r138 r">pid</span>)
        {
            <b>using</b> (<b>var</b> <span id="r139 rd" class="r139 r">sshProcess</span> = <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Process</span>.<span class="i">GetProcessById</span>(<span class="r138 r">pid</span>))
            {
                <b>if</b> ((<span class="r139 r">sshProcess</span> != <b>null</b>) &amp;&amp; (<span class="r139 r">sshProcess</span>.<span class="i">Handle</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>) &amp;&amp; !<span class="r139 r">sshProcess</span>.<span class="i">HasExited</span>)
                {
                    <span class="r139 r">sshProcess</span>.<span class="i">Kill</span>();
                }
            }
        }
 
        <span class="c">// Process creation flags</span>
        <b>private const int</b> <a id="52fe1f1336160499" href="../../../R/52fe1f1336160499.html" target="n" data-glyph="10,1" class="i field">CREATE_NEW_PROCESS_GROUP</a> = 0x00000200;
        <b>private const int</b> <a id="6dcd1a5c14651677" href="../../../R/6dcd1a5c14651677.html" target="n" data-glyph="10,1" class="i field">CREATE_SUSPENDED</a> = 0x00000004;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CreateProcessWithRedirectedStd.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Process</span> <a id="a6c9cc4a51b50b72" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CreateProcessWithRedirectedStd</a>(
            <span class="i">ProcessStartInfo</span> <span id="r140 rd" class="r140 r">startInfo</span>,
            <b>out</b> <span class="i">SafePipeHandle</span> <span id="r141 rd" class="r141 r">stdInPipeServer</span>,
            <b>out</b> <span class="i">SafePipeHandle</span> <span id="r142 rd" class="r142 r">stdOutPipeServer</span>,
            <b>out</b> <span class="i">SafePipeHandle</span> <span id="r143 rd" class="r143 r">stdErrPipeServer</span>)
        {
            <span class="c">//</span>
            <span class="c">// Create named (async) pipes for reading/writing to std.</span>
            <span class="c">//</span>
            <span class="r141 r">stdInPipeServer</span> = <b>null</b>;
            <span class="r142 r">stdOutPipeServer</span> = <b>null</b>;
            <span class="r143 r">stdErrPipeServer</span> = <b>null</b>;
            <span class="i">SafePipeHandle</span> <span id="r144 rd" class="r144 r">stdInPipeClient</span> = <b>null</b>;
            <span class="i">SafePipeHandle</span> <span id="r145 rd" class="r145 r">stdOutPipeClient</span> = <b>null</b>;
            <span class="i">SafePipeHandle</span> <span id="r146 rd" class="r146 r">stdErrPipeClient</span> = <b>null</b>;
            <b>string</b> <span id="r147 rd" class="r147 r">randomName</span> = <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetRandomFileName</span>());
 
            <b>try</b>
            {
                <span class="c">// Get default pipe security (Admin and current user access)</span>
                <b>var</b> <span id="r148 rd" class="r148 r">securityDesc</span> = <a href="RemoteSessionNamedPipe.cs.html#c14a08ba7cdb8bb2" class="t t">RemoteSessionNamedPipeServer</a>.<a href="RemoteSessionNamedPipe.cs.html#a02bc6bbd5e5ab58" class="i method">GetServerPipeSecurity</a>();
 
                <b>var</b> <span id="r149 rd" class="r149 r">stdInPipeName</span> = <span class="s">@&quot;\\.\pipe\StdIn&quot;</span> + <span class="r147 r">randomName</span>;
                <span class="r141 r">stdInPipeServer</span> = <span class="i">CreateNamedPipe</span>(<span class="r149 r">stdInPipeName</span>, <span class="r148 r">securityDesc</span>);
                <span class="r144 r">stdInPipeClient</span> = <span class="i">GetNamedPipeHandle</span>(<span class="r149 r">stdInPipeName</span>);
 
                <b>var</b> <span id="r150 rd" class="r150 r">stdOutPipeName</span> = <span class="s">@&quot;\\.\pipe\StdOut&quot;</span> + <span class="r147 r">randomName</span>;
                <span class="r142 r">stdOutPipeServer</span> = <span class="i">CreateNamedPipe</span>(<span class="r150 r">stdOutPipeName</span>, <span class="r148 r">securityDesc</span>);
                <span class="r145 r">stdOutPipeClient</span> = <span class="i">GetNamedPipeHandle</span>(<span class="r150 r">stdOutPipeName</span>);
 
                <b>var</b> <span id="r151 rd" class="r151 r">stdErrPipeName</span> = <span class="s">@&quot;\\.\pipe\StdErr&quot;</span> + <span class="r147 r">randomName</span>;
                <span class="r143 r">stdErrPipeServer</span> = <span class="i">CreateNamedPipe</span>(<span class="r151 r">stdErrPipeName</span>, <span class="r148 r">securityDesc</span>);
                <span class="r146 r">stdErrPipeClient</span> = <span class="i">GetNamedPipeHandle</span>(<span class="r151 r">stdErrPipeName</span>);
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <b>if</b> (<span class="r141 r">stdInPipeServer</span> != <b>null</b>) { <span class="r141 r">stdInPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r144 r">stdInPipeClient</span> != <b>null</b>) { <span class="r144 r">stdInPipeClient</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r142 r">stdOutPipeServer</span> != <b>null</b>) { <span class="r142 r">stdOutPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r145 r">stdOutPipeClient</span> != <b>null</b>) { <span class="r145 r">stdOutPipeClient</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r143 r">stdErrPipeServer</span> != <b>null</b>) { <span class="r143 r">stdErrPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r146 r">stdErrPipeClient</span> != <b>null</b>) { <span class="r146 r">stdErrPipeClient</span>.<span class="i">Dispose</span>(); }
 
                <b>throw</b>;
            }
 
            <span class="c">// Create process</span>
            <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#208aea11e39bcbec" class="t t">STARTUPINFO</a> <span id="r152 rd" class="r152 r">lpStartupInfo</span> = <b>new</b> <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#0d3cb46978876e5a" class="t constructor">STARTUPINFO</a>();
            <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#ea19886114ee9b7b" class="t t">PROCESS_INFORMATION</a> <span id="r153 rd" class="r153 r">lpProcessInformation</span> = <b>new</b> <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#c12e3b6f5f8c76b7" class="t constructor">PROCESS_INFORMATION</a>();
            <b>int</b> <span id="r154 rd" class="r154 r">creationFlags</span> = 0;
 
            <b>try</b>
            {
                <span class="c">// Create process start command line with filename and argument list.</span>
                <b>var</b> <span id="r155 rd" class="r155 r">cmdLine</span> = <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <span class="s">@&quot;&quot;&quot;{0}&quot;&quot; {1}&quot;</span>,
                    <span class="r140 r">startInfo</span>.<span class="i">FileName</span>,
                    <b>string</b>.<span class="i">Join</span>(<span class="s">&#39; &#39;</span>, <span class="r140 r">startInfo</span>.<span class="i">ArgumentList</span>));
 
                <span class="r152 r">lpStartupInfo</span>.<a href="../../../utils/PlatformInvokes.cs.html#5f15e99b334f39bf" class="i field">hStdInput</a> = <b>new</b> <span class="i">SafeFileHandle</span>(<span class="r144 r">stdInPipeClient</span>.<span class="i">DangerousGetHandle</span>(), <b>false</b>);
                <span class="r152 r">lpStartupInfo</span>.<a href="../../../utils/PlatformInvokes.cs.html#a830498ef4131916" class="i field">hStdOutput</a> = <b>new</b> <span class="i">SafeFileHandle</span>(<span class="r145 r">stdOutPipeClient</span>.<span class="i">DangerousGetHandle</span>(), <b>false</b>);
                <span class="r152 r">lpStartupInfo</span>.<a href="../../../utils/PlatformInvokes.cs.html#25906a0e9a876031" class="i field">hStdError</a> = <b>new</b> <span class="i">SafeFileHandle</span>(<span class="r146 r">stdErrPipeClient</span>.<span class="i">DangerousGetHandle</span>(), <b>false</b>);
                <span class="r152 r">lpStartupInfo</span>.<a href="../../../utils/PlatformInvokes.cs.html#471583ec52bcbc40" class="i field">dwFlags</a> = 0x100;
 
                <span class="c">// No new window: Inherit the parent process&#39;s console window</span>
                <span class="r154 r">creationFlags</span> = 0x00000000;
 
                <span class="c">// Create the new process in its own group, so that Ctrl+C is not sent to ssh.exe.  We want to handle this</span>
                <span class="c">// control signal internally so that it can be passed via PSRP to the remote session.</span>
                <span class="r154 r">creationFlags</span> |= <a href="#52fe1f1336160499" class="i field">CREATE_NEW_PROCESS_GROUP</a>;
 
                <span class="c">// Create the new process suspended so we have a chance to get a corresponding Process object in case it terminates quickly.</span>
                <span class="r154 r">creationFlags</span> |= <a href="#6dcd1a5c14651677" class="i field">CREATE_SUSPENDED</a>;
 
                <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#5ff6c3ee389c8fe3" class="t t">SECURITY_ATTRIBUTES</a> <span id="r156 rd" class="r156 r">lpProcessAttributes</span> = <b>new</b> <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#5d86d82b0979b477" class="t constructor">SECURITY_ATTRIBUTES</a>();
                <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#5ff6c3ee389c8fe3" class="t t">SECURITY_ATTRIBUTES</a> <span id="r157 rd" class="r157 r">lpThreadAttributes</span> = <b>new</b> <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#5d86d82b0979b477" class="t constructor">SECURITY_ATTRIBUTES</a>();
                <b>bool</b> <span id="r158 rd" class="r158 r">success</span> = <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<span class="i">CreateProcess</span>(
                    <b>null</b>,
                    <span class="r155 r">cmdLine</span>,
                    <span class="r156 r">lpProcessAttributes</span>,
                    <span class="r157 r">lpThreadAttributes</span>,
                    <b>true</b>,
                    <span class="r154 r">creationFlags</span>,
                    <span class="i">IntPtr</span>.<span class="i">Zero</span>,
                    <span class="r140 r">startInfo</span>.<span class="i">WorkingDirectory</span>,
                    <span class="r152 r">lpStartupInfo</span>,
                    <span class="r153 r">lpProcessInformation</span>);
 
                <b>if</b> (!<span class="r158 r">success</span>)
                {
                    <b>throw</b> <b>new</b> <span class="i">Win32Exception</span>(<span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>());
                }
 
                <span class="c">// At this point, we should have a suspended process.  Get the .Net Process object, resume the process, and return.</span>
                <span class="i">Process</span> <span id="r159 rd" class="r159 r">result</span> = <span class="i">Process</span>.<span class="i">GetProcessById</span>(<span class="r153 r">lpProcessInformation</span>.<a href="../../../utils/PlatformInvokes.cs.html#0a3cbb380fdd7c4f" class="i field">dwProcessId</a>);
                <b>uint</b> <span id="r160 rd" class="r160 r">returnValue</span> = <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#0a4db853ebeabb70" class="i method">ResumeThread</a>(<span class="r153 r">lpProcessInformation</span>.<a href="../../../utils/PlatformInvokes.cs.html#b7f1b530778f8c58" class="i field">hThread</a>);
 
                <b>if</b> (<span class="r160 r">returnValue</span> == <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#f12582d977629938" class="i field">RESUME_THREAD_FAILED</a>)
                {
                    <b>throw</b> <b>new</b> <span class="i">Win32Exception</span>(<span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>());
                }
 
                <b>return</b> <span class="r159 r">result</span>;
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <b>if</b> (<span class="r141 r">stdInPipeServer</span> != <b>null</b>) { <span class="r141 r">stdInPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r144 r">stdInPipeClient</span> != <b>null</b>) { <span class="r144 r">stdInPipeClient</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r142 r">stdOutPipeServer</span> != <b>null</b>) { <span class="r142 r">stdOutPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r145 r">stdOutPipeClient</span> != <b>null</b>) { <span class="r145 r">stdOutPipeClient</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r143 r">stdErrPipeServer</span> != <b>null</b>) { <span class="r143 r">stdErrPipeServer</span>.<span class="i">Dispose</span>(); }
 
                <b>if</b> (<span class="r146 r">stdErrPipeClient</span> != <b>null</b>) { <span class="r146 r">stdErrPipeClient</span>.<span class="i">Dispose</span>(); }
 
                <b>throw</b>;
            }
            <b>finally</b>
            {
                <span class="r153 r">lpProcessInformation</span>.<a href="../../../utils/PlatformInvokes.cs.html#252f5a616f09831f" class="i method">Dispose</a>();
            }
        }
 
        <b>private static</b> <span class="i">SafePipeHandle</span> <a id="11f3864cf65ecf1e" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetNamedPipeHandle</a>(<b>string</b> <span id="r161 rd" class="r161 r">pipeName</span>)
        {
            <span class="c">// Get handle to pipe.</span>
            <b>var</b> <span id="r162 rd" class="r162 r">fileHandle</span> = <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<span class="i">CreateFileW</span>(
                <span class="i">lpFileName</span>: <span class="r161 r">pipeName</span>,
                <span class="i">dwDesiredAccess</span>: <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#7fedf55d4132caa2" class="i field">GENERIC_READ</a> | <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#46f75be52612c475" class="i field">GENERIC_WRITE</a>,
                <span class="i">dwShareMode</span>: 0,
                <span class="i">lpSecurityAttributes</span>: <b>new</b> <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#5d86d82b0979b477" class="t constructor">SECURITY_ATTRIBUTES</a>(), <span class="c">// Create an inheritable handle.</span>
                <span class="i">dwCreationDisposition</span>: <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#8d8fe3c5dd8c1316" class="i field">OPEN_EXISTING</a>,
                <span class="i">dwFlagsAndAttributes</span>: <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#8be98ead3ee5e490" class="i field">FILE_FLAG_OVERLAPPED</a>, <span class="c">// Open in asynchronous mode.</span>
                <span class="i">hTemplateFile</span>: <span class="i">IntPtr</span>.<span class="i">Zero</span>);
 
            <b>int</b> <span id="r163 rd" class="r163 r">lastError</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r162 r">fileHandle</span> == <a href="../../../utils/PlatformInvokes.cs.html#efe149a5eeb6ff14" class="t t">PlatformInvokes</a>.<a href="../../../utils/PlatformInvokes.cs.html#6a9b337c9725f262" class="i field">INVALID_HANDLE_VALUE</a>)
            {
                <b>throw</b> <b>new</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>.<span class="i">Win32Exception</span>(<span class="r163 r">lastError</span>);
            }
 
            <b>return</b> <b>new</b> <span class="i">SafePipeHandle</span>(<span class="r162 r">fileHandle</span>, <b>true</b>);
        }
 
        <b>private static</b> <span class="i">SafePipeHandle</span> <a id="2fdb7877197e0ed7" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CreateNamedPipe</a>(
            <b>string</b> <span id="r164 rd" class="r164 r">pipeName</span>,
            <span class="i">CommonSecurityDescriptor</span> <span id="r165 rd" class="r165 r">securityDesc</span>)
        {
            <span class="c">// Create optional security attributes based on provided PipeSecurity.</span>
            <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#aa84de349d2b40d6" class="t t">SECURITY_ATTRIBUTES</a> <span id="r166 rd" class="r166 r">securityAttributes</span> = <b>null</b>;
            <span class="i">GCHandle</span>? <span id="r167 rd" class="r167 r">securityDescHandle</span> = <b>null</b>;
            <b>if</b> (<span class="r165 r">securityDesc</span> != <b>null</b>)
            {
                <b>byte</b>[] <span id="r168 rd" class="r168 r">securityDescBuffer</span> = <b>new</b> <b>byte</b>[<span class="r165 r">securityDesc</span>.<span class="i">BinaryLength</span>];
                <span class="r165 r">securityDesc</span>.<span class="i">GetBinaryForm</span>(<span class="r168 r">securityDescBuffer</span>, 0);
                <span class="r167 r">securityDescHandle</span> = <span class="i">GCHandle</span>.<span class="i">Alloc</span>(<span class="r168 r">securityDescBuffer</span>, <span class="i">GCHandleType</span>.<span class="i">Pinned</span>);
                <span class="r166 r">securityAttributes</span> = <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<span class="i">GetSecurityAttributes</span>(<span class="r167 r">securityDescHandle</span>.<span class="i">Value</span>, <b>true</b>);
            }
 
            <span class="c">// Create async named pipe.</span>
            <span class="i">SafePipeHandle</span> <span id="r169 rd" class="r169 r">pipeHandle</span> = <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<span class="i">CreateNamedPipe</span>(
                <span class="r164 r">pipeName</span>,
                <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#e2c1b7222f3857ae" class="i field">PIPE_ACCESS_DUPLEX</a> | <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#9cd7eb971c1df255" class="i field">FILE_FLAG_FIRST_PIPE_INSTANCE</a> | <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#8be98ead3ee5e490" class="i field">FILE_FLAG_OVERLAPPED</a>,
                <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#1d99eb627efb4ed4" class="i field">PIPE_TYPE_MESSAGE</a> | <a href="RemoteSessionNamedPipe.cs.html#98d00e2818535eae" class="t t">NamedPipeNative</a>.<a href="RemoteSessionNamedPipe.cs.html#babae4e5651bdcf4" class="i field">PIPE_READMODE_MESSAGE</a>,
                1,
                32768,
                32768,
                0,
                <span class="r166 r">securityAttributes</span>);
 
            <b>int</b> <span id="r170 rd" class="r170 r">lastError</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r167 r">securityDescHandle</span> != <b>null</b>)
            {
                <span class="r167 r">securityDescHandle</span>.<span class="i">Value</span>.<span class="i">Free</span>();
            }
 
            <b>if</b> (<span class="r169 r">pipeHandle</span>.<span class="i">IsInvalid</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">Win32Exception</span>(<span class="r170 r">lastError</span>);
            }
 
            <b>return</b> <span class="r169 r">pipeHandle</span>;
        }
 
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The class that contains connection information for a remote session between a local host</span>
    <span class="c">///</span><span class="c"> and VM. The local host can be a VM in nested scenario.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="3906a420e89ab01e" href="../../../R/3906a420e89ab01e.html" target="n" data-glyph="0,0" class="t t">VMConnectionInfo</a> : <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="22a931c33b3a21e0" href="../../../R/22a931c33b3a21e0.html" target="n" data-glyph="46,1" class="i field">_authMechanism</a>;
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="053b92d97ee327e5" href="../../../R/053b92d97ee327e5.html" target="n" data-glyph="46,1" class="i field">_credential</a>;
 
        <b>private const int</b> <a id="7dac9c773958521f" href="../../../R/7dac9c773958521f.html" target="n" data-glyph="10,1" class="i field">_defaultOpenTimeout</a> = 20000; <span class="c">/* 20 seconds. */</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> GUID of the target VM.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="74cd8e4ebf0317df" href="../../../R/74cd8e4ebf0317df.html" target="n" data-glyph="102,1" class="i property">VMGuid</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Configuration name of the VM session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="40e4e88d20abe582" href="../../../R/40e4e88d20abe582.html" target="n" data-glyph="102,1" class="i property">ConfigurationName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication mechanism to use while connecting to the server.</span>
        <span class="c">///</span><span class="c"> Only Default is supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="8f6b42235659d08d" href="../../../R/8f6b42235659d08d.html" target="n" data-glyph="102,1" class="i property">AuthenticationMechanism</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#22a931c33b3a21e0" class="i field">_authMechanism</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> != <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">IPCSupportsOnlyDefaultAuth</span>,
                        <b>value</b>.<span class="i">ToString</span>(), <b>nameof</b>(<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>));
                }
 
                <a href="#22a931c33b3a21e0" class="i field">_authMechanism</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ThumbPrint of a certificate used for connecting to a remote machine.</span>
        <span class="c">///</span><span class="c"> When this is specified, you dont need to supply credential and authentication</span>
        <span class="c">///</span><span class="c"> mechanism.</span>
        <span class="c">///</span><span class="c"> Will always be null to signify that this is not supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="e1f99da291e0e9aa" href="../../../R/e1f99da291e0e9aa.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b> { <b>return</b> <b>null</b>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential used for the connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="c860420833d917b0" href="../../../R/c860420833d917b0.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#053b92d97ee327e5" class="i field">_credential</a>;
            }
 
            <b>set</b>
            {
                <a href="#053b92d97ee327e5" class="i field">_credential</a> = <b>value</b>;
                <a href="#22a931c33b3a21e0" class="i field">_authMechanism</a> = <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target VM.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="2b06b6861e222ac4" href="../../../R/2b06b6861e222ac4.html" target="n" data-glyph="102,1" class="i property">ComputerName</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal override</b> <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="d0f9fb834dbdcc39" href="../../../R/d0f9fb834dbdcc39.html" target="n" data-glyph="74,1" class="i method">InternalCopy</a>()
        {
            <a href="#3906a420e89ab01e" class="t t">VMConnectionInfo</a> <span id="r171 rd" class="r171 r">result</span> = <b>new</b> <a href="#14edb95257658f82" class="t constructor">VMConnectionInfo</a>(<a href="#c860420833d917b0" class="i property">Credential</a>, <a href="#74cd8e4ebf0317df" class="i property">VMGuid</a>, <a href="#2b06b6861e222ac4" class="i property">ComputerName</a>, <a href="#40e4e88d20abe582" class="i property">ConfigurationName</a>);
            <b>return</b> <span class="r171 r">result</span>;
        }
 
        <b>internal override</b> <a href="../fanin/BaseTransportManager.cs.html#19883ec4df424177" class="t t">BaseClientSessionTransportManager</a> <a id="d3788fe00956a22b" href="../../../R/d3788fe00956a22b.html" target="n" data-glyph="74,1" class="i method">CreateClientSessionTransportManager</a>(<span class="i">Guid</span> <span id="r172 rd" class="r172 r">instanceId</span>, <b>string</b> <span id="r173 rd" class="r173 r">sessionName</span>, <a href="../../../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r174 rd" class="r174 r">cryptoHelper</span>)
        {
            <b>return</b> <b>new</b> <a href="../fanin/OutOfProcTransportManager.cs.html#b4dbc7a9f1f5d82f" class="t constructor">VMHyperVSocketClientSessionTransportManager</a>(
                <a href="#3906a420e89ab01e" class="k">this</a>,
                <span class="r172 r">instanceId</span>,
                <span class="r174 r">cryptoHelper</span>,
                <a href="#74cd8e4ebf0317df" class="i property">VMGuid</a>,
                <a href="#40e4e88d20abe582" class="i property">ConfigurationName</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a connection info instance used to create a runspace on target VM.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="14edb95257658f82" href="../../../R/14edb95257658f82.html" target="n" data-glyph="74,1" class="t constructor">VMConnectionInfo</a>(
            <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r175 rd" class="r175 r">credential</span>,
            <span class="i">Guid</span> <span id="r176 rd" class="r176 r">vmGuid</span>,
            <b>string</b> <span id="r177 rd" class="r177 r">vmName</span>,
            <b>string</b> <span id="r178 rd" class="r178 r">configurationName</span>)
            : <b>base</b>()
        {
            <a href="#c860420833d917b0" class="i property">Credential</a> = <span class="r175 r">credential</span>;
            <a href="#74cd8e4ebf0317df" class="i property">VMGuid</a> = <span class="r176 r">vmGuid</span>;
            <a href="#2b06b6861e222ac4" class="i property">ComputerName</a> = <span class="r177 r">vmName</span>;
            <a href="#40e4e88d20abe582" class="i property">ConfigurationName</a> = <span class="r178 r">configurationName</span>;
 
            <a href="#8f6b42235659d08d" class="i property">AuthenticationMechanism</a> = <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
            <a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <a href="#7dac9c773958521f" class="i field">_defaultOpenTimeout</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The class that contains connection information for a remote session between a local</span>
    <span class="c">///</span><span class="c"> container host and container.</span>
    <span class="c">///</span><span class="c"> For Windows Server container, the transport is based on named pipe for now.</span>
    <span class="c">///</span><span class="c"> For Hyper-V container, the transport is based on Hyper-V socket.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="d2be2d5c63c76391" href="../../../R/d2be2d5c63c76391.html" target="n" data-glyph="0,0" class="t t">ContainerConnectionInfo</a> : <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="9e359c47ca2ef3df" href="../../../R/9e359c47ca2ef3df.html" target="n" data-glyph="46,1" class="i field">_authMechanism</a>;
        <b>private</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="f68d55c1602e67f4" href="../../../R/f68d55c1602e67f4.html" target="n" data-glyph="46,1" class="i field">_credential</a>;
 
        <b>private const int</b> <a id="91e3d16e992c9a9c" href="../../../R/91e3d16e992c9a9c.html" target="n" data-glyph="10,1" class="i field">_defaultOpenTimeout</a> = 20000; <span class="c">/* 20 seconds. */</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ContainerProcess class instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#328c30109a9a72b1" class="t t">ContainerProcess</a> <a id="ee338ee5bc920bf9" href="../../../R/ee338ee5bc920bf9.html" target="n" data-glyph="104,1" class="i property">ContainerProc</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Authentication mechanism to use while connecting to the server.</span>
        <span class="c">///</span><span class="c"> Only Default is supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a> <a id="8a644a89deee446f" href="../../../R/8a644a89deee446f.html" target="n" data-glyph="102,1" class="i property">AuthenticationMechanism</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9e359c47ca2ef3df" class="i field">_authMechanism</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> != <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>)
                {
                    <b>throw</b> <a href="../../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">IPCSupportsOnlyDefaultAuth</span>,
                        <b>value</b>.<span class="i">ToString</span>(), <b>nameof</b>(<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>));
                }
 
                <a href="#9e359c47ca2ef3df" class="i field">_authMechanism</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ThumbPrint of a certificate used for connecting to a remote machine.</span>
        <span class="c">///</span><span class="c"> When this is specified, you dont need to supply credential and authentication</span>
        <span class="c">///</span><span class="c"> mechanism.</span>
        <span class="c">///</span><span class="c"> Will always be null to signify that this is not supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="484247a30bfbad15" href="../../../R/484247a30bfbad15.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b> { <b>return</b> <b>null</b>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential used for the connection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override</b> <a href="../../Credential.cs.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="4dcd4f2b83a5d9a9" href="../../../R/4dcd4f2b83a5d9a9.html" target="n" data-glyph="102,1" class="i property">Credential</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f68d55c1602e67f4" class="i field">_credential</a>;
            }
 
            <b>set</b>
            {
                <a href="#f68d55c1602e67f4" class="i field">_credential</a> = <b>value</b>;
                <a href="#9e359c47ca2ef3df" class="i field">_authMechanism</a> = <span class="i n">Runspaces</span>.<a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the target container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="f801a4fbbda7199f" href="../../../R/f801a4fbbda7199f.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b> { <b>return</b> <a href="#ee338ee5bc920bf9" class="i property">ContainerProc</a>.<a href="#90a6abdd77ef2b03" class="i property">ContainerId</a>; }
 
            <b>set</b> { <b>throw</b> <b>new</b> <a href="../../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>(); }
        }
 
        <b>internal override</b> <a href="#e07ed56a8a1da829" class="t t">RunspaceConnectionInfo</a> <a id="c8491b8f9e08c62c" href="../../../R/c8491b8f9e08c62c.html" target="n" data-glyph="74,1" class="i method">InternalCopy</a>()
        {
            <a href="#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a> <span id="r179 rd" class="r179 r">newCopy</span> = <b>new</b> <a href="#1c7be06542a68fc8" class="t constructor">ContainerConnectionInfo</a>(<a href="#ee338ee5bc920bf9" class="i property">ContainerProc</a>);
            <b>return</b> <span class="r179 r">newCopy</span>;
        }
 
        <b>internal override</b> <a href="../fanin/BaseTransportManager.cs.html#19883ec4df424177" class="t t">BaseClientSessionTransportManager</a> <a id="7392f55c1cf9ed0b" href="../../../R/7392f55c1cf9ed0b.html" target="n" data-glyph="74,1" class="i method">CreateClientSessionTransportManager</a>(<span class="i">Guid</span> <span id="r180 rd" class="r180 r">instanceId</span>, <b>string</b> <span id="r181 rd" class="r181 r">sessionName</span>, <a href="../../../utils/CryptoUtils.cs.html#1999dfb2439af5a0" class="t t">PSRemotingCryptoHelper</a> <span id="r182 rd" class="r182 r">cryptoHelper</span>)
        {
            <b>if</b> (<a href="#ee338ee5bc920bf9" class="i property">ContainerProc</a>.<a href="#96d9b1e4448dc129" class="i property">RuntimeId</a> != <span class="i">Guid</span>.<span class="i">Empty</span>)
            {
                <b>return</b> <b>new</b> <a href="../fanin/OutOfProcTransportManager.cs.html#b270f1da49f6a69e" class="t constructor">ContainerHyperVSocketClientSessionTransportManager</a>(
                    <a href="#d2be2d5c63c76391" class="k">this</a>,
                    <span class="r180 r">instanceId</span>,
                    <span class="r182 r">cryptoHelper</span>,
                    <a href="#ee338ee5bc920bf9" class="i property">ContainerProc</a>.<a href="#96d9b1e4448dc129" class="i property">RuntimeId</a>);
            }
            <b>else</b>
            {
                <b>return</b> <b>new</b> <a href="../fanin/OutOfProcTransportManager.cs.html#49d1e5b1bf7aa3ff" class="t constructor">ContainerNamedPipeClientSessionTransportManager</a>(
                    <a href="#d2be2d5c63c76391" class="k">this</a>,
                    <span class="r180 r">instanceId</span>,
                    <span class="r182 r">cryptoHelper</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a connection info instance used to create a runspace on target container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="1c7be06542a68fc8" href="../../../R/1c7be06542a68fc8.html" target="n" data-glyph="74,1" class="t constructor">ContainerConnectionInfo</a>(
            <a href="#328c30109a9a72b1" class="t t">ContainerProcess</a> <span id="r183 rd" class="r183 r">containerProc</span>)
            : <b>base</b>()
        {
            <a href="#ee338ee5bc920bf9" class="i property">ContainerProc</a> = <span class="r183 r">containerProc</span>;
 
            <a href="#8a644a89deee446f" class="i property">AuthenticationMechanism</a> = <a href="#f2f89adf00d05f44" class="t t">AuthenticationMechanism</a>.<a href="#aa044b4cbb803265" class="i field">Default</a>;
            <a href="#4dcd4f2b83a5d9a9" class="i property">Credential</a> = <b>null</b>;
            <a href="#a0a3c947f4d2fe9e" class="i property">OpenTimeout</a> = <a href="#91e3d16e992c9a9c" class="i field">_defaultOpenTimeout</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create ContainerConnectionInfo object based on container id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#d2be2d5c63c76391" class="t t">ContainerConnectionInfo</a> <a id="ceceac64cec04a81" href="../../../R/ceceac64cec04a81.html" target="n" data-glyph="72,1" class="i method">CreateContainerConnectionInfo</a>(
            <b>string</b> <span id="r184 rd" class="r184 r">containerId</span>,
            <b>bool</b> <span id="r185 rd" class="r185 r">runAsAdmin</span>,
            <b>string</b> <span id="r186 rd" class="r186 r">configurationName</span>)
        {
            <a href="#328c30109a9a72b1" class="t t">ContainerProcess</a> <span id="r187 rd" class="r187 r">containerProc</span> = <b>new</b> <a href="#7e7b31689a07a9b5" class="t constructor">ContainerProcess</a>(<span class="r184 r">containerId</span>, <b>null</b>, 0, <span class="r185 r">runAsAdmin</span>, <span class="r186 r">configurationName</span>);
 
            <b>return</b> <b>new</b> <a href="#1c7be06542a68fc8" class="t constructor">ContainerConnectionInfo</a>(<span class="r187 r">containerProc</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create process inside container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="c98e542c0a68e45e" href="../../../R/c98e542c0a68e45e.html" target="n" data-glyph="72,1" class="i method">CreateContainerProcess</a>()
        {
            <a href="#ee338ee5bc920bf9" class="i property">ContainerProc</a>.<a href="#195e3032304cbed5" class="i method">CreateContainerProcess</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Terminate process inside container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="9697a01efdf68c66" href="../../../R/9697a01efdf68c66.html" target="n" data-glyph="72,1" class="i method">TerminateContainerProcess</a>()
        {
            <b>return</b> <a href="#ee338ee5bc920bf9" class="i property">ContainerProc</a>.<a href="#6f8a388ab3f41541" class="i method">TerminateContainerProcess</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class used to create/terminate process inside container, which can be either</span>
    <span class="c">///</span><span class="c"> Windows Server Container or Hyper-V container.</span>
    <span class="c">///</span><span class="c"> - Windows Server Container does not require Hyper-V.</span>
    <span class="c">///</span><span class="c"> - Hyper-V container requires Hyper-V and utility VM, which is different from normal VM.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="328c30109a9a72b1" href="../../../R/328c30109a9a72b1.html" target="n" data-glyph="2,0" class="t t">ContainerProcess</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
        <b>private const uint</b> <a id="273f9ded97a404d9" href="../../../R/273f9ded97a404d9.html" target="n" data-glyph="10,1" class="i field">NoError</a> = 0;
        <b>private const uint</b> <a id="6da09fc73f562c74" href="../../../R/6da09fc73f562c74.html" target="n" data-glyph="10,1" class="i field">InvalidContainerId</a> = 1;
        <b>private const uint</b> <a id="2a0d881507908730" href="../../../R/2a0d881507908730.html" target="n" data-glyph="10,1" class="i field">ContainersFeatureNotEnabled</a> = 2;
        <b>private const uint</b> <a id="41b1d178ba76eb44" href="../../../R/41b1d178ba76eb44.html" target="n" data-glyph="10,1" class="i field">OtherError</a> = 9999;
 
        <b>private const uint</b> <a id="9ebb9c6f1c7d2c68" href="../../../R/9ebb9c6f1c7d2c68.html" target="n" data-glyph="10,1" class="i field">FileNotFoundHResult</a> = 0x80070002;
 
        <span class="c">// The list of executable to try in order</span>
        <b>private static readonly string</b>[] <a id="b4034f40dc2f51c9" href="../../../R/b4034f40dc2f51c9.html" target="n" data-glyph="46,1" class="i field">Executables</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;pwsh.exe&quot;</span>, <span class="s">&quot;powershell.exe&quot;</span> };
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or Sets, for Hyper-V container, the Guid of utility VM hosting Hyper-V container.</span>
        <span class="c">///</span><span class="c"> For Windows Server Container, it is empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="96d9b1e4448dc129" href="../../../R/96d9b1e4448dc129.html" target="n" data-glyph="102,1" class="i property">RuntimeId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the OB root of the container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ac6478d5ef277987" href="../../../R/ac6478d5ef277987.html" target="n" data-glyph="102,1" class="i property">ContainerObRoot</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the ID of the container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="90a6abdd77ef2b03" href="../../../R/90a6abdd77ef2b03.html" target="n" data-glyph="102,1" class="i property">ContainerId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the process ID of the process created in container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="ae164163259dda55" href="../../../R/ae164163259dda55.html" target="n" data-glyph="104,1" class="i property">ProcessId</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether the process in container should be launched as high privileged account</span>
        <span class="c">///</span><span class="c"> (RunAsAdmin being true) or low privileged account (RunAsAdmin being false).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="29d7513bb5290ebf" href="../../../R/29d7513bb5290ebf.html" target="n" data-glyph="104,1" class="i property">RunAsAdmin</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the configuration name of the container session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="2dd0c32ed072e8e2" href="../../../R/2dd0c32ed072e8e2.html" target="n" data-glyph="104,1" class="i property">ConfigurationName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether the process in container has terminated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="9e6669ac7912c82f" href="../../../R/9e6669ac7912c82f.html" target="n" data-glyph="104,1" class="i property">ProcessTerminated</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the error code.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal uint</b> <a id="af95b1927f015294" href="../../../R/af95b1927f015294.html" target="n" data-glyph="104,1" class="i property">ErrorCode</a> { <b>get</b>; <b>set</b>; } = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the error message for other errors.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="f6130142659a5d3c" href="../../../R/f6130142659a5d3c.html" target="n" data-glyph="104,1" class="i property">ErrorMessage</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the PowerShell executable being used to host the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="1a4e85102f5f8bfb" href="../../../R/1a4e85102f5f8bfb.html" target="n" data-glyph="104,1" class="i property">Executable</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Native HCS (i.e., host compute service) methods
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal struct</b> <a id="a798061592022a76" href="../../../R/a798061592022a76.html" target="n" data-glyph="110,1" class="t t"><span id="85ea56493f23d613">HCS_PROCESS_INFORMATION</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The process id.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public uint</b> <a id="559d45256687f271" href="../../../R/559d45256687f271.html" target="n" data-glyph="42,2" class="i field">ProcessId</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Reserved.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public uint</b> <a id="8313f19ddbc68060" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">Reserved</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> If created, standard input handle of the process.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public</b> <span class="i">IntPtr</span> <a id="7c4dd65c3c3887e2" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">StdInput</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> If created, standard output handle of the process.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public</b> <span class="i">IntPtr</span> <a id="8b4d138faaadbb71" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">StdOutput</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> If created, standard error handle of the process.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public</b> <span class="i">IntPtr</span> <a id="9d6bf33cca0e705f" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">StdError</a>;
        }
 
        [<span class="i">DllImport</span>(<a href="../../../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../../../utils/PInvokeDllNames.cs.html#c847f1e782dee5f5" class="i field">CreateProcessInComputeSystemDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="758c5dc42a6b0dcb" href="../../../R/758c5dc42a6b0dcb.html" target="n" data-glyph="74,1" class="i method">HcsOpenComputeSystem</a>(
            <b>string</b> <span id="r188 rd" class="r188 r">id</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r189 rd" class="r189 r">computeSystem</span>,
            <b>ref string</b> <span id="r190 rd" class="r190 r">result</span>);
 
        [<span class="i">DllImport</span>(<a href="../../../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../../../utils/PInvokeDllNames.cs.html#c847f1e782dee5f5" class="i field">CreateProcessInComputeSystemDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="a5a34bbc127ae97f" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">HcsGetComputeSystemProperties</a>(
            <span class="i">IntPtr</span> <span id="r191 rd" class="r191 r">computeSystem</span>,
            <b>string</b> <span id="r192 rd" class="r192 r">propertyQuery</span>,
            <b>ref string</b> <span id="r193 rd" class="r193 r">properties</span>,
            <b>ref string</b> <span id="r194 rd" class="r194 r">result</span>);
 
        [<span class="i">DllImport</span>(<a href="../../../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../../../utils/PInvokeDllNames.cs.html#c847f1e782dee5f5" class="i field">CreateProcessInComputeSystemDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="fb785f56f1cae6f1" href="../../../R/fb785f56f1cae6f1.html" target="n" data-glyph="74,1" class="i method">HcsCreateProcess</a>(
            <span class="i">IntPtr</span> <span id="r195 rd" class="r195 r">computeSystem</span>,
            <b>string</b> <span id="r196 rd" class="r196 r">processParameters</span>,
            <b>ref</b> <a href="#a798061592022a76" class="t t">HCS_PROCESS_INFORMATION</a> <span id="r197 rd" class="r197 r">processInformation</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r198 rd" class="r198 r">process</span>,
            <b>ref string</b> <span id="r199 rd" class="r199 r">result</span>);
 
        [<span class="i">DllImport</span>(<a href="../../../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../../../utils/PInvokeDllNames.cs.html#c847f1e782dee5f5" class="i field">CreateProcessInComputeSystemDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="41065c3624733734" href="../../../R/41065c3624733734.html" target="n" data-glyph="74,1" class="i method">HcsOpenProcess</a>(
            <span class="i">IntPtr</span> <span id="r200 rd" class="r200 r">computeSystem</span>,
            <b>int</b> <span id="r201 rd" class="r201 r">processId</span>,
            <b>ref</b> <span class="i">IntPtr</span> <span id="r202 rd" class="r202 r">process</span>,
            <b>ref string</b> <span id="r203 rd" class="r203 r">result</span>);
 
        [<span class="i">DllImport</span>(<a href="../../../utils/PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="../../../utils/PInvokeDllNames.cs.html#c847f1e782dee5f5" class="i field">CreateProcessInComputeSystemDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern uint</b> <a id="a3fbc4ffe375f321" href="../../../R/a3fbc4ffe375f321.html" target="n" data-glyph="74,1" class="i method">HcsTerminateProcess</a>(
            <span class="i">IntPtr</span> <span id="r204 rd" class="r204 r">process</span>,
            <b>ref string</b> <span id="r205 rd" class="r205 r">result</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance used for PowerShell Direct for container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="7e7b31689a07a9b5" href="../../../R/7e7b31689a07a9b5.html" target="n" data-glyph="72,1" class="t constructor">ContainerProcess</a>(<b>string</b> <span id="r206 rd" class="r206 r">containerId</span>, <b>string</b> <span id="r207 rd" class="r207 r">containerObRoot</span>, <b>int</b> <span id="r208 rd" class="r208 r">processId</span>, <b>bool</b> <span id="r209 rd" class="r209 r">runAsAdmin</span>, <b>string</b> <span id="r210 rd" class="r210 r">configurationName</span>)
        {
            <a href="#328c30109a9a72b1" class="k">this</a>.<a href="#90a6abdd77ef2b03" class="i property">ContainerId</a> = <span class="r206 r">containerId</span>;
            <a href="#328c30109a9a72b1" class="k">this</a>.<a href="#ac6478d5ef277987" class="i property">ContainerObRoot</a> = <span class="r207 r">containerObRoot</span>;
            <a href="#328c30109a9a72b1" class="k">this</a>.<a href="#ae164163259dda55" class="i property">ProcessId</a> = <span class="r208 r">processId</span>;
            <a href="#328c30109a9a72b1" class="k">this</a>.<a href="#29d7513bb5290ebf" class="i property">RunAsAdmin</a> = <span class="r209 r">runAsAdmin</span>;
            <a href="#328c30109a9a72b1" class="k">this</a>.<a href="#2dd0c32ed072e8e2" class="i property">ConfigurationName</a> = <span class="r210 r">configurationName</span>;
 
            <a href="../../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r206 r">containerId</span>), <span class="s">&quot;containerId input cannot be empty.&quot;</span>);
 
            <a href="#3741ce6b4561e480" class="i method">GetContainerProperties</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create process inside container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="195e3032304cbed5" href="../../../R/195e3032304cbed5.html" target="n" data-glyph="72,1" class="i method">CreateContainerProcess</a>()
        {
            <span class="i">RunOnMTAThread</span>(<span class="i">CreateContainerProcessInternal</span>);
 
            <span class="c">//</span>
            <span class="c">// Report error. More error reporting will come later.</span>
            <span class="c">//</span>
            <b>switch</b> (<a href="#af95b1927f015294" class="i property">ErrorCode</a>)
            {
                <b>case</b> <a href="#273f9ded97a404d9" class="i field">NoError</a>:
                    <b>break</b>;
 
                <b>case</b> <a href="#6da09fc73f562c74" class="i field">InvalidContainerId</a>:
                    <b>throw</b> <b>new</b> <a href="../../../utils/MshInvalidOperationException.cs.html#de5b942a57457045" class="t constructor">PSInvalidOperationException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">InvalidContainerId</span>,
                                                                            <a href="#90a6abdd77ef2b03" class="i property">ContainerId</a>));
 
                <b>case</b> <a href="#2a0d881507908730" class="i field">ContainersFeatureNotEnabled</a>:
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ContainersFeatureNotEnabled</span>);
 
                <span class="c">// other errors caught with exception</span>
                <b>case</b> <a href="#41b1d178ba76eb44" class="i field">OtherError</a>:
                    <b>throw</b> <b>new</b> <a href="../../../utils/MshInvalidOperationException.cs.html#de5b942a57457045" class="t constructor">PSInvalidOperationException</a>(<a href="#f6130142659a5d3c" class="i property">ErrorMessage</a>);
 
                <span class="c">// other errors caught without exception</span>
                <b>default</b>:
                    <b>throw</b> <b>new</b> <a href="../../../utils/MshInvalidOperationException.cs.html#de5b942a57457045" class="t constructor">PSInvalidOperationException</a>(<a href="../../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CannotCreateProcessInContainer</span>,
                                                                            <a href="#90a6abdd77ef2b03" class="i property">ContainerId</a>,
                                                                            <a href="#1a4e85102f5f8bfb" class="i property">Executable</a>,
                                                                            <a href="#af95b1927f015294" class="i property">ErrorCode</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Terminate process inside container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="6f8a388ab3f41541" href="../../../R/6f8a388ab3f41541.html" target="n" data-glyph="72,1" class="i method">TerminateContainerProcess</a>()
        {
            <span class="i">RunOnMTAThread</span>(<span class="i">TerminateContainerProcessInternal</span>);
 
            <b>return</b> <a href="#9e6669ac7912c82f" class="i property">ProcessTerminated</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get object root based on given container id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3741ce6b4561e480" href="../../../R/3741ce6b4561e480.html" target="n" data-glyph="72,1" class="i method">GetContainerProperties</a>()
        {
            <span class="i">RunOnMTAThread</span>(<span class="i">GetContainerPropertiesInternal</span>);
 
            <span class="c">//</span>
            <span class="c">// Report error.</span>
            <span class="c">//</span>
            <b>switch</b> (<a href="#af95b1927f015294" class="i property">ErrorCode</a>)
            {
                <b>case</b> <a href="#273f9ded97a404d9" class="i field">NoError</a>:
                    <b>break</b>;
 
                <b>case</b> <a href="#2a0d881507908730" class="i field">ContainersFeatureNotEnabled</a>:
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">ContainersFeatureNotEnabled</span>);
 
                <b>case</b> <a href="#41b1d178ba76eb44" class="i field">OtherError</a>:
                    <b>throw</b> <b>new</b> <a href="../../../utils/MshInvalidOperationException.cs.html#de5b942a57457045" class="t constructor">PSInvalidOperationException</a>(<a href="#f6130142659a5d3c" class="i property">ErrorMessage</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dynamically load the Host Compute interop assemblies and return useful types.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r211 r">computeSystemPropertiesType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The HCS.Compute.System.Properties type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">hostComputeInteropType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Microsoft.HostCompute.Interop.HostComputeInterop type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="160a309366a1d4a4" href="../../../R/160a309366a1d4a4.html" target="n" data-glyph="76,1" class="i method">GetHostComputeInteropTypes</a>(<b>out</b> <span class="i">Type</span> <span id="r211 rd" class="r211 r">computeSystemPropertiesType</span>, <b>out</b> <span class="i">Type</span> <span id="r212 rd" class="r212 r">hostComputeInteropType</span>)
        {
            <span class="i">Assembly</span> <span id="r213 rd" class="r213 r">schemaAssembly</span> = <span class="i">Assembly</span>.<span class="i">Load</span>(<b>new</b> <span class="i">AssemblyName</span>(<span class="s">&quot;Microsoft.HyperV.Schema, Version=10.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;</span>));
 
            <span class="c">// The type name was changed in newer version of Windows so we check for new one first,</span>
            <span class="c">// then fallback to previous type name to support older versions of Windows</span>
            <span class="r211 r">computeSystemPropertiesType</span> = <span class="r213 r">schemaAssembly</span>.<span class="i">GetType</span>(<span class="s">&quot;HCS.Compute.System.Properties&quot;</span>);
            <b>if</b> (<span class="r211 r">computeSystemPropertiesType</span> == <b>null</b>)
            {
                <span class="r211 r">computeSystemPropertiesType</span> = <span class="r213 r">schemaAssembly</span>.<span class="i">GetType</span>(<span class="s">&quot;Microsoft.HyperV.Schema.Compute.System.Properties&quot;</span>);
                <b>if</b> (<span class="r211 r">computeSystemPropertiesType</span> == <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CannotGetHostInteropTypes</span>);
                }
            }
 
            <span class="i">Assembly</span> <span id="r214 rd" class="r214 r">hostComputeInteropAssembly</span> = <span class="i">Assembly</span>.<span class="i">Load</span>(<b>new</b> <span class="i">AssemblyName</span>(<span class="s">&quot;Microsoft.HostCompute.Interop, Version=10.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;</span>));
            <span class="r212 r">hostComputeInteropType</span> = <span class="r214 r">hostComputeInteropAssembly</span>.<span class="i">GetType</span>(<span class="s">&quot;Microsoft.HostCompute.Interop.HostComputeInterop&quot;</span>);
            <b>if</b> (<span class="r212 r">hostComputeInteropType</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CannotGetHostInteropTypes</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create process inside container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9b0a8807db0bacfa" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CreateContainerProcessInternal</a>()
        {
            <b>uint</b> <span id="r215 rd" class="r215 r">result</span>;
            <b>string</b> <span id="r216 rd" class="r216 r">cmd</span>;
            <b>int</b> <span id="r217 rd" class="r217 r">processId</span> = 0;
            <b>uint</b> <span id="r218 rd" class="r218 r">error</span> = 0;
 
            <span class="c">//</span>
            <span class="c">// Check whether the given container id exists.</span>
            <span class="c">//</span>
            <b>try</b>
            {
                <span class="i">IntPtr</span> <span id="r219 rd" class="r219 r">ComputeSystem</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <b>string</b> <span id="r220 rd" class="r220 r">resultString</span> = <b>string</b>.<span class="i">Empty</span>;
 
                <span class="r215 r">result</span> = <a href="#758c5dc42a6b0dcb" class="i method">HcsOpenComputeSystem</a>(<a href="#90a6abdd77ef2b03" class="i property">ContainerId</a>, <b>ref</b> <span class="r219 r">ComputeSystem</span>, <b>ref</b> <span class="r220 r">resultString</span>);
                <b>if</b> (<span class="r215 r">result</span> != 0)
                {
                    <span class="r217 r">processId</span> = 0;
                    <span class="r218 r">error</span> = <a href="#6da09fc73f562c74" class="i field">InvalidContainerId</a>;
                }
                <b>else</b>
                {
                    <span class="c">//</span>
                    <span class="c">// Hyper-V container (i.e., RuntimeId is not empty) uses Hyper-V socket transport.</span>
                    <span class="c">// Windows Server container (i.e., RuntimeId is empty) uses named pipe transport for now.</span>
                    <span class="c">// This code executes `pwsh.exe` as it exists in the container which currently is</span>
                    <span class="c">// expected to be PowerShell 6+ as it&#39;s inbox in the container.</span>
                    <span class="c">// If `pwsh.exe` does not exist, fall back to `powershell.exe` which is Windows PowerShell.</span>
                    <span class="c">//</span>
                    <b>foreach</b> (<b>string</b> <span id="r221 rd" class="r221 r">executableToTry</span> <b>in</b> <a href="#b4034f40dc2f51c9" class="i field">Executables</a>)
                    {
                        <span class="r216 r">cmd</span> = <a href="#d04ac8e6864904d2" class="i method">GetContainerProcessCommand</a>(<span class="r221 r">executableToTry</span>);
 
                        <a href="#a798061592022a76" class="t t">HCS_PROCESS_INFORMATION</a> <span id="r222 rd" class="r222 r">ProcessInformation</span> = <b>new</b> <span class="t">HCS_PROCESS_INFORMATION</span>();
                        <span class="i">IntPtr</span> <span id="r223 rd" class="r223 r">Process</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
                        <span class="c">//</span>
                        <span class="c">// Create PowerShell process inside the container.</span>
                        <span class="c">//</span>
                        <span class="r215 r">result</span> = <a href="#fb785f56f1cae6f1" class="i method">HcsCreateProcess</a>(<span class="r219 r">ComputeSystem</span>, <span class="r216 r">cmd</span>, <b>ref</b> <span class="r222 r">ProcessInformation</span>, <b>ref</b> <span class="r223 r">Process</span>, <b>ref</b> <span class="r220 r">resultString</span>);
                        <b>if</b> (<span class="r215 r">result</span> == 0)
                        {
                            <span class="r217 r">processId</span> = <span class="i">Convert</span>.<span class="i">ToInt32</span>(<span class="r222 r">ProcessInformation</span>.<a href="#559d45256687f271" class="i field">ProcessId</a>);
 
                            <span class="c">// Reset error to 0 in case this is not the first iteration of the loop.</span>
                            <span class="r218 r">error</span> = 0;
 
                            <span class="c">// the process was started, exit the loop.</span>
                            <b>break</b>;
                        }
                        <b>else</b> <b>if</b> (<span class="r215 r">result</span> == <a href="#9ebb9c6f1c7d2c68" class="i field">FileNotFoundHResult</a>)
                        {
                            <span class="c">// &quot;The system cannot find the file specified&quot;, try the next one</span>
                            <span class="c">// or exit the loop of none are left to try.</span>
                            <span class="c">// Set the process and error information in case we exit the loop.</span>
                            <span class="r217 r">processId</span> = 0;
                            <span class="r218 r">error</span> = <span class="r215 r">result</span>;
                            <b>continue</b>;
                        }
                        <b>else</b>
                        {
                            <span class="r217 r">processId</span> = 0;
                            <span class="r218 r">error</span> = <span class="r215 r">result</span>;
 
                            <span class="c">// the executable was found but did not work</span>
                            <span class="c">// exit the loop with the error state.</span>
                            <b>break</b>;
                        }
                    }
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r224 rd" class="r224 r">e</span>)
            {
                <b>if</b> (<span class="r224 r">e</span> <b>is</b> <span class="i">FileNotFoundException</span> || <span class="r224 r">e</span> <b>is</b> <span class="i">FileLoadException</span>)
                {
                    <span class="c">//</span>
                    <span class="c">// The ComputeSystemExists call depends on the existence of microsoft.hostcompute.interop.dll,</span>
                    <span class="c">// which requires Containers feature to be enabled. In case Containers feature is</span>
                    <span class="c">// not enabled, we need to output a corresponding error message to inform user.</span>
                    <span class="c">//</span>
                    <a href="#ae164163259dda55" class="i property">ProcessId</a> = 0;
                    <a href="#af95b1927f015294" class="i property">ErrorCode</a> = <a href="#2a0d881507908730" class="i field">ContainersFeatureNotEnabled</a>;
                    <b>return</b>;
                }
                <b>else</b>
                {
                    <a href="#ae164163259dda55" class="i property">ProcessId</a> = 0;
                    <a href="#af95b1927f015294" class="i property">ErrorCode</a> = <a href="#41b1d178ba76eb44" class="i field">OtherError</a>;
                    <a href="#f6130142659a5d3c" class="i property">ErrorMessage</a> = <a href="#6dfc36d68bc13eb6" class="i method">GetErrorMessageFromException</a>(<span class="r224 r">e</span>);
                    <b>return</b>;
                }
            }
 
            <a href="#ae164163259dda55" class="i property">ProcessId</a> = <span class="r217 r">processId</span>;
            <a href="#af95b1927f015294" class="i property">ErrorCode</a> = <span class="r218 r">error</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get Command to launch container process based on instance properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r225 r">executable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the executable to use in the command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command to launch the container process.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="d04ac8e6864904d2" href="../../../R/d04ac8e6864904d2.html" target="n" data-glyph="76,1" class="i method">GetContainerProcessCommand</a>(<b>string</b> <span id="r225 rd" class="r225 r">executable</span>)
        {
            <a href="#1a4e85102f5f8bfb" class="i property">Executable</a> = <span class="r225 r">executable</span>;
            <b>return</b> <b>string</b>.<span class="i">Format</span>(
                        <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="s">@&quot;{{&quot;&quot;CommandLine&quot;&quot;: &quot;&quot;{0} {1} -NoLogo {2}&quot;&quot;,&quot;&quot;RestrictedToken&quot;&quot;: {3}}}&quot;</span>,
                        <a href="#1a4e85102f5f8bfb" class="i property">Executable</a>,
                        (<a href="#96d9b1e4448dc129" class="i property">RuntimeId</a> != <span class="i">Guid</span>.<span class="i">Empty</span>) ? <span class="s">&quot;-SocketServerMode -NoProfile&quot;</span> : <span class="s">&quot;-NamedPipeServerMode&quot;</span>,
                        <b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#2dd0c32ed072e8e2" class="i property">ConfigurationName</a>) ? <b>string</b>.<span class="i">Empty</span> : <b>string</b>.<span class="i">Concat</span>(<span class="s">&quot;-Config &quot;</span>, <a href="#2dd0c32ed072e8e2" class="i property">ConfigurationName</a>),
                        <a href="#29d7513bb5290ebf" class="i property">RunAsAdmin</a> ? <span class="s">&quot;false&quot;</span> : <span class="s">&quot;true&quot;</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Terminate the process inside container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="73cd67e99b162444" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">TerminateContainerProcessInternal</a>()
        {
            <span class="i">IntPtr</span> <span id="r226 rd" class="r226 r">ComputeSystem</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>string</b> <span id="r227 rd" class="r227 r">resultString</span> = <b>string</b>.<span class="i">Empty</span>;
            <span class="i">IntPtr</span> <span id="r228 rd" class="r228 r">process</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
 
            <a href="#9e6669ac7912c82f" class="i property">ProcessTerminated</a> = <b>false</b>;
 
            <b>if</b> (<a href="#758c5dc42a6b0dcb" class="i method">HcsOpenComputeSystem</a>(<a href="#90a6abdd77ef2b03" class="i property">ContainerId</a>, <b>ref</b> <span class="r226 r">ComputeSystem</span>, <b>ref</b> <span class="r227 r">resultString</span>) == 0)
            {
                <b>if</b> (<a href="#41065c3624733734" class="i method">HcsOpenProcess</a>(<span class="r226 r">ComputeSystem</span>, <a href="#ae164163259dda55" class="i property">ProcessId</a>, <b>ref</b> <span class="r228 r">process</span>, <b>ref</b> <span class="r227 r">resultString</span>) == 0)
                {
                    <b>if</b> (<a href="#a3fbc4ffe375f321" class="i method">HcsTerminateProcess</a>(<span class="r228 r">process</span>, <b>ref</b> <span class="r227 r">resultString</span>) == 0)
                    {
                        <a href="#9e6669ac7912c82f" class="i property">ProcessTerminated</a> = <b>true</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get object root based on given container id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="437efbd21851820f" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetContainerPropertiesInternal</a>()
        {
            <b>try</b>
            {
                <span class="i">IntPtr</span> <span id="r229 rd" class="r229 r">ComputeSystem</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <b>string</b> <span id="r230 rd" class="r230 r">resultString</span> = <b>string</b>.<span class="i">Empty</span>;
 
                <b>if</b> (<a href="#758c5dc42a6b0dcb" class="i method">HcsOpenComputeSystem</a>(<a href="#90a6abdd77ef2b03" class="i property">ContainerId</a>, <b>ref</b> <span class="r229 r">ComputeSystem</span>, <b>ref</b> <span class="r230 r">resultString</span>) == 0)
                {
                    <span class="i">Type</span> <span id="r231 rd" class="r231 r">computeSystemPropertiesType</span>;
                    <span class="i">Type</span> <span id="r232 rd" class="r232 r">hostComputeInteropType</span>;
 
                    <a href="#160a309366a1d4a4" class="i method">GetHostComputeInteropTypes</a>(<b>out</b> <span class="r231 r">computeSystemPropertiesType</span>, <b>out</b> <span class="r232 r">hostComputeInteropType</span>);
 
                    <span class="i">MethodInfo</span> <span id="r233 rd" class="r233 r">getComputeSystemPropertiesInfo</span> = <span class="r232 r">hostComputeInteropType</span>.<span class="i">GetMethod</span>(<span class="s">&quot;HcsGetComputeSystemProperties&quot;</span>);
 
                    <b>var</b> <span id="r234 rd" class="r234 r">computeSystemPropertiesHandle</span> = <span class="r233 r">getComputeSystemPropertiesInfo</span>.<span class="i">Invoke</span>(<b>null</b>, <b>new</b> <b>object</b>[] { <span class="r229 r">ComputeSystem</span> });
 
                    <span class="c">// Since Hyper-V changed this from a property to a field, we can optimize for newest Windows to see if it&#39;s a field,</span>
                    <span class="c">// otherwise we fall back to old code to be compatible with older versions of Windows</span>
                    <b>var</b> <span id="r235 rd" class="r235 r">fieldInfo</span> = <span class="r231 r">computeSystemPropertiesType</span>.<span class="i">GetField</span>(<span class="s">&quot;RuntimeId&quot;</span>);
                    <b>if</b> (<span class="r235 r">fieldInfo</span> != <b>null</b>)
                    {
                        <a href="#96d9b1e4448dc129" class="i property">RuntimeId</a> = (<span class="i">Guid</span>)<span class="r235 r">fieldInfo</span>.<span class="i">GetValue</span>(<span class="r234 r">computeSystemPropertiesHandle</span>);
                    }
                    <b>else</b>
                    {
                        <b>var</b> <span id="r236 rd" class="r236 r">propertyInfo</span> = <span class="r231 r">computeSystemPropertiesType</span>.<span class="i">GetProperty</span>(<span class="s">&quot;RuntimeId&quot;</span>);
                        <b>if</b> (<span class="r236 r">propertyInfo</span> == <b>null</b>)
                        {
                            <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CannotGetHostInteropTypes</span>);
                        }
 
                        <a href="#96d9b1e4448dc129" class="i property">RuntimeId</a> = (<span class="i">Guid</span>)<span class="r236 r">propertyInfo</span>.<span class="i">GetValue</span>(<span class="r234 r">computeSystemPropertiesHandle</span>);
                    }
 
                    <span class="c">//</span>
                    <span class="c">// Get container object root for Windows Server container.</span>
                    <span class="c">//</span>
                    <b>if</b> (<a href="#96d9b1e4448dc129" class="i property">RuntimeId</a> == <span class="i">Guid</span>.<span class="i">Empty</span>)
                    {
                        <span class="c">// Since Hyper-V changed this from a property to a field, we can optimize for newest Windows to see if it&#39;s a field,</span>
                        <span class="c">// otherwise we fall back to old code to be compatible with older versions of Windows</span>
                        <b>var</b> <span id="r237 rd" class="r237 r">obRootFieldInfo</span> = <span class="r231 r">computeSystemPropertiesType</span>.<span class="i">GetField</span>(<span class="s">&quot;ObRoot&quot;</span>);
                        <b>if</b> (<span class="r237 r">obRootFieldInfo</span> != <b>null</b>)
                        {
                            <a href="#ac6478d5ef277987" class="i property">ContainerObRoot</a> = <span class="r237 r">obRootFieldInfo</span>.<span class="i">GetValue</span>(<span class="r234 r">computeSystemPropertiesHandle</span>) <b>as string</b>;
                        }
                        <b>else</b>
                        {
                            <b>var</b> <span id="r238 rd" class="r238 r">obRootPropertyInfo</span> = <span class="r231 r">computeSystemPropertiesType</span>.<span class="i">GetProperty</span>(<span class="s">&quot;ObRoot&quot;</span>);
                            <b>if</b> (<span class="r238 r">obRootPropertyInfo</span> != <b>null</b>)
                            {
                                <a href="#ac6478d5ef277987" class="i property">ContainerObRoot</a> = <span class="r238 r">obRootPropertyInfo</span>.<span class="i">GetValue</span>(<span class="r234 r">computeSystemPropertiesHandle</span>) <b>as string</b>;
                            }
                        }
 
                        <b>if</b> (<a href="#ac6478d5ef277987" class="i property">ContainerObRoot</a> == <b>null</b>)
                        {
                            <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">RemotingErrorIdStrings</span>.<span class="i">CannotGetHostInteropTypes</span>);
                        }
                    }
                }
            }
            <b>catch</b> (<span class="i">FileNotFoundException</span>)
            {
                <a href="#af95b1927f015294" class="i property">ErrorCode</a> = <a href="#2a0d881507908730" class="i field">ContainersFeatureNotEnabled</a>;
            }
            <b>catch</b> (<span class="i">FileLoadException</span>)
            {
                <a href="#af95b1927f015294" class="i property">ErrorCode</a> = <a href="#2a0d881507908730" class="i field">ContainersFeatureNotEnabled</a>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r239 rd" class="r239 r">e</span>)
            {
                <b>if</b> (<span class="r239 r">e</span>.<span class="i">InnerException</span> != <b>null</b> &amp;&amp;
                    <span class="i">StringComparer</span>.<span class="i">Ordinal</span>.<span class="i">Equals</span>(
                        <span class="r239 r">e</span>.<span class="i">InnerException</span>.<span class="i">GetType</span>().<span class="i">FullName</span>,
                        <span class="s">&quot;Microsoft.HostCompute.Interop.ObjectNotFoundException&quot;</span>))
                {
                    <a href="#af95b1927f015294" class="i property">ErrorCode</a> = <a href="#6da09fc73f562c74" class="i field">InvalidContainerId</a>;
                }
                <b>else</b>
                {
                    <a href="#af95b1927f015294" class="i property">ErrorCode</a> = <a href="#41b1d178ba76eb44" class="i field">OtherError</a>;
                    <a href="#f6130142659a5d3c" class="i property">ErrorMessage</a> = <a href="#6dfc36d68bc13eb6" class="i method">GetErrorMessageFromException</a>(<span class="r239 r">e</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Run some tasks on MTA thread if needed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="9be37d95b7aa2622" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RunOnMTAThread</a>(<span class="i">ThreadStart</span> <span id="r240 rd" class="r240 r">threadProc</span>)
        {
            <b>if</b> (<span class="i">Thread</span>.<span class="i">CurrentThread</span>.<span class="i">GetApartmentState</span>() == <span class="i">ApartmentState</span>.<span class="i">MTA</span>)
            {
                <span class="r240 r">threadProc</span>();
            }
            <b>else</b>
            {
                <span class="i">Thread</span> <span id="r241 rd" class="r241 r">executionThread</span> = <b>new</b> <span class="i">Thread</span>(<b>new</b> <span class="i">ThreadStart</span>(<span class="r240 r">threadProc</span>));
 
                <span class="r241 r">executionThread</span>.<span class="i">SetApartmentState</span>(<span class="i">ApartmentState</span>.<span class="i">MTA</span>);
                <span class="r241 r">executionThread</span>.<span class="i">Start</span>();
                <span class="r241 r">executionThread</span>.<span class="i">Join</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get error message from the thrown exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="6dfc36d68bc13eb6" href="../../../R/6dfc36d68bc13eb6.html" target="n" data-glyph="76,1" class="i method">GetErrorMessageFromException</a>(<span class="i">Exception</span> <span id="r242 rd" class="r242 r">e</span>)
        {
            <b>string</b> <span id="r243 rd" class="r243 r">errorMessage</span> = <span class="r242 r">e</span>.<span class="i">Message</span>;
 
            <b>if</b> (<span class="r242 r">e</span>.<span class="i">InnerException</span> != <b>null</b>)
            {
                <span class="r243 r">errorMessage</span> += <span class="s">&quot; &quot;</span> + <span class="r242 r">e</span>.<span class="i">InnerException</span>.<span class="i">Message</span>;
            }
 
            <b>return</b> <span class="r243 r">errorMessage</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
