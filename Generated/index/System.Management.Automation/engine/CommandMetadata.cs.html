<!DOCTYPE html>
<html><head><title>CommandMetadata.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1548);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CommandMetadata.cs" target="_top">engine\CommandMetadata.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Debug</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines session capabilities provided by a PowerShell session.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#307c0a1bbe64082c" class="i method">CreateRestricted</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="#543f906b9137ce10" class="t t">CommandMetadata</a>.<a href="#4424bbe0e916cad7" class="i method">GetRestrictedCommands</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="bb52d235a01f7719" href="../R/bb52d235a01f7719.html" target="n" data-glyph="18,0" class="t t"><span id="5f62576dfce24853">SessionCapabilities</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session with </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b2234cfd6d5d5d27" class="i field">RemoteServer</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> capabilities can be made available on a server</span>
        <span class="c">///</span><span class="c"> that wants to provide a full user experience to PowerShell clients.</span>
        <span class="c">///</span><span class="c"> Clients connecting to the server will be able to use implicit remoting</span>
        <span class="c">///</span><span class="c"> (Import-PSSession, Export-PSSession) as well as interactive remoting (Enter-PSSession, Exit-PSSession).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b2234cfd6d5d5d27" href="../R/b2234cfd6d5d5d27.html" target="n" data-glyph="24,1" class="i field">RemoteServer</a> = 0x1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Include language capabilities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8e2f929e55381afe" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Language</a> = 0x4
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class represents the compiled metadata for a command type.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;CommandName = {Name}; Type = {CommandType}&quot;</span>)]
    <b>public sealed class</b> <a id="543f906b9137ce10" href="../R/543f906b9137ce10.html" target="n" data-glyph="0,0" class="t t">CommandMetadata</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a CommandMetadata object for the given CLS complaint type</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">commandType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">commandType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CLS complaint type to inspect for Cmdlet metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> commandType is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="b9218398fb562257" href="../R/b9218398fb562257.html" target="n" data-glyph="72,1" class="t constructor">CommandMetadata</a>(<span class="i">Type</span> <span id="r0 rd" class="r0 r">commandType</span>)
        {
            <a href="#0c1ae4b070dc34b5" class="i method">Init</a>(<b>null</b>, <b>null</b>, <span class="r0 r">commandType</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a CommandMetadata object for the given commandInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The commandInfo object to construct CommandMetadata for</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> commandInfo is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the commandInfo is an alias to an unknown command, or if the commandInfo</span>
        <span class="c">///</span><span class="c"> is an unsupported command type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="67fe3aba634d5055" href="../R/67fe3aba634d5055.html" target="n" data-glyph="72,1" class="t constructor">CommandMetadata</a>(<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r1 rd" class="r1 r">commandInfo</span>)
            : <a href="#f5f5067fb7a93f99" class="k">this</a>(<span class="r1 r">commandInfo</span>, <b>false</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a CommandMetadata object for the given commandInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The commandInfo object to construct CommandMetadata for</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">shouldGenerateCommonParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Should common parameters be included in the metadata?</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> commandInfo is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the commandInfo is an alias to an unknown command, or if the commandInfo</span>
        <span class="c">///</span><span class="c"> is an unsupported command type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public</b> <a id="f5f5067fb7a93f99" href="../R/f5f5067fb7a93f99.html" target="n" data-glyph="72,1" class="t constructor">CommandMetadata</a>(<a href="CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r2 rd" class="r2 r">commandInfo</span>, <b>bool</b> <span id="r3 rd" class="r3 r">shouldGenerateCommonParameters</span>)
        {
            <b>if</b> (<span class="r2 r">commandInfo</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">commandInfo</span>));
            }
            <b>while</b> (<span class="r2 r">commandInfo</span> <b>is</b> <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>)
            {
                <span class="r2 r">commandInfo</span> = ((<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>)<span class="r2 r">commandInfo</span>).<a href="AliasInfo.cs.html#3c87427c7d52a654" class="i property">ResolvedCommand</a>;
                <b>if</b> (<span class="r2 r">commandInfo</span> == <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
                }
            }
 
            <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r4 rd" class="r4 r">cmdletInfo</span>;
            <a href="ExternalScriptInfo.cs.html#7806ac40f903221c" class="t t">ExternalScriptInfo</a> <span id="r5 rd" class="r5 r">scriptInfo</span>;
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r6 rd" class="r6 r">funcInfo</span>;
            <b>if</b> ((<span class="r4 r">cmdletInfo</span> = <span class="r2 r">commandInfo</span> <b>as</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>) != <b>null</b>)
            {
                <a href="#0c1ae4b070dc34b5" class="i method">Init</a>(<span class="r2 r">commandInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r4 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#7faf4081836f8538" class="i property">FullName</a>, <span class="r4 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a>, <span class="r3 r">shouldGenerateCommonParameters</span>);
            }
            <b>else</b> <b>if</b> ((<span class="r5 r">scriptInfo</span> = <span class="r2 r">commandInfo</span> <b>as</b> <a href="ExternalScriptInfo.cs.html#7806ac40f903221c" class="t t">ExternalScriptInfo</a>) != <b>null</b>)
            {
                <span class="c">// Accessing the script block property here reads and parses the script</span>
                <a href="#75661c398c19710b" class="i method">Init</a>(<span class="r5 r">scriptInfo</span>.<a href="ExternalScriptInfo.cs.html#7795a39b7e78fc61" class="i property">ScriptBlock</a>, <span class="r5 r">scriptInfo</span>.<a href="ExternalScriptInfo.cs.html#ba1a326ad41ce463" class="i property">Path</a>, <span class="r3 r">shouldGenerateCommonParameters</span>);
                <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>;
            }
            <b>else</b> <b>if</b> ((<span class="r6 r">funcInfo</span> = <span class="r2 r">commandInfo</span> <b>as</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>) != <b>null</b>)
            {
                <a href="#75661c398c19710b" class="i method">Init</a>(<span class="r6 r">funcInfo</span>.<a href="FunctionInfo.cs.html#aa3a9db104bb0f61" class="i property">ScriptBlock</a>, <span class="r6 r">funcInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r3 r">shouldGenerateCommonParameters</span>);
                <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a> = <span class="r2 r">commandInfo</span>.<a href="CommandInfo.cs.html#1aa74ca244a39308" class="i property">CommandType</a>;
            }
            <b>else</b>
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#18f73963f5ead5c2" class="i method">NewNotSupportedException</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Construct a CommandMetadata object for a script file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="06543eeab79f1d0e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CommandMetadata</a>(<b>string</b> <span id="r7 rd" class="r7 r">path</span>)
        {
            <b>string</b> <span id="r8 rd" class="r8 r">scriptName</span> = <span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r7 r">path</span>);
            <a href="ExternalScriptInfo.cs.html#7806ac40f903221c" class="t t">ExternalScriptInfo</a> <span id="r9 rd" class="r9 r">scriptInfo</span> = <b>new</b> <a href="ExternalScriptInfo.cs.html#12b68b14765ad8b7" class="t constructor">ExternalScriptInfo</a>(<span class="r8 r">scriptName</span>, <span class="r7 r">path</span>);
 
            <a href="#75661c398c19710b" class="i method">Init</a>(<span class="r9 r">scriptInfo</span>.<a href="ExternalScriptInfo.cs.html#7795a39b7e78fc61" class="i property">ScriptBlock</a>, <span class="r7 r">path</span>, <b>false</b>);
            <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A copy constructor that creates a deep copy of the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">other</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> CommandMetadata object.</span>
        <span class="c">///</span><span class="c"> Instances of Attribute and Type classes are copied by reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">other</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to copy.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8c053d155e3b6da3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CommandMetadata</a>(<a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r10 rd" class="r10 r">other</span>)
        {
            <b>if</b> (<span class="r10 r">other</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r10 r">other</span>));
            }
 
            <a href="#8d0d4ac251b21d59" class="i property">Name</a> = <span class="r10 r">other</span>.<a href="#8d0d4ac251b21d59" class="i property">Name</a>;
            <a href="#94737225e0faa8f9" class="i property">ConfirmImpact</a> = <span class="r10 r">other</span>.<a href="#94737225e0faa8f9" class="i property">ConfirmImpact</a>;
            <a href="#17e610d48ec80ead" class="i field">_defaultParameterSetFlag</a> = <span class="r10 r">other</span>.<a href="#17e610d48ec80ead" class="i field">_defaultParameterSetFlag</a>;
            <a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a> = <span class="r10 r">other</span>.<a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a>;
            <a href="#3d51c59159570232" class="i field">_implementsDynamicParameters</a> = <span class="r10 r">other</span>.<a href="#3d51c59159570232" class="i field">_implementsDynamicParameters</a>;
            <a href="#aa53189195e06c7a" class="i property">SupportsShouldProcess</a> = <span class="r10 r">other</span>.<a href="#aa53189195e06c7a" class="i property">SupportsShouldProcess</a>;
            <a href="#6e322fe87e0f4bcc" class="i property">SupportsPaging</a> = <span class="r10 r">other</span>.<a href="#6e322fe87e0f4bcc" class="i property">SupportsPaging</a>;
            <a href="#20ae284e47c80be8" class="i property">SupportsTransactions</a> = <span class="r10 r">other</span>.<a href="#20ae284e47c80be8" class="i property">SupportsTransactions</a>;
            <a href="#543f906b9137ce10" class="k">this</a>.<a href="#45b42f65f7c23c04" class="i property">CommandType</a> = <span class="r10 r">other</span>.<a href="#45b42f65f7c23c04" class="i property">CommandType</a>;
            <a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a> = <span class="r10 r">other</span>.<a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a>;
            <a href="#1fec58014079a921" class="i field">_wrappedCommand</a> = <span class="r10 r">other</span>.<a href="#1fec58014079a921" class="i field">_wrappedCommand</a>;
            <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a> = <span class="r10 r">other</span>.<a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a>;
 
            <a href="#5eb37c0d877161e7" class="i field">_parameters</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt;(<span class="r10 r">other</span>.<a href="#3f6c73a7b157f755" class="i property">Parameters</a>.<span class="i">Count</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <span class="c">// deep copy</span>
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <span id="r11 rd" class="r11 r">entry</span> <b>in</b> <span class="r10 r">other</span>.<a href="#3f6c73a7b157f755" class="i property">Parameters</a>)
            {
                <a href="#5eb37c0d877161e7" class="i field">_parameters</a>.<span class="i">Add</span>(<span class="r11 r">entry</span>.<span class="i">Key</span>, <b>new</b> <span class="t">ParameterMetadata</span>(<span class="r11 r">entry</span>.<span class="i">Value</span>));
            }
 
            <span class="c">// deep copy of the collection, collection items (Attributes) copied by reference</span>
            <b>if</b> (<span class="r10 r">other</span>.<a href="#4218dcd4db68f814" class="i field">_otherAttributes</a> == <b>null</b>)
            {
                <a href="#4218dcd4db68f814" class="i field">_otherAttributes</a> = <b>null</b>;
            }
            <b>else</b>
            {
                <a href="#4218dcd4db68f814" class="i field">_otherAttributes</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;(<b>new</b> <span class="i">List</span>&lt;<span class="i">Attribute</span>&gt;(<span class="r10 r">other</span>.<a href="#4218dcd4db68f814" class="i field">_otherAttributes</a>.<span class="i">Count</span>));
                <b>foreach</b> (<span class="i">Attribute</span> <span id="r12 rd" class="r12 r">attribute</span> <b>in</b> <span class="r10 r">other</span>.<a href="#4218dcd4db68f814" class="i field">_otherAttributes</a>)
                {
                    <a href="#4218dcd4db68f814" class="i field">_otherAttributes</a>.<span class="i">Add</span>(<span class="r12 r">attribute</span>);
                }
            }
 
            <span class="c">// not copying those fields/members as they are untouched (and left set to null)</span>
            <span class="c">// by public constructors, so we can&#39;t rely on those fields/members to be set</span>
            <span class="c">// when CommandMetadata comes from a user</span>
            <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor used by implicit remoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a773cfb499db4a06" href="../R/a773cfb499db4a06.html" target="n" data-glyph="74,1" class="t constructor">CommandMetadata</a>(
            <b>string</b> <span id="r13 rd" class="r13 r">name</span>,
            <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r14 rd" class="r14 r">commandType</span>,
            <b>bool</b> <span id="r15 rd" class="r15 r">isProxyForCmdlet</span>,
            <b>string</b> <span id="r16 rd" class="r16 r">defaultParameterSetName</span>,
            <b>bool</b> <span id="r17 rd" class="r17 r">supportsShouldProcess</span>,
            <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <span id="r18 rd" class="r18 r">confirmImpact</span>,
            <b>bool</b> <span id="r19 rd" class="r19 r">supportsPaging</span>,
            <b>bool</b> <span id="r20 rd" class="r20 r">supportsTransactions</span>,
            <b>bool</b> <span id="r21 rd" class="r21 r">positionalBinding</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <span id="r22 rd" class="r22 r">parameters</span>)
        {
            <a href="#8d0d4ac251b21d59" class="i property">Name</a> = <a href="#1fec58014079a921" class="i field">_wrappedCommand</a> = <span class="r13 r">name</span>;
            <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a> = <span class="r14 r">commandType</span>;
            <a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a> = <span class="r15 r">isProxyForCmdlet</span>;
            <a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a> = <span class="r16 r">defaultParameterSetName</span>;
            <a href="#aa53189195e06c7a" class="i property">SupportsShouldProcess</a> = <span class="r17 r">supportsShouldProcess</span>;
            <a href="#6e322fe87e0f4bcc" class="i property">SupportsPaging</a> = <span class="r19 r">supportsPaging</span>;
            <a href="#94737225e0faa8f9" class="i property">ConfirmImpact</a> = <span class="r18 r">confirmImpact</span>;
            <a href="#20ae284e47c80be8" class="i property">SupportsTransactions</a> = <span class="r20 r">supportsTransactions</span>;
            <a href="#c171e77e4fad3fde" class="i property">PositionalBinding</a> = <span class="r21 r">positionalBinding</span>;
            <a href="#543f906b9137ce10" class="k">this</a>.<a href="#3f6c73a7b157f755" class="i property">Parameters</a> = <span class="r22 r">parameters</span>;
        }
 
        <b>private void</b> <a id="0c1ae4b070dc34b5" href="../R/0c1ae4b070dc34b5.html" target="n" data-glyph="76,1" class="i method">Init</a>(<b>string</b> <span id="r23 rd" class="r23 r">name</span>, <b>string</b> <span id="r24 rd" class="r24 r">fullyQualifiedName</span>, <span class="i">Type</span> <span id="r25 rd" class="r25 r">commandType</span>, <b>bool</b> <span id="r26 rd" class="r26 r">shouldGenerateCommonParameters</span>)
        {
            <a href="#8d0d4ac251b21d59" class="i property">Name</a> = <span class="r23 r">name</span>;
            <a href="#543f906b9137ce10" class="k">this</a>.<a href="#45b42f65f7c23c04" class="i property">CommandType</a> = <span class="r25 r">commandType</span>;
 
            <b>if</b> (<span class="r25 r">commandType</span> != <b>null</b>)
            {
                <a href="#5dd43889ae130a01" class="i method">ConstructCmdletMetadataUsingReflection</a>();
                <a href="#1ca3116409a50c20" class="i field">_shouldGenerateCommonParameters</a> = <span class="r26 r">shouldGenerateCommonParameters</span>;
            }
 
            <span class="c">// Use fully qualified name if available.</span>
            <a href="#1fec58014079a921" class="i field">_wrappedCommand</a> = !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">fullyQualifiedName</span>) ? <span class="r24 r">fullyQualifiedName</span> : <a href="#8d0d4ac251b21d59" class="i property">Name</a>;
            <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a> = <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>;
            <a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a> = <b>true</b>;
        }
 
        <b>private void</b> <a id="75661c398c19710b" href="../R/75661c398c19710b.html" target="n" data-glyph="76,1" class="i method">Init</a>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r27 rd" class="r27 r">scriptBlock</span>, <b>string</b> <span id="r28 rd" class="r28 r">name</span>, <b>bool</b> <span id="r29 rd" class="r29 r">shouldGenerateCommonParameters</span>)
        {
            <b>if</b> (<span class="r27 r">scriptBlock</span>.<a href="runtime/CompiledScriptBlock.cs.html#42e46e4ff0244eb3" class="i property">UsesCmdletBinding</a>)
            {
                <a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a> = <b>true</b>;
            }
            <b>else</b>
            {
                <span class="c">// Ignore what was passed in, there are no common parameters if cmdlet binding is not used.</span>
                <span class="r29 r">shouldGenerateCommonParameters</span> = <b>false</b>;
            }
 
            <a href="Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a> <span id="r30 rd" class="r30 r">cmdletBindingAttribute</span> = <span class="r27 r">scriptBlock</span>.<a href="runtime/CompiledScriptBlock.cs.html#f357391ff92f5336" class="i property">CmdletBindingAttribute</a>;
            <b>if</b> (<span class="r30 r">cmdletBindingAttribute</span> != <b>null</b>)
            {
                <a href="#bb1438ade5133b78" class="i method">ProcessCmdletAttribute</a>(<span class="r30 r">cmdletBindingAttribute</span>);
            }
            <b>else</b> <b>if</b> (<span class="r27 r">scriptBlock</span>.<a href="runtime/CompiledScriptBlock.cs.html#42e46e4ff0244eb3" class="i property">UsesCmdletBinding</a>)
            {
                <a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a> = <b>null</b>;
            }
 
            <a href="#8743e273f4b3dfb6" class="i property">Obsolete</a> = <span class="r27 r">scriptBlock</span>.<a href="runtime/CompiledScriptBlock.cs.html#2acf0b78bcba9559" class="i property">ObsoleteAttribute</a>;
            <a href="#c84602d3c4ddf0ed" class="i field">_scriptBlock</a> = <span class="r27 r">scriptBlock</span>;
            <a href="#1fec58014079a921" class="i field">_wrappedCommand</a> = <a href="#8d0d4ac251b21d59" class="i property">Name</a> = <span class="r28 r">name</span>;
            <a href="#1ca3116409a50c20" class="i field">_shouldGenerateCommonParameters</a> = <span class="r29 r">shouldGenerateCommonParameters</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the metadata for the specified cmdlet from the cache or creates</span>
        <span class="c">///</span><span class="c"> a new instance if its not in the cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the command that this metadata represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">cmdletType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The cmdlet to get the metadata for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current engine context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The CommandMetadata for the specified cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">commandName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">cmdletType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#cde577fa1eaccc35" class="t t">ParsingMetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If more than int.MaxValue parameter-sets are defined for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="02b3e4cc7edd09ec" href="../R/02b3e4cc7edd09ec.html" target="n" data-glyph="74,1" class="i method">Get</a>(<b>string</b> <span id="r31 rd" class="r31 r">commandName</span>, <span class="i">Type</span> <span id="r32 rd" class="r32 r">cmdletType</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r33 rd" class="r33 r">context</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r31 r">commandName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r31 r">commandName</span>));
            }
 
            <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r34 rd" class="r34 r">result</span> = <b>null</b>;
 
            <b>if</b> ((<span class="r33 r">context</span> != <b>null</b>) &amp;&amp; (<span class="r32 r">cmdletType</span> != <b>null</b>))
            {
                <b>string</b> <span id="r35 rd" class="r35 r">cmdletTypeName</span> = <span class="r32 r">cmdletType</span>.<span class="i">AssemblyQualifiedName</span>;
                <a href="#e9a0c54d536f7ab8" class="i field">s_commandMetadataCache</a>.<span class="i">TryGetValue</span>(<span class="r35 r">cmdletTypeName</span>, <b>out</b> <span class="r34 r">result</span>);
            }
 
            <b>if</b> (<span class="r34 r">result</span> == <b>null</b>)
            {
                <span class="r34 r">result</span> = <b>new</b> <a href="#cb4e959b4c6966ae" class="t constructor">CommandMetadata</a>(<span class="r31 r">commandName</span>, <span class="r32 r">cmdletType</span>, <span class="r33 r">context</span>);
 
                <b>if</b> ((<span class="r33 r">context</span> != <b>null</b>) &amp;&amp; (<span class="r32 r">cmdletType</span> != <b>null</b>))
                {
                    <b>string</b> <span id="r36 rd" class="r36 r">cmdletTypeName</span> = <span class="r32 r">cmdletType</span>.<span class="i">AssemblyQualifiedName</span>;
                    <a href="#e9a0c54d536f7ab8" class="i field">s_commandMetadataCache</a>.<span class="i">TryAdd</span>(<span class="r36 r">cmdletTypeName</span>, <span class="r34 r">result</span>);
                }
            }
 
            <b>return</b> <span class="r34 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs an instance of CommandMetadata using reflection against a bindable object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the command that this metadata represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">cmdletType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of an object type that can be used to bind MSH parameters. A type is</span>
        <span class="c">///</span><span class="c"> considered bindable if it has at least one field and/or property that is decorated</span>
        <span class="c">///</span><span class="c"> with the ParameterAttribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current engine context. If null, the command and type metadata will be generated</span>
        <span class="c">///</span><span class="c"> and will not be cached.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">cmdletType</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#cde577fa1eaccc35" class="t t">ParsingMetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If more than int.MaxValue parameter-sets are defined for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter defines the same parameter-set name multiple times.</span>
        <span class="c">///</span><span class="c"> If the attributes could not be read from a property or field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="cb4e959b4c6966ae" href="../R/cb4e959b4c6966ae.html" target="n" data-glyph="74,1" class="t constructor">CommandMetadata</a>(<b>string</b> <span id="r37 rd" class="r37 r">commandName</span>, <span class="i">Type</span> <span id="r38 rd" class="r38 r">cmdletType</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r39 rd" class="r39 r">context</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r37 r">commandName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r37 r">commandName</span>));
            }
 
            <a href="#8d0d4ac251b21d59" class="i property">Name</a> = <span class="r37 r">commandName</span>;
            <a href="#543f906b9137ce10" class="k">this</a>.<a href="#45b42f65f7c23c04" class="i property">CommandType</a> = <span class="r38 r">cmdletType</span>;
 
            <b>if</b> (<span class="r38 r">cmdletType</span> != <b>null</b>)
            {
                <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r40 rd" class="r40 r">parameterMetadata</span> = <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<a href="TypeMetadata.cs.html#7af90786dfc7589c" class="i method">Get</a>(<span class="r38 r">cmdletType</span>, <span class="r39 r">context</span>, <b>false</b>);
                <a href="#5dd43889ae130a01" class="i method">ConstructCmdletMetadataUsingReflection</a>();
                <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a> = <a href="#5d60c274c6d991ec" class="i method">MergeParameterMetadata</a>(<span class="r39 r">context</span>, <span class="r40 r">parameterMetadata</span>, <b>true</b>);
                <a href="#17e610d48ec80ead" class="i field">_defaultParameterSetFlag</a> = <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a>.<a href="MergedCommandParameterMetadata.cs.html#1e4f66b12a1584cf" class="i method">GenerateParameterSetMappingFromMetadata</a>(<a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a>);
                <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a>.<a href="MergedCommandParameterMetadata.cs.html#2ef37f3bb8f1263c" class="i method">MakeReadOnly</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for creating command metadata from a script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">scriptblock</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unlike cmdlet based on a C# type where cmdlet metadata and parameter</span>
        <span class="c">///</span><span class="c"> metadata is created through reflecting the implementation type, script</span>
        <span class="c">///</span><span class="c"> cmdlet has different way for constructing metadata.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">     1. Metadata for cmdlet itself comes from cmdlet statement, which</span>
        <span class="c">///</span><span class="c">        is parsed into CmdletDeclarationNode and then converted into</span>
        <span class="c">///</span><span class="c">        a CmdletAttribute object.</span>
        <span class="c">///</span><span class="c">     2. Metadata for parameter comes from parameter declaration statement,</span>
        <span class="c">///</span><span class="c">        which is parsed into parameter nodes with parameter annotations.</span>
        <span class="c">///</span><span class="c">        Information in ParameterNodes is eventually transformed into a</span>
        <span class="c">///</span><span class="c">        dictionary of RuntimeDefinedParameters.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> By the time this constructor is called, information about CmdletAttribute</span>
        <span class="c">///</span><span class="c"> and RuntimeDefinedParameters for the script block has been setup with</span>
        <span class="c">///</span><span class="c"> the scriptblock object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a id="98d20845646470be" href="../R/98d20845646470be.html" target="n" data-glyph="74,1" class="t constructor">CommandMetadata</a>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r41 rd" class="r41 r">scriptblock</span>, <b>string</b> <span id="r43 rd" class="r43 r">commandName</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r42 rd" class="r42 r">context</span>)
        {
            <b>if</b> (<span class="r41 r">scriptblock</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r41 r">scriptblock</span>));
            }
 
            <a href="Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a> <span id="r44 rd" class="r44 r">cmdletBindingAttribute</span> = <span class="r41 r">scriptblock</span>.<a href="runtime/CompiledScriptBlock.cs.html#f357391ff92f5336" class="i property">CmdletBindingAttribute</a>;
 
            <b>if</b> (<span class="r44 r">cmdletBindingAttribute</span> != <b>null</b>)
            {
                <a href="#bb1438ade5133b78" class="i method">ProcessCmdletAttribute</a>(<span class="r44 r">cmdletBindingAttribute</span>);
            }
            <b>else</b>
            {
                <a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a> = <b>null</b>;
            }
 
            <a href="#8743e273f4b3dfb6" class="i property">Obsolete</a> = <span class="r41 r">scriptblock</span>.<a href="runtime/CompiledScriptBlock.cs.html#2acf0b78bcba9559" class="i property">ObsoleteAttribute</a>;
            <a href="#8d0d4ac251b21d59" class="i property">Name</a> = <span class="r43 r">commandName</span>;
            <a href="#543f906b9137ce10" class="k">this</a>.<a href="#45b42f65f7c23c04" class="i property">CommandType</a> = <b>typeof</b>(<a href="runtime/CompiledScriptBlock.cs.html#20151031a0be3c24" class="t t">PSScriptCmdlet</a>);
 
            <b>if</b> (<span class="r41 r">scriptblock</span>.<a href="runtime/CompiledScriptBlock.cs.html#1e6d0becba712301" class="i property">HasDynamicParameters</a>)
            {
                <a href="#3d51c59159570232" class="i field">_implementsDynamicParameters</a> = <b>true</b>;
            }
 
            <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r45 rd" class="r45 r">parameterMetadata</span> = <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<a href="TypeMetadata.cs.html#37a5e8eb404da755" class="i method">Get</a>(<span class="r41 r">scriptblock</span>.<a href="runtime/CompiledScriptBlock.cs.html#61f3934e64edc598" class="i property">RuntimeDefinedParameters</a>, <b>false</b>,
                                                                                        <span class="r41 r">scriptblock</span>.<a href="runtime/CompiledScriptBlock.cs.html#42e46e4ff0244eb3" class="i property">UsesCmdletBinding</a>);
            <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a> = <a href="#5d60c274c6d991ec" class="i method">MergeParameterMetadata</a>(<span class="r42 r">context</span>, <span class="r45 r">parameterMetadata</span>, <span class="r41 r">scriptblock</span>.<a href="runtime/CompiledScriptBlock.cs.html#42e46e4ff0244eb3" class="i property">UsesCmdletBinding</a>);
            <a href="#17e610d48ec80ead" class="i field">_defaultParameterSetFlag</a> = <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a>.<a href="MergedCommandParameterMetadata.cs.html#1e4f66b12a1584cf" class="i method">GenerateParameterSetMappingFromMetadata</a>(<a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a>);
            <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a>.<a href="MergedCommandParameterMetadata.cs.html#2ef37f3bb8f1263c" class="i method">MakeReadOnly</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the name of the command this metadata represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="8d0d4ac251b21d59" href="../R/8d0d4ac251b21d59.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Type which this CommandMetadata represents.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="45b42f65f7c23c04" href="../R/45b42f65f7c23c04.html" target="n" data-glyph="102,1" class="i property">CommandType</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">// The ScriptBlock which this CommandMetadata represents.</span>
        <b>private</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="c84602d3c4ddf0ed" href="../R/c84602d3c4ddf0ed.html" target="n" data-glyph="46,1" class="i field">_scriptBlock</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets/Sets the default parameter set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="8b69ebf363ce4bf7" href="../R/8b69ebf363ce4bf7.html" target="n" data-glyph="102,1" class="i property">DefaultParameterSetName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<b>value</b>))
                {
                    <b>value</b> = <a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>;
                }
 
                <a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="5ae7cd81536989d4" href="../R/5ae7cd81536989d4.html" target="n" data-glyph="46,1" class="i field">_defaultParameterSetName</a> = <a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the cmdlet declared that it supports ShouldProcess, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="aa53189195e06c7a" href="../R/aa53189195e06c7a.html" target="n" data-glyph="102,1" class="i property">SupportsShouldProcess</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the cmdlet declared that it supports Paging, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="6e322fe87e0f4bcc" href="../R/6e322fe87e0f4bcc.html" target="n" data-glyph="102,1" class="i property">SupportsPaging</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When true, the command will auto-generate appropriate parameter metadata to support positional</span>
        <span class="c">///</span><span class="c"> parameters if the script hasn&#39;t already specified multiple parameter sets or specified positions</span>
        <span class="c">///</span><span class="c"> explicitly via the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="c171e77e4fad3fde" href="../R/c171e77e4fad3fde.html" target="n" data-glyph="102,1" class="i property">PositionalBinding</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the cmdlet declared that it supports transactions, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="20ae284e47c80be8" href="../R/20ae284e47c80be8.html" target="n" data-glyph="102,1" class="i property">SupportsTransactions</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Related link URI for Get-Help -Online.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1056:UriPropertiesShouldNotBeStrings&quot;</span>)]
        <b>public string</b> <a id="5396c381060eb27f" href="../R/5396c381060eb27f.html" target="n" data-glyph="102,1" class="i property">HelpUri</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The remoting capabilities of this cmdlet, when exposed in a context</span>
        <span class="c">///</span><span class="c"> with ambient remoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a> <a id="20278fb4e2f49bdd" href="../R/20278fb4e2f49bdd.html" target="n" data-glyph="102,1" class="i property">RemotingCapability</a>
        {
            <b>get</b>
            {
                <a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a> <span id="r46 rd" class="r46 r">currentRemotingCapability</span> = <a href="#b6f4d657d961efd3" class="i field">_remotingCapability</a>;
                <b>if</b> ((<span class="r46 r">currentRemotingCapability</span> == <span class="i n">Automation</span>.<a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="remoting/common/misc.cs.html#eba7651d6fd75b39" class="i field">PowerShell</a>) &amp;&amp;
                    ((<a href="#543f906b9137ce10" class="k">this</a>.<a href="#3f6c73a7b157f755" class="i property">Parameters</a> != <b>null</b>) &amp;&amp; <a href="#543f906b9137ce10" class="k">this</a>.<a href="#3f6c73a7b157f755" class="i property">Parameters</a>.<span class="i">ContainsKey</span>(<span class="s">&quot;ComputerName&quot;</span>)))
                {
                    <a href="#b6f4d657d961efd3" class="i field">_remotingCapability</a> = <span class="i n">Automation</span>.<a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="remoting/common/misc.cs.html#d29c65a273d5cb37" class="i field">SupportedByCommand</a>;
                }
 
                <b>return</b> <a href="#b6f4d657d961efd3" class="i field">_remotingCapability</a>;
            }
 
            <b>set</b>
            {
                <a href="#b6f4d657d961efd3" class="i field">_remotingCapability</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a> <a id="b6f4d657d961efd3" href="../R/b6f4d657d961efd3.html" target="n" data-glyph="46,1" class="i field">_remotingCapability</a> = <a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="remoting/common/misc.cs.html#eba7651d6fd75b39" class="i field">PowerShell</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates the &quot;destructiveness&quot; of the command operation and</span>
        <span class="c">///</span><span class="c"> when it should be confirmed.  This is only effective when</span>
        <span class="c">///</span><span class="c"> the command calls ShouldProcess, which should only occur when</span>
        <span class="c">///</span><span class="c"> SupportsShouldProcess is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public</b> <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a> <a id="94737225e0faa8f9" href="../R/94737225e0faa8f9.html" target="n" data-glyph="102,1" class="i property">ConfirmImpact</a> { <b>get</b>; <b>set</b>; } = <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#f2126d83835863e8" class="i field">Medium</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the parameter data for this command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <a id="3f6c73a7b157f755" href="../R/3f6c73a7b157f755.html" target="n" data-glyph="102,1" class="i property">Parameters</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#5eb37c0d877161e7" class="i field">_parameters</a> == <b>null</b>)
                {
                    <span class="c">// Return parameters for a script block</span>
                    <b>if</b> (<a href="#c84602d3c4ddf0ed" class="i field">_scriptBlock</a> != <b>null</b>)
                    {
                        <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r47 rd" class="r47 r">parameterMetadata</span> = <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<a href="TypeMetadata.cs.html#37a5e8eb404da755" class="i method">Get</a>(<a href="#c84602d3c4ddf0ed" class="i field">_scriptBlock</a>.<a href="runtime/CompiledScriptBlock.cs.html#61f3934e64edc598" class="i property">RuntimeDefinedParameters</a>, <b>false</b>,
                                                                            <a href="#c84602d3c4ddf0ed" class="i field">_scriptBlock</a>.<a href="runtime/CompiledScriptBlock.cs.html#42e46e4ff0244eb3" class="i property">UsesCmdletBinding</a>);
                        <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r48 rd" class="r48 r">mergedCommandParameterMetadata</span> =
                            <a href="#5d60c274c6d991ec" class="i method">MergeParameterMetadata</a>(<b>null</b>, <span class="r47 r">parameterMetadata</span>, <a href="#1ca3116409a50c20" class="i field">_shouldGenerateCommonParameters</a>);
                        <a href="#5eb37c0d877161e7" class="i field">_parameters</a> = <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>.<a href="TypeMetadata.cs.html#048a9efefa0d22ed" class="i method">GetParameterMetadata</a>(<span class="r48 r">mergedCommandParameterMetadata</span>);
                    }
                    <b>else</b> <b>if</b> (<a href="#543f906b9137ce10" class="k">this</a>.<a href="#45b42f65f7c23c04" class="i property">CommandType</a> != <b>null</b>)
                    {
                        <span class="c">// Construct compiled parameter metadata from this</span>
                        <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r49 rd" class="r49 r">parameterMetadata</span> = <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<a href="TypeMetadata.cs.html#7af90786dfc7589c" class="i method">Get</a>(<a href="#543f906b9137ce10" class="k">this</a>.<a href="#45b42f65f7c23c04" class="i property">CommandType</a>, <b>null</b>, <b>false</b>);
                        <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r50 rd" class="r50 r">mergedCommandParameterMetadata</span> =
                            <a href="#5d60c274c6d991ec" class="i method">MergeParameterMetadata</a>(<b>null</b>, <span class="r49 r">parameterMetadata</span>, <a href="#1ca3116409a50c20" class="i field">_shouldGenerateCommonParameters</a>);
 
                        <span class="c">// Construct parameter metadata from compiled parameter metadata</span>
                        <span class="c">// compiled parameter metadata is used for internal purposes. It has lots of information</span>
                        <span class="c">// which is used by ParameterBinder.</span>
                        <a href="#5eb37c0d877161e7" class="i field">_parameters</a> = <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>.<a href="TypeMetadata.cs.html#048a9efefa0d22ed" class="i method">GetParameterMetadata</a>(<span class="r50 r">mergedCommandParameterMetadata</span>);
                    }
                }
 
                <b>return</b> <a href="#5eb37c0d877161e7" class="i field">_parameters</a>;
            }
 
            <b>private set</b>
            {
                <a href="#5eb37c0d877161e7" class="i field">_parameters</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <a id="5eb37c0d877161e7" href="../R/5eb37c0d877161e7.html" target="n" data-glyph="46,1" class="i field">_parameters</a>;
        <b>private bool</b> <a id="1ca3116409a50c20" href="../R/1ca3116409a50c20.html" target="n" data-glyph="46,1" class="i field">_shouldGenerateCommonParameters</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the obsolete attribute on the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">ObsoleteAttribute</span> <a id="8743e273f4b3dfb6" href="../R/8743e273f4b3dfb6.html" target="n" data-glyph="104,1" class="i property">Obsolete</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the merged metadata for the command including cmdlet declared parameters,</span>
        <span class="c">///</span><span class="c"> common parameters, and (optionally) ShouldProcess and Transactions parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="2949218a02f2a560" href="../R/2949218a02f2a560.html" target="n" data-glyph="104,1" class="i property">StaticCommandParameterMetadata</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#049e09696413b6fd" class="i field">_staticCommandParameterMetadata</a>;
            }
        }
 
        <b>private readonly</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="049e09696413b6fd" href="../R/049e09696413b6fd.html" target="n" data-glyph="46,1" class="i field">_staticCommandParameterMetadata</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the cmdlet implements dynamic parameters, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="132ba2fe4030925b" href="../R/132ba2fe4030925b.html" target="n" data-glyph="104,1" class="i property">ImplementsDynamicParameters</a>
        {
            <b>get</b> { <b>return</b> <a href="#3d51c59159570232" class="i field">_implementsDynamicParameters</a>; }
        }
 
        <b>private bool</b> <a id="3d51c59159570232" href="../R/3d51c59159570232.html" target="n" data-glyph="46,1" class="i field">_implementsDynamicParameters</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the bit in the parameter set map for the default parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal uint</b> <a id="5b69467350bd1a5b" href="../R/5b69467350bd1a5b.html" target="n" data-glyph="104,1" class="i property">DefaultParameterSetFlag</a>
        {
            <b>get</b> { <b>return</b> <a href="#17e610d48ec80ead" class="i field">_defaultParameterSetFlag</a>; }
 
            <b>set</b> { <a href="#17e610d48ec80ead" class="i field">_defaultParameterSetFlag</a> = <b>value</b>; }
        }
 
        <b>private uint</b> <a id="17e610d48ec80ead" href="../R/17e610d48ec80ead.html" target="n" data-glyph="46,1" class="i field">_defaultParameterSetFlag</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of attributes that were declared at the cmdlet level but were not</span>
        <span class="c">///</span><span class="c"> recognized by the engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt; <a id="4218dcd4db68f814" href="../R/4218dcd4db68f814.html" target="n" data-glyph="46,1" class="i field">_otherAttributes</a> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;();
 
        <span class="c">// command this CommandMetadata instance is intended to wrap</span>
        <b>private string</b> <a id="1fec58014079a921" href="../R/1fec58014079a921.html" target="n" data-glyph="46,1" class="i field">_wrappedCommand</a>;
        <span class="c">// the type of command this CommandMetadata instance is intended to wrap</span>
        <b>private</b> <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <a id="95d13becedee08ce" href="../R/95d13becedee08ce.html" target="n" data-glyph="46,1" class="i field">_wrappedCommandType</a>;
        <span class="c">// The CommandType for a script cmdlet is not CommandTypes.Cmdlet, yet</span>
        <span class="c">// proxy generation needs to know the difference between script and script cmdlet.</span>
        <b>private bool</b> <a id="c037d3b0aa4493fd" href="../R/c037d3b0aa4493fd.html" target="n" data-glyph="46,1" class="i field">_wrappedAnyCmdlet</a>;
 
        <b>internal bool</b> <a id="8c63605ed8210320" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">WrappedAnyCmdlet</a>
        {
            <b>get</b> { <b>return</b> <a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a>; }
        }
 
        <b>internal</b> <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <a id="5aa28a62504c5bb4" href="../R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">WrappedCommandType</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> internal members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> helper methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs the command metadata by using reflection against the</span>
        <span class="c">///</span><span class="c"> CLR type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#cde577fa1eaccc35" class="t t">ParsingMetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If more than int.MaxValue parameter-sets are defined for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="5dd43889ae130a01" href="../R/5dd43889ae130a01.html" target="n" data-glyph="76,1" class="i method">ConstructCmdletMetadataUsingReflection</a>()
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <a href="#45b42f65f7c23c04" class="i property">CommandType</a> != <b>null</b>,
                <span class="s">&quot;This method should only be called when constructed with the Type&quot;</span>);
 
            <span class="c">// Determine if the cmdlet implements dynamic parameters by looking for the interface</span>
 
            <span class="i">Type</span> <span id="r51 rd" class="r51 r">dynamicParametersType</span> = <a href="#45b42f65f7c23c04" class="i property">CommandType</a>.<span class="i">GetInterface</span>(<b>nameof</b>(<a href="MshCmdlet.cs.html#c401984c7c9aeb48" class="t t">IDynamicParameters</a>), <b>true</b>);
 
            <b>if</b> (<span class="r51 r">dynamicParametersType</span> != <b>null</b>)
            {
                <a href="#3d51c59159570232" class="i field">_implementsDynamicParameters</a> = <b>true</b>;
            }
 
            <span class="c">// Process the attributes on the cmdlet</span>
 
            <b>var</b> <span id="r52 rd" class="r52 r">customAttributes</span> = <a href="#45b42f65f7c23c04" class="i property">CommandType</a>.<span class="i">GetCustomAttributes</span>(<b>false</b>);
 
            <b>foreach</b> (<span class="i">Attribute</span> <span id="r53 rd" class="r53 r">attribute</span> <b>in</b> <span class="r52 r">customAttributes</span>)
            {
                <a href="Attributes.cs.html#1c6b89ca87d7bfea" class="t t">CmdletAttribute</a> <span id="r54 rd" class="r54 r">cmdletAttribute</span> = <span class="r53 r">attribute</span> <b>as</b> <a href="Attributes.cs.html#1c6b89ca87d7bfea" class="t t">CmdletAttribute</a>;
                <b>if</b> (<span class="r54 r">cmdletAttribute</span> != <b>null</b>)
                {
                    <a href="#bb1438ade5133b78" class="i method">ProcessCmdletAttribute</a>(<span class="r54 r">cmdletAttribute</span>);
                    <a href="#543f906b9137ce10" class="k">this</a>.<a href="#8d0d4ac251b21d59" class="i property">Name</a> = <span class="r54 r">cmdletAttribute</span>.<a href="Attributes.cs.html#1897aa9f4581e0e7" class="i property">VerbName</a> + <span class="s">&quot;-&quot;</span> + <span class="r54 r">cmdletAttribute</span>.<a href="Attributes.cs.html#8161a285f9ba64d0" class="i property">NounName</a>;
                }
                <b>else</b> <b>if</b> (<span class="r53 r">attribute</span> <b>is</b> <span class="i">ObsoleteAttribute</span>)
                {
                    <a href="#8743e273f4b3dfb6" class="i property">Obsolete</a> = (<span class="i">ObsoleteAttribute</span>)<span class="r53 r">attribute</span>;
                }
                <b>else</b>
                {
                    <a href="#4218dcd4db68f814" class="i field">_otherAttributes</a>.<span class="i">Add</span>(<span class="r53 r">attribute</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Extracts the cmdlet data from the CmdletAttribute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">attribute</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The CmdletAttribute to process</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">attribute</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#cde577fa1eaccc35" class="t t">ParsingMetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If more than int.MaxValue parameter-sets are defined for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="bb1438ade5133b78" href="../R/bb1438ade5133b78.html" target="n" data-glyph="76,1" class="i method">ProcessCmdletAttribute</a>(<a href="Attributes.cs.html#d7ea758d33bcef80" class="t t">CmdletCommonMetadataAttribute</a> <span id="r55 rd" class="r55 r">attribute</span>)
        {
            <b>if</b> (<span class="r55 r">attribute</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r55 r">attribute</span>));
            }
 
            <span class="c">// Process the default parameter set name</span>
            <a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a> = <span class="r55 r">attribute</span>.<a href="Attributes.cs.html#7bcab566998127aa" class="i property">DefaultParameterSetName</a>;
 
            <span class="c">// Check to see if the cmdlet supports ShouldProcess</span>
            <a href="#aa53189195e06c7a" class="i property">SupportsShouldProcess</a> = <span class="r55 r">attribute</span>.<a href="Attributes.cs.html#a74bb3710497b882" class="i property">SupportsShouldProcess</a>;
 
            <span class="c">// Determine the cmdlet&#39;s impact confirmation</span>
            <a href="#94737225e0faa8f9" class="i property">ConfirmImpact</a> = <span class="r55 r">attribute</span>.<a href="Attributes.cs.html#050b5caee084ffcc" class="i property">ConfirmImpact</a>;
 
            <span class="c">// Check to see if the cmdlet supports paging</span>
            <a href="#6e322fe87e0f4bcc" class="i property">SupportsPaging</a> = <span class="r55 r">attribute</span>.<a href="Attributes.cs.html#1dd714e8974c7fe0" class="i property">SupportsPaging</a>;
 
            <span class="c">// Check to see if the cmdlet supports transactions</span>
            <a href="#20ae284e47c80be8" class="i property">SupportsTransactions</a> = <span class="r55 r">attribute</span>.<a href="Attributes.cs.html#171f9a9c636aad16" class="i property">SupportsTransactions</a>;
 
            <span class="c">// Grab related link</span>
            <a href="#5396c381060eb27f" class="i property">HelpUri</a> = <span class="r55 r">attribute</span>.<a href="Attributes.cs.html#b86e0f84f57581eb" class="i property">HelpUri</a>;
 
            <span class="c">// Remoting support</span>
            <a href="#b6f4d657d961efd3" class="i field">_remotingCapability</a> = <span class="r55 r">attribute</span>.<a href="Attributes.cs.html#94d7a58858c6cd15" class="i property">RemotingCapability</a>;
 
            <span class="c">// Check to see if the cmdlet uses positional binding</span>
            <a href="Attributes.cs.html#67a775c242618ea6" class="k">var</a> <span id="r56 rd" class="r56 r">cmdletBindingAttribute</span> = <span class="r55 r">attribute</span> <b>as</b> <a href="Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>;
            <b>if</b> (<span class="r56 r">cmdletBindingAttribute</span> != <b>null</b>)
            {
                <a href="#c171e77e4fad3fde" class="i property">PositionalBinding</a> = <span class="r56 r">cmdletBindingAttribute</span>.<a href="Attributes.cs.html#923927e48096d1bb" class="i property">PositionalBinding</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Merges parameter metadata from different sources: those that are coming from Type,</span>
        <span class="c">///</span><span class="c"> CommonParameters, should process etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">parameterMetadata</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">shouldGenerateCommonParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if metadata info about Verbose,Debug etc needs to be generated.</span>
        <span class="c">///</span><span class="c"> false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="5d60c274c6d991ec" href="../R/5d60c274c6d991ec.html" target="n" data-glyph="76,1" class="i method">MergeParameterMetadata</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r57 rd" class="r57 r">context</span>, <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r58 rd" class="r58 r">parameterMetadata</span>, <b>bool</b> <span id="r59 rd" class="r59 r">shouldGenerateCommonParameters</span>)
        {
            <span class="c">// Create an instance of the static metadata class</span>
            <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r60 rd" class="r60 r">staticCommandParameterMetadata</span> =
                <b>new</b> <span class="t">MergedCommandParameterMetadata</span>();
 
            <span class="c">// First add the metadata for the formal cmdlet parameters</span>
            <span class="r60 r">staticCommandParameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#38d7db725edf154f" class="i method">AddMetadataForBinder</a>(
                <span class="r58 r">parameterMetadata</span>,
                <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#515e5d093bc20be2" class="i field">DeclaredFormalParameters</a>);
 
            <span class="c">// Now add the common parameters metadata</span>
            <b>if</b> (<span class="r59 r">shouldGenerateCommonParameters</span>)
            {
                <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r61 rd" class="r61 r">commonParametersMetadata</span> =
                    <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<span class="i">Get</span>(<b>typeof</b>(<a href="CommonCommandParameters.cs.html#2ad29128f1bdef2a" class="t t">CommonParameters</a>), <span class="r57 r">context</span>, <b>false</b>);
 
                <span class="r60 r">staticCommandParameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#38d7db725edf154f" class="i method">AddMetadataForBinder</a>(
                    <span class="r61 r">commonParametersMetadata</span>,
                    <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#5061cf0360fde0b5" class="i field">CommonParameters</a>);
 
                <span class="c">// If the command supports ShouldProcess, add the metadata for</span>
                <span class="c">// those parameters</span>
                <b>if</b> (<a href="#543f906b9137ce10" class="k">this</a>.<a href="#aa53189195e06c7a" class="i property">SupportsShouldProcess</a>)
                {
                    <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r62 rd" class="r62 r">shouldProcessParametersMetadata</span> =
                        <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<span class="i">Get</span>(<b>typeof</b>(<a href="UserFeedbackParameters.cs.html#bc412e9aa0179760" class="t t">ShouldProcessParameters</a>), <span class="r57 r">context</span>, <b>false</b>);
 
                    <span class="r60 r">staticCommandParameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#38d7db725edf154f" class="i method">AddMetadataForBinder</a>(
                        <span class="r62 r">shouldProcessParametersMetadata</span>,
                        <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#c60a12a7e7110562" class="i field">ShouldProcessParameters</a>);
                }
 
                <span class="c">// If the command supports paging, add the metadata for</span>
                <span class="c">// those parameters</span>
                <b>if</b> (<a href="#543f906b9137ce10" class="k">this</a>.<a href="#6e322fe87e0f4bcc" class="i property">SupportsPaging</a>)
                {
                    <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r63 rd" class="r63 r">pagingParametersMetadata</span> =
                        <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<span class="i">Get</span>(<b>typeof</b>(<a href="UserFeedbackParameters.cs.html#19fbf494d8a3adaf" class="t t">PagingParameters</a>), <span class="r57 r">context</span>, <b>false</b>);
 
                    <span class="r60 r">staticCommandParameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#38d7db725edf154f" class="i method">AddMetadataForBinder</a>(
                        <span class="r63 r">pagingParametersMetadata</span>,
                        <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#5c8c49bf90cb9996" class="i field">PagingParameters</a>);
                }
 
                <span class="c">// If the command supports transactions, add the metadata for</span>
                <span class="c">// those parameters</span>
                <b>if</b> (<a href="#543f906b9137ce10" class="k">this</a>.<a href="#20ae284e47c80be8" class="i property">SupportsTransactions</a>)
                {
                    <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r64 rd" class="r64 r">transactionParametersMetadata</span> =
                        <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<span class="i">Get</span>(<b>typeof</b>(<a href="UserFeedbackParameters.cs.html#88f4e3c74eecfca7" class="t t">TransactionParameters</a>), <span class="r57 r">context</span>, <b>false</b>);
 
                    <span class="r60 r">staticCommandParameterMetadata</span>.<a href="MergedCommandParameterMetadata.cs.html#38d7db725edf154f" class="i method">AddMetadataForBinder</a>(
                        <span class="r64 r">transactionParametersMetadata</span>,
                        <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#1bd613dc40264db8" class="i field">TransactionParameters</a>);
                }
            }
 
            <b>return</b> <span class="r60 r">staticCommandParameterMetadata</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> helper methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Proxy Command generation
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ScriptCmdlet in string format.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="c4d9f17dfcf32a8a" href="../R/c4d9f17dfcf32a8a.html" target="n" data-glyph="74,1" class="i method">GetProxyCommand</a>(<b>string</b> <span id="r65 rd" class="r65 r">helpComment</span>, <b>bool</b> <span id="r66 rd" class="r66 r">generateDynamicParameters</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r65 r">helpComment</span>))
            {
                <span class="r65 r">helpComment</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;
.ForwardHelpTargetName {0}
.ForwardHelpCategory {1}
&quot;</span>,
                    <a href="#1fec58014079a921" class="i field">_wrappedCommand</a>, <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a>);
            }
 
            <b>string</b> <span id="r67 rd" class="r67 r">dynamicParamblock</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r66 r">generateDynamicParameters</span> &amp;&amp; <a href="#543f906b9137ce10" class="k">this</a>.<a href="#132ba2fe4030925b" class="i property">ImplementsDynamicParameters</a>)
            {
                <span class="r67 r">dynamicParamblock</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;
dynamicparam
{{{0}}}
 
&quot;</span>, <a href="#304b74e58f4b3e28" class="i method">GetDynamicParamBlock</a>());
            }
 
            <b>string</b> <span id="r68 rd" class="r68 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;{0}
param({1})
 
{2}begin
{{{3}}}
 
process
{{{4}}}
 
end
{{{5}}}
&lt;#
{6}
#&gt;
&quot;</span>,
                <a href="#6edced04a94a8a8c" class="i method">GetDecl</a>(),
                <a href="#f58c339e73398873" class="i method">GetParamBlock</a>(),
                <span class="r67 r">dynamicParamblock</span>,
                <a href="#f216447d77319de0" class="i method">GetBeginBlock</a>(),
                <a href="#f3ceb4d0c6a8472a" class="i method">GetProcessBlock</a>(),
                <a href="#22a970424e0c51bc" class="i method">GetEndBlock</a>(),
                <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#ce750f8c6b0f451d" class="i method">EscapeBlockCommentContent</a>(<span class="r65 r">helpComment</span>));
 
            <b>return</b> <span class="r68 r">result</span>;
        }
 
        <b>internal string</b> <a id="6edced04a94a8a8c" href="../R/6edced04a94a8a8c.html" target="n" data-glyph="74,1" class="i method">GetDecl</a>()
        {
            <b>string</b> <span id="r69 rd" class="r69 r">result</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r70 rd" class="r70 r">separator</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a>)
            {
                <span class="i">StringBuilder</span> <span id="r71 rd" class="r71 r">decl</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="s">&quot;[CmdletBinding(&quot;</span>);
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a>))
                {
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;DefaultParameterSetName=&#39;&quot;</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#5ae7cd81536989d4" class="i field">_defaultParameterSetName</a>));
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                    <span class="r70 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                }
 
                <b>if</b> (<a href="#aa53189195e06c7a" class="i property">SupportsShouldProcess</a>)
                {
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;SupportsShouldProcess=$true&quot;</span>);
                    <span class="r70 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;ConfirmImpact=&#39;&quot;</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<a href="#94737225e0faa8f9" class="i property">ConfirmImpact</a>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                }
 
                <b>if</b> (<a href="#6e322fe87e0f4bcc" class="i property">SupportsPaging</a>)
                {
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;SupportsPaging=$true&quot;</span>);
                    <span class="r70 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                }
 
                <b>if</b> (<a href="#20ae284e47c80be8" class="i property">SupportsTransactions</a>)
                {
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;SupportsTransactions=$true&quot;</span>);
                    <span class="r70 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                }
 
                <b>if</b> (!<a href="#c171e77e4fad3fde" class="i property">PositionalBinding</a>)
                {
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;PositionalBinding=$false&quot;</span>);
                    <span class="r70 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#5396c381060eb27f" class="i property">HelpUri</a>))
                {
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;HelpUri=&#39;&quot;</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#5396c381060eb27f" class="i property">HelpUri</a>));
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                    <span class="r70 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                }
 
                <b>if</b> (<a href="#b6f4d657d961efd3" class="i field">_remotingCapability</a> != <a href="remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="remoting/common/misc.cs.html#eba7651d6fd75b39" class="i field">PowerShell</a>)
                {
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="r70 r">separator</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;RemotingCapability=&#39;&quot;</span>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<a href="#b6f4d657d961efd3" class="i field">_remotingCapability</a>);
                    <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&#39;\&#39;&#39;</span>);
                    <span class="r70 r">separator</span> = <span class="s">&quot;, &quot;</span>;
                }
 
                <span class="r71 r">decl</span>.<span class="i">Append</span>(<span class="s">&quot;)]&quot;</span>);
 
                <span class="r69 r">result</span> = <span class="r71 r">decl</span>.<span class="i">ToString</span>();
            }
 
            <b>return</b> <span class="r69 r">result</span>;
        }
 
        <b>internal string</b> <a id="f58c339e73398873" href="../R/f58c339e73398873.html" target="n" data-glyph="74,1" class="i method">GetParamBlock</a>()
        {
            <b>if</b> (<a href="#3f6c73a7b157f755" class="i property">Parameters</a>.<span class="i">Keys</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">StringBuilder</span> <span id="r72 rd" class="r72 r">parameters</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <b>string</b> <span id="r73 rd" class="r73 r">prefix</span> = <b>string</b>.<span class="i">Concat</span>(<span class="i">Environment</span>.<span class="i">NewLine</span>, <span class="s">&quot;    &quot;</span>);
                <b>string</b> <span id="r74 rd" class="r74 r">paramDataPrefix</span> = <b>null</b>;
 
                <b>foreach</b> (<b>var</b> <span id="r75 rd" class="r75 r">pair</span> <b>in</b> <a href="#3f6c73a7b157f755" class="i property">Parameters</a>)
                {
                    <b>if</b> (<span class="r74 r">paramDataPrefix</span> != <b>null</b>)
                    {
                        <span class="r72 r">parameters</span>.<span class="i">Append</span>(<span class="r74 r">paramDataPrefix</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// syntax for parameter separation : comma followed by new-line.</span>
                        <span class="r74 r">paramDataPrefix</span> = <b>string</b>.<span class="i">Concat</span>(<span class="s">&quot;,&quot;</span>, <span class="i">Environment</span>.<span class="i">NewLine</span>);
                    }
                    <span class="c">// generate the parameter proxy and append to the list</span>
                    <b>string</b> <span id="r76 rd" class="r76 r">paramData</span> = <span class="r75 r">pair</span>.<span class="i">Value</span>.<span class="i">GetProxyParameterData</span>(<span class="r73 r">prefix</span>, <span class="r75 r">pair</span>.<span class="i">Key</span>, <a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a>);
                    <span class="r72 r">parameters</span>.<span class="i">Append</span>(<span class="r76 r">paramData</span>);
                }
 
                <b>return</b> <span class="r72 r">parameters</span>.<span class="i">ToString</span>();
            }
 
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
 
        <b>internal string</b> <a id="f216447d77319de0" href="../R/f216447d77319de0.html" target="n" data-glyph="74,1" class="i method">GetBeginBlock</a>()
        {
            <b>string</b> <span id="r77 rd" class="r77 r">result</span>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#1fec58014079a921" class="i field">_wrappedCommand</a>))
            {
                <b>string</b> <span id="r78 rd" class="r78 r">error</span> = <span class="i">ProxyCommandStrings</span>.<span class="i">CommandMetadataMissingCommandName</span>;
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r78 r">error</span>);
            }
 
            <b>string</b> <span id="r79 rd" class="r79 r">commandOrigin</span> = <span class="s">&quot;$myInvocation.CommandOrigin&quot;</span>;
 
            <span class="c">// For functions, don&#39;t proxy the command origin, otherwise they will</span>
            <span class="c">// be subject to the runspace restrictions</span>
            <b>if</b> (<a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a> == <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a>)
            {
                <span class="r79 r">commandOrigin</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>if</b> (<a href="#c037d3b0aa4493fd" class="i field">_wrappedAnyCmdlet</a>)
            {
                <span class="r77 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;
    try {{
        $outBuffer = $null
        if ($PSBoundParameters.TryGetValue(&#39;OutBuffer&#39;, [ref]$outBuffer))
        {{
            $PSBoundParameters[&#39;OutBuffer&#39;] = 1
        }}
 
        $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand(&#39;{0}&#39;, [System.Management.Automation.CommandTypes]::{1})
        $scriptCmd = {{&amp; $wrappedCmd @PSBoundParameters }}
 
        $steppablePipeline = $scriptCmd.GetSteppablePipeline({2})
        $steppablePipeline.Begin($PSCmdlet)
    }} catch {{
        throw
    }}
&quot;</span>,
                    <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#1fec58014079a921" class="i field">_wrappedCommand</a>),
                    <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a>,
                    <span class="r79 r">commandOrigin</span>
                    );
            }
            <b>else</b>
            {
                <span class="r77 r">result</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;
    try {{
        $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand(&#39;{0}&#39;, [System.Management.Automation.CommandTypes]::{1})
        $PSBoundParameters.Add(&#39;$args&#39;, $args)
        $scriptCmd = {{&amp; $wrappedCmd @PSBoundParameters }}
 
        $steppablePipeline = $scriptCmd.GetSteppablePipeline({2})
        $steppablePipeline.Begin($myInvocation.ExpectingInput, $ExecutionContext)
    }} catch {{
        throw
    }}
&quot;</span>,
                <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#1fec58014079a921" class="i field">_wrappedCommand</a>),
                <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a>,
                <span class="r79 r">commandOrigin</span>
                );
            }
 
            <b>return</b> <span class="r77 r">result</span>;
        }
 
        <b>internal string</b> <a id="f3ceb4d0c6a8472a" href="../R/f3ceb4d0c6a8472a.html" target="n" data-glyph="74,1" class="i method">GetProcessBlock</a>()
        {
            <b>return</b> <span class="s">@&quot;
    try {
        $steppablePipeline.Process($_)
    } catch {
        throw
    }
&quot;</span>;
        }
 
        <b>internal string</b> <a id="304b74e58f4b3e28" href="../R/304b74e58f4b3e28.html" target="n" data-glyph="74,1" class="i method">GetDynamicParamBlock</a>()
        {
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">@&quot;
    try {{
        $targetCmd = $ExecutionContext.InvokeCommand.GetCommand(&#39;{0}&#39;, [System.Management.Automation.CommandTypes]::{1}, $PSBoundParameters)
        $dynamicParams = @($targetCmd.Parameters.GetEnumerator() | Microsoft.PowerShell.Core\Where-Object {{ $_.Value.IsDynamic }})
        if ($dynamicParams.Length -gt 0)
        {{
            $paramDictionary = [Management.Automation.RuntimeDefinedParameterDictionary]::new()
            foreach ($param in $dynamicParams)
            {{
                $param = $param.Value
 
                if(-not $MyInvocation.MyCommand.Parameters.ContainsKey($param.Name))
                {{
                    $dynParam = [Management.Automation.RuntimeDefinedParameter]::new($param.Name, $param.ParameterType, $param.Attributes)
                    $paramDictionary.Add($param.Name, $dynParam)
                }}
            }}
 
            return $paramDictionary
        }}
    }} catch {{
        throw
    }}
&quot;</span>,
            <a href="lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#1fec58014079a921" class="i field">_wrappedCommand</a>),
            <a href="#95d13becedee08ce" class="i field">_wrappedCommandType</a>);
        }
 
        <b>internal string</b> <a id="22a970424e0c51bc" href="../R/22a970424e0c51bc.html" target="n" data-glyph="74,1" class="i method">GetEndBlock</a>()
        {
            <b>return</b> <span class="s">@&quot;
    try {
        $steppablePipeline.End()
    } catch {
        throw
    }
&quot;</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helper methods for restricting commands needed by implicit and interactive remoting
 
        <b>internal const string</b> <a id="c90a41934f1cc43e" href="../R/c90a41934f1cc43e.html" target="n" data-glyph="8,1" class="i field">isSafeNameOrIdentifierRegex</a> = <span class="s">@&quot;^[-._:\\\p{Ll}\p{Lu}\p{Lt}\p{Lo}\p{Nd}\p{Lm}]{1,100}$&quot;</span>;
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="1622ad209de556f7" href="../R/1622ad209de556f7.html" target="n" data-glyph="76,1" class="i method">GetRestrictedCmdlet</a>(<b>string</b> <span id="r80 rd" class="r80 r">cmdletName</span>, <b>string</b> <span id="r81 rd" class="r81 r">defaultParameterSet</span>, <b>string</b> <span id="r82 rd" class="r82 r">helpUri</span>, <b>params</b> <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>[] <span id="r83 rd" class="r83 r">parameters</span>)
        {
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt; <span id="r84 rd" class="r84 r">parametersDictionary</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r85 rd" class="r85 r">parameter</span> <b>in</b> <span class="r83 r">parameters</span>)
            {
                <span class="r84 r">parametersDictionary</span>.<span class="i">Add</span>(<span class="r85 r">parameter</span>.<a href="TypeMetadata.cs.html#12f6ecd22fc50a11" class="i property">Name</a>, <span class="r85 r">parameter</span>);
            }
 
            <span class="c">// isProxyForCmdlet:</span>
            <span class="c">// 1a. we would want to set it to false to get rid of unused common parameters</span>
            <span class="c">//    (like OutBuffer - see bug Windows 7: #402213)</span>
            <span class="c">// 1b. otoh common parameters are going to be present anyway on all proxy functions</span>
            <span class="c">//     that the host generates for its cmdlets that need cmdletbinding, so</span>
            <span class="c">//     we should make sure that common parameters are safe, not hide them</span>
            <span class="c">// 2. otoh without cmdletbinding() unspecified parameters get bound to $null which might</span>
            <span class="c">//    unnecessarily trigger validation attribute failures - see bug Windows 7: #477218</span>
 
            <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r86 rd" class="r86 r">metadata</span> = <b>new</b> <a href="#a773cfb499db4a06" class="t constructor">CommandMetadata</a>(
                                   <span class="r13 r">name</span>: <span class="r80 r">cmdletName</span>,
                            <span class="r14 r">commandType</span>: <a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a>,
                       <span class="r15 r">isProxyForCmdlet</span>: <b>true</b>,
                <span class="r16 r">defaultParameterSetName</span>: <span class="r81 r">defaultParameterSet</span>,
                  <span class="r17 r">supportsShouldProcess</span>: <b>false</b>,
                          <span class="r18 r">confirmImpact</span>: <a href="CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>.<a href="CommandBase.cs.html#5b2b0bf78675f285" class="i field">None</a>,
                         <span class="r19 r">supportsPaging</span>: <b>false</b>,
                   <span class="r20 r">supportsTransactions</span>: <b>false</b>,
                      <span class="r21 r">positionalBinding</span>: <b>true</b>,
                             <span class="r22 r">parameters</span>: <span class="r84 r">parametersDictionary</span>);
 
            <span class="r86 r">metadata</span>.<a href="#5396c381060eb27f" class="i property">HelpUri</a> = <span class="r82 r">helpUri</span>;
 
            <b>return</b> <span class="r86 r">metadata</span>;
        }
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="5d8caf95acb08d4b" href="../R/5d8caf95acb08d4b.html" target="n" data-glyph="76,1" class="i method">GetRestrictedGetCommand</a>()
        {
            <span class="c">// remote Get-Command called by Import/Export-PSSession to get metadata for remote commands that user wants to import</span>
 
            <span class="c">// remote Get-Command is also called by interactive remoting before entering the remote session to verify</span>
            <span class="c">// that Out-Default and Exit-PSSession commands are present in the remote session</span>
 
            <span class="c">// value passed directly from Import-PSSession -CommandName to Get-Command -Name</span>
            <span class="c">// can&#39;t really restrict beyond basics</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r87 rd" class="r87 r">nameParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;Name&quot;</span>, <b>typeof</b>(<b>string</b>[]));
            <span class="r87 r">nameParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#b590229b4c493ef7" class="t constructor">ValidateLengthAttribute</a>(0, 1000));
            <span class="r87 r">nameParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#26b3a4564a8cb309" class="t constructor">ValidateCountAttribute</a>(0, 1000));
 
            <span class="c">// value passed directly from Import-PSSession -PSSnapIn to Get-Command -Module</span>
            <span class="c">// can&#39;t really restrict beyond basics</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r88 rd" class="r88 r">moduleParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;Module&quot;</span>, <b>typeof</b>(<b>string</b>[]));
            <span class="r88 r">moduleParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#b590229b4c493ef7" class="t constructor">ValidateLengthAttribute</a>(0, 1000));
            <span class="r88 r">moduleParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#26b3a4564a8cb309" class="t constructor">ValidateCountAttribute</a>(0, 100));
 
            <span class="c">// value passed directly from Import-PSSession -ArgumentList to Get-Command -ArgumentList</span>
            <span class="c">// can&#39;t really restrict beyond basics</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r89 rd" class="r89 r">argumentListParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;ArgumentList&quot;</span>, <b>typeof</b>(<b>object</b>[]));
            <span class="r89 r">argumentListParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#26b3a4564a8cb309" class="t constructor">ValidateCountAttribute</a>(0, 100));
 
            <span class="c">// value passed directly from Import-PSSession -CommandType to Get-Command -CommandType</span>
            <span class="c">// can&#39;t really restrict beyond basics</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r90 rd" class="r90 r">commandTypeParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;CommandType&quot;</span>, <b>typeof</b>(<a href="CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>));
 
            <span class="c">// we do allow -ListImported switch</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r91 rd" class="r91 r">listImportedParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;ListImported&quot;</span>, <b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>));
 
            <span class="c">// Need to expose ShowCommandInfo parameter for remote ShowCommand support.</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r92 rd" class="r92 r">showCommandInfo</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;ShowCommandInfo&quot;</span>, <b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>));
 
            <b>return</b> <a href="#1622ad209de556f7" class="i method">GetRestrictedCmdlet</a>(
                <span class="s">&quot;Get-Command&quot;</span>,
                <b>null</b>, <span class="c">// defaultParameterSet</span>
                <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=113309&quot;</span>, <span class="c">// helpUri</span>
                <span class="r87 r">nameParameter</span>,
                <span class="r88 r">moduleParameter</span>,
                <span class="r89 r">argumentListParameter</span>,
                <span class="r90 r">commandTypeParameter</span>,
                <span class="r91 r">listImportedParameter</span>,
                <span class="r92 r">showCommandInfo</span>);
        }
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="071f73a1e824b1c3" href="../R/071f73a1e824b1c3.html" target="n" data-glyph="76,1" class="i method">GetRestrictedGetFormatData</a>()
        {
            <span class="c">// remote Get-FormatData called by Import/Export-PSSession to get F&amp;O metadata from remote session</span>
 
            <span class="c">// value passed directly from Import-PSSession -FormatTypeName to Get-FormatData -TypeName</span>
            <span class="c">// can&#39;t really restrict beyond basics</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r93 rd" class="r93 r">typeNameParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;TypeName&quot;</span>, <b>typeof</b>(<b>string</b>[]));
            <span class="r93 r">typeNameParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#b590229b4c493ef7" class="t constructor">ValidateLengthAttribute</a>(0, 1000));
            <span class="r93 r">typeNameParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#26b3a4564a8cb309" class="t constructor">ValidateCountAttribute</a>(0, 1000));
 
            <span class="c">// This parameter is required for implicit remoting in PS V5.1.</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r94 rd" class="r94 r">powershellVersionParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;PowerShellVersion&quot;</span>, <b>typeof</b>(<span class="i">Version</span>));
 
            <b>return</b> <a href="#1622ad209de556f7" class="i method">GetRestrictedCmdlet</a>(<span class="s">&quot;Get-FormatData&quot;</span>, <b>null</b>, <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=144303&quot;</span>, <span class="r93 r">typeNameParameter</span>, <span class="r94 r">powershellVersionParameter</span>);
        }
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="c4cbbcd9db3a89a8" href="../R/c4cbbcd9db3a89a8.html" target="n" data-glyph="76,1" class="i method">GetRestrictedGetHelp</a>()
        {
            <span class="c">// remote Get-Help is called when help for implicit remoting proxy tries to fetch help content for a remote command</span>
 
            <span class="c">// This should only be called with 1 &quot;safe&quot; command name (unless ipsn is called with -Force)</span>
            <span class="c">// (it seems ok to disallow getting help for &quot;unsafe&quot; commands [possible when ipsn is called with -Force]</span>
            <span class="c">//  - host can always generate its own proxy for Get-Help if it cares about &quot;unsafe&quot; command names)</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r95 rd" class="r95 r">nameParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;Name&quot;</span>, <b>typeof</b>(<b>string</b>));
            <span class="r95 r">nameParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#33866253d829c106" class="t constructor">ValidatePatternAttribute</a>(<a href="#c90a41934f1cc43e" class="i field">isSafeNameOrIdentifierRegex</a>));
            <span class="r95 r">nameParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#b590229b4c493ef7" class="t constructor">ValidateLengthAttribute</a>(0, 1000));
 
            <span class="c">// This should only be called with 1 valid category</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r96 rd" class="r96 r">categoryParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;Category&quot;</span>, <b>typeof</b>(<b>string</b>[]));
            <span class="r96 r">categoryParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <span class="t">ValidateSetAttribute</span>(<span class="i">Enum</span>.<span class="i">GetNames</span>(<b>typeof</b>(<a href="../help/HelpSystem.cs.html#5ad0a796ad0d8ceb" class="t t">HelpCategory</a>))));
            <span class="r96 r">categoryParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#26b3a4564a8cb309" class="t constructor">ValidateCountAttribute</a>(0, 1));
 
            <b>return</b> <a href="#1622ad209de556f7" class="i method">GetRestrictedCmdlet</a>(<span class="s">&quot;Get-Help&quot;</span>, <b>null</b>, <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=113316&quot;</span>, <span class="r95 r">nameParameter</span>, <span class="r96 r">categoryParameter</span>);
        }
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="8114342787a38819" href="../R/8114342787a38819.html" target="n" data-glyph="76,1" class="i method">GetRestrictedSelectObject</a>()
        {
            <span class="c">// remote Select-Object is called by Import/Export-PSSession to</span>
            <span class="c">// 1) restrict what properties are serialized</span>
            <span class="c">// 2) artificially increase serialization depth of selected properties (especially &quot;Parameters&quot; property)</span>
 
            <span class="c">// only called with a fixed set of values</span>
            <b>string</b>[] <span id="r97 rd" class="r97 r">validPropertyValues</span> = <b>new</b> <b>string</b>[] {
                <span class="s">&quot;ModuleName&quot;</span>, <span class="s">&quot;Namespace&quot;</span>, <span class="s">&quot;OutputType&quot;</span>, <span class="s">&quot;Count&quot;</span>, <span class="s">&quot;HelpUri&quot;</span>,
                <span class="s">&quot;Name&quot;</span>, <span class="s">&quot;CommandType&quot;</span>, <span class="s">&quot;ResolvedCommandName&quot;</span>, <span class="s">&quot;DefaultParameterSet&quot;</span>, <span class="s">&quot;CmdletBinding&quot;</span>, <span class="s">&quot;Parameters&quot;</span> };
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r98 rd" class="r98 r">propertyParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;Property&quot;</span>, <b>typeof</b>(<b>string</b>[]));
            <span class="r98 r">propertyParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <a href="Attributes.cs.html#e156071d7c94ccee" class="t constructor">ValidateSetAttribute</a>(<span class="r97 r">validPropertyValues</span>));
            <span class="r98 r">propertyParameter</span>.<a href="TypeMetadata.cs.html#6e5f6f9087cc2460" class="i property">Attributes</a>.<span class="i">Add</span>(<b>new</b> <span class="t">ValidateCountAttribute</span>(1, <span class="r97 r">validPropertyValues</span>.<span class="i">Length</span>));
 
            <span class="c">// needed for pipeline input if cmdlet binding has to be used (i.e. if Windows 7: #477218 is not fixed)</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r99 rd" class="r99 r">inputParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;InputObject&quot;</span>, <b>typeof</b>(<b>object</b>));
            <span class="r99 r">inputParameter</span>.<a href="TypeMetadata.cs.html#ddcfa30101fb45a0" class="i property">ParameterSets</a>.<span class="i">Add</span>(
                <a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>,
                <b>new</b> <span class="t">ParameterSetMetadata</span>(
                    <b>int</b>.<span class="i">MinValue</span>, <span class="c">// not positional</span>
                    <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>.<a href="TypeMetadata.cs.html#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="TypeMetadata.cs.html#097b158bf63460a7" class="i field">ValueFromPipeline</a> | <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>.<a href="TypeMetadata.cs.html#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="TypeMetadata.cs.html#f307820c98dcae7c" class="i field">Mandatory</a>,
                    <b>null</b>)); <span class="c">// no help message</span>
 
            <b>return</b> <a href="#1622ad209de556f7" class="i method">GetRestrictedCmdlet</a>(<span class="s">&quot;Select-Object&quot;</span>, <b>null</b>, <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096716&quot;</span>, <span class="r98 r">propertyParameter</span>, <span class="r99 r">inputParameter</span>);
        }
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="ac3d82e7052ad85f" href="../R/ac3d82e7052ad85f.html" target="n" data-glyph="76,1" class="i method">GetRestrictedMeasureObject</a>()
        {
            <span class="c">// remote Measure-Object is called by Import/Export-PSSession to measure how many objects</span>
            <span class="c">// it is going to receive and to display a nice progress bar</span>
 
            <span class="c">// needed for pipeline input if cmdlet binding has to be used (i.e. if Windows 7: #477218 is not fixed)</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r100 rd" class="r100 r">inputParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;InputObject&quot;</span>, <b>typeof</b>(<b>object</b>));
            <span class="r100 r">inputParameter</span>.<a href="TypeMetadata.cs.html#ddcfa30101fb45a0" class="i property">ParameterSets</a>.<span class="i">Add</span>(
                <a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>,
                <b>new</b> <span class="t">ParameterSetMetadata</span>(
                    <b>int</b>.<span class="i">MinValue</span>, <span class="c">// not positional</span>
                    <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>.<a href="TypeMetadata.cs.html#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="TypeMetadata.cs.html#097b158bf63460a7" class="i field">ValueFromPipeline</a> | <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>.<a href="TypeMetadata.cs.html#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="TypeMetadata.cs.html#f307820c98dcae7c" class="i field">Mandatory</a>,
                    <b>null</b>)); <span class="c">// no help message</span>
 
            <b>return</b> <a href="#1622ad209de556f7" class="i method">GetRestrictedCmdlet</a>(<span class="s">&quot;Measure-Object&quot;</span>, <b>null</b>, <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=113349&quot;</span>, <span class="r100 r">inputParameter</span>);
        }
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="5d81ee28d71e026e" href="../R/5d81ee28d71e026e.html" target="n" data-glyph="76,1" class="i method">GetRestrictedOutDefault</a>()
        {
            <span class="c">// remote Out-Default is called by interactive remoting (without any parameters, only using pipelines to pass data)</span>
 
            <span class="c">// needed for pipeline input if cmdlet binding has to be used (i.e. if Windows 7: #477218 is not fixed)</span>
            <a href="TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <span id="r101 rd" class="r101 r">inputParameter</span> = <b>new</b> <span class="t">ParameterMetadata</span>(<span class="s">&quot;InputObject&quot;</span>, <b>typeof</b>(<b>object</b>));
            <span class="r101 r">inputParameter</span>.<a href="TypeMetadata.cs.html#ddcfa30101fb45a0" class="i property">ParameterSets</a>.<span class="i">Add</span>(
                <a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>,
                <b>new</b> <span class="t">ParameterSetMetadata</span>(
                    <b>int</b>.<span class="i">MinValue</span>, <span class="c">// not positional</span>
                    <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>.<a href="TypeMetadata.cs.html#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="TypeMetadata.cs.html#097b158bf63460a7" class="i field">ValueFromPipeline</a> | <a href="TypeMetadata.cs.html#3ad07bd1eab767d8" class="t t">ParameterSetMetadata</a>.<a href="TypeMetadata.cs.html#6a4c3e1acdb95960" class="t t">ParameterFlags</a>.<a href="TypeMetadata.cs.html#f307820c98dcae7c" class="i field">Mandatory</a>,
                    <b>null</b>)); <span class="c">// no help message</span>
 
            <b>return</b> <a href="#1622ad209de556f7" class="i method">GetRestrictedCmdlet</a>(<span class="s">&quot;Out-Default&quot;</span>, <b>null</b>, <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=113362&quot;</span>, <span class="r101 r">inputParameter</span>);
        }
 
        <b>private static</b> <a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="950722cb95a72729" href="../R/950722cb95a72729.html" target="n" data-glyph="76,1" class="i method">GetRestrictedExitPSSession</a>()
        {
            <span class="c">// remote Exit-PSSession is not called by PowerShell, but is needed so that users</span>
            <span class="c">// can exit an interactive remoting session</span>
 
            <b>return</b> <a href="#1622ad209de556f7" class="i method">GetRestrictedCmdlet</a>(<span class="s">&quot;Exit-PSSession&quot;</span>, <b>null</b>, <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096787&quot;</span>); <span class="c">// no parameters are used</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a dictionary from a command name to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#543f906b9137ce10" class="t t">CommandMetadata</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> describing</span>
        <span class="c">///</span><span class="c"> how that command can be restricted to limit attack surface while still being usable</span>
        <span class="c">///</span><span class="c"> by features included in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">sessionCapabilities</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For example the implicit remoting feature</span>
        <span class="c">///</span><span class="c"> (included in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#bb52d235a01f7719" class="t t">SessionCapabilities</a>.<a href="#b2234cfd6d5d5d27" class="i field">RemoteServer</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">)</span>
        <span class="c">///</span><span class="c"> doesn&#39;t use all parameters of Get-Help</span>
        <span class="c">///</span><span class="c"> and uses only a limited set of argument values for the parameters it does use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#543f906b9137ce10" class="t t">CommandMetadata</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> can be passed to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ProxyCommand.cs.html#d53207f43e14c0fe" class="t t">ProxyCommand</a>.<a href="ProxyCommand.cs.html#2b588fde3998711d" class="i method">Create</a>(<a href="#543f906b9137ce10" class="t t">CommandMetadata</a>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> method to generate</span>
        <span class="c">///</span><span class="c"> a body of a proxy function that forwards calls to the actual cmdlet, while exposing only the parameters</span>
        <span class="c">///</span><span class="c"> listed in </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#543f906b9137ce10" class="t t">CommandMetadata</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.  Exposing only the restricted proxy function while making</span>
        <span class="c">///</span><span class="c"> the actual cmdlet and its aliases private can help in reducing attack surface of the remoting server.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>.<a href="InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="InitialSessionState.cs.html#307c0a1bbe64082c" class="i method">CreateRestricted</a>(<a href="#bb52d235a01f7719" class="t t">SessionCapabilities</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
        <b>public static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt; <a id="4424bbe0e916cad7" href="../R/4424bbe0e916cad7.html" target="n" data-glyph="72,1" class="i method">GetRestrictedCommands</a>(<a href="#bb52d235a01f7719" class="t t">SessionCapabilities</a> <span id="r102 rd" class="r102 r">sessionCapabilities</span>)
        {
            <span class="i">List</span>&lt;<a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt; <span id="r103 rd" class="r103 r">restrictedCommands</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt;();
 
            <span class="c">// all remoting cmdlets need to be included for workflow scenarios as wel</span>
            <b>if</b> ((<span class="r102 r">sessionCapabilities</span> &amp; <a href="#bb52d235a01f7719" class="t t">SessionCapabilities</a>.<a href="#b2234cfd6d5d5d27" class="i field">RemoteServer</a>) == <a href="#bb52d235a01f7719" class="t t">SessionCapabilities</a>.<a href="#b2234cfd6d5d5d27" class="i field">RemoteServer</a>)
            {
                <span class="r103 r">restrictedCommands</span>.<span class="i">AddRange</span>(<a href="#1a67a0cf053642a7" class="i method">GetRestrictedRemotingCommands</a>());
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt; <span id="r104 rd" class="r104 r">result</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<a href="#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r105 rd" class="r105 r">restrictedCommand</span> <b>in</b> <span class="r103 r">restrictedCommands</span>)
            {
                <span class="r104 r">result</span>.<span class="i">Add</span>(<span class="r105 r">restrictedCommand</span>.<a href="#8d0d4ac251b21d59" class="i property">Name</a>, <span class="r105 r">restrictedCommand</span>);
            }
 
            <b>return</b> <span class="r104 r">result</span>;
        }
 
        <b>private static</b> <span class="i">Collection</span>&lt;<a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt; <a id="1a67a0cf053642a7" href="../R/1a67a0cf053642a7.html" target="n" data-glyph="76,1" class="i method">GetRestrictedRemotingCommands</a>()
        {
            <span class="i">Collection</span>&lt;<a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt; <span id="r106 rd" class="r106 r">remotingCommands</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt;
                                                           {
                                                               <a href="#5d8caf95acb08d4b" class="i method">GetRestrictedGetCommand</a>(),
                                                               <a href="#071f73a1e824b1c3" class="i method">GetRestrictedGetFormatData</a>(),
                                                               <a href="#8114342787a38819" class="i method">GetRestrictedSelectObject</a>(),
                                                               <a href="#c4cbbcd9db3a89a8" class="i method">GetRestrictedGetHelp</a>(),
                                                               <a href="#ac3d82e7052ad85f" class="i method">GetRestrictedMeasureObject</a>(),
                                                               <a href="#950722cb95a72729" class="i method">GetRestrictedExitPSSession</a>(),
                                                               <a href="#5d81ee28d71e026e" class="i method">GetRestrictedOutDefault</a>()
                                                           };
 
            <b>return</b> <span class="r106 r">remotingCommands</span>;
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span>    <span class="c">// Not referenced on CSS</span>
<span class="e">        private static Collection&lt;CommandMetadata&gt; GetRestrictedJobCommands()
        {
            // all the job cmdlets take a Name parameter. This needs to be
            // restricted to safenames in order to allow only valid wildcards
 
            // construct the parameterset metadata
            ParameterSetMetadata nameParameterSet = new ParameterSetMetadata(0,
                                                                             ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                             string.Empty);
            ParameterSetMetadata instanceIdParameterSet = new ParameterSetMetadata(0,
                                                                                   ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                                   string.Empty);
            ParameterSetMetadata idParameterSet = new ParameterSetMetadata(0,
                                                                           ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                           string.Empty);
            ParameterSetMetadata stateParameterSet = new ParameterSetMetadata(int.MinValue,
                                                                              ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                              string.Empty);
            ParameterSetMetadata commandParameterSet = new ParameterSetMetadata(int.MinValue,
                                                                                ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                                string.Empty);
            ParameterSetMetadata filterParameterSet = new ParameterSetMetadata(0,
                                                                                ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                                string.Empty);
            ParameterSetMetadata jobParameterSet = new ParameterSetMetadata(0,
                                                                            ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName |
                                                                            ParameterSetMetadata.ParameterFlags.ValueFromPipeline |
                                                                            ParameterSetMetadata.ParameterFlags.Mandatory, string.Empty);
            ParameterSetMetadata computerNameParameterSet = new ParameterSetMetadata(0,
                                                                                     ParameterSetMetadata.ParameterFlags.Mandatory |
                                                                                     ParameterSetMetadata.ParameterFlags.ValueFromPipeline |
                                                                                     ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                                     string.Empty);
            ParameterSetMetadata locationParameterSet = new ParameterSetMetadata(0,
                                                                                 ParameterSetMetadata.ParameterFlags.Mandatory |
                                                                                 ParameterSetMetadata.ParameterFlags.ValueFromPipeline |
                                                                                 ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                                 string.Empty);
 
            Dictionary&lt;string, ParameterSetMetadata&gt; parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(JobCmdletBase.NameParameterSet, nameParameterSet);
 
            Collection&lt;string&gt; emptyCollection = new Collection&lt;string&gt;();
 
            ParameterMetadata nameParameter = new ParameterMetadata(emptyCollection, false, JobCmdletBase.NameParameter,
                                                                    parameterSets, typeof(string[]));
            nameParameter.Attributes.Add(new ValidatePatternAttribute(isSafeNameOrIdentifierRegex));
            nameParameter.Attributes.Add(new ValidateLengthAttribute(0, 1000));
 
            // all the other parameters can be safely allowed
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(JobCmdletBase.InstanceIdParameterSet, instanceIdParameterSet);
            ParameterMetadata instanceIdParameter = new ParameterMetadata(emptyCollection, false,
                                                                          JobCmdletBase.InstanceIdParameter,
                                                                          parameterSets, typeof(Guid[]));
            instanceIdParameter.Attributes.Add(new ValidateNotNullOrEmptyAttribute());
 
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(JobCmdletBase.SessionIdParameterSet, idParameterSet);
            ParameterMetadata idParameter = new ParameterMetadata(emptyCollection, false, &quot;Id&quot;, parameterSets, typeof(int[]));
            idParameter.Attributes.Add(new ValidateNotNullOrEmptyAttribute());
 
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(JobCmdletBase.StateParameterSet, stateParameterSet);
            ParameterMetadata stateParameter = new ParameterMetadata(emptyCollection, false,
                                                                     JobCmdletBase.StateParameter, parameterSets,
                                                                     typeof(JobState));
 
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(JobCmdletBase.CommandParameterSet, commandParameterSet);
            ParameterMetadata commandParameter = new ParameterMetadata(emptyCollection, false,
                                                                       JobCmdletBase.CommandParameter, parameterSets,
                                                                       typeof(string[]));
 
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(JobCmdletBase.FilterParameterSet, filterParameterSet);
            ParameterMetadata filterParameter = new ParameterMetadata(emptyCollection, false, JobCmdletBase.FilterParameter, parameterSets, typeof(Hashtable));
 
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(JobCmdletBase.JobParameter, jobParameterSet);
            ParameterMetadata jobParameter = new ParameterMetadata(emptyCollection, false, JobCmdletBase.JobParameter,
                                                                   parameterSets, typeof(Job[]));
            jobParameter.Attributes.Add(new ValidateNotNullOrEmptyAttribute());
 
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            parameterSets.Add(&quot;ComputerName&quot;, computerNameParameterSet);
            parameterSets.Add(&quot;Location&quot;, locationParameterSet);
            ParameterMetadata jobParameter2 = new ParameterMetadata(emptyCollection, false, JobCmdletBase.JobParameter,
                                                                    parameterSets, typeof(Job[]));
 
            // Start-Job is not really required since the user will be using the name
            // of the workflow to launch them
            Collection&lt;CommandMetadata&gt; restrictedJobCommands = new Collection&lt;CommandMetadata&gt;();
 
            // Stop-Job cmdlet
            ParameterMetadata passThruParameter = new ParameterMetadata(&quot;PassThru&quot;, typeof(SwitchParameter));
            ParameterMetadata anyParameter = new ParameterMetadata(&quot;Any&quot;, typeof(SwitchParameter));
 
            CommandMetadata stopJob = GetRestrictedCmdlet(&quot;Stop-Job&quot;, JobCmdletBase.SessionIdParameterSet, &quot;https://go.microsoft.com/fwlink/?LinkID=2096795&quot;, nameParameter,
                                                          instanceIdParameter, idParameter,
                                                          stateParameter, filterParameter, jobParameter, passThruParameter);
            restrictedJobCommands.Add(stopJob);
 
            // Wait-Job cmdlet
            ParameterMetadata timeoutParameter = new ParameterMetadata(&quot;Timeout&quot;, typeof(int));
            timeoutParameter.Attributes.Add(new ValidateRangeAttribute(-1, Int32.MaxValue));
 
            CommandMetadata waitJob = GetRestrictedCmdlet(&quot;Wait-Job&quot;, JobCmdletBase.SessionIdParameterSet, &quot;https://go.microsoft.com/fwlink/?LinkID=2096902&quot;, nameParameter,
                                                          instanceIdParameter, idParameter,
                                                          jobParameter, stateParameter, filterParameter, anyParameter, timeoutParameter);
            restrictedJobCommands.Add(waitJob);
 
            // Get-Job cmdlet
            CommandMetadata getJob = GetRestrictedCmdlet(&quot;Get-Job&quot;, JobCmdletBase.SessionIdParameterSet, &quot;https://go.microsoft.com/fwlink/?LinkID=113328&quot;, nameParameter,
                                                         instanceIdParameter, idParameter,
                                                         stateParameter, filterParameter, commandParameter);
            restrictedJobCommands.Add(getJob);
 
            // Receive-Job cmdlet
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            computerNameParameterSet = new ParameterSetMetadata(1,
                                                                ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                                string.Empty);
 
            parameterSets.Add(&quot;ComputerName&quot;, computerNameParameterSet);
            ParameterMetadata computerNameParameter = new ParameterMetadata(emptyCollection, false, &quot;ComputerName&quot;, parameterSets, typeof(string[]));
            computerNameParameter.Attributes.Add(new ValidateLengthAttribute(0, 1000));
            computerNameParameter.Attributes.Add(new ValidateNotNullOrEmptyAttribute());
 
            parameterSets = new Dictionary&lt;string, ParameterSetMetadata&gt;();
            locationParameterSet = new ParameterSetMetadata(1,
                                                            ParameterSetMetadata.ParameterFlags.ValueFromPipelineByPropertyName,
                                                            string.Empty);
 
            parameterSets.Add(&quot;Location&quot;, locationParameterSet);
            ParameterMetadata locationParameter = new ParameterMetadata(emptyCollection, false, &quot;Location&quot;, parameterSets, typeof(string[]));
            locationParameter.Attributes.Add(new ValidateLengthAttribute(0, 1000));
            locationParameter.Attributes.Add(new ValidateNotNullOrEmptyAttribute());
 
            ParameterMetadata norecurseParameter = new ParameterMetadata(&quot;NoRecurse&quot;, typeof(SwitchParameter));
            ParameterMetadata keepParameter = new ParameterMetadata(&quot;Keep&quot;, typeof(SwitchParameter));
            ParameterMetadata waitParameter = new ParameterMetadata(&quot;Wait&quot;, typeof(SwitchParameter));
            ParameterMetadata writeEventsParameter = new ParameterMetadata(&quot;WriteEvents&quot;, typeof(SwitchParameter));
            ParameterMetadata writeJobParameter = new ParameterMetadata(&quot;WriteJobInResults&quot;, typeof(SwitchParameter));
            ParameterMetadata autoRemoveParameter = new ParameterMetadata(&quot;AutoRemoveJob&quot;, typeof(SwitchParameter));
 
            CommandMetadata receiveJob = GetRestrictedCmdlet(&quot;Receive-Job&quot;, &quot;Location&quot;, &quot;https://go.microsoft.com/fwlink/?LinkID=2096965&quot;, nameParameter,
                                                             instanceIdParameter,
                                                             idParameter, stateParameter, jobParameter2,
                                                             computerNameParameter, locationParameter,
                                                             norecurseParameter, keepParameter, waitParameter,
                                                             writeEventsParameter, writeJobParameter, autoRemoveParameter);
            restrictedJobCommands.Add(receiveJob);
 
            // Remove-Job cmdlet
            ParameterMetadata forceParameter = new ParameterMetadata(&quot;Force&quot;, typeof(SwitchParameter));
 
            CommandMetadata removeJob = GetRestrictedCmdlet(&quot;Remove-Job&quot;, JobCmdletBase.SessionIdParameterSet, &quot;https://go.microsoft.com/fwlink/?LinkID=2096868&quot;,
                                                            nameParameter, instanceIdParameter,
                                                            idParameter, stateParameter, filterParameter, jobParameter, forceParameter);
 
            restrictedJobCommands.Add(removeJob);
 
            // Suspend-Job cmdlet
            CommandMetadata suspendJob = GetRestrictedCmdlet(&quot;Suspend-Job&quot;, JobCmdletBase.SessionIdParameterSet, &quot;https://go.microsoft.com/fwlink/?LinkID=210613&quot;,
                                                             nameParameter, instanceIdParameter,
                                                             idParameter, stateParameter, filterParameter, jobParameter, passThruParameter);
            restrictedJobCommands.Add(suspendJob);
 
            // Suspend-Job cmdlet
            CommandMetadata resumeJob = GetRestrictedCmdlet(&quot;Resume-Job&quot;, JobCmdletBase.SessionIdParameterSet, &quot;https://go.microsoft.com/fwlink/?LinkID=210611&quot;,
                                                             nameParameter, instanceIdParameter,
                                                             idParameter, stateParameter, filterParameter, jobParameter, passThruParameter);
            restrictedJobCommands.Add(resumeJob);
 
            return restrictedJobCommands;
        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Metadata cache
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command metadata cache. This is separate from the parameterMetadata cache</span>
        <span class="c">///</span><span class="c"> because it is specific to cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>.<span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt; <a id="e9a0c54d536f7ab8" href="../R/e9a0c54d536f7ab8.html" target="n" data-glyph="46,1" class="i field">s_commandMetadataCache</a> =
            <b>new</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>.<span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <a href="#543f906b9137ce10" class="t t">CommandMetadata</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
