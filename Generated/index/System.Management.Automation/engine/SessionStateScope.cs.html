<!DOCTYPE html>
<html><head><title>SessionStateScope.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1988);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/SessionStateScope.cs" target="_top">engine\SessionStateScope.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A SessionStateScope defines the scope of visibility for a set</span>
    <span class="c">///</span><span class="c"> of virtual drives and their data.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="460261155e0163cb" href="../R/460261155e0163cb.html" target="n" data-glyph="2,0" class="t t">SessionStateScope</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for a session state scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">parentScope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parent of this scope.  It can be null for the global scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="5cb50ac1c5ec03b2" href="../R/5cb50ac1c5ec03b2.html" target="n" data-glyph="74,1" class="t constructor">SessionStateScope</a>(<a href="#460261155e0163cb" class="t t">SessionStateScope</a> <span id="r0 rd" class="r0 r">parentScope</span>)
        {
            <a href="#84d072e625b581f5" class="i property">ScopeOrigin</a> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>;
            <a href="#ec04fff24436a018" class="i property">Parent</a> = <span class="r0 r">parentScope</span>;
 
            <b>if</b> (<span class="r0 r">parentScope</span> != <b>null</b>)
            {
                <span class="c">// Now copy the script: scope stack from the parent</span>
                <a href="#b4c1af1db2c52b6a" class="i field">_scriptScope</a> = <span class="r0 r">parentScope</span>.<a href="#3f4dd09980424f44" class="i property">ScriptScope</a>;
            }
            <b>else</b>
            {
                <a href="#b4c1af1db2c52b6a" class="i field">_scriptScope</a> = <a href="#460261155e0163cb" class="k">this</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the parent scope of this scope.  May be null</span>
        <span class="c">///</span><span class="c"> for the global scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#460261155e0163cb" class="t t">SessionStateScope</a> <a id="ec04fff24436a018" href="../R/ec04fff24436a018.html" target="n" data-glyph="104,1" class="i property">Parent</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Defines the origin of the command that resulted in this scope</span>
        <span class="c">///</span><span class="c"> being created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <a id="84d072e625b581f5" href="../R/84d072e625b581f5.html" target="n" data-glyph="104,1" class="i property">ScopeOrigin</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script scope for this scope. It may reference itself but may not</span>
        <span class="c">///</span><span class="c"> be a null reference.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><b>value</b><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null when setting the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#460261155e0163cb" class="t t">SessionStateScope</a> <a id="3f4dd09980424f44" href="../R/3f4dd09980424f44.html" target="n" data-glyph="104,1" class="i property">ScriptScope</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#b4c1af1db2c52b6a" class="i field">_scriptScope</a>;
            }
 
            <b>set</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>value</b> != <b>null</b>, <span class="s">&quot;Caller to verify scope is not null&quot;</span>);
                <a href="#b4c1af1db2c52b6a" class="i field">_scriptScope</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="#460261155e0163cb" class="t t">SessionStateScope</a> <a id="b4c1af1db2c52b6a" href="../R/b4c1af1db2c52b6a.html" target="n" data-glyph="46,1" class="i field">_scriptScope</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The version of strict mode for the interpreter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Which version of strict mode is active for this scope and it&#39;s children.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Version</span> <a id="1a4f72ac80cc8c14" href="../R/1a4f72ac80cc8c14.html" target="n" data-glyph="104,1" class="i property">StrictModeVersion</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Some local variables are stored in this tuple (for non-global scope, any variable assigned to,</span>
        <span class="c">///</span><span class="c"> or parameters, or some predefined locals.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a> <a id="d10101bbc5961e39" href="../R/d10101bbc5961e39.html" target="n" data-glyph="104,1" class="i property">LocalsTuple</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When dotting a script, no new scope is created.  Automatic variables must go somewhere, so rather than store</span>
        <span class="c">///</span><span class="c"> them in the scope they are dotted into, we just store them in a tuple like any other local variable so we</span>
        <span class="c">///</span><span class="c"> can skip saving and restoring them as the scopes change, instead it&#39;s a simple push/pop of this stack.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This works because in a dotted script block, the only locals in the tuple are the automatic variables, all</span>
        <span class="c">///</span><span class="c"> other variables use the variable apis to find the variable and get/set it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Stack</span>&lt;<a href="runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>&gt; <a id="240090c569665c17" href="../R/240090c569665c17.html" target="n" data-glyph="104,1" class="i property">DottedScopes</a> { <b>get</b> { <b>return</b> <a href="#7c0785dd3b82b6e8" class="i field">_dottedScopes</a>; } }
 
        <b>private readonly</b> <span class="i">Stack</span>&lt;<a href="runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>&gt; <a id="7c0785dd3b82b6e8" href="../R/7c0785dd3b82b6e8.html" target="n" data-glyph="46,1" class="i field">_dottedScopes</a> = <b>new</b> <span class="i">Stack</span>&lt;<a href="runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Drives
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a new drive to the scope&#39;s drive collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">newDrive</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new drive to be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method assumes the drive has already been verified and</span>
        <span class="c">///</span><span class="c"> the provider has already been notified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">newDrive</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a drive of the same name already exists in this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="be5f4ca8939b8bec" href="../R/be5f4ca8939b8bec.html" target="n" data-glyph="74,1" class="i method">NewDrive</a>(<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r1 rd" class="r1 r">newDrive</span>)
        {
            <b>if</b> (<span class="r1 r">newDrive</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1 r">newDrive</span>));
            }
 
            <span class="c">// Ensure that multiple threads do not try to modify the</span>
            <span class="c">// drive data at the same time.</span>
 
            <b>var</b> <span id="r2 rd" class="r2 r">driveInfos</span> = <a href="#7ad0d1785167384f" class="i method">GetDrives</a>();
            <b>if</b> (<span class="r2 r">driveInfos</span>.<span class="i">ContainsKey</span>(<span class="r1 r">newDrive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>))
            {
                <a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a> <span id="r3 rd" class="r3 r">e</span> =
                    <b>new</b> <span class="t">SessionStateException</span>(
                        <span class="r1 r">newDrive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>,
                        <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#ed7df391c110e1a2" class="i field">Drive</a>,
                        <span class="s">&quot;DriveAlreadyExists&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">DriveAlreadyExists</span>,
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#22cb3b8b80f740be" class="i field">ResourceExists</a>);
 
                <b>throw</b> <span class="r3 r">e</span>;
            }
 
            <b>if</b> (!<span class="r1 r">newDrive</span>.<a href="DataStoreAdapter.cs.html#84a02b38509aa94e" class="i property">IsAutoMounted</a>)
            {
                <span class="r2 r">driveInfos</span>.<span class="i">Add</span>(<span class="r1 r">newDrive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>, <span class="r1 r">newDrive</span>);
            }
            <b>else</b>
            {
                <b>var</b> <span id="r4 rd" class="r4 r">automountedDrives</span> = <a href="#04f8ccfacbc359da" class="i method">GetAutomountedDrives</a>();
                <b>if</b> (!<span class="r4 r">automountedDrives</span>.<span class="i">ContainsKey</span>(<span class="r1 r">newDrive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>))
                {
                    <span class="r4 r">automountedDrives</span>.<span class="i">Add</span>(<span class="r1 r">newDrive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>, <span class="r1 r">newDrive</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the specified drive from this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">drive</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The drive to be removed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method assumes that the drive has already been validated for removal</span>
        <span class="c">///</span><span class="c"> by the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">drive</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="235e4996b87173bd" href="../R/235e4996b87173bd.html" target="n" data-glyph="74,1" class="i method">RemoveDrive</a>(<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r5 rd" class="r5 r">drive</span>)
        {
            <b>if</b> (<span class="r5 r">drive</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r5 r">drive</span>));
            }
 
            <b>if</b> (<a href="#9f5d9664ad1cc50a" class="i field">_drives</a> == <b>null</b>)
                <b>return</b>;
 
            <b>var</b> <span id="r6 rd" class="r6 r">driveInfos</span> = <a href="#7ad0d1785167384f" class="i method">GetDrives</a>();
            <b>if</b> (!<span class="r6 r">driveInfos</span>.<span class="i">Remove</span>(<span class="r5 r">drive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>))
            {
                <span class="c">// Check to see if it is in the automounted drive collection.</span>
                <b>var</b> <span id="r7 rd" class="r7 r">automountedDrives</span> = <a href="#04f8ccfacbc359da" class="i method">GetAutomountedDrives</a>();
                <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r8 rd" class="r8 r">automountedDrive</span>;
                <b>if</b> (<span class="r7 r">automountedDrives</span>.<span class="i">TryGetValue</span>(<span class="r5 r">drive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>, <b>out</b> <span class="r8 r">automountedDrive</span>))
                {
                    <span class="r8 r">automountedDrive</span>.<a href="DataStoreAdapter.cs.html#825bb79433ccd511" class="i property">IsAutoMountedManuallyRemoved</a> = <b>true</b>;
 
                    <span class="c">// Remove ths persisted from the list of automounted drives.</span>
                    <b>if</b> (<span class="r5 r">drive</span>.<a href="DataStoreAdapter.cs.html#c50685ff8ad27035" class="i property">IsNetworkDrive</a>)
                    {
                        <span class="r7 r">automountedDrives</span>.<span class="i">Remove</span>(<span class="r5 r">drive</span>.<a href="DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes all the drives from the scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="2adeb6f3f2abac76" href="../R/2adeb6f3f2abac76.html" target="n" data-glyph="74,1" class="i method">RemoveAllDrives</a>()
        {
            <a href="#7ad0d1785167384f" class="i method">GetDrives</a>().<span class="i">Clear</span>();
            <a href="#04f8ccfacbc359da" class="i method">GetAutomountedDrives</a>().<span class="i">Clear</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the drive of the specified name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the drive to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a PSDriveInfo object with the specified name if one</span>
        <span class="c">///</span><span class="c"> exists in this scope or null if one does not exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <a id="60d8a02344b18642" href="../R/60d8a02344b18642.html" target="n" data-glyph="74,1" class="i method">GetDrive</a>(<b>string</b> <span id="r9 rd" class="r9 r">name</span>)
        {
            <b>if</b> (<span class="r9 r">name</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r9 r">name</span>));
            }
 
            <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r10 rd" class="r10 r">result</span> = <b>null</b>;
 
            <b>var</b> <span id="r11 rd" class="r11 r">driveInfos</span> = <a href="#7ad0d1785167384f" class="i method">GetDrives</a>();
            <b>if</b> (!<span class="r11 r">driveInfos</span>.<span class="i">TryGetValue</span>(<span class="r9 r">name</span>, <b>out</b> <span class="r10 r">result</span>))
            {
                <span class="c">// The caller needs to determine what to do with</span>
                <span class="c">// manually removed drives.</span>
                <a href="#04f8ccfacbc359da" class="i method">GetAutomountedDrives</a>().<span class="i">TryGetValue</span>(<span class="r9 r">name</span>, <b>out</b> <span class="r10 r">result</span>);
            }
 
            <b>return</b> <span class="r10 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an IEnumerable for the drives in this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="620dfb81e7623e3f" href="../R/620dfb81e7623e3f.html" target="n" data-glyph="104,1" class="i property">Drives</a>
        {
            <b>get</b>
            {
                <span class="i">Collection</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <span id="r12 rd" class="r12 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt;();
                <b>foreach</b> (<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r13 rd" class="r13 r">drive</span> <b>in</b> <a href="#7ad0d1785167384f" class="i method">GetDrives</a>().<span class="i">Values</span>)
                {
                    <span class="r12 r">result</span>.<span class="i">Add</span>(<span class="r13 r">drive</span>);
                }
 
                <span class="c">// Now add automounted drives that have not been manually</span>
                <span class="c">// removed by the user.</span>
 
                <b>foreach</b> (<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r14 rd" class="r14 r">drive</span> <b>in</b> <a href="#04f8ccfacbc359da" class="i method">GetAutomountedDrives</a>().<span class="i">Values</span>)
                {
                    <b>if</b> (!<span class="r14 r">drive</span>.<a href="DataStoreAdapter.cs.html#825bb79433ccd511" class="i property">IsAutoMountedManuallyRemoved</a>)
                    {
                        <span class="r12 r">result</span>.<span class="i">Add</span>(<span class="r14 r">drive</span>);
                    }
                }
 
                <b>return</b> <span class="r12 r">result</span>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Drives
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Variables
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an IDictionary for the variables in this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IDictionary</span>&lt;<b>string</b>, <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>&gt; <a id="f3f7c22a2d29d233" href="../R/f3f7c22a2d29d233.html" target="n" data-glyph="104,1" class="i property">Variables</a> { <b>get</b> { <b>return</b> <a href="#107e48bde2f8f86e" class="i method">GetPrivateVariables</a>(); } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the specified variable from the variable table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the command trying to retrieve this variable...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSVariable representing the variable specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <a id="a1f277d1ce96506f" href="../R/a1f277d1ce96506f.html" target="n" data-glyph="74,1" class="i method">GetVariable</a>(<b>string</b> <span id="r15 rd" class="r15 r">name</span>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r16 rd" class="r16 r">origin</span>)
        {
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r17 rd" class="r17 r">result</span>;
            <a href="#2cdab37595af6c96" class="i method">TryGetVariable</a>(<span class="r15 r">name</span>, <span class="r16 r">origin</span>, <b>false</b>, <b>out</b> <span class="r17 r">result</span>);
            <b>return</b> <span class="r17 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the specified variable from the variable table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSVariable representing the variable specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <a id="300228748927425f" href="../R/300228748927425f.html" target="n" data-glyph="74,1" class="i method">GetVariable</a>(<b>string</b> <span id="r18 rd" class="r18 r">name</span>)
        {
            <b>return</b> <a href="#a1f277d1ce96506f" class="i method">GetVariable</a>(<span class="r18 r">name</span>, <a href="#84d072e625b581f5" class="i property">ScopeOrigin</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Looks up a variable, returns true and the variable if found and is visible, throws if the found variable is not visible,</span>
        <span class="c">///</span><span class="c"> and returns false if there is no variable with the given name in the current scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The command origin (where the scope was created), used to decide if the variable is visible.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">fromNewOrSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if looking up the variable as part of a new or set variable operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">variable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable, if one is found in scope.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Thrown if the variable is not visible based on CommandOrigin.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if there is a variable in scope, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="2cdab37595af6c96" href="../R/2cdab37595af6c96.html" target="n" data-glyph="74,1" class="i method">TryGetVariable</a>(<b>string</b> <span id="r19 rd" class="r19 r">name</span>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r20 rd" class="r20 r">origin</span>, <b>bool</b> <span id="r21 rd" class="r21 r">fromNewOrSet</span>, <b>out</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r22 rd" class="r22 r">variable</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r19 r">name</span> != <b>null</b>, <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <b>if</b> (<a href="#47c71bddd693c07b" class="i method">TryGetLocalVariableFromTuple</a>(<span class="r19 r">name</span>, <span class="r21 r">fromNewOrSet</span>, <b>out</b> <span class="r22 r">variable</span>))
            {
                <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#f73a87d524011168" class="i method">ThrowIfNotVisible</a>(<span class="r20 r">origin</span>, <span class="r22 r">variable</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#107e48bde2f8f86e" class="i method">GetPrivateVariables</a>().<span class="i">TryGetValue</span>(<span class="r19 r">name</span>, <b>out</b> <span class="r22 r">variable</span>))
            {
                <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#f73a87d524011168" class="i method">ThrowIfNotVisible</a>(<span class="r20 r">origin</span>, <span class="r22 r">variable</span>);
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">variable</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="2dff503775afc808" href="../R/2dff503775afc808.html" target="n" data-glyph="74,1" class="i method">GetAutomaticVariableValue</a>(<a href="SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a> <span id="r23 rd" class="r23 r">variable</span>)
        {
            <b>int</b> <span id="r24 rd" class="r24 r">index</span> = (<b>int</b>)<span class="r23 r">variable</span>;
            <b>foreach</b> (<b>var</b> <span id="r25 rd" class="r25 r">dottedScope</span> <b>in</b> <a href="#7c0785dd3b82b6e8" class="i field">_dottedScopes</a>)
            {
                <b>if</b> (<span class="r25 r">dottedScope</span>.<span class="i">IsValueSet</span>(<span class="r24 r">index</span>))
                {
                    <b>return</b> <span class="r25 r">dottedScope</span>.<span class="i">GetValue</span>(<span class="r24 r">index</span>);
                }
            }
 
            <span class="c">// LocalsTuple should not be null, but the test infrastructure creates scopes</span>
            <span class="c">// and doesn&#39;t set LocalsTuple</span>
            <b>if</b> (<a href="#d10101bbc5961e39" class="i property">LocalsTuple</a> != <b>null</b> &amp;&amp; <a href="#d10101bbc5961e39" class="i property">LocalsTuple</a>.<a href="runtime/MutableTuple.cs.html#35dd8174a8c19817" class="i method">IsValueSet</a>(<span class="r24 r">index</span>))
            {
                <b>return</b> <a href="#d10101bbc5961e39" class="i property">LocalsTuple</a>.<a href="runtime/MutableTuple.cs.html#cc32e7a36d6c27bd" class="i method">GetValue</a>(<span class="r24 r">index</span>);
            }
 
            <b>return</b> <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable to the given value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value for the variable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">asValue</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, sets the variable value to newValue. If false, newValue must</span>
        <span class="c">///</span><span class="c"> be a PSVariable object and the item will be set rather than the value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the variable will be set even if it is readonly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">sessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Which SessionState this variable belongs to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the caller</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">fastPath</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true and the variable is being set in the global scope,</span>
        <span class="c">///</span><span class="c"> then all of the normal variable lookup stuff is bypassed and</span>
        <span class="c">///</span><span class="c"> the variable is added directly to the dictionary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSVariable representing the variable that was set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the variable is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <a id="82151a5a9031dac4" href="../R/82151a5a9031dac4.html" target="n" data-glyph="74,1" class="i method">SetVariable</a>(<b>string</b> <span id="r26 rd" class="r26 r">name</span>, <b>object</b> <span id="r27 rd" class="r27 r">value</span>, <b>bool</b> <span id="r28 rd" class="r28 r">asValue</span>, <b>bool</b> <span id="r29 rd" class="r29 r">force</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r30 rd" class="r30 r">sessionState</span>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r31 rd" class="r31 r">origin</span> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>, <b>bool</b> <span id="r32 rd" class="r32 r">fastPath</span> = <b>false</b>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r26 r">name</span> != <b>null</b>, <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r33 rd" class="r33 r">variable</span>;
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r34 rd" class="r34 r">variableToSet</span> = <span class="r27 r">value</span> <b>as</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>;
 
            <span class="c">// Set the variable directly in the table, bypassing all of the checks. This</span>
            <span class="c">// can only be used for global scope otherwise the slow path is used.</span>
            <b>if</b> (<span class="r32 r">fastPath</span>)
            {
                <b>if</b> (<a href="#ec04fff24436a018" class="i property">Parent</a> != <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;fastPath&quot;</span>);
                }
 
                <span class="r33 r">variable</span> = <b>new</b> <a href="ShellVariable.cs.html#3ac543e1434ca630" class="t constructor">PSVariable</a>(<span class="r26 r">name</span>, <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a>, <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#388974547ffee0d7" class="i property">Options</a>, <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#5a5702c328974ec4" class="i property">Attributes</a>) { <a href="ShellVariable.cs.html#5f551c3a69d87108" class="i property">Description</a> = <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#5f551c3a69d87108" class="i property">Description</a> };
                <a href="#107e48bde2f8f86e" class="i method">GetPrivateVariables</a>()[<span class="r26 r">name</span>] = <span class="r33 r">variable</span>;
                <b>return</b> <span class="r33 r">variable</span>;
            }
 
            <b>bool</b> <span id="r35 rd" class="r35 r">varExists</span> = <a href="#2cdab37595af6c96" class="i method">TryGetVariable</a>(<span class="r26 r">name</span>, <span class="r31 r">origin</span>, <b>true</b>, <b>out</b> <span class="r33 r">variable</span>);
 
            <span class="c">// Initialize the private variable dictionary if it&#39;s not yet</span>
            <b>if</b> (<a href="#faf742d1998e47c2" class="i field">_variables</a> == <b>null</b>) { <a href="#107e48bde2f8f86e" class="i method">GetPrivateVariables</a>(); }
 
            <b>if</b> (!<span class="r28 r">asValue</span> &amp;&amp; <span class="r34 r">variableToSet</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r35 r">varExists</span>)
                {
                    <span class="c">// First check the variable to ensure that it</span>
                    <span class="c">// is not constant or readonly</span>
 
                    <b>if</b> (<span class="r33 r">variable</span> == <b>null</b> || <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#fbdeffd557748144" class="i property">IsConstant</a> || (!<span class="r29 r">force</span> &amp;&amp; <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#8f7f1fc361d7e5b9" class="i property">IsReadOnly</a>))
                    {
                        <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r36 rd" class="r36 r">e</span> =
                            <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                    <span class="r26 r">name</span>,
                                    <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#2c22962ab516ef3f" class="i field">Variable</a>,
                                    <span class="s">&quot;VariableNotWritable&quot;</span>,
                                    <span class="i">SessionStateStrings</span>.<span class="i">VariableNotWritable</span>);
 
                        <b>throw</b> <span class="r36 r">e</span>;
                    }
 
                    <b>if</b> (<span class="r33 r">variable</span> <b>is</b> <a href="ShellVariable.cs.html#548f55a3498e1b7b" class="t t">LocalVariable</a>
                        &amp;&amp; (<span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#5a5702c328974ec4" class="i property">Attributes</a>.<span class="i">Count</span> &gt; 0 || <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#388974547ffee0d7" class="i property">Options</a> != <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#388974547ffee0d7" class="i property">Options</a>))
                    {
                        <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r37 rd" class="r37 r">e</span> =
                            <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                    <span class="r26 r">name</span>,
                                    <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#2c22962ab516ef3f" class="i field">Variable</a>,
                                    <span class="s">&quot;VariableNotWritableRare&quot;</span>,
                                    <span class="i">SessionStateStrings</span>.<span class="i">VariableNotWritableRare</span>);
 
                        <b>throw</b> <span class="r37 r">e</span>;
                    }
 
                    <b>if</b> (<span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#8f7f1fc361d7e5b9" class="i property">IsReadOnly</a> &amp;&amp; <span class="r29 r">force</span>)
                    {
                        <a href="#faf742d1998e47c2" class="i field">_variables</a>.<span class="i">Remove</span>(<span class="r26 r">name</span>);
                        <span class="r35 r">varExists</span> = <b>false</b>;
                        <span class="r33 r">variable</span> = <b>new</b> <a href="ShellVariable.cs.html#3ac543e1434ca630" class="t constructor">PSVariable</a>(<span class="r26 r">name</span>, <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a>, <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#388974547ffee0d7" class="i property">Options</a>, <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#5a5702c328974ec4" class="i property">Attributes</a>) { <a href="ShellVariable.cs.html#5f551c3a69d87108" class="i property">Description</a> = <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#5f551c3a69d87108" class="i property">Description</a> };
                    }
                    <b>else</b>
                    {
                        <span class="c">// Since the variable already exists, copy</span>
                        <span class="c">// the value, options, description, and attributes</span>
                        <span class="c">// to it.</span>
                        <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#5a5702c328974ec4" class="i property">Attributes</a>.<span class="i">Clear</span>();
 
                        <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a> = <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a>;
                        <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#388974547ffee0d7" class="i property">Options</a> = <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#388974547ffee0d7" class="i property">Options</a>;
                        <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#5f551c3a69d87108" class="i property">Description</a> = <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#5f551c3a69d87108" class="i property">Description</a>;
 
                        <b>foreach</b> (<span class="i">Attribute</span> <span id="r38 rd" class="r38 r">attr</span> <b>in</b> <span class="r34 r">variableToSet</span>.<a href="ShellVariable.cs.html#5a5702c328974ec4" class="i property">Attributes</a>)
                        {
                            <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#5a5702c328974ec4" class="i property">Attributes</a>.<span class="i">Add</span>(<span class="r38 r">attr</span>);
                        }
                    }
                }
                <b>else</b>
                {
                    <span class="c">// Since the variable doesn&#39;t exist, use the new Variable</span>
                    <span class="c">// object</span>
 
                    <span class="r33 r">variable</span> = <span class="r34 r">variableToSet</span>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r33 r">variable</span> != <b>null</b>)
            {
                <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a> = <span class="r27 r">value</span>;
            }
            <b>else</b>
            {
                <span class="r33 r">variable</span> = (<a href="#d10101bbc5961e39" class="i property">LocalsTuple</a>?.<a href="runtime/MutableTuple.cs.html#e633babb79befd2b" class="i method">TrySetVariable</a>(<span class="r26 r">name</span>, <span class="r27 r">value</span>)) ?? <b>new</b> <a href="ShellVariable.cs.html#dc6637f308192bb1" class="t constructor">PSVariable</a>(<span class="r26 r">name</span>, <span class="r27 r">value</span>);
            }
 
            <b>if</b> (<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="ExecutionContext.cs.html#f3a9373a4fcbee98" class="i property">HasEverUsedConstrainedLanguage</a>)
            {
                <a href="#020a626e18041eab" class="i method">CheckVariableChangeInConstrainedLanguage</a>(<span class="r33 r">variable</span>);
            }
 
            <a href="#faf742d1998e47c2" class="i field">_variables</a>[<span class="r26 r">name</span>] = <span class="r33 r">variable</span>;
            <span class="r33 r">variable</span>.<a href="ShellVariable.cs.html#7c0f65f1c842288b" class="i property">SessionState</a> = <span class="r30 r">sessionState</span>;
            <b>return</b> <span class="r33 r">variable</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable to scope without any checks.</span>
        <span class="c">///</span><span class="c"> This is intended to be used only for global scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">variableToSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSVariable to set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">sessionState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">SessionState for variable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="0c0ff36eb0f81bf6" href="../R/0c0ff36eb0f81bf6.html" target="n" data-glyph="74,1" class="i method">SetVariableForce</a>(<a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r39 rd" class="r39 r">variableToSet</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r40 rd" class="r40 r">sessionState</span>)
        {
            <b>if</b> (<a href="#ec04fff24436a018" class="i property">Parent</a> != <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>(<span class="s">&quot;SetVariableForce&quot;</span>);
            }
 
            <span class="r39 r">variableToSet</span>.<a href="ShellVariable.cs.html#7c0f65f1c842288b" class="i property">SessionState</a> = <span class="r40 r">sessionState</span>;
            <a href="#107e48bde2f8f86e" class="i method">GetPrivateVariables</a>()[<span class="r39 r">variableToSet</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>] = <span class="r39 r">variableToSet</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable to the given value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">newVariable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new variable to create.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the variable will be set even if it is readonly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">sessionState</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Which SessionState this variable belongs to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSVariable representing the variable that was set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the variable is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <a id="611f1e7f24ec3360" href="../R/611f1e7f24ec3360.html" target="n" data-glyph="74,1" class="i method">NewVariable</a>(<a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r41 rd" class="r41 r">newVariable</span>, <b>bool</b> <span id="r42 rd" class="r42 r">force</span>, <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r43 rd" class="r43 r">sessionState</span>)
        {
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r44 rd" class="r44 r">variable</span>;
            <b>bool</b> <span id="r45 rd" class="r45 r">varExists</span> = <a href="#2cdab37595af6c96" class="i method">TryGetVariable</a>(<span class="r41 r">newVariable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <a href="#84d072e625b581f5" class="i property">ScopeOrigin</a>, <b>true</b>, <b>out</b> <span class="r44 r">variable</span>);
 
            <b>if</b> (<span class="r45 r">varExists</span>)
            {
                <span class="c">// First check the variable to ensure that it</span>
                <span class="c">// is not constant or readonly</span>
 
                <b>if</b> (<span class="r44 r">variable</span> == <b>null</b> || <span class="r44 r">variable</span>.<a href="ShellVariable.cs.html#fbdeffd557748144" class="i property">IsConstant</a> || (!<span class="r42 r">force</span> &amp;&amp; <span class="r44 r">variable</span>.<a href="ShellVariable.cs.html#8f7f1fc361d7e5b9" class="i property">IsReadOnly</a>))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r46 rd" class="r46 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r41 r">newVariable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#2c22962ab516ef3f" class="i field">Variable</a>,
                                <span class="s">&quot;VariableNotWritable&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">VariableNotWritable</span>);
 
                    <b>throw</b> <span class="r46 r">e</span>;
                }
 
                <b>if</b> (<span class="r44 r">variable</span> <b>is</b> <a href="ShellVariable.cs.html#548f55a3498e1b7b" class="t t">LocalVariable</a>)
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r47 rd" class="r47 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r41 r">newVariable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#2c22962ab516ef3f" class="i field">Variable</a>,
                                <span class="s">&quot;VariableNotWritableRare&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">VariableNotWritableRare</span>);
 
                    <b>throw</b> <span class="r47 r">e</span>;
                }
 
                <span class="c">// If the new and old variable are the same then don&#39;t bother</span>
                <span class="c">// doing the assignment and marking as &quot;removed&quot;.</span>
                <span class="c">// This can happen when a module variable is imported twice.</span>
                <b>if</b> (!<span class="i">ReferenceEquals</span>(<span class="r41 r">newVariable</span>, <span class="r44 r">variable</span>))
                {
                    <span class="c">// Mark the old variable as removed...</span>
                    <span class="r44 r">variable</span>.<a href="ShellVariable.cs.html#63750c7d6b75ca37" class="i property">WasRemoved</a> = <b>true</b>;
                    <span class="r44 r">variable</span> = <span class="r41 r">newVariable</span>;
                }
            }
            <b>else</b>
            {
                <span class="c">// Since the variable doesn&#39;t exist, use the new Variable</span>
                <span class="c">// object</span>
 
                <span class="r44 r">variable</span> = <span class="r41 r">newVariable</span>;
            }
 
            <b>if</b> (<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="ExecutionContext.cs.html#f3a9373a4fcbee98" class="i property">HasEverUsedConstrainedLanguage</a>)
            {
                <a href="#020a626e18041eab" class="i method">CheckVariableChangeInConstrainedLanguage</a>(<span class="r44 r">variable</span>);
            }
 
            <a href="#faf742d1998e47c2" class="i field">_variables</a>[<span class="r44 r">variable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>] = <span class="r44 r">variable</span>;
            <span class="r44 r">variable</span>.<a href="ShellVariable.cs.html#7c0f65f1c842288b" class="i property">SessionState</a> = <span class="r43 r">sessionState</span>;
            <b>return</b> <span class="r44 r">variable</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a variable from the variable table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the variable to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the variable will be removed even if its ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the variable is constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c99bbeeceef299fa" href="../R/c99bbeeceef299fa.html" target="n" data-glyph="74,1" class="i method">RemoveVariable</a>(<b>string</b> <span id="r48 rd" class="r48 r">name</span>, <b>bool</b> <span id="r49 rd" class="r49 r">force</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r48 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r50 rd" class="r50 r">variable</span> = <a href="#300228748927425f" class="i method">GetVariable</a>(<span class="r48 r">name</span>);
 
            <b>if</b> (<span class="r50 r">variable</span>.<a href="ShellVariable.cs.html#fbdeffd557748144" class="i property">IsConstant</a> || (<span class="r50 r">variable</span>.<a href="ShellVariable.cs.html#8f7f1fc361d7e5b9" class="i property">IsReadOnly</a> &amp;&amp; !<span class="r49 r">force</span>))
            {
                <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r51 rd" class="r51 r">e</span> =
                    <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                            <span class="r48 r">name</span>,
                            <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#2c22962ab516ef3f" class="i field">Variable</a>,
                            <span class="s">&quot;VariableNotRemovable&quot;</span>,
                            <span class="i">SessionStateStrings</span>.<span class="i">VariableNotRemovable</span>);
 
                <b>throw</b> <span class="r51 r">e</span>;
            }
 
            <b>if</b> (<span class="r50 r">variable</span> <b>is</b> <a href="ShellVariable.cs.html#548f55a3498e1b7b" class="t t">LocalVariable</a>)
            {
                <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r52 rd" class="r52 r">e</span> =
                    <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                            <span class="r48 r">name</span>,
                            <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#2c22962ab516ef3f" class="i field">Variable</a>,
                            <span class="s">&quot;VariableNotRemovableRare&quot;</span>,
                            <span class="i">SessionStateStrings</span>.<span class="i">VariableNotRemovableRare</span>);
 
                <b>throw</b> <span class="r52 r">e</span>;
            }
 
            <a href="#faf742d1998e47c2" class="i field">_variables</a>.<span class="i">Remove</span>(<span class="r48 r">name</span>);
 
            <span class="c">// Finally mark the variable itself has having been removed so</span>
            <span class="c">// anyone holding a reference to it can be aware of this.</span>
            <span class="r50 r">variable</span>.<a href="ShellVariable.cs.html#63750c7d6b75ca37" class="i property">WasRemoved</a> = <b>true</b>;
        }
 
        <b>internal bool</b> <a id="d26d0b4983ef07b0" href="../R/d26d0b4983ef07b0.html" target="n" data-glyph="74,1" class="i method">TrySetLocalParameterValue</a>(<b>string</b> <span id="r53 rd" class="r53 r">name</span>, <b>object</b> <span id="r54 rd" class="r54 r">value</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r55 rd" class="r55 r">dottedScope</span> <b>in</b> <a href="#7c0785dd3b82b6e8" class="i field">_dottedScopes</a>)
            {
                <b>if</b> (<span class="r55 r">dottedScope</span>.<span class="i">TrySetParameter</span>(<span class="r53 r">name</span>, <span class="r54 r">value</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <a href="#d10101bbc5961e39" class="i property">LocalsTuple</a> != <b>null</b> &amp;&amp; <a href="#d10101bbc5961e39" class="i property">LocalsTuple</a>.<a href="runtime/MutableTuple.cs.html#1d0ae1bfb437b1f3" class="i method">TrySetParameter</a>(<span class="r53 r">name</span>, <span class="r54 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For most scopes (global scope being the notable exception), most variables are known ahead of</span>
        <span class="c">///</span><span class="c"> time and stored in a tuple.  The names of those variables are stored separately, this method</span>
        <span class="c">///</span><span class="c"> determines if variable name is active in this scope, and if so, returns a wrapper around the</span>
        <span class="c">///</span><span class="c"> tuple to access the property in the tuple for the given variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="47c71bddd693c07b" href="../R/47c71bddd693c07b.html" target="n" data-glyph="74,1" class="i method">TryGetLocalVariableFromTuple</a>(<b>string</b> <span id="r56 rd" class="r56 r">name</span>, <b>bool</b> <span id="r57 rd" class="r57 r">fromNewOrSet</span>, <b>out</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r58 rd" class="r58 r">result</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r59 rd" class="r59 r">dottedScope</span> <b>in</b> <a href="#7c0785dd3b82b6e8" class="i field">_dottedScopes</a>)
            {
                <b>if</b> (<span class="r59 r">dottedScope</span>.<span class="i">TryGetLocalVariable</span>(<span class="r56 r">name</span>, <span class="r57 r">fromNewOrSet</span>, <b>out</b> <span class="r58 r">result</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <span class="r58 r">result</span> = <b>null</b>;
            <b>return</b> <a href="#d10101bbc5961e39" class="i property">LocalsTuple</a> != <b>null</b> &amp;&amp; <a href="#d10101bbc5961e39" class="i property">LocalsTuple</a>.<a href="runtime/MutableTuple.cs.html#9cc23aaaa6f283d9" class="i method">TryGetLocalVariable</a>(<span class="r56 r">name</span>, <span class="r57 r">fromNewOrSet</span>, <b>out</b> <span class="r58 r">result</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> variables
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Aliases
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an IEnumerable for the aliases in this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt; <a id="004230f64a4526c0" href="../R/004230f64a4526c0.html" target="n" data-glyph="104,1" class="i property">AliasTable</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3fce71a286a9563e" class="i method">GetAliases</a>().<span class="i">Values</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the specified alias from the alias table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the alias to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string representing the value of the alias specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <a id="c52884be8798f63a" href="../R/c52884be8798f63a.html" target="n" data-glyph="74,1" class="i method">GetAlias</a>(<b>string</b> <span id="r60 rd" class="r60 r">name</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r60 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r61 rd" class="r61 r">result</span>;
            <a href="#3fce71a286a9563e" class="i method">GetAliases</a>().<span class="i">TryGetValue</span>(<span class="r60 r">name</span>, <b>out</b> <span class="r61 r">result</span>);
 
            <b>return</b> <span class="r61 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets an alias to the given value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the alias to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value for the alias</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for this engine instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the value will be set even if the alias is ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string representing the value that was set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the alias is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <a id="cc431b97e86dccfb" href="../R/cc431b97e86dccfb.html" target="n" data-glyph="74,1" class="i method">SetAliasValue</a>(<b>string</b> <span id="r62 rd" class="r62 r">name</span>, <b>string</b> <span id="r63 rd" class="r63 r">value</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r64 rd" class="r64 r">context</span>, <b>bool</b> <span id="r65 rd" class="r65 r">force</span>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r66 rd" class="r66 r">origin</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r62 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <b>var</b> <span id="r67 rd" class="r67 r">aliasInfos</span> = <a href="#3fce71a286a9563e" class="i method">GetAliases</a>();
            <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r68 rd" class="r68 r">aliasInfo</span>;
            <b>if</b> (!<span class="r67 r">aliasInfos</span>.<span class="i">TryGetValue</span>(<span class="r62 r">name</span>, <b>out</b> <span class="r68 r">aliasInfo</span>))
            {
                <span class="r67 r">aliasInfos</span>[<span class="r62 r">name</span>] = <b>new</b> <a href="AliasInfo.cs.html#81b0ee0063948411" class="t constructor">AliasInfo</a>(<span class="r62 r">name</span>, <span class="r63 r">value</span>, <span class="r64 r">context</span>);
            }
            <b>else</b>
            {
                <span class="c">// Make sure the alias isn&#39;t constant or readonly</span>
                <b>if</b> ((<span class="r68 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) != 0 ||
                    (!<span class="r65 r">force</span> &amp;&amp; (<span class="r68 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>) != 0))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r69 rd" class="r69 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r62 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#0d09830478f193c2" class="i field">Alias</a>,
                                <span class="s">&quot;AliasNotWritable&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">AliasNotWritable</span>);
 
                    <b>throw</b> <span class="r69 r">e</span>;
                }
 
                <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#f73a87d524011168" class="i method">ThrowIfNotVisible</a>(<span class="r66 r">origin</span>, <span class="r68 r">aliasInfo</span>);
                <a href="#bd3ff93df4625767" class="i method">RemoveAliasFromCache</a>(<span class="r68 r">aliasInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r68 r">aliasInfo</span>.<a href="AliasInfo.cs.html#18d5b1486b184b4a" class="i property">Definition</a>);
 
                <b>if</b> (<span class="r65 r">force</span>)
                {
                    <span class="r67 r">aliasInfos</span>.<span class="i">Remove</span>(<span class="r62 r">name</span>);
                    <span class="r68 r">aliasInfo</span> = <b>new</b> <a href="AliasInfo.cs.html#81b0ee0063948411" class="t constructor">AliasInfo</a>(<span class="r62 r">name</span>, <span class="r63 r">value</span>, <span class="r64 r">context</span>);
                    <span class="r67 r">aliasInfos</span>[<span class="r62 r">name</span>] = <span class="r68 r">aliasInfo</span>;
                }
                <b>else</b>
                {
                    <span class="r68 r">aliasInfo</span>.<a href="AliasInfo.cs.html#bd63788df3b8bd53" class="i method">SetDefinition</a>(<span class="r63 r">value</span>, <b>false</b>);
                }
            }
 
            <a href="#8d946f9545c3da25" class="i method">AddAliasToCache</a>(<span class="r62 r">name</span>, <span class="r63 r">value</span>);
 
            <b>return</b> <span class="r67 r">aliasInfos</span>[<span class="r62 r">name</span>];
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets an alias to the given value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the alias to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value for the alias</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for this engine instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The options to set on the alias.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the value will be set even if the alias is ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string representing the value that was set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the alias is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <a id="7d9a71174bd57452" href="../R/7d9a71174bd57452.html" target="n" data-glyph="74,1" class="i method">SetAliasValue</a>(
            <b>string</b> <span id="r70 rd" class="r70 r">name</span>,
            <b>string</b> <span id="r71 rd" class="r71 r">value</span>,
            <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r73 rd" class="r73 r">options</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r72 rd" class="r72 r">context</span>,
            <b>bool</b> <span id="r74 rd" class="r74 r">force</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r75 rd" class="r75 r">origin</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r70 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <b>var</b> <span id="r76 rd" class="r76 r">aliasInfos</span> = <a href="#3fce71a286a9563e" class="i method">GetAliases</a>();
            <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r77 rd" class="r77 r">aliasInfo</span>;
            <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r78 rd" class="r78 r">result</span>;
            <b>if</b> (!<span class="r76 r">aliasInfos</span>.<span class="i">TryGetValue</span>(<span class="r70 r">name</span>, <b>out</b> <span class="r77 r">aliasInfo</span>))
            {
                <span class="r78 r">result</span> = <b>new</b> <a href="AliasInfo.cs.html#908ec52506619a99" class="t constructor">AliasInfo</a>(<span class="r70 r">name</span>, <span class="r71 r">value</span>, <span class="r72 r">context</span>, <span class="r73 r">options</span>);
                <span class="r76 r">aliasInfos</span>[<span class="r70 r">name</span>] = <span class="r78 r">result</span>;
            }
            <b>else</b>
            {
                <span class="c">// Make sure the alias isn&#39;t constant or readonly</span>
                <b>if</b> ((<span class="r77 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) != 0 ||
                    (!<span class="r74 r">force</span> &amp;&amp; (<span class="r77 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>) != 0))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r79 rd" class="r79 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r70 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#0d09830478f193c2" class="i field">Alias</a>,
                                <span class="s">&quot;AliasNotWritable&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">AliasNotWritable</span>);
 
                    <b>throw</b> <span class="r79 r">e</span>;
                }
 
                <span class="c">// Ensure we are not trying to set the alias to constant as this can only be</span>
                <span class="c">// done at creation time.</span>
 
                <b>if</b> ((<span class="r73 r">options</span> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) != 0)
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r80 rd" class="r80 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r70 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#0d09830478f193c2" class="i field">Alias</a>,
                                <span class="s">&quot;AliasCannotBeMadeConstant&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">AliasCannotBeMadeConstant</span>);
 
                    <b>throw</b> <span class="r80 r">e</span>;
                }
 
                <b>if</b> ((<span class="r73 r">options</span> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) == 0 &amp;&amp;
                    (<span class="r77 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) != 0)
                {
                    <span class="c">// user is trying to remove the AllScope option from the alias.</span>
                    <span class="c">// Do not allow this (as per spec).</span>
 
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r81 rd" class="r81 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r70 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#0d09830478f193c2" class="i field">Alias</a>,
                                <span class="s">&quot;AliasAllScopeOptionCannotBeRemoved&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">AliasAllScopeOptionCannotBeRemoved</span>);
 
                    <b>throw</b> <span class="r81 r">e</span>;
                }
 
                <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#f73a87d524011168" class="i method">ThrowIfNotVisible</a>(<span class="r75 r">origin</span>, <span class="r77 r">aliasInfo</span>);
                <a href="#bd3ff93df4625767" class="i method">RemoveAliasFromCache</a>(<span class="r77 r">aliasInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r77 r">aliasInfo</span>.<a href="AliasInfo.cs.html#18d5b1486b184b4a" class="i property">Definition</a>);
 
                <b>if</b> (<span class="r74 r">force</span>)
                {
                    <span class="r76 r">aliasInfos</span>.<span class="i">Remove</span>(<span class="r70 r">name</span>);
                    <span class="r78 r">result</span> = <b>new</b> <a href="AliasInfo.cs.html#908ec52506619a99" class="t constructor">AliasInfo</a>(<span class="r70 r">name</span>, <span class="r71 r">value</span>, <span class="r72 r">context</span>, <span class="r73 r">options</span>);
                    <span class="r76 r">aliasInfos</span>[<span class="r70 r">name</span>] = <span class="r78 r">result</span>;
                }
                <b>else</b>
                {
                    <span class="r78 r">result</span> = <span class="r77 r">aliasInfo</span>;
                    <span class="r77 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> = <span class="r73 r">options</span>;
                    <span class="r77 r">aliasInfo</span>.<a href="AliasInfo.cs.html#bd63788df3b8bd53" class="i method">SetDefinition</a>(<span class="r71 r">value</span>, <b>false</b>);
                }
            }
 
            <a href="#8d946f9545c3da25" class="i method">AddAliasToCache</a>(<span class="r70 r">name</span>, <span class="r71 r">value</span>);
 
            <b>return</b> <span class="r78 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets an alias to the given value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">aliasToSet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The information about the alias to be set</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the alias will be set even if there is an existing ReadOnly</span>
        <span class="c">///</span><span class="c"> alias.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the command origin of the calling command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string representing the value that was set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the alias is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <a id="9d8a2f17f4084053" href="../R/9d8a2f17f4084053.html" target="n" data-glyph="74,1" class="i method">SetAliasItem</a>(<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r82 rd" class="r82 r">aliasToSet</span>, <b>bool</b> <span id="r83 rd" class="r83 r">force</span>, <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r84 rd" class="r84 r">origin</span> = <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a>.<a href="SecurityManagerBase.cs.html#946d8e7ca02acec6" class="i field">Internal</a>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r82 r">aliasToSet</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the aliasToSet&quot;</span>);
 
            <b>var</b> <span id="r85 rd" class="r85 r">aliasInfos</span> = <a href="#3fce71a286a9563e" class="i method">GetAliases</a>();
            <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r86 rd" class="r86 r">aliasInfo</span>;
            <b>if</b> (<span class="r85 r">aliasInfos</span>.<span class="i">TryGetValue</span>(<span class="r82 r">aliasToSet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <b>out</b> <span class="r86 r">aliasInfo</span>))
            {
                <span class="c">// An existing alias cannot be set if it is ReadOnly or Constant unless</span>
                <span class="c">// force is specified, in which case an existing ReadOnly alias can</span>
                <span class="c">// be set.</span>
 
                <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#f73a87d524011168" class="i method">ThrowIfNotVisible</a>(<span class="r84 r">origin</span>, <span class="r86 r">aliasInfo</span>);
                <b>if</b> ((<span class="r86 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) != 0 ||
                    ((<span class="r86 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>) != 0 &amp;&amp; !<span class="r83 r">force</span>))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r87 rd" class="r87 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r82 r">aliasToSet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#0d09830478f193c2" class="i field">Alias</a>,
                                <span class="s">&quot;AliasNotWritable&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">AliasNotWritable</span>);
 
                    <b>throw</b> <span class="r87 r">e</span>;
                }
 
                <b>if</b> ((<span class="r82 r">aliasToSet</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) == 0 &amp;&amp;
                    (<span class="r86 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) != 0)
                {
                    <span class="c">// user is trying to remove the AllScope option from the alias.</span>
                    <span class="c">// Do not allow this (as per spec).</span>
 
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r88 rd" class="r88 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r82 r">aliasToSet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#0d09830478f193c2" class="i field">Alias</a>,
                                <span class="s">&quot;AliasAllScopeOptionCannotBeRemoved&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">AliasAllScopeOptionCannotBeRemoved</span>);
 
                    <b>throw</b> <span class="r88 r">e</span>;
                }
 
                <a href="#bd3ff93df4625767" class="i method">RemoveAliasFromCache</a>(<span class="r86 r">aliasInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r86 r">aliasInfo</span>.<a href="AliasInfo.cs.html#18d5b1486b184b4a" class="i property">Definition</a>);
            }
 
            <span class="r85 r">aliasInfos</span>[<span class="r82 r">aliasToSet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>] = <span class="r82 r">aliasToSet</span>;
 
            <a href="#8d946f9545c3da25" class="i method">AddAliasToCache</a>(<span class="r82 r">aliasToSet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r82 r">aliasToSet</span>.<a href="AliasInfo.cs.html#18d5b1486b184b4a" class="i property">Definition</a>);
 
            <b>return</b> <span class="r82 r">aliasToSet</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a alias from the alias table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the alias to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the alias will be removed even if it is ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the alias is constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b1afebcf919d3538" href="../R/b1afebcf919d3538.html" target="n" data-glyph="74,1" class="i method">RemoveAlias</a>(<b>string</b> <span id="r89 rd" class="r89 r">name</span>, <b>bool</b> <span id="r90 rd" class="r90 r">force</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r89 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <span class="c">// Make sure the alias isn&#39;t constant or readonly</span>
 
            <b>var</b> <span id="r91 rd" class="r91 r">aliasInfos</span> = <a href="#3fce71a286a9563e" class="i method">GetAliases</a>();
            <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r92 rd" class="r92 r">aliasInfo</span>;
            <b>if</b> (<span class="r91 r">aliasInfos</span>.<span class="i">TryGetValue</span>(<span class="r89 r">name</span>, <b>out</b> <span class="r92 r">aliasInfo</span>))
            {
                <b>if</b> ((<span class="r92 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) != 0 ||
                    (!<span class="r90 r">force</span> &amp;&amp; (<span class="r92 r">aliasInfo</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>) != 0))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r93 rd" class="r93 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r89 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#0d09830478f193c2" class="i field">Alias</a>,
                                <span class="s">&quot;AliasNotRemovable&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">AliasNotRemovable</span>);
 
                    <b>throw</b> <span class="r93 r">e</span>;
                }
 
                <a href="#bd3ff93df4625767" class="i method">RemoveAliasFromCache</a>(<span class="r92 r">aliasInfo</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r92 r">aliasInfo</span>.<a href="AliasInfo.cs.html#18d5b1486b184b4a" class="i property">Definition</a>);
            }
 
            <span class="r91 r">aliasInfos</span>.<span class="i">Remove</span>(<span class="r89 r">name</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> aliases
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Functions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an IEnumerable for the functions in this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt; <a id="0cb72e1b3b779c82" href="../R/0cb72e1b3b779c82.html" target="n" data-glyph="104,1" class="i property">FunctionTable</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#b3f4127c3da10955" class="i method">GetFunctions</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the specified function from the function table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A FunctionInfo that is either a FilterInfo or FunctionInfo representing the</span>
        <span class="c">///</span><span class="c"> function or filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <a id="2057e0e5221ac1d4" href="../R/2057e0e5221ac1d4.html" target="n" data-glyph="74,1" class="i method">GetFunction</a>(<b>string</b> <span id="r94 rd" class="r94 r">name</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r94 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r95 rd" class="r95 r">result</span>;
            <a href="#b3f4127c3da10955" class="i method">GetFunctions</a>().<span class="i">TryGetValue</span>(<span class="r94 r">name</span>, <b>out</b> <span class="r95 r">result</span>);
 
            <b>return</b> <span class="r95 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets an function to the given function declaration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">function</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block that represents the code for the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the function will be set even if its ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for the function/filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A FunctionInfo that is either a FilterInfo or FunctionInfo representing the</span>
        <span class="c">///</span><span class="c"> function or filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the function is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <a id="50ac79c298b4ff32" href="../R/50ac79c298b4ff32.html" target="n" data-glyph="74,1" class="i method">SetFunction</a>(
            <b>string</b> <span id="r96 rd" class="r96 r">name</span>,
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r97 rd" class="r97 r">function</span>,
            <b>bool</b> <span id="r98 rd" class="r98 r">force</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r99 rd" class="r99 r">origin</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r100 rd" class="r100 r">context</span>)
        {
            <b>return</b> <a href="#5b4b5a2a13986936" class="i method">SetFunction</a>(<span class="r96 r">name</span>, <span class="r97 r">function</span>, <b>null</b>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#d3cd3fca45c40287" class="i field">Unspecified</a>, <span class="r98 r">force</span>, <span class="r99 r">origin</span>, <span class="r100 r">context</span>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets an function to the given function declaration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">function</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block that represents the code for the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">originalFunction</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The original function (if any) from which the scriptblock was derived.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the function will be set even if its ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for the function/filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A FunctionInfo that is either a FilterInfo or FunctionInfo representing the</span>
        <span class="c">///</span><span class="c"> function or filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the function is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <a id="6d7966fb86df8d02" href="../R/6d7966fb86df8d02.html" target="n" data-glyph="74,1" class="i method">SetFunction</a>(
            <b>string</b> <span id="r101 rd" class="r101 r">name</span>,
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r102 rd" class="r102 r">function</span>,
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r103 rd" class="r103 r">originalFunction</span>,
            <b>bool</b> <span id="r104 rd" class="r104 r">force</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r105 rd" class="r105 r">origin</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r106 rd" class="r106 r">context</span>)
        {
            <b>return</b> <a href="#5b4b5a2a13986936" class="i method">SetFunction</a>(<span class="r101 r">name</span>, <span class="r102 r">function</span>, <span class="r103 r">originalFunction</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#d3cd3fca45c40287" class="i field">Unspecified</a>, <span class="r104 r">force</span>, <span class="r105 r">origin</span>, <span class="r106 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets an function to the given function declaration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">function</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block that the function should represent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">originalFunction</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The original function (if any) from which the scriptblock was derived.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The options that should be applied to the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the function will be set even if its ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for the function/filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A FunctionInfo that is either a FilterInfo or FunctionInfo representing the</span>
        <span class="c">///</span><span class="c"> function or filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the function is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <a id="5b4b5a2a13986936" href="../R/5b4b5a2a13986936.html" target="n" data-glyph="74,1" class="i method">SetFunction</a>(
            <b>string</b> <span id="r107 rd" class="r107 r">name</span>,
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r108 rd" class="r108 r">function</span>,
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r109 rd" class="r109 r">originalFunction</span>,
            <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r110 rd" class="r110 r">options</span>,
            <b>bool</b> <span id="r111 rd" class="r111 r">force</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r112 rd" class="r112 r">origin</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r113 rd" class="r113 r">context</span>)
        {
            <b>return</b> <a href="#da2cb62e7370c854" class="i method">SetFunction</a>(<span class="r107 r">name</span>, <span class="r108 r">function</span>, <span class="r109 r">originalFunction</span>, <span class="r110 r">options</span>, <span class="r111 r">force</span>, <span class="r112 r">origin</span>, <span class="r113 r">context</span>, <b>null</b>);
        }
 
        <b>internal</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <a id="da2cb62e7370c854" href="../R/da2cb62e7370c854.html" target="n" data-glyph="74,1" class="i method">SetFunction</a>(
            <b>string</b> <span id="r114 rd" class="r114 r">name</span>,
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r115 rd" class="r115 r">function</span>,
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r116 rd" class="r116 r">originalFunction</span>,
            <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r117 rd" class="r117 r">options</span>,
            <b>bool</b> <span id="r118 rd" class="r118 r">force</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r119 rd" class="r119 r">origin</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r120 rd" class="r120 r">context</span>,
            <b>string</b> <span id="r121 rd" class="r121 r">helpFile</span>)
        {
            <b>return</b> <span class="i">SetFunction</span>(<span class="r114 r">name</span>, <span class="r115 r">function</span>, <span class="r116 r">originalFunction</span>, <span class="r117 r">options</span>, <span class="r118 r">force</span>, <span class="r119 r">origin</span>, <span class="r120 r">context</span>, <span class="r121 r">helpFile</span>, <span class="i">CreateFunction</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets an function to the given function declaration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">function</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script block that the function should represent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">originalFunction</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The original function (if any) from which the scriptblock was derived.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r125 r">options</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The options that should be applied to the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the function will be set even if its ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for the function/filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">helpFile</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the help file associated with the function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">functionFactory</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Function to create the FunctionInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A FunctionInfo that is either a FilterInfo or FunctionInfo representing the</span>
        <span class="c">///</span><span class="c"> function or filter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the function is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <a id="b610e95bb2b35b2d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetFunction</a>(
            <b>string</b> <span id="r122 rd" class="r122 r">name</span>,
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r123 rd" class="r123 r">function</span>,
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r124 rd" class="r124 r">originalFunction</span>,
            <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r125 rd" class="r125 r">options</span>,
            <b>bool</b> <span id="r126 rd" class="r126 r">force</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r127 rd" class="r127 r">origin</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r128 rd" class="r128 r">context</span>,
            <b>string</b> <span id="r129 rd" class="r129 r">helpFile</span>,
            <span class="i">Func</span>&lt;<b>string</b>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>, <b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt; <span id="r130 rd" class="r130 r">functionFactory</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r122 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <b>var</b> <span id="r131 rd" class="r131 r">functionInfos</span> = <a href="#b3f4127c3da10955" class="i method">GetFunctions</a>();
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r132 rd" class="r132 r">existingValue</span>;
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r133 rd" class="r133 r">result</span>;
            <b>if</b> (!<span class="r131 r">functionInfos</span>.<span class="i">TryGetValue</span>(<span class="r122 r">name</span>, <b>out</b> <span class="r132 r">existingValue</span>))
            {
                <span class="r133 r">result</span> = <span class="r130 r">functionFactory</span>(<span class="r122 r">name</span>, <span class="r123 r">function</span>, <span class="r124 r">originalFunction</span>, <span class="r125 r">options</span>, <span class="r128 r">context</span>, <span class="r129 r">helpFile</span>);
                <span class="r131 r">functionInfos</span>[<span class="r122 r">name</span>] = <span class="r133 r">result</span>;
 
                <b>if</b> (<a href="#58acb335b66cb83a" class="i method">IsFunctionOptionSet</a>(<span class="r133 r">result</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>))
                {
                    <a href="#0745c59201878810" class="i method">GetAllScopeFunctions</a>()[<span class="r122 r">name</span>] = <span class="r133 r">result</span>;
                }
            }
            <b>else</b>
            {
                <span class="c">// Make sure the function isn&#39;t constant or readonly</span>
 
                <a href="SessionStatePublic.cs.html#0a202aa6b2d52930" class="t t">SessionState</a>.<a href="SessionStatePublic.cs.html#f73a87d524011168" class="i method">ThrowIfNotVisible</a>(<span class="r127 r">origin</span>, <span class="r132 r">existingValue</span>);
 
                <b>if</b> (<a href="#58acb335b66cb83a" class="i method">IsFunctionOptionSet</a>(<span class="r132 r">existingValue</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) ||
                    (!<span class="r126 r">force</span> &amp;&amp; <a href="#58acb335b66cb83a" class="i method">IsFunctionOptionSet</a>(<span class="r132 r">existingValue</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>)))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r134 rd" class="r134 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r122 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#00c730945e327236" class="i field">Function</a>,
                                <span class="s">&quot;FunctionNotWritable&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">FunctionNotWritable</span>);
 
                    <b>throw</b> <span class="r134 r">e</span>;
                }
 
                <span class="c">// Ensure we are not trying to set the function to constant as this can only be</span>
                <span class="c">// done at creation time.</span>
 
                <b>if</b> ((<span class="r125 r">options</span> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) != 0)
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r135 rd" class="r135 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r122 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#00c730945e327236" class="i field">Function</a>,
                                <span class="s">&quot;FunctionCannotBeMadeConstant&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">FunctionCannotBeMadeConstant</span>);
 
                    <b>throw</b> <span class="r135 r">e</span>;
                }
 
                <span class="c">// Ensure we are not trying to remove the AllScope option</span>
 
                <b>if</b> ((<span class="r125 r">options</span> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) == 0 &amp;&amp;
                    <a href="#58acb335b66cb83a" class="i method">IsFunctionOptionSet</a>(<span class="r132 r">existingValue</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r136 rd" class="r136 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r122 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#00c730945e327236" class="i field">Function</a>,
                                <span class="s">&quot;FunctionAllScopeOptionCannotBeRemoved&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">FunctionAllScopeOptionCannotBeRemoved</span>);
 
                    <b>throw</b> <span class="r136 r">e</span>;
                }
 
                <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r137 rd" class="r137 r">existingFunction</span> = <span class="r132 r">existingValue</span>;
                <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r138 rd" class="r138 r">newValue</span> = <b>null</b>;
 
                <span class="c">// If the function type changes (i.e.: function to workflow or back)</span>
                <span class="c">// then we need to blast what was there</span>
                <span class="r138 r">newValue</span> = <span class="r130 r">functionFactory</span>(<span class="r122 r">name</span>, <span class="r123 r">function</span>, <span class="r124 r">originalFunction</span>, <span class="r125 r">options</span>, <span class="r128 r">context</span>, <span class="r129 r">helpFile</span>);
 
                <b>bool</b> <span id="r139 rd" class="r139 r">changesFunctionType</span> = <span class="r137 r">existingFunction</span>.<span class="i">GetType</span>() != <span class="r138 r">newValue</span>.<span class="i">GetType</span>();
 
                <span class="c">// Since the options are set after the script block, we have to</span>
                <span class="c">// forcefully apply the script block if the options will be</span>
                <span class="c">// set to not being ReadOnly</span>
                <b>if</b> (<span class="r139 r">changesFunctionType</span> ||
                    ((<span class="r137 r">existingFunction</span>.<a href="FunctionInfo.cs.html#4eff0d117fdeb729" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>) != 0 &amp;&amp; <span class="r126 r">force</span>))
                {
                    <span class="r133 r">result</span> = <span class="r138 r">newValue</span>;
                    <span class="r131 r">functionInfos</span>[<span class="r122 r">name</span>] = <span class="r138 r">newValue</span>;
                }
                <b>else</b>
                {
                    <b>bool</b> <span id="r140 rd" class="r140 r">applyForce</span> = <span class="r126 r">force</span> || (<span class="r125 r">options</span> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>) == 0;
 
                    <span class="r137 r">existingFunction</span>.<a href="FunctionInfo.cs.html#f2b80a7864320f15" class="i method">Update</a>(<span class="r138 r">newValue</span>, <span class="r140 r">applyForce</span>, <span class="r125 r">options</span>, <span class="r129 r">helpFile</span>);
                    <span class="r133 r">result</span> = <span class="r137 r">existingFunction</span>;
                }
            }
 
            <b>return</b> <span class="r133 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a function from the function table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the function is removed even if it is ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the function is constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b787b43c1f34d058" href="../R/b787b43c1f34d058.html" target="n" data-glyph="74,1" class="i method">RemoveFunction</a>(<b>string</b> <span id="r141 rd" class="r141 r">name</span>, <b>bool</b> <span id="r142 rd" class="r142 r">force</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r141 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <b>var</b> <span id="r143 rd" class="r143 r">functionInfos</span> = <a href="#b3f4127c3da10955" class="i method">GetFunctions</a>();
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r144 rd" class="r144 r">function</span>;
            <b>if</b> (<span class="r143 r">functionInfos</span>.<span class="i">TryGetValue</span>(<span class="r141 r">name</span>, <b>out</b> <span class="r144 r">function</span>))
            {
                <b>if</b> (<a href="#58acb335b66cb83a" class="i method">IsFunctionOptionSet</a>(<span class="r144 r">function</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a>) ||
                    (!<span class="r142 r">force</span> &amp;&amp; <a href="#58acb335b66cb83a" class="i method">IsFunctionOptionSet</a>(<span class="r144 r">function</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#be05356d33c4ce88" class="i field">ReadOnly</a>)))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a> <span id="r145 rd" class="r145 r">e</span> =
                        <b>new</b> <span class="t">SessionStateUnauthorizedAccessException</span>(
                                <span class="r141 r">name</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#00c730945e327236" class="i field">Function</a>,
                                <span class="s">&quot;FunctionNotRemovable&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">FunctionNotRemovable</span>);
 
                    <b>throw</b> <span class="r145 r">e</span>;
                }
 
                <b>if</b> (<a href="#58acb335b66cb83a" class="i method">IsFunctionOptionSet</a>(<span class="r144 r">function</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>))
                {
                    <a href="#0745c59201878810" class="i method">GetAllScopeFunctions</a>().<span class="i">Remove</span>(<span class="r141 r">name</span>);
                }
            }
 
            <span class="r143 r">functionInfos</span>.<span class="i">Remove</span>(<span class="r141 r">name</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> functions
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Cmdlets
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an IEnumerable for the cmdlets in this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;&gt; <a id="bedca0fe0b1b3026" href="../R/bedca0fe0b1b3026.html" target="n" data-glyph="104,1" class="i property">CmdletTable</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the specified cmdlet from the cmdlet table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the cmdlet to retrieve.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CmdletInfo representing this cmdlet</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <a id="45cc57cd4e014449" href="../R/45cc57cd4e014449.html" target="n" data-glyph="74,1" class="i method">GetCmdlet</a>(<b>string</b> <span id="r146 rd" class="r146 r">name</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r146 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r147 rd" class="r147 r">result</span> = <b>null</b>;
 
            <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt; <span id="r148 rd" class="r148 r">cmdlets</span>;
 
            <b>if</b> (<a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>.<span class="i">TryGetValue</span>(<span class="r146 r">name</span>, <b>out</b> <span class="r148 r">cmdlets</span>))
            {
                <b>if</b> (<span class="r148 r">cmdlets</span> != <b>null</b> &amp;&amp; <span class="r148 r">cmdlets</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r147 r">result</span> = <span class="r148 r">cmdlets</span>[0];
                }
            }
 
            <b>return</b> <span class="r147 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a cmdlet to the cmdlet cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r149 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the cmdlet to add.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The cmdlet that should be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">origin</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The origin of the caller of this API</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for the cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A CmdletInfo representing the cmdlet</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the cmdlet is read-only or constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span>
        <b>internal</b> <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <a id="3878bfdb52dbb931" href="../R/3878bfdb52dbb931.html" target="n" data-glyph="74,1" class="i method">AddCmdletToCache</a>(
            <b>string</b> <span id="r149 rd" class="r149 r">name</span>,
            <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r150 rd" class="r150 r">cmdlet</span>,
            <a href="SecurityManagerBase.cs.html#a1d5a2ba5cd1b3aa" class="t t">CommandOrigin</a> <span id="r151 rd" class="r151 r">origin</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r152 rd" class="r152 r">context</span>)
        {
            <b>bool</b> <span id="r153 rd" class="r153 r">throwNotSupported</span> = <b>false</b>;
            <b>try</b>
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                    <span class="r149 r">name</span> != <b>null</b>,
                    <span class="s">&quot;The caller should verify the name&quot;</span>);
 
                <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt; <span id="r154 rd" class="r154 r">cmdlets</span>;
                <b>if</b> (!<a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>.<span class="i">TryGetValue</span>(<span class="r149 r">name</span>, <b>out</b> <span class="r154 r">cmdlets</span>))
                {
                    <span class="r154 r">cmdlets</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;();
                    <span class="r154 r">cmdlets</span>.<span class="i">Add</span>(<span class="r150 r">cmdlet</span>);
                    <a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>.<span class="i">Add</span>(<span class="r149 r">name</span>, <span class="r154 r">cmdlets</span>);
 
                    <b>if</b> ((<span class="r150 r">cmdlet</span>.<a href="CmdletInfo.cs.html#924765cf42982e3f" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) != 0)
                    {
                        <a href="#63d27ffe9672b552" class="i field">_allScopeCmdlets</a>[<span class="r149 r">name</span>].<span class="i">Insert</span>(0, <span class="r150 r">cmdlet</span>);
                    }
                }
                <b>else</b>
                {
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r150 r">cmdlet</span>.<a href="CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>))
                    {
                        <span class="c">// Need to be sure that the existing cmdlet doesn&#39;t have the same snapin name</span>
                        <b>foreach</b> (<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r155 rd" class="r155 r">cmdletInfo</span> <b>in</b> <span class="r154 r">cmdlets</span>)
                        {
                            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r150 r">cmdlet</span>.<a href="CmdletInfo.cs.html#7faf4081836f8538" class="i property">FullName</a>, <span class="r155 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#7faf4081836f8538" class="i property">FullName</a>,
                                              <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>if</b> (<span class="r150 r">cmdlet</span>.<a href="CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a> == <span class="r155 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a>)
                                {
                                    <span class="c">// It is already added in the cache. Do not add it again</span>
                                    <b>return</b> <b>null</b>;
                                }
                                <span class="c">// Otherwise it&#39;s an error...</span>
                                <span class="r153 r">throwNotSupported</span> = <b>true</b>;
                                <b>break</b>;
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// If there&#39;s no module name, then see if there is a cmdlet that matches the type</span>
                        <b>foreach</b> (<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r156 rd" class="r156 r">cmdletInfo</span> <b>in</b> <span class="r154 r">cmdlets</span>)
                        {
                            <b>if</b> (<span class="r150 r">cmdlet</span>.<a href="CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a> == <span class="r156 r">cmdletInfo</span>.<a href="CmdletInfo.cs.html#9ba4328ad01dd7c0" class="i property">ImplementingType</a>)
                            {
                                <span class="c">// It&#39;s already in the cache so don&#39;t need to add it again...</span>
                                <b>return</b> <b>null</b>;
                            }
 
                            <span class="c">// Otherwise it&#39;s an error...</span>
                            <span class="r153 r">throwNotSupported</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
                    <span class="c">// Insert the cmdlet if a duplicate doesn&#39;t already exist</span>
                    <b>if</b> (!<span class="r153 r">throwNotSupported</span>)
                    {
                        <span class="r154 r">cmdlets</span>.<span class="i">Insert</span>(0, <span class="r150 r">cmdlet</span>);
                    }
                }
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <span class="r153 r">throwNotSupported</span> = <b>true</b>;
            }
 
            <b>if</b> (<span class="r153 r">throwNotSupported</span>)
            {
                <a href="../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a> <span id="r157 rd" class="r157 r">notSupported</span> =
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(
                        <span class="i">DiscoveryExceptions</span>.<span class="i">DuplicateCmdletName</span>,
                        <span class="r150 r">cmdlet</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>);
 
                <b>throw</b> <span class="r157 r">notSupported</span>;
            }
 
            <b>return</b> <a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>[<span class="r149 r">name</span>][0];
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a cmdlet from the cmdlet table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r158 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the cmdlet to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r159 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The index at which to remove the cmdlet</span>
        <span class="c">///</span><span class="c"> If index is -1, remove all cmdlets with that name</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r160 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the cmdlet is removed even if it is ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the cmdlet is constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="9f22287e80ad10f7" href="../R/9f22287e80ad10f7.html" target="n" data-glyph="74,1" class="i method">RemoveCmdlet</a>(<b>string</b> <span id="r158 rd" class="r158 r">name</span>, <b>int</b> <span id="r159 rd" class="r159 r">index</span>, <b>bool</b> <span id="r160 rd" class="r160 r">force</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r158 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt; <span id="r161 rd" class="r161 r">cmdlets</span>;
            <b>if</b> (<a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>.<span class="i">TryGetValue</span>(<span class="r158 r">name</span>, <b>out</b> <span class="r161 r">cmdlets</span>))
            {
                <a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a> <span id="r162 rd" class="r162 r">tempCmdlet</span> = <span class="r161 r">cmdlets</span>[<span class="r159 r">index</span>];
 
                <b>if</b> ((<span class="r162 r">tempCmdlet</span>.<a href="CmdletInfo.cs.html#924765cf42982e3f" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) != 0)
                {
                    <a href="#63d27ffe9672b552" class="i field">_allScopeCmdlets</a>[<span class="r158 r">name</span>].<span class="i">RemoveAt</span>(<span class="r159 r">index</span>);
                }
 
                <span class="r161 r">cmdlets</span>.<span class="i">RemoveAt</span>(<span class="r159 r">index</span>);
 
                <span class="c">// Remove the entry is the list is now empty</span>
                <b>if</b> (<span class="r161 r">cmdlets</span>.<span class="i">Count</span> == 0)
                {
                    <span class="c">// Remove the key</span>
                    <a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>.<span class="i">Remove</span>(<span class="r158 r">name</span>);
                    <b>return</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a cmdlet entry from the cmdlet table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r163 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The key for the cmdlet entry to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r164 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the cmdlet entry is removed even if it is ReadOnly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#fc882bde4eabbb16" class="t t">SessionStateUnauthorizedAccessException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the cmdlet is constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="d9d6a93e6e21f4d3" href="../R/d9d6a93e6e21f4d3.html" target="n" data-glyph="74,1" class="i method">RemoveCmdletEntry</a>(<b>string</b> <span id="r163 rd" class="r163 r">name</span>, <b>bool</b> <span id="r164 rd" class="r164 r">force</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r163 r">name</span> != <b>null</b>,
                <span class="s">&quot;The caller should verify the name&quot;</span>);
 
            <a href="#6d809ca76cc7163c" class="i field">_cmdlets</a>.<span class="i">Remove</span>(<span class="r163 r">name</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Cmdlets
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Types
 
        <b>private</b> <span class="i n">Language</span>.<a href="parser/TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a> <a id="e4e6017779e6515d" href="../R/e4e6017779e6515d.html" target="n" data-glyph="46,1" class="i field">_typeResolutionState</a>;
 
        <b>internal</b> <span class="i n">Language</span>.<a href="parser/TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a> <a id="bdd9f0dc3f98ba22" href="../R/bdd9f0dc3f98ba22.html" target="n" data-glyph="104,1" class="i property">TypeResolutionState</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#e4e6017779e6515d" class="i field">_typeResolutionState</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#e4e6017779e6515d" class="i field">_typeResolutionState</a>;
                }
 
                <b>return</b> <a href="#ec04fff24436a018" class="i property">Parent</a> != <b>null</b> ? <a href="#ec04fff24436a018" class="i property">Parent</a>.<a href="#bdd9f0dc3f98ba22" class="i property">TypeResolutionState</a> : <span class="i n">Language</span>.<a href="parser/TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a>.<a href="parser/TypeResolver.cs.html#1575db53b7fecb70" class="i field">UsingSystem</a>;
            }
 
            <b>set</b>
            {
                <a href="#e4e6017779e6515d" class="i field">_typeResolutionState</a> = <b>value</b>;
            }
        }
 
        <b>internal</b> <span class="i">IDictionary</span>&lt;<b>string</b>, <span class="i">Type</span>&gt; <a id="1e07cd95bdef9156" href="../R/1e07cd95bdef9156.html" target="n" data-glyph="104,1" class="i property">TypeTable</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal void</b> <a id="b6935dec64b2fcf7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddType</a>(<b>string</b> <span id="r165 rd" class="r165 r">name</span>, <span class="i">Type</span> <span id="r166 rd" class="r166 r">type</span>)
        {
            <b>if</b> (<a href="#1e07cd95bdef9156" class="i property">TypeTable</a> == <b>null</b>)
            {
                <a href="#1e07cd95bdef9156" class="i property">TypeTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Type</span>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
 
            <a href="#1e07cd95bdef9156" class="i property">TypeTable</a>[<span class="r165 r">name</span>] = <span class="r166 r">type</span>;
        }
 
        <b>internal</b> <span class="i">Type</span> <a id="94b4cf2b5d0cb334" href="../R/94b4cf2b5d0cb334.html" target="n" data-glyph="74,1" class="i method">LookupType</a>(<b>string</b> <span id="r167 rd" class="r167 r">name</span>)
        {
            <b>if</b> (<a href="#1e07cd95bdef9156" class="i property">TypeTable</a> == <b>null</b>) <b>return</b> <b>null</b>;
            <span class="i">Type</span> <span id="r168 rd" class="r168 r">result</span>;
            <a href="#1e07cd95bdef9156" class="i property">TypeTable</a>.<span class="i">TryGetValue</span>(<span class="r167 r">name</span>, <b>out</b> <span class="r168 r">result</span>);
            <b>return</b> <span class="r168 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Types
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private members
 
        <b>private static bool</b> <a id="58acb335b66cb83a" href="../R/58acb335b66cb83a.html" target="n" data-glyph="76,1" class="i method">IsFunctionOptionSet</a>(<a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r169 rd" class="r169 r">function</span>, <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r170 rd" class="r170 r">options</span>)
        {
            <b>return</b> (<span class="r169 r">function</span>.<a href="FunctionInfo.cs.html#4eff0d117fdeb729" class="i property">Options</a> &amp; <span class="r170 r">options</span>) != 0;
        }
 
        <b>private static</b> <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <a id="5dc5bf9d4aa11842" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CreateFunction</a>(<b>string</b> <span id="r171 rd" class="r171 r">name</span>, <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r172 rd" class="r172 r">function</span>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r173 rd" class="r173 r">originalFunction</span>,
            <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a> <span id="r174 rd" class="r174 r">options</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r175 rd" class="r175 r">context</span>, <b>string</b> <span id="r176 rd" class="r176 r">helpFile</span>)
        {
            <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r177 rd" class="r177 r">newValue</span> = <b>null</b>;
 
            <b>if</b> (<span class="r174 r">options</span> == <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#d3cd3fca45c40287" class="i field">Unspecified</a>)
            {
                <span class="r174 r">options</span> = <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#76fffaf5453ae116" class="i field">None</a>;
            }
 
            <span class="c">// First use the copy constructors</span>
            <b>if</b> (<span class="r173 r">originalFunction</span> <b>is</b> <a href="FilterInfo.cs.html#945af8143f567881" class="t t">FilterInfo</a>)
            {
                <span class="r177 r">newValue</span> = <b>new</b> <a href="FilterInfo.cs.html#537a8552b440cd54" class="t constructor">FilterInfo</a>(<span class="r171 r">name</span>, (<a href="FilterInfo.cs.html#945af8143f567881" class="t t">FilterInfo</a>)<span class="r173 r">originalFunction</span>);
            }
            <b>else</b> <b>if</b> (<span class="r173 r">originalFunction</span> <b>is</b> <a href="ConfigurationInfo.cs.html#f7e2a2001ad5ccfc" class="t t">ConfigurationInfo</a>)
            {
                <span class="r177 r">newValue</span> = <b>new</b> <a href="ConfigurationInfo.cs.html#ec75ca575789513d" class="t constructor">ConfigurationInfo</a>(<span class="r171 r">name</span>, (<a href="ConfigurationInfo.cs.html#f7e2a2001ad5ccfc" class="t t">ConfigurationInfo</a>)<span class="r173 r">originalFunction</span>);
            }
            <b>else</b> <b>if</b> (<span class="r173 r">originalFunction</span> != <b>null</b>)
            {
                <span class="r177 r">newValue</span> = <b>new</b> <a href="FunctionInfo.cs.html#33bde3af820fdb19" class="t constructor">FunctionInfo</a>(<span class="r171 r">name</span>, <span class="r173 r">originalFunction</span>);
            }
 
            <span class="c">// Then use the creation constructors - workflows don&#39;t get here because the workflow info</span>
            <span class="c">// is created during compilation.</span>
            <b>else</b> <b>if</b> (<span class="r172 r">function</span>.<a href="lang/scriptblock.cs.html#d359ea5ab7ca7a34" class="i property">IsFilter</a>) { <span class="r177 r">newValue</span> = <b>new</b> <a href="FilterInfo.cs.html#e18f37b3f7c686e1" class="t constructor">FilterInfo</a>(<span class="r171 r">name</span>, <span class="r172 r">function</span>, <span class="r174 r">options</span>, <span class="r175 r">context</span>, <span class="r176 r">helpFile</span>); }
            <b>else</b> <b>if</b> (<span class="r172 r">function</span>.<a href="lang/scriptblock.cs.html#9e62a6d46071d521" class="i property">IsConfiguration</a>)
            {
                <span class="r177 r">newValue</span> = <b>new</b> <a href="ConfigurationInfo.cs.html#4fed5ba51a62d236" class="t constructor">ConfigurationInfo</a>(<span class="r171 r">name</span>, <span class="r172 r">function</span>, <span class="r174 r">options</span>, <span class="r175 r">context</span>, <span class="r176 r">helpFile</span>, <span class="r172 r">function</span>.<a href="runtime/CompiledScriptBlock.cs.html#e23a7d51c5f3a7e6" class="i method">IsMetaConfiguration</a>());
            }
            <b>else</b> <span class="r177 r">newValue</span> = <b>new</b> <a href="FunctionInfo.cs.html#6b8cfad5e3507160" class="t constructor">FunctionInfo</a>(<span class="r171 r">name</span>, <span class="r172 r">function</span>, <span class="r174 r">options</span>, <span class="r175 r">context</span>, <span class="r176 r">helpFile</span>);
 
            <b>return</b> <span class="r177 r">newValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Contains the virtual drives for this scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">// Initializing all of the session state items every time we create a new scope causes a measurable</span>
        <span class="c">// performance degradation, so we use lazy initialization for all of them.</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="7ad0d1785167384f" href="../R/7ad0d1785167384f.html" target="n" data-glyph="76,1" class="i method">GetDrives</a>()
        {
            <b>return</b> <a href="#9f5d9664ad1cc50a" class="i field">_drives</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="9f5d9664ad1cc50a" href="../R/9f5d9664ad1cc50a.html" target="n" data-glyph="46,1" class="i field">_drives</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Contains the drives that have been automounted by the system.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">// Initializing all of the session state items every time we create a new scope causes a measurable</span>
        <span class="c">// performance degradation, so we use lazy initialization for all of them.</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="04f8ccfacbc359da" href="../R/04f8ccfacbc359da.html" target="n" data-glyph="76,1" class="i method">GetAutomountedDrives</a>()
        {
            <b>return</b> <a href="#d348fc7fb5f8ce7d" class="i field">_automountedDrives</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="d348fc7fb5f8ce7d" href="../R/d348fc7fb5f8ce7d.html" target="n" data-glyph="46,1" class="i field">_automountedDrives</a>;
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>&gt; <a id="faf742d1998e47c2" href="../R/faf742d1998e47c2.html" target="n" data-glyph="46,1" class="i field">_variables</a>;
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>&gt; <a id="107e48bde2f8f86e" href="../R/107e48bde2f8f86e.html" target="n" data-glyph="76,1" class="i method">GetPrivateVariables</a>()
        {
            <b>if</b> (<a href="#faf742d1998e47c2" class="i field">_variables</a> == <b>null</b>)
            {
                <span class="c">// Create the variables collection with the default parameters</span>
                <a href="#faf742d1998e47c2" class="i field">_variables</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                <span class="c">// Create the default variables in the global scope.</span>
                <span class="c">// If the variable must propagate to each new scope,</span>
                <span class="c">// the AllScope option must be set.</span>
 
                <a href="#b885786a79effcb5" class="i method">AddSessionStateScopeDefaultVariables</a>();
            }
 
            <b>return</b> <a href="#faf742d1998e47c2" class="i field">_variables</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add the built-in variables defined by the session state scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="b885786a79effcb5" href="../R/b885786a79effcb5.html" target="n" data-glyph="74,1" class="i method">AddSessionStateScopeDefaultVariables</a>()
        {
            <b>if</b> (<a href="#ec04fff24436a018" class="i property">Parent</a> == <b>null</b>)
            {
                <span class="c">// Create the default variables that are in every scope</span>
                <span class="c">// These variables will automatically propagate to new</span>
                <span class="c">// scopes since they are marked AllScope.</span>
 
                <a href="#faf742d1998e47c2" class="i field">_variables</a>.<span class="i">Add</span>(<a href="#323137906dd5d8f4" class="i field">s_nullVar</a>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <a href="#323137906dd5d8f4" class="i field">s_nullVar</a>);
                <a href="#faf742d1998e47c2" class="i field">_variables</a>.<span class="i">Add</span>(<a href="#fea3d7b7b7ef85cc" class="i field">s_falseVar</a>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <a href="#fea3d7b7b7ef85cc" class="i field">s_falseVar</a>);
                <a href="#faf742d1998e47c2" class="i field">_variables</a>.<span class="i">Add</span>(<a href="#5c40d19281cd479a" class="i field">s_trueVar</a>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <a href="#5c40d19281cd479a" class="i field">s_trueVar</a>);
            }
            <b>else</b>
            {
                <span class="c">// Propagate all variables that are marked AllScope.</span>
                <b>foreach</b> (<a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r178 rd" class="r178 r">variable</span> <b>in</b> <a href="#ec04fff24436a018" class="i property">Parent</a>.<a href="#107e48bde2f8f86e" class="i method">GetPrivateVariables</a>().<span class="i">Values</span>)
                {
                    <b>if</b> (<span class="r178 r">variable</span>.<a href="ShellVariable.cs.html#9a3a203b3995508f" class="i property">IsAllScope</a>)
                        <a href="#faf742d1998e47c2" class="i field">_variables</a>.<span class="i">Add</span>(<span class="r178 r">variable</span>.<a href="ShellVariable.cs.html#fedaff61e8100bc1" class="i property">Name</a>, <span class="r178 r">variable</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the aliases defined for the session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">// Initializing all of the session state items every time we create a new scope causes a measurable</span>
        <span class="c">// performance degradation, so we use lazy initialization for all of them.</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt; <a id="3fce71a286a9563e" href="../R/3fce71a286a9563e.html" target="n" data-glyph="76,1" class="i method">GetAliases</a>()
        {
            <b>if</b> (<a href="#c5757f3147ec5eb3" class="i field">_alias</a> == <b>null</b>)
            {
                <span class="c">// Create the alias table</span>
                <a href="#c5757f3147ec5eb3" class="i field">_alias</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                <b>if</b> (<a href="#ec04fff24436a018" class="i property">Parent</a> != <b>null</b>)
                {
                    <span class="c">// Propagate all aliases that are marked AllScope</span>
                    <b>foreach</b> (<a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a> <span id="r179 rd" class="r179 r">newAlias</span> <b>in</b> <a href="#ec04fff24436a018" class="i property">Parent</a>.<a href="#3fce71a286a9563e" class="i method">GetAliases</a>().<span class="i">Values</span>)
                    {
                        <b>if</b> ((<span class="r179 r">newAlias</span>.<a href="AliasInfo.cs.html#4efeb840e82b2f90" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) != 0)
                        {
                            <a href="#c5757f3147ec5eb3" class="i field">_alias</a>.<span class="i">Add</span>(<span class="r179 r">newAlias</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r179 r">newAlias</span>);
                        }
                    }
                }
            }
 
            <b>return</b> <a href="#c5757f3147ec5eb3" class="i field">_alias</a>;
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="AliasInfo.cs.html#cf27095b0a2fb6ea" class="t t">AliasInfo</a>&gt; <a id="c5757f3147ec5eb3" href="../R/c5757f3147ec5eb3.html" target="n" data-glyph="46,1" class="i field">_alias</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the functions defined in this scope...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">// Initializing all of the session state items every time we create a new scope causes a measurable</span>
        <span class="c">// performance degradation, so we use lazy initialization for all of them.</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt; <a id="b3f4127c3da10955" href="../R/b3f4127c3da10955.html" target="n" data-glyph="76,1" class="i method">GetFunctions</a>()
        {
            <b>if</b> (<a href="#0ef415974d508169" class="i field">_functions</a> == <b>null</b>)
            {
                <span class="c">// Create the functions table</span>
                <a href="#0ef415974d508169" class="i field">_functions</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                <b>if</b> (<a href="#ec04fff24436a018" class="i property">Parent</a> != <b>null</b> &amp;&amp; <a href="#ec04fff24436a018" class="i property">Parent</a>.<a href="#3c69cd6c248b8a7f" class="i field">_allScopeFunctions</a> != <b>null</b>)
                {
                    <span class="c">// Propagate all functions that are marked AllScope</span>
                    <b>foreach</b> (<a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r180 rd" class="r180 r">newFunc</span> <b>in</b> <a href="#ec04fff24436a018" class="i property">Parent</a>.<a href="#3c69cd6c248b8a7f" class="i field">_allScopeFunctions</a>.<span class="i">Values</span>)
                    {
                        <a href="#0ef415974d508169" class="i field">_functions</a>.<span class="i">Add</span>(<span class="r180 r">newFunc</span>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>, <span class="r180 r">newFunc</span>);
                    }
                }
            }
 
            <b>return</b> <a href="#0ef415974d508169" class="i field">_functions</a>;
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt; <a id="0ef415974d508169" href="../R/0ef415974d508169.html" target="n" data-glyph="46,1" class="i field">_functions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All entries in this table should also be in the normal function</span>
        <span class="c">///</span><span class="c"> table. The entries in this table are automatically propagated</span>
        <span class="c">///</span><span class="c"> to new scopes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">// Initializing all of the session state items every time we create a new scope causes a measurable</span>
        <span class="c">// performance degradation, so we use lazy initialization for all of them.</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt; <a id="0745c59201878810" href="../R/0745c59201878810.html" target="n" data-glyph="76,1" class="i method">GetAllScopeFunctions</a>()
        {
            <b>if</b> (<a href="#3c69cd6c248b8a7f" class="i field">_allScopeFunctions</a> == <b>null</b>)
            {
                <b>if</b> (<a href="#ec04fff24436a018" class="i property">Parent</a> != <b>null</b> &amp;&amp; <a href="#ec04fff24436a018" class="i property">Parent</a>.<a href="#3c69cd6c248b8a7f" class="i field">_allScopeFunctions</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#ec04fff24436a018" class="i property">Parent</a>.<a href="#3c69cd6c248b8a7f" class="i field">_allScopeFunctions</a>;
                }
 
                <span class="c">// Create the &quot;AllScope&quot; functions table</span>
                <a href="#3c69cd6c248b8a7f" class="i field">_allScopeFunctions</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
 
            <b>return</b> <a href="#3c69cd6c248b8a7f" class="i field">_allScopeFunctions</a>;
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>&gt; <a id="3c69cd6c248b8a7f" href="../R/3c69cd6c248b8a7f.html" target="n" data-glyph="46,1" class="i field">_allScopeFunctions</a>;
 
        <span class="c">// The value for the cmdlet cache is a list of CmdletInfo objects because of the following reason</span>
        <span class="c">// Import-Module Mod1 -Cmdlet foo</span>
        <span class="c">// Import-Module Mod2 -Cmdlet foo</span>
        <span class="c">// Remove-Module Mod2</span>
        <span class="c">// foo</span>
        <span class="c">// The command &quot;foo&quot; from Mod1 is invoked.</span>
        <span class="c">// If we do not maintain a list, we break this behavior as we would have over-written Mod1\foo with Mod2\foo and then Mod2 is removed, we have nothing.</span>
 
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;&gt; <a id="6d809ca76cc7163c" href="../R/6d809ca76cc7163c.html" target="n" data-glyph="46,1" class="i field">_cmdlets</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All entries in this table should also be in the normal cmdlet</span>
        <span class="c">///</span><span class="c"> table. The entries in this table are automatically propagated</span>
        <span class="c">///</span><span class="c"> to new scopes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;&gt; <a id="63d27ffe9672b552" href="../R/63d27ffe9672b552.html" target="n" data-glyph="46,1" class="i field">_allScopeCmdlets</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="CmdletInfo.cs.html#9492ffc9968f644d" class="t t">CmdletInfo</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The variable that represents $true in the language.</span>
        <span class="c">///</span><span class="c"> We don&#39;t need a new reference in each scope since it</span>
        <span class="c">///</span><span class="c"> is ScopedItemOptions.Constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <a id="5c40d19281cd479a" href="../R/5c40d19281cd479a.html" target="n" data-glyph="46,1" class="i field">s_trueVar</a> =
            <b>new</b> <a href="ShellVariable.cs.html#46f590f26072d557" class="t constructor">PSVariable</a>(
                <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#b905047e9e658caf" class="i field">True</a>,
                <b>true</b>,
                <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                <span class="s">&quot;Boolean True&quot;</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The variable that represents $false in the language.</span>
        <span class="c">///</span><span class="c"> We don&#39;t need a new reference in each scope since it</span>
        <span class="c">///</span><span class="c"> is ScopedItemOptions.Constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <a id="fea3d7b7b7ef85cc" href="../R/fea3d7b7b7ef85cc.html" target="n" data-glyph="46,1" class="i field">s_falseVar</a> =
            <b>new</b> <a href="ShellVariable.cs.html#46f590f26072d557" class="t constructor">PSVariable</a>(
                <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#9d352df8e53d9d6b" class="i field">False</a>,
                <b>false</b>,
                <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#798b6fcea4620b5d" class="i field">Constant</a> | <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>,
                <span class="s">&quot;Boolean False&quot;</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The variable that represents $null in the language.</span>
        <span class="c">///</span><span class="c"> We don&#39;t need a new reference in each scope since it</span>
        <span class="c">///</span><span class="c"> is ScopedItemOptions.Constant.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <a href="ShellVariable.cs.html#1d73190f8da7c3d2" class="t t">NullVariable</a> <a id="323137906dd5d8f4" href="../R/323137906dd5d8f4.html" target="n" data-glyph="46,1" class="i field">s_nullVar</a> =
            <b>new</b> <a href="ShellVariable.cs.html#599291ba1682f231" class="t constructor">NullVariable</a>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Alias mapping
 
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<b>string</b>&gt;&gt; <a id="ee5e2f5e88cb3ed9" href="../R/ee5e2f5e88cb3ed9.html" target="n" data-glyph="46,1" class="i field">_commandsToAliasesCache</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<b>string</b>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the aliases by command name (used by metadata-driven help)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r181 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="f3eb03ab73e691e9" href="../R/f3eb03ab73e691e9.html" target="n" data-glyph="74,1" class="i method">GetAliasesByCommandName</a>(<b>string</b> <span id="r181 rd" class="r181 r">command</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r182 rd" class="r182 r">commandsToAliases</span>;
            <b>if</b> (<a href="#ee5e2f5e88cb3ed9" class="i field">_commandsToAliasesCache</a>.<span class="i">TryGetValue</span>(<span class="r181 r">command</span>, <b>out</b> <span class="r182 r">commandsToAliases</span>))
            {
                <b>foreach</b> (<b>string</b> <span id="r183 rd" class="r183 r">str</span> <b>in</b> <span class="r182 r">commandsToAliases</span>)
                {
                    <b>yield</b> <b>return</b> <span class="r183 r">str</span>;
                }
            }
 
            <b>yield</b> <b>break</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r184 r">alias</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r185 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8d946f9545c3da25" href="../R/8d946f9545c3da25.html" target="n" data-glyph="76,1" class="i method">AddAliasToCache</a>(<b>string</b> <span id="r184 rd" class="r184 r">alias</span>, <b>string</b> <span id="r185 rd" class="r185 r">value</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r186 rd" class="r186 r">existingAliases</span>;
            <b>if</b> (!<a href="#ee5e2f5e88cb3ed9" class="i field">_commandsToAliasesCache</a>.<span class="i">TryGetValue</span>(<span class="r185 r">value</span>, <b>out</b> <span class="r186 r">existingAliases</span>))
            {
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r187 rd" class="r187 r">list</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                <span class="r187 r">list</span>.<span class="i">Add</span>(<span class="r184 r">alias</span>);
                <a href="#ee5e2f5e88cb3ed9" class="i field">_commandsToAliasesCache</a>.<span class="i">Add</span>(<span class="r185 r">value</span>, <span class="r187 r">list</span>);
            }
            <b>else</b>
            {
                <b>if</b> (!<span class="r186 r">existingAliases</span>.<span class="i">Contains</span>(<span class="r184 r">alias</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r186 r">existingAliases</span>.<span class="i">Add</span>(<span class="r184 r">alias</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r188 r">alias</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r189 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="bd3ff93df4625767" href="../R/bd3ff93df4625767.html" target="n" data-glyph="76,1" class="i method">RemoveAliasFromCache</a>(<b>string</b> <span id="r188 rd" class="r188 r">alias</span>, <b>string</b> <span id="r189 rd" class="r189 r">value</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r190 rd" class="r190 r">list</span>;
            <b>if</b> (!<a href="#ee5e2f5e88cb3ed9" class="i field">_commandsToAliasesCache</a>.<span class="i">TryGetValue</span>(<span class="r189 r">value</span>, <b>out</b> <span class="r190 r">list</span>))
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r190 r">list</span>.<span class="i">Count</span> &lt;= 1)
            {
                <a href="#ee5e2f5e88cb3ed9" class="i field">_commandsToAliasesCache</a>.<span class="i">Remove</span>(<span class="r189 r">value</span>);
            }
            <b>else</b>
            {
                <b>string</b> <span id="r191 rd" class="r191 r">itemToRemove</span> = <span class="r190 r">list</span>.<span class="i">Find</span>(<span id="r192 rd" class="r192 r">item</span> =&gt; <span class="r192 r">item</span>.<span class="i">Equals</span>(<span class="r188 r">alias</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
                <b>if</b> (<span class="r191 r">itemToRemove</span> != <b>null</b>)
                {
                    <span class="r190 r">list</span>.<span class="i">Remove</span>(<span class="r191 r">itemToRemove</span>);
                }
            }
        }
 
        <b>private void</b> <a id="020a626e18041eab" href="../R/020a626e18041eab.html" target="n" data-glyph="76,1" class="i method">CheckVariableChangeInConstrainedLanguage</a>(<a href="ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a> <span id="r193 rd" class="r193 r">variable</span>)
        {
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r194 rd" class="r194 r">context</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>if</b> (<span class="r194 r">context</span>?.<a href="ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>)
            {
                <b>if</b> ((<span class="r193 r">variable</span>.<a href="ShellVariable.cs.html#388974547ffee0d7" class="i property">Options</a> &amp; <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>) == <a href="ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="ShellVariable.cs.html#6cfa31306085b107" class="i field">AllScope</a>)
                {
                    <span class="c">// Don&#39;t let people set AllScope variables in ConstrainedLanguage, as they can be used to</span>
                    <span class="c">// interfere with the session state of trusted commands.</span>
                    <b>throw</b> <b>new</b> <a href="../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
                }
 
                <span class="c">// Mark untrusted values for assignments to &#39;Global:&#39; variables, and &#39;Script:&#39; variables in</span>
                <span class="c">// a module scope, if it&#39;s necessary.</span>
                <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="ExecutionContext.cs.html#c15a3f5eeeb61bab" class="i method">MarkObjectAsUntrustedForVariableAssignment</a>(<span class="r193 r">variable</span>, <a href="#460261155e0163cb" class="k">this</a>, <span class="r194 r">context</span>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
