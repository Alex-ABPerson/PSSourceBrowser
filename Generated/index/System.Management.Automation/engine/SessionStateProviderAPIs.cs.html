<!DOCTYPE html>
<html><head><title>SessionStateProviderAPIs.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1560);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/SessionStateProviderAPIs.cs" target="_top">engine\SessionStateProviderAPIs.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Provider</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Holds the state of a PowerShell session.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed</b> <a href="../P/2dc1bd90a8299178.html" target="s" class="k">partial</a> <b>class</b> <a id="2dc1bd90a8299178" href="../R/2dc1bd90a8299178.html" target="n" data-glyph="2,0" class="t t">SessionStateInternal</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the providers. Any provider in this collection can</span>
        <span class="c">///</span><span class="c"> have drives in any scope in session state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;&gt; <a id="12503655514931e1" href="../R/12503655514931e1.html" target="n" data-glyph="104,1" class="i property">Providers</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a> == <a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>)
                    <b>return</b> <a href="#c30ea9dc89dba3e5" class="i field">_providers</a>;
                <b>return</b> <a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>.<a href="#12503655514931e1" class="i property">Providers</a>;
            }
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;&gt; <a id="c30ea9dc89dba3e5" href="../R/c30ea9dc89dba3e5.html" target="n" data-glyph="46,1" class="i field">_providers</a> =
            <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;&gt;(
                    <a href="SessionStateUtils.cs.html#c8557f4210bffbf9" class="t t">SessionStateConstants</a>.<a href="SessionStateUtils.cs.html#940e36821586d4bf" class="i field">DefaultDictionaryCapacity</a>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stores the current working drive for each provider. This</span>
        <span class="c">///</span><span class="c"> allows for retrieving the current working directory for each</span>
        <span class="c">///</span><span class="c"> individual provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Dictionary</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="5501f560faf2de0a" href="../R/5501f560faf2de0a.html" target="n" data-glyph="104,1" class="i property">ProvidersCurrentWorkingDrive</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a> == <a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>)
                    <b>return</b> <a href="#cade387ee97271be" class="i field">_providersCurrentWorkingDrive</a>;
                <b>return</b> <a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#95bc6698d12886ee" class="i property">TopLevelSessionState</a>.<a href="#5501f560faf2de0a" class="i property">ProvidersCurrentWorkingDrive</a>;
            }
        }
 
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="cade387ee97271be" href="../R/cade387ee97271be.html" target="n" data-glyph="46,1" class="i field">_providersCurrentWorkingDrive</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>, <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Entrypoint used by to add a provider to the current session state</span>
        <span class="c">///</span><span class="c"> based on a SessionStateProviderEntry.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">providerEntry</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="365f0e3eed5536c0" href="../R/365f0e3eed5536c0.html" target="n" data-glyph="74,1" class="i method">AddSessionStateEntry</a>(<a href="InitialSessionState.cs.html#236a07b6fd3f0e39" class="t t">SessionStateProviderEntry</a> <span id="r0 rd" class="r0 r">providerEntry</span>)
        {
            <a href="#26fe6b6296481f80" class="i method">AddProvider</a>(<span class="r0 r">providerEntry</span>.<a href="InitialSessionState.cs.html#bcdd2ec5da2607ba" class="i property">ImplementingType</a>,
                        <span class="r0 r">providerEntry</span>.<a href="InitialSessionState.cs.html#c5f3f5b848ea98cd" class="i property">Name</a>,
                        <span class="r0 r">providerEntry</span>.<a href="InitialSessionState.cs.html#ec3922c91455de72" class="i property">HelpFileName</a>,
                        <span class="r0 r">providerEntry</span>.<a href="InitialSessionState.cs.html#a63d54bd9a0897a7" class="i property">PSSnapIn</a>,
                        <span class="r0 r">providerEntry</span>.<a href="InitialSessionState.cs.html#a3328f1f3a3a9605" class="i property">Module</a>);
        }
 
        <b>private</b> <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <a id="26fe6b6296481f80" href="../R/26fe6b6296481f80.html" target="n" data-glyph="76,1" class="i method">AddProvider</a>(<span class="i">Type</span> <span id="r1 rd" class="r1 r">implementingType</span>, <b>string</b> <span id="r2 rd" class="r2 r">name</span>, <b>string</b> <span id="r3 rd" class="r3 r">helpFileName</span>, <a href="../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r4 rd" class="r4 r">psSnapIn</span>, <a href="Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r5 rd" class="r5 r">module</span>)
        {
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r6 rd" class="r6 r">provider</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r6 r">provider</span> =
                    <b>new</b> <a href="DataStoreAdapterProvider.cs.html#a2241984115134f8" class="t constructor">ProviderInfo</a>(
                        <b>new</b> <a href="SessionStatePublic.cs.html#45f5fbc7afc57ae4" class="t constructor">SessionState</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>),
                        <span class="r1 r">implementingType</span>,
                        <span class="r2 r">name</span>,
                        <span class="r3 r">helpFileName</span>,
                        <span class="r4 r">psSnapIn</span>);
                <span class="r6 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#f34a3a471d68849c" class="i method">SetModule</a>(<span class="r5 r">module</span>);
 
                <a href="#4df468eaf1170de0" class="i method">NewProvider</a>(<span class="r6 r">provider</span>);
 
                <span class="c">// Log the provider start event</span>
 
                <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#302502e120276213" class="i method">LogProviderLifecycleEvent</a>(
                    <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>,
                    <span class="r6 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>,
                    <a href="../logging/MshLog.cs.html#74ca7b7b1cc6cf5c" class="t t">ProviderState</a>.<a href="../logging/MshLog.cs.html#378814869092522e" class="i field">Started</a>);
            }
            <b>catch</b> (<a href="lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a> <span id="r7 rd" class="r7 r">sessionStateException</span>)
            {
                <b>if</b> (<span class="r7 r">sessionStateException</span>.<span class="i">GetType</span>() == <b>typeof</b>(<a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a>))
                {
                    <b>throw</b>;
                }
                <b>else</b>
                {
                    <span class="c">// NTRAID#Windows OS Bugs-1009281-2004/02/11-JeffJon</span>
                    <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<span class="i">ReportEngineStartupError</span>(<span class="r7 r">sessionStateException</span>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r8 rd" class="r8 r">e</span>) <span class="c">// Catch-all OK, 3rd party callout</span>
            {
                <span class="c">// NTRAID#Windows OS Bugs-1009281-2004/02/11-JeffJon</span>
                <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>.<a href="ExecutionContext.cs.html#dc6d233d4e064eaa" class="i method">ReportEngineStartupError</a>(<span class="r8 r">e</span>);
            }
 
            <b>return</b> <span class="r6 r">provider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines the appropriate provider for the drive and then calls the NewDrive</span>
        <span class="c">///</span><span class="c"> method of that provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">drive</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The drive to have the provider verify.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command context under which the drive is being added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">resolvePathIfPossible</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the drive root will be resolved as an MSH path before verifying with</span>
        <span class="c">///</span><span class="c"> the provider. If false, the path is assumed to be a provider-internal path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The instance of the drive to be added as approved by the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the provider is not a DriveCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider for the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">drive</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> could not be found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the provider throws an exception while validating the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private</b> <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <a id="cd42a4055289a2b6" href="../R/cd42a4055289a2b6.html" target="n" data-glyph="76,1" class="i method">ValidateDriveWithProvider</a>(<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r9 rd" class="r9 r">drive</span>, <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r10 rd" class="r10 r">context</span>, <b>bool</b> <span id="r11 rd" class="r11 r">resolvePathIfPossible</span>)
        {
            <span class="i n">Dbg</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r9 r">drive</span> != <b>null</b>,
                <span class="s">&quot;drive should have been validated by the caller&quot;</span>);
 
            <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <span id="r12 rd" class="r12 r">namespaceProvider</span> =
                <a href="#684b564cf58f4962" class="i method">GetDriveProviderInstance</a>(<span class="r9 r">drive</span>.<a href="DataStoreAdapter.cs.html#599e6ea3519fc2d6" class="i property">Provider</a>);
 
            <b>return</b> <a href="#f0fa1bdc83f8c1ec" class="i method">ValidateDriveWithProvider</a>(<span class="r12 r">namespaceProvider</span>, <span class="r9 r">drive</span>, <span class="r10 r">context</span>, <span class="r11 r">resolvePathIfPossible</span>);
        }
 
        <b>private</b> <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <a id="f0fa1bdc83f8c1ec" href="../R/f0fa1bdc83f8c1ec.html" target="n" data-glyph="76,1" class="i method">ValidateDriveWithProvider</a>(
            <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <span id="r13 rd" class="r13 r">driveProvider</span>,
            <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r14 rd" class="r14 r">drive</span>,
            <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r15 rd" class="r15 r">context</span>,
            <b>bool</b> <span id="r16 rd" class="r16 r">resolvePathIfPossible</span>)
        {
            <span class="i n">Dbg</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r14 r">drive</span> != <b>null</b>,
                <span class="s">&quot;drive should have been validated by the caller&quot;</span>);
 
            <span class="i n">Dbg</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r13 r">driveProvider</span> != <b>null</b>,
                <span class="s">&quot;driveProvider should have been validated by the caller&quot;</span>);
 
            <span class="c">// Mark the drive as being created so that the provider can modify the</span>
            <span class="c">// root if necessary</span>
 
            <span class="r14 r">drive</span>.<a href="DataStoreAdapter.cs.html#fa0b26c8d8c60c3b" class="i property">DriveBeingCreated</a> = <b>true</b>;
 
            <span class="c">// Only try to resolve the root as an MSH path if there is a current drive.</span>
 
            <b>if</b> (<a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a> != <b>null</b> &amp;&amp; <span class="r16 r">resolvePathIfPossible</span>)
            {
                <b>string</b> <span id="r17 rd" class="r17 r">newRoot</span> = <a href="SessionStateDriveAPIs.cs.html#1c30c835cbe1588b" class="i method">GetProviderRootFromSpecifiedRoot</a>(<span class="r14 r">drive</span>.<a href="DataStoreAdapter.cs.html#6c8f4db73167e8f9" class="i property">Root</a>, <span class="r14 r">drive</span>.<a href="DataStoreAdapter.cs.html#599e6ea3519fc2d6" class="i property">Provider</a>);
 
                <b>if</b> (<span class="r17 r">newRoot</span> != <b>null</b>)
                {
                    <span class="r14 r">drive</span>.<a href="DataStoreAdapter.cs.html#93b17517c14f538e" class="i method">SetRoot</a>(<span class="r17 r">newRoot</span>);
                }
            }
 
            <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r18 rd" class="r18 r">result</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r18 r">result</span> = <span class="r13 r">driveProvider</span>.<a href="../namespaces/DriveProviderBase.cs.html#2f793e258348274f" class="i method">NewDrive</a>(<span class="r14 r">drive</span>, <span class="r15 r">context</span>);
            }
            <b>catch</b> (<a href="lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r19 rd" class="r19 r">e</span>) <span class="c">// Catch-all OK, 3rd party callout</span>
            {
                <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r20 rd" class="r20 r">pie</span> =
                    <span class="i">NewProviderInvocationException</span>(
                        <span class="s">&quot;NewDriveProviderException&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">NewDriveProviderException</span>,
                        <span class="r13 r">driveProvider</span>.<a href="../namespaces/ProviderBase.cs.html#6129ef83671ead76" class="i property">ProviderInfo</a>,
                        <span class="r14 r">drive</span>.<a href="DataStoreAdapter.cs.html#6c8f4db73167e8f9" class="i property">Root</a>,
                        <span class="r19 r">e</span>);
                <span class="r15 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#97661a296df11e6d" class="i method">WriteError</a>(
                    <b>new</b> <span class="t">ErrorRecord</span>(
                        <span class="r20 r">pie</span>.<a href="../utils/SessionStateExceptions.cs.html#14349d35e06aecf0" class="i property">ErrorRecord</a>,
                        <span class="r20 r">pie</span>));
            }
            <b>finally</b>
            {
                <span class="r14 r">drive</span>.<a href="DataStoreAdapter.cs.html#fa0b26c8d8c60c3b" class="i property">DriveBeingCreated</a> = <b>false</b>;
            }
 
            <b>return</b> <span class="r18 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of a provider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">providerId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The identifier for the provider to return an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the specified provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> refers to a provider that doesn&#39;t exist or</span>
        <span class="c">///</span><span class="c"> the name passed matched multiple providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <a id="e8e87f501c578713" href="../R/e8e87f501c578713.html" target="n" data-glyph="74,1" class="i method">GetProviderInstance</a>(<b>string</b> <span id="r21 rd" class="r21 r">providerId</span>)
        {
            <b>if</b> (<span class="r21 r">providerId</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r21 r">providerId</span>));
            }
 
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r22 rd" class="r22 r">provider</span> = <a href="#02cfdb64abb0b450" class="i method">GetSingleProvider</a>(<span class="r21 r">providerId</span>);
 
            <b>return</b> <a href="#61c4fceacab681fd" class="i method">GetProviderInstance</a>(<span class="r22 r">provider</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of a provider given the provider information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to return an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the specified provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <a id="61c4fceacab681fd" href="../R/61c4fceacab681fd.html" target="n" data-glyph="74,1" class="i method">GetProviderInstance</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r23 rd" class="r23 r">provider</span>)
        {
            <b>if</b> (<span class="r23 r">provider</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r23 r">provider</span>));
            }
 
            <b>return</b> <span class="r23 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#dd6074faa9bf93c1" class="i method">CreateInstance</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an exception for the case where the provider name matched multiple providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">matchingProviders</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ProviderInfo of the possible matches.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An exception representing the error with a message stating which providers are possible matches.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../utils/SessionStateExceptions.cs.html#5664cd43f9e1d820" class="t t">ProviderNameAmbiguousException</a> <a id="ded65b853327f190" href="../R/ded65b853327f190.html" target="n" data-glyph="74,1" class="i method">NewAmbiguousProviderName</a>(<b>string</b> <span id="r24 rd" class="r24 r">name</span>, <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r25 rd" class="r25 r">matchingProviders</span>)
        {
            <b>string</b> <span id="r26 rd" class="r26 r">possibleMatches</span> = <a href="#4c8e65ee106db6d4" class="i method">GetPossibleMatches</a>(<span class="r25 r">matchingProviders</span>);
 
            <a href="../utils/SessionStateExceptions.cs.html#5664cd43f9e1d820" class="t t">ProviderNameAmbiguousException</a> <span id="r27 rd" class="r27 r">e</span> =
                <b>new</b> <span class="t">ProviderNameAmbiguousException</span>(
                    <span class="r24 r">name</span>,
                    <span class="s">&quot;ProviderNameAmbiguous&quot;</span>,
                    <span class="i">SessionStateStrings</span>.<span class="i">ProviderNameAmbiguous</span>,
                    <span class="r25 r">matchingProviders</span>,
                    <span class="r26 r">possibleMatches</span>);
 
            <b>return</b> <span class="r27 r">e</span>;
        }
 
        <b>private static string</b> <a id="4c8e65ee106db6d4" href="../R/4c8e65ee106db6d4.html" target="n" data-glyph="76,1" class="i method">GetPossibleMatches</a>(<span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r28 rd" class="r28 r">matchingProviders</span>)
        {
            <span class="i">StringBuilder</span> <span id="r29 rd" class="r29 r">possibleMatches</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>foreach</b> (<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r30 rd" class="r30 r">matchingProvider</span> <b>in</b> <span class="r28 r">matchingProviders</span>)
            {
                <span class="r29 r">possibleMatches</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                <span class="r29 r">possibleMatches</span>.<span class="i">Append</span>(<span class="r30 r">matchingProvider</span>.<a href="DataStoreAdapterProvider.cs.html#91a8d08ee3ba5a61" class="i property">FullName</a>);
            }
 
            <b>return</b> <span class="r29 r">possibleMatches</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an DriveCmdletProvider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">providerId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider ID of the provider to get an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a DriveCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> refers to a provider that doesn&#39;t exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <a id="906127de1c02f908" href="../R/906127de1c02f908.html" target="n" data-glyph="74,1" class="i method">GetDriveProviderInstance</a>(<b>string</b> <span id="r31 rd" class="r31 r">providerId</span>)
        {
            <b>if</b> (<span class="r31 r">providerId</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r31 r">providerId</span>));
            }
 
            <b>if</b> (!(<a href="#e8e87f501c578713" class="i method">GetProviderInstance</a>(<span class="r31 r">providerId</span>) <b>is</b> <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <span id="r32 rd" class="r32 r">driveCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">DriveCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r32 r">driveCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an DriveCmdletProvider given the provider information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to get an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a DriveCmdletProvider for the specified provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <a id="684b564cf58f4962" href="../R/684b564cf58f4962.html" target="n" data-glyph="74,1" class="i method">GetDriveProviderInstance</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r33 rd" class="r33 r">provider</span>)
        {
            <b>if</b> (<span class="r33 r">provider</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r33 r">provider</span>));
            }
 
            <b>if</b> (!(<a href="#61c4fceacab681fd" class="i method">GetProviderInstance</a>(<span class="r33 r">provider</span>) <b>is</b> <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <span id="r34 rd" class="r34 r">driveCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">DriveCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r34 r">driveCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an DriveCmdletProvider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">providerInstance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The instance of the provider to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a DriveCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from DriveCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <a id="7ff1ab83334142fd" href="../R/7ff1ab83334142fd.html" target="n" data-glyph="76,1" class="i method">GetDriveProviderInstance</a>(<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <span id="r35 rd" class="r35 r">providerInstance</span>)
        {
            <b>if</b> (<span class="r35 r">providerInstance</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r35 r">providerInstance</span>));
            }
 
            <b>if</b> (!(<span class="r35 r">providerInstance</span> <b>is</b> <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <span id="r36 rd" class="r36 r">driveCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">DriveCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r36 r">driveCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an ItemCmdletProvider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">providerId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider ID of the provider to get an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a ItemCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> refers to a provider that doesn&#39;t exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/ItemProviderBase.cs.html#ca858520f083a7df" class="t t">ItemCmdletProvider</a> <a id="2ba9b60cdb89c4fa" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetItemProviderInstance</a>(<b>string</b> <span id="r37 rd" class="r37 r">providerId</span>)
        {
            <b>if</b> (<span class="r37 r">providerId</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r37 r">providerId</span>));
            }
 
            <b>if</b> (!(<a href="#e8e87f501c578713" class="i method">GetProviderInstance</a>(<span class="r37 r">providerId</span>) <b>is</b> <a href="../namespaces/ItemProviderBase.cs.html#ca858520f083a7df" class="t t">ItemCmdletProvider</a> <span id="r38 rd" class="r38 r">itemCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">ItemCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r38 r">itemCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an ItemCmdletProvider given the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to get an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a ItemCmdletProvider for the specified provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/ItemProviderBase.cs.html#ca858520f083a7df" class="t t">ItemCmdletProvider</a> <a id="1401b5f1c0abb4b4" href="../R/1401b5f1c0abb4b4.html" target="n" data-glyph="74,1" class="i method">GetItemProviderInstance</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r39 rd" class="r39 r">provider</span>)
        {
            <b>if</b> (<span class="r39 r">provider</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r39 r">provider</span>));
            }
 
            <b>if</b> (!(<a href="#61c4fceacab681fd" class="i method">GetProviderInstance</a>(<span class="r39 r">provider</span>) <b>is</b> <a href="../namespaces/ItemProviderBase.cs.html#ca858520f083a7df" class="t t">ItemCmdletProvider</a> <span id="r40 rd" class="r40 r">itemCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">ItemCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r40 r">itemCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an ItemCmdletProvider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">providerInstance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The instance of the provider to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a ItemCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from ItemCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../namespaces/ItemProviderBase.cs.html#ca858520f083a7df" class="t t">ItemCmdletProvider</a> <a id="084bbed06e1cf0ce" href="../R/084bbed06e1cf0ce.html" target="n" data-glyph="76,1" class="i method">GetItemProviderInstance</a>(<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <span id="r41 rd" class="r41 r">providerInstance</span>)
        {
            <b>if</b> (<span class="r41 r">providerInstance</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r41 r">providerInstance</span>));
            }
 
            <b>if</b> (!(<span class="r41 r">providerInstance</span> <b>is</b> <a href="../namespaces/ItemProviderBase.cs.html#ca858520f083a7df" class="t t">ItemCmdletProvider</a> <span id="r42 rd" class="r42 r">itemCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">ItemCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r42 r">itemCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an ContainerCmdletProvider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">providerId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider ID of the provider to get an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a ContainerCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">providerId</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> refers to a provider that doesn&#39;t exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/ContainerProviderBase.cs.html#bfc85492b760e757" class="t t">ContainerCmdletProvider</a> <a id="56a05a4faf9f9be0" href="../R/56a05a4faf9f9be0.html" target="n" data-glyph="74,1" class="i method">GetContainerProviderInstance</a>(<b>string</b> <span id="r43 rd" class="r43 r">providerId</span>)
        {
            <b>if</b> (<span class="r43 r">providerId</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r43 r">providerId</span>));
            }
 
            <b>if</b> (!(<a href="#e8e87f501c578713" class="i method">GetProviderInstance</a>(<span class="r43 r">providerId</span>) <b>is</b> <a href="../namespaces/ContainerProviderBase.cs.html#bfc85492b760e757" class="t t">ContainerCmdletProvider</a> <span id="r44 rd" class="r44 r">containerCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">ContainerCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r44 r">containerCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an ContainerCmdletProvider given the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to get an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a ContainerCmdletProvider for the specified provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/ContainerProviderBase.cs.html#bfc85492b760e757" class="t t">ContainerCmdletProvider</a> <a id="effde0c1f75d8b39" href="../R/effde0c1f75d8b39.html" target="n" data-glyph="74,1" class="i method">GetContainerProviderInstance</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r45 rd" class="r45 r">provider</span>)
        {
            <b>if</b> (<span class="r45 r">provider</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r45 r">provider</span>));
            }
 
            <b>if</b> (!(<a href="#61c4fceacab681fd" class="i method">GetProviderInstance</a>(<span class="r45 r">provider</span>) <b>is</b> <a href="../namespaces/ContainerProviderBase.cs.html#bfc85492b760e757" class="t t">ContainerCmdletProvider</a> <span id="r46 rd" class="r46 r">containerCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">ContainerCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r46 r">containerCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an ContainerCmdletProvider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">providerInstance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The instance of the provider to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a ContainerCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from ContainerCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../namespaces/ContainerProviderBase.cs.html#bfc85492b760e757" class="t t">ContainerCmdletProvider</a> <a id="cac72cf8ba4cbbc5" href="../R/cac72cf8ba4cbbc5.html" target="n" data-glyph="76,1" class="i method">GetContainerProviderInstance</a>(<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <span id="r47 rd" class="r47 r">providerInstance</span>)
        {
            <b>if</b> (<span class="r47 r">providerInstance</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r47 r">providerInstance</span>));
            }
 
            <b>if</b> (!(<span class="r47 r">providerInstance</span> <b>is</b> <a href="../namespaces/ContainerProviderBase.cs.html#bfc85492b760e757" class="t t">ContainerCmdletProvider</a> <span id="r48 rd" class="r48 r">containerCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">ContainerCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r48 r">containerCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an NavigationCmdletProvider given the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to get an instance of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a NavigationCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../namespaces/NavigationProviderBase.cs.html#7d31476313596b0b" class="t t">NavigationCmdletProvider</a> <a id="a870c6ca8f207d3d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetNavigationProviderInstance</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r49 rd" class="r49 r">provider</span>)
        {
            <b>if</b> (<span class="r49 r">provider</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r49 r">provider</span>));
            }
 
            <b>if</b> (!(<a href="#61c4fceacab681fd" class="i method">GetProviderInstance</a>(<span class="r49 r">provider</span>) <b>is</b> <a href="../namespaces/NavigationProviderBase.cs.html#7d31476313596b0b" class="t t">NavigationCmdletProvider</a> <span id="r50 rd" class="r50 r">navigationCmdletProvider</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">NavigationCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r50 r">navigationCmdletProvider</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of an NavigationCmdletProvider given the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">providerInstance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The instance of the provider to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">acceptNonContainerProviders</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specify True if the method should just return the Path if the</span>
        <span class="c">///</span><span class="c"> provider doesn&#39;t support container overloads.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of a NavigationCmdletProvider for the specified provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">providerInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is not for a provider</span>
        <span class="c">///</span><span class="c"> that is derived from NavigationCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../namespaces/NavigationProviderBase.cs.html#7d31476313596b0b" class="t t">NavigationCmdletProvider</a> <a id="ca7553f60c3e8f50" href="../R/ca7553f60c3e8f50.html" target="n" data-glyph="76,1" class="i method">GetNavigationProviderInstance</a>(<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <span id="r51 rd" class="r51 r">providerInstance</span>, <b>bool</b> <span id="r52 rd" class="r52 r">acceptNonContainerProviders</span>)
        {
            <b>if</b> (<span class="r51 r">providerInstance</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r51 r">providerInstance</span>));
            }
 
            <a href="../namespaces/NavigationProviderBase.cs.html#7d31476313596b0b" class="t t">NavigationCmdletProvider</a> <span id="r53 rd" class="r53 r">navigationCmdletProvider</span> =
                <span class="r51 r">providerInstance</span> <b>as</b> <a href="../namespaces/NavigationProviderBase.cs.html#7d31476313596b0b" class="t t">NavigationCmdletProvider</a>;
 
            <b>if</b> ((<span class="r53 r">navigationCmdletProvider</span> == <b>null</b>) &amp;&amp; (!<span class="r52 r">acceptNonContainerProviders</span>))
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewNotSupportedException</span>(<span class="i">SessionStateStrings</span>.<span class="i">NavigationCmdletProvider_NotSupported</span>);
            }
 
            <b>return</b> <span class="r53 r">navigationCmdletProvider</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> GetProvider
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the specified CmdletProvider is loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the CmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the CmdletProvider is loaded, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="dc359a601ce02a89" href="../R/dc359a601ce02a89.html" target="n" data-glyph="74,1" class="i method">IsProviderLoaded</a>(<b>string</b> <span id="r54 rd" class="r54 r">name</span>)
        {
            <b>bool</b> <span id="r55 rd" class="r55 r">result</span> = <b>false</b>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r54 r">name</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r54 r">name</span>));
            }
 
            <span class="c">// Get the provider from the providers container</span>
 
            <b>try</b>
            {
                <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r56 rd" class="r56 r">providerInfo</span> = <a href="#02cfdb64abb0b450" class="i method">GetSingleProvider</a>(<span class="r54 r">name</span>);
 
                <span class="r55 r">result</span> = <span class="r56 r">providerInfo</span> != <b>null</b>;
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a>)
            {
            }
 
            <b>return</b> <span class="r55 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the provider of the specified name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the provider to retrieve</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider of the given name</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider with the specified </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> could not be found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <a id="d5d3002ebd62e68a" href="../R/d5d3002ebd62e68a.html" target="n" data-glyph="74,1" class="i method">GetProvider</a>(<b>string</b> <span id="r57 rd" class="r57 r">name</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r57 r">name</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r57 r">name</span>));
            }
 
            <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a> <span id="r58 rd" class="r58 r">providerName</span> = <a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a>.<span class="i">GetInstance</span>(<span class="r57 r">name</span>);
 
            <b>if</b> (<span class="r58 r">providerName</span> == <b>null</b>)
            {
                <a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a> <span id="r59 rd" class="r59 r">e</span> =
                 <b>new</b> <span class="t">ProviderNotFoundException</span>(
                     <span class="r57 r">name</span>,
                     <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                     <span class="s">&quot;ProviderNotFoundBadFormat&quot;</span>,
                     <span class="i">SessionStateStrings</span>.<span class="i">ProviderNotFoundBadFormat</span>);
 
                <b>throw</b> <span class="r59 r">e</span>;
            }
 
            <b>return</b> <a href="#8c2b801c66a1e329" class="i method">GetProvider</a>(<span class="r58 r">providerName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the provider of the specified name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the provider to retrieve</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider of the given name</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider with the specified </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">name</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> could not be found or the name was ambiguous.</span>
        <span class="c">///</span><span class="c"> If the name is ambiguous then the PSSnapin qualified name must</span>
        <span class="c">///</span><span class="c"> be specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <a id="02cfdb64abb0b450" href="../R/02cfdb64abb0b450.html" target="n" data-glyph="74,1" class="i method">GetSingleProvider</a>(<b>string</b> <span id="r60 rd" class="r60 r">name</span>)
        {
            <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r61 rd" class="r61 r">matchingProviders</span> = <a href="#d5d3002ebd62e68a" class="i method">GetProvider</a>(<span class="r60 r">name</span>);
 
            <b>if</b> (<span class="r61 r">matchingProviders</span>.<span class="i">Count</span> != 1)
            {
                <b>if</b> (<span class="r61 r">matchingProviders</span>.<span class="i">Count</span> == 0)
                {
                    <a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a> <span id="r62 rd" class="r62 r">e</span> =
                        <b>new</b> <span class="t">ProviderNotFoundException</span>(
                            <span class="r60 r">name</span>,
                            <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                            <span class="s">&quot;ProviderNotFound&quot;</span>,
                            <span class="i">SessionStateStrings</span>.<span class="i">ProviderNotFound</span>);
 
                    <b>throw</b> <span class="r62 r">e</span>;
                }
                <b>else</b>
                {
                    <b>throw</b> <a href="#ded65b853327f190" class="i method">NewAmbiguousProviderName</a>(<span class="r60 r">name</span>, <span class="r61 r">matchingProviders</span>);
                }
            }
 
            <b>return</b> <span class="r61 r">matchingProviders</span>[0];
        }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <a id="8c2b801c66a1e329" href="../R/8c2b801c66a1e329.html" target="n" data-glyph="74,1" class="i method">GetProvider</a>(<a href="MshSnapinQualifiedName.cs.html#93cb5bb27e91d97d" class="t t">PSSnapinQualifiedName</a> <span id="r63 rd" class="r63 r">providerName</span>)
        {
            <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r64 rd" class="r64 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;();
 
            <b>if</b> (<span class="r63 r">providerName</span> == <b>null</b>)
            {
                <a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a> <span id="r65 rd" class="r65 r">e</span> =
                    <b>new</b> <span class="t">ProviderNotFoundException</span>(
                        <span class="s">&quot;null&quot;</span>,
                        <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                        <span class="s">&quot;ProviderNotFound&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">ProviderNotFound</span>);
 
                <b>throw</b> <span class="r65 r">e</span>;
            }
 
            <span class="c">// Get the provider from the providers container</span>
 
            <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r66 rd" class="r66 r">matchingProviders</span> = <b>null</b>;
 
            <b>if</b> (!<a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">TryGetValue</span>(<span class="r63 r">providerName</span>.<a href="MshSnapinQualifiedName.cs.html#cb4b6868a9751795" class="i property">ShortName</a>, <b>out</b> <span class="r66 r">matchingProviders</span>))
            {
                <span class="c">// If the provider was not found, we may need to auto-mount it.</span>
                <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a>.<a href="SessionStateDriveAPIs.cs.html#b209d41d45fa40e2" class="i method">MountDefaultDrive</a>(<span class="r63 r">providerName</span>.<a href="MshSnapinQualifiedName.cs.html#cb4b6868a9751795" class="i property">ShortName</a>, <a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>);
 
                <b>if</b> (!<a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">TryGetValue</span>(<span class="r63 r">providerName</span>.<a href="MshSnapinQualifiedName.cs.html#cb4b6868a9751795" class="i property">ShortName</a>, <b>out</b> <span class="r66 r">matchingProviders</span>))
                {
                    <a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a> <span id="r67 rd" class="r67 r">e</span> =
                        <b>new</b> <span class="t">ProviderNotFoundException</span>(
                            <span class="r63 r">providerName</span>.<a href="MshSnapinQualifiedName.cs.html#f95c94660355138b" class="i method">ToString</a>(),
                            <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                            <span class="s">&quot;ProviderNotFound&quot;</span>,
                            <span class="i">SessionStateStrings</span>.<span class="i">ProviderNotFound</span>);
 
                    <b>throw</b> <span class="r67 r">e</span>;
                }
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r63 r">providerName</span>.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>))
            {
                <span class="c">// Be sure the PSSnapin/Module name matches</span>
 
                <b>foreach</b> (<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r68 rd" class="r68 r">provider</span> <b>in</b> <span class="r66 r">matchingProviders</span>)
                {
                    <b>if</b> (<b>string</b>.<span class="i">Equals</span>(
                            <span class="r68 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#85735ca1e339b2fc" class="i property">PSSnapInName</a>,
                            <span class="r63 r">providerName</span>.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>,
                           <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                        <b>string</b>.<span class="i">Equals</span>(
                            <span class="r68 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#f13c4dce92c1c35b" class="i property">ModuleName</a>,
                            <span class="r63 r">providerName</span>.<a href="MshSnapinQualifiedName.cs.html#2638d2d5a054bb72" class="i property">PSSnapInName</a>,
                            <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r64 r">result</span>.<span class="i">Add</span>(<span class="r68 r">provider</span>);
                    }
                }
            }
            <b>else</b>
            {
                <b>foreach</b> (<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r69 rd" class="r69 r">provider</span> <b>in</b> <span class="r66 r">matchingProviders</span>)
                {
                    <span class="r64 r">result</span>.<span class="i">Add</span>(<span class="r69 r">provider</span>);
                }
            }
 
            <b>return</b> <span class="r64 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets all the CoreCommandProviders.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <a id="5b65de64571ac732" href="../R/5b65de64571ac732.html" target="n" data-glyph="104,1" class="i property">ProviderList</a>
        {
            <b>get</b>
            {
                <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r70 rd" class="r70 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;();
 
                <b>foreach</b> (<span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r71 rd" class="r71 r">providerValues</span> <b>in</b> <a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">Values</span>)
                {
                    <b>foreach</b> (<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r72 rd" class="r72 r">provider</span> <b>in</b> <span class="r71 r">providerValues</span>)
                    {
                        <span class="r70 r">result</span>.<span class="i">Add</span>(<span class="r72 r">provider</span>);
                    }
                }
 
                <b>return</b> <span class="r70 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copy the Providers from another session state instance...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">ss</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The session state instance to copy from...</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="0ee1668ccac30268" href="../R/0ee1668ccac30268.html" target="n" data-glyph="74,1" class="i method">CopyProviders</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r73 rd" class="r73 r">ss</span>)
        {
            <b>if</b> (<span class="r73 r">ss</span> == <b>null</b> || <span class="r73 r">ss</span>.<a href="#12503655514931e1" class="i property">Providers</a> == <b>null</b>)
                <b>return</b>;
 
            <span class="c">// private Dictionary&lt;string, List&lt;ProviderInfo&gt;&gt; providers;</span>
            <a href="#c30ea9dc89dba3e5" class="i field">_providers</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;&gt;();
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;&gt; <span id="r74 rd" class="r74 r">e</span> <b>in</b> <span class="r73 r">ss</span>.<a href="#c30ea9dc89dba3e5" class="i field">_providers</a>)
            {
                <a href="#c30ea9dc89dba3e5" class="i field">_providers</a>.<span class="i">Add</span>(<span class="r74 r">e</span>.<span class="i">Key</span>, <span class="r74 r">e</span>.<span class="i">Value</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> GetProvider
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> NewProvider
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a provider by loading the assembly, creating an instance of the</span>
        <span class="c">///</span><span class="c"> provider, calling its start method followed by the InitializeDefaultDrives method. The</span>
        <span class="c">///</span><span class="c"> Drives that are returned from the InitializeDefaultDrives method are then mounted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">providerInstance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the provider to use for the initialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to be initialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the initialization is occurring. If this parameter is not</span>
        <span class="c">///</span><span class="c"> null, errors will be written to the WriteError method of the context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">context</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the provider is not a DriveCmdletProvider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a drive already exists for the name of one of the drives the</span>
        <span class="c">///</span><span class="c"> provider tries to add.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="97c645ab58ab6b85" href="../R/97c645ab58ab6b85.html" target="n" data-glyph="74,1" class="i method">InitializeProvider</a>(
            <span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <span id="r75 rd" class="r75 r">providerInstance</span>,
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r76 rd" class="r76 r">provider</span>,
            <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r77 rd" class="r77 r">context</span>)
        {
            <b>if</b> (<span class="r76 r">provider</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r76 r">provider</span>));
            }
 
            <b>if</b> (<span class="r77 r">context</span> == <b>null</b>)
            {
                <span class="r77 r">context</span> = <b>new</b> <a href="../namespaces/CoreCommandContext.cs.html#8a0e078b40b2fd0e" class="t constructor">CmdletProviderContext</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>);
            }
 
            <span class="c">// Initialize the provider so that it can add any drives</span>
            <span class="c">// that it needs.</span>
 
            <span class="i">List</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <span id="r78 rd" class="r78 r">newDrives</span> = <b>new</b> <span class="i">List</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt;();
            <a href="../namespaces/DriveProviderBase.cs.html#44a855059013a4af" class="t t">DriveCmdletProvider</a> <span id="r79 rd" class="r79 r">driveProvider</span> =
                <a href="#7ff1ab83334142fd" class="i method">GetDriveProviderInstance</a>(<span class="r75 r">providerInstance</span>);
 
            <b>if</b> (<span class="r79 r">driveProvider</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="i">Collection</span>&lt;<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <span id="r80 rd" class="r80 r">drives</span> = <span class="r79 r">driveProvider</span>.<a href="../namespaces/DriveProviderBase.cs.html#42b803e3e5cfd35e" class="i method">InitializeDefaultDrives</a>(<span class="r77 r">context</span>);
                    <b>if</b> (<span class="r80 r">drives</span> != <b>null</b> &amp;&amp; <span class="r80 r">drives</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="r78 r">newDrives</span>.<span class="i">AddRange</span>(<span class="r80 r">drives</span>);
                        <a href="#5501f560faf2de0a" class="i property">ProvidersCurrentWorkingDrive</a>[<span class="r76 r">provider</span>] = <span class="r80 r">drives</span>[0];
                    }
                }
                <b>catch</b> (<a href="lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>)
                {
                    <b>throw</b>;
                }
                <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
                {
                    <b>throw</b>;
                }
                <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a>)
                {
                    <b>throw</b>;
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r81 rd" class="r81 r">e</span>) <span class="c">// Catch-all OK, 3rd party callout</span>
                {
                    <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r82 rd" class="r82 r">providerException</span> =
                        <span class="i">NewProviderInvocationException</span>(
                            <span class="s">&quot;InitializeDefaultDrivesException&quot;</span>,
                            <span class="i">SessionStateStrings</span>.<span class="i">InitializeDefaultDrivesException</span>,
                            <span class="r76 r">provider</span>,
                            <b>string</b>.<span class="i">Empty</span>,
                            <span class="r81 r">e</span>);
 
                    <span class="r77 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#97661a296df11e6d" class="i method">WriteError</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(
                            <span class="r82 r">providerException</span>,
                            <span class="s">&quot;InitializeDefaultDrivesException&quot;</span>,
                            <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                            <span class="r76 r">provider</span>));
                }
            }
 
            <b>if</b> (<span class="r78 r">newDrives</span> != <b>null</b> &amp;&amp; <span class="r78 r">newDrives</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Add the drives.</span>
 
                <b>foreach</b> (<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r83 rd" class="r83 r">newDrive</span> <b>in</b> <span class="r78 r">newDrives</span>)
                {
                    <b>if</b> (<span class="r83 r">newDrive</span> == <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="c">// Only mount drives for the current provider</span>
 
                    <b>if</b> (!<span class="r76 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<span class="r83 r">newDrive</span>.<a href="DataStoreAdapter.cs.html#599e6ea3519fc2d6" class="i property">Provider</a>.<a href="DataStoreAdapterProvider.cs.html#91a8d08ee3ba5a61" class="i property">FullName</a>))
                    {
                        <b>continue</b>;
                    }
 
                    <b>try</b>
                    {
                        <a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r84 rd" class="r84 r">validatedNewDrive</span> = <a href="#f0fa1bdc83f8c1ec" class="i method">ValidateDriveWithProvider</a>(<span class="r79 r">driveProvider</span>, <span class="r83 r">newDrive</span>, <span class="r77 r">context</span>, <b>false</b>);
 
                        <b>if</b> (<span class="r84 r">validatedNewDrive</span> != <b>null</b>)
                        {
                            <span class="c">// Since providers are global then the drives created</span>
                            <span class="c">// through InitializeDefaultDrives should also be global.</span>
 
                            <a href="SessionStateScopeAPIs.cs.html#2b591e85d7ead426" class="i property">GlobalScope</a>.<a href="SessionStateScope.cs.html#be5f4ca8939b8bec" class="i method">NewDrive</a>(<span class="r84 r">validatedNewDrive</span>);
                        }
                    }
                    <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a> <span id="r85 rd" class="r85 r">exception</span>)
                    {
                        <span class="r77 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#97661a296df11e6d" class="i method">WriteError</a>(<span class="r85 r">exception</span>.<a href="../utils/SessionStateExceptions.cs.html#3efc34ad3d29e212" class="i property">ErrorRecord</a>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates and adds a provider to the provider container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to add.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider that was added or null if the provider failed to be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">provider</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the provider already exists.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there was a failure to load the provider or the provider</span>
        <span class="c">///</span><span class="c"> threw an exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <a id="4df468eaf1170de0" href="../R/4df468eaf1170de0.html" target="n" data-glyph="74,1" class="i method">NewProvider</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r86 rd" class="r86 r">provider</span>)
        {
            <b>if</b> (<span class="r86 r">provider</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r86 r">provider</span>));
            }
 
            <span class="c">// Check to see if the provider already exists.</span>
            <span class="c">// We do the check instead of allowing the hashtable to</span>
            <span class="c">// throw the exception so that we give a better error</span>
            <span class="c">// message.</span>
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r87 rd" class="r87 r">existingProvider</span> = <a href="#d0c53247c6306e16" class="i method">ProviderExists</a>(<span class="r86 r">provider</span>);
            <b>if</b> (<span class="r87 r">existingProvider</span> != <b>null</b>)
            {
                <span class="c">// If it&#39;s an already loaded provider, don&#39;t return an error...</span>
                <b>if</b> (<span class="r87 r">existingProvider</span>.<a href="DataStoreAdapterProvider.cs.html#3801e8e136516894" class="i property">ImplementingType</a> == <span class="r86 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#3801e8e136516894" class="i property">ImplementingType</a>)
                    <b>return</b> <span class="r87 r">existingProvider</span>;
 
                <a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a> <span id="r88 rd" class="r88 r">sessionStateException</span> =
                    <b>new</b> <span class="t">SessionStateException</span>(
                        <span class="r86 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>,
                        <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                        <span class="s">&quot;CmdletProviderAlreadyExists&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">CmdletProviderAlreadyExists</span>,
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#22cb3b8b80f740be" class="i field">ResourceExists</a>);
 
                <b>throw</b> <span class="r88 r">sessionStateException</span>;
            }
 
            <span class="c">// Make sure we are able to create an instance of the provider.</span>
            <span class="c">// Note, this will also set the friendly name if the user didn&#39;t</span>
            <span class="c">// specify one.</span>
 
            <span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <span id="r89 rd" class="r89 r">providerInstance</span> = <span class="r86 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#dd6074faa9bf93c1" class="i method">CreateInstance</a>();
 
            <span class="c">// Now call start to let the provider initialize itself</span>
            <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r90 rd" class="r90 r">context</span> = <b>new</b> <a href="../namespaces/CoreCommandContext.cs.html#8a0e078b40b2fd0e" class="t constructor">CmdletProviderContext</a>(<a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>);
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r91 rd" class="r91 r">newProviderInfo</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r91 r">newProviderInfo</span> = <span class="r89 r">providerInstance</span>.<a href="../namespaces/ProviderBase.cs.html#fd8802cc120a55c9" class="i method">Start</a>(<span class="r86 r">provider</span>, <span class="r90 r">context</span>);
 
                <span class="c">// Set the new provider info in the instance in case the provider</span>
                <span class="c">// derived a new one</span>
 
                <span class="r89 r">providerInstance</span>.<a href="../namespaces/ProviderBase.cs.html#5a7404629811329a" class="i method">SetProviderInformation</a>(<span class="r91 r">newProviderInfo</span>);
            }
            <b>catch</b> (<a href="lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r92 rd" class="r92 r">e</span>) <span class="c">// Catch-call OK, 3rd party callout</span>
            {
                <b>throw</b>
                    <span class="i">NewProviderInvocationException</span>(
                        <span class="s">&quot;ProviderStartException&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">ProviderStartException</span>,
                        <span class="r86 r">provider</span>,
                        <b>null</b>,
                        <span class="r92 r">e</span>);
            }
 
            <span class="r90 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#fbd6be97427096df" class="i method">ThrowFirstErrorOrDoNothing</a>(<b>true</b>);
 
            <b>if</b> (<span class="r91 r">newProviderInfo</span> == <b>null</b>)
            {
                <b>throw</b>
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                        <span class="i">SessionStateStrings</span>.<span class="i">InvalidProviderInfoNull</span>);
            }
 
            <b>if</b> (<span class="r91 r">newProviderInfo</span> != <span class="r86 r">provider</span>)
            {
                <span class="c">// Since the references are not the same, ensure that the provider</span>
                <span class="c">// name is the same.</span>
 
                <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r91 r">newProviderInfo</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>, <span class="r86 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>throw</b>
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(
                            <span class="i">SessionStateStrings</span>.<span class="i">InvalidProviderInfo</span>);
                }
 
                <span class="c">// Use the new provider info instead</span>
                <span class="r86 r">provider</span> = <span class="r91 r">newProviderInfo</span>;
            }
 
            <span class="c">// Add the newly create provider to the providers container</span>
 
            <b>try</b>
            {
                <a href="#80bb7a5510489d4b" class="i method">NewProviderEntry</a>(<span class="r86 r">provider</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a> <span id="r93 rd" class="r93 r">sessionStateException</span> =
                    <b>new</b> <span class="t">SessionStateException</span>(
                        <span class="r86 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>,
                        <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                        <span class="s">&quot;CmdletProviderAlreadyExists&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">CmdletProviderAlreadyExists</span>,
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#22cb3b8b80f740be" class="i field">ResourceExists</a>);
 
                <b>throw</b> <span class="r93 r">sessionStateException</span>;
            }
 
            <span class="c">// Add the provider to the provider current working</span>
            <span class="c">// drive hashtable so that we can associate a current working</span>
            <span class="c">// drive with it.</span>
 
            <a href="#5501f560faf2de0a" class="i property">ProvidersCurrentWorkingDrive</a>.<span class="i">Add</span>(<span class="r86 r">provider</span>, <b>null</b>);
 
            <b>bool</b> <span id="r94 rd" class="r94 r">initializeProviderError</span> = <b>false</b>;
            <b>try</b>
            {
                <span class="c">// Initialize the provider and give it a chance to</span>
                <span class="c">// mount some drives.</span>
 
                <a href="#97c645ab58ab6b85" class="i method">InitializeProvider</a>(<span class="r89 r">providerInstance</span>, <span class="r86 r">provider</span>, <span class="r90 r">context</span>);
                <span class="r90 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#fbd6be97427096df" class="i method">ThrowFirstErrorOrDoNothing</a>(<b>true</b>);
            }
            <b>catch</b> (<a href="lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
            {
                <span class="r94 r">initializeProviderError</span> = <b>true</b>;
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a>)
            {
                <span class="r94 r">initializeProviderError</span> = <b>true</b>;
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">NotSupportedException</span>)
            {
                <span class="c">// We can safely ignore NotSupportedExceptions because</span>
                <span class="c">// it just means that the provider doesn&#39;t support</span>
                <span class="c">// drives.</span>
 
                <span class="r94 r">initializeProviderError</span> = <b>false</b>;
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a>)
            {
                <span class="r94 r">initializeProviderError</span> = <b>true</b>;
                <b>throw</b>;
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r94 r">initializeProviderError</span>)
                {
                    <span class="c">// An exception during initialization should remove the provider from</span>
                    <span class="c">// session state.</span>
 
                    <a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">Remove</span>(<span class="r86 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>);
                    <a href="#5501f560faf2de0a" class="i property">ProvidersCurrentWorkingDrive</a>.<span class="i">Remove</span>(<span class="r86 r">provider</span>);
                    <span class="r86 r">provider</span> = <b>null</b>;
                }
            }
 
            <span class="c">// Now write out the result</span>
 
            <b>return</b> <span class="r86 r">provider</span>;
        }
 
        <b>private</b> <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <a id="d0c53247c6306e16" href="../R/d0c53247c6306e16.html" target="n" data-glyph="76,1" class="i method">ProviderExists</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r95 rd" class="r95 r">provider</span>)
        {
            <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r96 rd" class="r96 r">matchingProviders</span> = <b>null</b>;
 
            <b>if</b> (<a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">TryGetValue</span>(<span class="r95 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>, <b>out</b> <span class="r96 r">matchingProviders</span>))
            {
                <b>foreach</b> (<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r97 rd" class="r97 r">possibleMatch</span> <b>in</b> <span class="r96 r">matchingProviders</span>)
                {
                    <b>if</b> (<span class="r95 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<span class="r97 r">possibleMatch</span>.<a href="DataStoreAdapterProvider.cs.html#91a8d08ee3ba5a61" class="i property">FullName</a>))
                    {
                        <b>return</b> <span class="r97 r">possibleMatch</span>;
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an entry in the providers hashtable for the new provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider being added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a provider with the same name and PSSnapIn name already exists.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="80bb7a5510489d4b" href="../R/80bb7a5510489d4b.html" target="n" data-glyph="76,1" class="i method">NewProviderEntry</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r98 rd" class="r98 r">provider</span>)
        {
            <b>bool</b> <span id="r99 rd" class="r99 r">isDuplicateProvider</span> = <b>false</b>;
 
            <span class="c">// Add the entry to the list of providers with that name</span>
            <b>if</b> (!<a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">ContainsKey</span>(<span class="r98 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>))
            {
                <a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">Add</span>(<span class="r98 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>, <b>new</b> <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt;());
            }
            <b>else</b>
            {
                <span class="c">// be sure the same provider from the same PSSnapin doesn&#39;t already exist</span>
 
                <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r100 rd" class="r100 r">existingProviders</span> = <a href="#12503655514931e1" class="i property">Providers</a>[<span class="r98 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>];
 
                <b>foreach</b> (<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r101 rd" class="r101 r">existingProvider</span> <b>in</b> <span class="r100 r">existingProviders</span>)
                {
                    <span class="c">// making sure that we are not trying to add the same provider by checking the provider name &amp; type of the new and existing providers.</span>
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r98 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#85735ca1e339b2fc" class="i property">PSSnapInName</a>) &amp;&amp; (<b>string</b>.<span class="i">Equals</span>(<span class="r101 r">existingProvider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>, <span class="r98 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        (<span class="r101 r">existingProvider</span>.<span class="i">GetType</span>().<span class="i">Equals</span>(<span class="r98 r">provider</span>.<span class="i">GetType</span>()))))
                    {
                        <span class="r99 r">isDuplicateProvider</span> = <b>true</b>;
                    }
 
                    <span class="c">// making sure that we are not trying to add the same provider by checking the PSSnapinName of the new and existing providers.</span>
                    <b>else</b> <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r101 r">existingProvider</span>.<a href="DataStoreAdapterProvider.cs.html#85735ca1e339b2fc" class="i property">PSSnapInName</a>, <span class="r98 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#85735ca1e339b2fc" class="i property">PSSnapInName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r99 r">isDuplicateProvider</span> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (!<span class="r99 r">isDuplicateProvider</span>)
            {
                <a href="#12503655514931e1" class="i property">Providers</a>[<span class="r98 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>].<span class="i">Add</span>(<span class="r98 r">provider</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> NewProvider
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Remove Provider
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the provider of the given name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">providerName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the provider to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider should be removed forcefully even if there were</span>
        <span class="c">///</span><span class="c"> drives present or errors.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is being run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">error</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">providerName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">error</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">error</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> There are still drives associated with this provider,</span>
        <span class="c">///</span><span class="c"> and the &quot;force&quot; option was not specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">error</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">error</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A provider with name </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">providerName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> could not be found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">error</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">error</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a provider throws an exception it gets written to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">context</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">error</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">providerName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">context</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All drives associated with the provider must be removed before the provider</span>
        <span class="c">///</span><span class="c"> can be removed. Call SessionState.GetDrivesForProvider() to determine if there</span>
        <span class="c">///</span><span class="c"> are any drives associated with the provider. A SessionStateException</span>
        <span class="c">///</span><span class="c"> will be written to the context if any such drives do exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5d394d367dedec84" href="../R/5d394d367dedec84.html" target="n" data-glyph="74,1" class="i method">RemoveProvider</a>(
            <b>string</b> <span id="r102 rd" class="r102 r">providerName</span>,
            <b>bool</b> <span id="r103 rd" class="r103 r">force</span>,
            <a href="../namespaces/CoreCommandContext.cs.html#1e83d35d5286e174" class="t t">CmdletProviderContext</a> <span id="r104 rd" class="r104 r">context</span>)
        {
            <b>if</b> (<span class="r104 r">context</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r104 r">context</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r102 r">providerName</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r102 r">providerName</span>));
            }
 
            <b>bool</b> <span id="r105 rd" class="r105 r">errors</span> = <b>false</b>;
 
            <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r106 rd" class="r106 r">provider</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r106 r">provider</span> = <a href="#02cfdb64abb0b450" class="i method">GetSingleProvider</a>(<span class="r102 r">providerName</span>);
            }
            <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a>)
            {
                <b>return</b>;
            }
 
            <b>try</b>
            {
                <span class="c">// First get an instance of the provider to make sure it exists</span>
                <span class="i n">Provider</span>.<a href="../P/71826561229efd99.html#71826561229efd99" class="t t">CmdletProvider</a> <span id="r107 rd" class="r107 r">providerBase</span> = <a href="#61c4fceacab681fd" class="i method">GetProviderInstance</a>(<span class="r106 r">provider</span>);
 
                <b>if</b> (<span class="r107 r">providerBase</span> == <b>null</b>)
                {
                    <a href="../utils/SessionStateExceptions.cs.html#a58038dc730da896" class="t t">ProviderNotFoundException</a> <span id="r108 rd" class="r108 r">e</span> = <b>new</b> <span class="t">ProviderNotFoundException</span>(
                        <span class="r102 r">providerName</span>,
                        <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                        <span class="s">&quot;ProviderNotFound&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">ProviderNotFound</span>);
                    <span class="r104 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#97661a296df11e6d" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r108 r">e</span>.<a href="../utils/SessionStateExceptions.cs.html#3efc34ad3d29e212" class="i property">ErrorRecord</a>, <span class="r108 r">e</span>));
 
                    <span class="r105 r">errors</span> = <b>true</b>;
                }
                <b>else</b>
                {
                    <span class="c">// See if there are any drives present for the provider</span>
 
                    <b>int</b> <span id="r109 rd" class="r109 r">driveCount</span> = 0;
                    <b>foreach</b> (<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r110 rd" class="r110 r">drive</span> <b>in</b> <a href="SessionStateDriveAPIs.cs.html#4a709421313fe1ad" class="i method">GetDrivesForProvider</a>(<span class="r102 r">providerName</span>))
                    {
                        <b>if</b> (<span class="r110 r">drive</span> != <b>null</b>)
                        {
                            ++<span class="r109 r">driveCount</span>;
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r109 r">driveCount</span> &gt; 0)
                    {
                        <b>if</b> (<span class="r103 r">force</span>)
                        {
                            <span class="c">// Forcefully remove all the drives</span>
 
                            <b>foreach</b> (<a href="DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r111 rd" class="r111 r">drive</span> <b>in</b> <a href="SessionStateDriveAPIs.cs.html#4a709421313fe1ad" class="i method">GetDrivesForProvider</a>(<span class="r102 r">providerName</span>))
                            {
                                <b>if</b> (<span class="r111 r">drive</span> != <b>null</b>)
                                {
                                    <a href="SessionStateDriveAPIs.cs.html#efe8494b1eb76744" class="i method">RemoveDrive</a>(<span class="r111 r">drive</span>, <b>true</b>, <b>null</b>);
                                }
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r105 r">errors</span> = <b>true</b>;
 
                            <span class="c">// Since there are still drives associated with the provider</span>
                            <span class="c">// the provider cannot be removed</span>
 
                            <a href="../utils/SessionStateExceptions.cs.html#3f7cfda90a75013a" class="t t">SessionStateException</a> <span id="r112 rd" class="r112 r">e</span> = <b>new</b> <span class="t">SessionStateException</span>(
                                <span class="r102 r">providerName</span>,
                                <a href="../utils/SessionStateExceptions.cs.html#22b8ef04eadcf731" class="t t">SessionStateCategory</a>.<a href="../utils/SessionStateExceptions.cs.html#3e9b2052f3ab0f37" class="i field">CmdletProvider</a>,
                                <span class="s">&quot;RemoveDrivesBeforeRemovingProvider&quot;</span>,
                                <span class="i">SessionStateStrings</span>.<span class="i">RemoveDrivesBeforeRemovingProvider</span>,
                                <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>);
                            <span class="r104 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#97661a296df11e6d" class="i method">WriteError</a>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r112 r">e</span>.<a href="../utils/SessionStateExceptions.cs.html#3efc34ad3d29e212" class="i property">ErrorRecord</a>, <span class="r112 r">e</span>));
 
                            <b>return</b>;
                        }
                    }
 
                    <span class="c">// Now tell the provider that they are going to be removed by</span>
                    <span class="c">// calling the Stop method</span>
 
                    <b>try</b>
                    {
                        <span class="r107 r">providerBase</span>.<a href="../namespaces/ProviderBase.cs.html#38079c68bcb9b691" class="i method">Stop</a>(<span class="r104 r">context</span>);
                    }
                    <b>catch</b> (<a href="lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>)
                    {
                        <b>throw</b>;
                    }
                    <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
                    {
                        <b>throw</b>;
                    }
                    <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a>)
                    {
                        <b>throw</b>;
                    }
                }
            }
            <b>catch</b> (<a href="lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../utils/ExecutionExceptions.cs.html#f896df45dff24981" class="t t">ActionPreferenceStopException</a>)
            {
                <b>throw</b>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r113 rd" class="r113 r">e</span>)
            {
                <span class="r105 r">errors</span> = <b>true</b>;
                <span class="r104 r">context</span>.<a href="../namespaces/CoreCommandContext.cs.html#97661a296df11e6d" class="i method">WriteError</a>(
                    <b>new</b> <a href="ErrorPackage.cs.html#e9334565e5136f43" class="t constructor">ErrorRecord</a>(
                        <span class="r113 r">e</span>,
                        <span class="s">&quot;RemoveProviderUnexpectedException&quot;</span>,
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <span class="r102 r">providerName</span>));
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r103 r">force</span> || !<span class="r105 r">errors</span>)
                {
                    <span class="c">// Log the provider stopped event</span>
 
                    <a href="../logging/MshLog.cs.html#c21af6f8f06e5873" class="t t">MshLog</a>.<a href="../logging/MshLog.cs.html#302502e120276213" class="i method">LogProviderLifecycleEvent</a>(
                        <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">this</a>.<a href="SessionState.cs.html#3ddff2db6bc01805" class="i property">ExecutionContext</a>,
                        <span class="r102 r">providerName</span>,
                        <a href="../logging/MshLog.cs.html#74ca7b7b1cc6cf5c" class="t t">ProviderState</a>.<a href="../logging/MshLog.cs.html#511f412afcce2e6a" class="i field">Stopped</a>);
 
                    <a href="#9ff0e0c83387dc99" class="i method">RemoveProviderFromCollection</a>(<span class="r106 r">provider</span>);
                    <a href="#5501f560faf2de0a" class="i property">ProvidersCurrentWorkingDrive</a>.<span class="i">Remove</span>(<span class="r106 r">provider</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the provider from the providers dictionary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">provider</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider to be removed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there are multiple providers with the same name, then only the provider</span>
        <span class="c">///</span><span class="c"> from the matching PSSnapin is removed.</span>
        <span class="c">///</span><span class="c"> If the last provider of that name is removed the entry is removed from the dictionary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9ff0e0c83387dc99" href="../R/9ff0e0c83387dc99.html" target="n" data-glyph="76,1" class="i method">RemoveProviderFromCollection</a>(<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r114 rd" class="r114 r">provider</span>)
        {
            <span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r115 rd" class="r115 r">matchingProviders</span>;
            <b>if</b> (<a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">TryGetValue</span>(<span class="r114 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>, <b>out</b> <span class="r115 r">matchingProviders</span>))
            {
                <b>if</b> (<span class="r115 r">matchingProviders</span>.<span class="i">Count</span> == 1 &amp;&amp;
                    <span class="r115 r">matchingProviders</span>[0].<span class="i">NameEquals</span>(<span class="r114 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#91a8d08ee3ba5a61" class="i property">FullName</a>))
                {
                    <a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">Remove</span>(<span class="r114 r">provider</span>.<a href="DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>);
                }
                <b>else</b>
                {
                    <span class="r115 r">matchingProviders</span>.<span class="i">Remove</span>(<span class="r114 r">provider</span>);
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RemoveProvider
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the count of the number of providers that are loaded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="6dd27d6ba191948d" href="../R/6dd27d6ba191948d.html" target="n" data-glyph="104,1" class="i property">ProviderCount</a>
        {
            <b>get</b>
            {
                <b>int</b> <span id="r116 rd" class="r116 r">count</span> = 0;
                <b>foreach</b> (<span class="i">List</span>&lt;<a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>&gt; <span id="r117 rd" class="r117 r">matchingProviders</span> <b>in</b> <a href="#12503655514931e1" class="i property">Providers</a>.<span class="i">Values</span>)
                {
                    <span class="r116 r">count</span> += <span class="r117 r">matchingProviders</span>.<span class="i">Count</span>;
                }
 
                <b>return</b> <span class="r116 r">count</span>;
            }
        }
    }
}
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
</pre></td></tr></table></div></body></html>
