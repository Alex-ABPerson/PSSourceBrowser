<!DOCTYPE html>
<html><head><title>ParameterBinderController.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1327);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ParameterBinderController.cs" target="_top">engine\ParameterBinderController.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The base class for the parameter binder controllers. This class and</span>
    <span class="c">///</span><span class="c"> its derived classes control the interaction between the command processor</span>
    <span class="c">///</span><span class="c"> and the parameter binder(s). It holds the state of the arguments and parameters.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;InvocationInfo = {InvocationInfo}&quot;</span>)]
    <b>internal abstract class</b> <a id="9e4e49a03a43c579" href="../R/9e4e49a03a43c579.html" target="n" data-glyph="2,0" class="t t">ParameterBinderController</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a parameter binder controller for the specified command</span>
        <span class="c">///</span><span class="c"> in the specified engine context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The invocation information about the code being run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The engine context in which the command is being run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">parameterBinder</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     The default parameter binder for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7c8feb3ce277a36f" href="../R/7c8feb3ce277a36f.html" target="n" data-glyph="74,1" class="t constructor">ParameterBinderController</a>(<a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r0 rd" class="r0 r">invocationInfo</span>, <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r1 rd" class="r1 r">context</span>, <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a> <span id="r2 rd" class="r2 r">parameterBinder</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r0 r">invocationInfo</span> != <b>null</b>, <span class="s">&quot;Caller to verify invocationInfo is not null.&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r2 r">parameterBinder</span> != <b>null</b>, <span class="s">&quot;Caller to verify parameterBinder is not null.&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r1 r">context</span> != <b>null</b>, <span class="s">&quot;call to verify context is not null.&quot;</span>);
 
            <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a> = <span class="r2 r">parameterBinder</span>;
            <a href="#ce2a3e6f14a932c8" class="i property">Context</a> = <span class="r1 r">context</span>;
            <a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a> = <span class="r0 r">invocationInfo</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal_members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The engine context the command is running in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="ce2a3e6f14a932c8" href="../R/ce2a3e6f14a932c8.html" target="n" data-glyph="104,1" class="i property">Context</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the parameter binder for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a> <a id="ce76907c0e73fffa" href="../R/ce76907c0e73fffa.html" target="n" data-glyph="104,1" class="i property">DefaultParameterBinder</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The invocation information about the code being run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="e0677962cb6d3e17" href="../R/e0677962cb6d3e17.html" target="n" data-glyph="104,1" class="i property">InvocationInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All the metadata associated with any of the parameters that</span>
        <span class="c">///</span><span class="c"> are available from the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="b1da2b94d5ab12b2" href="../R/b1da2b94d5ab12b2.html" target="n" data-glyph="104,1" class="i property">BindableParameters</a>
        {
            <b>get</b> { <b>return</b> <a href="#7238478eed2bd243" class="i field">_bindableParameters</a>; }
        }
 
        <b>protected</b> <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="7238478eed2bd243" href="../R/7238478eed2bd243.html" target="n" data-glyph="45,1" class="i field">_bindableParameters</a> = <b>new</b> <span class="t">MergedCommandParameterMetadata</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of the unbound parameters for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <span class="i">List</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="717e40a5f982f97b" href="../R/717e40a5f982f97b.html" target="n" data-glyph="105,1" class="i property">UnboundParameters</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the bound parameters for the command. The collection is</span>
        <span class="c">///</span><span class="c"> indexed based on the name of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="03396016088be5fe" href="../R/03396016088be5fe.html" target="n" data-glyph="105,1" class="i property">BoundParameters</a> { <b>get</b>; } = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>internal</b> <a href="ParameterBinderBase.cs.html#efc1e794ccda0552" class="t t">CommandLineParameters</a> <a id="0b62798bea43a39e" href="../R/0b62798bea43a39e.html" target="n" data-glyph="104,1" class="i property">CommandLineParameters</a>
        {
            <b>get</b> { <b>return</b> <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#4555288f0b3927cb" class="i property">CommandLineParameters</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set true if the default parameter binding is in use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="6f34f8dc3c4c2aaf" href="../R/6f34f8dc3c4c2aaf.html" target="n" data-glyph="105,1" class="i property">DefaultParameterBindingInUse</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">// Set true if the default parameter values are applied</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of bound default parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="1cc9eda224499cdc" href="../R/1cc9eda224499cdc.html" target="n" data-glyph="105,1" class="i property">BoundDefaultParameters</a> { <b>get</b>; } = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
        <span class="c">// Keep record of the bound default parameters</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the unbound arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <a id="609d30f416d5dd37" href="../R/609d30f416d5dd37.html" target="n" data-glyph="105,1" class="i property">UnboundArguments</a> { <b>get</b>; <b>set</b>; } = <b>new</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;();
 
        <b>internal void</b> <a id="8dfa3bdaa5f53b57" href="../R/8dfa3bdaa5f53b57.html" target="n" data-glyph="74,1" class="i method">ClearUnboundArguments</a>()
        {
            <a href="#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Clear</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the arguments that have been bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <a id="4893dd5e52f9f477" href="../R/4893dd5e52f9f477.html" target="n" data-glyph="105,1" class="i property">BoundArguments</a> { <b>get</b>; } = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reparses the unbound arguments using the parameter metadata of the</span>
        <span class="c">///</span><span class="c"> specified parameter binder as the parsing guide.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a parameter token is not matched with an argument and its not a bool or</span>
        <span class="c">///</span><span class="c"> SwitchParameter.</span>
        <span class="c">///</span><span class="c"> Or</span>
        <span class="c">///</span><span class="c"> The name of the argument matches more than one parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="5c35bd87e9fcd1ca" href="../R/5c35bd87e9fcd1ca.html" target="n" data-glyph="75,1" class="i method">ReparseUnboundArguments</a>()
        {
            <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r3 rd" class="r3 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;();
 
            <b>for</b> (<b>int</b> <span id="r4 rd" class="r4 r">index</span> = 0; <span class="r4 r">index</span> &lt; <a href="#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Count</span>; ++<span class="r4 r">index</span>)
            {
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r5 rd" class="r5 r">argument</span> = <a href="#609d30f416d5dd37" class="i property">UnboundArguments</a>[<span class="r4 r">index</span>];
 
                <span class="c">// If the parameter name is not specified, or if it is specified _and_ there is an</span>
                <span class="c">// argument, we have nothing to reparse for this argument.</span>
                <b>if</b> (!<span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a> || <span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#f6c863f6ae765a95" class="i property">ArgumentSpecified</a>)
                {
                    <span class="r3 r">result</span>.<span class="i">Add</span>(<span class="r5 r">argument</span>);
                    <b>continue</b>;
                }
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a> &amp;&amp; !<span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#f6c863f6ae765a95" class="i property">ArgumentSpecified</a>,
                    <span class="s">&quot;At this point, we only process parameters with no arguments&quot;</span>);
 
                <span class="c">// Now check the argument name with the binder.</span>
 
                <b>string</b> <span id="r6 rd" class="r6 r">parameterName</span> = <span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>;
                <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r7 rd" class="r7 r">matchingParameter</span> =
                    <a href="#7238478eed2bd243" class="i field">_bindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(
                        <span class="r6 r">parameterName</span>,
                        <b>false</b>,
                        <b>true</b>,
                        <b>new</b> <a href="InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>, <span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#d12a5051b2b93c45" class="i property">ParameterExtent</a>));
 
                <b>if</b> (<span class="r7 r">matchingParameter</span> == <b>null</b>)
                {
                    <span class="c">// Since we couldn&#39;t find a match, just add the argument as it was</span>
                    <span class="c">// and continue</span>
                    <span class="r3 r">result</span>.<span class="i">Add</span>(<span class="r5 r">argument</span>);
                    <b>continue</b>;
                }
 
                <span class="c">// Now that we know we have a single match for the parameter name,</span>
                <span class="c">// see if we can figure out what the argument value for the parameter is.</span>
 
                <span class="c">// If its a bool or switch parameter, then set the value to true and continue</span>
 
                <b>if</b> (<a href="#9eaad0a5b26b96e9" class="i method">IsSwitchAndSetValue</a>(<span class="r6 r">parameterName</span>, <span class="r5 r">argument</span>, <span class="r7 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>))
                {
                    <span class="r3 r">result</span>.<span class="i">Add</span>(<span class="r5 r">argument</span>);
                    <b>continue</b>;
                }
 
                <span class="c">// Since it&#39;s not a bool or a SwitchParameter we need to check the next</span>
                <span class="c">// argument.</span>
 
                <b>if</b> (<a href="#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Count</span> - 1 &gt; <span class="r4 r">index</span>)
                {
                    <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r8 rd" class="r8 r">nextArgument</span> = <a href="#609d30f416d5dd37" class="i property">UnboundArguments</a>[<span class="r4 r">index</span> + 1];
 
                    <span class="c">// Since the argument appears to be a valid parameter, check the</span>
                    <span class="c">// next argument to see if it is the value for that parameter</span>
 
                    <b>if</b> (<span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a>)
                    {
                        <span class="c">// Since we have a valid parameter we need to see if the next argument is</span>
                        <span class="c">// an argument value for that parameter or a parameter itself.</span>
 
                        <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r9 rd" class="r9 r">nextMatchingParameter</span> =
                            <a href="#7238478eed2bd243" class="i field">_bindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(
                                <span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>,
                                <b>false</b>,
                                <b>true</b>,
                                <b>new</b> <a href="InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>, <span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#d12a5051b2b93c45" class="i property">ParameterExtent</a>));
 
                        <b>if</b> ((<span class="r9 r">nextMatchingParameter</span> != <b>null</b>) || <span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#86476a75bd8e4bb0" class="i property">ParameterAndArgumentSpecified</a>)
                        {
                            <span class="c">// Since the next argument is a valid parameter that means the current</span>
                            <span class="c">// argument doesn&#39;t have a value</span>
 
                            <span class="c">// It is an error to have an argument that is a parameter name</span>
                            <span class="c">// but doesn&#39;t have a value</span>
 
                            <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r10 rd" class="r10 r">exception</span> =
                                <b>new</b> <span class="t">ParameterBindingException</span>(
                                    <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                    <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>,
                                    <a href="#3227307065b1eace" class="i method">GetParameterErrorExtent</a>(<span class="r5 r">argument</span>),
                                    <span class="r7 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                                    <span class="r7 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>,
                                    <b>null</b>,
                                    <span class="i">ParameterBinderStrings</span>.<span class="i">MissingArgument</span>,
                                    <span class="s">&quot;MissingArgument&quot;</span>);
 
                            <b>throw</b> <span class="r10 r">exception</span>;
                        }
 
                        ++<span class="r4 r">index</span>;
                        <span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a> = <span class="r7 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
                        <span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#09f81ec8536cf6e6" class="i method">SetArgumentValue</a>(<span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#74477d6db015267b" class="i property">ArgumentAst</a>, <span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#e4b21d1937e05e60" class="i property">ParameterText</a>);
                        <span class="r3 r">result</span>.<span class="i">Add</span>(<span class="r5 r">argument</span>);
                        <b>continue</b>;
                    }
 
                    <span class="c">// The next argument appears to be the value for this parameter. Set the value,</span>
                    <span class="c">// increment the index and continue</span>
 
                    ++<span class="r4 r">index</span>;
                    <span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a> = <span class="r7 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
                    <span class="r5 r">argument</span>.<a href="CommandParameter.cs.html#09f81ec8536cf6e6" class="i method">SetArgumentValue</a>(<span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#74477d6db015267b" class="i property">ArgumentAst</a>, <span class="r8 r">nextArgument</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>);
                    <span class="r3 r">result</span>.<span class="i">Add</span>(<span class="r5 r">argument</span>);
                }
                <b>else</b>
                {
                    <span class="c">// It is an error to have a argument that is a parameter name</span>
                    <span class="c">// but doesn&#39;t have a value</span>
 
                    <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r11 rd" class="r11 r">exception</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>,
                            <a href="#3227307065b1eace" class="i method">GetParameterErrorExtent</a>(<span class="r5 r">argument</span>),
                            <span class="r7 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                            <span class="r7 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>,
                            <b>null</b>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">MissingArgument</span>,
                            <span class="s">&quot;MissingArgument&quot;</span>);
 
                    <b>throw</b> <span class="r11 r">exception</span>;
                }
            }
 
            <a href="#609d30f416d5dd37" class="i property">UnboundArguments</a> = <span class="r3 r">result</span>;
        }
 
        <b>protected void</b> <a id="3db4667c4d45649b" href="../R/3db4667c4d45649b.html" target="n" data-glyph="75,1" class="i method">InitUnboundArguments</a>(<span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r12 rd" class="r12 r">arguments</span>)
        {
            <span class="c">// Add the passed in arguments to the unboundArguments collection</span>
            <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r13 rd" class="r13 r">paramsFromSplatting</span> = <b>null</b>;
            <b>foreach</b> (<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r14 rd" class="r14 r">argument</span> <b>in</b> <span class="r12 r">arguments</span>)
            {
                <b>if</b> (<span class="r14 r">argument</span>.<a href="CommandParameter.cs.html#71a176d2010d8e7c" class="i property">FromHashtableSplatting</a>)
                {
                    <span class="r13 r">paramsFromSplatting</span> ??= <b>new</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;();
                    <span class="r13 r">paramsFromSplatting</span>.<span class="i">Add</span>(<span class="r14 r">argument</span>);
                }
                <b>else</b>
                {
                    <a href="#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Add</span>(<span class="r14 r">argument</span>);
                }
            }
 
            <span class="c">// Move the arguments from hashtable splatting to the end of the unbound args list, so that</span>
            <span class="c">// the explicitly specified named arguments can supersede those from a hashtable splatting.</span>
            <b>if</b> (<span class="r13 r">paramsFromSplatting</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r15 rd" class="r15 r">argument</span> <b>in</b> <span class="r13 r">paramsFromSplatting</span>)
                {
                    <a href="#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Add</span>(<span class="r15 r">argument</span>);
                }
            }
        }
 
        <b>private static bool</b> <a id="9eaad0a5b26b96e9" href="../R/9eaad0a5b26b96e9.html" target="n" data-glyph="76,1" class="i method">IsSwitchAndSetValue</a>(
            <b>string</b> <span id="r16 rd" class="r16 r">argumentName</span>,
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r17 rd" class="r17 r">argument</span>,
            <a href="CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r18 rd" class="r18 r">matchingParameter</span>)
        {
            <b>bool</b> <span id="r19 rd" class="r19 r">result</span> = <b>false</b>;
 
            <b>if</b> (<span class="r18 r">matchingParameter</span>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a> == <b>typeof</b>(<a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>))
            {
                <span class="r17 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a> = <span class="r16 r">argumentName</span>;
                <span class="r17 r">argument</span>.<span class="i">SetArgumentValue</span>(<b>null</b>, <a href="MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>.<a href="MshCmdlet.cs.html#df46a7a19deb662a" class="i property">Present</a>);
                <span class="r19 r">result</span> = <b>true</b>;
            }
 
            <b>return</b> <span class="r19 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument looks like a parameter if it is a string</span>
        <span class="c">///</span><span class="c"> and starts with a dash.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">arg</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument to check.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the argument is a string and starts with a dash,</span>
        <span class="c">///</span><span class="c"> or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="b303f54101870392" href="../R/b303f54101870392.html" target="n" data-glyph="74,1" class="i method">ArgumentLooksLikeParameter</a>(<b>string</b> <span id="r20 rd" class="r20 r">arg</span>)
        {
            <b>bool</b> <span id="r21 rd" class="r21 r">result</span> = <b>false</b>;
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r20 r">arg</span>))
            {
                <span class="r21 r">result</span> = <span class="r20 r">arg</span>[0].<span class="i">IsDash</span>();
            }
 
            <b>return</b> <span class="r21 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reparses the arguments specified in the object[] and generates CommandParameterInternal instances</span>
        <span class="c">///</span><span class="c"> based on whether the arguments look like parameters. The CommandParameterInternal instances then</span>
        <span class="c">///</span><span class="c"> get added to the specified command processor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">commandProcessor</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command processor instance to add the reparsed parameters to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments that require reparsing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="4bdadb9bbf1443dd" href="../R/4bdadb9bbf1443dd.html" target="n" data-glyph="74,1" class="i method">AddArgumentsToCommandProcessor</a>(<a href="CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r22 rd" class="r22 r">commandProcessor</span>, <b>object</b>[] <span id="r23 rd" class="r23 r">arguments</span>)
        {
            <b>if</b> ((<span class="r23 r">arguments</span> != <b>null</b>) &amp;&amp; (<span class="r23 r">arguments</span>.<span class="i">Length</span> &gt; 0))
            {
                <a href="ParameterBinderBase.cs.html#9382e45706fdb782" class="t t">PSBoundParametersDictionary</a> <span id="r24 rd" class="r24 r">boundParameters</span> = <span class="r23 r">arguments</span>[0] <b>as</b> <a href="ParameterBinderBase.cs.html#9382e45706fdb782" class="t t">PSBoundParametersDictionary</a>;
                <b>if</b> ((<span class="r24 r">boundParameters</span> != <b>null</b>) &amp;&amp; (<span class="r23 r">arguments</span>.<span class="i">Length</span> == 1))
                {
                    <span class="c">// If they are supplying a dictionary of parameters, use those directly</span>
                    <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r25 rd" class="r25 r">boundParameter</span> <b>in</b> <span class="r24 r">boundParameters</span>)
                    {
                        <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r26 rd" class="r26 r">param</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                            <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r25 r">boundParameter</span>.<span class="i">Key</span>, <span class="r25 r">boundParameter</span>.<span class="i">Key</span>,
                            <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r25 r">boundParameter</span>.<span class="i">Value</span>, <b>false</b>);
                        <span class="r22 r">commandProcessor</span>.<a href="CommandProcessorBase.cs.html#a862b2435f52bbdf" class="i method">AddParameter</a>(<span class="r26 r">param</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// Otherwise, we need to parse them ourselves</span>
                    <b>for</b> (<b>int</b> <span id="r27 rd" class="r27 r">argIndex</span> = 0; <span class="r27 r">argIndex</span> &lt; <span class="r23 r">arguments</span>.<span class="i">Length</span>; ++<span class="r27 r">argIndex</span>)
                    {
                        <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r28 rd" class="r28 r">param</span>;
                        <b>string</b> <span id="r29 rd" class="r29 r">paramText</span> = <span class="r23 r">arguments</span>[<span class="r27 r">argIndex</span>] <b>as string</b>;
                        <b>if</b> (<a href="#b303f54101870392" class="i method">ArgumentLooksLikeParameter</a>(<span class="r29 r">paramText</span>))
                        {
                            <span class="c">// The argument looks like a parameter.</span>
                            <span class="c">// Create a parameter with argument if the paramText is like this: -Path:c:\windows</span>
                            <span class="c">// Combine it with the next argument if there is an argument, and the parameter ends in &#39;:&#39;.</span>
 
                            <b>var</b> <span id="r30 rd" class="r30 r">colonIndex</span> = <span class="r29 r">paramText</span>.<span class="i">IndexOf</span>(<span class="s">&#39;:&#39;</span>);
                            <b>if</b> (<span class="r30 r">colonIndex</span> != -1 &amp;&amp; <span class="r30 r">colonIndex</span> != <span class="r29 r">paramText</span>.<span class="i">Length</span> - 1)
                            {
                                <span class="r28 r">param</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                                    <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r29 r">paramText</span>.<span class="i">Substring</span>(1, <span class="r30 r">colonIndex</span> - 1), <span class="r29 r">paramText</span>,
                                    <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r29 r">paramText</span>.<span class="i">AsSpan</span>(<span class="r30 r">colonIndex</span> + 1).<span class="i">Trim</span>().<span class="i">ToString</span>(),
                                    <b>false</b>);
                            }
                            <b>else</b> <b>if</b> (<span class="r27 r">argIndex</span> == <span class="r23 r">arguments</span>.<span class="i">Length</span> - 1 || <span class="r29 r">paramText</span>[<span class="r29 r">paramText</span>.<span class="i">Length</span> - 1] != <span class="s">&#39;:&#39;</span>)
                            {
                                <span class="r28 r">param</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameter</span>(
                                    <span class="r29 r">paramText</span>.<span class="i">Substring</span>(1), <span class="r29 r">paramText</span>);
                            }
                            <b>else</b>
                            {
                                <span class="r28 r">param</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                                    <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r29 r">paramText</span>.<span class="i">Substring</span>(1, <span class="r29 r">paramText</span>.<span class="i">Length</span> - 2), <span class="r29 r">paramText</span>,
                                    <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r23 r">arguments</span>[<span class="r27 r">argIndex</span> + 1],
                                    <b>false</b>);
                                <span class="r27 r">argIndex</span>++;
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r28 r">param</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<a href="CommandParameter.cs.html#1454f83e9b819690" class="i method">CreateArgument</a>(<span class="r23 r">arguments</span>[<span class="r27 r">argIndex</span>]);
                        }
 
                        <span class="r22 r">commandProcessor</span>.<a href="CommandProcessorBase.cs.html#a862b2435f52bbdf" class="i method">AddParameter</a>(<span class="r28 r">param</span>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind the argument to the specified parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">argument</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument to be bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flags for type coercion, validation, and script block binding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the parameter was successfully bound. False if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">flags</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> does not have the</span>
        <span class="c">///</span><span class="c"> flag </span><span class="c">&lt;</span><span class="c">see</span><span class="c">&gt;</span><span class="c">ParameterBindingFlags.ShouldCoerceType</span><span class="c">&lt;/</span><span class="c">see</span><span class="c">&gt;</span><span class="c"> and the type does not match the parameter type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If argument transformation fails.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The argument could not be coerced to the appropriate type for the parameter.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The parameter argument transformation, prerequisite, or validation failed.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If the binding to the parameter fails.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The parameter has already been bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="d7bec2a482789f4b" href="../R/d7bec2a482789f4b.html" target="n" data-glyph="74,1" class="i method">BindParameter</a>(
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r31 rd" class="r31 r">argument</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r32 rd" class="r32 r">flags</span>)
        {
            <b>bool</b> <span id="r33 rd" class="r33 r">result</span> = <b>false</b>;
 
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r34 rd" class="r34 r">matchingParameter</span> =
                <a href="#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(
                    <span class="r31 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>,
                    (<span class="r32 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#29b6a605a3b407fe" class="i field">ThrowOnParameterNotFound</a>) != 0,
                    <b>true</b>,
                    <b>new</b> <a href="InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>, <span class="r31 r">argument</span>.<a href="CommandParameter.cs.html#d12a5051b2b93c45" class="i property">ParameterExtent</a>));
 
            <b>if</b> (<span class="r34 r">matchingParameter</span> != <b>null</b>)
            {
                <span class="c">// Now check to make sure it hasn&#39;t already been</span>
                <span class="c">// bound by looking in the boundParameters collection</span>
 
                <b>if</b> (<a href="#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<span class="r34 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r35 rd" class="r35 r">bindingException</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>,
                            <a href="#3227307065b1eace" class="i method">GetParameterErrorExtent</a>(<span class="r31 r">argument</span>),
                            <span class="r31 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>,
                            <b>null</b>,
                            <b>null</b>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                            <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>));
 
                    <b>throw</b> <span class="r35 r">bindingException</span>;
                }
 
                <span class="r32 r">flags</span> &amp;= ~<a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>;
                <span class="r33 r">result</span> = <a href="#e8ef2838fd93f053" class="i method">BindParameter</a>(<a href="#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <span class="r31 r">argument</span>, <span class="r34 r">matchingParameter</span>, <span class="r32 r">flags</span>);
            }
 
            <b>return</b> <span class="r33 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Derived classes need to define the binding of multiple arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">parameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments to be bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments which are still not bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <a id="00b8c327ea842aa4" href="../R/00b8c327ea842aa4.html" target="n" data-glyph="74,1" class="i method">BindParameters</a>(<span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r36 rd" class="r36 r">parameters</span>)
        {
            <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind the argument to the specified parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">parameterSets</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter set used to bind the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">argument</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument to be bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">parameter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The metadata for the parameter to bind the argument to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flags for type coercion and validation of the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the parameter was successfully bound. False if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">flags</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> specifies no type coercion and the type does not match the parameter type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">parameter</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> or </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">argument</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If argument transformation fails.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The argument could not be coerced to the appropriate type for the parameter.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The parameter argument transformation, prerequisite, or validation failed.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If the binding to the parameter fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="e8ef2838fd93f053" href="../R/e8ef2838fd93f053.html" target="n" data-glyph="74,1" class="i method">BindParameter</a>(
            <b>uint</b> <span id="r37 rd" class="r37 r">parameterSets</span>,
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r38 rd" class="r38 r">argument</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r39 rd" class="r39 r">parameter</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r40 rd" class="r40 r">flags</span>)
        {
            <b>bool</b> <span id="r41 rd" class="r41 r">result</span> = <b>false</b>;
 
            <b>switch</b> (<span class="r39 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#dfdaee66f98b9a67" class="i property">BinderAssociation</a>)
            {
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#515e5d093bc20be2" class="i field">DeclaredFormalParameters</a>:
                    <span class="r41 r">result</span> =
                        <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#af68f8de580249df" class="i method">BindParameter</a>(
                            <span class="r38 r">argument</span>,
                            <span class="r39 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>,
                            <span class="r40 r">flags</span>);
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <b>false</b>,
                        <span class="s">&quot;Only the formal parameters are available for this type of command&quot;</span>);
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r41 r">result</span> &amp;&amp; ((<span class="r40 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#765bb2966dedd770" class="i field">IsDefaultValue</a>) == 0))
            {
                <a href="#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Remove</span>(<span class="r39 r">parameter</span>);
                <a href="#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">Add</span>(<span class="r39 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r39 r">parameter</span>);
            }
 
            <b>return</b> <span class="r41 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is used by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b49f6e6866858d41" class="i method">BindNamedParameters</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to validate and bind a given named parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="5d2d522698592395" href="../R/5d2d522698592395.html" target="n" data-glyph="75,1" class="i method">BindNamedParameter</a>(
            <b>uint</b> <span id="r42 rd" class="r42 r">parameterSets</span>,
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r43 rd" class="r43 r">argument</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r44 rd" class="r44 r">parameter</span>)
        {
            <a href="#e8ef2838fd93f053" class="i method">BindParameter</a>(<span class="r42 r">parameterSets</span>, <span class="r43 r">argument</span>, <span class="r44 r">parameter</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind the named parameters from the specified argument collection,</span>
        <span class="c">///</span><span class="c"> for only the parameters in the specified parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">parameterSets</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter set used to bind the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments that should be attempted to bind to the parameters of the specified parameter binder.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if multiple parameters are found matching the name.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> if no match could be found.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If argument transformation fails.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The argument could not be coerced to the appropriate type for the parameter.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The parameter argument transformation, prerequisite, or validation failed.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If the binding to the parameter fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <a id="b49f6e6866858d41" href="../R/b49f6e6866858d41.html" target="n" data-glyph="75,1" class="i method">BindNamedParameters</a>(<b>uint</b> <span id="r45 rd" class="r45 r">parameterSets</span>, <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r46 rd" class="r46 r">arguments</span>)
        {
            <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r47 rd" class="r47 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;();
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r48 rd" class="r48 r">boundExplicitNamedParams</span> = <b>null</b>;
 
            <b>foreach</b> (<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r49 rd" class="r49 r">argument</span> <b>in</b> <span class="r46 r">arguments</span>)
            {
                <b>if</b> (!<span class="r49 r">argument</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a>)
                {
                    <span class="r47 r">result</span>.<span class="i">Add</span>(<span class="r49 r">argument</span>);
                    <b>continue</b>;
                }
 
                <span class="c">// We don&#39;t want to throw an exception yet because the parameter might be a positional argument,</span>
                <span class="c">// or in case of a cmdlet or an advanced function, it might match up to a dynamic parameter.</span>
                <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r50 rd" class="r50 r">parameter</span> =
                    <a href="#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(
                        <span class="r51 r">name</span>: <span class="r49 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>,
                        <span class="r52 r">throwOnParameterNotFound</span>: <b>false</b>,
                        <span class="r53 r">tryExactMatching</span>: <b>true</b>,
                        <span class="r54 r">invocationInfo</span>: <b>new</b> <a href="InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>, <span class="r49 r">argument</span>.<a href="CommandParameter.cs.html#d12a5051b2b93c45" class="i property">ParameterExtent</a>));
 
                <span class="c">// If the parameter is not in the specified parameter set, throw a binding exception</span>
                <b>if</b> (<span class="r50 r">parameter</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r55 rd" class="r55 r">formalParamName</span> = <span class="r50 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
 
                    <b>if</b> (<span class="r49 r">argument</span>.<a href="CommandParameter.cs.html#71a176d2010d8e7c" class="i property">FromHashtableSplatting</a>)
                    {
                        <span class="r48 r">boundExplicitNamedParams</span> ??= <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(
                            <a href="#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">Keys</span>,
                            <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                        <b>if</b> (<span class="r48 r">boundExplicitNamedParams</span>.<span class="i">Contains</span>(<span class="r55 r">formalParamName</span>))
                        {
                            <span class="c">// This named parameter from splatting is also explicitly specified by the user,</span>
                            <span class="c">// which was successfully bound, so we ignore the one from splatting because it</span>
                            <span class="c">// is superceded by the explicit one. For example:</span>
                            <span class="c">//   $splat = @{ Path = $path1 }</span>
                            <span class="c">//   dir @splat -Path $path2</span>
                            <b>continue</b>;
                        }
                    }
 
                    <span class="c">// Now check to make sure it hasn&#39;t already been</span>
                    <span class="c">// bound by looking in the boundParameters collection</span>
 
                    <b>if</b> (<a href="#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<span class="r55 r">formalParamName</span>))
                    {
                        <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r56 rd" class="r56 r">bindingException</span> =
                            <b>new</b> <span class="t">ParameterBindingException</span>(
                                <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>,
                                <a href="#3227307065b1eace" class="i method">GetParameterErrorExtent</a>(<span class="r49 r">argument</span>),
                                <span class="r49 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>,
                                <b>null</b>,
                                <b>null</b>,
                                <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                                <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>));
 
                        <b>throw</b> <span class="r56 r">bindingException</span>;
                    }
 
                    <a href="#5d2d522698592395" class="i method">BindNamedParameter</a>(<span class="r45 r">parameterSets</span>, <span class="r49 r">argument</span>, <span class="r50 r">parameter</span>);
                }
                <b>else</b> <b>if</b> (<span class="r49 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>.<span class="i">Equals</span>(<a href="parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="parser/Parser.cs.html#7d52fa9f4230b072" class="i field">VERBATIM_PARAMETERNAME</a>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <span class="c">// We sometimes send a magic parameter from a remote machine with the values referenced via</span>
                    <span class="c">// a using expression ($using:x).  We then access these values via PSBoundParameters, so</span>
                    <span class="c">// &quot;bind&quot; them here.</span>
                    <a href="#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#4555288f0b3927cb" class="i property">CommandLineParameters</a>.<a href="ParameterBinderBase.cs.html#ebd10d420500ef5c" class="i method">SetImplicitUsingParameters</a>(<span class="r49 r">argument</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>);
                }
                <b>else</b>
                {
                    <span class="r47 r">result</span>.<span class="i">Add</span>(<span class="r49 r">argument</span>);
                }
            }
 
            <b>return</b> <span class="r47 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the unbound arguments to positional parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">unboundArguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The unbound arguments to attempt to bind as positional arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">validParameterSets</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current parameter set flags that are valid.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">defaultParameterSet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter set to use to disambiguate parameters that have the same position</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">outgoingBindingException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the underlying parameter binding exception if any was generated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The remaining arguments that have not been bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It is assumed that the unboundArguments parameter has already been processed</span>
        <span class="c">///</span><span class="c"> for this parameter binder. All named parameters have been paired with their</span>
        <span class="c">///</span><span class="c"> values. Any arguments that don&#39;t have a name are considered positional and</span>
        <span class="c">///</span><span class="c"> will be processed in this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If multiple parameters were found for the same position in the specified</span>
        <span class="c">///</span><span class="c"> parameter set.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If argument transformation fails.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The argument could not be coerced to the appropriate type for the parameter.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The parameter argument transformation, prerequisite, or validation failed.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If the binding to the parameter fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <a id="9078ab3976c11a31" href="../R/9078ab3976c11a31.html" target="n" data-glyph="74,1" class="i method">BindPositionalParameters</a>(
            <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r57 rd" class="r57 r">unboundArguments</span>,
            <b>uint</b> <span id="r58 rd" class="r58 r">validParameterSets</span>,
            <b>uint</b> <span id="r59 rd" class="r59 r">defaultParameterSet</span>,
            <b>out</b> <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r60 rd" class="r60 r">outgoingBindingException</span>
            )
        {
            <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r61 rd" class="r61 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;();
            <span class="r60 r">outgoingBindingException</span> = <b>null</b>;
 
            <b>if</b> (<span class="r57 r">unboundArguments</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Create a new collection to iterate over so that we can remove</span>
                <span class="c">// unbound arguments while binding them.</span>
 
                <span class="i">List</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r62 rd" class="r62 r">unboundArgumentsCollection</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;(<span class="r57 r">unboundArguments</span>);
 
                <span class="c">// Get a sorted dictionary of the positional parameters with the position</span>
                <span class="c">// as the key</span>
 
                <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;&gt; <span id="r63 rd" class="r63 r">positionalParameterDictionary</span>;
 
                <b>try</b>
                {
                    <span class="r63 r">positionalParameterDictionary</span> =
                        <span class="i">EvaluateUnboundPositionalParameters</span>(<a href="#717e40a5f982f97b" class="i property">UnboundParameters</a>, <a href="#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>);
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span>)
                {
                    <span class="c">// The parameter set declaration is ambiguous so</span>
                    <span class="c">// throw an exception.</span>
 
                    <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r64 rd" class="r64 r">bindingException</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>,
                            <b>null</b>,
                            <b>null</b>,
                            <b>null</b>,
                            <b>null</b>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">AmbiguousPositionalParameterNoName</span>,
                            <span class="s">&quot;AmbiguousPositionalParameterNoName&quot;</span>);
 
                    <span class="c">// This exception is thrown because the binder found two positional parameters</span>
                    <span class="c">// from the same parameter set with the same position defined. This is not caused</span>
                    <span class="c">// by introducing the default parameter binding.</span>
                    <b>throw</b> <span class="r64 r">bindingException</span>;
                }
 
                <b>if</b> (<span class="r63 r">positionalParameterDictionary</span>.<span class="i">Count</span> &gt; 0)
                {
                    <b>int</b> <span id="r65 rd" class="r65 r">unboundArgumentsIndex</span> = 0;
 
                    <b>foreach</b> (<span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r66 rd" class="r66 r">nextPositionalParameters</span> <b>in</b> <span class="r63 r">positionalParameterDictionary</span>.<span class="i">Values</span>)
                    {
                        <span class="c">// Only continue if there are parameters at the specified position. Parameters</span>
                        <span class="c">// can be removed as the parameter set gets narrowed down.</span>
 
                        <b>if</b> (<span class="r66 r">nextPositionalParameters</span>.<span class="i">Count</span> == 0)
                        {
                            <b>continue</b>;
                        }
 
                        <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r67 rd" class="r67 r">argument</span> = <a href="#831c4f4ecefe7c52" class="i method">GetNextPositionalArgument</a>(
                            <span class="r62 r">unboundArgumentsCollection</span>,
                            <span class="r61 r">result</span>,
                            <b>ref</b> <span class="r65 r">unboundArgumentsIndex</span>);
 
                        <b>if</b> (<span class="r67 r">argument</span> == <b>null</b>)
                        {
                            <b>break</b>;
                        }
 
                        <span class="c">// Bind first to defaultParameterSet without type coercion, then to</span>
                        <span class="c">// other sets without type coercion, then to the defaultParameterSet with</span>
                        <span class="c">// type coercion and finally to the other sets with type coercion.</span>
 
                        <b>bool</b> <span id="r68 rd" class="r68 r">aParameterWasBound</span> = <b>false</b>;
                        <b>if</b> (<span class="r59 r">defaultParameterSet</span> != 0 &amp;&amp; (<span class="r58 r">validParameterSets</span> &amp; <span class="r59 r">defaultParameterSet</span>) != 0)
                        {
                            <span class="c">// Favor the default parameter set.</span>
                            <span class="c">// First try without type coercion</span>
 
                            <span class="r68 r">aParameterWasBound</span> =
                                <a href="#41926839e7a869ee" class="i method">BindPositionalParametersInSet</a>(
                                    <span class="r59 r">defaultParameterSet</span>,
                                    <span class="r66 r">nextPositionalParameters</span>,
                                    <span class="r67 r">argument</span>,
                                    <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>,
                                    <b>out</b> <span class="r60 r">outgoingBindingException</span>);
                        }
 
                        <b>if</b> (!<span class="r68 r">aParameterWasBound</span>)
                        {
                            <span class="c">// Try the non-default parameter sets</span>
                            <span class="c">// without type coercion.</span>
 
                            <span class="r68 r">aParameterWasBound</span> =
                                <a href="#41926839e7a869ee" class="i method">BindPositionalParametersInSet</a>(
                                    <span class="r58 r">validParameterSets</span>,
                                    <span class="r66 r">nextPositionalParameters</span>,
                                    <span class="r67 r">argument</span>,
                                    <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>,
                                    <b>out</b> <span class="r60 r">outgoingBindingException</span>);
                        }
 
                        <b>if</b> (!<span class="r68 r">aParameterWasBound</span>)
                        {
                            <span class="c">// Now try the default parameter set with type coercion</span>
                            <b>if</b> (<span class="r59 r">defaultParameterSet</span> != 0 &amp;&amp; (<span class="r58 r">validParameterSets</span> &amp; <span class="r59 r">defaultParameterSet</span>) != 0)
                            {
                                <span class="c">// Favor the default parameter set.</span>
                                <span class="c">// First try without type coercion</span>
 
                                <span class="r68 r">aParameterWasBound</span> =
                                    <a href="#41926839e7a869ee" class="i method">BindPositionalParametersInSet</a>(
                                        <span class="r59 r">defaultParameterSet</span>,
                                        <span class="r66 r">nextPositionalParameters</span>,
                                        <span class="r67 r">argument</span>,
                                        <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a> | <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>,
                                        <b>out</b> <span class="r60 r">outgoingBindingException</span>);
                            }
                        }
 
                        <b>if</b> (!<span class="r68 r">aParameterWasBound</span>)
                        {
                            <span class="c">// Try the non-default parameter sets</span>
                            <span class="c">// with type coercion.</span>
 
                            <span class="r68 r">aParameterWasBound</span> =
                                <a href="#41926839e7a869ee" class="i method">BindPositionalParametersInSet</a>(
                                    <span class="r58 r">validParameterSets</span>,
                                    <span class="r66 r">nextPositionalParameters</span>,
                                    <span class="r67 r">argument</span>,
                                    <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a> | <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>,
                                    <b>out</b> <span class="r60 r">outgoingBindingException</span>);
                        }
 
                        <b>if</b> (!<span class="r68 r">aParameterWasBound</span>)
                        {
                            <span class="c">// Add the unprocessed argument to the results and continue</span>
                            <span class="r61 r">result</span>.<span class="i">Add</span>(<span class="r67 r">argument</span>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// Update the parameter sets if necessary</span>
                            <b>if</b> (<span class="r58 r">validParameterSets</span> != <a href="#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>)
                            {
                                <span class="r58 r">validParameterSets</span> = <a href="#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>;
                                <a href="#478d5b369d26a74b" class="i method">UpdatePositionalDictionary</a>(<span class="r63 r">positionalParameterDictionary</span>, <span class="r58 r">validParameterSets</span>);
                            }
                        }
                    }
 
                    <span class="c">// Now for any arguments that were not processed, add them to</span>
                    <span class="c">// the result</span>
 
                    <b>for</b> (<b>int</b> <span id="r69 rd" class="r69 r">index</span> = <span class="r65 r">unboundArgumentsIndex</span>; <span class="r69 r">index</span> &lt; <span class="r62 r">unboundArgumentsCollection</span>.<span class="i">Count</span>; ++<span class="r69 r">index</span>)
                    {
                        <span class="r61 r">result</span>.<span class="i">Add</span>(<span class="r62 r">unboundArgumentsCollection</span>[<span class="r69 r">index</span>]);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// Since no positional parameters were found, add the arguments</span>
                    <span class="c">// to the result</span>
 
                    <span class="r61 r">result</span> = <span class="r57 r">unboundArguments</span>;
                }
            }
 
            <b>return</b> <span class="r61 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method only updates the collections contained in the dictionary, not the dictionary</span>
        <span class="c">///</span><span class="c"> itself to contain only the parameters that are in the specified parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">positionalParameterDictionary</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The sorted dictionary of positional parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">validParameterSets</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Valid parameter sets</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="478d5b369d26a74b" href="../R/478d5b369d26a74b.html" target="n" data-glyph="74,1" class="i method">UpdatePositionalDictionary</a>(
            <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;&gt; <span id="r70 rd" class="r70 r">positionalParameterDictionary</span>,
            <b>uint</b> <span id="r71 rd" class="r71 r">validParameterSets</span>)
        {
            <b>foreach</b> (<span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r72 rd" class="r72 r">parameterCollection</span> <b>in</b> <span class="r70 r">positionalParameterDictionary</span>.<span class="i">Values</span>)
            {
                <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r73 rd" class="r73 r">paramToRemove</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;();
 
                <b>foreach</b> (<a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a> <span id="r74 rd" class="r74 r">positionalParameter</span> <b>in</b> <span class="r72 r">parameterCollection</span>.<span class="i">Values</span>)
                {
                    <span class="i">Collection</span>&lt;<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a>&gt; <span id="r75 rd" class="r75 r">parameterSetData</span> = <span class="r74 r">positionalParameter</span>.<a href="PositionalCommandParameter.cs.html#98c95f23f61d5629" class="i property">ParameterSetData</a>;
 
                    <b>for</b> (<b>int</b> <span id="r76 rd" class="r76 r">index</span> = <span class="r75 r">parameterSetData</span>.<span class="i">Count</span> - 1; <span class="r76 r">index</span> &gt;= 0; --<span class="r76 r">index</span>)
                    {
                        <b>if</b> ((<span class="r75 r">parameterSetData</span>[<span class="r76 r">index</span>].<span class="i">ParameterSetFlag</span> &amp; <span class="r71 r">validParameterSets</span>) == 0 &amp;&amp;
                            !<span class="r75 r">parameterSetData</span>[<span class="r76 r">index</span>].<span class="i">IsInAllSets</span>)
                        {
                            <span class="c">// The parameter is not in the valid parameter sets so remove it from the collection.</span>
                            <span class="r75 r">parameterSetData</span>.<span class="i">RemoveAt</span>(<span class="r76 r">index</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r75 r">parameterSetData</span>.<span class="i">Count</span> == 0)
                    {
                        <span class="r73 r">paramToRemove</span>.<span class="i">Add</span>(<span class="r74 r">positionalParameter</span>.<a href="PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>);
                    }
                }
 
                <span class="c">// Now remove all the parameters that no longer have parameter set data</span>
                <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r77 rd" class="r77 r">removeParam</span> <b>in</b> <span class="r73 r">paramToRemove</span>)
                {
                    <span class="r72 r">parameterCollection</span>.<span class="i">Remove</span>(<span class="r77 r">removeParam</span>);
                }
            }
        }
 
        <b>private bool</b> <a id="41926839e7a869ee" href="../R/41926839e7a869ee.html" target="n" data-glyph="76,1" class="i method">BindPositionalParametersInSet</a>(
            <b>uint</b> <span id="r78 rd" class="r78 r">validParameterSets</span>,
            <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r79 rd" class="r79 r">nextPositionalParameters</span>,
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r80 rd" class="r80 r">argument</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r81 rd" class="r81 r">flags</span>,
            <b>out</b> <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r82 rd" class="r82 r">bindingException</span>
            )
        {
            <b>bool</b> <span id="r83 rd" class="r83 r">result</span> = <b>false</b>;
            <span class="r82 r">bindingException</span> = <b>null</b>;
 
            <b>foreach</b> (<a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a> <span id="r84 rd" class="r84 r">parameter</span> <b>in</b> <span class="r79 r">nextPositionalParameters</span>.<span class="i">Values</span>)
            {
                <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r85 rd" class="r85 r">parameterSetData</span> <b>in</b> <span class="r84 r">parameter</span>.<a href="PositionalCommandParameter.cs.html#98c95f23f61d5629" class="i property">ParameterSetData</a>)
                {
                    <span class="c">// if the parameter is not in the specified parameter set, don&#39;t consider it</span>
 
                    <b>if</b> ((<span class="r78 r">validParameterSets</span> &amp; <span class="r85 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a>) == 0 &amp;&amp;
                        !<span class="r85 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#4410808f4575d589" class="i property">IsInAllSets</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>bool</b> <span id="r86 rd" class="r86 r">bindResult</span> = <b>false</b>;
                    <b>string</b> <span id="r87 rd" class="r87 r">parameterName</span> = <span class="r84 r">parameter</span>.<a href="PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
 
                    <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r88 rd" class="r88 r">parameterBindingExceptionToThrown</span> = <b>null</b>;
                    <b>try</b>
                    {
                        <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r89 rd" class="r89 r">bindableArgument</span> =
                            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                                <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r87 r">parameterName</span>, <span class="s">&quot;-&quot;</span> + <span class="r87 r">parameterName</span> + <span class="s">&quot;:&quot;</span>,
                                <span class="r80 r">argument</span>.<a href="CommandParameter.cs.html#74477d6db015267b" class="i property">ArgumentAst</a>, <span class="r80 r">argument</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>,
                                <b>false</b>);
 
                        <span class="r86 r">bindResult</span> =
                            <a href="#e8ef2838fd93f053" class="i method">BindParameter</a>(
                                <span class="r78 r">validParameterSets</span>,
                                <span class="r89 r">bindableArgument</span>,
                                <span class="r84 r">parameter</span>.<a href="PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>,
                                <span class="r81 r">flags</span>);
                    }
                    <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#3585a1c095cead84" class="t t">ParameterBindingArgumentTransformationException</a> <span id="r90 rd" class="r90 r">pbex</span>)
                    {
                        <span class="r88 r">parameterBindingExceptionToThrown</span> = <span class="r90 r">pbex</span>;
                    }
                    <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#e39f77ef0b39d632" class="t t">ParameterBindingValidationException</a> <span id="r91 rd" class="r91 r">pbex</span>)
                    {
                        <b>if</b> (<span class="r91 r">pbex</span>.<a href="../utils/ParameterBinderExceptions.cs.html#8932b690fd0638f2" class="i property">SwallowException</a>)
                        {
                            <span class="c">// Just ignore and continue</span>
                            <span class="r86 r">bindResult</span> = <b>false</b>;
                            <span class="r82 r">bindingException</span> = <span class="r91 r">pbex</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r88 r">parameterBindingExceptionToThrown</span> = <span class="r91 r">pbex</span>;
                        }
                    }
                    <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#025f44cd23269a6e" class="t t">ParameterBindingParameterDefaultValueException</a> <span id="r92 rd" class="r92 r">pbex</span>)
                    {
                        <span class="r88 r">parameterBindingExceptionToThrown</span> = <span class="r92 r">pbex</span>;
                    }
                    <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r93 rd" class="r93 r">e</span>)
                    {
                        <span class="c">// Just ignore and continue;</span>
                        <span class="r86 r">bindResult</span> = <b>false</b>;
                        <span class="r82 r">bindingException</span> = <span class="r93 r">e</span>;
                    }
 
                    <b>if</b> (<span class="r88 r">parameterBindingExceptionToThrown</span> != <b>null</b>)
                    {
                        <b>if</b> (!<a href="#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                        {
                            <b>throw</b> <span class="r88 r">parameterBindingExceptionToThrown</span>;
                        }
                        <b>else</b>
                        {
                            <a href="#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r88 r">parameterBindingExceptionToThrown</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r86 r">bindResult</span>)
                    {
                        <span class="r83 r">result</span> = <b>true</b>;
                        <a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#0b62798bea43a39e" class="i property">CommandLineParameters</a>.<a href="ParameterBinderBase.cs.html#300462d4aee417ae" class="i method">MarkAsBoundPositionally</a>(<span class="r87 r">parameterName</span>);
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r83 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generate elaborated binding exception so that the user will know the default binding might cause the failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">pbex</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="a9066724fc9cbe64" href="../R/a9066724fc9cbe64.html" target="n" data-glyph="75,1" class="i method">ThrowElaboratedBindingException</a>(<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r94 rd" class="r94 r">pbex</span>)
        {
            <b>if</b> (<span class="r94 r">pbex</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r94 r">pbex</span>));
            }
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r94 r">pbex</span>.<a href="../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a> != <b>null</b>, <span class="s">&quot;ErrorRecord should not be null in a ParameterBindingException&quot;</span>);
 
            <span class="c">// Original error message</span>
            <b>string</b> <span id="r95 rd" class="r95 r">oldMsg</span> = <span class="r94 r">pbex</span>.<a href="../utils/ParameterBinderExceptions.cs.html#ddf6dbf1298aeb68" class="i property">Message</a>;
            <span class="c">// Default parameters get bound so far</span>
            <span class="i">StringBuilder</span> <span id="r96 rd" class="r96 r">defaultParamsGetBound</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>foreach</b> (<b>string</b> <span id="r97 rd" class="r97 r">paramName</span> <b>in</b> <a href="#1cc9eda224499cdc" class="i property">BoundDefaultParameters</a>)
            {
                <span class="r96 r">defaultParamsGetBound</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot; -{0}&quot;</span>, <span class="r97 r">paramName</span>);
            }
 
            <b>string</b> <span id="r98 rd" class="r98 r">resourceString</span> = <span class="i">ParameterBinderStrings</span>.<span class="i">DefaultBindingErrorElaborationSingle</span>;
            <b>if</b> (<a href="#1cc9eda224499cdc" class="i property">BoundDefaultParameters</a>.<span class="i">Count</span> &gt; 1)
            {
                <span class="r98 r">resourceString</span> = <span class="i">ParameterBinderStrings</span>.<span class="i">DefaultBindingErrorElaborationMultiple</span>;
            }
 
            <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r99 rd" class="r99 r">newBindingException</span> =
                <b>new</b> <span class="t">ParameterBindingException</span>(
                    <span class="r94 r">pbex</span>.<span class="i">InnerException</span>,
                    <span class="r94 r">pbex</span>,
                    <span class="r98 r">resourceString</span>,
                    <span class="r95 r">oldMsg</span>, <span class="r96 r">defaultParamsGetBound</span>);
 
            <b>throw</b> <span class="r99 r">newBindingException</span>;
        }
 
        <b>private static</b> <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <a id="831c4f4ecefe7c52" href="../R/831c4f4ecefe7c52.html" target="n" data-glyph="76,1" class="i method">GetNextPositionalArgument</a>(
            <span class="i">List</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r100 rd" class="r100 r">unboundArgumentsCollection</span>,
            <span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r101 rd" class="r101 r">nonPositionalArguments</span>,
            <b>ref int</b> <span id="r102 rd" class="r102 r">unboundArgumentsIndex</span>)
        {
            <span class="c">// Find the next positional argument</span>
            <span class="c">// An argument without a name is considered to be positional since</span>
            <span class="c">// we are assuming the unboundArguments have been reparsed using</span>
            <span class="c">// the merged metadata from this parameter binder controller.</span>
 
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r103 rd" class="r103 r">result</span> = <b>null</b>;
            <b>while</b> (<span class="r102 r">unboundArgumentsIndex</span> &lt; <span class="r100 r">unboundArgumentsCollection</span>.<span class="i">Count</span>)
            {
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r104 rd" class="r104 r">argument</span> = <span class="r100 r">unboundArgumentsCollection</span>[<span class="r102 r">unboundArgumentsIndex</span>++];
 
                <b>if</b> (!<span class="r104 r">argument</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a>)
                {
                    <span class="r103 r">result</span> = <span class="r104 r">argument</span>;
                    <b>break</b>;
                }
 
                <span class="r101 r">nonPositionalArguments</span>.<span class="i">Add</span>(<span class="r104 r">argument</span>);
 
                <span class="c">// Now check to see if the next argument needs to be consumed as well.</span>
 
                <b>if</b> (<span class="r100 r">unboundArgumentsCollection</span>.<span class="i">Count</span> - 1 &gt;= <span class="r102 r">unboundArgumentsIndex</span>)
                {
                    <span class="r104 r">argument</span> = <span class="r100 r">unboundArgumentsCollection</span>[<span class="r102 r">unboundArgumentsIndex</span>];
 
                    <b>if</b> (!<span class="r104 r">argument</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a>)
                    {
                        <span class="c">// Since the next argument doesn&#39;t appear to be a parameter name</span>
                        <span class="c">// consume it as well.</span>
 
                        <span class="r101 r">nonPositionalArguments</span>.<span class="i">Add</span>(<span class="r104 r">argument</span>);
                        <span class="r102 r">unboundArgumentsIndex</span>++;
                    }
                }
            }
 
            <b>return</b> <span class="r103 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the unbound positional parameters in a sorted dictionary in the order of their</span>
        <span class="c">///</span><span class="c"> positions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The sorted dictionary of MergedCompiledCommandParameter metadata with the position</span>
        <span class="c">///</span><span class="c"> as the key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;&gt; <a id="a424407f33ebaeb1" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">EvaluateUnboundPositionalParameters</a>(
            <span class="i">ICollection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r105 rd" class="r105 r">unboundParameters</span>, <b>uint</b> <span id="r106 rd" class="r106 r">validParameterSetFlag</span>)
        {
            <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;&gt; <span id="r107 rd" class="r107 r">result</span> =
                <b>new</b> <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;&gt;();
 
            <b>if</b> (<span class="r105 r">unboundParameters</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Loop through the unbound parameters and find a parameter in the specified parameter set</span>
                <span class="c">// that has a position greater than or equal to the positionalParameterIndex</span>
 
                <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r108 rd" class="r108 r">parameter</span> <b>in</b> <span class="r105 r">unboundParameters</span>)
                {
                    <b>bool</b> <span id="r109 rd" class="r109 r">isInParameterSet</span> = (<span class="r108 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <span class="r106 r">validParameterSetFlag</span>) != 0 || <span class="r108 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>;
 
                    <b>if</b> (<span class="r109 r">isInParameterSet</span>)
                    {
                        <b>var</b> <span id="r110 rd" class="r110 r">parameterSetDataCollection</span> = <span class="r108 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<span class="r106 r">validParameterSetFlag</span>);
                        <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r111 rd" class="r111 r">parameterSetData</span> <b>in</b> <span class="r110 r">parameterSetDataCollection</span>)
                        {
                            <span class="c">// Skip ValueFromRemainingArguments parameters</span>
                            <b>if</b> (<span class="r111 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a>)
                            {
                                <b>continue</b>;
                            }
 
                            <span class="c">// Check the position in the parameter set</span>
 
                            <b>int</b> <span id="r112 rd" class="r112 r">positionInParameterSet</span> = <span class="r111 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#5fe039f108b3ea8f" class="i property">Position</a>;
 
                            <b>if</b> (<span class="r112 r">positionInParameterSet</span> == <b>int</b>.<span class="i">MinValue</span>)
                            {
                                <span class="c">// The parameter is not positional so go to the next one</span>
                                <b>continue</b>;
                            }
 
                            <a href="#d901bd3c301aa391" class="i method">AddNewPosition</a>(<span class="r107 r">result</span>, <span class="r112 r">positionInParameterSet</span>, <span class="r108 r">parameter</span>, <span class="r111 r">parameterSetData</span>);
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r107 r">result</span>;
        }
 
        <b>private static void</b> <a id="d901bd3c301aa391" href="../R/d901bd3c301aa391.html" target="n" data-glyph="76,1" class="i method">AddNewPosition</a>(
            <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;&gt; <span id="r113 rd" class="r113 r">result</span>,
            <b>int</b> <span id="r114 rd" class="r114 r">positionInParameterSet</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r115 rd" class="r115 r">parameter</span>,
            <a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r116 rd" class="r116 r">parameterSetData</span>)
        {
            <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r117 rd" class="r117 r">positionalCommandParameters</span>;
            <b>if</b> (<span class="r113 r">result</span>.<span class="i">TryGetValue</span>(<span class="r114 r">positionInParameterSet</span>, <b>out</b> <span class="r117 r">positionalCommandParameters</span>))
            {
                <span class="c">// Check to see if any of the other parameters in this position are in the same parameter set.</span>
                <b>if</b> (<a href="#44633fec75baf2de" class="i method">ContainsPositionalParameterInSet</a>(<span class="r117 r">positionalCommandParameters</span>, <span class="r115 r">parameter</span>, <span class="r116 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a>))
                {
                    <span class="c">// Multiple parameters were found with the same</span>
                    <span class="c">// position. This means the parameter set is ambiguous.</span>
 
                    <span class="c">// positional parameter could not be resolved</span>
 
                    <span class="c">// We throw InvalidOperationException, which the</span>
                    <span class="c">// caller will catch and throw a more</span>
                    <span class="c">// appropriate exception.</span>
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                }
 
                <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a> <span id="r118 rd" class="r118 r">positionalCommandParameter</span>;
                <b>if</b> (!<span class="r117 r">positionalCommandParameters</span>.<span class="i">TryGetValue</span>(<span class="r115 r">parameter</span>, <b>out</b> <span class="r118 r">positionalCommandParameter</span>))
                {
                    <span class="r118 r">positionalCommandParameter</span> = <b>new</b> <a href="PositionalCommandParameter.cs.html#dfee7f161235e1a3" class="t constructor">PositionalCommandParameter</a>(<span class="r115 r">parameter</span>);
                    <span class="r117 r">positionalCommandParameters</span>.<span class="i">Add</span>(<span class="r115 r">parameter</span>, <span class="r118 r">positionalCommandParameter</span>);
                }
 
                <span class="r118 r">positionalCommandParameter</span>.<a href="PositionalCommandParameter.cs.html#98c95f23f61d5629" class="i property">ParameterSetData</a>.<span class="i">Add</span>(<span class="r116 r">parameterSetData</span>);
            }
            <b>else</b>
            {
                <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r119 rd" class="r119 r">newPositionDictionary</span> =
                    <b>new</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;();
 
                <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a> <span id="r120 rd" class="r120 r">newPositionalParameter</span> = <b>new</b> <a href="PositionalCommandParameter.cs.html#dfee7f161235e1a3" class="t constructor">PositionalCommandParameter</a>(<span class="r115 r">parameter</span>);
                <span class="r120 r">newPositionalParameter</span>.<a href="PositionalCommandParameter.cs.html#98c95f23f61d5629" class="i property">ParameterSetData</a>.<span class="i">Add</span>(<span class="r116 r">parameterSetData</span>);
                <span class="r119 r">newPositionDictionary</span>.<span class="i">Add</span>(<span class="r115 r">parameter</span>, <span class="r120 r">newPositionalParameter</span>);
 
                <span class="r113 r">result</span>.<span class="i">Add</span>(<span class="r114 r">positionInParameterSet</span>, <span class="r119 r">newPositionDictionary</span>);
            }
        }
 
        <b>private static bool</b> <a id="44633fec75baf2de" href="../R/44633fec75baf2de.html" target="n" data-glyph="76,1" class="i method">ContainsPositionalParameterInSet</a>(
            <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r121 rd" class="r121 r">positionalCommandParameters</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r122 rd" class="r122 r">parameter</span>,
            <b>uint</b> <span id="r123 rd" class="r123 r">parameterSet</span>)
        {
            <b>bool</b> <span id="r124 rd" class="r124 r">result</span> = <b>false</b>;
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r125 rd" class="r125 r">pair</span> <b>in</b> <span class="r121 r">positionalCommandParameters</span>)
            {
                <span class="c">// It&#39;s OK to have the same parameter</span>
                <b>if</b> (<span class="r125 r">pair</span>.<span class="i">Key</span> == <span class="r122 r">parameter</span>)
                {
                    <b>continue</b>;
                }
 
                <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r126 rd" class="r126 r">parameterSetData</span> <b>in</b> <span class="r125 r">pair</span>.<span class="i">Value</span>.<span class="i">ParameterSetData</span>)
                {
                    <b>if</b> ((<span class="r126 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a> &amp; <span class="r123 r">parameterSet</span>) != 0 ||
                        <span class="r126 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a> == <span class="r123 r">parameterSet</span>)
                    {
                        <span class="r124 r">result</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r124 r">result</span>)
                {
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r124 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Keeps track of the parameters that get bound through pipeline input, so that their</span>
        <span class="c">///</span><span class="c"> previous values can be restored before the next pipeline input comes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="d0bd55d2c98c7d2a" href="../R/d0bd55d2c98c7d2a.html" target="n" data-glyph="104,1" class="i property">ParametersBoundThroughPipelineInput</a> { <b>get</b>; } = <b>new</b> <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For any unbound parameters, this method checks to see if the</span>
        <span class="c">///</span><span class="c"> parameter has a default value specified, and evaluates the expression</span>
        <span class="c">///</span><span class="c"> (if the expression is not constant) and binds the result to the parameter.</span>
        <span class="c">///</span><span class="c"> If not, we bind null to the parameter (which may go through type coercion).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="f631287a37be6f9b" href="../R/f631287a37be6f9b.html" target="n" data-glyph="74,1" class="i method">BindUnboundScriptParameters</a>()
        {
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r127 rd" class="r127 r">parameter</span> <b>in</b> <a href="#717e40a5f982f97b" class="i property">UnboundParameters</a>)
            {
                <a href="#1a97f11b2162cd32" class="i method">BindUnboundScriptParameterWithDefaultValue</a>(<span class="r127 r">parameter</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the parameter binder might use the value more than once, this it can save the value to avoid</span>
        <span class="c">///</span><span class="c"> re-evaluating complicated expressions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="4626fe887d6660f7" href="../R/4626fe887d6660f7.html" target="n" data-glyph="75,1" class="i method">SaveDefaultScriptParameterValue</a>(<b>string</b> <span id="r128 rd" class="r128 r">name</span>, <b>object</b> <span id="r129 rd" class="r129 r">value</span>)
        {
            <span class="c">// By default, parameter binders don&#39;t need to remember the value, the exception being the cmdlet parameter binder.</span>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind the default value for an unbound parameter to script (used by both the script binder</span>
        <span class="c">///</span><span class="c"> and the cmdlet binder).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="1a97f11b2162cd32" href="../R/1a97f11b2162cd32.html" target="n" data-glyph="74,1" class="i method">BindUnboundScriptParameterWithDefaultValue</a>(<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r130 rd" class="r130 r">parameter</span>)
        {
            <a href="scriptparameterbinder.cs.html#070e81280a64ffb7" class="t t">ScriptParameterBinder</a> <span id="r131 rd" class="r131 r">spb</span> = (<a href="scriptparameterbinder.cs.html#070e81280a64ffb7" class="t t">ScriptParameterBinder</a>)<a href="#9e4e49a03a43c579" class="k">this</a>.<a href="#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>;
            <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r132 rd" class="r132 r">script</span> = <span class="r131 r">spb</span>.<a href="scriptparameterbinder.cs.html#b642403a070fddb7" class="i property">Script</a>;
            <a href="PseudoParameters.cs.html#68fb670c5eb25328" class="t t">RuntimeDefinedParameter</a> <span id="r133 rd" class="r133 r">runtimeDefinedParameter</span>;
            <b>if</b> (<span class="r132 r">script</span>.<a href="runtime/CompiledScriptBlock.cs.html#61f3934e64edc598" class="i property">RuntimeDefinedParameters</a>.<span class="i">TryGetValue</span>(<span class="r130 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <b>out</b> <span class="r133 r">runtimeDefinedParameter</span>))
            {
                <b>bool</b> <span id="r134 rd" class="r134 r">oldRecordParameters</span> = <span class="r131 r">spb</span>.<a href="ParameterBinderBase.cs.html#80f311903d85dd3b" class="i field">RecordBoundParameters</a>;
                <b>try</b>
                {
                    <span class="r131 r">spb</span>.<a href="ParameterBinderBase.cs.html#80f311903d85dd3b" class="i field">RecordBoundParameters</a> = <b>false</b>;
 
                    <span class="c">// We may pass a magic parameter from the remote end with the values for the using expressions.</span>
                    <span class="c">// In this case, we want to use those values to evaluate the default value. e.g. param($a = $using:date)</span>
                    <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">IDictionary</span> <span id="r135 rd" class="r135 r">implicitUsingParameters</span> = <b>null</b>;
                    <b>if</b> (<a href="#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#4555288f0b3927cb" class="i property">CommandLineParameters</a> != <b>null</b>)
                    {
                        <span class="r135 r">implicitUsingParameters</span> = <a href="#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#4555288f0b3927cb" class="i property">CommandLineParameters</a>.<a href="ParameterBinderBase.cs.html#12b5ea06f8c115f8" class="i method">GetImplicitUsingParameters</a>();
                    }
 
                    <b>object</b> <span id="r136 rd" class="r136 r">result</span> = <span class="r131 r">spb</span>.<span class="i">GetDefaultScriptParameterValue</span>(<span class="r133 r">runtimeDefinedParameter</span>, <span class="r135 r">implicitUsingParameters</span>);
                    <a href="#4626fe887d6660f7" class="i method">SaveDefaultScriptParameterValue</a>(<span class="r130 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r136 r">result</span>);
                    <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r137 rd" class="r137 r">argument</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                        <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r130 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="s">&quot;-&quot;</span> + <span class="r130 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a> + <span class="s">&quot;:&quot;</span>,
                        <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r136 r">result</span>,
                        <b>false</b>);
                    <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r138 rd" class="r138 r">flags</span> = <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#765bb2966dedd770" class="i field">IsDefaultValue</a>;
                    <span class="c">// Only coerce explicit values.  We default to null, which isn&#39;t always convertible.</span>
                    <b>if</b> (<span class="r133 r">runtimeDefinedParameter</span>.<a href="PseudoParameters.cs.html#82f6794e07fdf6ec" class="i property">IsSet</a>)
                    {
                        <span class="r138 r">flags</span> |= <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>;
                    }
 
                    <span class="i">BindParameter</span>(<b>uint</b>.<span class="i">MaxValue</span>, <span class="r137 r">argument</span>, <span class="r130 r">parameter</span>, <span class="r138 r">flags</span>);
                }
                <b>finally</b>
                {
                    <span class="r131 r">spb</span>.<a href="ParameterBinderBase.cs.html#80f311903d85dd3b" class="i field">RecordBoundParameters</a> = <span class="r134 r">oldRecordParameters</span>;
                }
            }
        }
 
        <b>internal uint</b> <a id="4524af3c017b217b" href="../R/4524af3c017b217b.html" target="n" data-glyph="44,1" class="i field">_currentParameterSetFlag</a> = <b>uint</b>.<span class="i">MaxValue</span>;
        <b>internal uint</b> <a id="fadc9fd52431d28e" href="../R/fadc9fd52431d28e.html" target="n" data-glyph="44,1" class="i field">_prePipelineProcessingParameterSetFlags</a> = <b>uint</b>.<span class="i">MaxValue</span>;
 
        <b>protected</b> <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="a9e5006bea1e5324" href="../R/a9e5006bea1e5324.html" target="n" data-glyph="75,1" class="i method">GetErrorExtent</a>(<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r139 rd" class="r139 r">cpi</span>)
        {
            <a href="parser/Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r140 rd" class="r140 r">result</span> = <span class="r139 r">cpi</span>.<a href="CommandParameter.cs.html#d5b8f6c7dafdc5cb" class="i property">ErrorExtent</a>;
            <b>if</b> (<span class="r140 r">result</span> == <a href="parser/Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="parser/Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>)
                <span class="r140 r">result</span> = <a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>;
            <span class="c">// Can&#39;t use this assertion - we don&#39;t have useful positions when invoked via PowerShell API</span>
            <span class="c">// Diagnostics.Assert(result != PositionUtilities.EmptyExtent, &quot;We are missing a valid position somewhere&quot;);</span>
            <b>return</b> <span class="r140 r">result</span>;
        }
 
        <b>protected</b> <a href="parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="3227307065b1eace" href="../R/3227307065b1eace.html" target="n" data-glyph="75,1" class="i method">GetParameterErrorExtent</a>(<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r141 rd" class="r141 r">cpi</span>)
        {
            <a href="parser/Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r142 rd" class="r142 r">result</span> = <span class="r141 r">cpi</span>.<a href="CommandParameter.cs.html#d12a5051b2b93c45" class="i property">ParameterExtent</a>;
            <b>if</b> (<span class="r142 r">result</span> == <a href="parser/Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="parser/Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>)
                <span class="r142 r">result</span> = <a href="#e0677962cb6d3e17" class="i property">InvocationInfo</a>.<a href="InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>;
            <span class="c">// Can&#39;t use this assertion - we don&#39;t have useful positions when invoked via PowerShell API</span>
            <span class="c">// Diagnostics.Assert(result != PositionUtilities.EmptyExtent, &quot;We are missing a valid position somewhere&quot;);</span>
            <b>return</b> <span class="r142 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> internal_members
    }
}
</pre></td></tr></table></div></body></html>
