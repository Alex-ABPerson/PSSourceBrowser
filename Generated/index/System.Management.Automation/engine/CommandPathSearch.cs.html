<!DOCTYPE html>
<html><head><title>CommandPathSearch.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(589);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CommandPathSearch.cs" target="_top">engine\CommandPathSearch.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Used to enumerate the commands on the system that match the specified</span>
    <span class="c">///</span><span class="c"> command name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="edd9b71bf4db52b8" href="../R/edd9b71bf4db52b8.html" target="n" data-glyph="2,0" class="t t">CommandPathSearch</a> : <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;, <span class="i">IEnumerator</span>&lt;<b>string</b>&gt;
    {
        [<span class="i">TraceSource</span>(<span class="s">&quot;CommandSearch&quot;</span>, <span class="s">&quot;CommandSearch&quot;</span>)]
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="0a8fee3aa3f16708" href="../R/0a8fee3aa3f16708.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;CommandSearch&quot;</span>, <span class="s">&quot;CommandSearch&quot;</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs a command searching enumerator that resolves the location</span>
        <span class="c">///</span><span class="c"> of a command using the PATH environment variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command name to search for in the path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">lookupPaths</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The paths to directories in which to lookup the command.</span>
        <span class="c">///</span><span class="c"> Ex.null: paths from PATH environment variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The execution context for the current engine instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">acceptableCommandNames</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The patterns to search for in the paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">useFuzzyMatch</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use likely relevant search.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="3f5640facf474be0" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">CommandPathSearch</a>(
            <b>string</b> <span id="r0 rd" class="r0 r">commandName</span>,
            <a href="CommandDiscovery.cs.html#57824bf3a39bbcd1" class="t t">LookupPathCollection</a> <span id="r1 rd" class="r1 r">lookupPaths</span>,
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r2 rd" class="r2 r">context</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt;? <span id="r3 rd" class="r3 r">acceptableCommandNames</span>,
            <b>bool</b> <span id="r4 rd" class="r4 r">useFuzzyMatch</span>)
        {
            <a href="#93de296bda9624ca" class="i field">_useFuzzyMatch</a> = <span class="r4 r">useFuzzyMatch</span>;
            <b>string</b>[] <span id="r5 rd" class="r5 r">commandPatterns</span>;
            <b>if</b> (<span class="r3 r">acceptableCommandNames</span> != <b>null</b>)
            {
                <span class="c">// The name passed in is not a pattern. To minimize enumerating the file system, we</span>
                <span class="c">// turn the command name into a pattern and then match against extensions in PATHEXT.</span>
                <span class="c">// The old code would enumerate the file system many more times, once per possible extension.</span>
                <b>if</b> (<a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#a0395f876114b36d" class="i property">IsWindows</a>)
                {
                    <span class="r5 r">commandPatterns</span> = <b>new</b>[] { <span class="r0 r">commandName</span> + <span class="s">&quot;.*&quot;</span> };
                }
                <b>else</b>
                {
                    <span class="c">// Porting note: on non-Windows platforms, we want to always allow just &#39;commandName&#39;</span>
                    <span class="c">// as an acceptable command name. However, we also want to allow commands to be</span>
                    <span class="c">// called with the .ps1 extension, so that &#39;script.ps1&#39; can be called by &#39;script&#39;.</span>
                    <span class="r5 r">commandPatterns</span> = <b>new</b>[] { <span class="r0 r">commandName</span>, <span class="r0 r">commandName</span> + <span class="s">&quot;.ps1&quot;</span> };
                }
 
                <a href="#7bec0fbbd6bdcab6" class="i field">_postProcessEnumeratedFiles</a> = <span class="i">CheckAgainstAcceptableCommandNames</span>;
                <a href="#940c4c98a86751f4" class="i field">_acceptableCommandNames</a> = <span class="r3 r">acceptableCommandNames</span>;
            }
            <b>else</b>
            {
                <span class="r5 r">commandPatterns</span> = <b>new</b>[] { <span class="r0 r">commandName</span> };
                <a href="#7bec0fbbd6bdcab6" class="i field">_postProcessEnumeratedFiles</a> = <span class="i">JustCheckExtensions</span>;
            }
 
            <span class="c">// Note, discovery must be set before resolving the current directory</span>
            <a href="#08dd4c9887dbb33e" class="i field">_context</a> = <span class="r2 r">context</span>;
            <a href="#f284609673dd989b" class="i field">_patterns</a> = <span class="r5 r">commandPatterns</span>;
            <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a> = <span class="r1 r">lookupPaths</span>;
            <a href="#cf77974b36876ed1" class="i method">ResolveCurrentDirectoryInLookupPaths</a>();
 
            <a href="#0157d49dbdcb5c57" class="i field">_orderedPathExt</a> = <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#9bf9d4eaf7ff2fb4" class="i property">PathExtensionsWithPs1Prepended</a>;
 
            <span class="c">// The same as in this.Reset()</span>
            <a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a> = <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>.<span class="i">GetEnumerator</span>();
            <a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a> = <a href="#f284609673dd989b" class="i field">_patterns</a>.<span class="i">GetEnumerator</span>();
            <a href="#55a93e0bdb507109" class="i field">_currentDirectoryResults</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
            <a href="#f778684943a964f8" class="i field">_currentDirectoryResultsEnumerator</a> = <a href="#55a93e0bdb507109" class="i field">_currentDirectoryResults</a>.<span class="i">GetEnumerator</span>();
            <a href="#0afc4d0a60bcae59" class="i field">_justReset</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ensures that all the paths in the lookupPaths member are absolute</span>
        <span class="c">///</span><span class="c"> file system paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="cf77974b36876ed1" href="../R/cf77974b36876ed1.html" target="n" data-glyph="76,1" class="i method">ResolveCurrentDirectoryInLookupPaths</a>()
        {
            <b>var</b> <span id="r6 rd" class="r6 r">indexesToRemove</span> = <b>new</b> <span class="i">SortedDictionary</span>&lt;<b>int</b>, <b>int</b>&gt;();
            <b>int</b> <span id="r7 rd" class="r7 r">removalListCount</span> = 0;
 
            <b>string</b> <span id="r8 rd" class="r8 r">fileSystemProviderName</span> = <a href="#08dd4c9887dbb33e" class="i field">_context</a>.<a href="ExecutionContext.cs.html#733af3e5592e5947" class="i property">ProviderNames</a>.<a href="ProviderNames.cs.html#07509539bc35966f" class="i property">FileSystem</a>;
 
            <a href="../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r9 rd" class="r9 r">sessionState</span> = <a href="#08dd4c9887dbb33e" class="i field">_context</a>.<a href="ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
 
            <span class="c">// Only use the directory if it gets resolved by the FileSystemProvider</span>
            <b>bool</b> <span id="r10 rd" class="r10 r">isCurrentDriveValid</span> =
                <span class="r9 r">sessionState</span>.<a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a> != <b>null</b> &amp;&amp;
                <span class="r9 r">sessionState</span>.<a href="SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a>.<a href="DataStoreAdapter.cs.html#599e6ea3519fc2d6" class="i property">Provider</a>.<a href="DataStoreAdapterProvider.cs.html#13e2cce7adaad137" class="i method">NameEquals</a>(<span class="r8 r">fileSystemProviderName</span>) &amp;&amp;
                <span class="r9 r">sessionState</span>.<a href="SessionStateProviderAPIs.cs.html#dc359a601ce02a89" class="i method">IsProviderLoaded</a>(<span class="r8 r">fileSystemProviderName</span>);
 
            <b>string</b> <span id="r11 rd" class="r11 r">environmentCurrentDirectory</span> = <span class="i">Directory</span>.<span class="i">GetCurrentDirectory</span>();
 
            <a href="../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a> <span id="r12 rd" class="r12 r">pathResolver</span> = <a href="#08dd4c9887dbb33e" class="i field">_context</a>.<a href="ExecutionContext.cs.html#287b499ae3f5652b" class="i property">LocationGlobber</a>;
 
            <span class="c">// Loop through the relative paths and resolve them</span>
 
            <b>foreach</b> (<b>int</b> <span id="r13 rd" class="r13 r">index</span> <b>in</b> <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>.<a href="CommandDiscovery.cs.html#2af9555c6dcc416d" class="i method">IndexOfRelativePath</a>())
            {
                <b>string</b>? <span id="r14 rd" class="r14 r">resolvedDirectory</span> = <b>null</b>;
                <b>string</b>? <span id="r15 rd" class="r15 r">resolvedPath</span> = <b>null</b>;
 
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                    <span class="s">&quot;Lookup directory \&quot;{0}\&quot; appears to be a relative path. Attempting resolution...&quot;</span>,
                    <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>[<span class="r13 r">index</span>]);
 
                <b>if</b> (<span class="r10 r">isCurrentDriveValid</span>)
                {
                    <b>try</b>
                    {
                        <a href="DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r16 rd" class="r16 r">provider</span>;
                        <span class="r15 r">resolvedPath</span> =
                            <span class="r12 r">pathResolver</span>.<span class="i">GetProviderPath</span>(
                                <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>[<span class="r13 r">index</span>],
                                <b>out</b> <span class="r16 r">provider</span>);
                    }
                    <b>catch</b> (<a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a> <span id="r17 rd" class="r17 r">providerInvocationException</span>)
                    {
                        <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                            <span class="s">&quot;The relative path &#39;{0}&#39;, could not be resolved because the provider threw an exception: &#39;{1}&#39;&quot;</span>,
                            <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>[<span class="r13 r">index</span>],
                            <span class="r17 r">providerInvocationException</span>.<a href="../utils/SessionStateExceptions.cs.html#ca5c39e5cd30c80d" class="i property">Message</a>);
                    }
                    <b>catch</b> (<span class="i">InvalidOperationException</span>)
                    {
                        <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                            <span class="s">&quot;The relative path &#39;{0}&#39;, could not resolve a home directory for the provider&quot;</span>,
                            <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>[<span class="r13 r">index</span>]);
                    }
 
                    <span class="c">// Note, if the directory resolves to multiple paths, only the first is used.</span>
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r15 r">resolvedPath</span>))
                    {
                        <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">TraceError</span>(
                            <span class="s">&quot;The relative path resolved to: {0}&quot;</span>,
                            <span class="r15 r">resolvedPath</span>);
 
                        <span class="r14 r">resolvedDirectory</span> = <span class="r15 r">resolvedPath</span>;
                    }
                    <b>else</b>
                    {
                        <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<span class="i">WriteLine</span>(
                            <span class="s">&quot;The relative path was not a file system path. {0}&quot;</span>,
                            <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>[<span class="r13 r">index</span>]);
                    }
                }
                <b>else</b>
                {
                    <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#906bc47eb55bba45" class="i method">TraceWarning</a>(
                        <span class="s">&quot;The current drive is not set, using the process current directory: {0}&quot;</span>,
                        <span class="r11 r">environmentCurrentDirectory</span>);
 
                    <span class="r14 r">resolvedDirectory</span> = <span class="r11 r">environmentCurrentDirectory</span>;
                }
 
                <span class="c">// If we successfully resolved the path, make sure it is unique. Remove</span>
                <span class="c">// any duplicates found after the first occurrence of the path.</span>
 
                <b>if</b> (<span class="r14 r">resolvedDirectory</span> != <b>null</b>)
                {
                    <b>int</b> <span id="r18 rd" class="r18 r">existingIndex</span> = <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>.<span class="i">IndexOf</span>(<span class="r14 r">resolvedDirectory</span>);
 
                    <b>if</b> (<span class="r18 r">existingIndex</span> != -1)
                    {
                        <b>if</b> (<span class="r18 r">existingIndex</span> &gt; <span class="r13 r">index</span>)
                        {
                            <span class="c">// The relative path index is less than the explicit path,</span>
                            <span class="c">// so remove the explicit path.</span>
 
                            <span class="r6 r">indexesToRemove</span>.<span class="i">Add</span>(<span class="r7 r">removalListCount</span>++, <span class="r18 r">existingIndex</span>);
                            <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>[<span class="r13 r">index</span>] = <span class="r14 r">resolvedDirectory</span>;
                        }
                        <b>else</b>
                        {
                            <span class="c">// The explicit path index is less than the relative path</span>
                            <span class="c">// index, so remove the relative path.</span>
 
                            <span class="r6 r">indexesToRemove</span>.<span class="i">Add</span>(<span class="r7 r">removalListCount</span>++, <span class="r13 r">index</span>);
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// Change the relative path to the resolved path.</span>
 
                        <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>[<span class="r13 r">index</span>] = <span class="r14 r">resolvedDirectory</span>;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// The directory couldn&#39;t be resolved so remove it from the</span>
                    <span class="c">// lookup paths.</span>
 
                    <span class="r6 r">indexesToRemove</span>.<span class="i">Add</span>(<span class="r7 r">removalListCount</span>++, <span class="r13 r">index</span>);
                }
            }
 
            <span class="c">// Now remove all the duplicates starting from the back of the collection.</span>
            <span class="c">// As each element is removed, elements that follow are moved up to occupy</span>
            <span class="c">// the emptied index.</span>
 
            <b>for</b> (<b>int</b> <span id="r19 rd" class="r19 r">removeIndex</span> = <span class="r6 r">indexesToRemove</span>.<span class="i">Count</span>; <span class="r19 r">removeIndex</span> &gt; 0; --<span class="r19 r">removeIndex</span>)
            {
                <b>int</b> <span id="r20 rd" class="r20 r">indexToRemove</span> = <span class="r6 r">indexesToRemove</span>[<span class="r19 r">removeIndex</span> - 1];
                <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>.<span class="i">RemoveAt</span>(<span class="r20 r">indexToRemove</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of a command enumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of this class as IEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="i">IEnumerator</span>&lt;<b>string</b>&gt; <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;.<a id="928880df17b78fd0" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#edd9b71bf4db52b8" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance of a command enumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of this class as IEnumerator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="i">IEnumerator</span> <span class="i">IEnumerable</span>.<a id="f3e64310bb06a2f3" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetEnumerator</a>()
        {
            <b>return</b> <a href="#edd9b71bf4db52b8" class="k">this</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Moves the enumerator to the next command match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if there was another command that matches, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="c075bba946a76b14" href="../R/c075bba946a76b14.html" target="n" data-glyph="72,1" class="i method">MoveNext</a>()
        {
            <b>bool</b> <span id="r21 rd" class="r21 r">result</span> = <b>false</b>;
 
            <b>if</b> (<a href="#0afc4d0a60bcae59" class="i field">_justReset</a>)
            {
                <a href="#0afc4d0a60bcae59" class="i field">_justReset</a> = <b>false</b>;
 
                <b>if</b> (!<a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a>.<span class="i">MoveNext</span>())
                {
                    <a href="#0a8fee3aa3f16708" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;No patterns were specified&quot;</span>);
                    <b>return</b> <b>false</b>;
                }
 
                <b>if</b> (!<a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a>.<span class="i">MoveNext</span>())
                {
                    <a href="#0a8fee3aa3f16708" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;No lookup paths were specified&quot;</span>);
                    <b>return</b> <b>false</b>;
                }
 
                <span class="i">GetNewDirectoryResults</span>(<a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a>.<span class="i">Current</span>, <a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a>.<span class="i">Current</span>);
            }
 
            <b>while</b> (<b>true</b>) <span class="c">// while lookupPathsEnumerator is valid</span>
            {
                <b>while</b> (<b>true</b>) <span class="c">// while patternEnumerator is valid</span>
                {
                    <span class="c">// Try moving to the next path in the current results</span>
 
                    <b>if</b> (!<a href="#f778684943a964f8" class="i field">_currentDirectoryResultsEnumerator</a>.<span class="i">MoveNext</span>())
                    {
                        <a href="#0a8fee3aa3f16708" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Current directory results are invalid&quot;</span>);
 
                        <span class="c">// Since a path was not found in the current result,</span>
                        <span class="c">// advance the pattern and try again</span>
 
                        <b>if</b> (!<a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a>.<span class="i">MoveNext</span>())
                        {
                            <a href="#0a8fee3aa3f16708" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Current patterns exhausted in current directory: {0}&quot;</span>, <a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a>.<span class="i">Current</span>);
                            <b>break</b>;
                        }
 
                        <span class="c">// Get the results of the next pattern</span>
 
                        <span class="i">GetNewDirectoryResults</span>(<a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a>.<span class="i">Current</span>, <a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a>.<span class="i">Current</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#0a8fee3aa3f16708" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Next path found: {0}&quot;</span>, <a href="#f778684943a964f8" class="i field">_currentDirectoryResultsEnumerator</a>.<span class="i">Current</span>);
                        <span class="r21 r">result</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <span class="c">// Since we have reset the results, loop again to find the next result.</span>
                }
 
                <b>if</b> (<span class="r21 r">result</span>)
                {
                    <b>break</b>;
                }
 
                <span class="c">// Since the path was not found in the current results, and all patterns were exhausted,</span>
                <span class="c">// advance the path and continue</span>
 
                <b>if</b> (!<a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a>.<span class="i">MoveNext</span>())
                {
                    <a href="#0a8fee3aa3f16708" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;All lookup paths exhausted, no more matches can be found&quot;</span>);
                    <b>break</b>;
                }
 
                <span class="c">// Reset the pattern enumerator and get new results using the new lookup path</span>
 
                <a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a> = <a href="#f284609673dd989b" class="i field">_patterns</a>.<span class="i">GetEnumerator</span>();
 
                <b>if</b> (!<a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a>.<span class="i">MoveNext</span>())
                {
                    <a href="#0a8fee3aa3f16708" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;All patterns exhausted, no more matches can be found&quot;</span>);
                    <b>break</b>;
                }
 
                <span class="i">GetNewDirectoryResults</span>(<a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a>.<span class="i">Current</span>, <a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a>.<span class="i">Current</span>);
            }
 
            <b>return</b> <span class="r21 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets the enumerator to before the first command match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="7d3e6fa18be68d7f" href="../R/7d3e6fa18be68d7f.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a>.<span class="i">Dispose</span>();
            <a href="#9ad74f2c1293b8eb" class="i field">_lookupPathsEnumerator</a> = <a href="#a929f4b7709d0424" class="i field">_lookupPaths</a>.<span class="i">GetEnumerator</span>();
            <a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a>.<span class="i">Dispose</span>();
            <a href="#76a386b54ca5ed56" class="i field">_patternEnumerator</a> = <a href="#f284609673dd989b" class="i field">_patterns</a>.<span class="i">GetEnumerator</span>();
            <a href="#55a93e0bdb507109" class="i field">_currentDirectoryResults</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
            <a href="#f778684943a964f8" class="i field">_currentDirectoryResultsEnumerator</a>.<span class="i">Dispose</span>();
            <a href="#f778684943a964f8" class="i field">_currentDirectoryResultsEnumerator</a> = <a href="#55a93e0bdb507109" class="i field">_currentDirectoryResults</a>.<span class="i">GetEnumerator</span>();
            <a href="#0afc4d0a60bcae59" class="i field">_justReset</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the path to the current command match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The enumerator is positioned before the first element of</span>
        <span class="c">///</span><span class="c"> the collection or after the last element.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>string</b> <span class="i">IEnumerator</span>&lt;<b>string</b>&gt;.<a id="bedbea6d76f1835b" href="../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#55a93e0bdb507109" class="i field">_currentDirectoryResults</a> == <b>null</b>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#4f3f8175dd33a015" class="i method">NewInvalidOperationException</a>();
                }
 
                <b>return</b> <a href="#f778684943a964f8" class="i field">_currentDirectoryResultsEnumerator</a>.<span class="i">Current</span>;
            }
        }
 
        <b>object</b> <span class="i">IEnumerator</span>.<a id="ae04978bef2791b6" href="../R/../../0000000000.html" target="n" data-glyph="106,1" class="i property">Current</a>
        {
            <b>get</b>
            {
                <b>return</b> ((<span class="i">IEnumerator</span>&lt;<b>string</b>&gt;)<a href="#edd9b71bf4db52b8" class="k">this</a>).<span class="i">Current</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Required by the IEnumerator generic interface.</span>
        <span class="c">///</span><span class="c"> Resets the searcher.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ed34f64fbc3222af" href="../R/ed34f64fbc3222af.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#7d3e6fa18be68d7f" class="i method">Reset</a>();
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#edd9b71bf4db52b8" class="k">this</a>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the matching files in the specified directories and resets</span>
        <span class="c">///</span><span class="c"> the currentDirectoryResultsEnumerator to this new set of results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">pattern</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pattern used to find the matching files in the specified directory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">directory</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path to the directory to find the files in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ce6cfd1d68b99d47" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetNewDirectoryResults</a>(<b>string</b> <span id="r22 rd" class="r22 r">pattern</span>, <b>string</b> <span id="r23 rd" class="r23 r">directory</span>)
        {
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;? <span id="r24 rd" class="r24 r">result</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="CommandDiscovery.cs.html#5d9833e2519bb80f" class="i field">discoveryTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(<span class="s">&quot;Looking for {0} in {1}&quot;</span>, <span class="r22 r">pattern</span>, <span class="r23 r">directory</span>);
 
                <span class="c">// Get the matching files in the directory</span>
                <b>if</b> (<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r23 r">directory</span>))
                {
                    <span class="c">// Win8 bug 92113: Directory.GetFiles() regressed in NET4</span>
                    <span class="c">// Directory.GetFiles(directory, &quot;.&quot;) used to return null with CLR 2.</span>
                    <span class="c">// but with CLR4 it started acting like &quot;*&quot;. This is a appcompat bug in CLR4</span>
                    <span class="c">// but they cannot fix it as CLR4 is already RTMd by the time this was reported.</span>
                    <span class="c">// If they revert it, it will become a CLR4 appcompat issue. So, using the workaround</span>
                    <span class="c">// to forcefully use null if pattern is &quot;.&quot;</span>
                    <b>if</b> (<span class="r22 r">pattern</span>.<span class="i">Length</span> != 1 || <span class="r22 r">pattern</span>[0] != <span class="s">&#39;.&#39;</span>)
                    {
                        <b>if</b> (<a href="#93de296bda9624ca" class="i field">_useFuzzyMatch</a>)
                        {
                            <b>var</b> <span id="r25 rd" class="r25 r">files</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                            <b>var</b> <span id="r26 rd" class="r26 r">matchingFiles</span> = <span class="i">Directory</span>.<span class="i">EnumerateFiles</span>(<span class="r23 r">directory</span>);
                            <b>foreach</b> (<b>string</b> <span id="r27 rd" class="r27 r">file</span> <b>in</b> <span class="r26 r">matchingFiles</span>)
                            {
                                <b>if</b> (<a href="../utils/FuzzyMatch.cs.html#39ac23db4a63eca2" class="t t">FuzzyMatcher</a>.<span class="i">IsFuzzyMatch</span>(<span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r27 r">file</span>), <span class="r22 r">pattern</span>))
                                {
                                    <span class="r25 r">files</span>.<span class="i">Add</span>(<span class="r27 r">file</span>);
                                }
                            }
 
                            <span class="r24 r">result</span> = <a href="#7bec0fbbd6bdcab6" class="i field">_postProcessEnumeratedFiles</a> != <b>null</b>
                                ? <span class="i">_postProcessEnumeratedFiles</span>(<span class="r25 r">files</span>.<span class="i">ToArray</span>())
                                : <span class="r25 r">files</span>;
                        }
                        <b>else</b>
                        {
                            <b>var</b> <span id="r28 rd" class="r28 r">matchingFiles</span> = <span class="i">Directory</span>.<span class="i">EnumerateFiles</span>(<span class="r23 r">directory</span>, <span class="r22 r">pattern</span>);
                            <span class="r24 r">result</span> = <a href="#7bec0fbbd6bdcab6" class="i field">_postProcessEnumeratedFiles</a> != <b>null</b>
                                ? <span class="i">_postProcessEnumeratedFiles</span>(<span class="r28 r">matchingFiles</span>.<span class="i">ToArray</span>())
                                : <span class="r28 r">matchingFiles</span>;
                        }
                    }
                }
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <span class="c">// The pattern contained illegal file system characters</span>
            }
            <b>catch</b> (<span class="i">IOException</span>)
            {
                <span class="c">// A directory specified in the lookup path was not</span>
                <span class="c">// accessible</span>
            }
            <b>catch</b> (<span class="i">UnauthorizedAccessException</span>)
            {
                <span class="c">// A directory specified in the lookup path was not</span>
                <span class="c">// accessible</span>
            }
            <b>catch</b> (<span class="i">NotSupportedException</span>)
            {
                <span class="c">// A directory specified in the lookup path was not</span>
                <span class="c">// accessible</span>
            }
 
            <a href="#55a93e0bdb507109" class="i field">_currentDirectoryResults</a> = <span class="r24 r">result</span> ?? <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
            <a href="#f778684943a964f8" class="i field">_currentDirectoryResultsEnumerator</a> = <a href="#55a93e0bdb507109" class="i field">_currentDirectoryResults</a>.<span class="i">GetEnumerator</span>();
        }
 
        <b>private</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;? <a id="3f47fbfb0029d140" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CheckAgainstAcceptableCommandNames</a>(<b>string</b>[] <span id="r29 rd" class="r29 r">fileNames</span>)
        {
            <b>var</b> <span id="r30 rd" class="r30 r">baseNames</span> = <span class="r29 r">fileNames</span>.<span class="i">Select</span>(<span class="i">Path</span>.<span class="i">GetFileName</span>).<span class="i">ToArray</span>();
 
            <span class="c">// Result must be ordered by PATHEXT order of precedence.</span>
            <span class="c">// acceptableCommandNames is in this order, so</span>
 
            <span class="c">// Porting note: allow files with executable bit on non-Windows platforms</span>
 
            <span class="i">Collection</span>&lt;<b>string</b>&gt;? <span id="r31 rd" class="r31 r">result</span> = <b>null</b>;
            <b>if</b> (<span class="r30 r">baseNames</span>.<span class="i">Length</span> &gt; 0 &amp;&amp; <a href="#940c4c98a86751f4" class="i field">_acceptableCommandNames</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r32 rd" class="r32 r">name</span> <b>in</b> <a href="#940c4c98a86751f4" class="i field">_acceptableCommandNames</a>)
                {
                    <b>for</b> (<b>int</b> <span id="r33 rd" class="r33 r">i</span> = 0; <span class="r33 r">i</span> &lt; <span class="r30 r">baseNames</span>.<span class="i">Length</span>; <span class="r33 r">i</span>++)
                    {
                        <b>if</b> (<span class="r32 r">name</span>.<span class="i">Equals</span>(<span class="r30 r">baseNames</span>[<span class="r33 r">i</span>], <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                            || (!<a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#a0395f876114b36d" class="i property">IsWindows</a> &amp;&amp; <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<span class="i">NonWindowsIsExecutable</span>(<span class="r32 r">name</span>)))
                        {
                            <b>if</b> (<span class="r31 r">result</span> == <b>null</b>)
                                <span class="r31 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
                            <span class="r31 r">result</span>.<span class="i">Add</span>(<span class="r29 r">fileNames</span>[<span class="r33 r">i</span>]);
                            <b>break</b>;
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r31 r">result</span>;
        }
 
        <b>private</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;? <a id="c19b67f89300f578" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">JustCheckExtensions</a>(<b>string</b>[] <span id="r34 rd" class="r34 r">fileNames</span>)
        {
            <span class="c">// Warning: pretty duplicated code</span>
            <span class="c">// Result must be ordered by PATHEXT order of precedence.</span>
 
            <span class="c">// Porting note: allow files with executable bit on non-Windows platforms</span>
 
            <span class="i">Collection</span>&lt;<b>string</b>&gt;? <span id="r35 rd" class="r35 r">result</span> = <b>null</b>;
            <b>foreach</b> (<b>var</b> <span id="r36 rd" class="r36 r">allowedExt</span> <b>in</b> <a href="#0157d49dbdcb5c57" class="i field">_orderedPathExt</a>)
            {
                <b>foreach</b> (<b>var</b> <span id="r37 rd" class="r37 r">fileName</span> <b>in</b> <span class="r34 r">fileNames</span>)
                {
                    <b>if</b> (<span class="r37 r">fileName</span>.<span class="i">EndsWith</span>(<span class="r36 r">allowedExt</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                        || (!<a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#a0395f876114b36d" class="i property">IsWindows</a> &amp;&amp; <a href="../CoreCLR/CorePsPlatform.cs.html#693813241122eb45" class="t t">Platform</a>.<a href="../CoreCLR/CorePsPlatform.cs.html#67a7455f248aadf6" class="i method">NonWindowsIsExecutable</a>(<span class="r37 r">fileName</span>)))
                    {
                        <b>if</b> (<span class="r35 r">result</span> == <b>null</b>)
                            <span class="r35 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
                        <span class="r35 r">result</span>.<span class="i">Add</span>(<span class="r37 r">fileName</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r35 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The directory paths in which to look for commands.</span>
        <span class="c">///</span><span class="c"> This is derived from the PATH environment variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="CommandDiscovery.cs.html#57824bf3a39bbcd1" class="t t">LookupPathCollection</a> <a id="a929f4b7709d0424" href="../R/a929f4b7709d0424.html" target="n" data-glyph="46,1" class="i field">_lookupPaths</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The enumerator for the lookup paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerator</span>&lt;<b>string</b>&gt; <a id="9ad74f2c1293b8eb" href="../R/9ad74f2c1293b8eb.html" target="n" data-glyph="46,1" class="i field">_lookupPathsEnumerator</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The list of results matching the pattern in the current</span>
        <span class="c">///</span><span class="c"> path lookup directory. Resets to null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="55a93e0bdb507109" href="../R/55a93e0bdb507109.html" target="n" data-glyph="46,1" class="i field">_currentDirectoryResults</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The enumerator for the list of results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerator</span>&lt;<b>string</b>&gt; <a id="f778684943a964f8" href="../R/f778684943a964f8.html" target="n" data-glyph="46,1" class="i field">_currentDirectoryResultsEnumerator</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command name to search for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="f284609673dd989b" href="../R/f284609673dd989b.html" target="n" data-glyph="46,1" class="i field">_patterns</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The enumerator for the patterns.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IEnumerator</span>&lt;<b>string</b>&gt; <a id="76a386b54ca5ed56" href="../R/76a386b54ca5ed56.html" target="n" data-glyph="46,1" class="i field">_patternEnumerator</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A reference to the execution context for this runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="08dd4c9887dbb33e" href="../R/08dd4c9887dbb33e.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When reset is called, this gets set to true. Once MoveNext</span>
        <span class="c">///</span><span class="c"> is called, this gets set to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="0afc4d0a60bcae59" href="../R/0afc4d0a60bcae59.html" target="n" data-glyph="46,1" class="i field">_justReset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If not null, called with the enumerated files for further processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Func</span>&lt;<b>string</b>[], <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;?&gt; <a id="7bec0fbbd6bdcab6" href="../R/7bec0fbbd6bdcab6.html" target="n" data-glyph="46,1" class="i field">_postProcessEnumeratedFiles</a>;
 
        <b>private readonly string</b>[] <a id="0157d49dbdcb5c57" href="../R/0157d49dbdcb5c57.html" target="n" data-glyph="46,1" class="i field">_orderedPathExt</a>;
        <b>private readonly</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;? <a id="940c4c98a86751f4" href="../R/940c4c98a86751f4.html" target="n" data-glyph="46,1" class="i field">_acceptableCommandNames</a>;
 
        <b>private readonly bool</b> <a id="93de296bda9624ca" href="../R/93de296bda9624ca.html" target="n" data-glyph="46,1" class="i field">_useFuzzyMatch</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private members
    }
}
</pre></td></tr></table></div></body></html>
