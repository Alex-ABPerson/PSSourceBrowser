<!DOCTYPE html>
<html><head><title>MshObject.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(2656);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/MshObject.cs" target="_top">engine\MshObject.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Data</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Dynamic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>.<span class="i">Expressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
<b>using</b> <span class="i n">System</span>.<span class="i">DirectoryServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 56500
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Wraps an object providing alternate views of the available members</span>
    <span class="c">///</span><span class="c"> and ways to extend them. Members can be methods, properties,</span>
    <span class="c">///</span><span class="c"> parameterized properties, etc.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> It is permitted to subclass </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a3c2513aa3da07fa" class="t t">PSObject</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> but there is no established scenario for doing this, nor has it been tested.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    [<span class="i">TypeDescriptionProvider</span>(<b>typeof</b>(<a href="MshObjectTypeDescriptor.cs.html#5c24927d2e510439" class="t t">PSObjectTypeDescriptionProvider</a>))]
    [<span class="i">Serializable</span>]
    <b>public class</b> <a id="a3c2513aa3da07fa" href="../R/a3c2513aa3da07fa.html" target="n" data-glyph="0,0" class="t t">PSObject</a> : <span class="i">IFormattable</span>, <span class="i">IComparable</span>, <span class="i">ISerializable</span>, <span class="i">IDynamicMetaObjectProvider</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private to the constructors
 
        <b>internal</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <a id="d5f9f98808bbda0e" href="../R/d5f9f98808bbda0e.html" target="n" data-glyph="74,1" class="i method">GetTypeTable</a>()
        {
            <b>if</b> (<a href="#edf2e687c14df594" class="i field">_typeTable</a> != <b>null</b> &amp;&amp; <a href="#edf2e687c14df594" class="i field">_typeTable</a>.<span class="i">TryGetTarget</span>(<b>out</b> <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r0 rd" class="r0 r">typeTable</span>))
            {
                <b>return</b> <span class="r0 r">typeTable</span>;
            }
 
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r1 rd" class="r1 r">context</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <b>return</b> <span class="r1 r">context</span>?.<a href="ExecutionContext.cs.html#e05f19c7ccf4ea74" class="i property">TypeTable</a>;
        }
 
        <b>internal static</b> <span class="r2 r t">T</span> <a id="ac786b8910f1969e" href="../R/ac786b8910f1969e.html" target="n" data-glyph="74,1" class="i method">TypeTableGetMemberDelegate</a>&lt;<span id="r2 rd t" class="r2 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r3 rd" class="r3 r">msjObj</span>, <b>string</b> <span id="r4 rd" class="r4 r">name</span>) <b>where</b> <span class="r2 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r5 rd" class="r5 r">table</span> = <span class="r3 r">msjObj</span>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
            <b>return</b> <span class="i">TypeTableGetMemberDelegate</span>&lt;<span class="r2 r t">T</span>&gt;(<span class="r3 r">msjObj</span>, <span class="r5 r">table</span>, <span class="r4 r">name</span>);
        }
 
        <b>private static</b> <span class="r6 r t">T</span> <a id="3f348d45915ab4cb" href="../R/3f348d45915ab4cb.html" target="n" data-glyph="76,1" class="i method">TypeTableGetMemberDelegate</a>&lt;<span id="r6 rd t" class="r6 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r7 rd" class="r7 r">msjObj</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r8 rd" class="r8 r">typeTableToUse</span>, <b>string</b> <span id="r9 rd" class="r9 r">name</span>) <b>where</b> <span class="r6 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (<span class="r8 r">typeTableToUse</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r10 rd" class="r10 r">allMembers</span> = <span class="r8 r">typeTableToUse</span>.<a href="TypeTable.cs.html#360ddf05c317b5ab" class="i method">GetMembers</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r7 r">msjObj</span>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>);
            <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r11 rd" class="r11 r">member</span> = <span class="r10 r">allMembers</span><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><span class="r9 r">name</span>];
            <b>if</b> (<span class="r11 r">member</span> == <b>null</b>)
            {
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;\&quot;{0}\&quot; NOT present in type table.&quot;</span>, <span class="r9 r">name</span>);
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r11 r">member</span> <b>is</b> <span class="r6 r t">T</span> <span id="r12 rd" class="r12 r">memberAsT</span>)
            {
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;\&quot;{0}\&quot; present in type table.&quot;</span>, <span class="r9 r">name</span>);
                <b>return</b> <span class="r12 r">memberAsT</span>;
            }
 
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<span class="i">WriteLine</span>(<span class="s">&quot;\&quot;{0}\&quot; from types table ignored because it has type {1} instead of {2}.&quot;</span>,
                <span class="r9 r">name</span>, <span class="r11 r">member</span>.<span class="i">GetType</span>(), <b>typeof</b>(<span class="r6 r t">T</span>));
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r13 r t">T</span>&gt; <a id="7dee234508c56ab1" href="../R/7dee234508c56ab1.html" target="n" data-glyph="74,1" class="i method">TypeTableGetMembersDelegate</a>&lt;<span id="r13 rd t" class="r13 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r14 rd" class="r14 r">msjObj</span>) <b>where</b> <span class="r13 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r15 rd" class="r15 r">table</span> = <span class="r14 r">msjObj</span>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
            <b>return</b> <span class="i">TypeTableGetMembersDelegate</span>&lt;<span class="r13 r t">T</span>&gt;(<span class="r14 r">msjObj</span>, <span class="r15 r">table</span>);
        }
 
        <b>internal static</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r16 r t">T</span>&gt; <a id="7660755da9806a2a" href="../R/7660755da9806a2a.html" target="n" data-glyph="74,1" class="i method">TypeTableGetMembersDelegate</a>&lt;<span id="r16 rd t" class="r16 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r17 rd" class="r17 r">msjObj</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r18 rd" class="r18 r">typeTableToUse</span>) <b>where</b> <span class="r16 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (<span class="r18 r">typeTableToUse</span> == <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r16 r t">T</span>&gt;();
            }
 
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r16 r t">T</span>&gt; <span id="r19 rd" class="r19 r">members</span> = <span class="r18 r">typeTableToUse</span>.<span class="i">GetMembers</span>&lt;<span class="r16 r t">T</span>&gt;(<span class="r17 r">msjObj</span>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>);
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#70ee671c8687bfbd" class="i method">WriteLine</a>(<span class="s">&quot;Type table members: {0}.&quot;</span>, <span class="r19 r">members</span>.<a href="MshMemberInfo.cs.html#85006968f446d94b" class="i property">Count</a>);
            <b>return</b> <span class="r19 r">members</span>;
        }
 
        <b>internal static</b> <span class="r20 r t">T</span> <a id="1d31fd7ffb1e12da" href="../R/1d31fd7ffb1e12da.html" target="n" data-glyph="74,1" class="i method">TypeTableGetFirstMemberOrDefaultDelegate</a>&lt;<span id="r20 rd t" class="r20 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r21 rd" class="r21 r">msjObj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r22 rd" class="r22 r">predicate</span>) <b>where</b> <span class="r20 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r23 rd" class="r23 r">table</span> = <span class="r21 r">msjObj</span>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
            <b>return</b> <span class="i">TypeTableGetFirstOrDefaultMemberDelegate</span>&lt;<span class="r20 r t">T</span>&gt;(<span class="r21 r">msjObj</span>, <span class="r23 r">table</span>, <span class="r22 r">predicate</span>);
        }
 
        <b>internal static</b> <span class="r24 r t">T</span> <a id="42e39e019d3338c3" href="../R/42e39e019d3338c3.html" target="n" data-glyph="74,1" class="i method">TypeTableGetFirstOrDefaultMemberDelegate</a>&lt;<span id="r24 rd t" class="r24 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r25 rd" class="r25 r">msjObj</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r26 rd" class="r26 r">typeTableToUse</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r27 rd" class="r27 r">predicate</span>) <b>where</b> <span class="r24 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>return</b> <span class="r26 r">typeTableToUse</span>?.<span class="i">GetFirstMemberOrDefault</span>&lt;<span class="r24 r t">T</span>&gt;(<span class="r25 r">msjObj</span>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>, <span class="r27 r">predicate</span>);
        }
 
        <b>private static</b> <span class="r28 r t">T</span> <a id="899ce42e883492aa" href="../R/899ce42e883492aa.html" target="n" data-glyph="76,1" class="i method">AdapterGetMemberDelegate</a>&lt;<span id="r28 rd t" class="r28 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r29 rd" class="r29 r">msjObj</span>, <b>string</b> <span id="r30 rd" class="r30 r">name</span>) <b>where</b> <span class="r28 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (<span class="r29 r">msjObj</span>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a>)
            {
                <b>if</b> (<span class="r29 r">msjObj</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r28 r t">T</span> <span id="r31 rd" class="r31 r">adaptedMember</span> = <span class="r29 r">msjObj</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><span class="r30 r">name</span>] <b>as</b> <span class="r28 r t">T</span>;
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Serialized adapted member: {0}.&quot;</span>, <span class="r31 r">adaptedMember</span> == <b>null</b> ? <span class="s">&quot;not found&quot;</span> : <span class="r31 r">adaptedMember</span>.<span class="i">Name</span>);
                <b>return</b> <span class="r31 r">adaptedMember</span>;
            }
 
            <span class="r28 r t">T</span> <span id="r32 rd" class="r32 r">retValue</span> = <span class="r29 r">msjObj</span>.<a href="#c3997c282bafb530" class="i property">InternalAdapter</a>.<span class="i">BaseGetMember</span>&lt;<span class="r28 r t">T</span>&gt;(<span class="r29 r">msjObj</span>.<a href="#d4170653add67c11" class="i property">ImmediateBaseObject</a>, <span class="r30 r">name</span>);
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Adapted member: {0}.&quot;</span>, <span class="r32 r">retValue</span> == <b>null</b> ? <span class="s">&quot;not found&quot;</span> : <span class="r32 r">retValue</span>.<span class="i">Name</span>);
            <b>return</b> <span class="r32 r">retValue</span>;
        }
 
        <b>private static</b> <span class="r33 r t">T</span> <a id="79bb9595e2a070f9" href="../R/79bb9595e2a070f9.html" target="n" data-glyph="76,1" class="i method">AdapterGetFirstMemberOrDefaultDelegate</a>&lt;<span id="r33 rd t" class="r33 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r34 rd" class="r34 r">msjObj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r35 rd" class="r35 r">predicate</span>) <b>where</b> <span class="r33 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (<span class="r34 r">msjObj</span>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a> &amp;&amp; <b>typeof</b>(<span class="r33 r t">T</span>).<span class="i">IsAssignableFrom</span>(<b>typeof</b>(<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>)))
            {
                <b>if</b> (<span class="r34 r">msjObj</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>foreach</b> (<b>var</b> <span id="r36 rd" class="r36 r">adaptedMember</span> <b>in</b> <span class="r34 r">msjObj</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a>)
                {
                    <b>if</b> (<span class="r35 r">predicate</span>(<span class="r36 r">adaptedMember</span>.<span class="i">Name</span>))
                    {
                        <b>return</b> <span class="r36 r">adaptedMember</span> <b>as</b> <span class="r33 r t">T</span>;
                    }
                }
            }
 
            <span class="r33 r t">T</span> <span id="r37 rd" class="r37 r">retValue</span> = <span class="r34 r">msjObj</span>.<a href="#c3997c282bafb530" class="i property">InternalAdapter</a>.<span class="i">BaseGetFirstMemberOrDefault</span>&lt;<span class="r33 r t">T</span>&gt;(<span class="r34 r">msjObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>, <span class="r35 r">predicate</span>);
            <b>return</b> <span class="r37 r">retValue</span>;
        }
 
        <b>internal static</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r38 r t">TResult</span>&gt; <a id="24475ac12840314b" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TransformMemberInfoCollection</a>&lt;<span id="r39 rd t" class="r39 r t">TSource</span>, <span id="r38 rd t" class="r38 r t">TResult</span>&gt;(<a href="MshMemberInfo.cs.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<span class="r39 r t">TSource</span>&gt; <span id="r40 rd" class="r40 r">source</span>)
            <b>where</b> <span class="r39 r t">TSource</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <b>where</b> <span class="r38 r t">TResult</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (<b>typeof</b>(<span class="r39 r t">TSource</span>) == <b>typeof</b>(<span class="r38 r t">TResult</span>))
            {
                <span class="c">// If the types are the same, don&#39;t make a copy, return the cached collection.</span>
                <b>return</b> <span class="r40 r">source</span> <b>as</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r38 r t">TResult</span>&gt;;
            }
 
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r38 r t">TResult</span>&gt; <span id="r41 rd" class="r41 r">returnValue</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r38 r t">TResult</span>&gt;();
            <b>foreach</b> (<span class="r39 r t">TSource</span> <span id="r42 rd" class="r42 r">member</span> <b>in</b> <span class="r40 r">source</span>)
            {
                <b>if</b> (<span class="r42 r">member</span> <b>is</b> <span class="r38 r t">TResult</span> <span id="r43 rd" class="r43 r">result</span>)
                {
                    <span class="r41 r">returnValue</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r43 r">result</span>);
                }
            }
 
            <b>return</b> <span class="r41 r">returnValue</span>;
        }
 
        <b>private static</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r44 r t">T</span>&gt; <a id="f9d7a5c519f51915" href="../R/f9d7a5c519f51915.html" target="n" data-glyph="76,1" class="i method">AdapterGetMembersDelegate</a>&lt;<span id="r44 rd t" class="r44 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r45 rd" class="r45 r">msjObj</span>) <b>where</b> <span class="r44 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <b>if</b> (<span class="r45 r">msjObj</span>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a>)
            {
                <b>if</b> (<span class="r45 r">msjObj</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a> == <b>null</b>)
                {
                    <b>return</b> <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r44 r t">T</span>&gt;();
                }
 
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#70ee671c8687bfbd" class="i method">WriteLine</a>(<span class="s">&quot;Serialized adapted members: {0}.&quot;</span>, <span class="r45 r">msjObj</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a>.<a href="MshMemberInfo.cs.html#85006968f446d94b" class="i property">Count</a>);
                <b>return</b> <span class="i">TransformMemberInfoCollection</span>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>, <span class="r44 r t">T</span>&gt;(<span class="r45 r">msjObj</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a>);
            }
 
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r44 r t">T</span>&gt; <span id="r46 rd" class="r46 r">retValue</span> = <span class="r45 r">msjObj</span>.<a href="#c3997c282bafb530" class="i property">InternalAdapter</a>.<span class="i">BaseGetMembers</span>&lt;<span class="r44 r t">T</span>&gt;(<span class="r45 r">msjObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>);
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#70ee671c8687bfbd" class="i method">WriteLine</a>(<span class="s">&quot;Adapted members: {0}.&quot;</span>, <span class="r46 r">retValue</span>.<a href="MshMemberInfo.cs.html#522a346a9cc23d93" class="i property">VisibleCount</a>);
            <b>return</b> <span class="r46 r">retValue</span>;
        }
 
        <b>private static</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r47 r t">T</span>&gt; <a id="d24f0f1ae5a3c79b" href="../R/d24f0f1ae5a3c79b.html" target="n" data-glyph="76,1" class="i method">DotNetGetMembersDelegate</a>&lt;<span id="r47 rd t" class="r47 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r48 rd" class="r48 r">msjObj</span>) <b>where</b> <span class="r47 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <span class="c">// Don&#39;t lookup dotnet members if the object doesn&#39;t insist.</span>
            <b>if</b> (<span class="r48 r">msjObj</span>.<a href="#457ec7fb90705caa" class="i property">InternalBaseDotNetAdapter</a> != <b>null</b>)
            {
                <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<span class="r47 r t">T</span>&gt; <span id="r49 rd" class="r49 r">retValue</span> = <span class="r48 r">msjObj</span>.<a href="#457ec7fb90705caa" class="i property">InternalBaseDotNetAdapter</a>.<span class="i">BaseGetMembers</span>&lt;<span class="r47 r t">T</span>&gt;(<span class="r48 r">msjObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>);
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#70ee671c8687bfbd" class="i method">WriteLine</a>(<span class="s">&quot;DotNet members: {0}.&quot;</span>, <span class="r49 r">retValue</span>.<a href="MshMemberInfo.cs.html#522a346a9cc23d93" class="i property">VisibleCount</a>);
                <b>return</b> <span class="r49 r">retValue</span>;
            }
 
            <b>return</b> <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<span class="r47 r t">T</span>&gt;();
        }
 
        <b>private static</b> <span class="r50 r t">T</span> <a id="f69c3ae371c8355e" href="../R/f69c3ae371c8355e.html" target="n" data-glyph="76,1" class="i method">DotNetGetMemberDelegate</a>&lt;<span id="r50 rd t" class="r50 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r51 rd" class="r51 r">msjObj</span>, <b>string</b> <span id="r52 rd" class="r52 r">name</span>) <b>where</b> <span class="r50 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <span class="c">// Don&#39;t lookup dotnet member if the object doesn&#39;t insist.</span>
            <b>if</b> (<span class="r51 r">msjObj</span>.<a href="#457ec7fb90705caa" class="i property">InternalBaseDotNetAdapter</a> != <b>null</b>)
            {
                <span class="r50 r t">T</span> <span id="r53 rd" class="r53 r">retValue</span> = <span class="r51 r">msjObj</span>.<a href="#457ec7fb90705caa" class="i property">InternalBaseDotNetAdapter</a>.<span class="i">BaseGetMember</span>&lt;<span class="r50 r t">T</span>&gt;(<span class="r51 r">msjObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>, <span class="r52 r">name</span>);
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#a99ae1b984fd50d2" class="i property">MemberResolution</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;DotNet member: {0}.&quot;</span>, <span class="r53 r">retValue</span> == <b>null</b> ? <span class="s">&quot;not found&quot;</span> : <span class="r53 r">retValue</span>.<span class="i">Name</span>);
                <b>return</b> <span class="r53 r">retValue</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <span class="r54 r t">T</span> <a id="8cfeae48e6805962" href="../R/8cfeae48e6805962.html" target="n" data-glyph="76,1" class="i method">DotNetGetFirstMemberOrDefaultDelegate</a>&lt;<span id="r54 rd t" class="r54 r t">T</span>&gt;(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r55 rd" class="r55 r">msjObj</span>, <a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r56 rd" class="r56 r">predicate</span>) <b>where</b> <span class="r54 r t">T</span> : <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>
        {
            <span class="c">// Don&#39;t lookup dotnet member if the object doesn&#39;t insist.</span>
            <b>return</b> <span class="r55 r">msjObj</span>.<a href="#457ec7fb90705caa" class="i property">InternalBaseDotNetAdapter</a>?.<span class="i">BaseGetFirstMemberOrDefault</span>&lt;<span class="r54 r t">T</span>&gt;(<span class="r55 r">msjObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>, <span class="r56 r">predicate</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of delegates to get Extended/Adapted/Dotnet members based on the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">viewType</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">viewType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A filter to select Extended/Adapted/Dotnet view of the object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt; <a id="cb3126f4729fbd94" href="../R/cb3126f4729fbd94.html" target="n" data-glyph="74,1" class="i method">GetMemberCollection</a>(<a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a> <span id="r57 rd" class="r57 r">viewType</span>)
        {
            <b>return</b> <a href="#855191b609bc2b2f" class="i method">GetMemberCollection</a>(<span class="r57 r">viewType</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of delegates to get Extended/Adapted/Dotnet members based on the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">viewType</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">viewType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A filter to select Extended/Adapted/Dotnet view of the object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">backupTypeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Backup type table to use if there is no execution context associated with the current thread</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt; <a id="855191b609bc2b2f" href="../R/855191b609bc2b2f.html" target="n" data-glyph="74,1" class="i method">GetMemberCollection</a>(
            <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a> <span id="r58 rd" class="r58 r">viewType</span>,
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r59 rd" class="r59 r">backupTypeTable</span>)
        {
            <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt; <span id="r60 rd" class="r60 r">returnValue</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt;();
            <b>if</b> ((<span class="r58 r">viewType</span> &amp; <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#9a5e7eb3c8a4bb72" class="i field">Extended</a>) == <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#9a5e7eb3c8a4bb72" class="i field">Extended</a>)
            {
                <b>if</b> (<span class="r59 r">backupTypeTable</span> == <b>null</b>)
                {
                    <span class="r60 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(
                        <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#7dee234508c56ab1" class="i method">TypeTableGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                        <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#ac786b8910f1969e" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                        <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#1d31fd7ffb1e12da" class="i method">TypeTableGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                        <b>true</b>, <b>true</b>, <span class="s">&quot;type table members&quot;</span>));
                }
                <b>else</b>
                {
                    <span class="r60 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CollectionEntry</span>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(
                        <span id="r61 rd" class="r61 r">msjObj</span> =&gt; <a href="#7660755da9806a2a" class="i method">TypeTableGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r61 r">msjObj</span>, <span class="r59 r">backupTypeTable</span>),
                        (<span id="r62 rd" class="r62 r">msjObj</span>, <span id="r63 rd" class="r63 r">name</span>) =&gt; <a href="#3f348d45915ab4cb" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r62 r">msjObj</span>, <span class="r59 r">backupTypeTable</span>, <span class="r63 r">name</span>),
                        (<span id="r64 rd" class="r64 r">msjObj</span>, <span id="r65 rd" class="r65 r">predicate</span>) =&gt; <a href="#42e39e019d3338c3" class="i method">TypeTableGetFirstOrDefaultMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r64 r">msjObj</span>, <span class="r59 r">backupTypeTable</span>, <span class="r65 r">predicate</span>),
                        <b>true</b>, <b>true</b>, <span class="s">&quot;type table members&quot;</span>));
                }
            }
 
            <b>if</b> ((<span class="r58 r">viewType</span> &amp; <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#3c776c2dab2d739b" class="i field">Adapted</a>) == <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#3c776c2dab2d739b" class="i field">Adapted</a>)
            {
                <span class="r60 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#f9d7a5c519f51915" class="i method">AdapterGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#899ce42e883492aa" class="i method">AdapterGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#79bb9595e2a070f9" class="i method">AdapterGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                    <span class="r66 r">shouldReplicateWhenReturning</span>: <b>false</b>,
                    <span class="r67 r">shouldCloneWhenReturning</span>: <b>false</b>,
                    <span class="r68 r">collectionNameForTracing</span>: <span class="s">&quot;adapted members&quot;</span>));
            }
 
            <b>if</b> ((<span class="r58 r">viewType</span> &amp; <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#a09761d810a0a73f" class="i field">Base</a>) == <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#a09761d810a0a73f" class="i field">Base</a>)
            {
                <span class="r60 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#d24f0f1ae5a3c79b" class="i method">DotNetGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#f69c3ae371c8355e" class="i method">DotNetGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#8cfeae48e6805962" class="i method">DotNetGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;,
                    <span class="r66 r">shouldReplicateWhenReturning</span>: <b>false</b>,
                    <span class="r67 r">shouldCloneWhenReturning</span>: <b>false</b>,
                    <span class="r68 r">collectionNameForTracing</span>: <span class="s">&quot;clr members&quot;</span>));
            }
 
            <b>return</b> <span class="r60 r">returnValue</span>;
        }
 
        <b>private static</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;&gt; <a id="4a2f54e641fbc942" href="../R/4a2f54e641fbc942.html" target="n" data-glyph="76,1" class="i method">GetMethodCollection</a>()
        {
            <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;&gt; <span id="r69 rd" class="r69 r">returnValue</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;&gt;
            {
                <b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#7dee234508c56ab1" class="i method">TypeTableGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#ac786b8910f1969e" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#1d31fd7ffb1e12da" class="i method">TypeTableGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <span class="r70 r">shouldReplicateWhenReturning</span>: <b>true</b>,
                    <span class="r71 r">shouldCloneWhenReturning</span>: <b>true</b>,
                    <span class="r72 r">collectionNameForTracing</span>: <span class="s">&quot;type table members&quot;</span>),
                <b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#f9d7a5c519f51915" class="i method">AdapterGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#899ce42e883492aa" class="i method">AdapterGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#79bb9595e2a070f9" class="i method">AdapterGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <span class="r70 r">shouldReplicateWhenReturning</span>: <b>false</b>,
                    <span class="r71 r">shouldCloneWhenReturning</span>: <b>false</b>,
                    <span class="r72 r">collectionNameForTracing</span>: <span class="s">&quot;adapted members&quot;</span>),
                <b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#d24f0f1ae5a3c79b" class="i method">DotNetGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#f69c3ae371c8355e" class="i method">DotNetGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#8cfeae48e6805962" class="i method">DotNetGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;,
                    <span class="r70 r">shouldReplicateWhenReturning</span>: <b>false</b>,
                    <span class="r71 r">shouldCloneWhenReturning</span>: <b>false</b>,
                    <span class="r72 r">collectionNameForTracing</span>: <span class="s">&quot;clr members&quot;</span>)
            };
            <b>return</b> <span class="r69 r">returnValue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of delegates to get Extended/Adapted/Dotnet properties based on the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">viewType</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">viewType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A filter to select Extended/Adapted/Dotnet view of the object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt; <a id="60c82c23385d1067" href="../R/60c82c23385d1067.html" target="n" data-glyph="74,1" class="i method">GetPropertyCollection</a>(
            <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a> <span id="r73 rd" class="r73 r">viewType</span>)
        {
            <b>return</b> <a href="#1f16d9e0f8f39912" class="i method">GetPropertyCollection</a>(<span class="r73 r">viewType</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of delegates to get Extended/Adapted/Dotnet properties based on the</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">viewType</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">viewType</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A filter to select Extended/Adapted/Dotnet view of the object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">backupTypeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Backup type table to use if there is no execution context associated with the current thread</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt; <a id="1f16d9e0f8f39912" href="../R/1f16d9e0f8f39912.html" target="n" data-glyph="74,1" class="i method">GetPropertyCollection</a>(
            <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a> <span id="r74 rd" class="r74 r">viewType</span>,
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r75 rd" class="r75 r">backupTypeTable</span>)
        {
            <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt; <span id="r76 rd" class="r76 r">returnValue</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt;();
            <b>if</b> ((<span class="r74 r">viewType</span> &amp; <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#9a5e7eb3c8a4bb72" class="i field">Extended</a>) == <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#9a5e7eb3c8a4bb72" class="i field">Extended</a>)
            {
                <b>if</b> (<span class="r75 r">backupTypeTable</span> == <b>null</b>)
                {
                    <span class="r76 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(
                        <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#7dee234508c56ab1" class="i method">TypeTableGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                        <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#ac786b8910f1969e" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                        <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#1d31fd7ffb1e12da" class="i method">TypeTableGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                        <b>true</b>, <b>true</b>, <span class="s">&quot;type table members&quot;</span>));
                }
                <b>else</b>
                {
                    <span class="r76 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CollectionEntry</span>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(
                        <span id="r77 rd" class="r77 r">msjObj</span> =&gt; <a href="#7660755da9806a2a" class="i method">TypeTableGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(<span class="r77 r">msjObj</span>, <span class="r75 r">backupTypeTable</span>),
                        (<span id="r78 rd" class="r78 r">msjObj</span>, <span id="r79 rd" class="r79 r">name</span>) =&gt; <a href="#3f348d45915ab4cb" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(<span class="r78 r">msjObj</span>, <span class="r75 r">backupTypeTable</span>, <span class="r79 r">name</span>),
                        <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">TypeTableGetFirstMemberOrDefaultDelegate</span>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                        <b>true</b>, <b>true</b>, <span class="s">&quot;type table members&quot;</span>));
                }
            }
 
            <b>if</b> ((<span class="r74 r">viewType</span> &amp; <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#3c776c2dab2d739b" class="i field">Adapted</a>) == <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#3c776c2dab2d739b" class="i field">Adapted</a>)
            {
                <span class="r76 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#f9d7a5c519f51915" class="i method">AdapterGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#899ce42e883492aa" class="i method">AdapterGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#79bb9595e2a070f9" class="i method">AdapterGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                    <b>false</b>, <b>false</b>, <span class="s">&quot;adapted members&quot;</span>));
            }
 
            <b>if</b> ((<span class="r74 r">viewType</span> &amp; <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#a09761d810a0a73f" class="i field">Base</a>) == <a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#a09761d810a0a73f" class="i field">Base</a>)
            {
                <span class="r76 r">returnValue</span>.<span class="i">Add</span>(<b>new</b> <a href="MshMemberInfo.cs.html#058230c7346f3b55" class="t constructor">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#d24f0f1ae5a3c79b" class="i method">DotNetGetMembersDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#f69c3ae371c8355e" class="i method">DotNetGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#8cfeae48e6805962" class="i method">DotNetGetFirstMemberOrDefaultDelegate</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;,
                    <b>false</b>, <b>false</b>, <span class="s">&quot;clr members&quot;</span>));
            }
 
            <b>return</b> <span class="r76 r">returnValue</span>;
        }
 
        <b>private void</b> <a id="e0128aac59f2dcb0" href="../R/e0128aac59f2dcb0.html" target="n" data-glyph="76,1" class="i method">CommonInitialization</a>(<b>object</b> <span id="r80 rd" class="r80 r">obj</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r80 r">obj</span> != <b>null</b>, <span class="s">&quot;checked by callers&quot;</span>);
            <b>if</b> (<span class="r80 r">obj</span> <b>is</b> <a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>)
            {
                <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a> = <b>true</b>;
            }
 
            <a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> = <span class="r80 r">obj</span>;
            <a href="ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r81 rd" class="r81 r">context</span> = <a href="hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
            <a href="#edf2e687c14df594" class="i field">_typeTable</a> = <span class="r81 r">context</span>?.<a href="ExecutionContext.cs.html#b6d5904c3eeb0bf5" class="i property">TypeTableWeakReference</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Adapter Mappings
 
        <b>private static readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<span class="i">Type</span>, <a href="#16d82eb261f231c0" class="t t">AdapterSet</a>&gt; <a id="8b3b74494bacda56" href="../R/8b3b74494bacda56.html" target="n" data-glyph="46,1" class="i field">s_adapterMapping</a> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<span class="i">Type</span>, <a href="#16d82eb261f231c0" class="t t">AdapterSet</a>&gt;();
 
        <b>private static readonly</b> <span class="i">List</span>&lt;<span class="i">Func</span>&lt;<b>object</b>, <a href="#16d82eb261f231c0" class="t t">AdapterSet</a>&gt;&gt; <a id="10b3e952c4fed50d" href="../R/10b3e952c4fed50d.html" target="n" data-glyph="46,1" class="i field">s_adapterSetMappers</a> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Func</span>&lt;<b>object</b>, <a href="#16d82eb261f231c0" class="t t">AdapterSet</a>&gt;&gt;
                                                                                    {
                                                                                        <span class="i">MappedInternalAdapterSet</span>
                                                                                    };
 
        <b>private static</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="0222cb8ea23be282" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">MappedInternalAdapterSet</a>(<b>object</b> <span id="r82 rd" class="r82 r">obj</span>)
        {
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#94055d12f7361fbe" class="i field">s_mshMemberSetAdapter</a>; }
 
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#d5013a7b26b0eb6c" class="i field">s_mshObjectAdapter</a>; }
 
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <span class="i">CimInstance</span>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#bd7b51c675de3e9f" class="i field">s_cimInstanceAdapter</a>; }
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <span class="i">ManagementClass</span>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#f972b786717d0ebb" class="i field">s_managementClassAdapter</a>; }
 
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <span class="i">ManagementBaseObject</span>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#c25e2f595978a886" class="i field">s_managementObjectAdapter</a>; }
 
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <span class="i">DirectoryEntry</span>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#90f6b44882222436" class="i field">s_directoryEntryAdapter</a>; }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <span class="i">DataRowView</span>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#6313460721401595" class="i field">s_dataRowViewAdapter</a>; }
 
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <span class="i">DataRow</span>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#5a7450d3dfba28c1" class="i field">s_dataRowAdapter</a>; }
 
            <b>if</b> (<span class="r82 r">obj</span> <b>is</b> <span class="i">XmlNode</span>) { <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#bf26c42e6f3ef708" class="i field">s_xmlNodeAdapter</a>; }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the adapter corresponding to obj.GetType()</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The adapter set corresponding to obj.GetType().</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="c3772e5257a3f0e8" href="../R/c3772e5257a3f0e8.html" target="n" data-glyph="74,1" class="i method">GetMappedAdapter</a>(<b>object</b> <span id="r83 rd" class="r83 r">obj</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r84 rd" class="r84 r">typeTable</span>)
        {
            <span class="i">Type</span> <span id="r85 rd" class="r85 r">objectType</span> = <span class="r83 r">obj</span>.<span class="i">GetType</span>();
 
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <span id="r86 rd" class="r86 r">adapter</span> = <span class="r84 r">typeTable</span>?.<a href="TypeTable.cs.html#5c1aadb50f439bea" class="i method">GetTypeAdapter</a>(<span class="r85 r">objectType</span>);
 
            <b>if</b> (<span class="r86 r">adapter</span> != <b>null</b>)
            {
                <span class="c">// We don&#39;t cache results found via the type table because type tables may differ b/w runspaces,</span>
                <span class="c">// our cache is app domain wide, and the key is simply the type.</span>
                <b>return</b> <span class="r86 r">adapter</span>;
            }
 
            <b>if</b> (<a href="#8b3b74494bacda56" class="i field">s_adapterMapping</a>.<span class="i">TryGetValue</span>(<span class="r85 r">objectType</span>, <b>out</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <span id="r87 rd" class="r87 r">result</span>))
            {
                <b>return</b> <span class="r87 r">result</span>;
            }
 
            <b>lock</b> (<a href="#10b3e952c4fed50d" class="i field">s_adapterSetMappers</a>)
            {
                <b>foreach</b> (<b>var</b> <span id="r88 rd" class="r88 r">mapper</span> <b>in</b> <a href="#10b3e952c4fed50d" class="i field">s_adapterSetMappers</a>)
                {
                    <span class="r87 r">result</span> = <span class="r88 r">mapper</span>(<span class="r83 r">obj</span>);
                    <b>if</b> (<span class="r87 r">result</span> != <b>null</b>)
                    {
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r87 r">result</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r85 r">objectType</span>.<span class="i">IsCOMObject</span>)
                {
                    <span class="c">// All WinRT types are COM types.</span>
                    <span class="c">// All WinRT types would contain the TypeAttributes flag being set to WindowsRunTime.</span>
                    <b>if</b> (<a href="WinRT/IInspectable.cs.html#3ad1214ea747f068" class="t t">WinRTHelper</a>.<a href="WinRT/IInspectable.cs.html#40254edf05e205a3" class="i method">IsWinRTType</a>(<span class="r85 r">objectType</span>))
                    {
                        <span class="r87 r">result</span> = <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#3402ea72759a9e9c" class="i field">s_dotNetInstanceAdapterSet</a>;
                    }
 
                    <span class="c">// We are not using IsAssignableFrom because we want to avoid</span>
                    <span class="c">// using the COM adapters for Primary Interop Assembly types</span>
                    <span class="c">// and they derive from System.__ComObject.</span>
                    <span class="c">// We are not using Type.Equals because System.__ComObject is</span>
                    <span class="c">// not public.</span>
                    <b>else</b> <b>if</b> (<span class="r85 r">objectType</span>.<span class="i">FullName</span>.<span class="i">Equals</span>(<span class="s">&quot;System.__ComObject&quot;</span>))
                    {
                        <span class="c">// We don&#39;t cache the adapter set for COM objects because the adapter varies depending on the COM object, but often</span>
                        <span class="c">// (typically), the runtime type is always the same.  That&#39;s why this if statement is here and returns.</span>
 
                        <a href="COM/ComTypeInfo.cs.html#cb2cb929589884c9" class="t t">ComTypeInfo</a> <span id="r89 rd" class="r89 r">info</span> = <a href="COM/ComTypeInfo.cs.html#cb2cb929589884c9" class="t t">ComTypeInfo</a>.<a href="COM/ComTypeInfo.cs.html#e3235d54338546ec" class="i method">GetDispatchTypeInfo</a>(<span class="r83 r">obj</span>);
                        <b>return</b> <span class="r89 r">info</span> != <b>null</b>
                                   ? <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <a href="COM/ComAdapter.cs.html#bcb0a0d2341c9615" class="t constructor">ComAdapter</a>(<span class="r89 r">info</span>), <a href="#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>)
                                   : <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#3402ea72759a9e9c" class="i field">s_dotNetInstanceAdapterSet</a>;
                    }
                    <b>else</b>
                    {
                        <a href="COM/ComTypeInfo.cs.html#cb2cb929589884c9" class="t t">ComTypeInfo</a> <span id="r90 rd" class="r90 r">info</span> = <a href="COM/ComTypeInfo.cs.html#cb2cb929589884c9" class="t t">ComTypeInfo</a>.<a href="COM/ComTypeInfo.cs.html#e3235d54338546ec" class="i method">GetDispatchTypeInfo</a>(<span class="r83 r">obj</span>);
                        <span class="r87 r">result</span> = <span class="r90 r">info</span> != <b>null</b>
                                   ? <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <a href="CoreAdapter.cs.html#95818270c558d5d0" class="t constructor">DotNetAdapterWithComTypeName</a>(<span class="r90 r">info</span>), <b>null</b>)
                                   : <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#3402ea72759a9e9c" class="i field">s_dotNetInstanceAdapterSet</a>;
                    }
                }
                <b>else</b>
                {
                    <span class="r87 r">result</span> = <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#3402ea72759a9e9c" class="i field">s_dotNetInstanceAdapterSet</a>;
                }
            }
 
            <b>var</b> <span id="r91 rd" class="r91 r">existingOrNew</span> = <a href="#8b3b74494bacda56" class="i field">s_adapterMapping</a>.<span class="i">GetOrAdd</span>(<span class="r85 r">objectType</span>, <span class="r87 r">result</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r91 r">existingOrNew</span> == <span class="r87 r">result</span>, <span class="s">&quot;There is a logic error in caching adapter sets.&quot;</span>);
 
            <b>return</b> <span class="r87 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>internal static</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="2727850624c84677" href="../R/2727850624c84677.html" target="n" data-glyph="74,1" class="i method">CreateThirdPartyAdapterSet</a>(<span class="i">Type</span> <span id="r92 rd" class="r92 r">adaptedType</span>, <a href="ThirdPartyAdapter.cs.html#17f6467fbb657094" class="t t">PSPropertyAdapter</a> <span id="r93 rd" class="r93 r">adapter</span>)
        {
            <b>return</b> <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <a href="ThirdPartyAdapter.cs.html#54cade2180b45f6b" class="t constructor">ThirdPartyAdapter</a>(<span class="r92 r">adaptedType</span>, <span class="r93 r">adapter</span>), <a href="#de49724160f5edcd" class="i field">s_baseAdapterForAdaptedObjects</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private to the constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of PSObject with an PSCustomObject BaseObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="cbbe437e20e8b8b8" href="../R/cbbe437e20e8b8b8.html" target="n" data-glyph="72,1" class="t constructor">PSObject</a>()
        {
            <a href="#e0128aac59f2dcb0" class="i method">CommonInitialization</a>(<a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>.<a href="#f440822ac3f6fd5d" class="i field">SelfInstance</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of PSObject with an PSCustomObject BaseObject</span>
        <span class="c">///</span><span class="c"> with an initial capacity for members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">instanceMemberCapacity</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The initial capacity for the instance member collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c7153417c495b4af" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PSObject</a>(<b>int</b> <span id="r94 rd" class="r94 r">instanceMemberCapacity</span>) : <a href="#cbbe437e20e8b8b8" class="k">this</a>()
        {
            <a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a> = <b>new</b> <a href="MshMemberInfo.cs.html#8162a541fe91131d" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r94 r">instanceMemberCapacity</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of PSObject wrapping obj (accessible through BaseObject).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object we are wrapping.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">obj</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1720:IdentifiersShouldNotContainTypeNames&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;obj&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This is shipped as part of V1. Retaining this for backward compatibility.&quot;</span>)]
        <b>public</b> <a id="3ee1d75e736c4afc" href="../R/3ee1d75e736c4afc.html" target="n" data-glyph="72,1" class="t constructor">PSObject</a>(<b>object</b> <span id="r95 rd" class="r95 r">obj</span>)
        {
            <b>if</b> (<span class="r95 r">obj</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r95 r">obj</span>));
            }
 
            <a href="#e0128aac59f2dcb0" class="i method">CommonInitialization</a>(<span class="r95 r">obj</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a PSObject from an ISerializable context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The streaming context for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="c8016bee92300903" href="../R/c8016bee92300903.html" target="n" data-glyph="75,1" class="t constructor">PSObject</a>(<span class="i">SerializationInfo</span> <span id="r96 rd" class="r96 r">info</span>, <span class="i">StreamingContext</span> <span id="r97 rd" class="r97 r">context</span>)
        {
            <b>if</b> (<span class="r96 r">info</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r96 r">info</span>));
            }
 
            <b>if</b> (!(<span class="r96 r">info</span>.<span class="i">GetValue</span>(<span class="s">&quot;CliXml&quot;</span>, <b>typeof</b>(<b>string</b>)) <b>is string</b> <span id="r98 rd" class="r98 r">serializedData</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r96 r">info</span>));
            }
 
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r99 rd" class="r99 r">result</span> = <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e81a321a846beda7" class="i method">AsPSObject</a>(<a href="serialization.cs.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<a href="serialization.cs.html#d9210d35690d435f" class="i method">Deserialize</a>(<span class="r98 r">serializedData</span>));
            <a href="#e0128aac59f2dcb0" class="i method">CommonInitialization</a>(<span class="r99 r">result</span>.<a href="#d4170653add67c11" class="i property">ImmediateBaseObject</a>);
 
            <a href="#41bdc8470b711aef" class="i method">CopyDeserializerFields</a>(<span class="r100 r">source</span>: <span class="r99 r">result</span>, <span class="r101 r">target</span>: <a href="#a3c2513aa3da07fa" class="k">this</a>);
        }
 
        <b>internal static</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="da1a0c5544c2130d" href="../R/da1a0c5544c2130d.html" target="n" data-glyph="74,1" class="i method">ConstructPSObjectFromSerializationInfo</a>(<span class="i">SerializationInfo</span> <span id="r102 rd" class="r102 r">info</span>, <span class="i">StreamingContext</span> <span id="r103 rd" class="r103 r">context</span>)
        {
            <b>return</b> <b>new</b> <a href="#c8016bee92300903" class="t constructor">PSObject</a>(<span class="r102 r">info</span>, <span class="r103 r">context</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> fields
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> instance fields
 
        <b>private readonly object</b> <a id="fdc00447f943248b" href="../R/fdc00447f943248b.html" target="n" data-glyph="46,1" class="i field">_lockObject</a> = <b>new</b> <b>object</b>();
 
        <b>private</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="37278d46e00b78ec" href="../R/37278d46e00b78ec.html" target="n" data-glyph="46,1" class="i field">_typeNames</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the main field in the class representing</span>
        <span class="c">///</span><span class="c"> the System.Object we are encapsulating.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private object</b> <a id="8c16eebde29bd5f9" href="../R/8c16eebde29bd5f9.html" target="n" data-glyph="46,1" class="i field">_immediateBaseObject</a>;
 
        <b>private</b> <span class="i">WeakReference</span>&lt;<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>&gt; <a id="edf2e687c14df594" href="../R/edf2e687c14df594.html" target="n" data-glyph="46,1" class="i field">_typeTable</a>;
        <b>private</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="99b88dfe2d0d8a63" href="../R/99b88dfe2d0d8a63.html" target="n" data-glyph="46,1" class="i field">_adapterSet</a>;
        <b>private</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <a id="8fbc79e4c54109eb" href="../R/8fbc79e4c54109eb.html" target="n" data-glyph="46,1" class="i field">_instanceMembers</a>;
        <b>private</b> <a href="MshMemberInfo.cs.html#520db5b1e8966ea1" class="t t">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <a id="f218e3471ddd47aa" href="../R/f218e3471ddd47aa.html" target="n" data-glyph="46,1" class="i field">_members</a>;
        <b>private</b> <a href="MshMemberInfo.cs.html#520db5b1e8966ea1" class="t t">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <a id="e556fdf033bc2eca" href="../R/e556fdf033bc2eca.html" target="n" data-glyph="46,1" class="i field">_properties</a>;
        <b>private</b> <a href="MshMemberInfo.cs.html#520db5b1e8966ea1" class="t t">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt; <a id="b40abab072d122e1" href="../R/b40abab072d122e1.html" target="n" data-glyph="46,1" class="i field">_methods</a>;
 
        <b>private</b> <a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a> <a id="6dfe7fdb239cdd76" href="../R/6dfe7fdb239cdd76.html" target="n" data-glyph="46,1" class="i field">_flags</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> instance fields
 
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="2f0fbfca7b867b87" href="../R/2f0fbfca7b867b87.html" target="n" data-glyph="46,1" class="i field">s_memberResolution</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#24b0f68d5add3eb3" class="i method">GetTracer</a>(<span class="s">&quot;MemberResolution&quot;</span>, <span class="s">&quot;Traces the resolution from member name to the member. A member can be a property, method, etc.&quot;</span>, <b>false</b>);
 
        <b>private static readonly</b> <span class="i">ConditionalWeakTable</span>&lt;<b>object</b>, <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt; <a id="1b544828fc4bf3ca" href="../R/1b544828fc4bf3ca.html" target="n" data-glyph="46,1" class="i field">s_typeNamesResurrectionTable</a> = <b>new</b> <span class="i">ConditionalWeakTable</span>&lt;<b>object</b>, <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a>&gt;();
 
        <b>private static readonly</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt; <a id="d2986432b06515f6" href="../R/d2986432b06515f6.html" target="n" data-glyph="46,1" class="i field">s_memberCollection</a> = <a href="#cb3126f4729fbd94" class="i method">GetMemberCollection</a>(<a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#525826a417e26897" class="i field">All</a>);
        <b>private static readonly</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;&gt; <a id="fdd7a9b4fa7540d7" href="../R/fdd7a9b4fa7540d7.html" target="n" data-glyph="46,1" class="i field">s_methodCollection</a> = <a href="#4a2f54e641fbc942" class="i method">GetMethodCollection</a>();
        <b>private static readonly</b> <span class="i">Collection</span>&lt;<a href="MshMemberInfo.cs.html#b4eae19a609e9065" class="t t">CollectionEntry</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;&gt; <a id="21080d8bcdb088a2" href="../R/21080d8bcdb088a2.html" target="n" data-glyph="46,1" class="i field">s_propertyCollection</a> = <a href="#60c82c23385d1067" class="i method">GetPropertyCollection</a>(<a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#525826a417e26897" class="i field">All</a>);
 
        <b>private static readonly</b> <a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a> <a id="48562d9930b22ac8" href="../R/48562d9930b22ac8.html" target="n" data-glyph="46,1" class="i field">s_dotNetInstanceAdapter</a> = <b>new</b> <a href="CoreAdapter.cs.html#6658f94fd5929609" class="t constructor">DotNetAdapter</a>();
        <b>private static readonly</b> <a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a> <a id="de49724160f5edcd" href="../R/de49724160f5edcd.html" target="n" data-glyph="46,1" class="i field">s_baseAdapterForAdaptedObjects</a> = <b>new</b> <span class="t">BaseDotNetAdapterForAdaptedObjects</span>();
        <b>private static readonly</b> <a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a> <a id="d306ec6bcf4d65d0" href="../R/d306ec6bcf4d65d0.html" target="n" data-glyph="46,1" class="i field">s_dotNetStaticAdapter</a> = <b>new</b> <a href="CoreAdapter.cs.html#50a27efb3848aebe" class="t constructor">DotNetAdapter</a>(<b>true</b>);
 
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="3402ea72759a9e9c" href="../R/3402ea72759a9e9c.html" target="n" data-glyph="46,1" class="i field">s_dotNetInstanceAdapterSet</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<a href="#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>, <b>null</b>);
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="94055d12f7361fbe" href="../R/94055d12f7361fbe.html" target="n" data-glyph="46,1" class="i field">s_mshMemberSetAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">PSMemberSetAdapter</span>(), <b>null</b>);
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="d5013a7b26b0eb6c" href="../R/d5013a7b26b0eb6c.html" target="n" data-glyph="46,1" class="i field">s_mshObjectAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">PSObjectAdapter</span>(), <b>null</b>);
 
        <b>private static readonly</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="bd7b51c675de3e9f" href="../R/bd7b51c675de3e9f.html" target="n" data-glyph="46,1" class="i field">s_cimInstanceAdapter</a> =
            <b>new</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">ThirdPartyAdapter</span>(<b>typeof</b>(<span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimInstance</span>),
                                                          <b>new</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Cim</span>.<span class="t">CimInstanceAdapter</span>()),
                                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>);
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="c25e2f595978a886" href="../R/c25e2f595978a886.html" target="n" data-glyph="46,1" class="i field">s_managementObjectAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">ManagementObjectAdapter</span>(), <a href="#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>);
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="f972b786717d0ebb" href="../R/f972b786717d0ebb.html" target="n" data-glyph="46,1" class="i field">s_managementClassAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">ManagementClassApdapter</span>(), <a href="#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>);
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="90f6b44882222436" href="../R/90f6b44882222436.html" target="n" data-glyph="46,1" class="i field">s_directoryEntryAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">DirectoryEntryAdapter</span>(), <a href="#20218854b572ba17" class="i property">DotNetInstanceAdapter</a>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="6313460721401595" href="../R/6313460721401595.html" target="n" data-glyph="46,1" class="i field">s_dataRowViewAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">DataRowViewAdapter</span>(), <a href="#de49724160f5edcd" class="i field">s_baseAdapterForAdaptedObjects</a>);
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="5a7450d3dfba28c1" href="../R/5a7450d3dfba28c1.html" target="n" data-glyph="46,1" class="i field">s_dataRowAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">DataRowAdapter</span>(), <a href="#de49724160f5edcd" class="i field">s_baseAdapterForAdaptedObjects</a>);
        <b>private static readonly</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="bf26c42e6f3ef708" href="../R/bf26c42e6f3ef708.html" target="n" data-glyph="46,1" class="i field">s_xmlNodeAdapter</a> = <b>new</b> <a href="#c967055107a51782" class="t constructor">AdapterSet</a>(<b>new</b> <span class="t">XmlNodeAdapter</span>(), <a href="#de49724160f5edcd" class="i field">s_baseAdapterForAdaptedObjects</a>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> fields
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> properties
 
        <b>internal</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <a id="e518df2aeb312ac9" href="../R/e518df2aeb312ac9.html" target="n" data-glyph="104,1" class="i property">InstanceMembers</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#fdc00447f943248b" class="i field">_lockObject</a>)
                    {
                        <b>if</b> (<a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a> == <b>null</b>)
                        {
                            <a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a> =
                                <a href="#1dd81913e4ff9947" class="i field">s_instanceMembersResurrectionTable</a>.<span class="i">GetValue</span>(
                                    <a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>),
                                    <span id="r104 rd" class="r104 r">_</span> =&gt; <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;());
                        }
                    }
                }
 
                <b>return</b> <a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a>;
            }
 
            <b>set</b> =&gt; <a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the adapter that will depend on the type of baseObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CoreAdapter.cs.html#88aa0312e9fc25c7" class="t t">Adapter</a> <a id="c3997c282bafb530" href="../R/c3997c282bafb530.html" target="n" data-glyph="104,1" class="i property">InternalAdapter</a> =&gt; <a href="#d589cbe59a010f1c" class="i property">InternalAdapterSet</a>.<a href="#ae0218d7abc2d496" class="i property">OriginalAdapter</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the adapter that is used to resolve the base dotnet members for an</span>
        <span class="c">///</span><span class="c"> adapted object. If an object is not adapted, this will be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If an object is not adapted, InternalAdapter will use the dotnet adapter.</span>
        <span class="c">///</span><span class="c"> So there is no point falling back to the same dotnet adapter.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If an object is adapted, this adapter will be used to resolve the dotnet</span>
        <span class="c">///</span><span class="c"> members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CoreAdapter.cs.html#88aa0312e9fc25c7" class="t t">Adapter</a> <a id="457ec7fb90705caa" href="../R/457ec7fb90705caa.html" target="n" data-glyph="104,1" class="i property">InternalBaseDotNetAdapter</a> =&gt; <a href="#d589cbe59a010f1c" class="i property">InternalAdapterSet</a>.<a href="#6e03ccc45b630635" class="i property">DotNetAdapter</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the adapter set that will contain the adapter of the baseObject</span>
        <span class="c">///</span><span class="c"> and the ultimate .net member lookup adapter.</span>
        <span class="c">///</span><span class="c"> See </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#16d82eb261f231c0" class="t t">AdapterSet</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for explanation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#16d82eb261f231c0" class="t t">AdapterSet</a> <a id="d589cbe59a010f1c" href="../R/d589cbe59a010f1c.html" target="n" data-glyph="106,1" class="i property">InternalAdapterSet</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#99b88dfe2d0d8a63" class="i field">_adapterSet</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#fdc00447f943248b" class="i field">_lockObject</a>)
                    {
                        <b>if</b> (<a href="#99b88dfe2d0d8a63" class="i field">_adapterSet</a> == <b>null</b>)
                        {
                            <a href="#99b88dfe2d0d8a63" class="i field">_adapterSet</a> = <a href="#c3772e5257a3f0e8" class="i method">GetMappedAdapter</a>(<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>, <a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>());
                        }
                    }
                }
 
                <b>return</b> <a href="#99b88dfe2d0d8a63" class="i field">_adapterSet</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the member collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="MshMemberInfo.cs.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <a id="56bc82b240e4291b" href="../R/56bc82b240e4291b.html" target="n" data-glyph="102,1" class="i property">Members</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#f218e3471ddd47aa" class="i field">_members</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#fdc00447f943248b" class="i field">_lockObject</a>)
                    {
                        <b>if</b> (<a href="#f218e3471ddd47aa" class="i field">_members</a> == <b>null</b>)
                        {
                            <a href="#f218e3471ddd47aa" class="i field">_members</a> = <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<a href="#a3c2513aa3da07fa" class="k">this</a>, <a href="#d2986432b06515f6" class="i field">s_memberCollection</a>);
                        }
                    }
                }
 
                <b>return</b> <a href="#f218e3471ddd47aa" class="i field">_members</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Property collection, or the members that are actually properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="MshMemberInfo.cs.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <a id="59e9cd1ad57ccd34" href="../R/59e9cd1ad57ccd34.html" target="n" data-glyph="102,1" class="i property">Properties</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#e556fdf033bc2eca" class="i field">_properties</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#fdc00447f943248b" class="i field">_lockObject</a>)
                    {
                        <b>if</b> (<a href="#e556fdf033bc2eca" class="i field">_properties</a> == <b>null</b>)
                        {
                            <a href="#e556fdf033bc2eca" class="i field">_properties</a> = <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(<a href="#a3c2513aa3da07fa" class="k">this</a>, <a href="#21080d8bcdb088a2" class="i field">s_propertyCollection</a>);
                        }
                    }
                }
 
                <b>return</b> <a href="#e556fdf033bc2eca" class="i field">_properties</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Method collection, or the members that are actually methods.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="MshMemberInfo.cs.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt; <a id="6cb42c4e7cce30cd" href="../R/6cb42c4e7cce30cd.html" target="n" data-glyph="102,1" class="i property">Methods</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#b40abab072d122e1" class="i field">_methods</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#fdc00447f943248b" class="i field">_lockObject</a>)
                    {
                        <b>if</b> (<a href="#b40abab072d122e1" class="i field">_methods</a> == <b>null</b>)
                        {
                            <a href="#b40abab072d122e1" class="i field">_methods</a> = <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;(<a href="#a3c2513aa3da07fa" class="k">this</a>, <a href="#fdd7a9b4fa7540d7" class="i field">s_methodCollection</a>);
                        }
                    }
                }
 
                <b>return</b> <a href="#b40abab072d122e1" class="i field">_methods</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the object we are directly wrapping.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">If the ImmediateBaseObject is another PSObject,</span>
        <span class="c">///</span><span class="c"> that PSObject will be returned.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public object</b> <a id="d4170653add67c11" href="../R/d4170653add67c11.html" target="n" data-glyph="102,1" class="i property">ImmediateBaseObject</a> =&gt; <a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the object we are wrapping.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">If the ImmediateBaseObject is another PSObject, this property</span>
        <span class="c">///</span><span class="c"> will return its BaseObject.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public object</b> <a id="d854d13536b70a12" href="../R/d854d13536b70a12.html" target="n" data-glyph="102,1" class="i property">BaseObject</a>
        {
            <b>get</b>
            {
                <b>object</b> <span id="r105 rd" class="r105 r">returnValue</span>;
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r106 rd" class="r106 r">mshObj</span> = <a href="#a3c2513aa3da07fa" class="k">this</a>;
                <b>do</b>
                {
                    <span class="r105 r">returnValue</span> = <span class="r106 r">mshObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>;
                    <span class="r106 r">mshObj</span> = <span class="r105 r">returnValue</span> <b>as</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>;
                } <b>while</b> (<span class="r106 r">mshObj</span> != <b>null</b>);
 
                <b>return</b> <span class="r105 r">returnValue</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type names collection initially containing the object type hierarchy.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="86c0a84d554979ba" href="../R/86c0a84d554979ba.html" target="n" data-glyph="102,1" class="i property">TypeNames</a>
        {
            <b>get</b>
            {
                <a href="TypeTable.cs.html#d34ed619706e31fc" class="k">var</a> <span id="r107 rd" class="r107 r">result</span> = <a href="#829da48f79891848" class="i property">InternalTypeNames</a>;
                <b>if</b> (<span class="r107 r">result</span>.<a href="TypeTable.cs.html#6cd96f8516d597b0" class="i property">IsReadOnly</a>)
                {
                    <b>lock</b> (<a href="#fdc00447f943248b" class="i field">_lockObject</a>)
                    {
                        <span class="c">// Check again after acquiring the lock to ensure some other thread didn&#39;t make the copy.</span>
                        <b>if</b> (<span class="r107 r">result</span>.<a href="TypeTable.cs.html#6cd96f8516d597b0" class="i property">IsReadOnly</a>)
                        {
                            <a href="#37278d46e00b78ec" class="i field">_typeNames</a> = <a href="#1b544828fc4bf3ca" class="i field">s_typeNamesResurrectionTable</a>.<span class="i">GetValue</span>(
                                            <a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>),
                                            <span id="r108 rd" class="r108 r">_</span> =&gt; <b>new</b> <a href="TypeTable.cs.html#17d617d311bac184" class="t constructor">ConsolidatedString</a>(<a href="#37278d46e00b78ec" class="i field">_typeNames</a>));
 
                            <b>object</b> <span id="r109 rd" class="r109 r">baseObj</span> = <a href="#d854d13536b70a12" class="i property">BaseObject</a>;
                            <span class="c">// In most cases, the TypeNames will be modified after it&#39;s returned</span>
                            <b>if</b> (<span class="r109 r">baseObj</span> != <b>null</b>) { <a href="runtime/Binding/Binders.cs.html#0cc44259d9b27d72" class="t t">PSVariableAssignmentBinder</a>.<span class="i">NoteTypeHasInstanceMemberOrTypeName</span>(<span class="r109 r">baseObj</span>.<span class="i">GetType</span>()); }
 
                            <b>return</b> <a href="#37278d46e00b78ec" class="i field">_typeNames</a>;
                        }
                    }
                }
 
                <b>return</b> <span class="r107 r">result</span>;
            }
        }
 
        <b>internal</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="829da48f79891848" href="../R/829da48f79891848.html" target="n" data-glyph="104,1" class="i property">InternalTypeNames</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#37278d46e00b78ec" class="i field">_typeNames</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#fdc00447f943248b" class="i field">_lockObject</a>)
                    {
                        <b>if</b> (<a href="#37278d46e00b78ec" class="i field">_typeNames</a> == <b>null</b>)
                        {
                            <b>if</b> (!<a href="#1b544828fc4bf3ca" class="i field">s_typeNamesResurrectionTable</a>.<span class="i">TryGetValue</span>(<a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>), <b>out</b> <a href="#37278d46e00b78ec" class="i field">_typeNames</a>))
                            {
                                <span class="c">// We don&#39;t cache this typename in the resurrection table because it&#39;s cached in the psobject,</span>
                                <span class="c">// and the assumption is we&#39;ll usually get the value directly from the PSObject, so it&#39;s not</span>
                                <span class="c">// needed in the resurrection table.</span>
                                <span class="c">//</span>
                                <span class="c">// If we hand out the typename to a client that could change it (through the public property</span>
                                <span class="c">// TypeNames), then we&#39;ll need to store the copy in the resurrection table.</span>
                                <a href="#37278d46e00b78ec" class="i field">_typeNames</a> = <a href="#c3997c282bafb530" class="i property">InternalAdapter</a>.<a href="CoreAdapter.cs.html#e70aa32975138432" class="i method">BaseGetTypeNameHierarchy</a>(<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>);
                            }
                        }
                    }
                }
 
                <b>return</b> <a href="#37278d46e00b78ec" class="i field">_typeNames</a>;
            }
 
            <b>set</b> =&gt; <a href="#37278d46e00b78ec" class="i field">_typeNames</a> = <b>value</b>;
        }
 
        <b>internal static</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <a id="0dfe59c032d463c4" href="../R/0dfe59c032d463c4.html" target="n" data-glyph="74,1" class="i method">GetTypeNames</a>(<b>object</b> <span id="r110 rd" class="r110 r">obj</span>)
        {
            <b>if</b> (<span class="r110 r">obj</span> <b>is</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r111 rd" class="r111 r">psobj</span>)
            {
                <b>return</b> <span class="r111 r">psobj</span>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>;
            }
 
            <b>if</b> (<a href="#05391b9ab0d48975" class="i method">HasInstanceTypeName</a>(<span class="r110 r">obj</span>, <b>out</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <span id="r112 rd" class="r112 r">result</span>))
            {
                <b>return</b> <span class="r112 r">result</span>;
            }
 
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#c3772e5257a3f0e8" class="i method">GetMappedAdapter</a>(<span class="r110 r">obj</span>, <b>null</b>).<a href="#ae0218d7abc2d496" class="i property">OriginalAdapter</a>.<a href="CoreAdapter.cs.html#e70aa32975138432" class="i method">BaseGetTypeNameHierarchy</a>(<span class="r110 r">obj</span>);
        }
 
        <b>internal static bool</b> <a id="05391b9ab0d48975" href="../R/05391b9ab0d48975.html" target="n" data-glyph="74,1" class="i method">HasInstanceTypeName</a>(<b>object</b> <span id="r113 rd" class="r113 r">obj</span>, <b>out</b> <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <span id="r114 rd" class="r114 r">result</span>)
        {
            <b>return</b> <a href="#1b544828fc4bf3ca" class="i field">s_typeNamesResurrectionTable</a>.<span class="i">TryGetValue</span>(<a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<span class="r113 r">obj</span>), <b>out</b> <span class="r114 r">result</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> static methods
        <b>internal static bool</b> <a id="364e445adfd28491" href="../R/364e445adfd28491.html" target="n" data-glyph="74,1" class="i method">HasInstanceMembers</a>(<b>object</b> <span id="r115 rd" class="r115 r">obj</span>, <b>out</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r116 rd" class="r116 r">instanceMembers</span>)
        {
            <b>if</b> (<span class="r115 r">obj</span> <b>is</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r117 rd" class="r117 r">psobj</span>)
            {
                <b>lock</b> (<span class="r117 r">psobj</span>)
                {
                    <b>if</b> (<span class="r117 r">psobj</span>.<a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a> == <b>null</b>)
                    {
                        <a href="#1dd81913e4ff9947" class="i field">s_instanceMembersResurrectionTable</a>.<span class="i">TryGetValue</span>(<a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<span class="r117 r">psobj</span>), <b>out</b> <span class="r117 r">psobj</span>.<a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a>);
                    }
                }
 
                <span class="r116 r">instanceMembers</span> = <span class="r117 r">psobj</span>.<a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a>;
            }
            <b>else</b> <b>if</b> (<span class="r115 r">obj</span> != <b>null</b>)
            {
                <a href="#1dd81913e4ff9947" class="i field">s_instanceMembersResurrectionTable</a>.<span class="i">TryGetValue</span>(<a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<span class="r115 r">obj</span>), <b>out</b> <span class="r116 r">instanceMembers</span>);
            }
            <b>else</b>
            {
                <span class="r116 r">instanceMembers</span> = <b>null</b>;
            }
 
            <b>return</b> <span class="r116 r">instanceMembers</span> != <b>null</b> &amp;&amp; <span class="r116 r">instanceMembers</span>.<a href="MshMemberInfo.cs.html#85006968f446d94b" class="i property">Count</a> &gt; 0;
        }
 
        <b>private static readonly</b> <span class="i">ConditionalWeakTable</span>&lt;<b>object</b>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt; <a id="1dd81913e4ff9947" href="../R/1dd81913e4ff9947.html" target="n" data-glyph="46,1" class="i field">s_instanceMembersResurrectionTable</a> =
            <b>new</b> <span class="i">ConditionalWeakTable</span>&lt;<b>object</b>, <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static implicit operator</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>(<b>int</b> <span id="r118 rd" class="r118 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r118 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static implicit operator</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>(<b>string</b> <span id="r119 rd" class="r119 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r119 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static implicit operator</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>(<span class="i">Hashtable</span> <span id="r120 rd" class="r120 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r120 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static implicit operator</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>(<b>double</b> <span id="r121 rd" class="r121 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r121 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">valueToConvert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static implicit operator</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>(<b>bool</b> <span id="r122 rd" class="r122 r">valueToConvert</span>)
        {
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r122 r">valueToConvert</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If obj is not an PSObject, it is returned. Otherwise, retrieves</span>
        <span class="c">///</span><span class="c"> the first non PSObject or PSObject with CustomBaseObject</span>
        <span class="c">///</span><span class="c"> in the PSObject - BaseObject chain.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="8ae71f08053e5ae1" href="../R/8ae71f08053e5ae1.html" target="n" data-glyph="74,1" class="i method">Base</a>(<b>object</b> <span id="r123 rd" class="r123 r">obj</span>)
        {
            <b>if</b> (!(<span class="r123 r">obj</span> <b>is</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r124 rd" class="r124 r">mshObj</span>))
            {
                <b>return</b> <span class="r123 r">obj</span>;
            }
 
            <b>if</b> (<span class="r124 r">mshObj</span> == <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                <b>return</b> <b>null</b>;
            <b>if</b> (<span class="r124 r">mshObj</span>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>)
            {
                <b>return</b> <span class="r123 r">obj</span>;
            }
 
            <b>object</b> <span id="r125 rd" class="r125 r">returnValue</span>;
            <b>do</b>
            {
                <span class="r125 r">returnValue</span> = <span class="r124 r">mshObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>;
                <span class="r124 r">mshObj</span> = <span class="r125 r">returnValue</span> <b>as</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>;
            } <b>while</b> ((<span class="r124 r">mshObj</span> != <b>null</b>) &amp;&amp; (!<span class="r124 r">mshObj</span>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>));
 
            <b>return</b> <span class="r125 r">returnValue</span>;
        }
 
        <b>internal static</b> <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="ab8f37f21c281edc" href="../R/ab8f37f21c281edc.html" target="n" data-glyph="74,1" class="i method">GetStaticCLRMember</a>(<b>object</b> <span id="r126 rd" class="r126 r">obj</span>, <b>string</b> <span id="r127 rd" class="r127 r">methodName</span>)
        {
            <span class="r126 r">obj</span> = <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r126 r">obj</span>);
            <b>if</b> (<span class="r126 r">obj</span> == <b>null</b> || <span class="r127 r">methodName</span> == <b>null</b> || <span class="r127 r">methodName</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>var</b> <span id="r128 rd" class="r128 r">objType</span> = <span class="r126 r">obj</span> <b>as</b> <span class="i">Type</span> ?? <span class="r126 r">obj</span>.<span class="i">GetType</span>();
            <b>return</b> <a href="#09463c4cdacf00f4" class="i property">DotNetStaticAdapter</a>.<span class="i">BaseGetMember</span>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r128 r">objType</span>, <span class="r127 r">methodName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If obj is an PSObject it will be returned as is, otherwise</span>
        <span class="c">///</span><span class="c"> a new PSObject will be created based on obj.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to be wrapped.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> obj or a new PSObject whose BaseObject is obj</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">obj</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1720:IdentifiersShouldNotContainTypeNames&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;obj&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;This is shipped as part of V1. Retaining this for backward compatibility.&quot;</span>)]
        <b>public static</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="e81a321a846beda7" href="../R/e81a321a846beda7.html" target="n" data-glyph="72,1" class="i method">AsPSObject</a>(<b>object</b> <span id="r129 rd" class="r129 r">obj</span>)
        {
            <b>return</b> <a href="#755f4bdabd8b3b84" class="i method">AsPSObject</a>(<span class="r129 r">obj</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If obj is a PSObject, it will be returned as is, otherwise a new</span>
        <span class="c">///</span><span class="c"> PSObject will be created on obj. Its InstanceMembers and TypeNames</span>
        <span class="c">///</span><span class="c"> will be initialized if we are not going to use the ResurrectionTables</span>
        <span class="c">///</span><span class="c"> for this PSObject instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r131 r">storeTypeNameAndInstanceMembersLocally</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1720:IdentifiersShouldNotContainTypeNames&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;obj&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;AsPSObject is shipped as part of V1. This is a new overload method.&quot;</span>)]
        <b>internal static</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="755f4bdabd8b3b84" href="../R/755f4bdabd8b3b84.html" target="n" data-glyph="74,1" class="i method">AsPSObject</a>(<b>object</b> <span id="r130 rd" class="r130 r">obj</span>, <b>bool</b> <span id="r131 rd" class="r131 r">storeTypeNameAndInstanceMembersLocally</span>)
        {
            <b>if</b> (<span class="r130 r">obj</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r130 r">obj</span>));
            }
 
            <b>if</b> (<span class="r130 r">obj</span> <b>is</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r132 rd" class="r132 r">so</span>)
            {
                <b>return</b> <span class="r132 r">so</span>;
            }
 
            <b>return</b> <b>new</b> <a href="#3ee1d75e736c4afc" class="t constructor">PSObject</a>(<span class="r130 r">obj</span>) { <a href="#9b5bfd3e7e1a661c" class="i property">StoreTypeNameAndInstanceMembersLocally</a> = <span class="r131 r">storeTypeNameAndInstanceMembersLocally</span> };
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an object that should be used as a key for getting 1) instance members and 2) type names</span>
        <span class="c">///</span><span class="c"> - If base object is a PSCustomObject or a string or a type</span>
        <span class="c">///</span><span class="c">   then the most nested wrapping PSObject is returned (the PSObject where immediateBaseObject=PSCustomObject/string/type)</span>
        <span class="c">///</span><span class="c"> - Otherwise the base object is returned</span>
        <span class="c">///</span><span class="c"> This is a temporary fix for Win8 : 254345 - Job Failed By Throwing ExtendedTypeSystemException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="0fd6e301844c990e" href="../R/0fd6e301844c990e.html" target="n" data-glyph="74,1" class="i method">GetKeyForResurrectionTables</a>(<b>object</b> <span id="r133 rd" class="r133 r">obj</span>)
        {
            <b>if</b> (!(<span class="r133 r">obj</span> <b>is</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r134 rd" class="r134 r">pso</span>))
            {
                <b>return</b> <span class="r133 r">obj</span>;
            }
 
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r135 rd" class="r135 r">psObjectAboveBase</span> = <span class="r134 r">pso</span>;
            <b>while</b> (<span class="r135 r">psObjectAboveBase</span>.<a href="#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>is</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <span class="r135 r">psObjectAboveBase</span> = (<a href="#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r135 r">psObjectAboveBase</span>.<a href="#d4170653add67c11" class="i property">ImmediateBaseObject</a>;
            }
 
            <b>if</b> (<span class="r135 r">psObjectAboveBase</span>.<a href="#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>is</b> <a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>
                || <span class="r135 r">psObjectAboveBase</span>.<a href="#d4170653add67c11" class="i property">ImmediateBaseObject</a> <b>is string</b>
                || <span class="r134 r">pso</span>.<a href="#9b5bfd3e7e1a661c" class="i property">StoreTypeNameAndInstanceMembersLocally</a>)
            {
                <b>return</b> <span class="r135 r">psObjectAboveBase</span>;
            }
 
            <b>return</b> <span class="r135 r">psObjectAboveBase</span>.<a href="#d4170653add67c11" class="i property">ImmediateBaseObject</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> static methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> instance methods
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ToString
 
        <b>private static string</b> <a id="4624a2b6f81a22d5" href="../R/4624a2b6f81a22d5.html" target="n" data-glyph="76,1" class="i method">GetSeparator</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r136 rd" class="r136 r">context</span>, <b>string</b> <span id="r137 rd" class="r137 r">separator</span>)
        {
            <b>if</b> (<span class="r137 r">separator</span> != <b>null</b>)
            {
                <b>return</b> <span class="r137 r">separator</span>;
            }
 
            <b>object</b> <span id="r138 rd" class="r138 r">obj</span> = <span class="r136 r">context</span>?.<a href="ExecutionContext.cs.html#3a6f9a48ec862dfb" class="i method">GetVariableValue</a>(<a href="SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="SpecialVariables.cs.html#94cb0dc3b18b4df6" class="i field">OFSVarPath</a>);
            <b>if</b> (<span class="r138 r">obj</span> != <b>null</b>)
            {
                <b>return</b> <span class="r138 r">obj</span>.<span class="i">ToString</span>();
            }
 
            <b>return</b> <span class="s">&quot; &quot;</span>;
        }
 
        <b>internal static string</b> <a id="8b4e7a6d0dda77da" href="../R/8b4e7a6d0dda77da.html" target="n" data-glyph="74,1" class="i method">ToStringEnumerator</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r139 rd" class="r139 r">context</span>, <span class="i">IEnumerator</span> <span id="r140 rd" class="r140 r">enumerator</span>, <b>string</b> <span id="r141 rd" class="r141 r">separator</span>, <b>string</b> <span id="r142 rd" class="r142 r">format</span>, <span class="i">IFormatProvider</span> <span id="r143 rd" class="r143 r">formatProvider</span>)
        {
            <span class="i">StringBuilder</span> <span id="r144 rd" class="r144 r">returnValue</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>string</b> <span id="r145 rd" class="r145 r">separatorToUse</span> = <a href="#4624a2b6f81a22d5" class="i method">GetSeparator</a>(<span class="r139 r">context</span>, <span class="r141 r">separator</span>);
            <b>while</b> (<span class="r140 r">enumerator</span>.<span class="i">MoveNext</span>())
            {
                <b>object</b> <span id="r146 rd" class="r146 r">obj</span> = <span class="r140 r">enumerator</span>.<span class="i">Current</span>;
                <span class="r144 r">returnValue</span>.<span class="i">Append</span>(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e7ab15d0863aa3d6" class="i method">ToString</a>(<span class="r139 r">context</span>, <span class="r146 r">obj</span>, <span class="r141 r">separator</span>, <span class="r142 r">format</span>, <span class="r143 r">formatProvider</span>, <b>false</b>, <b>false</b>));
                <span class="r144 r">returnValue</span>.<span class="i">Append</span>(<span class="r145 r">separatorToUse</span>);
            }
 
            <b>if</b> (<span class="r144 r">returnValue</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>int</b> <span id="r147 rd" class="r147 r">separatorLength</span> = <span class="r145 r">separatorToUse</span>.<span class="i">Length</span>;
            <span class="r144 r">returnValue</span>.<span class="i">Remove</span>(<span class="r144 r">returnValue</span>.<span class="i">Length</span> - <span class="r147 r">separatorLength</span>, <span class="r147 r">separatorLength</span>);
            <b>return</b> <span class="r144 r">returnValue</span>.<span class="i">ToString</span>();
        }
 
        <b>internal static string</b> <a id="1576938cd9601319" href="../R/1576938cd9601319.html" target="n" data-glyph="74,1" class="i method">ToStringEnumerable</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r148 rd" class="r148 r">context</span>, <span class="i">IEnumerable</span> <span id="r149 rd" class="r149 r">enumerable</span>, <b>string</b> <span id="r150 rd" class="r150 r">separator</span>, <b>string</b> <span id="r151 rd" class="r151 r">format</span>, <span class="i">IFormatProvider</span> <span id="r152 rd" class="r152 r">formatProvider</span>)
        {
            <span class="i">StringBuilder</span> <span id="r153 rd" class="r153 r">returnValue</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>string</b> <span id="r154 rd" class="r154 r">separatorToUse</span> = <a href="#4624a2b6f81a22d5" class="i method">GetSeparator</a>(<span class="r148 r">context</span>, <span class="r150 r">separator</span>);
            <b>foreach</b> (<b>object</b> <span id="r155 rd" class="r155 r">obj</span> <b>in</b> <span class="r149 r">enumerable</span>)
            {
                <b>if</b> (<span class="r155 r">obj</span> != <b>null</b>)
                {
                    <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r156 rd" class="r156 r">mshObj</span> = <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r155 r">obj</span>);
                    <span class="r153 r">returnValue</span>.<span class="i">Append</span>(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e7ab15d0863aa3d6" class="i method">ToString</a>(<span class="r148 r">context</span>, <span class="r156 r">mshObj</span>, <span class="r150 r">separator</span>, <span class="r151 r">format</span>, <span class="r152 r">formatProvider</span>, <b>false</b>, <b>false</b>));
                }
 
                <span class="r153 r">returnValue</span>.<span class="i">Append</span>(<span class="r154 r">separatorToUse</span>);
            }
 
            <b>if</b> (<span class="r153 r">returnValue</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>int</b> <span id="r157 rd" class="r157 r">separatorLength</span> = <span class="r154 r">separatorToUse</span>.<span class="i">Length</span>;
            <span class="r153 r">returnValue</span>.<span class="i">Remove</span>(<span class="r153 r">returnValue</span>.<span class="i">Length</span> - <span class="r157 r">separatorLength</span>, <span class="r157 r">separatorLength</span>);
            <b>return</b> <span class="r153 r">returnValue</span>.<span class="i">ToString</span>();
        }
 
        <b>private static string</b> <a id="ec24418bec9316ac" href="../R/ec24418bec9316ac.html" target="n" data-glyph="76,1" class="i method">ToStringEmptyBaseObject</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r158 rd" class="r158 r">context</span>, <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r159 rd" class="r159 r">mshObj</span>, <b>string</b> <span id="r160 rd" class="r160 r">separator</span>, <b>string</b> <span id="r161 rd" class="r161 r">format</span>, <span class="i">IFormatProvider</span> <span id="r162 rd" class="r162 r">formatProvider</span>)
        {
            <span class="i">StringBuilder</span> <span id="r163 rd" class="r163 r">returnValue</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="s">&quot;@{&quot;</span>);
            <b>bool</b> <span id="r164 rd" class="r164 r">isFirst</span> = <b>true</b>;
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r165 rd" class="r165 r">property</span> <b>in</b> <span class="r159 r">mshObj</span>.<a href="#59e9cd1ad57ccd34" class="i property">Properties</a>)
            {
                <b>if</b> (!<span class="r164 r">isFirst</span>)
                {
                    <span class="r163 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&quot;; &quot;</span>);
                }
 
                <span class="r164 r">isFirst</span> = <b>false</b>;
                <span class="r163 r">returnValue</span>.<span class="i">Append</span>(<span class="r165 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>);
                <span class="r163 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&#39;=&#39;</span>);
 
                <span class="c">// Don&#39;t evaluate script properties during a ToString() operation.</span>
                <b>var</b> <span id="r166 rd" class="r166 r">propertyValue</span> = <span class="r165 r">property</span> <b>is</b> <a href="MshMemberInfo.cs.html#b68884f0eb8d8ebb" class="t t">PSScriptProperty</a> ? <span class="r165 r">property</span>.<span class="i">GetType</span>().<span class="i">FullName</span> : <span class="r165 r">property</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>;
 
                <span class="r163 r">returnValue</span>.<span class="i">Append</span>(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">ToString</span>(<span class="r158 r">context</span>, <span class="r166 r">propertyValue</span>, <span class="r160 r">separator</span>, <span class="r161 r">format</span>, <span class="r162 r">formatProvider</span>, <b>false</b>, <b>false</b>));
            }
 
            <b>if</b> (<span class="r164 r">isFirst</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <span class="r163 r">returnValue</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
            <b>return</b> <span class="r163 r">returnValue</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of obj.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r167 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ExecutionContext used to fetch the separator.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r168 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> object we are trying to call ToString on. If this is not an PSObject we try</span>
        <span class="c">///</span><span class="c"> enumerating and if that fails we call obj.ToString.</span>
        <span class="c">///</span><span class="c"> If this is an PSObject, we look for a brokered ToString.</span>
        <span class="c">///</span><span class="c"> If it is not present, and the BaseObject is null we try listing the properties.</span>
        <span class="c">///</span><span class="c"> If the BaseObject is not null we try enumerating. If that fails we try the BaseObject&#39;s ToString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A string representation of the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When there is a brokered ToString but it failed, or when the ToString on obj throws an exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="e87c4fc15a3f59f5" href="../R/e87c4fc15a3f59f5.html" target="n" data-glyph="74,1" class="i method">ToStringParser</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r167 rd" class="r167 r">context</span>, <b>object</b> <span id="r168 rd" class="r168 r">obj</span>)
        {
            <b>return</b> <span class="i">ToStringParser</span>(<span class="r167 r">context</span>, <span class="r168 r">obj</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of obj.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ExecutionContext used to fetch the separator.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> object we are trying to call ToString on. If this is not an PSObject we try</span>
        <span class="c">///</span><span class="c"> enumerating and if that fails we call obj.ToString.</span>
        <span class="c">///</span><span class="c"> If this is an PSObject, we look for a brokered ToString.</span>
        <span class="c">///</span><span class="c"> If it is not present, and the BaseObject is null we try listing the properties.</span>
        <span class="c">///</span><span class="c"> If the BaseObject is not null we try enumerating. If that fails we try the BaseObject&#39;s ToString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The formatProvider to be passed to ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A string representation of the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When there is a brokered ToString but it failed, or when the ToString on obj throws an exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="1e8671244c1a552e" href="../R/1e8671244c1a552e.html" target="n" data-glyph="74,1" class="i method">ToStringParser</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r169 rd" class="r169 r">context</span>, <b>object</b> <span id="r170 rd" class="r170 r">obj</span>, <span class="i">IFormatProvider</span> <span id="r171 rd" class="r171 r">formatProvider</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#e7ab15d0863aa3d6" class="i method">ToString</a>(<span class="r169 r">context</span>, <span class="r170 r">obj</span>, <b>null</b>, <b>null</b>, <span class="r171 r">formatProvider</span>, <b>true</b>, <b>true</b>);
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r172 rd" class="r172 r">etse</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidCastException</span>(<span class="s">&quot;InvalidCastFromAnyTypeToString&quot;</span>, <span class="r172 r">etse</span>.<span class="i">InnerException</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">InvalidCastCannotRetrieveString</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from an PSObject instance ToString to provide a string representation for an object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r173 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ExecutionContext used to fetch the separator.</span>
        <span class="c">///</span><span class="c"> Typically either this or separator will be null.</span>
        <span class="c">///</span><span class="c"> If both are null, &quot; &quot; is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r174 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> object we are trying to call ToString on. If this is not an PSObject we try</span>
        <span class="c">///</span><span class="c"> enumerating and if that fails we call obj.ToString.</span>
        <span class="c">///</span><span class="c"> If this is an PSObject, we look for a brokered ToString.</span>
        <span class="c">///</span><span class="c"> If it is not present, and the BaseObject is null we try listing the properties.</span>
        <span class="c">///</span><span class="c"> If the BaseObject is not null we try enumerating. If that fails we try the BaseObject&#39;s ToString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r175 r">separator</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The separator between elements, if this is an enumeration.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r176 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format to be passed to ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r177 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The formatProvider to be passed to ToString.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r178 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">true if we should enumerate values or properties which would cause recursive</span>
        <span class="c">///</span><span class="c"> calls to this method. Such recursive calls will have recurse set to false, limiting the depth.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r179 r">unravelEnumeratorOnRecurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If recurse is false, this parameter is not considered. If it is true</span>
        <span class="c">///</span><span class="c"> this parameter will determine how enumerators are going to be treated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A string representation of the object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When there is a brokered ToString but it failed, or when the ToString on obj throws an exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="e7ab15d0863aa3d6" href="../R/e7ab15d0863aa3d6.html" target="n" data-glyph="74,1" class="i method">ToString</a>(<a href="ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r173 rd" class="r173 r">context</span>, <b>object</b> <span id="r174 rd" class="r174 r">obj</span>, <b>string</b> <span id="r175 rd" class="r175 r">separator</span>, <b>string</b> <span id="r176 rd" class="r176 r">format</span>, <span class="i">IFormatProvider</span> <span id="r177 rd" class="r177 r">formatProvider</span>, <b>bool</b> <span id="r178 rd" class="r178 r">recurse</span>, <b>bool</b> <span id="r179 rd" class="r179 r">unravelEnumeratorOnRecurse</span>)
        {
            <b>bool</b> <a id="ac82a44d72412c39" href="../R/ac82a44d72412c39.html" target="n" data-glyph="76,2" class="i method">TryFastTrackPrimitiveTypes</a>(<b>object</b> <span id="r180 rd" class="r180 r">value</span>, <b>out string</b> <span id="r181 rd" class="r181 r">str</span>)
            {
                <b>switch</b> (<span class="i">Convert</span>.<span class="i">GetTypeCode</span>(<span class="r180 r">value</span>))
                {
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">String</span>:
                        <span class="r181 r">str</span> = (<b>string</b>)<span class="r180 r">value</span>;
                        <b>break</b>;
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">Byte</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">SByte</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int16</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt16</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int32</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt32</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">Int64</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">UInt64</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">DateTime</span>:
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">Decimal</span>:
                        <b>var</b> <span id="r182 rd" class="r182 r">formattable</span> = (<span class="i">IFormattable</span>)<span class="r180 r">value</span>;
                        <span class="r181 r">str</span> = <span class="r182 r">formattable</span>.<span class="i">ToString</span>(<span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                        <b>break</b>;
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">Double</span>:
                        <b>var</b> <span id="r183 rd" class="r183 r">dbl</span> = (<b>double</b>)<span class="r180 r">value</span>;
                        <span class="r181 r">str</span> = <span class="r183 r">dbl</span>.<span class="i">ToString</span>(<span class="r176 r">format</span> ?? <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#e55dc96379386f6c" class="i field">DoublePrecision</a>, <span class="r177 r">formatProvider</span>);
                        <b>break</b>;
                    <b>case</b> <span class="i">TypeCode</span>.<span class="i">Single</span>:
                        <b>var</b> <span id="r184 rd" class="r184 r">sgl</span> = (<b>float</b>)<span class="r180 r">value</span>;
                        <span class="r181 r">str</span> = <span class="r184 r">sgl</span>.<span class="i">ToString</span>(<span class="r176 r">format</span> ?? <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#69af0728ca460fee" class="i field">SinglePrecision</a>, <span class="r177 r">formatProvider</span>);
                        <b>break</b>;
                    <b>default</b>:
                        <span class="r181 r">str</span> = <b>null</b>;
                        <b>return</b> <b>false</b>;
                }
 
                <b>return</b> <b>true</b>;
            }
 
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r185 rd" class="r185 r">mshObj</span> = <span class="r174 r">obj</span> <b>as</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>;
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> plain object
            <b>if</b> (<span class="r185 r">mshObj</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r174 r">obj</span> == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>if</b> (<a href="#ac82a44d72412c39" class="i method">TryFastTrackPrimitiveTypes</a>(<span class="r174 r">obj</span>, <b>out string</b> <span id="r186 rd" class="r186 r">objString</span>))
                {
                    <b>return</b> <span class="r186 r">objString</span>;
                }
 
                <span class="k preprocess">#</span><span class="k preprocess">region</span> recurse
                <b>if</b> (<span class="r178 r">recurse</span>)
                {
                    <span class="i">IEnumerable</span> <span id="r187 rd" class="r187 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r174 r">obj</span>);
                    <b>if</b> (<span class="r187 r">enumerable</span> != <b>null</b>)
                    {
                        <b>try</b>
                        {
                            <b>return</b> <a href="#1576938cd9601319" class="i method">ToStringEnumerable</a>(<span class="r173 r">context</span>, <span class="r187 r">enumerable</span>, <span class="r175 r">separator</span>, <span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                        }
                        <b>catch</b> (<span class="i">Exception</span>)
                        {
                            <span class="c">// We do want to ignore exceptions here to try the regular ToString below.</span>
                        }
                    }
 
                    <b>if</b> (<span class="r179 r">unravelEnumeratorOnRecurse</span>)
                    {
                        <span class="i">IEnumerator</span> <span id="r188 rd" class="r188 r">enumerator</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r174 r">obj</span>);
                        <b>if</b> (<span class="r188 r">enumerator</span> != <b>null</b>)
                        {
                            <b>try</b>
                            {
                                <b>return</b> <a href="#8b4e7a6d0dda77da" class="i method">ToStringEnumerator</a>(<span class="r173 r">context</span>, <span class="r188 r">enumerator</span>, <span class="r175 r">separator</span>, <span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                            }
                            <b>catch</b> (<span class="i">Exception</span>)
                            {
                                <span class="c">// We do want to ignore exceptions here to try the regular ToString below.</span>
                            }
                        }
                    }
                }
                <span class="k preprocess">#</span><span class="k preprocess">endregion</span> recurse
 
                <span class="k preprocess">#</span><span class="k preprocess">region</span> object ToString
 
                <span class="i">IFormattable</span> <span id="r189 rd" class="r189 r">objFormattable</span> = <span class="r174 r">obj</span> <b>as</b> <span class="i">IFormattable</span>;
                <b>try</b>
                {
                    <b>if</b> (<span class="r189 r">objFormattable</span> == <b>null</b>)
                    {
                        <span class="i">Type</span> <span id="r190 rd" class="r190 r">type</span> = <span class="r174 r">obj</span> <b>as</b> <span class="i">Type</span>;
                        <b>if</b> (<span class="r190 r">type</span> != <b>null</b>)
                        {
                            <b>return</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<a href="../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="#edc1ecfda5d75ea9" class="i method">Type</a>(<span class="r190 r">type</span>);
                        }
 
                        <b>return</b> <span class="r174 r">obj</span>.<span class="i">ToString</span>();
                    }
 
                    <b>return</b> <span class="r189 r">objFormattable</span>.<span class="i">ToString</span>(<span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r191 rd" class="r191 r">e</span>)
                {
                    <b>throw</b> <b>new</b> <span class="t">ExtendedTypeSystemException</span>(<span class="s">&quot;ToStringObjectBasicException&quot;</span>, <span class="r191 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">ToStringException</span>, <span class="r191 r">e</span>.<span class="i">Message</span>);
                }
                <span class="k preprocess">#</span><span class="k preprocess">endregion</span> object ToString
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> plain object
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> PSObject
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> brokered ToString
            <span class="c">// A brokered ToString has precedence over any other attempts.</span>
            <span class="c">// If it fails we let the exception go because the caller must be notified.</span>
            <a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a> <span id="r192 rd" class="r192 r">method</span> = <b>null</b>;
            <b>if</b> (<a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#364e445adfd28491" class="i method">HasInstanceMembers</a>(<span class="r185 r">mshObj</span>, <b>out</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r193 rd" class="r193 r">instanceMembers</span>))
            {
                <span class="r192 r">method</span> = <span class="r193 r">instanceMembers</span><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><span class="s">&quot;ToString&quot;</span>] <b>as</b> <a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>;
            }
 
            <b>if</b> (<span class="r192 r">method</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r185 r">mshObj</span>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>.<span class="i">Count</span> != 0)
                {
                    <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r194 rd" class="r194 r">table</span> = <span class="r185 r">mshObj</span>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
                    <b>if</b> (<span class="r194 r">table</span> != <b>null</b>)
                    {
                        <span class="r192 r">method</span> = <span class="r194 r">table</span>.<a href="TypeTable.cs.html#360ddf05c317b5ab" class="i method">GetMembers</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;(<span class="r185 r">mshObj</span>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>)[<span class="s">&quot;ToString&quot;</span>];
                        <b>if</b> (<span class="r192 r">method</span> != <b>null</b>)
                        {
                            <span class="r192 r">method</span> = (<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>)<span class="r192 r">method</span>.<a href="MshMemberInfo.cs.html#6a5051f6dba6b0e5" class="i method">Copy</a>();
                            <span class="r192 r">method</span>.<a href="MshMemberInfo.cs.html#014ea40b35222be9" class="i field">instance</a> = <span class="r185 r">mshObj</span>;
                        }
                    }
                }
            }
 
            <b>if</b> (<span class="r192 r">method</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="c">// Even if a format specifier has been provided, if there is only one overload</span>
                    <span class="c">// then it can&#39;t take a format specified...</span>
                    <b>object</b> <span id="r195 rd" class="r195 r">retObj</span>;
                    <b>if</b> (<span class="r177 r">formatProvider</span> != <b>null</b> &amp;&amp; <span class="r192 r">method</span>.<a href="MshMemberInfo.cs.html#faaa4aefb28a1156" class="i property">OverloadDefinitions</a>.<span class="i">Count</span> &gt; 1)
                    {
                        <span class="r195 r">retObj</span> = <span class="r192 r">method</span>.<span class="i">Invoke</span>(<span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                        <b>return</b> <span class="r195 r">retObj</span> != <b>null</b> ? <span class="r195 r">retObj</span>.<span class="i">ToString</span>() : <b>string</b>.<span class="i">Empty</span>;
                    }
 
                    <span class="r195 r">retObj</span> = <span class="r192 r">method</span>.<a href="MshMemberInfo.cs.html#f4f9695891d65945" class="i method">Invoke</a>();
                    <b>return</b> <span class="r195 r">retObj</span> != <b>null</b> ? <span class="r195 r">retObj</span>.<span class="i">ToString</span>() : <b>string</b>.<span class="i">Empty</span>;
                }
                <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a> <span id="r196 rd" class="r196 r">e</span>)
                {
                    <b>throw</b> <b>new</b> <span class="t">ExtendedTypeSystemException</span>(<span class="s">&quot;MethodExceptionNullFormatProvider&quot;</span>, <span class="r196 r">e</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">ToStringException</span>, <span class="r196 r">e</span>.<span class="i">Message</span>);
                }
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> brokered ToString
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> recurse
            <span class="c">// Since we don&#39;t have a brokered ToString, we check for the need to enumerate the object or its properties</span>
            <b>if</b> (<span class="r178 r">recurse</span>)
            {
                <b>if</b> (<span class="r185 r">mshObj</span>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>)
                {
                    <b>try</b>
                    {
                        <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#ec24418bec9316ac" class="i method">ToStringEmptyBaseObject</a>(<span class="r173 r">context</span>, <span class="r185 r">mshObj</span>, <span class="r175 r">separator</span>, <span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                        <span class="c">// We do want to ignore exceptions here to try the regular ToString below.</span>
                    }
                }
 
                <span class="i">IEnumerable</span> <span id="r197 rd" class="r197 r">enumerable</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r185 r">mshObj</span>);
                <b>if</b> (<span class="r197 r">enumerable</span> != <b>null</b>)
                {
                    <b>try</b>
                    {
                        <b>return</b> <a href="#1576938cd9601319" class="i method">ToStringEnumerable</a>(<span class="r173 r">context</span>, <span class="r197 r">enumerable</span>, <span class="r175 r">separator</span>, <span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                        <span class="c">// We do want to ignore exceptions here to try the regular ToString below.</span>
                    }
                }
 
                <b>if</b> (<span class="r179 r">unravelEnumeratorOnRecurse</span>)
                {
                    <span class="i">IEnumerator</span> <span id="r198 rd" class="r198 r">enumerator</span> = <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#837b38179d9ca088" class="i method">GetEnumerator</a>(<span class="r185 r">mshObj</span>);
                    <b>if</b> (<span class="r198 r">enumerator</span> != <b>null</b>)
                    {
                        <b>try</b>
                        {
                            <b>return</b> <a href="#8b4e7a6d0dda77da" class="i method">ToStringEnumerator</a>(<span class="r173 r">context</span>, <span class="r198 r">enumerator</span>, <span class="r175 r">separator</span>, <span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
                        }
                        <b>catch</b> (<span class="i">Exception</span>)
                        {
                            <span class="c">// We do want to ignore exceptions here to try the regular ToString below.</span>
                        }
                    }
                }
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> recurse
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> mshObject&#39;s BaseObject ToString
 
            <span class="c">// If we&#39;ve cached a string representation for this object, use that. This</span>
            <span class="c">// is used to preserve the original string for numeric literals.</span>
            <b>if</b> (<span class="r185 r">mshObj</span>.<a href="#d80386ffa3949a2a" class="i property">TokenText</a> != <b>null</b>)
            {
                <b>return</b> <span class="r185 r">mshObj</span>.<a href="#d80386ffa3949a2a" class="i property">TokenText</a>;
            }
 
            <span class="c">// Since we don&#39;t have a brokered ToString and the enumerations were not necessary or failed</span>
            <span class="c">// we try the BaseObject&#39;s ToString</span>
            <b>object</b> <span id="r199 rd" class="r199 r">baseObject</span> = <span class="r185 r">mshObj</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>;
 
            <b>if</b> (<a href="#ac82a44d72412c39" class="i method">TryFastTrackPrimitiveTypes</a>(<span class="r199 r">baseObject</span>, <b>out string</b> <span id="r200 rd" class="r200 r">baseObjString</span>))
            {
                <b>return</b> <span class="r200 r">baseObjString</span>;
            }
 
            <span class="i">IFormattable</span> <span id="r201 rd" class="r201 r">msjObjFormattable</span> = <span class="r199 r">baseObject</span> <b>as</b> <span class="i">IFormattable</span>;
            <b>try</b>
            {
                <b>var</b> <span id="r202 rd" class="r202 r">result</span> = <span class="r201 r">msjObjFormattable</span> == <b>null</b> ? <span class="r199 r">baseObject</span>.<span class="i">ToString</span>() : <span class="r201 r">msjObjFormattable</span>.<span class="i">ToString</span>(<span class="r176 r">format</span>, <span class="r177 r">formatProvider</span>);
 
                <b>return</b> <span class="r202 r">result</span> ?? <b>string</b>.<span class="i">Empty</span>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r203 rd" class="r203 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">ExtendedTypeSystemException</span>(<span class="s">&quot;ToStringPSObjectBasicException&quot;</span>, <span class="r203 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ToStringException</span>, <span class="r203 r">e</span>.<span class="i">Message</span>);
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> mshObject&#39;s BaseObject ToString
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSObject
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation for this object. A ToString</span>
        <span class="c">///</span><span class="c"> CodeMethod or ScriptMethod will be used, if available. Enumerations items are</span>
        <span class="c">///</span><span class="c"> concatenated using $ofs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation for baseObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If an exception was thrown by the BaseObject&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="298666357e641f03" href="../R/298666357e641f03.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <span class="c">// If ToString value from deserialization is available,</span>
            <span class="c">// simply return it.</span>
            <b>if</b> (<a href="#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a> != <b>null</b>)
            {
                <b>return</b> <a href="#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a>;
            }
 
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e7ab15d0863aa3d6" class="i method">ToString</a>(<b>null</b>, <a href="#a3c2513aa3da07fa" class="k">this</a>, <b>null</b>, <b>null</b>, <b>null</b>, <b>true</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation for this object. A ToString</span>
        <span class="c">///</span><span class="c"> CodeMethod or ScriptMethod will be used, if available. Enumerations items are</span>
        <span class="c">///</span><span class="c"> concatenated using $ofs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r204 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Repassed to baseObject&#39;s IFormattable if present.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r205 r">formatProvider</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Repassed to baseObject&#39;s IFormattable if present.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation for baseObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If an exception was thrown by the BaseObject&#39;s ToString.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public string</b> <a id="833d606fcbc0c908" href="../R/833d606fcbc0c908.html" target="n" data-glyph="72,1" class="i method">ToString</a>(<b>string</b> <span id="r204 rd" class="r204 r">format</span>, <span class="i">IFormatProvider</span> <span id="r205 rd" class="r205 r">formatProvider</span>)
        {
            <span class="c">// If ToString value from deserialization is available,</span>
            <span class="c">// simply return it.</span>
            <b>if</b> (<a href="#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a> != <b>null</b>)
            {
                <b>return</b> <a href="#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a>;
            }
 
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e7ab15d0863aa3d6" class="i method">ToString</a>(<b>null</b>, <a href="#a3c2513aa3da07fa" class="k">this</a>, <b>null</b>, <span class="r204 r">format</span>, <span class="r205 r">formatProvider</span>, <b>true</b>, <b>false</b>);
        }
 
        <b>private string</b> <a id="6d9077e381211131" href="../R/6d9077e381211131.html" target="n" data-glyph="76,1" class="i method">PrivateToString</a>()
        {
            <b>string</b> <span id="r206 rd" class="r206 r">result</span>;
            <b>try</b>
            {
                <span class="r206 r">result</span> = <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#298666357e641f03" class="i method">ToString</a>();
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a>)
            {
                <span class="r206 r">result</span> = <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>().<span class="i">FullName</span>;
            }
 
            <b>return</b> <span class="r206 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ToString
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Clone
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a copy of this PSObject. This will copy the BaseObject if</span>
        <span class="c">///</span><span class="c"> it is a value type, and use BaseObject.Clone() for the new PSObject,</span>
        <span class="c">///</span><span class="c"> if the BaseObject is ICloneable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A copy of this object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="31124c1d85456adb" href="../R/31124c1d85456adb.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r207 rd" class="r207 r">returnValue</span> = (<a href="#a3c2513aa3da07fa" class="t t">PSObject</a>)<a href="#a3c2513aa3da07fa" class="k">this</a>.<span class="i">MemberwiseClone</span>();
 
            <b>if</b> (<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>)
            {
                <span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> = <a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>.<a href="#f440822ac3f6fd5d" class="i field">SelfInstance</a>;
                <span class="r207 r">returnValue</span>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a> = <b>true</b>;
            }
            <b>else</b>
            {
                <span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> = <a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>;
                <span class="r207 r">returnValue</span>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a> = <b>false</b>;
            }
 
            <span class="c">// Instance members will be recovered as necessary through the resurrection table.</span>
            <span class="r207 r">returnValue</span>.<a href="#8fbc79e4c54109eb" class="i field">_instanceMembers</a> = <b>null</b>;
            <span class="c">// The typename is not resurrected.  A common reason to copy a PSObject is to change the TypeName,</span>
            <span class="c">// especially on a PSCustomObject - e.g. to a help object where we want to force a different view.</span>
            <span class="r207 r">returnValue</span>.<a href="#37278d46e00b78ec" class="i field">_typeNames</a> = <b>null</b>;
 
            <span class="r207 r">returnValue</span>.<a href="#f218e3471ddd47aa" class="i field">_members</a> = <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r207 r">returnValue</span>, <a href="#d2986432b06515f6" class="i field">s_memberCollection</a>);
            <span class="r207 r">returnValue</span>.<a href="#e556fdf033bc2eca" class="i field">_properties</a> = <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(<span class="r207 r">returnValue</span>, <a href="#21080d8bcdb088a2" class="i field">s_propertyCollection</a>);
            <span class="r207 r">returnValue</span>.<a href="#b40abab072d122e1" class="i field">_methods</a> = <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>&gt;(<span class="r207 r">returnValue</span>, <a href="#fdd7a9b4fa7540d7" class="i field">s_methodCollection</a>);
 
            <span class="r207 r">returnValue</span>.<a href="#99b88dfe2d0d8a63" class="i field">_adapterSet</a> = <a href="#c3772e5257a3f0e8" class="i method">GetMappedAdapter</a>(<span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>, <span class="r207 r">returnValue</span>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>());
 
            <b>if</b> (<span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> <b>is</b> <span class="i">ICloneable</span> <span id="r208 rd" class="r208 r">cloneableBase</span>)
            {
                <span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> = <span class="r208 r">cloneableBase</span>.<span class="i">Clone</span>();
            }
 
            <b>if</b> (<span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> <b>is</b> <span class="i">ValueType</span>)
            {
                <span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> = <a href="#70db3b2bca3cbc4d" class="i method">CopyValueType</a>(<span class="r207 r">returnValue</span>.<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>);
            }
 
            <span class="c">// needToReAddInstanceMembersAndTypeNames = returnValue will have a different key (different from &quot;this&quot;) returned from GetKeyForResurrectionTables</span>
            <b>bool</b> <span id="r209 rd" class="r209 r">needToReAddInstanceMembersAndTypeNames</span> = !<b>object</b>.<span class="i">ReferenceEquals</span>(<a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>), <a href="#0fd6e301844c990e" class="i method">GetKeyForResurrectionTables</a>(<span class="r207 r">returnValue</span>));
            <b>if</b> (<span class="r209 r">needToReAddInstanceMembersAndTypeNames</span>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<span class="r207 r">returnValue</span>.<a href="#e518df2aeb312ac9" class="i property">InstanceMembers</a>.<span class="i">Any</span>(), <span class="s">&quot;needToReAddInstanceMembersAndTypeNames should mean that the new object has a fresh/empty list of instance members&quot;</span>);
                <b>foreach</b> (<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r210 rd" class="r210 r">member</span> <b>in</b> <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#e518df2aeb312ac9" class="i property">InstanceMembers</a>)
                {
                    <b>if</b> (<span class="r210 r">member</span>.<a href="MshMemberInfo.cs.html#ddc58fcb9ef869dd" class="i property">IsHidden</a>)
                    {
                        <b>continue</b>;
                    }
                    <span class="c">// Add will clone the member</span>
                    <span class="r207 r">returnValue</span>.<a href="#56bc82b240e4291b" class="i property">Members</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r210 r">member</span>);
                }
 
                <span class="r207 r">returnValue</span>.<a href="#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
                <b>foreach</b> (<b>string</b> <span id="r211 rd" class="r211 r">typeName</span> <b>in</b> <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>)
                {
                    <span class="r207 r">returnValue</span>.<a href="#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="r211 r">typeName</span>);
                }
            }
 
            <span class="r207 r">returnValue</span>.<a href="#e3bac6ee3e22d6dc" class="i property">WriteStream</a> = <a href="#e3bac6ee3e22d6dc" class="i property">WriteStream</a>;
            <span class="r207 r">returnValue</span>.<a href="#9b240ff559436969" class="i property">HasGeneratedReservedMembers</a> = <b>false</b>;
 
            <b>return</b> <span class="r207 r">returnValue</span>;
        }
 
        <b>internal static object</b> <a id="70db3b2bca3cbc4d" href="../R/70db3b2bca3cbc4d.html" target="n" data-glyph="74,1" class="i method">CopyValueType</a>(<b>object</b> <span id="r212 rd" class="r212 r">obj</span>)
        {
            <span class="c">// this will force boxing and unboxing in a new object that will cause</span>
            <span class="c">// the copy of the value type</span>
            <b>var</b> <span id="r213 rd" class="r213 r">newBaseArray</span> = <span class="i">Array</span>.<span class="i">CreateInstance</span>(<span class="r212 r">obj</span>.<span class="i">GetType</span>(), 1);
            <span class="r213 r">newBaseArray</span>.<span class="i">SetValue</span>(<span class="r212 r">obj</span>, 0);
            <b>return</b> <span class="r213 r">newBaseArray</span>.<span class="i">GetValue</span>(0);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Clone
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IComparable
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compares the current instance with another object of the same type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r214 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">An object to compare with this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A 32-bit signed integer that indicates the relative order of the comparands.</span>
        <span class="c">///</span><span class="c"> The return value has these meanings:</span>
        <span class="c">///</span><span class="c">     Value             Meaning</span>
        <span class="c">///</span><span class="c">     Less than zero    This instance is less than obj.</span>
        <span class="c">///</span><span class="c">     Zero              This instance is equal to obj.</span>
        <span class="c">///</span><span class="c">     Greater than zero This instance is greater than obj.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ExtendedTypeSystemException.cs.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r214 r">obj</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> has a different type</span>
        <span class="c">///</span><span class="c"> than this instance&#39;s BaseObject or if the BaseObject does not implement IComparable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public int</b> <a id="42d38c3a21260aab" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CompareTo</a>(<b>object</b> <span id="r214 rd" class="r214 r">obj</span>)
        {
            <span class="c">// This ReferenceEquals is not just an optimization.</span>
            <span class="c">// It is necessary so that mshObject.Equals(mshObject) returns 0.</span>
            <span class="c">// Please see the comments inside the Equals implementation.</span>
            <b>if</b> (<b>object</b>.<span class="i">ReferenceEquals</span>(<a href="#a3c2513aa3da07fa" class="k">this</a>, <span class="r214 r">obj</span>))
            {
                <b>return</b> 0;
            }
 
            <b>try</b>
            {
                <span class="c">// PSObject.Base instead of BaseObject could cause an infinite</span>
                <span class="c">// loop with LP.Compare calling this Compare.</span>
                <b>return</b> <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#2bb5d0a887cf373d" class="i method">Compare</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d854d13536b70a12" class="i property">BaseObject</a>, <span class="r214 r">obj</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r215 rd" class="r215 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">ExtendedTypeSystemException</span>(<span class="s">&quot;PSObjectCompareTo&quot;</span>, <span class="r215 r">e</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">NotTheSameTypeOrNotIcomparable</span>, <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#6d9077e381211131" class="i method">PrivateToString</a>(), <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r214 r">obj</span>).<a href="#298666357e641f03" class="i method">ToString</a>(), <span class="s">&quot;IComparable&quot;</span>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IComparable
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Equals and GetHashCode
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether the specified Object is equal to the current Object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r216 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Object to compare with the current Object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the specified Object is equal to the current Object; otherwise, false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="ef2623ee5d754583" href="../R/ef2623ee5d754583.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r216 rd" class="r216 r">obj</span>)
        {
            <span class="c">// There is a slight difference between BaseObject and PSObject.Base.</span>
            <span class="c">// PSObject.Base returns the containing PSObject that wraps an MshCustomBaseObject.</span>
            <span class="c">// BaseObject returns the MshCustomBaseObject.</span>
            <span class="c">// Because we have to call BaseObject here, and LP.Compare uses PSObject.Base</span>
            <span class="c">// we need the reference equals below so that mshObject.Equals(mshObject) returns true.</span>
            <b>if</b> (<b>object</b>.<span class="i">ReferenceEquals</span>(<a href="#a3c2513aa3da07fa" class="k">this</a>, <span class="r216 r">obj</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// The above check validates if we are comparing with the same object references</span>
            <span class="c">// This check &quot;shortcuts&quot; the comparison if the first object is a CustomObject</span>
            <span class="c">// since 2 custom objects are not equal.</span>
            <b>if</b> (<b>object</b>.<span class="i">ReferenceEquals</span>(<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d854d13536b70a12" class="i property">BaseObject</a>, <a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>.<a href="#f440822ac3f6fd5d" class="i field">SelfInstance</a>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// PSObject.Base instead of BaseObject could cause an infinite</span>
            <span class="c">// loop with LP.Equals calling this Equals.</span>
            <b>return</b> <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#c17cb1e7f80c49b3" class="i method">Equals</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d854d13536b70a12" class="i property">BaseObject</a>, <span class="r216 r">obj</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serves as a hash function for a particular type, suitable for use in hashing algorithms and data structures like a hash table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A hash code for the current Object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override int</b> <a id="e15ae2404d74cb84" href="../R/e15ae2404d74cb84.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>return</b> <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetHashCode</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Equals and GetHashCode
 
        <b>internal void</b> <a id="3391974db863bbc1" href="../R/3391974db863bbc1.html" target="n" data-glyph="74,1" class="i method">AddOrSetProperty</a>(<b>string</b> <span id="r217 rd" class="r217 r">memberName</span>, <b>object</b> <span id="r218 rd" class="r218 r">value</span>)
        {
            <b>if</b> (<a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#c481ec977bf84cbc" class="i method">TryGetInstanceMember</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>, <span class="r217 r">memberName</span>, <b>out</b> <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r219 rd" class="r219 r">memberInfo</span>) &amp;&amp; <span class="r219 r">memberInfo</span> <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>)
            {
                <span class="r219 r">memberInfo</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> = <span class="r218 r">value</span>;
            }
            <b>else</b>
            {
                <a href="#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<span class="r217 r">memberName</span>, <span class="r218 r">value</span>));
            }
        }
 
        <b>internal void</b> <a id="3abed2428d3a5681" href="../R/3abed2428d3a5681.html" target="n" data-glyph="74,1" class="i method">AddOrSetProperty</a>(<a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r220 rd" class="r220 r">property</span>)
        {
            <b>if</b> (<a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="runtime/Binding/Binders.cs.html#c481ec977bf84cbc" class="i method">TryGetInstanceMember</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>, <span class="r220 r">property</span>.<a href="MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>, <b>out</b> <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r221 rd" class="r221 r">memberInfo</span>) &amp;&amp; <span class="r221 r">memberInfo</span> <b>is</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>)
            {
                <span class="r221 r">memberInfo</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> = <span class="r220 r">property</span>.<a href="MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>;
            }
            <b>else</b>
            {
                <a href="#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<span class="r220 r">property</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> instance methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> public const strings
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the member set for adapted members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This needs to be Lower cased as it saves some comparison time elsewhere.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="a761de3805c623a2" href="../R/a761de3805c623a2.html" target="n" data-glyph="6,1" class="i field">AdaptedMemberSetName</a> = <span class="s">&quot;psadapted&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the member set for extended members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This needs to be Lower cased as it saves some comparison time elsewhere.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="82db25e2060c4487" href="../R/82db25e2060c4487.html" target="n" data-glyph="6,1" class="i field">ExtendedMemberSetName</a> = <span class="s">&quot;psextended&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the member set for the BaseObject&#39;s members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This needs to be Lower cased as it saves some comparison time elsewhere.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="296e77f364f31de8" href="../R/296e77f364f31de8.html" target="n" data-glyph="6,1" class="i field">BaseObjectMemberSetName</a> = <span class="s">&quot;psbase&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSObject&#39;s properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This needs to be Lower cased as it saves some comparison time elsewhere.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="770510aed20ef9a0" href="../R/770510aed20ef9a0.html" target="n" data-glyph="8,1" class="i field">PSObjectMemberSetName</a> = <span class="s">&quot;psobject&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A shortcut to .PSObject.TypeNames.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This needs to be Lower cased as it saves some comparison time elsewhere.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="5c67cf178a08cfde" href="../R/5c67cf178a08cfde.html" target="n" data-glyph="8,1" class="i field">PSTypeNames</a> = <span class="s">&quot;pstypenames&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> public const strings
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> serialization
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements the ISerializable contract for serializing a PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r222 r">info</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Serialization information for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r223 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The streaming context for this instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="c365b93cc458b2fe" href="../R/c365b93cc458b2fe.html" target="n" data-glyph="72,1" class="i method">GetObjectData</a>(<span class="i">SerializationInfo</span> <span id="r222 rd" class="r222 r">info</span>, <span class="i">StreamingContext</span> <span id="r223 rd" class="r223 r">context</span>)
        {
            <b>if</b> (<span class="r222 r">info</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r222 r">info</span>));
            }
 
            <span class="c">// We create a wrapper PSObject, so that we can successfully deserialize it</span>
            <b>string</b> <span id="r224 rd" class="r224 r">serializedContent</span>;
            <b>if</b> (<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>)
            {
                <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r225 rd" class="r225 r">serializeTarget</span> = <b>new</b> <a href="#3ee1d75e736c4afc" class="t constructor">PSObject</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>);
                <span class="r224 r">serializedContent</span> = <a href="serialization.cs.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<a href="serialization.cs.html#a542e9acc69529dc" class="i method">Serialize</a>(<span class="r225 r">serializeTarget</span>);
            }
            <b>else</b>
            {
                <span class="r224 r">serializedContent</span> = <a href="serialization.cs.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<a href="serialization.cs.html#a542e9acc69529dc" class="i method">Serialize</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>);
            }
 
            <span class="r222 r">info</span>.<span class="i">AddValue</span>(<span class="s">&quot;CliXml&quot;</span>, <span class="r224 r">serializedContent</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">settings</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">noteName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">defaultValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">expectedType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r230 r">shouldReplicateInstance</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true to make this PSObject as the owner of the memberset.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r231 r">ownerObject</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSObject to be used while replicating the owner for PSMemberSet</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static object</b> <a id="f31b3ea3040dd4a3" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetNoteSettingValue</a>(<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <span id="r226 rd" class="r226 r">settings</span>, <b>string</b> <span id="r227 rd" class="r227 r">noteName</span>,
            <b>object</b> <span id="r228 rd" class="r228 r">defaultValue</span>, <span class="i">Type</span> <span id="r229 rd" class="r229 r">expectedType</span>,
            <b>bool</b> <span id="r230 rd" class="r230 r">shouldReplicateInstance</span>, <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r231 rd" class="r231 r">ownerObject</span>)
        {
            <b>if</b> (<span class="r226 r">settings</span> == <b>null</b>)
            {
                <b>return</b> <span class="r228 r">defaultValue</span>;
            }
 
            <b>if</b> (<span class="r230 r">shouldReplicateInstance</span>)
            {
                <span class="r226 r">settings</span>.<a href="MshMemberInfo.cs.html#6ced9c7de29c5f24" class="i method">ReplicateInstance</a>(<span class="r231 r">ownerObject</span>);
            }
 
            <b>if</b> (!(<span class="r226 r">settings</span>.<a href="MshMemberInfo.cs.html#23ba75fd4c58af6c" class="i property">Members</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r227 r">noteName</span>] <b>is</b> <a href="MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r232 rd" class="r232 r">note</span>))
            {
                <b>return</b> <span class="r228 r">defaultValue</span>;
            }
 
            <b>object</b> <span id="r233 rd" class="r233 r">noteValue</span> = <span class="r232 r">note</span>.<a href="MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>;
            <b>if</b> (<span class="r233 r">noteValue</span> == <b>null</b> || <span class="r233 r">noteValue</span>.<span class="i">GetType</span>() != <span class="r229 r">expectedType</span>)
            {
                <b>return</b> <span class="r228 r">defaultValue</span>;
            }
 
            <b>return</b> <span class="r232 r">note</span>.<a href="MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>;
        }
 
        <b>internal int</b> <a id="59e74d8cba5df10d" href="../R/59e74d8cba5df10d.html" target="n" data-glyph="74,1" class="i method">GetSerializationDepth</a>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r234 rd" class="r234 r">backupTypeTable</span>)
        {
            <b>int</b> <span id="r235 rd" class="r235 r">result</span> = 0;
 
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r236 rd" class="r236 r">typeTable</span> = <span class="r234 r">backupTypeTable</span> ?? <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
            <b>if</b> (<span class="r236 r">typeTable</span> != <b>null</b>)
            {
                <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <span id="r237 rd" class="r237 r">standardMemberSet</span> = <a href="#3f348d45915ab4cb" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>&gt;(<a href="#a3c2513aa3da07fa" class="k">this</a>,
                    <span class="r236 r">typeTable</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#ddc869cbe4f3534d" class="i field">PSStandardMembers</a>);
                <span class="r235 r">result</span> = (<b>int</b>)<span class="i">GetNoteSettingValue</span>(<span class="r237 r">standardMemberSet</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#63372acd82f78d2c" class="i field">SerializationDepth</a>, 0, <b>typeof</b>(<b>int</b>), <b>true</b>, <a href="#a3c2513aa3da07fa" class="k">this</a>);
            }
 
            <b>return</b> <span class="r235 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r238 r">backupTypeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TypeTable to use if this PSObject.GetTypeTable() returns null. This will happen</span>
        <span class="c">///</span><span class="c"> in the remoting scenario on the client/server side (where a LocalRunspace may not be</span>
        <span class="c">///</span><span class="c"> present).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <a id="107cc54a7e00165a" href="../R/107cc54a7e00165a.html" target="n" data-glyph="74,1" class="i method">GetStringSerializationSource</a>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r238 rd" class="r238 r">backupTypeTable</span>)
        {
            <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r239 rd" class="r239 r">result</span> = <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#c5c083ccdccc09a2" class="i method">GetPSStandardMember</a>(<span class="r238 r">backupTypeTable</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#aa4df10e8fb3c306" class="i field">StringSerializationSource</a>);
            <b>return</b> <span class="r239 r">result</span> <b>as</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r240 r">backupTypeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TypeTable to use if this PSObject.GetTypeTable() returns null. This will happen</span>
        <span class="c">///</span><span class="c"> in the remoting scenario on the client/server side (where a LocalRunspace may not be</span>
        <span class="c">///</span><span class="c"> present).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#9a814b5a84518967" class="t t">SerializationMethod</a> <a id="08cdba316b979499" href="../R/08cdba316b979499.html" target="n" data-glyph="74,1" class="i method">GetSerializationMethod</a>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r240 rd" class="r240 r">backupTypeTable</span>)
        {
            <a href="#9a814b5a84518967" class="t t">SerializationMethod</a> <span id="r241 rd" class="r241 r">result</span> = <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#0d39b32da8b45f00" class="i field">DefaultSerializationMethod</a>;
 
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r242 rd" class="r242 r">typeTable</span> = <span class="r240 r">backupTypeTable</span> ?? <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
            <b>if</b> (<span class="r242 r">typeTable</span> != <b>null</b>)
            {
                <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <span id="r243 rd" class="r243 r">standardMemberSet</span> = <a href="#3f348d45915ab4cb" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>&gt;(<a href="#a3c2513aa3da07fa" class="k">this</a>,
                    <span class="r242 r">typeTable</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#ddc869cbe4f3534d" class="i field">PSStandardMembers</a>);
                <span class="r241 r">result</span> = (<a href="#9a814b5a84518967" class="t t">SerializationMethod</a>)<span class="i">GetNoteSettingValue</span>(<span class="r243 r">standardMemberSet</span>,
                        <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#f7bed106e5b7a48f" class="i field">SerializationMethodNode</a>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#0d39b32da8b45f00" class="i field">DefaultSerializationMethod</a>, <b>typeof</b>(<a href="#9a814b5a84518967" class="t t">SerializationMethod</a>), <b>true</b>, <a href="#a3c2513aa3da07fa" class="k">this</a>);
            }
 
            <b>return</b> <span class="r241 r">result</span>;
        }
 
        <b>internal</b> <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <a id="7f00a096ce2593cb" href="../R/7f00a096ce2593cb.html" target="n" data-glyph="104,1" class="i property">PSStandardMembers</a>
        {
            <b>get</b>
            {
                <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="k">var</a> <span id="r244 rd" class="r244 r">retVal</span> = <a href="#ac786b8910f1969e" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>&gt;(<a href="#a3c2513aa3da07fa" class="k">this</a>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#ddc869cbe4f3534d" class="i field">PSStandardMembers</a>);
                <b>if</b> (<span class="r244 r">retVal</span> != <b>null</b>)
                {
                    <span class="r244 r">retVal</span> = (<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>)<span class="r244 r">retVal</span>.<a href="MshMemberInfo.cs.html#b0d160ee7441fc7c" class="i method">Copy</a>();
                    <span class="r244 r">retVal</span>.<a href="MshMemberInfo.cs.html#6ced9c7de29c5f24" class="i method">ReplicateInstance</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>);
                    <b>return</b> <span class="r244 r">retVal</span>;
                }
 
                <span class="r244 r">retVal</span> = <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#ddc869cbe4f3534d" class="i field">PSStandardMembers</a>] <b>as</b> <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>;
                <b>return</b> <span class="r244 r">retVal</span>;
            }
        }
 
        <b>internal</b> <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="c5c083ccdccc09a2" href="../R/c5c083ccdccc09a2.html" target="n" data-glyph="74,1" class="i method">GetPSStandardMember</a>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r245 rd" class="r245 r">backupTypeTable</span>, <b>string</b> <span id="r246 rd" class="r246 r">memberName</span>)
        {
            <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r247 rd" class="r247 r">result</span> = <b>null</b>;
 
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r248 rd" class="r248 r">typeTable</span> = <span class="r245 r">backupTypeTable</span> ?? <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
            <b>if</b> (<span class="r248 r">typeTable</span> != <b>null</b>)
            {
                <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <span id="r249 rd" class="r249 r">standardMemberSet</span> = <a href="#3f348d45915ab4cb" class="i method">TypeTableGetMemberDelegate</a>&lt;<a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>&gt;(
                    <a href="#a3c2513aa3da07fa" class="k">this</a>, <span class="r248 r">typeTable</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#ddc869cbe4f3534d" class="i field">PSStandardMembers</a>);
                <b>if</b> (<span class="r249 r">standardMemberSet</span> != <b>null</b>)
                {
                    <span class="r249 r">standardMemberSet</span>.<a href="MshMemberInfo.cs.html#6ced9c7de29c5f24" class="i method">ReplicateInstance</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>);
                    <a href="MshMemberInfo.cs.html#520db5b1e8966ea1" class="t t">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r250 rd" class="r250 r">members</span> =
                        <b>new</b> <a href="MshMemberInfo.cs.html#5bfe6a98dac86bcd" class="t constructor">PSMemberInfoIntegratingCollection</a>&lt;<a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(
                            <span class="r249 r">standardMemberSet</span>,
                            <a href="#855191b609bc2b2f" class="i method">GetMemberCollection</a>(<a href="MshMemberInfo.cs.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="MshMemberInfo.cs.html#525826a417e26897" class="i field">All</a>, <span class="r245 r">backupTypeTable</span>));
                    <span class="r247 r">result</span> = <span class="r250 r">members</span><a href="MshMemberInfo.cs.html#e718c689173675b4">[</a><span class="r246 r">memberName</span>];
                }
            }
 
            <b>return</b> <span class="r247 r">result</span> ?? <a href="#e518df2aeb312ac9" class="i property">InstanceMembers</a><a href="MshMemberInfo.cs.html#fe158918a7413959">[</a><a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#ddc869cbe4f3534d" class="i field">PSStandardMembers</a>] <b>as</b> <a href="MshMemberInfo.cs.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used by Deserializer to deserialize a serialized object to a given type</span>
        <span class="c">///</span><span class="c"> (as specified in the a types.ps1xml file)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r251 r">backupTypeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TypeTable to use if this PSObject.GetTypeTable() returns null. This will happen</span>
        <span class="c">///</span><span class="c"> in the remoting scenario on the client/server side (where a LocalRunspace may not be</span>
        <span class="c">///</span><span class="c"> present).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Type</span> <a id="5c084e24674b7a1b" href="../R/5c084e24674b7a1b.html" target="n" data-glyph="74,1" class="i method">GetTargetTypeForDeserialization</a>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r251 rd" class="r251 r">backupTypeTable</span>)
        {
            <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r252 rd" class="r252 r">targetType</span> = <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#c5c083ccdccc09a2" class="i method">GetPSStandardMember</a>(<span class="r251 r">backupTypeTable</span>, <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>.<a href="TypeTable.cs.html#0b8c50b5b1803a4f" class="i field">TargetTypeForDeserialization</a>);
            <b>return</b> <span class="r252 r">targetType</span>?.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a> <b>as</b> <span class="i">Type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is only going to be called if SerializationMethod is SpecificProperties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r253 r">backupTypeTable</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TypeTable to use if this PSObject.GetTypeTable() returns null. This will happen</span>
        <span class="c">///</span><span class="c"> in the remoting scenario on the client side (where a LocalRunspace may not be</span>
        <span class="c">///</span><span class="c"> present).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A collection with only the specific properties to serialize.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="7d5f4324f4aa4852" href="../R/7d5f4324f4aa4852.html" target="n" data-glyph="74,1" class="i method">GetSpecificPropertiesToSerialize</a>(<a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r253 rd" class="r253 r">backupTypeTable</span>)
        {
            <a href="../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a> <span id="r254 rd" class="r254 r">typeTable</span> = <span class="r253 r">backupTypeTable</span> ?? <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>();
            <b>if</b> (<span class="r254 r">typeTable</span> != <b>null</b>)
            {
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r255 rd" class="r255 r">tmp</span> = <span class="r254 r">typeTable</span>.<a href="TypeTable.cs.html#80d737240ef62a7f" class="i method">GetSpecificProperties</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a>);
                <b>return</b> <span class="r255 r">tmp</span>;
            }
 
            <b>return</b> <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;());
        }
 
        <b>internal bool</b> <a id="32a7100ca0d323b0" href="../R/32a7100ca0d323b0.html" target="n" data-glyph="74,1" class="i method">ShouldSerializeAdapter</a>()
        {
            <b>if</b> (<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a>)
            {
                <b>return</b> <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a> != <b>null</b>;
            }
 
            <b>return</b> !<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>;
        }
 
        <b>internal</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <a id="012f97bbf4e8d756" href="../R/012f97bbf4e8d756.html" target="n" data-glyph="74,1" class="i method">GetAdaptedProperties</a>()
        {
            <b>return</b> <a href="#e59dc9ab60d2fc72" class="i method">GetProperties</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a>, <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#c3997c282bafb530" class="i property">InternalAdapter</a>);
        }
 
        <b>private</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <a id="e59dc9ab60d2fc72" href="../R/e59dc9ab60d2fc72.html" target="n" data-glyph="76,1" class="i method">GetProperties</a>(<a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r256 rd" class="r256 r">serializedMembers</span>, <a href="CoreAdapter.cs.html#88aa0312e9fc25c7" class="t t">Adapter</a> <span id="r257 rd" class="r257 r">particularAdapter</span>)
        {
            <b>if</b> (<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a>)
            {
                <b>return</b> <span class="r256 r">serializedMembers</span>;
            }
 
            <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r258 rd" class="r258 r">returnValue</span> = <b>new</b> <a href="MshMemberInfo.cs.html#d7e1a7ae65692996" class="t constructor">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;();
 
            <b>foreach</b> (<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r259 rd" class="r259 r">member</span> <b>in</b> <span class="r257 r">particularAdapter</span>.<a href="CoreAdapter.cs.html#9c78fe6d2464e81a" class="i method">BaseGetMembers</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>))
            {
                <span class="r258 r">returnValue</span>.<a href="MshMemberInfo.cs.html#2321c5eb6fda9f4c" class="i method">Add</a>(<span class="r259 r">member</span>);
            }
 
            <b>return</b> <span class="r258 r">returnValue</span>;
        }
 
        <b>internal static void</b> <a id="41bdc8470b711aef" href="../R/41bdc8470b711aef.html" target="n" data-glyph="74,1" class="i method">CopyDeserializerFields</a>(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r100 rd" class="r100 r">source</span>, <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r101 rd" class="r101 r">target</span>)
        {
            <b>if</b> (!<span class="r101 r">target</span>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a>)
            {
                <span class="r101 r">target</span>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a> = <span class="r100 r">source</span>.<a href="#598b509cd0dd9b32" class="i property">IsDeserialized</a>;
                <span class="r101 r">target</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a> = <span class="r100 r">source</span>.<a href="#5c4993d343040815" class="i property">AdaptedMembers</a>;
                <span class="r101 r">target</span>.<a href="#26fbd5ca52191910" class="i property">ClrMembers</a> = <span class="r100 r">source</span>.<a href="#26fbd5ca52191910" class="i property">ClrMembers</a>;
            }
 
            <b>if</b> (<span class="r101 r">target</span>.<a href="#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a> == <b>null</b>)
            {
                <span class="r101 r">target</span>.<a href="#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a> = <span class="r100 r">source</span>.<a href="#4276028eaed58bbb" class="i property">ToStringFromDeserialization</a>;
                <span class="r101 r">target</span>.<a href="#d80386ffa3949a2a" class="i property">TokenText</a> = <span class="r100 r">source</span>.<a href="#d80386ffa3949a2a" class="i property">TokenText</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set base object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r260 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object which is set as core.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">overrideTypeInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If true, overwrite the type information.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">This method is to be used only by Serialization code</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="da2fa2de3c634732" href="../R/da2fa2de3c634732.html" target="n" data-glyph="74,1" class="i method">SetCoreOnDeserialization</a>(<b>object</b> <span id="r260 rd" class="r260 r">value</span>, <b>bool</b> <span id="r261 rd" class="r261 r">overrideTypeInfo</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a>, <span class="s">&quot;BaseObject should be PSCustomObject for deserialized objects&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r260 r">value</span> != <b>null</b>, <span class="s">&quot;known objects are never null&quot;</span>);
            <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#caa97e1ddfac8ce8" class="i property">ImmediateBaseObjectIsEmpty</a> = <b>false</b>;
            <a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a> = <span class="r260 r">value</span>;
            <a href="#99b88dfe2d0d8a63" class="i field">_adapterSet</a> = <a href="#c3772e5257a3f0e8" class="i method">GetMappedAdapter</a>(<a href="#8c16eebde29bd5f9" class="i field">_immediateBaseObject</a>, <a href="#d5f9f98808bbda0e" class="i method">GetTypeTable</a>());
            <b>if</b> (<span class="r261 r">overrideTypeInfo</span>)
            {
                <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#829da48f79891848" class="i property">InternalTypeNames</a> = <a href="#a3c2513aa3da07fa" class="k">this</a>.<a href="#c3997c282bafb530" class="i property">InternalAdapter</a>.<a href="CoreAdapter.cs.html#e70aa32975138432" class="i method">BaseGetTypeNameHierarchy</a>(<span class="r260 r">value</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> serialization
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This class is solely used by PSObject to support .net member lookup for all the</span>
        <span class="c">///</span><span class="c"> adapters except for dotNetInstanceAdapter, mshMemberSetAdapter and mshObjectAdapter.</span>
        <span class="c">///</span><span class="c"> If the original adapter is not one of those, then .net members are also exposed</span>
        <span class="c">///</span><span class="c"> on the PSObject. This will have the following effect:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> 1. Every adapted object like xml, wmi, adsi will show adapted members as well as</span>
        <span class="c">///</span><span class="c">    .net members.</span>
        <span class="c">///</span><span class="c"> 2. Users will not need to access PSBase to access original .net members.</span>
        <span class="c">///</span><span class="c"> 3. This will fix v1.0 ADSI adapter where most of the complaints were about</span>
        <span class="c">///</span><span class="c">    discovering original .net members.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Use of this class will allow us to customize the ultimate .net member lookup.</span>
        <span class="c">///</span><span class="c"> For example, XML adapter already exposes .net methods.</span>
        <span class="c">///</span><span class="c"> Using this class you can choose exact .net adapter to support .net</span>
        <span class="c">///</span><span class="c"> member lookup and avoid lookup duplication.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This class is intended for internal use only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="16d82eb261f231c0" href="../R/16d82eb261f231c0.html" target="n" data-glyph="2,1" class="t t">AdapterSet</a>
        {
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Data
 
            <span class="c">// original adapter like Xml, ManagementClass, DirectoryEntry etc.</span>
            <span class="c">// .net adapter</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> This property can be accessed only internally and hence</span>
            <span class="c">///</span><span class="c"> no checks are performed on input.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a href="CoreAdapter.cs.html#88aa0312e9fc25c7" class="t t">Adapter</a> <a id="ae0218d7abc2d496" href="../R/ae0218d7abc2d496.html" target="n" data-glyph="104,2" class="i property">OriginalAdapter</a> { <b>get</b>; <b>set</b>; }
 
            <b>internal</b> <a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a> <a id="6e03ccc45b630635" href="../R/6e03ccc45b630635.html" target="n" data-glyph="104,2" class="i property">DotNetAdapter</a> { <b>get</b>; }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
            <b>internal</b> <a id="c967055107a51782" href="../R/c967055107a51782.html" target="n" data-glyph="74,2" class="t constructor">AdapterSet</a>(<a href="CoreAdapter.cs.html#88aa0312e9fc25c7" class="t t">Adapter</a> <span id="r262 rd" class="r262 r">adapter</span>, <a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a> <span id="r263 rd" class="r263 r">dotnetAdapter</span>)
            {
                <a href="#ae0218d7abc2d496" class="i property">OriginalAdapter</a> = <span class="r262 r">adapter</span>;
                <a href="#6e03ccc45b630635" class="i property">DotNetAdapter</a> = <span class="r263 r">dotnetAdapter</span>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Dynamic metaobject implementation
 
        <b>internal class</b> <a id="ce9257f894f7e86c" href="../R/ce9257f894f7e86c.html" target="n" data-glyph="2,1" class="t t">PSDynamicMetaObject</a> : <span class="i">DynamicMetaObject</span>
        {
            <b>internal</b> <a id="d4d4820927f8d382" href="../R/d4d4820927f8d382.html" target="n" data-glyph="74,2" class="t constructor">PSDynamicMetaObject</a>(<span class="i">Expression</span> <span id="r264 rd" class="r264 r">expression</span>, <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r265 rd" class="r265 r">value</span>)
                : <b>base</b>(<span class="r264 r">expression</span>, <span class="i">BindingRestrictions</span>.<span class="i">Empty</span>, <span class="r265 r">value</span>)
            {
            }
 
            <b>private</b> <b>new</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="53affca67c83ac24" href="../R/53affca67c83ac24.html" target="n" data-glyph="106,2" class="i property">Value</a> =&gt; (<a href="#a3c2513aa3da07fa" class="t t">PSObject</a>)<b>base</b>.<span class="i">Value</span>;
 
            <b>private</b> <span class="i">DynamicMetaObject</span> <a id="22328afd47e09f91" href="../R/22328afd47e09f91.html" target="n" data-glyph="76,2" class="i method">GetUnwrappedObject</a>()
            {
                <b>return</b> <b>new</b> <span class="i">DynamicMetaObject</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<a href="parser/Compiler.cs.html#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="parser/Compiler.cs.html#95ba8d8e80c2ae2b" class="i field">PSObject_Base</a>, <a href="#ce9257f894f7e86c" class="k">this</a>.<span class="i">Expression</span>), <a href="#ce9257f894f7e86c" class="k">this</a>.<span class="i">Restrictions</span>, <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#8ae71f08053e5ae1" class="i method">Base</a>(<a href="#53affca67c83ac24" class="i property">Value</a>));
            }
 
            <b>public override</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="760c96f5b4aa0173" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">GetDynamicMemberNames</a>()
            {
                <b>return</b> (<b>from</b> <span class="i">member</span> <b>in</b> <a href="#53affca67c83ac24" class="i property">Value</a>.<a href="#56bc82b240e4291b" class="i property">Members</a> <b>select</b> <span class="i">member</span>.<span class="i">Name</span>);
            }
 
            <b>private bool</b> <a id="4eacfe989cd36a6c" href="../R/4eacfe989cd36a6c.html" target="n" data-glyph="76,2" class="i method">MustDeferIDMOP</a>()
            {
                <b>var</b> <span id="r266 rd" class="r266 r">baseObject</span> = <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="#8ae71f08053e5ae1" class="i method">Base</a>(<a href="#53affca67c83ac24" class="i property">Value</a>);
                <b>return</b> <span class="r266 r">baseObject</span> <b>is</b> <span class="i">IDynamicMetaObjectProvider</span> &amp;&amp; <span class="r266 r">baseObject</span> <b>is not</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>;
            }
 
            <b>private</b> <span class="i">DynamicMetaObject</span> <a id="7ddb218409a66b8a" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">DeferForIDMOP</a>(<span class="i">DynamicMetaObjectBinder</span> <span id="r267 rd" class="r267 r">binder</span>, <b>params</b> <span class="i">DynamicMetaObject</span>[] <span id="r268 rd" class="r268 r">args</span>)
            {
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>(), <span class="s">&quot;Defer only works for idmop wrapped PSObjects&quot;</span>);
 
                <span class="i">Expression</span>[] <span id="r269 rd" class="r269 r">exprs</span> = <b>new</b> <span class="i">Expression</span>[<span class="r268 r">args</span>.<span class="i">Length</span> + 1];
                <span class="i">BindingRestrictions</span> <span id="r270 rd" class="r270 r">restrictions</span> = <a href="#ce9257f894f7e86c" class="k">this</a>.<span class="i">Restrictions</span> == <span class="i">BindingRestrictions</span>.<span class="i">Empty</span> ? <a href="#ce9257f894f7e86c" class="k">this</a>.<span class="i">PSGetTypeRestriction</span>() : <a href="#ce9257f894f7e86c" class="k">this</a>.<span class="i">Restrictions</span>;
 
                <span class="r269 r">exprs</span>[0] = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="parser/Compiler.cs.html#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="parser/Compiler.cs.html#95ba8d8e80c2ae2b" class="i field">PSObject_Base</a>, <a href="#ce9257f894f7e86c" class="k">this</a>.<span class="i">Expression</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
                <b>for</b> (<b>int</b> <span id="r271 rd" class="r271 r">i</span> = 0; <span class="r271 r">i</span> &lt; <span class="r268 r">args</span>.<span class="i">Length</span>; <span class="r271 r">i</span>++)
                {
                    <span class="r269 r">exprs</span>[<span class="r271 r">i</span> + 1] = <span class="r268 r">args</span>[<span class="r271 r">i</span>].<span class="i">Expression</span>;
                    <span class="r270 r">restrictions</span> = <span class="r270 r">restrictions</span>.<span class="i">Merge</span>(<span class="r268 r">args</span>[<span class="r271 r">i</span>].<span class="i">Restrictions</span> == <span class="i">BindingRestrictions</span>.<span class="i">Empty</span> ? <span class="r268 r">args</span>[<span class="r271 r">i</span>].<a href="runtime/Binding/Binders.cs.html#328412aa1d4c0f48" class="i method">PSGetTypeRestriction</a>() : <span class="r268 r">args</span>[<span class="r271 r">i</span>].<span class="i">Restrictions</span>);
                }
 
                <b>return</b> <b>new</b> <span class="i">DynamicMetaObject</span>(<span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r267 r">binder</span>, <span class="r267 r">binder</span>.<span class="i">ReturnType</span>, <span class="r269 r">exprs</span>), <span class="r270 r">restrictions</span>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="a4bb90c9dcef9be4" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindBinaryOperation</a>(<span class="i">BinaryOperationBinder</span> <span id="r272 rd" class="r272 r">binder</span>, <span class="i">DynamicMetaObject</span> <span id="r273 rd" class="r273 r">arg</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r272 r">binder</span>, <span class="r273 r">arg</span>);
                }
 
                <b>return</b> <span class="r272 r">binder</span>.<span class="i">FallbackBinaryOperation</span>(<a href="#22328afd47e09f91" class="i method">GetUnwrappedObject</a>(), <span class="r273 r">arg</span>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="7722419381425bd0" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindConvert</a>(<span class="i">ConvertBinder</span> <span id="r274 rd" class="r274 r">binder</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r274 r">binder</span>);
                }
 
                <span class="c">// This will invoke the language binder, meaning we might not invoke PowerShell conversions.  This</span>
                <span class="c">// is an interesting design choice, which, if revisited, needs some care because there are multiple</span>
                <span class="c">// binders that PowerShell uses for conversion, the normal one, and the one used when we want to</span>
                <span class="c">// attempt enumeration of some object that might or might not implement IEnumerable.</span>
                <b>return</b> <span class="r274 r">binder</span>.<span class="i">FallbackConvert</span>(<a href="#ce9257f894f7e86c" class="k">this</a>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="0bec86041c813f54" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindDeleteIndex</a>(<span class="i">DeleteIndexBinder</span> <span id="r275 rd" class="r275 r">binder</span>, <span class="i">DynamicMetaObject</span>[] <span id="r276 rd" class="r276 r">indexes</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r275 r">binder</span>, <span class="r276 r">indexes</span>);
                }
 
                <b>return</b> <span class="r275 r">binder</span>.<span class="i">FallbackDeleteIndex</span>(<a href="#22328afd47e09f91" class="i method">GetUnwrappedObject</a>(), <span class="r276 r">indexes</span>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="aeb71dd40478e089" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindDeleteMember</a>(<span class="i">DeleteMemberBinder</span> <span id="r277 rd" class="r277 r">binder</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r277 r">binder</span>);
                }
 
                <b>return</b> <span class="r277 r">binder</span>.<span class="i">FallbackDeleteMember</span>(<a href="#22328afd47e09f91" class="i method">GetUnwrappedObject</a>());
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="55fda7433621c697" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindGetIndex</a>(<span class="i">GetIndexBinder</span> <span id="r278 rd" class="r278 r">binder</span>, <span class="i">DynamicMetaObject</span>[] <span id="r279 rd" class="r279 r">indexes</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r278 r">binder</span>, <span class="r279 r">indexes</span>);
                }
 
                <b>return</b> <span class="r278 r">binder</span>.<span class="i">FallbackGetIndex</span>(<a href="#22328afd47e09f91" class="i method">GetUnwrappedObject</a>(), <span class="r279 r">indexes</span>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="2b8e1a4b0752deb0" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindInvoke</a>(<span class="i">InvokeBinder</span> <span id="r280 rd" class="r280 r">binder</span>, <span class="i">DynamicMetaObject</span>[] <span id="r281 rd" class="r281 r">args</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r280 r">binder</span>, <span class="r281 r">args</span>);
                }
 
                <b>return</b> <span class="r280 r">binder</span>.<span class="i">FallbackInvoke</span>(<a href="#22328afd47e09f91" class="i method">GetUnwrappedObject</a>(), <span class="r281 r">args</span>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="9b0475ce34d98517" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindSetIndex</a>(<span class="i">SetIndexBinder</span> <span id="r282 rd" class="r282 r">binder</span>, <span class="i">DynamicMetaObject</span>[] <span id="r283 rd" class="r283 r">indexes</span>, <span class="i">DynamicMetaObject</span> <span id="r284 rd" class="r284 r">value</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r282 r">binder</span>, <span class="r283 r">indexes</span>.<span class="i">Append</span>(<span class="r284 r">value</span>).<span class="i">ToArray</span>());
                }
 
                <b>return</b> <span class="r282 r">binder</span>.<span class="i">FallbackSetIndex</span>(<a href="#22328afd47e09f91" class="i method">GetUnwrappedObject</a>(), <span class="r283 r">indexes</span>, <span class="r284 r">value</span>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="acc7294c262b7935" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindUnaryOperation</a>(<span class="i">UnaryOperationBinder</span> <span id="r285 rd" class="r285 r">binder</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r285 r">binder</span>);
                }
 
                <b>return</b> <span class="r285 r">binder</span>.<span class="i">FallbackUnaryOperation</span>(<a href="#22328afd47e09f91" class="i method">GetUnwrappedObject</a>());
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="b4f998295f2c5349" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindInvokeMember</a>(<span class="i">InvokeMemberBinder</span> <span id="r286 rd" class="r286 r">binder</span>, <span class="i">DynamicMetaObject</span>[] <span id="r287 rd" class="r287 r">args</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r286 r">binder</span>, <span class="r287 r">args</span>);
                }
 
                <b>return</b> (<span class="r286 r">binder</span> <b>as</b> <a href="runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a> ??
                        (<span class="i">InvokeMemberBinder</span>)(<span class="r286 r">binder</span> <b>as</b> <a href="runtime/Binding/Binders.cs.html#ea209d8b05b0d799" class="t t">PSInvokeBaseCtorBinder</a>) ??
                        <a href="runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<span class="i">Get</span>(<span class="r286 r">binder</span>.<span class="i">Name</span>, <span class="r286 r">binder</span>.<span class="i">CallInfo</span>, <b>false</b>, <b>false</b>, <b>null</b>, <b>null</b>)).<span class="i">FallbackInvokeMember</span>(<a href="#ce9257f894f7e86c" class="k">this</a>, <span class="r287 r">args</span>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="64b23fa3b0531b1e" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindGetMember</a>(<span class="i">GetMemberBinder</span> <span id="r288 rd" class="r288 r">binder</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r288 r">binder</span>);
                }
 
                <b>return</b> (<span class="r288 r">binder</span> <b>as</b> <a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a> ?? <a href="runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">Get</span>(<span class="r288 r">binder</span>.<span class="i">Name</span>, (<span class="i">Type</span>)<b>null</b>, <b>false</b>)).<span class="i">FallbackGetMember</span>(<a href="#ce9257f894f7e86c" class="k">this</a>);
            }
 
            <b>public override</b> <span class="i">DynamicMetaObject</span> <a id="1635b4f9151a6325" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">BindSetMember</a>(<span class="i">SetMemberBinder</span> <span id="r289 rd" class="r289 r">binder</span>, <span class="i">DynamicMetaObject</span> <span id="r290 rd" class="r290 r">value</span>)
            {
                <b>if</b> (<a href="#4eacfe989cd36a6c" class="i method">MustDeferIDMOP</a>())
                {
                    <b>return</b> <span class="i">DeferForIDMOP</span>(<span class="r289 r">binder</span>, <span class="r290 r">value</span>);
                }
 
                <b>return</b> (<span class="r289 r">binder</span> <b>as</b> <a href="runtime/Binding/Binders.cs.html#b33a3e4647e9ce8d" class="t t">PSSetMemberBinder</a> ?? <a href="runtime/Binding/Binders.cs.html#b33a3e4647e9ce8d" class="t t">PSSetMemberBinder</a>.<span class="i">Get</span>(<span class="r289 r">binder</span>.<span class="i">Name</span>, (<span class="i">Type</span>)<b>null</b>, <b>false</b>)).<span class="i">FallbackSetMember</span>(<a href="#ce9257f894f7e86c" class="k">this</a>, <span class="r290 r">value</span>);
            }
        }
 
        <span class="i">DynamicMetaObject</span> <span class="i">IDynamicMetaObjectProvider</span>.<a id="d76017b83b9baf2c" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetMetaObject</a>(<span class="i">Expression</span> <span id="r291 rd" class="r291 r">parameter</span>)
        {
            <b>return</b> <b>new</b> <a href="#d4d4820927f8d382" class="t constructor">PSDynamicMetaObject</a>(<span class="r291 r">parameter</span>, <a href="#a3c2513aa3da07fa" class="k">this</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>internal bool</b> <a id="598b509cd0dd9b32" href="../R/598b509cd0dd9b32.html" target="n" data-glyph="104,1" class="i property">IsDeserialized</a>
        {
            <b>get</b> =&gt; <a href="#6dfe7fdb239cdd76" class="i field">_flags</a>.<span class="i">HasFlag</span>(<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#b603dd8e10caec16" class="i field">IsDeserialized</a>);
            <b>set</b>
            {
                <b>if</b> (<b>value</b>)
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> |= <a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#b603dd8e10caec16" class="i field">IsDeserialized</a>;
                }
                <b>else</b>
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> &amp;= ~<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#b603dd8e10caec16" class="i field">IsDeserialized</a>;
                }
            }
        }
 
        <b>private bool</b> <a id="9b5bfd3e7e1a661c" href="../R/9b5bfd3e7e1a661c.html" target="n" data-glyph="106,1" class="i property">StoreTypeNameAndInstanceMembersLocally</a>
        {
            <b>get</b> =&gt; <a href="#6dfe7fdb239cdd76" class="i field">_flags</a>.<span class="i">HasFlag</span>(<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#abb3e2333034ac6f" class="i field">StoreTypeNameAndInstanceMembersLocally</a>);
            <b>set</b>
            {
                <b>if</b> (<b>value</b>)
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> |= <a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#abb3e2333034ac6f" class="i field">StoreTypeNameAndInstanceMembersLocally</a>;
                }
                <b>else</b>
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> &amp;= ~<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#abb3e2333034ac6f" class="i field">StoreTypeNameAndInstanceMembersLocally</a>;
                }
            }
        }
 
        <b>internal bool</b> <a id="46fe0e4bd3e1bb79" href="../R/46fe0e4bd3e1bb79.html" target="n" data-glyph="104,1" class="i property">IsHelpObject</a>
        {
            <b>get</b> =&gt; <a href="#6dfe7fdb239cdd76" class="i field">_flags</a>.<span class="i">HasFlag</span>(<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#f5d2041ffac67dc3" class="i field">IsHelpObject</a>);
            <b>set</b>
            {
                <b>if</b> (<b>value</b>)
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> |= <a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#f5d2041ffac67dc3" class="i field">IsHelpObject</a>;
                }
                <b>else</b>
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> &amp;= ~<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#f5d2041ffac67dc3" class="i field">IsHelpObject</a>;
                }
            }
        }
 
        <b>internal bool</b> <a id="9b240ff559436969" href="../R/9b240ff559436969.html" target="n" data-glyph="104,1" class="i property">HasGeneratedReservedMembers</a>
        {
            <b>get</b> =&gt; <a href="#6dfe7fdb239cdd76" class="i field">_flags</a>.<span class="i">HasFlag</span>(<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#0f59656d6148f758" class="i field">HasGeneratedReservedMembers</a>);
            <b>set</b>
            {
                <b>if</b> (<b>value</b>)
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> |= <a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#0f59656d6148f758" class="i field">HasGeneratedReservedMembers</a>;
                }
                <b>else</b>
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> &amp;= ~<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#0f59656d6148f758" class="i field">HasGeneratedReservedMembers</a>;
                }
            }
        }
 
        <b>internal bool</b> <a id="caa97e1ddfac8ce8" href="../R/caa97e1ddfac8ce8.html" target="n" data-glyph="104,1" class="i property">ImmediateBaseObjectIsEmpty</a>
        {
            <b>get</b> =&gt; <a href="#6dfe7fdb239cdd76" class="i field">_flags</a>.<span class="i">HasFlag</span>(<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#788bebb2c012455d" class="i field">ImmediateBaseObjectIsEmpty</a>);
            <b>set</b>
            {
                <b>if</b> (<b>value</b>)
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> |= <a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#788bebb2c012455d" class="i field">ImmediateBaseObjectIsEmpty</a>;
                }
                <b>else</b>
                {
                    <a href="#6dfe7fdb239cdd76" class="i field">_flags</a> &amp;= ~<a href="#08ae6dda457d0458" class="t t">PSObjectFlags</a>.<a href="#788bebb2c012455d" class="i field">ImmediateBaseObjectIsEmpty</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If &#39;this&#39; is non-null, return this string as the ToString() for this wrapped object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="d80386ffa3949a2a" href="../R/d80386ffa3949a2a.html" target="n" data-glyph="104,1" class="i property">TokenText</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the &#39;ToString&#39; value on deserialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="4276028eaed58bbb" href="../R/4276028eaed58bbb.html" target="n" data-glyph="104,1" class="i property">ToStringFromDeserialization</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property contains a stream type used by the formatting system.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#03e0630da31ec3a9" class="t t">WriteStreamType</a> <a id="e3bac6ee3e22d6dc" href="../R/e3bac6ee3e22d6dc.html" target="n" data-glyph="104,1" class="i property">WriteStream</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Members from the adapter of the object before it was serialized</span>
        <span class="c">///</span><span class="c"> Null for live objects but not null for deserialized objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <a id="5c4993d343040815" href="../R/5c4993d343040815.html" target="n" data-glyph="104,1" class="i property">AdaptedMembers</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal static</b> <a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a> <a id="09463c4cdacf00f4" href="../R/09463c4cdacf00f4.html" target="n" data-glyph="104,1" class="i property">DotNetStaticAdapter</a> =&gt; <a href="#d306ec6bcf4d65d0" class="i field">s_dotNetStaticAdapter</a>;
 
        <b>internal static</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="a99ae1b984fd50d2" href="../R/a99ae1b984fd50d2.html" target="n" data-glyph="104,1" class="i property">MemberResolution</a> =&gt; <a href="#2f0fbfca7b867b87" class="i field">s_memberResolution</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Members from the adapter of the object before it was serialized</span>
        <span class="c">///</span><span class="c"> Null for live objects but not null for deserialized objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshMemberInfo.cs.html#d9b894a5fd752b79" class="t t">PSMemberInfoInternalCollection</a>&lt;<a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <a id="26fbd5ca52191910" href="../R/26fbd5ca52191910.html" target="n" data-glyph="104,1" class="i property">ClrMembers</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal static</b> <a href="CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a> <a id="20218854b572ba17" href="../R/20218854b572ba17.html" target="n" data-glyph="104,1" class="i property">DotNetInstanceAdapter</a> =&gt; <a href="#48562d9930b22ac8" class="i field">s_dotNetInstanceAdapter</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets an instance member if it&#39;s name matches the predicate. Otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <a id="1c0e9bcb3834bacc" href="../R/1c0e9bcb3834bacc.html" target="n" data-glyph="74,1" class="i method">GetFirstPropertyOrDefault</a>(<a href="MshMemberInfo.cs.html#d5ff3fcf47f31d27" class="t t">MemberNamePredicate</a> <span id="r292 rd" class="r292 r">predicate</span>)
        {
            <b>return</b> <a href="#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#0b5e4d035c474f32" class="i method">FirstOrDefault</a>(<span class="r292 r">predicate</span>);
        }
 
        [<span class="i">Flags</span>]
        <b>private enum</b> <a id="08ae6dda457d0458" href="../R/08ae6dda457d0458.html" target="n" data-glyph="22,1" class="t t"><span id="f9af6a1c79e9c664">PSObjectFlags</span></a> : <b>byte</b>
        {
            <a id="4657008679d760ba" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">None</a> = 0,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> This flag is set in deserialized shellobject.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="b603dd8e10caec16" href="../R/b603dd8e10caec16.html" target="n" data-glyph="24,2" class="i field">IsDeserialized</a> = 0b00000001,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Set to true when the BaseObject is PSCustomObject.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="0f59656d6148f758" href="../R/0f59656d6148f758.html" target="n" data-glyph="24,2" class="i field">HasGeneratedReservedMembers</a> = 0b00000010,
            <a id="788bebb2c012455d" href="../R/788bebb2c012455d.html" target="n" data-glyph="24,2" class="i field">ImmediateBaseObjectIsEmpty</a> = 0b00000100,
            <a id="f5d2041ffac67dc3" href="../R/f5d2041ffac67dc3.html" target="n" data-glyph="24,2" class="i field">IsHelpObject</a> = 0b00001000,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Indicate whether we store the instance members and type names locally</span>
            <span class="c">///</span><span class="c"> for this PSObject instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="abb3e2333034ac6f" href="../R/abb3e2333034ac6f.html" target="n" data-glyph="24,2" class="i field">StoreTypeNameAndInstanceMembersLocally</a> = 0b00010000,
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Specifies special stream write processing.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="03e0630da31ec3a9" href="../R/03e0630da31ec3a9.html" target="n" data-glyph="20,0" class="t t"><span id="fd768d99333da013">WriteStreamType</span></a> : <b>byte</b>
    {
        <a id="fb007489cab0f342" href="../R/fb007489cab0f342.html" target="n" data-glyph="24,1" class="i field">None</a>,
        <a id="b36161f03e58f67b" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Output</a>,
        <a id="af472c29dba3fb51" href="../R/af472c29dba3fb51.html" target="n" data-glyph="24,1" class="i field">Error</a>,
        <a id="6c92852b80d52e75" href="../R/6c92852b80d52e75.html" target="n" data-glyph="24,1" class="i field">Warning</a>,
        <a id="74af4733316f3145" href="../R/74af4733316f3145.html" target="n" data-glyph="24,1" class="i field">Verbose</a>,
        <a id="9b1a014e3b7e9eb3" href="../R/9b1a014e3b7e9eb3.html" target="n" data-glyph="24,1" class="i field">Debug</a>,
        <a id="be5bddae0acf5fcc" href="../R/be5bddae0acf5fcc.html" target="n" data-glyph="24,1" class="i field">Information</a>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Serves as a placeholder BaseObject when PSObject&#39;s</span>
    <span class="c">///</span><span class="c"> constructor with no parameters is used.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="4a84ee8edc4d53a0" href="../R/4a84ee8edc4d53a0.html" target="n" data-glyph="0,0" class="t t">PSCustomObject</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To prevent other instances than SelfInstance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a id="d05ca0d053930ec0" href="../R/d05ca0d053930ec0.html" target="n" data-glyph="76,1" class="t constructor">PSCustomObject</a>() { }
 
        <b>internal static readonly</b> <a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a> <a id="f440822ac3f6fd5d" href="../R/f440822ac3f6fd5d.html" target="n" data-glyph="44,1" class="i field">SelfInstance</a> = <b>new</b> <a href="#d05ca0d053930ec0" class="t constructor">PSCustomObject</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="233575c8cf86cef3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Please keep in sync with SerializationMethod from</span>
    <span class="c">///</span><span class="c"> C:\e\win7_powershell\admin\monad\nttargets\assemblies\logging\ETW\Manifests\Microsoft-Windows-PowerShell-Instrumentation.man</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="9a814b5a84518967" href="../R/9a814b5a84518967.html" target="n" data-glyph="20,0" class="t t"><span id="765c52a5cac2bd3b">SerializationMethod</span></a>
    {
        <a id="2b48e1ab81bbeb55" href="../R/2b48e1ab81bbeb55.html" target="n" data-glyph="24,1" class="i field">AllPublicProperties</a> = 0,
        <a id="39112656c90948bc" href="../R/39112656c90948bc.html" target="n" data-glyph="24,1" class="i field">String</a> = 1,
        <a id="2de6f005a393985d" href="../R/2de6f005a393985d.html" target="n" data-glyph="24,1" class="i field">SpecificProperties</a> = 2
    }
}
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">restore</span> 56500
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Contains auxiliary ToString CodeMethod implementations for some types.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static</b> <a href="../P/6fbe6ac0a6a7f8d2.html" target="s" class="k">partial</a> <b>class</b> <a id="6fbe6ac0a6a7f8d2" href="../R/6fbe6ac0a6a7f8d2.html" target="n" data-glyph="0,0" class="t t">ToStringCodeMethods</a>
    {
        <b>private static void</b> <a id="9ab009c7850614fb" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddGenericArguments</a>(<span class="i">StringBuilder</span> <span id="r293 rd" class="r293 r">sb</span>, <span class="i">Type</span>[] <span id="r294 rd" class="r294 r">genericArguments</span>, <b>bool</b> <span id="r295 rd" class="r295 r">dropNamespaces</span>)
        {
            <span class="r293 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
            <b>for</b> (<b>int</b> <span id="r296 rd" class="r296 r">i</span> = 0; <span class="r296 r">i</span> &lt; <span class="r294 r">genericArguments</span>.<span class="i">Length</span>; <span class="r296 r">i</span>++)
            {
                <b>if</b> (<span class="r296 r">i</span> &gt; 0) { <span class="r293 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>); }
 
                <span class="r293 r">sb</span>.<span class="i">Append</span>(<a href="#edc1ecfda5d75ea9" class="i method">Type</a>(<span class="r294 r">genericArguments</span>[<span class="r296 r">i</span>], <span class="r295 r">dropNamespaces</span>));
            }
 
            <span class="r293 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
        }
 
        <b>internal static string</b> <a id="edc1ecfda5d75ea9" href="../R/edc1ecfda5d75ea9.html" target="n" data-glyph="74,1" class="i method">Type</a>(<span class="i">Type</span> <span id="r297 rd" class="r297 r">type</span>, <b>bool</b> <span id="r298 rd" class="r298 r">dropNamespaces</span> = <b>false</b>, <b>string</b> <span id="r299 rd" class="r299 r">key</span> = <b>null</b>)
        {
            <b>if</b> (<span class="r297 r">type</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>string</b> <span id="r300 rd" class="r300 r">result</span>;
            <b>if</b> (<span class="r297 r">type</span>.<span class="i">IsGenericType</span> &amp;&amp; !<span class="r297 r">type</span>.<span class="i">IsGenericTypeDefinition</span>)
            {
                <b>string</b> <span id="r301 rd" class="r301 r">genericDefinition</span> = <span class="i">Type</span>(<span class="r297 r">type</span>.<span class="i">GetGenericTypeDefinition</span>(), <span class="r298 r">dropNamespaces</span>);
                <span class="c">// For regular generic types, we find the backtick character, for example:</span>
                <span class="c">//      System.Collections.Generic.List`1[T] -&gt;</span>
                <span class="c">//      System.Collections.Generic.List[string]</span>
                <span class="c">// For nested generic types, we find the left bracket character, for example:</span>
                <span class="c">//      System.Collections.Generic.Dictionary`2+Enumerator[TKey, TValue] -&gt;</span>
                <span class="c">//      System.Collections.Generic.Dictionary`2+Enumerator[string,string]</span>
                <b>int</b> <span id="r302 rd" class="r302 r">backtickOrLeftBracketIndex</span> = <span class="r301 r">genericDefinition</span>.<span class="i">LastIndexOf</span>(<span class="r297 r">type</span>.<span class="i">IsNested</span> ? <span class="s">&#39;[&#39;</span> : <span class="s">&#39;`&#39;</span>);
                <b>var</b> <span id="r303 rd" class="r303 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r301 r">genericDefinition</span>, 0, <span class="r302 r">backtickOrLeftBracketIndex</span>, 512);
                <span class="i">AddGenericArguments</span>(<span class="r303 r">sb</span>, <span class="r297 r">type</span>.<span class="i">GetGenericArguments</span>(), <span class="r298 r">dropNamespaces</span>);
                <span class="r300 r">result</span> = <span class="r303 r">sb</span>.<span class="i">ToString</span>();
            }
            <b>else</b> <b>if</b> (<span class="r297 r">type</span>.<span class="i">IsArray</span>)
            {
                <b>string</b> <span id="r304 rd" class="r304 r">elementDefinition</span> = <span class="i">Type</span>(<span class="r297 r">type</span>.<span class="i">GetElementType</span>(), <span class="r298 r">dropNamespaces</span>);
                <b>var</b> <span id="r305 rd" class="r305 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r304 r">elementDefinition</span>, <span class="r304 r">elementDefinition</span>.<span class="i">Length</span> + 10);
                <span class="r305 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
                <b>for</b> (<b>int</b> <span id="r306 rd" class="r306 r">i</span> = 0; <span class="r306 r">i</span> &lt; <span class="r297 r">type</span>.<span class="i">GetArrayRank</span>() - 1; ++<span class="r306 r">i</span>)
                {
                    <span class="r305 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                }
 
                <span class="r305 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
                <span class="r300 r">result</span> = <span class="r305 r">sb</span>.<span class="i">ToString</span>();
            }
            <b>else</b>
            {
                <span class="r300 r">result</span> = <a href="parser/TypeResolver.cs.html#c299defb2b5f7804" class="t t">TypeAccelerators</a>.<a href="parser/TypeResolver.cs.html#31a99ea7bcdbafd6" class="i method">FindBuiltinAccelerator</a>(<span class="r297 r">type</span>, <span class="r299 r">key</span>);
                <b>if</b> (<span class="r300 r">result</span> == <b>null</b>)
                {
                    <b>if</b> (<span class="r297 r">type</span> == <b>typeof</b>(<a href="#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>))
                    {
                        <b>return</b> <span class="r297 r">type</span>.<span class="i">Name</span>;
                    }
 
                    <b>if</b> (<span class="r298 r">dropNamespaces</span>)
                    {
                        <b>if</b> (<span class="r297 r">type</span>.<span class="i">IsNested</span>)
                        {
                            <span class="c">// For nested types, we should return OuterType+InnerType. For example,</span>
                            <span class="c">//  System.Environment+SpecialFolder -&gt;  Environment+SpecialFolder</span>
                            <b>string</b> <span id="r307 rd" class="r307 r">fullName</span> = <span class="r297 r">type</span>.<span class="i">ToString</span>();
                            <span class="r300 r">result</span> = <span class="r297 r">type</span>.<span class="i">Namespace</span> == <b>null</b>
                                        ? <span class="r307 r">fullName</span>
                                        : <span class="r307 r">fullName</span>.<span class="i">Substring</span>(<span class="r297 r">type</span>.<span class="i">Namespace</span>.<span class="i">Length</span> + 1);
                        }
                        <b>else</b>
                        {
                            <span class="r300 r">result</span> = <span class="r297 r">type</span>.<span class="i">Name</span>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r300 r">result</span> = <span class="r297 r">type</span>.<span class="i">ToString</span>();
                    }
                }
            }
 
            <span class="c">// We can&#39;t round trip anything with a generic parameter.</span>
            <span class="c">// We also can&#39;t round trip if we&#39;re dropping the namespace.</span>
            <b>if</b> (!<span class="r297 r">type</span>.<span class="i">IsGenericParameter</span>
                &amp;&amp; !<span class="r297 r">type</span>.<span class="i">ContainsGenericParameters</span>
                &amp;&amp; !<span class="r298 r">dropNamespaces</span>
                &amp;&amp; !<span class="r297 r">type</span>.<span class="i">Assembly</span>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<a href="Attributes.cs.html#fab2ad862be5707e" class="t t">DynamicClassImplementationAssemblyAttribute</a>)).<span class="i">Any</span>())
            {
                <a href="parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="parser/TypeResolver.cs.html#3fb063578567b37c" class="i method">TryResolveType</a>(<span class="r300 r">result</span>, <b>out</b> <span class="i">Type</span> <span id="r308 rd" class="r308 r">roundTripType</span>);
                <b>if</b> (<span class="r308 r">roundTripType</span> != <span class="r297 r">type</span>)
                {
                    <span class="r300 r">result</span> = <span class="r297 r">type</span>.<span class="i">AssemblyQualifiedName</span>;
                }
            }
 
            <b>return</b> <span class="r300 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ToString implementation for Type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r309 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance of PSObject wrapping a Type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="deaf6cacda249501" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Type</a>(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r309 rd" class="r309 r">instance</span>)
        {
            <b>if</b> (<span class="r309 r">instance</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>return</b> <a href="#edc1ecfda5d75ea9" class="i method">Type</a>((<span class="i">Type</span>)<span class="r309 r">instance</span>.<a href="#d854d13536b70a12" class="i property">BaseObject</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ToString implementation for XmlNode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r310 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance of PSObject wrapping an XmlNode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="6ed6634fd684f9be" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">XmlNode</a>(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r310 rd" class="r310 r">instance</span>)
        {
            <span class="i">XmlNode</span> <span id="r311 rd" class="r311 r">node</span> = (<span class="i">XmlNode</span>)<span class="r310 r">instance</span>?.<a href="#d854d13536b70a12" class="i property">BaseObject</a>;
            <b>if</b> (<span class="r311 r">node</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>return</b> <span class="r311 r">node</span>.<span class="i">LocalName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ToString implementation for XmlNodeList.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r312 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Instance of PSObject wrapping an XmlNodeList.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="ec879309adcb7557" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">XmlNodeList</a>(<a href="#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r312 rd" class="r312 r">instance</span>)
        {
            <span class="i">XmlNodeList</span> <span id="r313 rd" class="r313 r">nodes</span> = (<span class="i">XmlNodeList</span>)<span class="r312 r">instance</span>?.<a href="#d854d13536b70a12" class="i property">BaseObject</a>;
            <b>if</b> (<span class="r313 r">nodes</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>if</b> (<span class="r313 r">nodes</span>.<span class="i">Count</span> == 1)
            {
                <b>if</b> (<span class="r313 r">nodes</span>[0] == <b>null</b>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r313 r">nodes</span>[0]).<a href="#298666357e641f03" class="i method">ToString</a>();
            }
 
            <b>return</b> <a href="#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">ToStringEnumerable</span>(<span class="i">context</span>: <b>null</b>, <span class="i">enumerable</span>: <span class="r313 r">nodes</span>, <span class="i">separator</span>: <b>null</b>, <span class="i">format</span>: <b>null</b>, <span class="i">formatProvider</span>: <b>null</b>);
        }
    }
}
</pre></td></tr></table></div></body></html>
